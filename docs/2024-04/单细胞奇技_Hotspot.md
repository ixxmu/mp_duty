---
title: "å•ç»†èƒå¥‡æŠ€_Hotspot"
date: 2024-04-16T01:32:54Z
draft: ["false"]
tags: [
  "fetched",
  "å•ç»†èƒè®­ç»ƒè¥"
]
categories: ["Acdemic"]
---
å•ç»†èƒå¥‡æŠ€_Hotspot by å•ç»†èƒè®­ç»ƒè¥
------
<div><p data-mpa-powered-by="yiban.io">å¯¹äºå•ç»†èƒè½¬å½•ç»„å­¦åˆ†æï¼Œæ•°ä»¥ä¸‡è®¡çš„ç»†èƒå¯ä»¥æ ¹æ®è¡¨è¾¾è°±çš„ç›¸ä¼¼æ€§è¢«åˆ†æˆç‹¬ç«‹çš„clusterï¼Œè€Œgeneä¹‹é—´ä¹Ÿå¯å› è¡¨è¾¾ç‰¹å¾çš„ç›¸ä¼¼è¢«åˆ†æˆç¦»æ•£çš„moduleï¼Œç‰¹åˆ«æ˜¯ç™Œç—‡ç”Ÿç‰©å­¦é¢†åŸŸååˆ†ä¾èµ–äºæ­¤æ€è·¯ä»å¼‚è´¨æ€§ååˆ†æ˜æ˜¾çš„è‚¿ç˜¤ç»†èƒè§£æå‡ºç›¸å¯¹ç¨³å¥çš„gene moduleï¼Œå¹¶æ ¹æ®moduleå†…çš„åŸºå› è¿›è¡ŒåŠŸèƒ½å¯Œé›†ä»è€Œæ­ç¤ºè‚¿ç˜¤ç»†èƒäºšç¾¤çš„è¡¨å‹ï¼Œæ¯”å¦‚è€è¯æ€§æˆ–å€¾å‘äºè½¬ç§»çš„ç‰¹å¾ã€‚æœ¬æ–‡ä»‹ç»çš„Hotspotå·¥å…·å³æ˜¯è¿›è¡Œæ­¤ç±»é—®é¢˜ç ”ç©¶çš„å¾ˆå¥½çš„å·¥å…·ğŸ”§ï¼Œè¯¥æ–¹æ³•åŸºäºpythonè¯­è¨€ç¯å¢ƒå®ç°ï¼Œå®‰è£…è¿‡ç¨‹å‹å¥½ï¼ŒåŸç†è®²è§£é€šé€[å¼ºçƒˆæ¨èå¤§å®¶é˜…è§ˆåŸæ–‡]ã€‚</p><p><img data-galleryid="" data-ratio="0.7435185185185185" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiab4UJnGJGLcHiblGvm3FRgpDWcKXZCs7RTbiaDecYzOn1AdKFvDPLwDgQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiab4UJnGJGLcHiblGvm3FRgpDWcKXZCs7RTbiaDecYzOn1AdKFvDPLwDgQ/640?wx_fmt=png"></p><p>é¦–å…ˆç®€å•ä»‹ç»å…¶è¿è¡Œé€»è¾‘ï¼ŒHotspotç®—æ³•æ˜¯åŸºäºå›¾çš„æ–¹æ³•è¿›è¡Œç‰¹å¾åŸºå› å’ŒåŸºå› æ¨¡å—é¢„æµ‹ï¼Œå…·ä½“æ¥è¯´ï¼Œä½œè€…è®¤ä¸ºè‹¥gene xå’Œgene yå­˜åœ¨è¡¨è¾¾æ¨¡å¼çš„ç›¸å…³æ€§é‚£ä¹ˆåœ¨å›¾è¡¨ç¤ºå†…è·ç¦»ç›¸è¿‘çš„é™å®šæ•°ç›®ç»†èƒä¸­è¡¨è¾¾é‡çš„ä¹˜ç§¯åº”å½“æ˜¾è‘—å¤§äºæ²¡æœ‰ç›¸å…³æ€§çš„ä¸€å¯¹åŸºå› ï¼Œæ•…æ­¤è¯„ä¼°æ–¹æ³•æœ‰åˆ«äºä»…è€ƒè™‘åŒä¸€ç»†èƒå†…æ¯å¯¹gene pairçš„è¡¨è¾¾æ¨¡å¼çš„pearsonè®¡ç®—æ–¹æ³•ä¸åŒï¼Œèƒ½å¤Ÿæ›´å¥½çš„è§£å†³æ•°æ®ç¨€ç–é€ æˆçš„å¯¹rare expression gene pairçš„å‡é˜´æ€§æ£€å‡ºé—®é¢˜ã€‚<span></span></p><p><img data-galleryid="" data-ratio="0.7055555555555556" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaQM5ickzzRKIicbDibAYJmia36icGANF2x8Ou7icv0b7fbnHSS3uYOUaBicwoA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaQM5ickzzRKIicbDibAYJmia36icGANF2x8Ou7icv0b7fbnHSS3uYOUaBicwoA/640?wx_fmt=png"></p><p>å¦å¤–ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œä¸Šè¿°cell-cell similarityçš„è¡¡é‡æ–¹å¼å¹¶éå•ä¸€ï¼Œè‹¥åœ¨å•ç»†èƒè½¬å½•ç»„æƒ…å¢ƒä¸‹è€ƒé‡ï¼Œå¯ä»¥æ˜¯ç»PCAçº¿æ€§é™ç»´åçš„ç©ºé—´å†…ç»†èƒé—´æ¬§å¼è·ç¦»ä¸ºè€ƒé‡æˆ–æ˜¯è€ƒè™‘åˆ°æ‰¹æ¬¡å“åº”ä»¥harmonyå¤„ç†åçš„ç©ºé—´ä¸‹ç›¸å¯¹è·ç¦»åˆæˆ–æ˜¯scVIéçº¿æ€§é™ç»´åçš„ç›¸å¯¹è·ç¦»ä½œä¸ºinputã€‚å¯¹äºç©ºé—´è½¬å½•ç»„æ•°æ®æ¥è¯´ï¼Œå¯ä»¥spotåœ¨2D 10X Visium slideä¸Šçš„åæ ‡ä½œä¸ºinputï¼Œé‚£ä¹ˆä¸éš¾æƒ³åˆ°ï¼Œæ­¤è¾“å…¥æœ€åæ±‚å¾—çš„gene moduleå³åœ¨ç©ºé—´åˆ†å¸ƒæ¨¡å¼ç›¸ä¼¼çš„åŸºå› é›†åˆï¼Œæ­¤æ–¹é¢å®Œå…¨å¯ä»¥æˆä¸ºSpatialIDEæ–¹æ³•çš„å¹³æ›¿[æ•ˆæœç›¸è¿‘ï¼Œè¿è¡Œé€Ÿåº¦åŠ å¿«ç™¾å€]</p><p><img data-galleryid="" data-ratio="0.85" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaw3eibqsEXoEabWHeVBoAxp5qPrxBGichnr5JPNKyxuUfto5Mr4IeJk5Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaw3eibqsEXoEabWHeVBoAxp5qPrxBGichnr5JPNKyxuUfto5Mr4IeJk5Q/640?wx_fmt=png"></p><p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æåˆ°ï¼Œä¸ºäº†å°½å¯èƒ½èŠ‚çœè®¡ç®—å¼€é”€å¹¶æ’é™¤æ‰æ²¡æœ‰æ„ä¹‰çš„åŸºå› ï¼Œè¿›è¡Œgeneé—´å±€éƒ¨correlationè®¡ç®—å‰é¦–å…ˆéœ€è¦æ‹©é€‰å‡ºinformative geneï¼Œæ­¤æ­¥ç®€å•æ¥è¯´ä¸ä¸Šè¿°æ€è·¯ç›¸ä¼¼ï¼Œä½†è®¡ç®—çš„æ˜¯auto-correlationï¼Œå³åœ¨å›¾è¡¨ç¤ºç©ºé—´ä¸­çš„æ¯”å¦‚30ä¸ªæœ€è¿‘é‚»çš„ç»†èƒä¸­è®¡ç®—åŒä¸€åŸºå› ä¸åŒç»†èƒä¹‹é—´ä¹˜ç§¯çš„ç´¯åŠ å’Œï¼Œå¹¶è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ±‚å‡ºæ¯ä¸ªåŸºå› çš„è‡ªç›¸å…³ç»Ÿè®¡é‡åè¿›è¡Œæ’åºï¼ŒæŒ‘é€‰å‰åˆ—çš„åŸºå› è¿›è¡Œåç»­çš„gene-pair correlationå’Œgene module extractionï¼Œä»è€Œè¿›ä¸€æ­¥åŠ å¼ºhotspotç®—æ³•çš„è¿ç®—æ•ˆç‡å’Œç»“æœçš„å¯è§£é‡Šæ€§ï¼<br></p><h3 data-pm-slice="1 1 []" data-en-clipboard="true"><strong>Code [Running]</strong></h3><p>#Hotspot is installed directly from PyPI using the following command:</p><section><ul><li></ul><pre data-lang="nginx"><code><span><span>pip</span> install hotspotsc</span></code></pre></section><ol><p>1. Create the Hotspot object</p></ol><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>import</span> hotspot</span></code><code><span>hs = hotspot.Hotspot(</span></code><code><span>Â  adata, <span>#Anndata object of cells by genes</span></span></code><code><span>Â  layer_key=<span>'counts'</span>, <span>#the layer of adata containing count information</span></span></code><code><span>Â  model=<span>'danb'</span>, <span>#danb selects the umi-adjusted negative binomial model</span></span></code><code><span>Â  latent_obsm_key = <span>'X_pca'</span>, <span>#the .obsm key of adata containing Cells x Components matrix (the PCA-reduced space)</span></span></code><code><span>Â  umi_counts_obs_key=<span>'total_counts'</span> <span>#the .obs key of adata with the UMI count for each cell</span></span></code><code><span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.6675925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiabfukoCjkeCq4U1mQtyH6ZTNG0ujBt5Fiby075HNfFbrDGhxUJIdvslg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiabfukoCjkeCq4U1mQtyH6ZTNG0ujBt5Fiby075HNfFbrDGhxUJIdvslg/640?wx_fmt=png"></p><p>2. Compute the KNN graph</p><section><ul><li><li></ul><pre data-lang="php"><code><span><span>#The K-nearest-neighbors graph is computed by running</span></span></code><code><span>hs.create_knn_graph(weighted_graph=<span>False</span>, n_neighbors=<span>30</span>)</span></code></pre></section><p><img data-galleryid="" data-ratio="0.2796296296296296" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaEFia9ib9mlNWzsgIU3hF9RZFM8J5fibm5Jwsb8zCjxsfPytibNMIYDiblicQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaEFia9ib9mlNWzsgIU3hF9RZFM8J5fibm5Jwsb8zCjxsfPytibNMIYDiblicQ/640?wx_fmt=png"></p><p>3. Find informative genes (by gene autocorrelation)<br></p><section><ul><li><li></ul><pre data-lang="ini"><code><span><span>#To compute per-gene autocorrelations,run:</span></span></code><code><span><span>hs_results</span> = hs.compute_autocorrelations()</span></code></pre></section><p><img data-galleryid="" data-ratio="0.6083333333333333" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaCczLtibtSrvIdFnKR86crv9NqLap7lXKXWQibW25USefhibFNOMYWktKA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaCczLtibtSrvIdFnKR86crv9NqLap7lXKXWQibW25USefhibFNOMYWktKA/640?wx_fmt=png"></p><p>4. Evaluate pair-wise gene associations (gene local correlations)</p><section><ul><li><li><li></ul><pre data-lang="makefile"><code><span>hs_genes = hs_results.loc[hs_results.FDR &lt; 0.05].index <span>#select informative genes</span></span></code><code><span>local_correlations = hs.compute_local_correlations(hs_genes,jobs=4) <span>#jobs for parallelization</span></span></code><code><span><span>#TheÂ outputÂ isÂ aÂ genesÂ xÂ genesÂ pandasÂ DataFrameÂ ofÂ Z-scoresÂ forÂ theÂ localÂ correlationÂ valuesÂ betweenÂ genes.Â TheÂ outputÂ isÂ alsoÂ storedÂ inÂ hs.local_correlation_z.</span></span></code></pre></section><p><span>â€</span></p><p><span>5. Group genes into modules</span><br></p><section><ul><li><li><li></ul><pre data-lang="makefile"><code><span>modules = hs.create_modules(min_gene_threshold=30,core_only=True,fdr_threshold=0.05)</span></code><code><span><span>#Visualizing correlation modules</span></span></code><code><span>hs.plot_local_correlations()</span></code></pre></section><p><img data-galleryid="" data-ratio="1.1712962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuial5bgsDBHDP4e6byXAR3icWJFjvfwUmNGpCnlibVAU8KR2WCvk1corGibg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuial5bgsDBHDP4e6byXAR3icWJFjvfwUmNGpCnlibVAU8KR2WCvk1corGibg/640?wx_fmt=png"></p><p>6. Compute summary per-cell module scores</p><section><ul><li><li></ul><pre data-lang="shell"><code><span><span>#</span>Summary per-cell score can be computed <span>for</span> a module, <span>which</span> is useful <span>for</span> visualizing the general pattern of expression <span>for</span> genes <span>in</span> a module.</span></code><code><span>module_scores = hs.calculate_module_scores()</span></code></pre></section><p><img data-galleryid="" data-ratio="0.7953703703703704" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaznkWXBpmCYu2v9DcZ5CVMGHQf0lRbMO104S81IsI9gNaOYll3Ft2bA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwKHX1wEAwOK2PrscIh5URuiaznkWXBpmCYu2v9DcZ5CVMGHQf0lRbMO104S81IsI9gNaOYll3Ft2bA/640?wx_fmt=png"></p><p>å‚è€ƒèµ„æ–™ï¼š</p><ul><li><p><span>https://doi.org/10.1016/j.cels.2021.04.005</span></p></li><li><p><span>https://github.com/yoseflab/hotspot</span></p></li><li><p><span>æƒ³è¿›ä¸€æ­¥äº†è§£è¯¥ç®—æ³•çš„åŸç†æˆ–å¸®åŠ©è¿è¡Œä»£ç è¯·ä»¥ç§ä¿¡æ–¹å¼è”ç³»å°ç¼–</span><span></span><span></span></p></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LA6hQ8ovp889enbvzFrrGw",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
