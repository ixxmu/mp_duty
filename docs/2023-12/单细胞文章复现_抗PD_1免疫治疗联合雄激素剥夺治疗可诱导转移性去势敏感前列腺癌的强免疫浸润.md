---
title: "å•ç»†èƒæ–‡ç« å¤ç°-æŠ—PD-1å…ç–«æ²»ç–—è”åˆé›„æ¿€ç´ å‰¥å¤ºæ²»ç–—å¯è¯±å¯¼è½¬ç§»æ€§å»åŠ¿æ•æ„Ÿå‰åˆ—è…ºç™Œçš„å¼ºå…ç–«æµ¸æ¶¦"
date: 2023-12-11T00:46:38Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡èœé¸Ÿå›¢"
]
categories: ["Acdemic"]
---
å•ç»†èƒæ–‡ç« å¤ç°-æŠ—PD-1å…ç–«æ²»ç–—è”åˆé›„æ¿€ç´ å‰¥å¤ºæ²»ç–—å¯è¯±å¯¼è½¬ç§»æ€§å»åŠ¿æ•æ„Ÿå‰åˆ—è…ºç™Œçš„å¼ºå…ç–«æµ¸æ¶¦ by ç”Ÿä¿¡èœé¸Ÿå›¢
------
<div><section><p>é¦–å…ˆä¸‹è½½æ•°æ®<br>https://data.mendeley.com/datasets/5nnw8xrh5m/1<br></p><figure><img data-imgfileid="100034684" data-ratio="0.2638888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXbfIuhbfQF3TP8Veg5DDIoJLhd5KRj7TsdMc7Ip0fyA4OA7MgXGPoKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXbfIuhbfQF3TP8Veg5DDIoJLhd5KRj7TsdMc7Ip0fyA4OA7MgXGPoKQ/640?wx_fmt=png&amp;from=appmsg"></figure><br>è®°å¾—å…ˆé€šè¯»å…¨æ–‡ï¼Œè™½ç„¶å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æ–¹å¼åšå‡ºæ¥ç»“æœï¼Œä½†ä¸€ä¸å°å¿ƒå°±ä¼šè®¤ä¸ºä½œè€…çš„æ ·æœ¬è¡€ç»†èƒæ±¡æŸ“ï¼Œæ³¨é‡Šæˆä¸Šçš®ç»†èƒï¼ŒpDCæ³¨é‡ŠæˆBç»†èƒã€‚ä½†å®é™…ä¸Šä½œè€…è€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨äº†å…¶ä»–çš„æ³¨é‡Šæ–¹å¼ã€‚<br>â‘ é¦–å…ˆçœ‹çœ‹æ–‡ä¸­ç›´æ¥ä½¿ç”¨åŸºå› è¡¨è¾¾æ³¨é‡Šçš„ç»†èƒç¾¤<p><br></p><pre><code>rm(list=ls())<br>options(stringsAsFactorsÂ =Â F)Â <br>library(Seurat)<br>library(ggplot2)<br>library(clustree)<br>library(cowplot)<br>library(dplyr)<br><br><span>######Â step1:å¯¼å…¥æ•°æ®Â ######Â Â Â </span><br>library(data.table)<br>scRNA=readRDS(<span>"primecut.integrated.geneexp.seurat.rds"</span>)<br>table(scRNA@meta.data$orig.ident)Â Â <span>#æŸ¥çœ‹æ¯ä¸ªæ ·æœ¬çš„ç»†èƒæ•°</span><br>head(scRNA@meta.data)<br>metaÂ =Â scRNA@meta.data<br>colnames(meta)<br>table(meta$orig.ident)<br>table(meta$patient)<br>table(meta$treatment)<br>table(meta$tissue)<br>table(meta$hpca_labels)<br>table(meta$hpca_main_labels)<br>table(meta$blueprint_labels)<br>table(meta$blueprint_main_labels)<br><br>library(ggplot2)Â <br>sce.allÂ =Â UpdateSeuratObject(objectÂ =Â scRNA)<br>table(Idents(sce.all))Â Â <br>sce.all$celltypeÂ =Â Idents(sce.all)<br><br>mycolorsÂ &lt;-c(<span>'#E5D2DD'</span>,Â <span>'#53A85F'</span>,Â <span>'#F1BB72'</span>,Â <span>'#F3B1A0'</span>,Â <span>'#D6E7A3'</span>,Â <span>'#57C3F3'</span>,Â <span>'#F7F398'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#E95C59'</span>,Â <span>'#E59CC4'</span>,Â <span>'#AB3282'</span>,Â <span>'#91D0BE'</span>,Â <span>'#BD956A'</span>,Â <span>'#8C549C'</span>,Â <span>'#585658'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#9FA3A8'</span>,Â <span>'#E0D4CA'</span>,Â <span>'#5F3D69'</span>,Â <span>'#C5DEBA'</span>,Â <span>'#58A4C3'</span>,Â <span>'#E4C755'</span>,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#AA9A59'</span>,Â <span>'#E63863'</span>,Â <span>'#E39A35'</span>,Â <span>'#C1E6F3'</span>,Â <span>'#6778AE'</span>,Â Â <span>'#B53E2B'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#712820'</span>,Â <span>'#DCC1DD'</span>,Â <span>'#CCE0F5'</span>,Â Â <span>'#CCC9E6'</span>,Â Â <span>'#68A180'</span>,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#968175'</span>)<br><br>DimPlot(sce.all,Â reductionÂ =Â <span>"umap"</span>,<span>split</span>.byÂ =Â <span>'orig.ident'</span>,<br>Â Â Â Â Â Â Â Â group.byÂ =Â <span>"celltype"</span>,labelÂ =Â T,colsÂ =Â mycolors)Â <br></code></pre><figure><img data-imgfileid="100034687" data-ratio="0.7685185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXpicRyg5ia9uME1ELgvDDVt9KMibGbUtjbvnJ029Y0JogBhB2OPNxibE2ibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXpicRyg5ia9uME1ELgvDDVt9KMibGbUtjbvnJ029Y0JogBhB2OPNxibE2ibg/640?wx_fmt=png&amp;from=appmsg"></figure><br>å¯ä»¥çœ‹åˆ°æ³¨é‡Šåˆ°ä¸€ä¸ªä¸Šçš®ç»†èƒï¼Œæ–‡ä¸­ç›´æ¥ä½¿ç”¨çš„SingleRï¼Œçœ‹çœ‹æ³¨é‡Šç»“æœæ€ä¹ˆæ ·<p><br></p><pre><code>pÂ &lt;-Â DotPlot(sce.all,Â featuresÂ =Â genes_to_check,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â assay=<span>'RNA'</span>Â ,<span>group</span>.<span>by</span>Â =Â <span>'integrated_snn_res0.8'</span>Â )Â Â +Â coord_flip()<br><br>p<br></code></pre><figure><img data-imgfileid="100034685" data-ratio="0.6398148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXnkibFYjPhRRPUHsDokHLT77cDhyDC10URSDO6RUmrBXgzZiaTlNlyysA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXnkibFYjPhRRPUHsDokHLT77cDhyDC10URSDO6RUmrBXgzZiaTlNlyysA/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code>p1Â <span>&lt;<span>-</span>Â <span>DotPlot</span>(<span>sce.all</span>,Â <span>features</span>Â =Â <span>genes_to_check,</span><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>assay</span>=<span>'RNA'</span>Â ,<span>group.by</span>Â =Â <span>'seurat_clusters'</span>Â )Â +<br>Â Â <span>coord_flip</span>()Â +<br>Â Â <span>theme</span>(<span>axis.text.x</span>Â =Â <span>element_text(angle</span>Â =Â <span>45,</span>Â <span>hjust</span>Â =Â <span>1))</span><br><br><span>p1</span><br></span></code></pre><p>æ³¨é‡Šäºšç¾¤çš„åŸºå› è¡¨è¾¾ç›¸ç¬¦<br></p><figure><img data-imgfileid="100034686" data-ratio="0.637962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXibwme9us6iblXy7F9HJrwHInhnciajCxSDqUtu8yQia33u5Y5a0O0qPvRg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXibwme9us6iblXy7F9HJrwHInhnciajCxSDqUtu8yQia33u5Y5a0O0qPvRg/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code><span>#2.çƒ­å›¾</span><br><span>#remotes::install_github(repoÂ =Â 'genecell/COSGR')</span><br>library(COSG)<br>marker_cosgÂ &lt;-Â cosg(<br>Â Â sce.all,<br>Â Â groups=<span>'all'</span>,<br>Â Â assay=<span>'RNA'</span>,<br>Â Â slot=<span>'data'</span>,<br>Â Â mu=<span>1</span>,<br>Â Â n_genes_user=<span>30</span>)<br><br>top_genesÂ &lt;-Â marker_cosg$names<br>table(geneÂ %in%Â rownames(sce.all))<br>geneÂ &lt;-Â unlist(lapply(top_genes,Â <span><span>function</span><span>(x)</span>Â <span>head</span><span>(intersect<span>(x,Â rownames<span>(sce.all)</span>)</span>,Â <span>5</span>)</span>))<br><br><span>DoHeatmap</span><span>(subset<span>(sce.all,downsample=<span>200</span>)</span>,gene,size=<span>3</span>)</span>+<span>scale_fill_gradientn</span><span>(colors=c<span>(<span>"#94C4E1"</span>,<span>"white"</span>,<span>"red"</span>)</span>)</span><br></span></code></pre><p>æ³¨é‡Šçš„è¿˜å¯ä»¥çš„ï¼Œè¯´æ˜singleRå€¼å¾—ä¸€ç”¨å‘€<br></p><figure><img data-imgfileid="100034688" data-ratio="0.6351851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXldAUMxQV2RXmwcHHKs6C2OXKarYNafyUk2fSUnIWmrJtOLDMqVwnNA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXldAUMxQV2RXmwcHHKs6C2OXKarYNafyUk2fSUnIWmrJtOLDMqVwnNA/640?wx_fmt=png&amp;from=appmsg"></figure><br>ä½†æ˜¯æ–‡ä¸­çªç„¶å°±æ¥è¿™ä¹ˆä¸€æ®µè¯ï¼ŒscRNAè¾¾ä¸åˆ°åˆ†æéœ€æ±‚ï¼Œæ‰€ä»¥ç”¨äº†VIPER(Virtual Inference of Protein-activity by Enriched Regulon analysis)ç®—æ³•ï¼Œå…è®¸åœ¨å•ä¸ªæ ·æœ¬çš„åŸºç¡€ä¸Šï¼Œ<strong>ä»åŸºå› è¡¨è¾¾è°±æ•°æ®è®¡ç®—è›‹ç™½è´¨æ´»æ€§æ¨æ–­</strong>ã€‚å®ƒåˆ©ç”¨æœ€ç›´æ¥å—ç‰¹å®šè›‹ç™½è´¨è°ƒæ§çš„åŸºå› è¡¨è¾¾ï¼Œå¦‚è½¬å½•å› å­(TF)çš„é¶æ ‡ï¼Œä½œä¸ºå…¶æ´»æ€§çš„å‡†ç¡®æ¨æ–­æ‰‹æ®µã€‚<em>å¤§ä½¬è¯´çš„å¯¹å¤§ä½¬æƒ³å’‹æ ·å°±å’‹æ ·ï¼ˆå°å£°bbï¼šä¸ä¼šæ˜¯æ­£å¸¸åˆ†æåˆ†æä¸å‡ºä»€ä¹ˆèŠ±æ¥äº†å§</em><blockquote><p>Due to high gene dropout levels, scRNA-seq analyses can typically monitor ~20% of all genes in each cell. To address this issue, we utilized an established single cell analysis pipeline,which leverages the <em>VIPER algorithm</em> to measure protein activity from single-cell gene expression data. By assessing protein activity based on the expression of 100 transcriptional targets of each protein, VIPER significantly mitigates gene dropout effects, thus allowing detection of proteins whose encoding gene is completely undetected.</p></blockquote><pre><code>rm(list=ls())<br>options(stringsAsFactorsÂ =Â F)Â <br>library(Seurat)<br>library(ggplot2)<br>library(clustree)<br>library(cowplot)<br>library(dplyr)<br><br><span>######Â step1:å¯¼å…¥æ•°æ®Â ######Â Â Â </span><br>library(data.table)<br>scRNA=readRDS(<span>"primecut.integrated.VIPER.Seurat.rds"</span>)<br>table(scRNA@meta.data$orig.ident)Â Â <span>#æŸ¥çœ‹æ¯ä¸ªæ ·æœ¬çš„ç»†èƒæ•°</span><br>head(scRNA@meta.data)<br>metaÂ =Â scRNA@meta.data<br>colnames(meta)<br>table(meta$orig.ident)<br>table(meta$patient)<br>table(meta$treatment)<br>table(meta$tissue)<br>table(meta$blueprint_labels)<br>table(meta$original_seurat_clusters)<br><br>library(ggplot2)Â <br>sce.allÂ =Â UpdateSeuratObject(objectÂ =Â scRNA)<br>table(Idents(sce.all))Â Â <br>sce.all$celltypeÂ =Â Idents(sce.all)<br><br>mycolorsÂ &lt;-c(<span>'#E5D2DD'</span>,Â <span>'#53A85F'</span>,Â <span>'#F1BB72'</span>,Â <span>'#F3B1A0'</span>,Â <span>'#D6E7A3'</span>,Â <span>'#57C3F3'</span>,Â <span>'#F7F398'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#E95C59'</span>,Â <span>'#E59CC4'</span>,Â <span>'#AB3282'</span>,Â <span>'#91D0BE'</span>,Â <span>'#BD956A'</span>,Â <span>'#8C549C'</span>,Â <span>'#585658'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#9FA3A8'</span>,Â <span>'#E0D4CA'</span>,Â <span>'#5F3D69'</span>,Â <span>'#C5DEBA'</span>,Â <span>'#58A4C3'</span>,Â <span>'#E4C755'</span>,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#AA9A59'</span>,Â <span>'#E63863'</span>,Â <span>'#E39A35'</span>,Â <span>'#C1E6F3'</span>,Â <span>'#6778AE'</span>,Â Â <span>'#B53E2B'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#712820'</span>,Â <span>'#DCC1DD'</span>,Â <span>'#CCE0F5'</span>,Â Â <span>'#CCC9E6'</span>,Â Â <span>'#68A180'</span>,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>'#968175'</span>)<br><br>DimPlot(sce.all,Â reductionÂ =Â <span>"umap"</span>,<span>split</span>.byÂ =Â <span>'orig.ident'</span>,<br>Â Â Â Â Â Â Â Â group.byÂ =Â <span>"celltype"</span>,labelÂ =Â T,colsÂ =Â mycolors)Â <br></code></pre><figure><img data-imgfileid="100034692" data-ratio="0.6398148148148148" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXiarBHu36fJgKK2APdj4AfUZG3zaNQYsWhIgzudbEn1TaRj0ibHHuITyA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXiarBHu36fJgKK2APdj4AfUZG3zaNQYsWhIgzudbEn1TaRj0ibHHuITyA/640?wx_fmt=png&amp;from=appmsg"></figure><br>SingleRä¸æä¾›è‚¿ç˜¤ç»†èƒä¸æ­£å¸¸ç»†èƒçš„åˆ†ç±»ï¼›å…·æœ‰ä¸Šçš®èµ·æºçš„è‚¿ç˜¤ç»†èƒï¼Œå¦‚å‰åˆ—è…ºç™Œç»†èƒï¼Œè¢«æ ‡è®°ä¸ºâ€œä¸Šçš®ç»†èƒâ€ã€‚æ ¹æ®å‰åˆ—è…ºè‚¿ç˜¤æ ‡å¿—ç‰©åŸºå› ï¼ˆå¦‚KLK3ï¼‰çš„è¡¨è¾¾ï¼Œä»¥åŠä½¿ç”¨æ·‹å·´ç»†èƒå’Œé«“ç³»ç»†èƒä½œä¸ºæ‹·è´æ•°æ­£å¸¸å‚è€ƒçš„æ¨æ–­æ‹·è´æ•°å˜å¼‚åˆ†æï¼Œç¡®è®¤ä¸‰ç¾¤ä¸Šçš®ç»†èƒå‡ä¸ºè‚¿ç˜¤ç»†èƒã€‚<br><figure><img data-imgfileid="100034689" data-ratio="0.23580786026200873" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXVbTuGfYliaAAlF7COU0eXIvXmiaBLGhYTR2hHUTnBhMNE4K8X5lwmImw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="916" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXVbTuGfYliaAAlF7COU0eXIvXmiaBLGhYTR2hHUTnBhMNE4K8X5lwmImw/640?wx_fmt=png&amp;from=appmsg"></figure><br>çœŸçš„å‡çš„ï¼Œæˆ‘ä¸‹è½½ä½œè€…æä¾›çš„Rdataï¼Œè¿™åŸºå› ç«Ÿç„¶æ²¡æœ‰ã€‚<br>æˆ‘å¾ˆè¿·ï¼Œæ–‡ä¸­è‡ªå¸¦çš„å¤„ç†æ•°æ®çš„ä»£ç å’Œæ–‡çŒ®è¡¨æ ¼å¯¹ä¸ä¸Šã€‚<br><figure><img data-imgfileid="100034690" data-ratio="0.32592592592592595" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXNVBmsqicib8RXj3MH3N4wfPEZ12yIpCt8nOxljBRd2k8kxhib064DQTGQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXNVBmsqicib8RXj3MH3N4wfPEZ12yIpCt8nOxljBRd2k8kxhib064DQTGQ/640?wx_fmt=png&amp;from=appmsg"></figure><br><figure><img data-imgfileid="100034691" data-ratio="0.45092592592592595" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXVSwuhNfLkrnMCkJXdwDH3MSTKC2aKXXpqrxCRBE15oibs7Hib2Oa6MfA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXVSwuhNfLkrnMCkJXdwDH3MSTKC2aKXXpqrxCRBE15oibs7Hib2Oa6MfA/640?wx_fmt=png&amp;from=appmsg"></figure><br>æˆ‘è¿™é‡Œçš„å¤„ç†æ˜¯æ–‡ä¸­æä¾›çš„æ•°æ®ï¼Œä¹Ÿå¾—ä¸åˆ°æ–‡ä¸­çš„ç»“æœğŸ˜‚æ¯”ä¾‹å›¾è¿™ç§å®Œå…¨ä¸éœ€è¦æ”¹å˜çš„ä¹Ÿå¯¹ä¸ä¸Šã€‚åŸæ–‡åŸºçº¿æœŸ3ä¸ªæ‚£è€…éª¨è½¬ç§»ï¼Œ2ä¸ªæ‚£è€…è‚è½¬ç§»ï¼Œ2ä¸ªæ‚£è€…æ·‹å·´ç»“è½¬ç§»ï¼Œ1ä¸ªæ‚£è€…è‚ºè½¬ç§»ã€‚<br><figure><img data-imgfileid="100034693" data-ratio="0.7350597609561753" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXLYDmbpMOgThwAboy1yyLH9sTHTWKXb7sqn7ib4sWRBbUoa3ZSxJowkA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1004" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXLYDmbpMOgThwAboy1yyLH9sTHTWKXb7sqn7ib4sWRBbUoa3ZSxJowkA/640?wx_fmt=png&amp;from=appmsg"></figure><br>æ–‡ä¸­æä¾›çš„æ•°æ®ç­›é€‰åŸºçº¿æœŸ<p><br></p><pre><code>table(sce.all$treatment)<br>sceÂ =Â sce.all<br><br>library(tidyr)<br>library(reshape2)<br>colnames(meta)<br>table(sce$patient)<br>table(sce$tissue)<br>table(sce$tissue,Â sce$patient)<br>metaÂ =Â sce@meta.data<br>colnames(meta)<br>table(meta$orig.ident)<br>table(meta$patient)<br>table(meta$treatment)<br>table(meta$tissue)<br>table(meta$blueprint_labels)<br>table(meta$original_seurat_clusters)<br><br>sce$intecelltypeÂ =Â <span>'NA'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'CD4Â T-cellÂ 1'</span>,<span>'CD4Â T-cellÂ 2'</span>)Â ]Â =Â <span>'CD4nonTreg'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'CD4Â T-cellÂ 1'</span>,<span>'CD4Â T-cellÂ 2'</span>)Â ]Â =Â <span>'CD4nonTreg'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'CD8Â T-cellÂ 1'</span>,Â Â Â <span>'CD8Â T-cellÂ 2'</span>,Â Â <span>'CD8Â T-cellÂ 3'</span>)Â ]Â =Â <span>'CD8'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'B-cellsÂ 1'</span>,Â <span>'B-cellsÂ 2'</span>,<span>'B-cellsÂ 3'</span>,<span>'B-cellsÂ 4'</span>,<span>'B-cellsÂ 5'</span>,<span>'PlasmaÂ cells'</span>)Â ]Â =Â <span>'B-cell'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'TregÂ 3'</span>,<span>'TregÂ 2'</span>,<span>'TregÂ 1'</span>)Â ]Â =Â <span>'Treg'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'EpithelialÂ 3'</span>,<span>'EpithelialÂ 2'</span>,<span>'EpithelialÂ 1'</span>)Â ]Â =Â <span>'Tumor'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'Endothelial'</span>)Â ]Â =Â <span>'Endothelial'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'ErythrocytesÂ 1'</span>)Â ]Â =Â <span>'Erythrocytes'</span><br>sce$intecelltype[sce$celltypeÂ %in%Â c(<span>'MonocytesÂ 1'</span>,Â <span>'MonocytesÂ 2'</span>,Â <span>'Macrophages'</span>,Â <span>'MonocytesÂ 3'</span>,<span>'Neutrophils'</span>)Â ]Â =Â <span>'Myeloid'</span><br>table(sce$intecelltype)<br><br>sce_preÂ =Â sce[,Â sce$treatmentÂ %in%Â c(Â <span>"Pre-Treatment"</span>Â )]<br>table(sce_pre$tissue,Â sce_pre$patient)<br></code></pre><p>å°±å¾—åˆ°äº†åŸºçº¿æœŸ3ä¸ªæ‚£è€…éª¨è½¬ç§»ï¼Œ2ä¸ªæ‚£è€…è‚è½¬ç§»ï¼Œ3ä¸ªæ‚£è€…æ·‹å·´ç»“è½¬ç§»ï¼Œ1ä¸ªæ‚£è€…è‚ºè½¬ç§»ã€‚ä¸ºä»€ä¹ˆä¼šå¤šå‡ºæ¥ä¸€ä¸ªæ‚£è€…ï¼Œæ˜æ˜æ–‡ä¸­ä¹Ÿå†™çš„æ˜¯8ä¸ªåŸºçº¿æœŸæ‚£è€…ï¼Œæˆ‘å“ªé‡Œå‡ºäº†é—®é¢˜<br></p><figure><img data-imgfileid="100034694" data-ratio="0.15555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXicrEFI4NBVKkk7lYwic9etibYwk5hCNbG9caUiaEPuBkyKoEF70yiavGD1g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXicrEFI4NBVKkk7lYwic9etibYwk5hCNbG9caUiaEPuBkyKoEF70yiavGD1g/640?wx_fmt=png&amp;from=appmsg"></figure><br><figure><img data-imgfileid="100034696" data-ratio="0.37222222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXXjBicAfKyUX8zN4qlIkGHERgKkZjiclENuibypFCdj0XJOQPoBS70QpAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXXjBicAfKyUX8zN4qlIkGHERgKkZjiclENuibypFCdj0XJOQPoBS70QpAQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code>sce_pre$groupÂ =Â <span>'NA'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Bone'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient1'</span>]Â =Â <span>'Bone1'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Bone'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient3'</span>]Â =Â <span>'Bone2'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Bone'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient8'</span>]Â =Â <span>'Bone3'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Liver'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient13'</span>]Â =Â <span>'Liver1'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Liver'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient14'</span>]Â =Â <span>'Liver2'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'LN'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient10'</span>]Â =Â <span>'LN1'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'LN'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient11'</span>]Â =Â <span>'LN2'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'LN'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient5'</span>]Â =Â <span>'LN3'</span><br>sce_pre$group[sce_pre$tissueÂ ==Â <span>'Lung'</span>&amp;sce_pre$patientÂ ==Â <span>'Patient7'</span>]Â =Â <span>'Lung'</span><br>table(sce_pre$group)<br><br>tb=table(sce_pre$group,Â sce_pre$intecelltype)<br>head(tb)<br>libraryÂ (gplots)Â <br>balloonplot(tb)<br>bar_dataÂ &lt;-Â as.data.frame(tb)<br><br>bar_perÂ &lt;-Â bar_dataÂ %&gt;%Â <br>Â Â group_by(Var1)Â %&gt;%<br>Â Â mutate(sum(Freq))Â %&gt;%<br>Â Â mutate(percentÂ =Â FreqÂ /Â <span>`sum(Freq)`</span>)<br>head(bar_per)Â <br>colÂ =c(<span>"#3176B7"</span>,<span>"#F78000"</span>,<span>"#3FA116"</span>,<span>"#CE2820"</span>,<span>"#9265C1"</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>"#885649"</span>,<span>"#DD76C5"</span>,<span>"#BBBE00"</span>,<span>"#41BED1"</span>)<br>colnames(bar_per)<br><br>p2Â =Â ggplot(bar_per,Â aes(<span>x</span>Â =Â percent,Â <span>y</span>Â =Â Var1))Â +<br>Â Â geom_bar(aes(fillÂ =Â Var2)Â ,Â <span>stat</span>Â =Â <span>"identity"</span>)Â +Â coord_flip()Â +<br>Â Â theme(axis.ticksÂ =Â element_line(linetypeÂ =Â <span>"blank"</span>),<br>Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"top"</span>,<br>Â Â Â Â Â Â Â Â panel.grid.minorÂ =Â element_line(colourÂ =Â NA,linetypeÂ =Â <span>"blank"</span>),Â <br>Â Â Â Â Â Â Â Â panel.backgroundÂ =Â element_rect(fillÂ =Â NA),<br>Â Â Â Â Â Â Â Â plot.backgroundÂ =Â element_rect(colourÂ =Â NA))Â +<br>Â Â labs(<span>y</span>Â =Â <span>"Â "</span>,Â fillÂ =Â NULL)+labs(<span>x</span>Â =Â <span>'RelativeÂ proportion(%)'</span>)+<br>Â Â scale_fill_manual(<span>values</span>=col)+<br>Â Â theme_classic()+<br>Â Â theme(plot.titleÂ =Â element_text(size=<span>12</span>,hjust=<span>0</span>.<span>5</span>))<br><br>p2<br></code></pre><p>å°†æœ€åˆçš„24ä¸ªVIPERç»†èƒç¾¤åˆå¹¶æˆ8ä¸ªç»†èƒç¾¤ã€‚è‚ºæ ·æœ¬çš„åŸºçº¿æ´»æ£€ä¸»è¦ç”±è‚¿ç˜¤ç»†èƒç»„æˆã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œéª¨ã€è‚å’Œè‚ºåŸºçº¿æ´»æ£€æ ·æœ¬å«æœ‰æ›´å¤§æ¯”ä¾‹çš„å…ç–«ç»†èƒã€‚<br></p><figure><img data-imgfileid="100034697" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXJgf0uuXcuia0fF4Q10coTfXyL3YicYeGtljnibu6I1Gdib61TlHG9YPgWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXJgf0uuXcuia0fF4Q10coTfXyL3YicYeGtljnibu6I1Gdib61TlHG9YPgWg/640?wx_fmt=png&amp;from=appmsg"><figcaption>image.png</figcaption></figure><pre><code><span>####åˆ†ç»„ç®±çº¿å›¾</span><br>tb=table(sce_pre$group,Â sce_pre$celltype)<br>head(tb)<br>libraryÂ (gplots)Â <br>balloonplot(tb)<br>bar_dataÂ &lt;-Â as.data.frame(tb)<br><br>bar_perÂ &lt;-Â bar_dataÂ %&gt;%Â <br>Â Â group_by(Var1)Â %&gt;%<br>Â Â mutate(sum(Freq))Â %&gt;%<br>Â Â mutate(percentÂ =Â FreqÂ /Â <span>`sum(Freq)`</span>)<br>head(bar_per)Â <br><br>bar_per$groupÂ =Â <span>'NA'</span><br>bar_per$group[str_detect(bar_per$Var1,<span>'Bone'</span>)]Â =Â <span>'Bone'</span><br>bar_per$group[str_detect(bar_per$Var1,<span>'Liver'</span>)]Â =Â <span>'Liver'</span><br>bar_per$group[str_detect(bar_per$Var1,<span>'LN'</span>)]Â =Â <span>'LN'</span><br>bar_per$group[str_detect(bar_per$Var1,<span>'Lung'</span>)]Â =Â <span>'Lung'</span><br>table(bar_per$group)<br><br><br>ggplot(bar_per,Â aes(<span>x</span>Â =Â Var2,Â <span>y</span>Â =Â percent))+Â <br>Â Â labs(<span>y</span>=<span>"CellÂ Proportion"</span>,Â <span>x</span>Â =Â Â NULL)+Â Â <br>Â Â geom_boxplot(aes(fillÂ =Â group),Â positionÂ =Â position_dodge(<span>0</span>.<span>5</span>),Â widthÂ =Â <span>0</span>.<span>5</span>,Â outlier.alphaÂ =Â <span>0</span>)+Â <br>Â Â scale_fill_manual(<span>values</span>Â =Â c(Â <span>"#3176B7"</span>,<span>"#F78000"</span>,<span>"#3FA116"</span>,<span>"#CE2820"</span>))Â +<br>Â Â theme_bw()Â +Â <br>Â Â theme(plot.titleÂ =Â element_text(sizeÂ =Â <span>12</span>,color=<span>"black"</span>,hjustÂ =Â <span>0</span>.<span>5</span>),Â <br>Â Â Â Â Â Â Â Â axis.text.xÂ =Â element_text(angleÂ =Â <span>45</span>,Â hjustÂ =Â <span>1</span>Â ),<br>Â Â Â Â Â Â Â Â panel.gridÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"top"</span>,<br>Â Â Â Â Â Â Â Â legend.textÂ =Â element_text(size=Â <span>12</span>),<br>Â Â Â Â Â Â Â Â legend.title=Â element_text(size=Â <span>12</span>))Â +Â <br>Â Â guides(fill=guide_legend(titleÂ =Â <span>"Tissue"</span>))<br></code></pre><p>åœ¨éª¨è½¬ç§»ä¸­ï¼Œæµ†ç»†èƒç›¸å¯¹äºå…¶ä»–éƒ¨ä½é«˜åº¦å¯Œé›†ï¼Œå•æ ¸ç»†èƒ1å’Œ2äºšå‹çš„è¡¨è¾¾å¢åŠ ã€‚åœ¨æ‰€æœ‰ç»„ç»‡ä¸­ï¼ŒCD8 Tç»†èƒå’Œå¸¸è§„ï¼ˆéTregï¼‰CD4ç»†èƒå å¾ˆå¤§æ¯”ä¾‹ã€‚<br></p><figure><img data-imgfileid="100034695" data-ratio="0.4564814814814815" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXb49iaqGWBKsDmDw0HJy52400qkJibh04nTRzpP6498oFD8UGnwn29hVA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXb49iaqGWBKsDmDw0HJy52400qkJibh04nTRzpP6498oFD8UGnwn29hVA/640?wx_fmt=png&amp;from=appmsg"></figure>æ¥ä¸‹æ¥çœ‹çœ‹ä¸åŒç»„ç»‡æ¥æºçš„æ ·æœ¬å’Œä¸åŒæ²»ç–—é˜¶æ®µæ ·æœ¬çš„ç»†èƒäºšç¾¤å·®å¼‚<p><br></p><pre><code>table(sce$treatment)<br>table(sce$tissue)<br>table(sce$intecelltype)<br>sce_boneÂ =Â sce[,Â sce$tissueÂ %in%Â c(Â <span>"Bone"</span>Â )]<br>sce_LiverÂ =Â sce[,Â sce$tissueÂ %in%Â c(Â <span>"Liver"</span>Â )]<br>sce_LNÂ =Â sce[,Â sce$tissueÂ %in%Â c(Â <span>"LN"</span>Â )]<br>sce_LungÂ =Â sce[,Â sce$tissueÂ %in%Â c(Â <span>"Lung"</span>Â )]<br><br>DimPlot(sce_bone,Â reductionÂ =Â <span>"umap"</span>,Â <span>split</span>.byÂ =Â <span>'treatment'</span>,Â group.byÂ =Â <span>"celltype"</span>,Â labelÂ =Â T,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â colsÂ =Â mycolors)<br></code></pre><figure><img data-imgfileid="100034698" data-ratio="0.5185185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXjicmFAFFU2D4BpjoqGeu2PR0wXCkzVCzDtibiaOtzLnUbFDkibuADFMhew/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXjicmFAFFU2D4BpjoqGeu2PR0wXCkzVCzDtibiaOtzLnUbFDkibuADFMhew/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code><span>##å †ç§¯æŸ±çŠ¶å›¾</span><br>poplotÂ =Â <span><span>function</span><span>(sce,title)</span></span>{<br><br>Â Â table(sce$treatment)<br>Â Â tb=table(sce$treatment,Â sce$intecelltype)<br>Â Â head(tb)<br>Â Â libraryÂ (gplots)Â <br>Â Â balloonplot(tb)<br>Â Â bar_dataÂ &lt;-Â <span>as</span>.data.frame(tb)<br><br>Â Â bar_perÂ &lt;-Â bar_dataÂ %&gt;%Â <br>Â Â Â Â group_by(Var1)Â %&gt;%<br>Â Â Â Â mutate(sum(Freq))Â %&gt;%<br>Â Â Â Â mutate(percentÂ =Â FreqÂ /Â `sum(Freq)`)<br>Â Â head(bar_per)Â <br>Â Â bar_perÂ =Â na.omit(bar_per)<br>Â Â colÂ =c(<span>"#3176B7"</span>,<span>"#F78000"</span>,<span>"#3FA116"</span>,<span>"#CE2820"</span>,<span>"#9265C1"</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>"#885649"</span>,<span>"#DD76C5"</span>,<span>"#BBBE00"</span>,<span>"#41BED1"</span>)<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â colnames(bar_per)<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â p2Â =Â ggplot(bar_per,Â aes(xÂ =Â percent,Â yÂ =Â Var1))Â +<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â geom_bar(aes(fillÂ =Â Var2)Â ,Â statÂ =Â <span>"identity"</span>)Â +Â coord_flip()Â +<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â theme(axis.ticksÂ =Â element_line(linetypeÂ =Â <span>"blank"</span>),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"top"</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â panel.grid.minorÂ =Â element_line(colourÂ =Â NA,linetypeÂ =Â <span>"blank"</span>),Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â panel.backgroundÂ =Â element_rect(fillÂ =Â NA),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â plot.backgroundÂ =Â element_rect(colourÂ =Â NA))Â +<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â labs(yÂ =Â <span>"Â "</span>,Â fillÂ =Â <span>NULL</span>)+labs(xÂ =Â <span>'RelativeÂ proportion(%)'</span>)+<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â scale_fill_manual(values=col)+<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â theme_classic()+<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ggtitle(title)Â +<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â theme(plot.titleÂ =Â element_text(size=<span>20</span>,hjust=<span>0.5</span>))<br><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â p2<br><br><br>}<br>poplot(sce_bone,<span>'Bone'</span>)<br></code></pre><p>åœ¨éª¨è½¬ç§»ä¸­ï¼ŒADTè¯±å¯¼é«“ç³»ç»†èƒå¢åŠ ï¼ŒCD4 Tç»†èƒä»¥åŠè‚¿ç˜¤ç»†èƒå‡å°‘ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒADT+aPD-1é™ä½äº†é«“ç³»ç»†èƒï¼ŒåŒæ—¶å¢åŠ äº†CD8 Tç»†èƒï¼Œä½†æ˜¯è‚¿ç˜¤ç»†èƒç«Ÿç„¶ä¹Ÿå˜å¤šäº†ã€‚<br></p><figure><img data-imgfileid="100034701" data-ratio="0.6555555555555556" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXIKHD0WQCB0VV5AwTgjSVjqVQJwsE9dDhqc1iaW7XeK7jIo3NwtWicbdg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXIKHD0WQCB0VV5AwTgjSVjqVQJwsE9dDhqc1iaW7XeK7jIo3NwtWicbdg/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code><span>###è‚</span><br>DimPlot(sce_Liver,Â reductionÂ =Â <span>"umap"</span>,Â split.<span>by</span>Â =Â <span>'treatment'</span>,Â <span>group</span>.<span>by</span>Â =Â <span>"celltype"</span>,Â labelÂ =Â T,Â <br>Â Â Â Â Â Â Â Â colsÂ =Â mycolors)<br></code></pre><figure><img data-imgfileid="100034702" data-ratio="0.5703703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXXPdZFbanlbb63waP1DG0GUMZMGrzmqTbBqHLqrPDalMsscIGBiaptuQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXXPdZFbanlbb63waP1DG0GUMZMGrzmqTbBqHLqrPDalMsscIGBiaptuQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code>poplot(sce_Liver,<span>'Liver'</span>)<br></code></pre><p>å†…è„ï¼ˆè‚è„å’Œè‚ºï¼‰çš„è”åˆæ²»ç–—åè‚¿ç˜¤ç»†èƒç»„æˆæ˜¾è‘—å‡å°‘ï¼Œé«“ç³»å‡ ä¹æ²¡æœ‰å˜åŒ–ï¼ŒCD8 Tç»†èƒæ˜¾è‘—å¢åŠ ã€‚<br></p><figure><img data-imgfileid="100034700" data-ratio="0.9287037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yX4BtZcuUJJt15wHd4w7aotIibpwphRLXnJhG3O3favO9gKycXZsoormw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yX4BtZcuUJJt15wHd4w7aotIibpwphRLXnJhG3O3favO9gKycXZsoormw/640?wx_fmt=png&amp;from=appmsg"></figure><pre><code><span>#Â ###è‚º</span><br><span>#Â DimPlot(sce_Lung,Â reductionÂ =Â "umap",Â split.byÂ =Â 'treatment',Â group.byÂ =Â "celltype",Â labelÂ =Â T,Â </span><br><span>#Â Â Â Â Â Â Â Â Â colsÂ =Â mycolors)</span><br><span>#Â </span><br><span>#Â poplot(sce_Lung,'Lung')</span><br><br><br><span>###æ·‹å·´ç»“</span><br>DimPlot(sce_LN,Â reductionÂ =Â <span>"umap"</span>,Â split.<span>by</span>Â =Â <span>'treatment'</span>,Â <span>group</span>.<span>by</span>Â =Â <span>"celltype"</span>,Â labelÂ =Â T,Â <br>Â Â Â Â Â Â Â Â colsÂ =Â mycolors)<br><br>poplot(sce_LN,<span>'LN'</span>)<br></code></pre><figure><img data-imgfileid="100034699" data-ratio="0.9259259259259259" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXu1lic0OaAkyy7WibgKk86GM37SMdPP2xGbEsjIRtYNGhSibngPrjPukgQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="image.png" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8ib7fQg0RibY1P1bmQFlk0yXu1lic0OaAkyy7WibgKk86GM37SMdPP2xGbEsjIRtYNGhSibngPrjPukgQ/640?wx_fmt=png&amp;from=appmsg"></figure><br><strong>å½“ä¸ADTè”åˆä½¿ç”¨æ—¶ï¼ŒæŠ—PD-1å¢åŠ äº†CD8 Tç»†èƒæµ¸æ¶¦åˆ°è½¬ç§»éƒ¨ä½çš„ç¨‹åº¦(éª¨ã€è‚å’Œè‚ºè½¬ç§»æ˜¯è¿™æ ·çš„è¶‹åŠ¿)ï¼Œè€Œå•ç‹¬ä½¿ç”¨ ADTæ—¶æ— æ³•è§‚å¯Ÿåˆ°ã€‚</strong><p><br></p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NZXZvBgTrDBy4Sg9Abjnkg",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
