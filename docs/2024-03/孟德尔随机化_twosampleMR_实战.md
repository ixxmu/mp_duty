---
title: "å­Ÿå¾·å°”éšæœºåŒ–ï¼štwosampleMR å®æˆ˜"
date: 2024-03-11T01:34:33Z
draft: ["false"]
tags: [
  "fetched",
  "åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°"
]
categories: ["Acdemic"]
---
å­Ÿå¾·å°”éšæœºåŒ–ï¼štwosampleMR å®æˆ˜ by åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°
------
<div><section><span>å…³æ³¨å…¬ä¼—å·ï¼Œå‘é€</span><strong>Rè¯­è¨€</strong><span>æˆ–</span><strong>python</strong><span>ï¼Œå¯è·å–èµ„æ–™</span><span></span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzUzOTQzNzU0NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YDc8IDhqWAHTrZsMuhDpFlw4scqOl1ZVWpeY77cdibaSzPeGALfkEhdVpwHzVibHCRSYZg4csB43g/0?wx_fmt=png" data-nickname="åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°" data-alias="yxhsxbj" data-signature="å¤–ç§‘åŒ»ç”ŸğŸ‘¨â€âš•ï¸çš„Rè¯­è¨€å’Œç”Ÿä¿¡å­¦ä¹ ğŸ”–" data-from="2" data-weuitheme="light"></mp-common-profile></section><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer"><section data-role="outer" label="edit by 135editor"><section data-tools="135ç¼–è¾‘å™¨" data-id="28"><p data-brushtype="text" hm_fix="440:185"><span>ğŸ’¡ä¸“æ³¨Rè¯­è¨€åœ¨ğŸ©ºç”Ÿç‰©åŒ»å­¦ä¸­çš„ä½¿ç”¨</span></p></section></section></section></section></section><hr><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><span><span>è®¾ä¸ºâ€œ</span><strong><span>æ˜Ÿæ ‡</span></strong><span>â€ï¼Œç²¾å½©ä¸é”™è¿‡</span></span><br></p><hr><p data-tool="mdniceç¼–è¾‘å™¨"><span><strong></strong></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨">ä¸¤æ ·æœ¬å­Ÿå¾·å°”éšæœºåŒ–ä¸“ç”¨RåŒ…<code>TwoSampleMR</code>ï¼Œå¯ä»¥å’Œ IEU open GWAS æ•°æ®åº“æ— ç¼è¿æ¥ï¼Œå¯é€šè¿‡åœ¨çº¿çš„æ–¹å¼ç›´æ¥æŸ¥è¯¢æ•°æ®åº“èµ„æºï¼Œå¹¶å®ç°åˆ†æã€ä¸‹è½½ç­‰åŠŸèƒ½ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æœ¬åœ°æ•°æ®è¿›è¡ŒMRåˆ†æï¼Œæ˜¯ç›®å‰ç”¨çš„æœ€å¤šçš„MRåˆ†æRåŒ…ï¼Œåªè¦ä½ åšMRåˆ†æï¼ŒåŸºæœ¬ä¸Šä¸å¯èƒ½ç»•è¿‡è¿™ä¸ªåŒ…ã€‚æ‰€ä»¥æˆ‘è®¤çœŸå­¦ä¹ äº†å®ƒçš„å®˜æ–¹æ–‡æ¡£ï¼Œæ•´ç†ä¸‹åˆ†äº«ç»™å¤§å®¶~</p><p data-tool="mdniceç¼–è¾‘å™¨">æœ¬æ–‡ç›®å½•ï¼š</p><ul><li><p>å®‰è£…</p></li><li><p>overview</p></li><li><p>åŸºç¡€ä½¿ç”¨</p></li><li><p>æ•æ„Ÿæ€§åˆ†æ</p></li><li><p>Steigeræ–¹å‘æ€§æ£€éªŒ</p></li><li><p>1-to-many forest plot</p></li><ul><li><p>ä¾‹1</p></li><li><p>ä¾‹2</p></li></ul><li><p>å¤šå˜é‡MRï¼ˆMVMRï¼‰</p></li><li><p>MR-MoE</p></li><li><p>æ•´åˆæ‰€æœ‰ç»“æœ</p></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><br></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å®‰è£…</span><span></span></h2><pre data-tool="mdniceç¼–è¾‘å™¨"><code>remotes::install_github("MRCIEU/TwoSampleMR")<br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>overview</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">ä½¿ç”¨<code>TwoSampleMR</code>è¿›è¡ŒMRåˆ†æä¸»è¦å°±æ˜¯4æ­¥ï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨"><li><section>ä¸ºæš´éœ²å› ç´ é€‰æ‹©åˆé€‚çš„å·¥å…·å˜é‡ï¼ˆå¿…è¦æ—¶è¿›è¡Œè¿é”ä¸å¹³è¡¡çš„è¿‡æ»¤ï¼‰</section></li><li><section>å¯¹æ„Ÿå…´è¶£çš„ç»“å±€æå–å·¥å…·å˜é‡</section></li><li><section>ç»Ÿä¸€æš´éœ²å› ç´ å’Œç»“å±€çš„æ•°æ®ï¼Œä½¿å¾—reference alleleä¿æŒä¸€è‡´</section></li><li><section>è¿›è¡ŒMRåˆ†æã€æ•æ„Ÿæ€§åˆ†æã€å¯è§†åŒ–</section></li></ol><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017481" data-ratio="1.1858304297328688" data-type="png" data-w="861" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich957n4vJG38T0tAeycVdibTxpiaiabveSS7EZCCuLMAbibqu3cTBlFhuf5g/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich957n4vJG38T0tAeycVdibTxpiaiabveSS7EZCCuLMAbibqu3cTBlFhuf5g/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>åŸºç¡€ä½¿ç”¨</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">ç›´æ¥ä½¿ç”¨IEUçš„APIï¼Œä½¿ç”¨åœ¨çº¿çš„æ–¹å¼æŸ¥è¯¢ã€åˆ†æã€æå–IEU open GWAS æ•°æ®åº“ä¸­çš„å·¥å…·å˜é‡ã€‚è¿™ä¸ªåŠŸèƒ½å…¶å®æ˜¯å€ŸåŠ©<code>ieugwasr</code>å®ç°çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">é¦–å…ˆæˆ‘ä»¬è¦é€‰æ‹©åˆé€‚çš„æš´éœ²å› ç´ å’Œç»“å±€ï¼Œæš´éœ²å› ç´ æˆ‘è¿™é‡Œé€‰çš„æ˜¯BMIï¼ˆbody mass indexï¼‰ï¼Œç»“å±€é€‰çš„æ˜¯CHDï¼ˆå† å¿ƒç—…ï¼‰ã€‚ä¹Ÿå°±æ˜¯æˆ‘æƒ³ç ”ç©¶BMIå¯¹å† å¿ƒç—…çš„å› æœå…³ç³»ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">BMIåœ¨IEU open GWAS æ•°æ®åº“ä¸­çš„IDæ˜¯<code>ieu-a-2</code>ï¼ŒCHDçš„IDæ˜¯<code>ieu-a-7</code>ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017482" data-ratio="0.5203703703703704" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichgYSec2N4yWia0oakuxj0z738Cd4XQMbEJ6UVzlP8ha0DibWicAWzZK6ug/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichgYSec2N4yWia0oakuxj0z738Cd4XQMbEJ6UVzlP8ha0DibWicAWzZK6ug/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100017483" data-ratio="0.5203703703703704" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichN65UEtkKxImp6zQ5bqpLiaMM6X7mwJwdoKtCtxkQDhhLlBnMArlZtoQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichN65UEtkKxImp6zQ5bqpLiaMM6X7mwJwdoKtCtxkQDhhLlBnMArlZtoQ/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdniceç¼–è¾‘å™¨">é€‰å¥½ä¹‹åï¼Œå°±æ˜¯ç”¨ä»£ç æŸ¥è¯¢æš´éœ²å’Œç»“å±€ç›¸å…³çš„SNPã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨æå–æš´éœ²å› ç´ ç›¸å…³çš„å·¥å…·å˜é‡æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œ<strong>å»é™¤è¿é”ä¸å¹³è¡¡çš„SNP</strong>ï¼Œç”±äºè¿™ä¸€æ­¥æ˜¯åœ¨çº¿è¿›è¡Œçš„ï¼Œéœ€è¦è”ç½‘ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥å¯¹ç½‘ç»œæœ‰è¦æ±‚ï¼Œæœ‰å¯èƒ½ä¼šç»å¸¸å¤±è´¥ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°è¿›è¡Œå¤„ç†ï¼ˆä¸‹æ¬¡å†è®²ï¼‰ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ä¸€æ ·çš„ç»“æœã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æå–ç»“å±€ç›¸å…³çš„SNPè¿™ä¸€æ­¥ä¹Ÿæ˜¯åœ¨çº¿è¿›è¡Œçš„ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šå¤±è´¥ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨"><code>harmonise_data</code>è¿™ä¸€æ­¥æ˜¯å¿…é¡»çš„ï¼Œä»¥ç¡®ä¿æš´éœ²å’Œç»“å±€çš„SNPçš„æ•ˆåº”ç­‰ä½åŸºå› æ˜¯ä¸€æ ·çš„ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>library(TwoSampleMR)<br><br># Registered S3 method overwritten by 'data.table':<br>#   method           from<br># print.data.table     <br># TwoSampleMR version 0.5.8 <br># [&gt;] New: Option to use non-European LD reference panels for clumping etc<br># [&gt;] Some studies temporarily quarantined to verify effect allele<br># [&gt;] See news(package='TwoSampleMR') and https://gwas.mrcieu.ac.uk for further details<br><br># List available GWASs<br>#ao &lt;- available_outcomes()<br><br># æå–æš´éœ²ç›¸å…³çš„SNP<br>exposure_dat &lt;- extract_instruments("ieu-a-2", access_token = NULL)<br><br># API: public: http://gwas-api.mrcieu.ac.uk/<br>#save(exposure_dat,file = "./ieu/exposure_data_ieu-a-2.rdata")<br><br># æå–ç»“å±€ç›¸å…³çš„SNP<br>outcome_dat &lt;- extract_outcome_data(snps=exposure_dat$SNP, <br>                                    outcomes = "ieu-a-7",<br>                                    access_token = NULL)<br><br># Extracting data for 79 SNP(s) from 1 GWAS(s)<br>#save(outcome_dat, file = "./ieu/outcome_data_ieu-a-7.rdata")<br><br># ç»Ÿä¸€æ•°æ®<br>dat &lt;- harmonise_data(exposure_dat, outcome_dat)<br><br># Harmonising Body mass index || id:ieu-a-2 (ieu-a-2) <br># and Coronary heart disease || id:ieu-a-7 (ieu-a-7)<br><br># è¿›è¡ŒMRåˆ†æ<br>res &lt;- mr(dat)<br><br># Analysing 'ieu-a-2' on 'ieu-a-7'<br><br>res<br><br># id.exposure id.outcome                              outcome<br># 1     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7<br># 2     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7<br># 3     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7<br># 4     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7<br># 5     ieu-a-2    ieu-a-7 Coronary heart disease || id:ieu-a-7<br># exposure                    method nsnp<br># 1 Body mass index || id:ieu-a-2                  MR Egger   79<br># 2 Body mass index || id:ieu-a-2           Weighted median   79<br># 3 Body mass index || id:ieu-a-2 Inverse variance weighted   79<br># 4 Body mass index || id:ieu-a-2               Simple mode   79<br># 5 Body mass index || id:ieu-a-2             Weighted mode   79<br># b         se         pval<br># 1 0.5024935 0.14396056 8.012590e-04<br># 2 0.3870065 0.07111020 5.258272e-08<br># 3 0.4459091 0.05898302 4.032020e-14<br># 4 0.3401554 0.15985362 3.650217e-02<br># 5 0.3888249 0.10593531 4.412728e-04<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»“æœä¸­ç»™å‡ºäº†ï¼š</p><ul data-tool="mdniceç¼–è¾‘å™¨"><li><section><code>method</code>:ä½¿ç”¨çš„å› æœæ•ˆåº”ä¼°è®¡æ–¹æ³•</section></li><li><section><code>nsnp</code>:SNPçš„æ•°é‡</section></li><li><section><code>b</code>:æš´éœ²å› ç´ å¯¹ç»“å±€çš„æ•ˆåº”é‡</section></li><li><section><code>se</code>:æ•ˆåº”é‡çš„æ ‡å‡†å·®</section></li><li><section><code>pval</code>:MRåˆ†æçš„På€¼ï¼Œå°äº0.05è¯´æ˜æœ‰å› æœå…³ç³»ã€‚</section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨">è¿˜å¯ä»¥è®¡ç®—ORå€¼å’Œå¯ä¿¡åŒºé—´ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>generate_odds_ratios(res)<br><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outcome</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 2Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 3Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 4Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 5Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â exposureÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodÂ nsnp</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MRÂ EggerÂ Â Â 79</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â WeightedÂ medianÂ Â Â 79</span><br><span>#Â 3Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â InverseÂ varianceÂ weightedÂ Â Â 79</span><br><span>#Â 4Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SimpleÂ modeÂ Â Â 79</span><br><span>#Â 5Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â WeightedÂ modeÂ Â Â 79</span><br><span>#Â bÂ Â Â Â Â Â Â Â Â seÂ Â Â Â Â Â Â Â Â pvalÂ Â Â Â Â Â lo_ciÂ Â Â Â Â up_ciÂ Â Â Â Â Â Â or</span><br><span>#Â 1Â 0.5024935Â 0.14396056Â 8.012590e-04Â 0.22033081Â 0.7846562Â 1.652838</span><br><span>#Â 2Â 0.3870065Â 0.07111020Â 5.258272e-08Â 0.24763049Â 0.5263825Â 1.472566</span><br><span>#Â 3Â 0.4459091Â 0.05898302Â 4.032020e-14Â 0.33030238Â 0.5615158Â 1.561909</span><br><span>#Â 4Â 0.3401554Â 0.15985362Â 3.650217e-02Â 0.02684233Â 0.6534685Â 1.405166</span><br><span>#Â 5Â 0.3888249Â 0.10593531Â 4.412728e-04Â 0.18119168Â 0.5964581Â 1.475246</span><br><span>#Â or_lci95Â or_uci95</span><br><span>#Â 1Â 1.246489Â 2.191653</span><br><span>#Â 2Â 1.280987Â 1.692797</span><br><span>#Â 3Â 1.391389Â 1.753328</span><br><span>#Â 4Â 1.027206Â 1.922196</span><br><span>#Â 5Â 1.198645Â 1.815676</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><code>or</code>å°±æ˜¯ORå€¼ï¼Œå¦‚æœå¤§äº1å°±æ˜¯é£é™©å› ç´ ï¼Œå°äº1å°±æ˜¯ä¿æŠ¤å› ç´ ï¼Œç„¶åå†ç»“åˆ<code>pval</code>ï¼Œå¦‚æœå°äº0.05å°±æ˜¯æœ‰å› æœå…³ç³»ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">ä¸»è¦æ˜¯çœ‹<code>Inverse variance weighted</code>çš„ç»“æœï¼Œå…¶ä»–æ–¹æ³•ä½œä¸ºè¾…åŠ©å³å¯ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å¯¹MRåˆ†æç»“æœè¿›è¡Œå¯è§†åŒ–ï¼Œè¿™ä¸ªå›¾å¾ˆæ˜æ˜¾ä½¿ç”¨<code>ggplot2</code>ç”»çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç›¸å…³è¯­æ³•è¿›è¡Œä¿®æ”¹ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>library(ggplot2)<br>library(ggsci)<br>p1 &lt;- mr_scatter_plot(res, dat = dat)<br><br>p1[[1]]+scale_color_lancet()+coord_fixed(0.5)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017479" data-ratio="1.1875881523272214" data-type="png" data-w="709" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichhRMSh14mKBJlGldXOibXoy4TGlNqMUhqWE123ktEpVjnXDHDRapYia2w/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichhRMSh14mKBJlGldXOibXoy4TGlNqMUhqWE123ktEpVjnXDHDRapYia2w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">æ¨ªåæ ‡æ˜¯SNPå¯¹æš´éœ²çš„æ•ˆåº”ï¼Œçºµåæ ‡æ˜¯SNPå¯¹ç»“å±€çš„æ•ˆåº”ï¼Œ</p><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªå›¾ä¸­æ¯ä¸€ä¸ªé»‘ç‚¹è¡¨ç¤ºä¸€ä¸ªSNPï¼Œæ¨ªçº¿è¡¨ç¤ºSNPå¯¹æš´éœ²å› ç´ çš„æ•ˆåº”é‡çš„å¯ä¿¡åŒºé—´ï¼ˆbetaÂ±seï¼‰ï¼Œç«–çº¿è¡¨ç¤ºSNPå¯¹ç»“å±€å› ç´ çš„æ•ˆåº”é‡çš„å¯ä¿¡åŒºé—´ï¼ˆbetaÂ±seï¼‰ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">5æ¡ç›´çº¿æ˜¯5ç§æ–¹æ³•çš„æ‹Ÿåˆçº¿ï¼ˆå›¾ä¸­æœ‰2æ¡çº¿é‡åˆäº†ï¼‰ï¼Œæ¯ç§æ–¹æ³•å…¶å®å°±æ˜¯è¿›è¡Œä¸€ç§å›å½’åˆ†æï¼Œæ‰€ä»¥æœ‰5æ¡æ‹Ÿåˆçº¿ã€‚æ¯æ¡ç›´çº¿çš„æ–œç‡ï¼ˆå°±æ˜¯ä¸Šé¢ç»“æœä¸­çš„<code>b</code>ï¼‰è¡¨ç¤ºè¯¥æ–¹æ³•ä¼°è®¡çš„å› æœæ•ˆåº”å¤§å°ï¼Œå¦‚æœæ–œç‡å¤§äº0ï¼Œå°±è¡¨ç¤ºæ˜¯é£é™©å› ç´ ï¼Œå¦‚æœå°äº0å°±è¡¨ç¤ºä¿æŠ¤å› ç´ ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æ”¯æŒå¤šç§å› æœæ•ˆåº”ä¼°è®¡æ–¹æ³•ï¼Œå…¶ä¸­è¿˜ç»™å‡ºäº†éƒ¨åˆ†æ–¹æ³•çš„å‚è€ƒæ–‡çŒ®ï¼Œ<code>use_by_default</code>ä¼šå‘Šè¯‰ä½ æ˜¯ä¸æ˜¯é»˜è®¤çš„æ–¹æ³•ï¼Œ<code>heterogeneity_test</code>ä¼šå‘Šè¯‰ä½ è¯¥æ–¹æ³•èƒ½ä¸èƒ½ç”¨äºå¼‚è´¨æ€§æ£€éªŒï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â 18ç§æ–¹æ³•</span><br>mr_method_list()<br><br><span>#Â 1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_wald_ratio</span><br><span>#Â 2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_two_sample_ml</span><br><span>#Â 3Â Â Â Â Â Â Â Â Â Â Â Â mr_egger_regression</span><br><span>#Â 4Â Â mr_egger_regression_bootstrap</span><br><span>#Â 5Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_simple_median</span><br><span>#Â 6Â Â Â Â Â Â Â Â Â Â Â Â Â mr_weighted_median</span><br><span>#Â 7Â Â Â mr_penalised_weighted_median</span><br><span>#Â 8Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_ivw</span><br><span>#Â 9Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_ivw_radial</span><br><span>#Â 10Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_ivw_mre</span><br><span>#Â 11Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_ivw_fe</span><br><span>#Â 12Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_simple_mode</span><br><span>#Â 13Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_weighted_mode</span><br><span>#Â 14Â Â Â Â Â Â Â Â Â mr_weighted_mode_nome</span><br><span>#Â 15Â Â Â Â Â Â Â Â Â Â Â mr_simple_mode_nome</span><br><span>#Â 16Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_raps</span><br><span>#Â 17Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_sign</span><br><span>#Â 18Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mr_uwr</span><br><span>#Â çœç•¥</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœä½ è¦æ›´æ”¹æ–¹æ³•ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>mr(dat,Â method_listÂ =Â c(<span>"mr_egger_regression"</span>,Â <span>"mr_ivw"</span>))<br><br><span>#Â AnalysingÂ 'ieu-a-2'Â onÂ 'ieu-a-7'</span><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outcome</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 2Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â exposureÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodÂ nsnp</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MRÂ EggerÂ Â Â 79</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â InverseÂ varianceÂ weightedÂ Â Â 79</span><br><span>#Â bÂ Â Â Â Â Â Â Â Â seÂ Â Â Â Â Â Â Â pval</span><br><span>#Â 1Â 0.5024935Â 0.14396056Â 8.01259e-04</span><br><span>#Â 2Â 0.4459091Â 0.05898302Â 4.03202e-14</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>æ•æ„Ÿæ€§åˆ†æ</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">å±äºäº‹åæ£€éªŒï¼Œç›®çš„æ˜¯çœ‹çœ‹MRåˆ†æçš„ç»“æœæ˜¯å¦é è°±ã€‚ä¸»è¦åŒ…æ‹¬4ä¸ªæ–¹é¢ï¼š</p><ul data-tool="mdniceç¼–è¾‘å™¨"><li><section>å¼‚è´¨æ€§æ£€éªŒ</section></li><li><section>æ°´å¹³å¤šæ•ˆæ€§</section></li><li><section>å•ä¸ªSNPåˆ†æ</section></li><li><section>ç•™ä¸€æ³•åˆ†æ</section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨">å¼‚è´¨æ€§æ£€éªŒå°±æ˜¯æ£€éªŒä¸åŒçš„å·¥å…·å˜é‡ï¼ˆSNPï¼‰ä¹‹é—´æ˜¯ä¸æ˜¯æœ‰éå¸¸å¤§çš„å·®å¼‚ï¼Œå¦‚æœå·®å¼‚å¾ˆå¤§ï¼Œå¯èƒ½ä¼šå¯¹ç»“æœçš„å¯é æ€§äº§ç”Ÿå½±å“ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">1è¡Œä»£ç å³å¯å®ç°ï¼ŒæŸäº›æ–¹æ³•æ—¢èƒ½è¿›è¡Œå› æœæ•ˆåº”åˆ†æï¼Œåˆå¯ä»¥è¿›è¡Œå¼‚è´¨æ€§æ£€éªŒï¼Œæ¯”å¦‚MR-Eggerå’ŒIVMï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>mr_heterogeneity(dat)<br><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outcome</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 2Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â exposureÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodÂ Â Â Â Â Â Â Â Q</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MRÂ EggerÂ 143.3046</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â InverseÂ varianceÂ weightedÂ 143.6508</span><br><span>#Â Q_dfÂ Â Â Â Â Â Â Q_pval</span><br><span>#Â 1Â Â Â 77Â 6.841585e-06</span><br><span>#Â 2Â Â Â 78Â 8.728420e-06</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ä¸»è¦å°±æ˜¯çœ‹ç»“æœä¸­çš„<code>Q_pval</code>ï¼Œä¹Ÿå°±æ˜¯ Cochran's Qï¼Œå°äº0.05å°±æ˜¯æ²¡æœ‰å¼‚è´¨æ€§ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">ä¹Ÿæ”¯æŒæ›´æ”¹æ–¹æ³•ï¼ˆæ”¯æŒçš„æ–¹æ³•å‚è€ƒ<code>mr_method_list()</code>ï¼‰ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>mr_heterogeneity(dat,Â method_listÂ =Â c(<span>"mr_egger_regression"</span>,Â <span>"mr_ivw"</span>))<br><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outcome</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â 2Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â exposureÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodÂ Â Â Â Â Â Â Â Q</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MRÂ EggerÂ 143.3046</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â InverseÂ varianceÂ weightedÂ 143.6508</span><br><span>#Â Q_dfÂ Â Â Â Â Â Â Q_pval</span><br><span>#Â 1Â Â Â 77Â 6.841585e-06</span><br><span>#Â 2Â Â Â 78Â 8.728420e-06</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ä¸‹é¢æ˜¯è¿›è¡Œæ°´å¹³å¤šæ•ˆæ€§æ£€éªŒï¼Œå·¥å…·å˜é‡çš„å¤šæ•ˆæ€§æ˜¯æŒ‡ä¸€ä¸ªå·¥å…·å˜é‡ï¼ˆä¹Ÿå°±æ˜¯é—ä¼ å˜å¼‚ï¼Œæˆ–è€…SNPï¼‰å¯¹å¤šä¸ªè¡¨å‹ï¼ˆä¹Ÿå°±æ˜¯æš´éœ²å› ç´ ï¼‰éƒ½ä¼šäº§ç”Ÿå½±å“çš„ç°è±¡ï¼Œè¿™æ˜¯è¿åç‹¬ç«‹æ€§å‡è®¾å’Œæ’ä»–æ€§å‡è®¾çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªæ°´å¹³å¤šæ•ˆæ€§çš„æ£€éªŒæ˜¯é€šè¿‡<code>MR-Egger</code>æ³•çš„æˆªè·æ¥åˆ¤æ–­çš„ï¼Œå¦‚æœæˆªè·ï¼ˆ<code>egger_intercept</code>ï¼‰åœ¨0é™„è¿‘ï¼ˆå¯ä»¥ç»“åˆä¸Šé¢çš„å›¾ï¼‰ï¼Œä¸”<code>pval</code>å¤§äº0.05è¯´æ˜æ²¡æœ‰æ°´å¹³å¤šæ•ˆæ€§ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>mr_pleiotropy_test(dat)<br><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outcome</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â exposureÂ egger_interceptÂ Â Â Â Â Â Â Â Â Â se</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â -0.001719304Â 0.003985962</span><br><span>#Â pval</span><br><span>#Â 1Â 0.6674266</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å•ä¸ªSNPåˆ†æï¼Œä¹Ÿå°±æ˜¯å¯¹æ¯ä¸€ä¸ªSNPå•ç‹¬è¿›è¡Œä¸€æ¬¡MRåˆ†æï¼Œç›®çš„å°±æ˜¯çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰æŸä¸ªSNPæ˜æ˜¾å’Œå…¶ä»–çš„SNPä¸ä¸€æ ·ï¼Œè¯†åˆ«ç¦»ç¾¤å€¼ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_singleÂ &lt;-Â mr_singlesnp(dat)<br>head(res_single)<br><br><span>#Â exposure</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 3Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 4Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 5Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 6Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â outcomeÂ id.exposureÂ id.outcome</span><br><span>#Â 1Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 2Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 3Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 4Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 5Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 6Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â samplesizeÂ Â Â Â Â Â Â Â SNPÂ Â Â Â Â Â Â Â Â Â bÂ Â Â Â Â Â Â Â seÂ Â Â Â Â Â Â Â Â Â p</span><br><span>#Â 1Â Â Â Â Â 184305Â Â rs1000940Â -0.7901087Â 0.5347554Â 0.13953788</span><br><span>#Â 2Â Â Â Â Â 184305Â rs10132280Â Â 0.5506335Â 0.4825339Â 0.25381623</span><br><span>#Â 3Â Â Â Â Â 184305Â Â rs1016287Â Â 0.6178509Â 0.4637632Â 0.18277634</span><br><span>#Â 4Â Â Â Â Â 184305Â rs10182181Â Â 0.5920712Â 0.3002913Â 0.04864884</span><br><span>#Â 5Â Â Â Â Â 184305Â rs10733682Â Â 0.2415426Â 0.5066223Â 0.63352560</span><br><span>#Â 6Â Â Â Â Â 184305Â rs10840100Â Â 0.7086893Â 0.4623010Â 0.12528548</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªç»“æœä¹Ÿæ˜¯å¯ä»¥è·å–ORå€¼å’Œå¯ä¿¡åŒºé—´çš„ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>head(generate_odds_ratios(res_single))<br><br><span>#Â exposure</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 3Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 4Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 5Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â 6Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â outcomeÂ id.exposureÂ id.outcome</span><br><span>#Â 1Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 2Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 3Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 4Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 5Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â 6Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7</span><br><span>#Â samplesizeÂ Â Â Â Â Â Â Â SNPÂ Â Â Â Â Â Â Â Â Â bÂ Â Â Â Â Â Â Â seÂ Â Â Â Â Â Â Â Â Â p</span><br><span>#Â 1Â Â Â Â Â 184305Â Â rs1000940Â -0.7901087Â 0.5347554Â 0.13953788</span><br><span>#Â 2Â Â Â Â Â 184305Â rs10132280Â Â 0.5506335Â 0.4825339Â 0.25381623</span><br><span>#Â 3Â Â Â Â Â 184305Â Â rs1016287Â Â 0.6178509Â 0.4637632Â 0.18277634</span><br><span>#Â 4Â Â Â Â Â 184305Â rs10182181Â Â 0.5920712Â 0.3002913Â 0.04864884</span><br><span>#Â 5Â Â Â Â Â 184305Â rs10733682Â Â 0.2415426Â 0.5066223Â 0.63352560</span><br><span>#Â 6Â Â Â Â Â 184305Â rs10840100Â Â 0.7086893Â 0.4623010Â 0.12528548</span><br><span>#Â lo_ciÂ Â Â Â up_ciÂ Â Â Â Â Â Â Â orÂ Â or_lci95Â or_uci95</span><br><span>#Â 1Â -1.838229348Â 0.258012Â 0.4537955Â 0.1590989Â 1.294354</span><br><span>#Â 2Â -0.395133032Â 1.496400Â 1.7343514Â 0.6735904Â 4.465584</span><br><span>#Â 3Â -0.291124912Â 1.526827Â 1.8549373Â 0.7474223Â 4.603545</span><br><span>#Â 4Â Â 0.003500324Â 1.180642Â 1.8077287Â 1.0035065Â 3.256464</span><br><span>#Â 5Â -0.751437234Â 1.234522Â 1.2732116Â 0.4716881Â 3.436737</span><br><span>#Â 6Â -0.197420583Â 1.614799Â 2.0313271Â 0.8208453Â 5.026879</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»“æœå¯è§†åŒ–:</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>p2Â &lt;-Â mr_forest_plot(res_single)<br>p2[[<span>1</span>]]<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017480" data-ratio="1.9914712153518124" data-type="png" data-w="469" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichtXTPygahPLcqAibicaxW4icwR7rZO3CYia7QtgLMqKM8XsicQN3xcib0RiaQA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichtXTPygahPLcqAibicaxW4icwR7rZO3CYia7QtgLMqKM8XsicQN3xcib0RiaQA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªå›¾æ˜¯ä¸€ä¸ªæ£®æ—å›¾ï¼Œå±•ç¤ºäº†å•ä¸ªSNPå¯¹CHDï¼ˆå† å¿ƒç—…ï¼‰çš„å½±å“ï¼Œå¦‚æœé»‘è‰²æ°´å¹³çº¿æ¡å®Œå…¨åœ¨0çš„å·¦è¾¹è¯´æ˜è¿™ä¸ªSNPæ˜¯ä¿æŠ¤å› ç´ ï¼Œå®Œå…¨åœ¨å³è¾¹è¯´æ˜æ˜¯å±é™©å› ç´ ï¼Œå¦‚æœç©¿è¿‡äº†0è¯´æ˜æ²¡æœ‰æ„ä¹‰ã€‚ä½†æ˜¯é€šå¸¸éƒ½æ˜¯å¤šä¸ªSNPä¸€èµ·ä½œç”¨çš„ï¼Œæ‰€ä»¥å•çœ‹ä¸€ä¸ªæ²¡æœ‰å¤ªå¤§è¯´æœåŠ›ï¼Œç›´æ¥çœ‹æœ€ä½ä¸‹çš„çº¢è‰²çº¿æ¡å³å¯ï¼Œè¿™æ˜¯æ±‡æ€»çš„æ•ˆåº”ï¼Œä¸Šå›¾å±•ç¤ºäº†ä¸¤ç§æ–¹æ³•çš„æ±‡æ€»æ•ˆåº”ï¼Œéƒ½æ˜¯å®Œå…¨åœ¨0çš„å³ä¾§çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å•ä¸ªSNPåˆ†æé»˜è®¤æ˜¯Wald ratioæ£€éªŒï¼Œå¯ä»¥æ›´æ”¹ï¼Œæ¯”å¦‚ä½¿ç”¨å›ºå®šæ•ˆåº”metaåˆ†ææ³•ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_singleÂ &lt;-Â mr_singlesnp(dat,Â single_methodÂ =Â <span>"mr_meta_fixed"</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æ€»çš„æ•ˆåº”é»˜è®¤æ˜¯IVWæ³•å’ŒMR-Eggeræ³•ï¼Œä¹Ÿå¯ä»¥æ›´æ”¹ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_singleÂ &lt;-Â mr_singlesnp(dat,Â all_methodÂ =Â <span>"mr_two_sample_ml"</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â single_methodÂ =Â <span>"mr_meta_fixed"</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å•ä¸ªSNPåˆ†æè¿˜å¯ä»¥ä½¿ç”¨æ¼æ–—å›¾è¿›è¡Œå¯è§†åŒ–ï¼Œä¸»è¦æ˜¯ä¸ºäº†çœ‹çœ‹æœ‰æ²¡æœ‰æ˜æ˜¾çš„ç¦»ç¾¤ç‚¹ï¼Œæ­£å¸¸çš„è¯åº”è¯¥æ˜¯å·¦å³åŸºæœ¬å¯¹ç§°åˆ†å¸ƒçš„ï¼Œå¦‚æœæŸä¸ªç‚¹ç¦»å¾—å¾ˆè¿œï¼Œå¯èƒ½éœ€è¦æŠŠè¯¥SNPå»æ‰ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_singleÂ &lt;-Â mr_singlesnp(dat)<br>p4Â &lt;-Â mr_funnel_plot(res_single)<br>p4[[<span>1</span>]]<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017488" data-ratio="0.5966921119592875" data-type="png" data-w="786" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichetRPOnQHZ6nkdN4cEnRh8YfsBylicvhkFELic6N7BxMGUObpCEdtxw7Q/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichetRPOnQHZ6nkdN4cEnRh8YfsBylicvhkFELic6N7BxMGUObpCEdtxw7Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">ç•™ä¸€æ³•åˆ†æï¼Œå³æ¯æ¬¡å»æ‰ä¸€ä¸ªSNPï¼Œå¯¹å‰©ä¸‹çš„SNPè¿›è¡ŒMRåˆ†æï¼Œå’Œå•ä¸ªSNPåˆ†æåˆšå¥½ç›¸åã€‚è¿™ä¸€æ­¥ä¹Ÿæ˜¯çœ‹çœ‹æœ‰æ²¡æœ‰å¼ºå½±å“ç‚¹ï¼Œæ­£å¸¸æ¥è¯´å»é™¤æŸä¸€ä¸ªSNPä¹‹åï¼Œæ€»ä½“çš„æ•ˆåº”åº”è¯¥å˜åŒ–ä¸å¤§ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œå¦‚æœå»æ‰æŸä¸ªSNPä¹‹åäº§ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ï¼Œè¯´æ˜è¿™ä¸ªSNPæœ‰é—®é¢˜ï¼Œéœ€è¦å»æ‰ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_looÂ &lt;-Â mr_leaveoneout(dat)<br>p3Â &lt;-Â mr_leaveoneout_plot(res_loo)<br>p3[[<span>1</span>]]<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017486" data-ratio="1.9936575052854122" data-type="png" data-w="473" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich5b4QSPwiaT1FSpm0icOgMroYPfnauWGBJEdJ8xNOArpylmUiakr4ubcPg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich5b4QSPwiaT1FSpm0icOgMroYPfnauWGBJEdJ8xNOArpylmUiakr4ubcPg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªè¿›è¡Œåˆ†æçš„æ–¹æ³•åŒæ ·ä¹Ÿæ˜¯å¯ä»¥æ›´æ”¹çš„å“ˆã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>Steigeræ–¹å‘æ€§æ£€éªŒ</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">MR-Steigeræ–¹å‘æ€§æ£€éªŒï¼Œä¸»è¦æ˜¯çœ‹ç»“å±€å’Œæš´éœ²ä¹‹é—´æ˜¯ä¸æ˜¯æœ‰åå‘å› æœå…³ç³»ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>directionality_test(dat)<br><br><span>#Â r.exposureÂ and/orÂ r.outcomeÂ notÂ present.</span><br><span>#Â CalculatingÂ approximateÂ SNP-exposureÂ and/orÂ SNP-outcomeÂ correlations,Â </span><br><span>#Â assumingÂ allÂ areÂ quantitativeÂ traits.Â PleaseÂ pre-calculateÂ r.exposureÂ </span><br><span>#Â and/orÂ r.outcomeÂ usingÂ get_r_from_lor()Â forÂ anyÂ binaryÂ traits</span><br><span>#Â id.exposureÂ id.outcomeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â exposure</span><br><span>#Â 1Â Â Â Â Â ieu-a-2Â Â Â Â ieu-a-7Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2</span><br><span>#Â outcomeÂ snp_r2.exposure</span><br><span>#Â 1Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â Â Â Â 0.01580819</span><br><span>#Â snp_r2.outcomeÂ correct_causal_directionÂ Â steiger_pval</span><br><span>#Â 1Â Â Â Â 0.001350485Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TRUEÂ 1.748577e-207</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">è¯¥æ£€éªŒå¯ä»¥è®¡ç®—SNPå¯¹ç»“å±€å’Œæš´éœ²çš„ r^2^ ï¼Œä¹Ÿå°±æ˜¯å¯¹ç»“å±€çš„è§£é‡Šç¨‹åº¦å’Œå¯¹æš´éœ²çš„è§£é‡Šç¨‹åº¦ï¼Œç†è®ºä¸Šè‚¯å®šæ˜¯å¯¹æš´éœ²çš„è§£é‡Šç¨‹åº¦æ›´é«˜ï¼ˆr^2^æ›´å¤§ï¼‰ï¼Œå› ä¸ºSNPæ˜¯å’Œæš´éœ²å› ç´ å¼ºç›¸å…³çš„ã€‚På€¼å¾ˆå°è¯´æ˜æ²¡æœ‰åå‘å› æœå…³ç³»ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>1-to-many forest plot</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">1-to-manyæ£®æ—å›¾å¯ä»¥ç”¨æ¥å¯è§†åŒ–<strong>å¤šä¸ªæš´éœ²å› ç´ å¯¹ä¸€ä¸ªç»“å±€çš„åˆ†æç»“æœ</strong>æˆ–è€…<strong>ä¸€ä¸ªæš´éœ²å› ç´ å¯¹å¤šä¸ªç»“å±€çš„åˆ†æç»“æœ</strong>ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å¯¹äºå°äº50ä¸ªç»“æœçš„å±•ç¤ºæ¯”è¾ƒå¥½ï¼Œå¦‚æœæœ‰å¤šäº50ä¸ªç»“æœå»ºè®®åˆ†æˆä¸¤å¼ å›¾ç„¶åå†æ‹¼èµ·æ¥ã€‚</p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>ä¾‹1</span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨">ç»“å±€è¿˜æ˜¯ä½¿ç”¨CHDï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªæš´éœ²å› ç´ ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â 6ä¸ªæš´éœ²å› ç´ </span><br>exp_datÂ &lt;-Â extract_instruments(<br>Â Â outcomesÂ =Â c(<span>"ieu-a-2"</span>,Â <span>"ieu-a-100"</span>,Â <span>"ieu-a-104"</span>,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>"ieu-a-1"</span>,Â <span>"ieu-a-72"</span>,Â <span>"ieu-a-999"</span>))<br><span>#Â æŸ¥çœ‹æ¯ä¸ªæš´éœ²å› ç´ æœ‰å‡ ä¸ªSNP</span><br>table(exp_dat$exposure)<br><br><span>#Â æå–ç»“å±€ç›¸å…³çš„SNP</span><br>chd_out_datÂ &lt;-Â extract_outcome_data(<br>Â Â snpsÂ =Â exp_dat$SNP,<br>Â Â outcomesÂ =Â <span>"ieu-a-7"</span><br>)<br><br>dat2Â &lt;-Â harmonise_data(<br>Â Â exposure_datÂ =Â exp_dat,Â <br>Â Â outcome_datÂ =Â chd_out_dat<br>)<br>res2Â &lt;-Â mr(dat2)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><code>subset_on_method</code>å‡½æ•°å¯¹æ¯ä¸€ä¸ªæš´éœ²-ç»“å±€ç»„åˆåªä¿ç•™ä¸€ä¸ªç»“æœï¼Œå¦‚æœå·¥å…·å˜é‡å¤§äº1ä¸ªå°±ä¿ç•™IVWæ³•çš„ç»“æœï¼Œå¦‚æœåªæœ‰1ä¸ªå·¥å…·å˜é‡å°±ä¿ç•™Wald-ratioçš„ç»“æœã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â åªä¿ç•™1ä¸ªç»“æœ</span><br>res2Â &lt;-Â subset_on_method(res2)Â <br><span>#Â æ’åº</span><br>res2Â &lt;-Â sort_1_to_many(res2,Â bÂ =Â <span>"b"</span>,Â sort_actionÂ =Â <span>4</span>)Â <span>#Â æŒ‰ç…§æ•ˆåº”é€’å‡æ’ä¸ªåº</span><br><br><span>#Â æŠŠÂ AdiponectinÂ ||Â id:ieu-a-1Â è¿™ç§ï¼Œå»æ‰åé¢çš„idï¼Œå¥½çœ‹ä¸€ç‚¹</span><br>res2Â &lt;-Â split_exposure(res2)Â <br><br><span>#Â è®¡ç®—ä¸‹æƒé‡ï¼Œä»¥ä¾¿æ£®æ—å›¾çš„é»‘è‰²æ–¹å—å¯ä»¥æœ‰ä¸åŒçš„å¤§å°</span><br>res2$weightÂ &lt;-Â <span>1</span>/res2$se<br><br><span>#Â è®¡ç®—ä¸‹95%å¯ä¿¡åŒºé—´çš„ä¸Šä¸‹é™ï¼Œæ–¹ä¾¿ç”»å›¾æ—¶ç¡®å®šä¸Šä¸‹ç«¯ç‚¹çš„å€¼</span><br>min(exp(res2$bÂ -Â <span>1.96</span>*res2$se))Â <span>#Â 0.3233985ï¼Œ'lo'Â </span><br>max(exp(res2$bÂ +Â <span>1.96</span>*res2$se))Â <span>#Â 2.489726ï¼Œ'up'</span><br><br><span>#Â ç”»å›¾</span><br>forest_plot_1_to_many(<br>Â Â res2,<br>Â Â bÂ =Â <span>"b"</span>,<br>Â Â seÂ =Â <span>"se"</span>,<br>Â Â exponentiateÂ =Â <span>TRUE</span>,<br>Â Â ao_slcÂ =Â <span>FALSE</span>,<br>Â Â loÂ =Â <span>0.3</span>,<br>Â Â upÂ =Â <span>2.5</span>,<br>Â Â TraitMÂ =Â <span>"exposure"</span>,<br>Â Â col1_widthÂ =Â <span>2</span>,<br>Â Â byÂ =Â <span>NULL</span>,<br>Â Â transÂ =Â <span>"log2"</span>,<br>Â Â xlabÂ =Â <span>"ORÂ forÂ CHDÂ perÂ SDÂ increaseÂ inÂ riskÂ factorÂ (95%Â CI)"</span>,<br>Â Â weightÂ =Â <span>"weight"</span><br>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017484" data-ratio="0.5956907477820025" data-type="png" data-w="789" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich5g5HHCYDm3L4o89GAxJTgSIgt0u4AoQzftiaxPqjjz5eZY8iaK2f4JiaA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpich5g5HHCYDm3L4o89GAxJTgSIgt0u4AoQzftiaxPqjjz5eZY8iaK2f4JiaA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">è¿™å¼ å›¾å°±åŒæ—¶å±•ç¤ºäº†6ä¸ªæš´éœ²å› ç´ å’Œç»“å±€ï¼Œåˆ†åˆ«è¿›è¡ŒMRåˆ†æçš„ç»“æœï¼Œå¯ä»¥æ–¹ä¾¿çš„çœ‹å‡ºæ¯ä¸ªæš´éœ²å› ç´ å¯¹ç»“å±€çš„æ•ˆåº”å¤§å°ï¼Œæœ€ä¸Šé¢çš„æ•ˆåº”æœ€å¤§ï¼Œè¿˜å±•ç¤ºäº†å¯ä¿¡åŒºé—´ç­‰ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">è¿˜å¯ä»¥å¤šæ·»åŠ å‡ åˆ—ä¿¡æ¯ï¼Œæ¯”å¦‚æŠŠPå€¼å’ŒSNPçš„æ•°é‡åŠ åˆ°æ£®æ—å›¾ä¸­ä¸€èµ·å±•ç¤ºï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â æ”¹ä¸‹På€¼çš„æ˜¾ç¤ºæ–¹æ³•</span><br>res2$pval&lt;-formatC(res2$pval,Â formatÂ =Â <span>"e"</span>,Â digitsÂ =Â <span>2</span>)<br><br>forest_plot_1_to_many(<br>Â Â res2,<br>Â Â bÂ =Â <span>"b"</span>,<br>Â Â seÂ =Â <span>"se"</span>,<br>Â Â exponentiateÂ =Â <span>TRUE</span>,<br>Â Â ao_slcÂ =Â <span>FALSE</span>,<br>Â Â loÂ =Â <span>0.3</span>,<br>Â Â upÂ =Â <span>2.5</span>,<br>Â Â TraitMÂ =Â <span>"exposure"</span>,<br>Â Â byÂ =Â <span>NULL</span>,<br>Â Â transÂ =Â <span>"log2"</span>,<br>Â Â xlabÂ =Â <span>"ORÂ forÂ CHDÂ perÂ SDÂ increaseÂ inÂ riskÂ factorÂ (95%Â CI)"</span>,<br>Â Â weightÂ =Â <span>"weight"</span>,<br>Â Â subheading_sizeÂ =Â <span>11</span>,<br>Â Â col1_titleÂ =Â <span>"RiskÂ factor"</span>,<br>Â Â col1_widthÂ =Â <span>2.5</span>,<br>Â Â col_text_sizeÂ =Â <span>4</span>,<br>Â Â addcolsÂ =Â c(<span>"nsnp"</span>,Â <span>"pval"</span>),Â <span>#Â æŠŠè¿™ä¸¤åˆ—åŠ è¿›å»</span><br>Â Â addcol_widthsÂ =Â c(<span>1.0</span>,Â <span>1.0</span>)Â <span>#Â è¿™ä¸¤åˆ—çš„å®½åº¦</span><br>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017485" data-ratio="0.6202046035805626" data-type="png" data-w="782" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichBc1orxgxNlcibcAHXYCvj5Nc8bBaJG6asuRlqJA8axEYKl4usm7rDHw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichBc1orxgxNlcibcAHXYCvj5Nc8bBaJG6asuRlqJA8axEYKl4usm7rDHw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>ä¾‹2</span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨">ä¸Šé¢æ˜¯åˆå¹¶å±•ç¤ºä¸åŒçš„æš´éœ²å› ç´ ï¼Œæ¯ä¸ªMRåˆ†æåªé€‰äº†ä¸€ç§åˆ†ææ–¹æ³•çš„ç»“æœè¿›è¡Œå±•ç¤ºã€‚ä¹Ÿå¯ä»¥æ ¹æ®æš´éœ²å› ç´ åˆ†å±‚ï¼Œæ¯ä¸ªæš´éœ²å› ç´ å’Œç»“å±€çš„MRåˆ†æå±•ç¤ºå¤šä¸ªæ–¹æ³•çš„ç»“æœã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res2Â &lt;-Â mr(dat2)<br>res2Â &lt;-Â split_exposure(res2)Â <br><br>res2Â &lt;-<br>Â Â sort_1_to_many(<br>Â Â Â Â res2,<br>Â Â Â Â groupÂ =Â <span>"exposure"</span>,Â <span>#Â åˆ†å±‚å˜é‡</span><br>Â Â Â Â sort_actionÂ =Â <span>3</span>,Â <span>#Â ç›¸åŒæš´éœ²å› ç´ çš„MRåˆ†æç»“æœæ”¾åœ¨ä¸€èµ·</span><br>Â Â Â Â priorityÂ =Â <span>"InverseÂ varianceÂ weighted"</span>,Â <span>#Â å“ªç§æ–¹æ³•æ”¾åœ¨æœ€ä¸Šé¢</span><br>Â Â Â Â trait_mÂ =Â <span>"method"</span><br>Â Â )<br><br>forest_plot_1_to_many(<br>Â Â res2,<br>Â Â bÂ =Â <span>"b"</span>,<br>Â Â seÂ =Â <span>"se"</span>,<br>Â Â exponentiateÂ =Â <span>TRUE</span>,<br>Â Â transÂ =Â <span>"log2"</span>,<br>Â Â ao_slcÂ =Â <span>FALSE</span>,<br>Â Â loÂ =Â <span>0.03</span>,<br>Â Â upÂ =Â <span>22</span>,<br>Â Â col1_widthÂ =Â <span>2</span>,<br>Â Â byÂ =Â <span>"exposure"</span>,Â <span>#Â åˆ†å±‚å˜é‡</span><br>Â Â TraitMÂ =Â <span>"method"</span>,<br>Â Â xlabÂ =Â <span>"ORÂ forÂ CHDÂ perÂ SDÂ increaseÂ inÂ riskÂ factorÂ (95%Â CI)"</span>,<br>Â Â subheading_sizeÂ =Â <span>12</span>,<br>Â Â col_text_sizeÂ =Â <span>4</span><br>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017487" data-ratio="2.3486973947895793" data-type="png" data-w="499" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichy5CpArKv1DibLr9JOPlicgy7shfRh5O0aRLvA8GyyJyXSbtwlWcTHQcw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicpaO98VzZqtk1ibibeGJFpichy5CpArKv1DibLr9JOPlicgy7shfRh5O0aRLvA8GyyJyXSbtwlWcTHQcw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å¤šå˜é‡MRï¼ˆMVMRï¼‰</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">å½“SNPå’Œå¤šä¸ªæš´éœ²å› ç´ éƒ½æœ‰å…³ç³»æ—¶ï¼Œå¯ä»¥è¿›è¡Œå¤šå˜é‡MRåˆ†æï¼ˆMultivariable MRï¼‰ã€‚å¤§æ¦‚çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol data-tool="mdniceç¼–è¾‘å™¨"><li><section>æå–æ¯ä¸ªæš´éœ²å› ç´ çš„SNP</section></li><li><section>åˆå¹¶è¿™äº›SNP</section></li><li><section>å»é™¤è¿é”ä¸å¹³è¡¡çš„SNP</section></li><li><section>é‡æ–°ä»ä»¥ä¸Šæ•°æ®ä¸­æå–SNP</section></li><li><section>ç»Ÿä¸€æ•°æ®ï¼Œç¡®ä¿effect alleleä¸€æ ·</section></li><li><section>ä½¿ç”¨å¤šå˜é‡MRæ–¹æ³•è¿›è¡Œåˆ†æ</section></li></ol><p data-tool="mdniceç¼–è¾‘å™¨">å®é™…ç”¨ä»£ç å®ç°æ˜¯éå¸¸ç®€å•çš„è¿‡ç¨‹ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æ¯”å¦‚æˆ‘ä»¬æœ‰ä»¥ä¸‹3ä¸ªæš´éœ²å› ç´ ï¼Œå®ƒä»¬å½¼æ­¤ä¹‹é—´æ˜¯ç›¸å…³çš„ï¼š</p><ul data-tool="mdniceç¼–è¾‘å™¨"><li><section>HDL:ieu-a-299</section></li><li><section>LDL:ieu-a-300</section></li><li><section>total cholesterol:ieu-a-302</section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨">ç»“å±€æ˜¯å† å¿ƒç—…ï¼š</p><p data-tool="mdniceç¼–è¾‘å™¨">coronary heart disease (CHD):ieu-a-7</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>id_exposureÂ &lt;-Â c(<span>"ieu-a-299"</span>,Â <span>"ieu-a-300"</span>,Â <span>"ieu-a-302"</span>)<br>id_outcomeÂ &lt;-Â <span>"ieu-a-7"</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">é¦–å…ˆæŸ¥æ‰¾è¿™å‡ ä¸ªæš´éœ²ç›¸å…³çš„SNPï¼Œè¿™ä¸ªå‡½æ•°ä¼šè‡ªå®šè¿›è¡Œåˆå¹¶ã€å»é™¤LDç­‰ï¼Œ1è¡Œä»£ç å°±è§£å†³äº†ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â æå–SNP</span><br>exposure_datmÂ &lt;-Â mv_extract_exposures(id_exposure)<br><br><span>#Â PleaseÂ lookÂ atÂ vignettesÂ forÂ optionsÂ onÂ runningÂ thisÂ locallyÂ ifÂ youÂ needÂ toÂ runÂ manyÂ instancesÂ ofÂ thisÂ command.</span><br><span>#Â ClumpingÂ 1,Â 214Â variants,Â usingÂ EURÂ populationÂ reference</span><br><span>#Â RemovingÂ 70Â ofÂ 214Â variantsÂ dueÂ toÂ LDÂ withÂ otherÂ variantsÂ orÂ absenceÂ fromÂ LDÂ referenceÂ panel</span><br><span>#Â ExtractingÂ dataÂ forÂ 144Â SNP(s)Â fromÂ 3Â GWAS(s)</span><br><span>#Â HarmonisingÂ HDLÂ cholesterolÂ ||Â id:ieu-a-299Â (ieu-a-299)Â andÂ LDLÂ cholesterolÂ ||Â id:ieu-a-300Â (ieu-a-300)</span><br><span>#Â HarmonisingÂ HDLÂ cholesterolÂ ||Â id:ieu-a-299Â (ieu-a-299)Â andÂ TriglyceridesÂ ||Â id:ieu-a-302Â (ieu-a-302)</span><br><br><br>head(exposure_datm[order(exposure_datm$SNP),],<span>12</span>)<br><br><span>#Â Â Â Â Â SNPÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â exposureÂ id.exposure</span><br><span>#Â 1Â Â Â rs10019888Â HDLÂ cholesterolÂ ||Â id:ieu-a-299Â Â Â ieu-a-299</span><br><span>#Â 145Â rs10019888Â LDLÂ cholesterolÂ ||Â id:ieu-a-300Â Â Â ieu-a-300</span><br><span>#Â 289Â rs10019888Â Â Â TriglyceridesÂ ||Â id:ieu-a-302Â Â Â ieu-a-302</span><br><span>#Â 2Â Â Â Â Â rs103294Â HDLÂ cholesterolÂ ||Â id:ieu-a-299Â Â Â ieu-a-299</span><br><span>#Â 146Â Â Â rs103294Â LDLÂ cholesterolÂ ||Â id:ieu-a-300Â Â Â ieu-a-300</span><br><span>#Â 290Â Â Â rs103294Â Â Â TriglyceridesÂ ||Â id:ieu-a-302Â Â Â ieu-a-302</span><br><span>#Â 3Â Â Â rs10468017Â HDLÂ cholesterolÂ ||Â id:ieu-a-299Â Â Â ieu-a-299</span><br><span>#Â 147Â rs10468017Â LDLÂ cholesterolÂ ||Â id:ieu-a-300Â Â Â ieu-a-300</span><br><span>#Â 291Â rs10468017Â Â Â TriglyceridesÂ ||Â id:ieu-a-302Â Â Â ieu-a-302</span><br><span>#Â 4Â Â Â Â rs1047891Â HDLÂ cholesterolÂ ||Â id:ieu-a-299Â Â Â ieu-a-299</span><br><span>#Â 148Â Â rs1047891Â LDLÂ cholesterolÂ ||Â id:ieu-a-300Â Â Â ieu-a-300</span><br><span>#Â 292Â Â rs1047891Â Â Â TriglyceridesÂ ||Â id:ieu-a-302Â Â Â ieu-a-302</span><br><span>#Â Â Â Â Â effect_allele.exposureÂ other_allele.exposureÂ eaf.exposure</span><br><span>#Â 1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â GÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â 0.1636</span><br><span>#Â 145Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â GÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â 0.1636</span><br><span>#Â 289Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â GÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â 0.1636</span><br><span>#Â 2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.1860</span><br><span>#Â 146Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.1860</span><br><span>#Â 290Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.1860</span><br><span>#Â 3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.2757</span><br><span>#Â 147Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.2757</span><br><span>#Â 291Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.2757</span><br><span>#Â 4Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.3021</span><br><span>#Â 148Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.3021</span><br><span>#Â 292Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CÂ Â Â Â Â Â Â 0.3021</span><br><span>#Â Â Â Â Â beta.exposureÂ se.exposureÂ pval.exposure</span><br><span>#Â 1Â Â Â Â Â Â Â Â Â -0.0270Â Â Â Â Â Â 0.0046Â Â Â 4.90095e-08</span><br><span>#Â 145Â Â Â Â Â Â Â Â 0.0182Â Â Â Â Â Â 0.0050Â Â Â 3.23199e-04</span><br><span>#Â 289Â Â Â Â Â Â Â Â 0.0228Â Â Â Â Â Â 0.0045Â Â Â 2.28302e-06</span><br><span>#Â 2Â Â Â Â Â Â Â Â Â Â 0.0523Â Â Â Â Â Â 0.0044Â Â Â 3.99485e-30</span><br><span>#Â 146Â Â Â Â Â Â Â Â 0.0073Â Â Â Â Â Â 0.0047Â Â Â 1.22500e-01</span><br><span>#Â 290Â Â Â Â Â Â Â -0.0021Â Â Â Â Â Â 0.0042Â Â Â 7.52101e-01</span><br><span>#Â 3Â Â Â Â Â Â Â Â Â Â 0.1179Â Â Â Â Â Â 0.0038Â Â 1.21060e-188</span><br><span>#Â 147Â Â Â Â Â Â Â Â 0.0020Â Â Â Â Â Â 0.0042Â Â Â 7.46799e-01</span><br><span>#Â 291Â Â Â Â Â Â Â Â 0.0379Â Â Â Â Â Â 0.0039Â Â Â 7.55962e-21</span><br><span>#Â 4Â Â Â Â Â Â Â Â Â -0.0269Â Â Â Â Â Â 0.0039Â Â Â 8.72991e-10</span><br><span>#Â 148Â Â Â Â Â Â Â Â 0.0079Â Â Â Â Â Â 0.0042Â Â Â 1.42200e-01</span><br><span>#Â 292Â Â Â Â Â Â Â Â 0.0000Â Â Â Â Â Â 0.0038Â Â Â 8.60200e-01</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å¯ä»¥çœ‹åˆ°æ¯ä¸ªSNPå¯¹åº”3ç§æš´éœ²ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">ç„¶åæå–å’Œç»“å±€ç›¸å…³çš„SNPï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>outcome_datmÂ &lt;-Â extract_outcome_data(exposure_datm$SNP,Â id_outcome)<br><br><span>#Â ExtractingÂ dataÂ forÂ 144Â SNP(s)Â fromÂ 1Â GWAS(s)</span><br><span>#Â FindingÂ proxiesÂ forÂ 1Â SNPsÂ inÂ outcomeÂ ieu-a-7</span><br><span>#Â ExtractingÂ dataÂ forÂ 1Â SNP(s)Â fromÂ 1Â GWAS(s)</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»Ÿä¸€æ•°æ®ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>mvdatÂ &lt;-Â mv_harmonise_data(exposure_datm,Â outcome_datm)<br><span>#Â HarmonisingÂ HDLÂ cholesterolÂ ||Â id:ieu-a-299Â (ieu-a-299)Â andÂ CoronaryÂ </span><br><span>#Â heartÂ diseaseÂ ||Â id:ieu-a-7Â (ieu-a-7)</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">è¿›è¡Œå¤šå˜é‡MRåˆ†æï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>resmÂ &lt;-Â mv_multiple(mvdat)<br>resm<br><br><span>#Â $result</span><br><span>#Â id.exposureÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â exposureÂ id.outcome</span><br><span>#Â 1Â Â Â ieu-a-299Â HDLÂ cholesterolÂ ||Â id:ieu-a-299Â Â Â Â ieu-a-7</span><br><span>#Â 2Â Â Â ieu-a-300Â LDLÂ cholesterolÂ ||Â id:ieu-a-300Â Â Â Â ieu-a-7</span><br><span>#Â 3Â Â Â ieu-a-302Â Â Â TriglyceridesÂ ||Â id:ieu-a-302Â Â Â Â ieu-a-7</span><br><span>#Â outcomeÂ nsnpÂ Â Â Â Â Â Â Â Â Â Â bÂ Â Â Â Â Â Â Â Â se</span><br><span>#Â 1Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â 79Â -0.08919724Â 0.05970552</span><br><span>#Â 2Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â 68Â Â 0.37853543Â 0.04976846</span><br><span>#Â 3Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7Â Â Â 42Â Â 0.13584165Â 0.06738291</span><br><span>#Â pval</span><br><span>#Â 1Â 1.351879e-01</span><br><span>#Â 2Â 2.828614e-14</span><br><span>#Â 3Â 4.380354e-02</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»“æœè¯´æ˜<code>ieu-a-299</code>ï¼Œä¹Ÿå°±æ˜¯HDLå¯¹å† å¿ƒç—…æ˜¯æ²¡æœ‰å› æœå…³ç³»çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœä½ å•ç‹¬å¯¹æ¯ä¸ªæš´éœ²å› ç´ åšMRåˆ†æï¼Œç»“æœå¯èƒ½å’Œå¤šå˜é‡MRçš„ç»“æœä¸åŒã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>MR-MoE</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•ç¡®å®šæœ€ä½³çš„MRæ–¹æ³•ã€‚MR-MoE:Using a mixture of experts machine learning approach</p><p data-tool="mdniceç¼–è¾‘å™¨">å¯ä»¥ä½¿ç”¨éšæœºæ£®æ—ç®—æ³•è¯„ä¼°11ç§MRæ–¹æ³•çš„å‡†ç¡®æ€§ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">ç›¸å…³çš„å‚è€ƒæ–‡çŒ®ï¼ˆè¯¦ç»†çš„æ–¹æ³•å­¦ä»‹ç»ï¼‰å¯ä»¥é€šè¿‡é“¾æ¥æŸ¥çœ‹ï¼šhttps://www.biorxiv.org/content/10.1101/173682v2<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="22px" viewbox="0 0 32 32" enable-background="new 0 0 32 32"><image width="32" height="32" x="0" y="0"></image></svg></p><p data-tool="mdniceç¼–è¾‘å™¨">ä½¿ç”¨æ–¹æ³•æ˜¯å¾ˆç®€å•çš„ï¼Œé¦–å…ˆéœ€è¦ä¸‹è½½å®˜æ–¹åˆ¶ä½œçš„è®­ç»ƒæ•°æ®ï¼Œä¸‹è½½é“¾æ¥ï¼šhttps://www.dropbox.com/s/5la7y38od95swcf/rf.rdata?dl=0</p><p data-tool="mdniceç¼–è¾‘å™¨">ç„¶åé€šè¿‡ä»¥ä¸‹ä»£ç å³å¯å®ç°ä½¿ç”¨<strong>éšæœºæ£®æ—</strong>ç¡®å®šæœ€ä½³çš„MRæ–¹æ³•ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â å‰é¢çš„æ­¥éª¤éƒ½æ˜¯ä¸€æ ·çš„</span><br>exposure_datÂ &lt;-Â extract_instruments(<span>"ieu-a-2"</span>)<br>outcome_datÂ &lt;-Â extract_outcome_data(exposure_dat$SNP,Â <span>"ieu-a-7"</span>)<br>datÂ &lt;-Â harmonise_data(exposure_dat,Â outcome_dat)<br><br><span>#Â åŠ è½½ä¸‹è½½çš„æ•°æ®</span><br>load(<span>"./ieu/rf.rdata"</span>)<br><br><span>#Â æ•´åˆæ‰€æœ‰MRæ–¹æ³•çš„ç»“æœ</span><br>res1Â &lt;-Â mr_wrapper(dat)<br><br><span>#Â PerformingÂ MRÂ analysisÂ ofÂ 'ieu-a-2'Â onÂ 'ieu-a-7'</span><br><span>#Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â -Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â -Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â -Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br><span>#Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â -Â CoronaryÂ heartÂ diseaseÂ ||Â id:ieu-a-7</span><br>Â <br><br><span>library</span>(dplyr)<br><span>#Â MR-MoEï¼šé¢„æµ‹æ¯ç§æ–¹æ³•çš„æ€§èƒ½</span><br>res_moeÂ &lt;-Â mr_moe(res1,Â rf)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»“æœæŸ¥çœ‹ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>res_moe$`ieu-a-2.ieu-a-7`$estimates<br><br><span>#Â AÂ tibble:Â 44Â Ã—Â 14</span><br>Â Â Â id.exposureÂ id.outcomeÂ methodÂ Â Â Â Â nsnpÂ Â Â Â Â bÂ Â Â Â Â seÂ ci_lowÂ ci_upp<br>Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â &lt;chr&gt;Â Â Â Â Â &lt;int&gt;Â &lt;dbl&gt;Â Â &lt;dbl&gt;Â Â &lt;dbl&gt;Â Â &lt;dbl&gt;<br>Â <span>1</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â FEÂ IVWÂ Â Â Â Â Â Â <span>69</span>Â <span>0.464</span>Â <span>0.0415</span>Â Â <span>0.383</span>Â Â <span>0.546</span><br>Â <span>2</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â REÂ IVWÂ Â Â Â Â Â Â <span>69</span>Â <span>0.464</span>Â <span>0.0415</span>Â Â <span>0.383</span>Â Â <span>0.546</span><br>Â <span>3</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â SimpleÂ mâ€¦Â Â Â Â <span>69</span>Â <span>0.439</span>Â <span>0.0465</span>Â Â <span>0.348</span>Â Â <span>0.530</span><br>Â <span>4</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â FEÂ IVWÂ Â Â Â Â Â Â <span>79</span>Â <span>0.446</span>Â <span>0.0439</span>Â Â <span>0.330</span>Â Â <span>0.561</span><br>Â <span>5</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â REÂ IVWÂ Â Â Â Â Â Â <span>69</span>Â <span>0.464</span>Â <span>0.0415</span>Â Â <span>0.383</span>Â Â <span>0.546</span><br>Â <span>6</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â SimpleÂ mâ€¦Â Â Â Â <span>79</span>Â <span>0.393</span>Â <span>0.0683</span>Â Â <span>0.259</span>Â Â <span>0.527</span><br>Â <span>7</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â SimpleÂ mâ€¦Â Â Â Â <span>69</span>Â <span>0.397</span>Â <span>0.0687</span>Â Â <span>0.262</span>Â Â <span>0.532</span><br>Â <span>8</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â FEÂ IVWÂ Â Â Â Â Â Â <span>69</span>Â <span>0.464</span>Â <span>0.0415</span>Â Â <span>0.383</span>Â Â <span>0.546</span><br>Â <span>9</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â Weightedâ€¦Â Â Â Â <span>69</span>Â <span>0.383</span>Â <span>0.0747</span>Â Â <span>0.236</span>Â Â <span>0.529</span><br><span>10</span>Â ieu-a-<span>2</span>Â Â Â Â Â ieu-a-<span>7</span>Â Â Â Â FEÂ IVWÂ Â Â Â Â Â Â <span>79</span>Â <span>0.446</span>Â <span>0.0439</span>Â Â <span>0.330</span>Â Â <span>0.561</span><br><span>#Â â„¹Â 34Â moreÂ rows</span><br><span>#Â â„¹Â 6Â moreÂ variables:Â pvalÂ &lt;dbl&gt;,Â steiger_filteredÂ &lt;lgl&gt;,</span><br><span>#Â Â Â outlier_filteredÂ &lt;lgl&gt;,Â selectionÂ &lt;chr&gt;,Â method2Â &lt;chr&gt;,</span><br><span>#Â Â Â MOEÂ &lt;dbl&gt;</span><br><span>#Â â„¹Â UseÂ `print(nÂ =Â ...)`Â toÂ seeÂ moreÂ rows</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">è¿™ä¸ªç»“æœ<code>res_moe</code>æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªå…ƒç´ ï¼š</p><ul data-tool="mdniceç¼–è¾‘å™¨"><li><section><code>estimates</code>ï¼šæ¯ç§MRæ–¹æ³•çš„ç»“æœ</section></li><li><section><code>heterogeneity</code>ï¼šå¼‚è´¨æ€§æ£€éªŒçš„ç»“æœ</section></li><li><section><code>directional_pleiotropy</code>ï¼šegger interceptsçš„ç»“æœ</section></li><li><section><code>info</code>ï¼šç”¨äºäº§ç”ŸMOEçš„æŒ‡æ ‡</section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨">ä¸»è¦æ˜¯çœ‹<code>estimates</code>ä¸­çš„<code>MOE</code>åˆ—ï¼Œè¿™æ˜¯æ¯ä¸ªæ–¹æ³•çš„AUCå€¼ï¼Œè¶Šå¤§è¯´æ˜è¿™ä¸ªæ–¹æ³•è¶Šå¥½ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>æ•´åˆæ‰€æœ‰ç»“æœ</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">å°±æ˜¯æŠŠæ‰€æœ‰ç»“æœæ”¾åˆ°ä¸€ä¸ªæ•°æ®æ¡†ä¸­ï¼Œæ„Ÿè§‰ç”¨å¤„ä¸å¤§...</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>resÂ &lt;-Â mr(dat)<br>hetÂ &lt;-Â mr_heterogeneity(dat)<br>pltÂ &lt;-Â mr_pleiotropy_test(dat)<br>sinÂ &lt;-Â mr_singlesnp(dat)<br><br><span>#Â åˆå¹¶æ‰€æœ‰ç»“æœ</span><br>all_resÂ &lt;-<br>Â Â combine_all_mrresults(<br>Â Â Â Â res,<br>Â Â Â Â het,<br>Â Â Â Â plt,<br>Â Â Â Â sin,<br>Â Â Â Â ao_slcÂ =Â <span>TRUE</span>,<br>Â Â Â Â ExpÂ =Â <span>TRUE</span>,<br>Â Â Â Â split.exposureÂ =Â <span>FALSE</span>,<br>Â Â Â Â split.outcomeÂ =Â <span>TRUE</span><br>Â Â )<br>head(all_res[,Â c(<br>Â Â <span>"Method"</span>,<br>Â Â <span>"outcome"</span>,<br>Â Â <span>"exposure"</span>,<br>Â Â <span>"nsnp"</span>,<br>Â Â <span>"b"</span>,<br>Â Â <span>"se"</span>,<br>Â Â <span>"pval"</span>,<br>Â Â <span>"intercept"</span>,<br>Â Â <span>"intercept_se"</span>,<br>Â Â <span>"intercept_pval"</span>,<br>Â Â <span>"Q"</span>,<br>Â Â <span>"Q_df"</span>,<br>Â Â <span>"Q_pval"</span>,<br>Â Â <span>"consortium"</span>,<br>Â Â <span>"ncase"</span>,<br>Â Â <span>"ncontrol"</span>,<br>Â Â <span>"pmid"</span>,<br>Â Â <span>"population"</span><br>)])<br><br><span>#Â 1Â InverseÂ varianceÂ weightedÂ CoronaryÂ heartÂ disease</span><br><span>#Â 2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MRÂ EggerÂ CoronaryÂ heartÂ disease</span><br><span>#Â 3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SimpleÂ modeÂ CoronaryÂ heartÂ disease</span><br><span>#Â 4Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WaldÂ ratioÂ CoronaryÂ heartÂ disease</span><br><span>#Â 5Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WaldÂ ratioÂ CoronaryÂ heartÂ disease</span><br><span>#Â 6Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â WaldÂ ratioÂ CoronaryÂ heartÂ disease</span><br><span>#Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â exposureÂ nsnpÂ Â Â Â Â Â Â Â Â Â bÂ Â Â Â Â Â Â Â Â se</span><br><span>#Â 1Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â 79Â Â 0.4459091Â 0.05898302</span><br><span>#Â 2Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â 79Â Â 0.5024935Â 0.14396056</span><br><span>#Â 3Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â 79Â Â 0.3401554Â 0.15878926</span><br><span>#Â 4Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â 1Â Â 1.1494985Â 0.37045723</span><br><span>#Â 5Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â 1Â -0.7901087Â 0.53475543</span><br><span>#Â 6Â BodyÂ massÂ indexÂ ||Â id:ieu-a-2Â Â Â Â 1Â Â 0.5506335Â 0.48253394</span><br><span>#Â Â Â Â Â Â Â Â Â Â Â pvalÂ Â Â Â interceptÂ intercept_seÂ intercept_pvalÂ Â Â Â Â Â Â Â Q</span><br><span>#Â 1Â 4.032020e-14Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â Â Â NAÂ 143.6508</span><br><span>#Â 2Â 8.012590e-04Â -0.001719304Â Â 0.003985962Â Â Â Â Â Â 0.6674266Â 143.3046</span><br><span>#Â 3Â 3.529868e-02Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â NA</span><br><span>#Â 4Â 1.916225e-03Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â NA</span><br><span>#Â 5Â 1.395379e-01Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â NA</span><br><span>#Â 6Â 2.538162e-01Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â Â Â NAÂ Â Â Â Â Â Â NA</span><br><span>#Â Â Â Â Â Â Â Â Â Â Â Â Â Â Q_dfÂ Â Â Â Â Â Â Q_pvalÂ Â Â Â Â Â Â Â consortiumÂ ncaseÂ ncontrolÂ Â Â Â Â pmid</span><br><span>#Â 1Â Â Â 78Â 8.728420e-06Â CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â 2Â Â Â 77Â 6.841585e-06Â CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â 3Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â 4Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â 5Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â 6Â Â Â NAÂ Â Â Â Â Â Â Â Â Â Â NAÂ CARDIoGRAMplusC4DÂ 60801Â Â Â 123504Â 26343387</span><br><span>#Â Â Â Â population</span><br><span>#Â 1Â Â Â Â Â Â Mixed</span><br><span>#Â 2Â Â Â Â Â Â Mixed</span><br><span>#Â 3Â Â Â Â Â Â Mixed</span><br><span>#Â 4Â Â Â Â Â Â Mixed</span><br><span>#Â 5Â Â Â Â Â Â Mixed</span><br><span>#Â 6Â Â Â Â Â Â Mixed</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">OVERï¼</p><p data-tool="mdniceç¼–è¾‘å™¨">åé¢çš„æ¨æ–‡å°±æ˜¯ä»‹ç»å¦‚ä½•ä»å„å¤§æ•°æ®åº“ä¸‹è½½æ•°æ®åˆ°æœ¬åœ°è¿›è¡ŒMRåˆ†æäº†ã€‚</p></section><p><span><br></span></p><hr><blockquote><p><span><strong>è”ç³»æˆ‘ä»¬ï¼Œå…³æ³¨æˆ‘ä»¬</strong></span></p><ol><li><section>å…è´¹QQäº¤æµç¾¤1ï¼š613637742</section></li><li><section>å…è´¹QQäº¤æµç¾¤2ï¼š608720452</section></li><li><section>å…¬ä¼—å·æ¶ˆæ¯ç•Œé¢å…³äºä½œè€…è·å–è”ç³»æ–¹å¼</section></li><li><section>çŸ¥ä¹ã€CSDNã€ç®€ä¹¦åŒåè´¦å·</section></li><li><section>å“”å“©å“”å“©ï¼šé˜¿è¶Šå°±æ˜¯æˆ‘</section></li></ol></blockquote></section></section></section></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Db_eeCoPn0Gv2ilROh642g",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
