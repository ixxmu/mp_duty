---
title: "模型构建后如何挑选基因验证?SurvSHAP"
date: 2025-01-08T22:58:24Z
draft: ["false"]
tags: [
  "fetched",
  "学R时习之"
]
categories: ["Acdemic"]
---
模型构建后如何挑选基因验证?SurvSHAP by 学R时习之
------
<div><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fgaodashitou%2Fxggbo7%2Fwyvcw8bobh5xgc3p"></ne-clipboard><p><span leaf="">构建预后模型通常需要多个基因，那么后续选择哪个基因进行验证研究？有大佬推荐用</span><code><span leaf="">Friends</span></code><span leaf="">或者</span><code><span leaf="">cytoHubba</span></code><span leaf="">对基因重要性进行排序，选择最重要的基因进行验证。最近看文献时发现也可以用</span><code><span leaf="">SurvSHAP</span></code><span leaf="">筛选基因(PMID: 39762905)。</span></p><p><span leaf=""><br></span></p><p><code><span leaf="">SurvSHAP</span></code><span leaf="">：利用机器学习对生存模型的时间相关解释。</span></p><h1><span leaf="">文章信息</span></h1><p><span leaf="">利用液-液生物聚合物调节剂预测肝细胞癌的预后和药物敏感性</span></p><p><span leaf="">Utilizing liquid-liquid biopolymer regulators to predict the prognosis and drug sensitivity of hepatocellular carcinoma.(PMID: 39762905)</span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDTRIgycicNLicc7QjTBs3EIOibFBHFKjvrvGNNQ1ibu9lyzS25An4icXINWg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.48600746268656714" data-type="png" data-w="1072" width="857.6" data-imgfileid="100004274" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDTRIgycicNLicc7QjTBs3EIOibFBHFKjvrvGNNQ1ibu9lyzS25An4icXINWg/640?wx_fmt=png&amp;from=appmsg"><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDTIqfj4sKw8DNBiaQSr66aYKeh0rcAEZzUicUycJ38EWl9kLBTdJIL11g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2716236722306525" data-type="png" data-w="659" width="527.2" data-imgfileid="100004273" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDTIqfj4sKw8DNBiaQSr66aYKeh0rcAEZzUicUycJ38EWl9kLBTdJIL11g/640?wx_fmt=png&amp;from=appmsg"></span></p><hr><h1><span leaf="">图表复现</span></h1><p><span leaf="">下面主要用</span><code><span leaf="">survex</span></code><span leaf="">进行复现，示例数据</span><code><span leaf="">survminer::myeloma</span></code><span leaf="">。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">library(survex)</span><span leaf=""><br></span><span leaf="">library(survival)</span><span leaf=""><br></span><span leaf="">library(ranger)</span><span leaf=""><br></span><span leaf="">library(survminer)</span><span leaf=""><br></span><span leaf="">library(cowplot)</span><span leaf=""><br></span><span leaf="">survminer::myeloma</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># Global explanations with SurvSHAP(t)----</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">data(myeloma)</span><span leaf=""><br></span><span leaf="">head(myeloma)</span><span leaf=""><br></span><span leaf="">vet &lt;-  myeloma[,-c(1:3)]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 构建模型</span></span><span leaf=""><br></span><span leaf="">model &lt;- ranger::ranger(Surv(time, event) ~ ., data = vet)</span><span leaf=""><br></span><span leaf="">explainer &lt;- explain(model,</span><span leaf=""><br></span><span leaf="">                     data = vet[,-c(1:2)],</span><span leaf=""><br></span><span leaf="">                     y = Surv(vet</span><span><span leaf="">$time</span></span><span leaf="">, vet</span><span><span leaf="">$event</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">shap &lt;- model_survshap(explainer, vet[-c(1:2)])</span><span leaf=""><br></span><span leaf="">p1 &lt;- plot(shap)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p2 &lt;- plot(shap, geom = </span><span><span leaf="">"beeswarm"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p1+p2</span></code></pre></section><p><span leaf=""><br></span></p><p><span leaf="">结果会对基因进行排序，然后就可以根据需求挑选基因进行下一步分析了。</span></p><p><span leaf="">Notes: </span><code><span leaf="">model_survshap()</span></code><span leaf="">速度比较慢，要耐心等待。</span></p><p><span leaf=""><br></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDyf6A1TJTbh3GcyIibAMiaKRMpx6WP1CtfLZMMq9ES9zN6ic0VBibvSTCBQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9009259259259259" data-type="png" data-w="1080" width="1194.4" data-imgfileid="100004275" src="https://mmbiz.qpic.cn/sz_mmbiz_png/C0nicuvoMeDFGl0u2ibdhaciaHgJFHTJGQDyf6A1TJTbh3GcyIibAMiaKRMpx6WP1CtfLZMMq9ES9zN6ic0VBibvSTCBQ/640?wx_fmt=png&amp;from=appmsg"></section><hr><p><span leaf="">声明：</span><span><span leaf="">本文代码均整理自网络，由于本人水平有限，缺点和疏漏在所难免，恳请大佬不吝指正。仅供交流学习，禁止用于商业用途，如有侵权，请联系删除。️</span></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dXQXU_rkCUB_9kIip-uv2g",target="_blank" rel="noopener noreferrer">原文链接</a>
