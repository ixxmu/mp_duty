---
title: "单细胞转录组下游分析（2）marker基因筛选、细胞注释"
date: 2025-01-13T00:02:00Z
draft: ["false"]
tags: [
  "fetched",
  "医学生之学习生信"
]
categories: ["Acdemic"]
---
单细胞转录组下游分析（2）marker基因筛选、细胞注释 by 医学生之学习生信
------
<div><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>上文利用harmony算法去除批次效应并细胞分类，接下来要鉴定Marker基因</p></section></section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>包的准备参考上文</p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span>#marker基因的筛选################</span></span></code><code><span><span>#寻找差异基因时的差异倍数</span></span></code><code><span>Logfc = <span>0.3</span><span>##表示logFC阈值，大于该阈值认为差异表达，默认值是0.25</span></span></code><code><span><span>#差异基因时最小的表达比例</span></span></code><code><span>Minpct = <span>0.25</span><span>##表示某个基因在两个cluster的一个或者2个的25％以上的细胞有表达才纳入差异分析</span></span></code><code><span>DefaultAssay(sce) &lt;- <span>"RNA"</span></span></code><code><span>sce.markers &lt;- FindAllMarkers(object = sce,logfc.threshold = Logfc, </span></code><code><span>                              min.pct = Minpct,only.pos = <span>T</span>)</span></code><code><span>sce.markers[<span>"pct.diff"</span>]=sce.markers$pct.1-sce.markers$pct.2</span></code><code><span>sce.markers &lt;- sce.markers[sce.markers$p_val_adj&lt;<span>0.05</span>,]</span></code><code><span><span>length</span>(unique(sce.markers$gene))</span></code><code><span>head(sce.markers)</span></code><code><span><br></span></code><code><span>write.table(sce.markers,<span>'scRNA_marker_gene.txt'</span>,<span>quote</span> = <span>F</span>,row.names = <span>F</span>,sep=<span>'\t'</span>)</span></code><code><span><br></span></code></pre></section></section><section powered-by="xiumi.us"><p>可视化</p></section><section powered-by="xiumi.us"><section><ul><li><li><li></ul><pre data-lang="c"><code><span>DimPlot(sce, reduction = <span>"umap"</span>, group.by = <span>"orig.ident"</span>, pt.size = <span>.1</span>, split.by = <span>'orig.ident'</span>)</span></code><code><span>DimPlot(sce, reduction = <span>"umap"</span>, group.by = <span>"Phase"</span>, pt.size = <span>.1</span>)　#按照细胞周期进行划分</span></code><code><span>DimPlot(sce, reduction = <span>"umap"</span>, label = TRUE, pt.size = <span>.1</span>)　  </span></code></pre></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.6101851851851852" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTujjUibhnrfnicLIV1Llc3DtkHnoLwOqWDo2pmjtjmwwicTjSRWAbSFvdQw/640?wx_fmt=png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTujjUibhnrfnicLIV1Llc3DtkHnoLwOqWDo2pmjtjmwwicTjSRWAbSFvdQw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p>细胞注释</p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>install.packages(<span>"BiocManager"</span>)</span></code><code><span>BiocManager::install(<span>"SingleR"</span>)</span></code><code><span>library(SingleR)</span></code><code><span>BiocManager::install(<span>"celldex"</span>)</span></code><code><span>library(celldex)</span></code><code><span>BiocManager::install(<span>"BiocParallel"</span>)</span></code><code><span>library(BiocParallel)</span></code><code><span>library(Seurat)</span></code><code><span><span>#下载</span></span></code><code><span>hpca.se &lt;- HumanPrimaryCellAtlasData()</span></code><code><span>load(<span>'sce2.RData'</span>)</span></code><code><span><span>#获取基因的表达谱的count数据</span></span></code><code><span>testdata &lt;- GetAssayData(sce, slot=<span>"data"</span>)</span></code><code><span><span>#获取聚类的亚群</span></span></code><code><span>clusters &lt;- sce@meta.data$seurat_clusters</span></code><code><span>pred.sce &lt;- SingleR(test =  testdata, </span></code><code><span>                    ref = hpca.se, </span></code><code><span>                    labels = hpca.se$label.fine,</span></code><code><span>                    method = <span>"clusters"</span>,</span></code><code><span>                    clusters = clusters, </span></code><code><span>                    assay.type.test = <span>"logcounts"</span>, </span></code><code><span>                    assay.type.ref = <span>"logcounts"</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>plotScoreHeatmap(pred.sce)</span></code><code><span>celltype = data.frame(ClusterID=rownames(pred.sce), celltype=pred.sce$labels</span></code><code><span>                      , stringsAsFactors = <span>F</span>)</span></code><code><span>celltype</span></code><code><span>write.table(celltype,<span>'celltype.txt'</span>,<span>quote</span> = <span>F</span>,sep = <span>'\t'</span>,row.names = <span>F</span>)</span></code><code><span><span>#修改亚群的名称</span></span></code><code><span>sce &lt;- RenameIdents(object = sce, </span></code><code><span>                    <span>"0"</span> = celltype[<span>1</span>,<span>2</span>],</span></code><code><span>                    <span>"1"</span> = celltype[<span>2</span>,<span>2</span>],</span></code><code><span>                    <span>"2"</span> = celltype[<span>3</span>,<span>2</span>],</span></code><code><span>                    <span>"3"</span> = celltype[<span>4</span>,<span>2</span>],</span></code><code><span>                    <span>"4"</span> = celltype[<span>5</span>,<span>2</span>],</span></code><code><span>                    <span>"5"</span> = celltype[<span>6</span>,<span>2</span>],</span></code><code><span>                    <span>"6"</span> = celltype[<span>7</span>,<span>2</span>],</span></code><code><span>                    <span>"7"</span> = celltype[<span>8</span>,<span>2</span>],</span></code><code><span>                    <span>"8"</span> = celltype[<span>9</span>,<span>2</span>],</span></code><code><span>                    <span>"9"</span> = celltype[<span>10</span>,<span>2</span>],</span></code><code><span>                    <span>"10"</span> = celltype[<span>11</span>,<span>2</span>])</span></code><code><span><br></span></code><code><span><span>length</span>(table(sce@active.ident))</span></code><code><span>allcolour=<span>c</span>(<span>"#DC143C"</span>,<span>"#0000FF"</span>,<span>"#20B2AA"</span>,<span>"#FFA500"</span>,<span>"#9370DB"</span>,<span>"#98FB98"</span>,<span>"#F08080"</span>,<span>"#1E90FF"</span>,<span>"#7CFC00"</span>,<span>"#FFFF00"</span>,</span></code><code><span>            <span>"#808000"</span>,<span>"#FF00FF"</span>,<span>"#CCCCFF"</span>,<span>"#000000"</span>,<span>"#7B68EE"</span>,<span>"#9400D3"</span>,<span>"#A0522D"</span>,<span>"#800080"</span>,<span>"#D2B48C"</span>,<span>"#D2691E"</span>,</span></code><code><span>            <span>"#87CEEB"</span>,<span>"#40E0D0"</span>,<span>"#5F9EA0"</span>,<span>"#FF1493"</span>,<span>"#0000CD"</span>,<span>"#008B8B"</span>,<span>"#FFE4B5"</span>,<span>"#8A2BE2"</span>,<span>"#228B22"</span>,<span>"#E9967A"</span>,</span></code><code><span>            <span>"#4682B4"</span>,<span>"#32CD32"</span>,<span>"#F0E68C"</span>,<span>"#FFFFE0"</span>,<span>"#EE82EE"</span>,<span>"#FF6347"</span>,<span>"#6A5ACD"</span>,<span>"#9932CC"</span>,<span>"#8B008B"</span>,<span>"#8B4513"</span>,</span></code><code><span>            <span>"#DEB887"</span>)</span></code><code><span><span>length</span>(table(sce@active.ident))</span></code><code><span>mycolor = allcolour[<span>1</span>:<span>length</span>(table(sce@active.ident))]</span></code><code><span><br></span></code><code><span>umap_celltype&lt;-DimPlot(sce,cols=mycolor,</span></code><code><span>                       reduction=<span>"umap"</span>,</span></code><code><span>                       label = <span>"T"</span>, </span></code><code><span>                       pt.size = <span>0.2</span>,</span></code><code><span>                       label.size = <span>5</span>)</span></code><code><span><br></span></code><code><span>umap_celltype</span></code><code><span>ggplot2::ggsave(<span>'umap_celltype.pdf'</span>,plot = umap_celltype,he=<span>7</span>,wi=<span>9</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p>然后根据作者提供的marker对细胞亚群进行贴现</p></section><section powered-by="xiumi.us"><section><img data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuJvRpcRGWbtKsjicct2JAQbHYVibnFkL4QDGB4PNjPYVsBKibICgbF3kUw/640?wx_fmt=png" data-ratio="0.6101851851851852" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuJvRpcRGWbtKsjicct2JAQbHYVibnFkL4QDGB4PNjPYVsBKibICgbF3kUw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><p>补充：我们自己对细胞亚群注释时，可以用以下代码进行手动注释</p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># Tumor cells were identified using MLANA, MITF, and DCT.</span></span></code><code><span><span># Tumor cells were further divided into subgroups </span></span></code><code><span><span># by expression of PRAME and GEP genes</span></span></code><code><span><br></span></code><code><span>library(ggplot2) </span></code><code><span>genes_to_check = <span>c</span>(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>,   <span># T cells</span></span></code><code><span>                   <span>'KLRD1'</span>, <span># natural killer (NK) cells</span></span></code><code><span>                   <span>'FCGR3B'</span>, <span>#neutrophils</span></span></code><code><span>                   <span>'MS4A1'</span> ,<span>'IGHG4'</span>, <span># b cells </span></span></code><code><span>                   <span>'RPE65'</span>,<span>'RCVRN'</span>,</span></code><code><span>                   <span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>,   <span>'MKI67'</span> ,<span>'TOP2A'</span>,</span></code><code><span>                   <span>'MLANA'</span>, <span>'MITF'</span>,  <span>'DCT'</span>,<span>'PRAME'</span> , <span>'GEP'</span> )</span></code><code><span>library(stringr)  </span></code><code><span>p_paper_markers &lt;- DotPlot(sce.all, features = genes_to_check,</span></code><code><span>                           assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p_paper_markers</span></code><code><span>ggsave(plot=p_paper_markers,</span></code><code><span>       filename=<span>"check_paper_marker_by_seurat_cluster.pdf"</span>,width = <span>12</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>参考</strong></p><p># T Cells (CD3D, CD3E, CD8A), </p><p># B cells (CD19, CD79A, MS4A1 [CD20]), </p><p># Plasma cells (IGHG1, MZB1, SDC1, CD79A), </p><p># Monocytes and macrophages (CD68, CD163, CD14),</p><p># NK Cells (FGFBP2, FCG3RA, CX3CR1),  </p><p># Photoreceptor cells (RCVRN), </p><p># Fibroblasts (FGF7, MME), </p><p># Endothelial cells (PECAM1, VWF). </p><p># epi or tumor (EPCAM, KRT19, PROM1, ALDH1A1, CD24).</p><p># immune (CD45+,PTPRC), epithelial/cancer (EpCAM+,EPCAM), </p><p># stromal(CD10+,MME,fibo or CD31+,PECAM1,endo) </p></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p><strong>all_marker</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>library(ggplot2) </span></code><code><span>genes_to_check = <span>c</span>(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>, <span>'CD4'</span>,<span>'CD8A'</span>,<span>'CD19'</span>, <span>'CD79A'</span>, <span>'MS4A1'</span> ,</span></code><code><span>                   <span>'IGHG1'</span>, <span>'MZB1'</span>, <span>'SDC1'</span>,</span></code><code><span>                   <span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>, </span></code><code><span>                   <span>'TPSAB1'</span> , <span>'TPSB2'</span>,  <span># mast cells,</span></span></code><code><span>                   <span>'RCVRN'</span>,<span>'FPR1'</span> , <span>'ITGAM'</span> ,</span></code><code><span>                   <span>'FGF7'</span>,<span>'MME'</span>, <span>'ACTA2'</span>,</span></code><code><span>                   <span>'PECAM1'</span>, <span>'VWF'</span>, </span></code><code><span>                   <span>'EPCAM'</span> , <span>'KRT19'</span>, <span>'PROM1'</span>, <span>'ALDH1A1'</span> )</span></code><code><span>library(stringr)  </span></code><code><span>p_all_markers &lt;- DotPlot(sce.all, features = genes_to_check,</span></code><code><span>                         assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p_all_markers</span></code><code><span>ggsave(plot=p_all_markers, filename=<span>"check_all_marker_by_seurat_cluster.pdf"</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>T cells</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>genes_to_check = <span>c</span>(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>, <span>'CD4'</span>,<span>'CD8A'</span>,</span></code><code><span>                   <span>'CCR7'</span>, <span>'SELL'</span> , <span>'TCF7'</span>,<span>'CXCR6'</span> , <span>'ITGA1'</span>,</span></code><code><span>                   <span>'FOXP3'</span>, <span>'IL2RA'</span>,  <span>'CTLA4'</span>,<span>'GZMB'</span>, <span>'GZMK'</span>,<span>'CCL5'</span>,</span></code><code><span>                   <span>'IFNG'</span>, <span>'CCL4'</span>, <span>'CCL3'</span> ,</span></code><code><span>                   <span>'PRF1'</span> , <span>'NKG7'</span>) </span></code><code><span>library(stringr)  </span></code><code><span>p &lt;- DotPlot(sce.all, features = genes_to_check,</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p</span></code><code><span>ggsave(plot=p, filename=<span>"check_Tcells_marker_by_seurat_cluster.pdf"</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>B cells</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># mast cells, TPSAB1 and TPSB2 </span></span></code><code><span><span># B cell,  CD79A  and MS4A1 (CD20) </span></span></code><code><span><span># naive B cells, such as MS4A1 (CD20), CD19, CD22, TCL1A, and CD83, </span></span></code><code><span><span># plasma B cells, such as CD38, TNFRSF17 (BCMA), and IGHG1/IGHG4</span></span></code><code><span>genes_to_check = <span>c</span>(<span>'CD3D'</span>,<span>'MS4A1'</span>,<span>'CD79A'</span>,</span></code><code><span>                   <span>'CD19'</span>, <span>'CD22'</span>, <span>'TCL1A'</span>,  <span>'CD83'</span>, <span>#  naive B cells</span></span></code><code><span>                   <span>'CD38'</span>,<span>'TNFRSF17'</span>,<span>'IGHG1'</span>,<span>'IGHG4'</span>, <span># plasma B cells,</span></span></code><code><span>                   <span>'TPSAB1'</span> , <span>'TPSB2'</span>,  <span># mast cells,</span></span></code><code><span>                   <span>'PTPRC'</span> ) </span></code><code><span>p &lt;- DotPlot(sce.all, features = genes_to_check,</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p</span></code><code><span>ggsave(plot=p, filename=<span>"check_Bcells_marker_by_seurat_cluster.pdf"</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>myeloids</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># Monocytes and macrophages (CD68, CD163, CD14),</span></span></code><code><span>genes_to_check = <span>c</span>(<span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>,  <span>'CD86'</span>, <span>'LAMP3'</span>, <span>## DC </span></span></code><code><span>                   <span>'CD68'</span>,  <span>'CD163'</span>,<span>'MRC1'</span>,<span>'MSR1'</span>,<span>'ITGAE'</span>,<span>'ITGAM'</span>,<span>'ITGAX'</span>,<span>'SIGLEC7'</span>, </span></code><code><span>                   <span>'MAF'</span>,<span>'APOE'</span>,<span>'FOLR2'</span>,<span>'RELB'</span>,<span>'BST2'</span>,<span>'BATF3'</span>)</span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(genes_to_check),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p</span></code><code><span>ggsave(plot=p, filename=<span>"check_myeloids_marker_by_seurat_cluster.pdf"</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>epi</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span><span># epi or tumor (EPCAM, KRT19, PROM1, ALDH1A1, CD24).</span></span></code><code><span><span># - alveolar type I cell (AT1; AGER+)</span></span></code><code><span><span># - alveolar type II cell (AT2; SFTPA1)</span></span></code><code><span><span># - secretory club cell (Club; SCGB1A1+)</span></span></code><code><span><span># - basal airway epithelial cells (Basal; KRT17+)</span></span></code><code><span><span># - ciliated airway epithelial cells (Ciliated; TPPP3+) </span></span></code><code><span><br></span></code><code><span>genes_to_check = <span>c</span>(  <span>'EPCAM'</span> , <span>'KRT19'</span>, <span>'PROM1'</span>, <span>'ALDH1A1'</span> ,</span></code><code><span>                     <span>'AGER'</span>,<span>'SFTPA1'</span>,<span>'SCGB1A1'</span>,<span>'KRT17'</span>,<span>'TPPP3'</span>,</span></code><code><span>                     <span>'KRT4'</span>,<span>'KRT14'</span>,<span>'KRT8'</span>,<span>'KRT18'</span>,</span></code><code><span>                     <span>'CD3D'</span>,<span>'PTPRC'</span> ) </span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(genes_to_check),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p</span></code><code><span>ggsave(plot=p, filename=<span>"check_epi_marker_by_seurat_cluster.pdf"</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span>library(ggplot2) </span></code><code><span>genes_to_check = <span>c</span>(  <span>'PROM1'</span>, <span>'CD44'</span> , <span>'THY1'</span>,<span>'ACTA2'</span>,<span>'MKI67'</span>, <span>'ESR1'</span>,</span></code><code><span>                     <span>'EPCAM'</span>, <span>'KRT19'</span>, </span></code><code><span>                     <span>'KRT8'</span>,  <span>'KRT18'</span>, <span>'KRT5'</span>,  <span>'KRT14'</span>, </span></code><code><span>                     <span>'ALDH1A1'</span>, <span>'CD24'</span> )</span></code><code><span>p &lt;- DotPlot(sce.all, features = genes_to_check,</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p  </span></code><code><span>ggsave(filename = <span>'DotPlot_epi_recluster.pdf'</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>stromal</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>genes_to_check = <span>c</span>(<span>'TEK'</span>,<span>"PTPRC"</span>,<span>"EPCAM"</span>,<span>"PDPN"</span>,<span>"PECAM1"</span>,<span>'PDGFRB'</span>,</span></code><code><span>                   <span>'CSPG4'</span>,<span>'GJB2'</span>, <span>'RGS5'</span>,<span>'ITGA7'</span>,</span></code><code><span>                   <span>'ACTA2'</span>,<span>'RBP1'</span>,<span>'CD36'</span>, <span>'ADGRE5'</span>,<span>'COL11A1'</span>,<span>'FGF7'</span>, <span>'MME'</span>)</span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(genes_to_check),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p</span></code><code><span>ggsave(plot=p, filename=<span>"check_stromal_marker_by_seurat_cluster.pdf"</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>check</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>library(ggplot2) </span></code><code><span>genes_to_check = <span>c</span>(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>, <span>'CD4'</span>,<span>'CD8A'</span>,</span></code><code><span>                   <span>'CD19'</span>, <span>'CD79A'</span>, <span>'MS4A1'</span> ,</span></code><code><span>                   <span>'IGHG1'</span>, <span>'MZB1'</span>, <span>'SDC1'</span>,</span></code><code><span>                   <span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>, </span></code><code><span>                   <span>'TPSAB1'</span> , <span>'TPSB2'</span>,  <span># mast cells,</span></span></code><code><span>                   <span>'RCVRN'</span>,<span>'FPR1'</span> , <span>'ITGAM'</span> ,</span></code><code><span>                   <span>'C1QA'</span>,  <span>'C1QB'</span>,  <span># mac</span></span></code><code><span>                   <span>'S100A9'</span>, <span>'S100A8'</span>, <span>'MMP19'</span>,<span># monocyte</span></span></code><code><span>                   <span>'FCGR3A'</span>,</span></code><code><span>                   <span>'LAMP3'</span>, <span>'IDO1'</span>,<span>'IDO2'</span>,<span>## DC3 </span></span></code><code><span>                   <span>'CD1E'</span>,<span>'CD1C'</span>, <span># DC2</span></span></code><code><span>                   <span>'KLRB1'</span>,<span>'NCR1'</span>, <span># NK </span></span></code><code><span>                   <span>'FGF7'</span>,<span>'MME'</span>, <span>'ACTA2'</span>, <span>## fibo </span></span></code><code><span>                   <span>'DCN'</span>, <span>'LUM'</span>,  <span>'GSN'</span> , <span>## mouse PDAC fibo </span></span></code><code><span>                   <span>'MKI67'</span> , <span>'TOP2A'</span>, </span></code><code><span>                   <span>'PECAM1'</span>, <span>'VWF'</span>,  <span>## endo </span></span></code><code><span>                   <span>'EPCAM'</span> , <span>'KRT19'</span>, <span>'PROM1'</span>, <span>'ALDH1A1'</span> )</span></code><code><span><br></span></code><code><span>library(stringr)  </span></code><code><span>genes_to_check=str_to_upper(genes_to_check)</span></code><code><span>genes_to_check</span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(genes_to_check),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p </span></code><code><span>ggsave(<span>'check_last_markers.pdf'</span>,height = <span>11</span>,width = <span>11</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>cg=<span>c</span>(<span>'NUPR1'</span>,<span>'RARRES2'</span>,<span>'MLEC'</span>,<span>'TMSB10'</span>,</span></code><code><span>     <span>'HES1'</span>,<span>'SNHG5'</span>,<span>'TFF3'</span>,<span>'WFDC2'</span>,<span>'MUC2'</span>,<span>'ITLN1'</span>,<span>'SPINK4'</span>,</span></code><code><span>     <span>'MGST1'</span>,<span>'ADH1C'</span>,<span>'UGT2B17'</span>,<span>'CRYBA2'</span>,<span>'SCGN'</span>,<span>'PCSK1N'</span>,<span>'PTMS'</span>,</span></code><code><span>     <span>'TUBA1A'</span>,<span>'MT2A'</span>,<span>'MT1G'</span>,<span>'KRT19'</span>,<span>'PHGR1'</span>,<span>'S100A6'</span>,<span>'SELENBP1'</span>,<span>'CA1'</span>,</span></code><code><span>     <span>'CEACAM1'</span>,<span>'CEACAM7'</span>,<span>'GUCA2A'</span>,<span>'SLC26A3'</span>,<span>'AQP8'</span>,<span>'CA7'</span>,<span>'BEST4'</span>,</span></code><code><span>     <span>'OTOP2'</span>,<span>'MT1H'</span>,<span>'LYPD8'</span>,<span>'CA4'</span>,<span>'HLA−DRA'</span>,<span>'HLA−DQB1'</span>,<span>'HLA−DPB1'</span>,</span></code><code><span>     <span>'CD74'</span>,<span>'CD83'</span>,<span>'EEF1A1'</span>,<span>'CREM'</span>,<span>'CCL5'</span>,<span>'TMSB4X'</span>,</span></code><code><span>     <span>'B2M'</span>,<span>'SRGN'</span>,<span>'LAPTM5'</span>,<span>'VIM'</span>,<span>'CD44'</span>,<span>'TPSAB1'</span>,<span>'TPSB2'</span>)</span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(cg),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p </span></code><code><span>ggsave(<span>'check_paper_markers.pdf'</span>,height = <span>11</span>,width = <span>11</span>)</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>细分B</strong></p></section><section powered-by="xiumi.us"><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="r"><code><span>g=<span>c</span>(<span>'CD34CD117'</span>,<span>'c-kit'</span>,<span>'Flt-3'</span>,<span>'Flk-2'</span>,<span>'IL-7R alpha'</span>,<span>'CD127'</span>,<span>'Neprilysin'</span>,<span>'CD10'</span>,</span></code><code><span><span>'Pax5'</span>,<span>'BSAP'</span>,<span>'Sca-1'</span>,<span>'Ly6'</span>,<span>'B220'</span>,<span>'CD45R'</span>,<span>'C1qR1'</span>,<span>'CD93'</span>,<span>'CD19'</span>,<span>'B220'</span>,<span>'CD45R'</span>,<span>'C1qR1'</span>,<span>'CD93'</span>,<span>'CD19'</span>,<span>'CD24'</span>,<span>'CD34'</span>,<span>'CD38'</span>,<span>'CD43'</span>,<span>'CD117'</span>,<span>'c-kit'</span>,<span>'CXCR4'</span>,<span>'Flt-3'</span>,<span>'Flk-2'</span>,<span>'IL-7R'</span>,<span>'alpha'</span>,<span>'CD127'</span>,<span>'Neprilysin'</span>,<span>'CD10'</span>,<span>'Pax5'</span>,<span>'BSAP'</span>,<span>'B220'</span>,<span>'CD45R'</span>,<span>'C1qR1'</span>,<span>'CD93'</span>,<span>'CD19'</span>,<span>'CD24'</span>,<span>'CD34'</span>,<span>'CD38'</span>,<span>'CD43'</span>,<span>'CD117'</span>,<span>'c-kit'</span>,<span>'CD20'</span>,<span>'IL-3R alpha'</span>,<span>'IL-7R alpha'</span>,<span>'CD127'</span>,<span>'Neprilysin'</span>,<span>'CD10'</span>,<span>'Pax5'</span>,<span>'BSAP'</span>,</span></code><code><span>p &lt;- DotPlot(sce.all, features = unique(cg),</span></code><code><span>             assay=<span>'RNA'</span>  )  + coord_flip()</span></code><code><span><br></span></code><code><span>p </span></code><code><span>ggsave(<span>'check_paper_markers.pdf'</span>,height = <span>11</span>,width = <span>11</span>)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>Progenitor B Cell</span></code><code><span>CD34</span></code><code><span>CD117/<span>c</span>-kit</span></code><code><span>Flt-<span>3</span>/Flk-<span>2</span></span></code><code><span>IL-<span>7</span>R alpha/CD127</span></code><code><span>Neprilysin/CD10</span></code><code><span>Pax5/BSAP</span></code><code><span>Sca-<span>1</span>/Ly6</span></code><code><span><br></span></code><code><span>Mouse B1 or B2 Progenitor Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span><br></span></code><code><span>Pre-Pro B Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD24</span></code><code><span>CD34</span></code><code><span>CD38</span></code><code><span>CD43</span></code><code><span>CD117/<span>c</span>-kit</span></code><code><span>CXCR4</span></code><code><span>Flt-<span>3</span>/Flk-<span>2</span></span></code><code><span>IL-<span>7</span>R alpha/CD127</span></code><code><span>Neprilysin/CD10</span></code><code><span>Pax5/BSAP</span></code><code><span><br></span></code><code><span>Pro-B Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD24</span></code><code><span>CD34</span></code><code><span>CD38</span></code><code><span>CD43</span></code><code><span>CD117/<span>c</span>-kit</span></code><code><span>CD20</span></code><code><span>IL-<span>3</span>R alpha</span></code><code><span>IL-<span>7</span>R alpha/CD127</span></code><code><span>Neprilysin/CD10</span></code><code><span>Pax5/BSAP</span></code><code><span><br></span></code><code><span>Pre-B Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD24</span></code><code><span>CD34</span></code><code><span>CD38</span></code><code><span>CD43</span></code><code><span>CD117/<span>c</span>-kit</span></code><code><span>CD20</span></code><code><span>IL-<span>3</span>R alpha</span></code><code><span>IL-<span>4</span>R alpha</span></code><code><span>IL-<span>7</span>R alpha/CD127</span></code><code><span>Neprilysin/CD10</span></code><code><span>Pax5/BSAP</span></code><code><span><br></span></code><code><span>Immature B Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD24</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>CD40/TNFRSF5</span></code><code><span>CD43</span></code><code><span>CD117/<span>c</span>-kit</span></code><code><span>CD20</span></code><code><span>IL-<span>4</span>R alpha</span></code><code><span>IL-<span>7</span>R alpha/CD127</span></code><code><span>Neprilysin/CD10</span></code><code><span><br></span></code><code><span>Human Transitional B Cell</span></code><code><span>C1qR1/CD93</span></code><code><span>CD5</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD24</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>Neprilysin/CD10</span></code><code><span>TACI/TNFRSF13B</span></code><code><span>BR3</span></code><code><span><br></span></code><code><span>Mouse Transitional <span>1</span> (T1) or Transitional <span>2</span> (T2) B Cell (from B2 Progenitor Cell)</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD24</span></code><code><span>CD43</span></code><code><span><br></span></code><code><span>Mouse B1a or B1b Cell (from B1 Progenitor Cell)</span></code><code><span>CD1d</span></code><code><span>CD5</span></code><code><span>CD19</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD43</span></code><code><span><br></span></code><code><span>Marginal Zone B Cell 边缘区（MZ）B细胞</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD1c/BDCA-<span>1</span></span></code><code><span>CD1d</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD43</span></code><code><span>CD20</span></code><code><span>FCRL3/FcRH3</span></code><code><span>TACI/TNFRSF13B</span></code><code><span><br></span></code><code><span>Follicular B Cell 滤泡（FO）B细胞</span></code><code><span>B220/CD45R</span></code><code><span>CD1d</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD24</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>CD43</span></code><code><span>CD20</span></code><code><span>CXCR5</span></code><code><span>MHC <span>class</span> II (I-A/I-E)</span></code><code><span>Neprilysin/CD10</span></code><code><span>Siglec-<span>2</span>/CD22</span></code><code><span>TACI/TNFRSF13B</span></code><code><span><br></span></code><code><span>Activated Germinal Center B Cell</span></code><code><span>B220/CD45R</span></code><code><span>CD19</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>CD40/TNFRSF5</span></code><code><span>CD83</span></code><code><span>CD20</span></code><code><span>MHC <span>class</span> II (I-A/I-E)</span></code><code><span>TACI/TNFRSF13B</span></code><code><span>BR3</span></code><code><span><br></span></code><code><span>Memory B Cell</span></code><code><span>B220/CD45R</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD40/TNFRSF5</span></code><code><span>CD20</span></code><code><span>MHC <span>class</span> II (I-A/I-E)</span></code><code><span>TACI/TNFRSF13B</span></code><code><span>CD80</span></code><code><span>CD84</span></code><code><span>CD86</span></code><code><span><br></span></code><code><span>Plasmablast</span></code><code><span>B220/CD45R</span></code><code><span>BCMA/TNFRSF17</span></code><code><span>C1qR1/CD93</span></code><code><span>CD19</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>Syndecan-<span>1</span>/CD138</span></code><code><span><br></span></code><code><span>Plasma Cell</span></code><code><span>B220/CD45R</span></code><code><span>BCMA/TNFRSF17</span></code><code><span>BLIMP1/PRDM1</span></code><code><span>CD19</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>CD20</span></code><code><span>CXCR4</span></code><code><span>MHC <span>class</span> II (I-A/I-E)</span></code><code><span>Syndecan-<span>1</span>/CD138</span></code><code><span>CD139</span></code><code><span>CD78</span></code><code><span><br></span></code><code><span>Regulatory B Cell 调节性B（Breg）细胞</span></code><code><span>B220/CD45R</span></code><code><span>B7-<span>1</span>/CD80</span></code><code><span>B7-<span>2</span>/CD86</span></code><code><span>BLIMP1/PRDM1</span></code><code><span>CD1d</span></code><code><span>CD5</span></code><code><span>CD11b/Integrin alpha M</span></code><code><span>CD19</span></code><code><span>CD21</span></code><code><span>CD23/Fc epsilon RII</span></code><code><span>CD24</span></code><code><span>CD27/TNFRSF7</span></code><code><span>CD38</span></code><code><span>CD40/TNFRSF5</span></code><code><span>CD44</span></code><code><span>CD69</span></code><code><span>CD72</span></code><code><span>CD20</span></code><code><span>CD25/IL-<span>2</span>R alpha</span></code><code><span>CXCR4</span></code><code><span>DEP-<span>1</span>/CD148</span></code><code><span>EBI3</span></code><code><span>EMMPRIN/CD147</span></code><code><span>HLA-DR</span></code><code><span>IgM</span></code><code><span>IL-<span>10</span></span></code><code><span>IL-<span>12</span> R beta <span>2</span></span></code><code><span>IL-<span>12</span>/IL-<span>35</span> p35</span></code><code><span>IL-<span>21</span></span></code><code><span>IL-<span>21</span>R</span></code><code><span>IL-<span>23</span>/IL-<span>39</span> p19</span></code><code><span>IL-<span>27</span> R alpha/WSX-<span>1</span>/TCCR</span></code><code><span>IL-<span>39</span> (IL-<span>23</span>p19/EBI3)</span></code><code><span>IRF4</span></code><code><span>Siglec-<span>2</span>/CD22</span></code><code><span>STAT1</span></code><code><span>STAT3</span></code><code><span>Syndecan-<span>1</span>/CD138</span></code><code><span>TACI/TNFRSF13B</span></code><code><span>TGF-beta</span></code><code><span>TIM-<span>1</span>/KIM-<span>1</span>/HAVCR</span></code><code><span>TLR4</span></code><code><span><br></span></code><code><span>未成熟B细胞的Marker</span></code><code><span>未成熟的B细胞表达CD19，CD <span>20</span>，CD34，CD38和CD45R，但不表达IgM。</span></code><code><span>成熟B细胞的Marker</span></code><code><span>对于大多数成熟的B细胞，关键Markers包括IgM和CD19（一种抗原蛋白受体）</span></code><code><span>活化的B细胞：CD30+（一种凋亡调节剂）</span></code><code><span>血浆B细胞：CD19-CD78+</span></code></pre></section></section><section powered-by="xiumi.us"><p><strong>T细胞再分</strong></p></section><section powered-by="xiumi.us"><p>Tn--初始T细胞，T细胞家族的起点</p><p>Tm--记忆型T细胞，记住抗原以备不时之需</p><p>Tcm--中央记忆型T细胞，中央军，Tem的前体细胞，归巢到淋巴结接收刺激信号分化Tem</p><p>Tem--效应记忆型T细胞，组织常驻记忆T细胞，地方驻军</p><p>Tfh--滤泡辅助型T细胞</p><p>Tfr--滤泡调节型T细胞</p><p>Treg--调节型T细胞，免疫系统的刹车，肿瘤免疫逃逸的帮凶</p><p>Tex--耗竭型T细胞，被肿瘤细胞摧残的失活T细胞，有逆转可能</p><p>Th--辅助性T细胞（Helper T cells,Th），具有协助体液免疫和细胞免疫的功能</p><p>而8个亚群 for 3,628 CD8+ ，也是N初始,CM中央记忆型,EM记忆型,EX耗竭型的功能分类。</p></section><section powered-by="xiumi.us"><section><img data-ratio="0.7481481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuuZllNyvjyfns0bwIdGCmsOELeHNPUic29bRByhVelQZHIAD871cbGTw/640?wx_fmt=png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuuZllNyvjyfns0bwIdGCmsOELeHNPUic29bRByhVelQZHIAD871cbGTw/640?wx_fmt=png"></section></section><section powered-by="xiumi.us"><section><img data-ratio="0.6611111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuajBU7N7YPQ1hddyyQE2TyXVB2Y6aM3Lue8xaF2o6IumuvDurlkeXiaA/640?wx_fmt=png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuajBU7N7YPQ1hddyyQE2TyXVB2Y6aM3Lue8xaF2o6IumuvDurlkeXiaA/640?wx_fmt=png"></section></section></section></section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><section powered-by="xiumi.us"><section><img data-src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuSDibbVfErqsQdsEYmP3BydBFWtuJJ7Vc9zzeshD1yk3SGmu0uNNXclg/640?wx_fmt=png" data-ratio="0.64" data-w="1000" src="https://mmbiz.qpic.cn/mmbiz_png/dgYTF46r3icZFpKZBAw8MpYzPEzcVePTuSDibbVfErqsQdsEYmP3BydBFWtuJJ7Vc9zzeshD1yk3SGmu0uNNXclg/640?wx_fmt=png"></section></section><p powered-by="xiumi.us"><br></p><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section><section><section powered-by="xiumi.us"><section><p><strong><span>作者｜</span></strong>陈咪祺</p><p><strong><span>审核人｜</span></strong>梁晓杰<br></p></section></section></section></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><p>还不点击蓝字关注</p></section></section><section><section powered-by="xiumi.us"><section><section><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/tA04TpZzA5icXo4TaHlmr9bEQw37s35bmb6FGJKwvUkOaicGibqTEFLQQdDuA1LbiaGQdXYrcsGgArYNvbLhGVPwzg/640?wx_fmt=gif" data-ratio="1.627659574468085" data-w="658" src="https://mmbiz.qpic.cn/mmbiz_gif/tA04TpZzA5icXo4TaHlmr9bEQw37s35bmb6FGJKwvUkOaicGibqTEFLQQdDuA1LbiaGQdXYrcsGgArYNvbLhGVPwzg/640?wx_fmt=gif"></section></section></section></section></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rS8Vu0c2XD8T93WgxCPSWQ",target="_blank" rel="noopener noreferrer">原文链接</a>
