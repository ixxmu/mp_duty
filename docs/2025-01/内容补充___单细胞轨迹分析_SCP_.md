---
title: "内容补充---单细胞轨迹分析（SCP）"
date: 2025-01-21T09:45:41Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞空间交响乐"
]
categories: ["Acdemic"]
---
内容补充---单细胞轨迹分析（SCP） by 单细胞空间交响乐
------
<div><h4 data-line="0"><span leaf="">作者，Evil Genius</span></h4><h4 data-line="2"><span leaf="">今日目标，单细胞轨迹分析</span></h4><section nodeleaf=""><img data-imgfileid="100010759" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3L1tEDDEgACCjBXIx2sQspicicumoicuDvWD9DQxjaLtib7XCyjIRIBJewA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3L1tEDDEgACCjBXIx2sQspicicumoicuDvWD9DQxjaLtib7XCyjIRIBJewA/640?wx_fmt=other&amp;from=appmsg"></section><section><br></section><section nodeleaf=""><img data-imgfileid="100010755" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3JAFVuTic7ibzLk4iby9FSoicFNic8cTDlQDVAsCxR5gNFBh2icjJ4RhqnaGw/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3JAFVuTic7ibzLk4iby9FSoicFNic8cTDlQDVAsCxR5gNFBh2icjJ4RhqnaGw/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="6"><span leaf="">关于单细胞轨迹分析，虽然大家觉得已经烂大街了，但是分析的很好的人，屈指可数。</span></h4><h4 data-line="8"><span leaf="">关于轨迹分析，有几个难点需要优先解决</span></h4><section nodeleaf=""><img data-imgfileid="100010756" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3fVe0lNJqqRk4jEEfYFiaw9U3qgluWPlCBMAT2hicAJgmibDicPg8BRzOMQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3fVe0lNJqqRk4jEEfYFiaw9U3qgluWPlCBMAT2hicAJgmibDicPg8BRzOMQ/640?wx_fmt=other&amp;from=appmsg"></section><blockquote><p><span leaf=""><span textstyle="">1、基因的选择，如何选择合适的用于计算发育的基因对结果影响巨大</span></span><br><span leaf=""><span textstyle="">2、细胞注释，错误的注释结果带来的就是错误的发育结果</span></span><br><span leaf=""><span textstyle="">3、方法的选择，传统的依据基因推断还是velocity方式，现在通常二者都有</span></span><br><span leaf=""><span textstyle="">4、关键性的基因轨迹变化，也就是我们课上常说的基因“开关”</span></span></p></blockquote><section nodeleaf=""><img data-imgfileid="100010757" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3qHD32s8emB961ficicKthVcqWFhRFoKKlhY6l1CdSV6aNqYmBUB3ARVw/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3qHD32s8emB961ficicKthVcqWFhRFoKKlhY6l1CdSV6aNqYmBUB3ARVw/640?wx_fmt=other&amp;from=appmsg"></section><section><br></section><section nodeleaf=""><img data-imgfileid="100010758" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3GZaOLjfrIyPsoVp4dnQ0gPg2wdrTnXG2euRt0YU9HRY30HwdibtoicGg/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3GZaOLjfrIyPsoVp4dnQ0gPg2wdrTnXG2euRt0YU9HRY30HwdibtoicGg/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="19"><span leaf="">今日我们分享的方法，SCP，参考地址在</span><span leaf="">https://zhanghao-njmu.github.io/SCP/</span><span leaf="">，这个地方是一系列软件的合成，当然，也有创新。</span></h4><h4 data-line="21"><span leaf="">大家同时也可以参考老俊俊的方法，也非常不错，</span><span leaf="">https://github.com/junjunlab/ClusterGVis</span><span leaf="">。</span></h4><section nodeleaf=""><img data-imgfileid="100010764" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3pTAbeV9zp91fhfF4WiaEUBVVP7VzOsZnIVfnEWibKbNYlqpSqpJWPiaFA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3pTAbeV9zp91fhfF4WiaEUBVVP7VzOsZnIVfnEWibKbNYlqpSqpJWPiaFA/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="25"><span leaf="">SCP需要R和python的联合环境使用</span></h4><pre><code><span><span leaf="">if</span></span><span leaf=""> (!</span><span><span leaf="">require</span></span><span leaf="">(</span><span><span leaf="">"devtools"</span></span><span leaf="">, quietly = </span><span><span leaf="">TRUE</span></span><span leaf="">)) {</span><br><span leaf="">  install.packages(</span><span><span leaf="">"devtools"</span></span><span leaf="">)</span><br><span leaf="">}</span><br><span leaf="">devtools::install_github(</span><span><span leaf="">"zhanghao-njmu/SCP"</span></span><span leaf="">)</span><br><br><span leaf="">SCP::PrepareEnv()</span><br><br><span leaf="">options(reticulate.conda_binary = </span><span><span leaf="">"/path/to/conda"</span></span><span leaf="">)</span><br><span leaf="">SCP::PrepareEnv()</span><br></code></pre><h4 data-line="37"><span leaf="">或者</span></h4><pre><code><span leaf="">SCP::PrepareEnv(</span><br><span leaf="">  miniconda_repo = </span><span><span leaf="">"https://mirrors.bfsu.edu.cn/anaconda/miniconda"</span></span><span leaf="">,</span><br><span leaf="">  pip_options = </span><span><span leaf="">"-i https://pypi.tuna.tsinghua.edu.cn/simple"</span></span><br><span leaf="">)</span><br></code></pre><h4 data-line="45"><span leaf="">我们来看看示例代码，示例数据在<span textstyle="">https://doi.org/10.1242/dev.173849</span></span><span leaf="">，来看看关键的核心步骤。</span></h4><pre><code><span leaf="">library(SCP)</span><br><span leaf="">library(BiocParallel)</span><br><span><span leaf="">register</span></span><span leaf="">(MulticoreParam(workers = </span><span><span leaf="">8</span></span><span leaf="">, progressbar = </span><span><span leaf="">TRUE</span></span><span leaf="">))</span><br><br><span leaf="">data(</span><span><span leaf="">"pancreas_sub"</span></span><span leaf="">)</span><br><span leaf="">print(pancreas_sub)</span><br><span><span leaf="">#&gt; An object of class Seurat </span></span><br><span><span leaf="">#&gt; 47874 features across 1000 samples within 3 assays </span></span><br><span><span leaf="">#&gt; Active assay: RNA (15958 features, 3467 variable features)</span></span><br><span><span leaf="">#&gt;  2 other assays present: spliced, unspliced</span></span><br><span><span leaf="">#&gt;  2 dimensional reductions calculated: PCA, UMAP</span></span><br></code></pre><h5 data-line="59"><span leaf="">看的出来，V4结构,而且基础分析 + 可变剪切都已经做过了。</span></h5><pre><code><span leaf="">ht </span><span><span leaf="">&lt;</span><span><span leaf="">-</span></span><span leaf=""> </span><span><span leaf="">CellCorHeatmap</span></span><span leaf="">(</span><br><span leaf="">  </span><span><span leaf="">srt_query</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">srt_ref</span></span><span leaf=""> = </span><span><span leaf="">panc8_rename,</span></span><br><span leaf="">  </span><span><span leaf="">query_group</span></span><span leaf=""> = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">, </span><span><span leaf="">ref_group</span></span><span leaf=""> = </span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><br><span leaf="">  </span><span><span leaf="">nlabel</span></span><span leaf=""> = </span><span><span leaf="">3,</span></span><span leaf=""> </span><span><span leaf="">label_by</span></span><span leaf=""> = </span><span><span leaf="">"row"</span></span><span leaf="">,</span><br><span leaf="">  </span><span><span leaf="">show_row_names</span></span><span leaf=""> = </span><span><span leaf="">TRUE,</span></span><span leaf=""> </span><span><span leaf="">show_column_names</span></span><span leaf=""> = </span><span><span leaf="">TRUE</span></span><br><span leaf="">)</span><br><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">ht</span></span><span leaf="">$</span><span><span leaf="">plot</span></span><span leaf="">)</span><br></span></code></pre><section nodeleaf=""><img data-imgfileid="100010763" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3mKDFXtVjzF3dLFAO1V9YnoZZO2xVQNlw3SSOTfusA6tPAwVR8exAuA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3mKDFXtVjzF3dLFAO1V9YnoZZO2xVQNlw3SSOTfusA6tPAwVR8exAuA/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="70"><span leaf="">PAGA analysis</span></h4><pre><code><span leaf="">pancreas_sub </span><span><span leaf="">&lt;</span><span><span leaf="">-</span></span><span leaf=""> </span><span><span leaf="">RunPAGA</span></span><span leaf="">(</span><br><span leaf="">  </span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">,</span><br><span leaf="">  </span><span><span leaf="">linear_reduction</span></span><span leaf=""> = </span><span><span leaf="">"PCA"</span></span><span leaf="">, </span><span><span leaf="">nonlinear_reduction</span></span><span leaf=""> = </span><span><span leaf="">"UMAP"</span></span><br><span leaf="">)</span><br><span><span leaf="">PAGAPlot</span></span><span leaf="">(</span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">reduction</span></span><span leaf=""> = </span><span><span leaf="">"UMAP"</span></span><span leaf="">, </span><span><span leaf="">label</span></span><span leaf=""> = </span><span><span leaf="">TRUE,</span></span><span leaf=""> </span><span><span leaf="">label_insitu</span></span><span leaf=""> = </span><span><span leaf="">TRUE,</span></span><span leaf=""> </span><span><span leaf="">label_repel</span></span><span leaf=""> = </span><span><span leaf="">TRUE)</span></span><br></span></code></pre><section nodeleaf=""><img data-imgfileid="100010762" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3LUTqhvJGl7d8TnevAWiaS09iayhia19A1SgO57PJgEH9MdzTIWP7AQF8w/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3LUTqhvJGl7d8TnevAWiaS09iayhia19A1SgO57PJgEH9MdzTIWP7AQF8w/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="80"><span leaf="">Velocity analysis</span></h4><pre><code><span leaf="">pancreas_sub </span><span><span leaf="">&lt;</span><span><span leaf="">-</span></span><span leaf=""> </span><span><span leaf="">RunSCVELO</span></span><span leaf="">(</span><br><span leaf="">  </span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">,</span><br><span leaf="">  </span><span><span leaf="">linear_reduction</span></span><span leaf=""> = </span><span><span leaf="">"PCA"</span></span><span leaf="">, </span><span><span leaf="">nonlinear_reduction</span></span><span leaf=""> = </span><span><span leaf="">"UMAP"</span></span><br><span leaf="">)</span><br><span><span leaf="">VelocityPlot</span></span><span leaf="">(</span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">reduction</span></span><span leaf=""> = </span><span><span leaf="">"UMAP"</span></span><span leaf="">, </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">)</span><br></span></code></pre><section nodeleaf=""><img data-imgfileid="100010760" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod35fk5LY2pmewNjdBIm89ujImmcABLV4QttoxwphpYcC67oZVHTKibI7g/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod35fk5LY2pmewNjdBIm89ujImmcABLV4QttoxwphpYcC67oZVHTKibI7g/640?wx_fmt=other&amp;from=appmsg"></section><pre><code><span leaf="">VelocityPlot(srt = pancreas_sub, reduction = </span><span><span leaf="">"UMAP"</span></span><span leaf="">, plot_type = </span><span><span leaf="">"stream"</span></span><span leaf="">)</span><br></code></pre><section nodeleaf=""><img data-imgfileid="100010761" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod32v49ff6diaT8dRAiavfOEibu5puF9toiaPFo1ChVNeUwibtDE840WlkJ5Wg/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod32v49ff6diaT8dRAiavfOEibu5puF9toiaPFo1ChVNeUwibtDE840WlkJ5Wg/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="96"><span leaf="">Differential expression analysis</span></h4><pre><code><span leaf="">pancreas_sub </span><span><span leaf="">&lt;</span><span><span leaf="">-</span></span><span leaf=""> </span><span><span leaf="">RunDEtest</span></span><span leaf="">(</span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"CellType"</span></span><span leaf="">, </span><span><span leaf="">fc.threshold</span></span><span leaf=""> = </span><span><span leaf="">1,</span></span><span leaf=""> </span><span><span leaf="">only.pos</span></span><span leaf=""> = </span><span><span leaf="">FALSE)</span></span><br><span><span leaf="">VolcanoPlot</span></span><span leaf="">(</span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"CellType"</span></span><span leaf="">)</span><br></span></code></pre><section nodeleaf=""><img data-imgfileid="100010770" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod36YGW2H2IeazCK10Tp7rsBy4ictnQvCRITHickKxD3Wz6aSyibUMKQogQw/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod36YGW2H2IeazCK10Tp7rsBy4ictnQvCRITHickKxD3Wz6aSyibUMKQogQw/640?wx_fmt=other&amp;from=appmsg"></section><pre><code><span leaf="">DEGs &lt;- pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox</span><br><span leaf="">DEGs &lt;- DEGs[with(DEGs, avg_log2FC &gt; </span><span><span leaf="">1</span></span><span leaf=""> &amp; p_val_adj &lt; </span><span><span leaf="">0.05</span></span><span leaf="">), ]</span><br><span><span leaf=""># Annotate features with transcription factors and surface proteins</span></span><br><span leaf="">pancreas_sub &lt;- AnnotateFeatures(pancreas_sub, species = </span><span><span leaf="">"Mus_musculus"</span></span><span leaf="">, db = c(</span><span><span leaf="">"TF"</span></span><span leaf="">, </span><span><span leaf="">"CSPA"</span></span><span leaf="">))</span><br><span leaf="">ht &lt;- FeatureHeatmap(</span><br><span leaf="">  srt = pancreas_sub, group.by = </span><span><span leaf="">"CellType"</span></span><span leaf="">, features = DEGs$gene, feature_split = DEGs$group1,</span><br><span leaf="">  species = </span><span><span leaf="">"Mus_musculus"</span></span><span leaf="">, db = c(</span><span><span leaf="">"GO_BP"</span></span><span leaf="">, </span><span><span leaf="">"KEGG"</span></span><span leaf="">, </span><span><span leaf="">"WikiPathway"</span></span><span leaf="">), anno_terms = </span><span><span leaf="">TRUE</span></span><span leaf="">,</span><br><span leaf="">  feature_annotation = c(</span><span><span leaf="">"TF"</span></span><span leaf="">, </span><span><span leaf="">"CSPA"</span></span><span leaf="">), feature_annotation_palcolor = </span><span><span leaf="">list</span></span><span leaf="">(c(</span><span><span leaf="">"gold"</span></span><span leaf="">, </span><span><span leaf="">"steelblue"</span></span><span leaf="">), c(</span><span><span leaf="">"forestgreen"</span></span><span leaf="">)),</span><br><span leaf="">  height = </span><span><span leaf="">5</span></span><span leaf="">, width = </span><span><span leaf="">4</span></span><br><span leaf="">)</span><br><span><span leaf="">print</span></span><span leaf="">(ht$plot)</span><br></code></pre><section nodeleaf=""><img data-imgfileid="100010767" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod38bwnREicf2CmZlT0eDLiaeeqk6uItibWv2wWEbFPT78Z1qhCLDgu9ibPTQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod38bwnREicf2CmZlT0eDLiaeeqk6uItibWv2wWEbFPT78Z1qhCLDgu9ibPTQ/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="119"><span leaf="">Enrichment analysis(over-representation)</span></h4><pre><code><span leaf="">EnrichmentPlot(</span><br><span leaf="">  srt = pancreas_sub, group_by = </span><span><span leaf="">"CellType"</span></span><span leaf="">, group_use = </span><span><span leaf="">"Ductal"</span></span><span leaf="">,</span><br><span leaf="">  plot_type = </span><span><span leaf="">"enrichmap"</span></span><br><span leaf="">)</span><br></code></pre><section nodeleaf=""><img data-imgfileid="100010769" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3icgvarL8QcKu3YYehXaHFibiakjibuex1VElDiayItOHFSduE2szd66Hhhg/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3icgvarL8QcKu3YYehXaHFibiakjibuex1VElDiayItOHFSduE2szd66Hhhg/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="128"><span leaf="">Enrichment analysis(GSEA)</span></h4><pre><code><span leaf="">pancreas_sub </span><span><span leaf="">&lt;</span><span><span leaf="">-</span></span><span leaf=""> </span><span><span leaf="">RunGSEA</span></span><span leaf="">(</span><br><span leaf="">  </span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"CellType"</span></span><span leaf="">, </span><span><span leaf="">db</span></span><span leaf=""> = </span><span><span leaf="">"GO_BP"</span></span><span leaf="">, </span><span><span leaf="">species</span></span><span leaf=""> = </span><span><span leaf="">"Mus_musculus"</span></span><span leaf="">,</span><br><span leaf="">  </span><span><span leaf="">DE_threshold</span></span><span leaf=""> = </span><span><span leaf="">"p_val_adj &lt; 0.05"</span></span><br><span leaf="">)</span><br><span><span leaf="">GSEAPlot</span></span><span leaf="">(</span><span><span leaf="">srt</span></span><span leaf=""> = </span><span><span leaf="">pancreas_sub,</span></span><span leaf=""> </span><span><span leaf="">group_by</span></span><span leaf=""> = </span><span><span leaf="">"CellType"</span></span><span leaf="">, </span><span><span leaf="">group_use</span></span><span leaf=""> = </span><span><span leaf="">"Endocrine"</span></span><span leaf="">, </span><span><span leaf="">id_use</span></span><span leaf=""> = </span><span><span leaf="">"GO:0007186"</span></span><span leaf="">)</span><br></span></code></pre><section nodeleaf=""><img data-imgfileid="100010766" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3nJZEvRkuiaHoqgzJ9icuf1VRDSI520E8RB6D9Dx3kvUBPgiaAfJ4joFIA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3nJZEvRkuiaHoqgzJ9icuf1VRDSI520E8RB6D9Dx3kvUBPgiaAfJ4joFIA/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="137"><span leaf="">Dynamic features</span></h4><pre><code><span leaf="">pancreas_sub &lt;- RunDynamicFeatures(srt = pancreas_sub, lineages = c(</span><span><span leaf="">"Lineage1"</span></span><span leaf="">, </span><span><span leaf="">"Lineage2"</span></span><span leaf="">), n_candidates = </span><span><span leaf="">200</span></span><span leaf="">)</span><br><span leaf="">ht &lt;- DynamicHeatmap(</span><br><span leaf="">  srt = pancreas_sub, lineages = c(</span><span><span leaf="">"Lineage1"</span></span><span leaf="">, </span><span><span leaf="">"Lineage2"</span></span><span leaf="">),</span><br><span leaf="">  use_fitted = </span><span><span leaf="">TRUE</span></span><span leaf="">, n_split = </span><span><span leaf="">6</span></span><span leaf="">, reverse_ht = </span><span><span leaf="">"Lineage1"</span></span><span leaf="">,</span><br><span leaf="">  species = </span><span><span leaf="">"Mus_musculus"</span></span><span leaf="">, db = </span><span><span leaf="">"GO_BP"</span></span><span leaf="">, anno_terms = </span><span><span leaf="">TRUE</span></span><span leaf="">, anno_keys = </span><span><span leaf="">TRUE</span></span><span leaf="">, anno_features = </span><span><span leaf="">TRUE</span></span><span leaf="">,</span><br><span leaf="">  heatmap_palette = </span><span><span leaf="">"viridis"</span></span><span leaf="">, cell_annotation = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">,</span><br><span leaf="">  separate_annotation = </span><span><span leaf="">list</span></span><span leaf="">(</span><span><span leaf="">"SubCellType"</span></span><span leaf="">, c(</span><span><span leaf="">"Nnat"</span></span><span leaf="">, </span><span><span leaf="">"Irx1"</span></span><span leaf="">)), separate_annotation_palette = c(</span><span><span leaf="">"Paired"</span></span><span leaf="">, </span><span><span leaf="">"Set1"</span></span><span leaf="">),</span><br><span leaf="">  feature_annotation = c(</span><span><span leaf="">"TF"</span></span><span leaf="">, </span><span><span leaf="">"CSPA"</span></span><span leaf="">), feature_annotation_palcolor = </span><span><span leaf="">list</span></span><span leaf="">(c(</span><span><span leaf="">"gold"</span></span><span leaf="">, </span><span><span leaf="">"steelblue"</span></span><span leaf="">), c(</span><span><span leaf="">"forestgreen"</span></span><span leaf="">)),</span><br><span leaf="">  pseudotime_label = </span><span><span leaf="">25</span></span><span leaf="">, pseudotime_label_color = </span><span><span leaf="">"red"</span></span><span leaf="">,</span><br><span leaf="">  height = </span><span><span leaf="">5</span></span><span leaf="">, width = </span><span><span leaf="">2</span></span><br><span leaf="">)</span><br><span><span leaf="">print</span></span><span leaf="">(ht$plot)</span><br></code></pre><section nodeleaf=""><img data-imgfileid="100010765" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3L1tEDDEgACCjBXIx2sQspicicumoicuDvWD9DQxjaLtib7XCyjIRIBJewA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3L1tEDDEgACCjBXIx2sQspicicumoicuDvWD9DQxjaLtib7XCyjIRIBJewA/640?wx_fmt=other&amp;from=appmsg"></section><pre><code><span leaf="">DynamicPlot(</span><br><span leaf="">  srt = pancreas_sub, lineages = c(</span><span><span leaf="">"Lineage1"</span></span><span leaf="">, </span><span><span leaf="">"Lineage2"</span></span><span leaf="">), group.by = </span><span><span leaf="">"SubCellType"</span></span><span leaf="">,</span><br><span leaf="">  features = c(</span><span><span leaf="">"Plk1"</span></span><span leaf="">, </span><span><span leaf="">"Hes1"</span></span><span leaf="">, </span><span><span leaf="">"Neurod2"</span></span><span leaf="">, </span><span><span leaf="">"Ghrl"</span></span><span leaf="">, </span><span><span leaf="">"Gcg"</span></span><span leaf="">, </span><span><span leaf="">"Ins2"</span></span><span leaf="">),</span><br><span leaf="">  compare_lineages = </span><span><span leaf="">TRUE</span></span><span leaf="">, compare_features = </span><span><span leaf="">FALSE</span></span><br><span leaf="">)</span><br></code></pre><section nodeleaf=""><img data-imgfileid="100010772" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3G9GicfKpHYf3lBUAfHaamKamKwDJYicvk6QLkibpKmdVgIr4D54ysnwnA/640?wx_fmt=other&amp;from=appmsg" data-type="other" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkeZraW782IRxmyvFtywod3G9GicfKpHYf3lBUAfHaamKamKwDJYicvk6QLkibpKmdVgIr4D54ysnwnA/640?wx_fmt=other&amp;from=appmsg"></section><h4 data-line="163"><span leaf="">生活很好，有你更好</span></h4><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="3a72bf99-4bd0-4bec-ae90-f80109a3e1e0" data-pid="101_10027744673443"></mp-common-cpsad></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vKbuhxSoDKk1Za7_Mcs84Q",target="_blank" rel="noopener noreferrer">原文链接</a>
