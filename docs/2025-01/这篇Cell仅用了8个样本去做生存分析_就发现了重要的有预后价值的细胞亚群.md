---
title: "è¿™ç¯‡Cellä»…ç”¨äº†8ä¸ªæ ·æœ¬å»åšç”Ÿå­˜åˆ†æï¼Œå°±å‘ç°äº†é‡è¦çš„æœ‰é¢„åä»·å€¼çš„ç»†èƒäºšç¾¤"
date: 2025-01-08T06:48:42Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡èµ„æ–™å…±äº«"
]
categories: ["Acdemic"]
---
è¿™ç¯‡Cellä»…ç”¨äº†8ä¸ªæ ·æœ¬å»åšç”Ÿå­˜åˆ†æï¼Œå°±å‘ç°äº†é‡è¦çš„æœ‰é¢„åä»·å€¼çš„ç»†èƒäºšç¾¤ by ç”Ÿä¿¡èµ„æ–™å…±äº«
------
<div><section nodeleaf=""><img data-imgfileid="100000160" data-ratio="1.749074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1nSCwAMbcPvlKfEPiaQnjJsbyzwriciaPgKrNqtrDqJlXUsx9l1GjCwTvA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1nSCwAMbcPvlKfEPiaQnjJsbyzwriciaPgKrNqtrDqJlXUsx9l1GjCwTvA/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">ä¸€ç›´è§‰å¾—è‡ªå·±çš„æ ·æœ¬é‡å°‘ï¼Œåšå‡ºæ¥çš„ç»“æœä¼šä¸ä¼šä¸å¯é ï¼Œçœ‹åˆ°è¿™ç¯‡Cellæ‰çŸ¥é“ï¼Œå°±ç®—æ˜¯8ä¸ªæ ·æœ¬ï¼Œåªè¦æ˜¯æœ‰æ„ä¹‰ï¼Œæ ·æœ¬é‡å†å°‘ä¹Ÿä¸æ¯«ä¸å½±å“é‡è¦ä¸œè¥¿çš„å‘ç°ã€‚ï¼ˆä¸»è¦å‘ç°äº†ä¸€ä¸ªå·¨å™¬ç»†èƒäºšç¾¤ï¼Œç„¶ååˆ†å±€è¿™ä¸ªäºšç¾¤å»åšç”Ÿå­˜åˆ†æï¼‰</span></span></section><section nodeleaf=""><img data-imgfileid="100000153" data-ratio="0.4" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1WksB1iavWwQPuCNZo1EsYrjp6AFnkALR0RnCnLE0YJlvgkfcFz8bzHw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1WksB1iavWwQPuCNZo1EsYrjp6AFnkALR0RnCnLE0YJlvgkfcFz8bzHw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1Bl0IRAxUL8lMKZuSWzVvUQVBR1vFtovJ6j1TMzvtuxujalibrweydXA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.825925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100000152" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1Bl0IRAxUL8lMKZuSWzVvUQVBR1vFtovJ6j1TMzvtuxujalibrweydXA/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">ä¸è¿‡è¿™ç¯‡æ–‡ç« åé¢è¿˜æ˜¯åšäº†ä¸€ä¸ªéªŒè¯é˜Ÿåˆ—ï¼Œæ‰©å¤§äº†æ ·æœ¬é‡</span></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1lxsauZK5jAU8rGl4aWXaPibiapossiaN80l70NFhH2aS5bRxkxGgwHcGA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.42592592592592593" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100000154" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1lxsauZK5jAU8rGl4aWXaPibiapossiaN80l70NFhH2aS5bRxkxGgwHcGA/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">ä¸‹é¢æ˜¯ä¸»è¦çš„ç ”ç©¶å†…å®¹ï¼Œå¼€å‘äº†ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å•ç»†èƒè›‹ç™½è´¨æ´»æ€§åˆ†æçš„åŒ…VIPERï¼ˆç”¨çš„æ˜¯å•ç»†èƒè½¬å½•ç»„çš„æ•°æ®å»åšçš„ï¼‰</span></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum19D2lib7oiahH5KA9YyPzdy6Mr86eH1LRvfcnXjDL6kUurNKdUkU40nEQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.25925925925925924" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100000156" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum19D2lib7oiahH5KA9YyPzdy6Mr86eH1LRvfcnXjDL6kUurNKdUkU40nEQ/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">è®°å½•ä¸€ä¸ªå›¾åƒæ•°æ®çš„å·¥å…·åŒ…</span></span><span><span leaf=""><span textstyle="">phenoptrï¼Œæœ‰å¾ˆå¤šåŠŸèƒ½å¯ä»¥ç”¨</span></span></span></section><section nodeleaf=""><img data-imgfileid="100000157" data-ratio="0.3888888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1su16Rq7z9tN6ZAs6P38aOWF4ia120G14V2BkWoG9N8Ow5Z31zqrL0UQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZdyCZLtNqCdGnsE9Lo8sum1su16Rq7z9tN6ZAs6P38aOWF4ia120G14V2BkWoG9N8Ow5Z31zqrL0UQ/640?wx_fmt=png&amp;from=appmsg"></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="go"><code><span leaf=""><span># åŠ è½½ phenoptr åº“ï¼Œç”¨äºç»†èƒåˆ†å‰²æ•°æ®åˆ†æç­‰ç›¸å…³æ“ä½œ</span></span></code><code><span leaf=""><span>library(phenoptr)</span></span></code><code><span leaf=""><span># åˆ›å»ºä¸€ä¸ªæ•°æ®æ¡† ihc_dataï¼ŒåŒ…å«æ‚£è€…ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‚£è€…ç¼–å·ã€è‚¿ç˜¤åˆ†æœŸå’Œè‚¿ç˜¤åˆ†çº§</span></span></code><code><span leaf=""><span>ihc_data=data.frame(patient=c(</span><span>"PatientA"</span><span>,</span><span>"PatientB"</span><span>,</span><span>"PatientC"</span><span>,</span><span>"Patient1"</span><span>,</span><span>"Patient2"</span><span>,</span><span>"Patient3"</span><span>,</span><span>"Patient4"</span><span>,</span><span>"Patient5"</span><span>,</span><span>"Patient6"</span><span>,</span><span>"Patient7"</span><span>,</span><span>"Patient8"</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stage=c(</span><span>"pT3a"</span><span>,</span><span>"pT1b"</span><span>,</span><span>"pT1b"</span><span>,</span><span>"pT1b"</span><span>,</span><span>"pT3a"</span><span>,</span><span>"pT3a"</span><span>,</span><span>"pT1b"</span><span>,</span><span>"pT3a"</span><span>,</span><span>"pT1b"</span><span>,</span><span>"pT3a"</span><span>,</span><span>"pT1b"</span><span>),grade=c(</span><span>3</span><span>,</span><span>2</span><span>,</span><span>2</span><span>,</span><span>2</span><span>,</span><span>2</span><span>,</span><span>1</span><span>,</span><span>1</span><span>,</span><span>4</span><span>,</span><span>2</span><span>,</span><span>3</span><span>,</span><span>2</span><span>))</span></span></code><code><span leaf=""><span># åˆå§‹åŒ–ä¸‰ä¸ªç©ºå‘é‡ï¼Œç”¨äºå­˜å‚¨ C1Qã€TREM2ã€APOE åœ¨å·¨å™¬ç»†èƒä¸­çš„ä¼˜åŠ¿æ¯”</span></span></code><code><span leaf=""><span>C1Q.macrophage.oddsratio=c()</span></span></code><code><span leaf=""><span>TREM2.macrophage.oddsratio=c()</span></span></code><code><span leaf=""><span>APOE.macrophage.oddsratio=c()</span></span></code><code><span leaf=""><span># å®šä¹‰è‚¿ç˜¤ç»„ç»‡ä¸­ä¸åŒç»†èƒç±»å‹çš„é¢‘ç‡å‘é‡ï¼ŒåŒ…æ‹¬ CA9+ã€CD3+ç­‰å¤šç§ç»†èƒç±»å‹ä»¥åŠå…¶ä»–ç±»å‹</span></span></code><code><span leaf=""><span>tumor_freqs=c(</span><span>"CA9+"</span><span>,</span><span>"CD3+"</span><span>,</span><span>"CD68/CD163+"</span><span>,</span><span>"C1Q+CD68/CD163+"</span><span>,</span><span>"TREM2+CD68/CD163+"</span><span>,</span><span>"APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>,</span><span>"C1Q+APOE+CD68/CD163+"</span><span>,</span><span>"TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+"</span><span>,</span><span>"TREM2+"</span><span>,</span><span>"APOE+"</span><span>,</span><span>"Other"</span><span>)</span></span></code><code><span leaf=""><span># å®šä¹‰åŸºè´¨ç»„ç»‡ä¸­ä¸åŒç»†èƒç±»å‹çš„é¢‘ç‡å‘é‡ï¼Œä¸è‚¿ç˜¤ç»„ç»‡ä¸­çš„å®šä¹‰ç›¸åŒ</span></span></code><code><span leaf=""><span>stroma_freqs=c(</span><span>"CA9+"</span><span>,</span><span>"CD3+"</span><span>,</span><span>"CD68/CD163+"</span><span>,</span><span>"C1Q+CD68/CD163+"</span><span>,</span><span>"TREM2+CD68/CD163+"</span><span>,</span><span>"APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>,</span><span>"C1Q+APOE+CD68/CD163+"</span><span>,</span><span>"TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+"</span><span>,</span><span>"TREM2+"</span><span>,</span><span>"APOE+"</span><span>,</span><span>"Other"</span><span>)</span></span></code><code><span leaf=""><span># å®šä¹‰æ­£å¸¸ç»„ç»‡ä¸­ä¸åŒç»†èƒç±»å‹çš„é¢‘ç‡å‘é‡ï¼Œä¸è‚¿ç˜¤ç»„ç»‡ä¸­çš„å®šä¹‰ç›¸åŒï¼Œå¹¶æ·»åŠ ä¸€è¡Œ NaN å€¼</span></span></code><code><span leaf=""><span>normal_freqs=c(</span><span>"CA9+"</span><span>,</span><span>"CD3+"</span><span>,</span><span>"CD68/CD163+"</span><span>,</span><span>"C1Q+CD68/CD163+"</span><span>,</span><span>"TREM2+CD68/CD163+"</span><span>,</span><span>"APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>,</span><span>"C1Q+APOE+CD68/CD163+"</span><span>,</span><span>"TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+"</span><span>,</span><span>"TREM2+"</span><span>,</span><span>"APOE+"</span><span>,</span><span>"Other"</span><span>)</span></span></code><code><span leaf=""><span>normal_freqs=rbind(normal_freqs,rep(NaN,length(normal_freqs)))</span></span></code><code><span leaf=""><span># ä»¥ä¸‹æ˜¯å¯¹æ‚£è€… A çš„æ•°æ®åˆ†æ</span></span></code><code><span leaf=""><span># æ‚£è€… A çš„ä¿¡æ¯ï¼šstageÂ </span><span>3</span><span>ï¼ŒgradeÂ </span><span>3</span></span></code><code><span leaf=""><span># æ•°æ®æ–‡ä»¶è·¯å¾„ï¼šIHC_data_allsamples/Batch_Sp18_10879</span></span></code><code><span leaf=""><span># ä»¥ä¸‹æ˜¯è¯¥æ‚£è€…çš„ä¸€äº›ç»†èƒæ ‡è®°ç‰©åœ¨åŸºè´¨å’Œè‚¿ç˜¤ç»„ç»‡ä¸­çš„è¡¨è¾¾æ°´å¹³æ•°æ®</span></span></code><code><span leaf=""><span># APOE StromaÂ </span><span>2.72</span><span>Â TumorÂ </span><span>2.02</span></span></code><code><span leaf=""><span># C1Q StromaÂ </span><span>3.02</span><span>Â TumorÂ </span><span>2.5</span></span></code><code><span leaf=""><span># CA9 StromaÂ </span><span>4.12</span><span>Â Tumor</span></span></code><code><span leaf=""><span># CD3 StromaÂ </span><span>0.28</span><span>Â Tumor</span></span></code><code><span leaf=""><span># CD68+CD163+ StromaÂ </span><span>3.2</span><span>Â TumorÂ </span><span>2.2</span></span></code><code><span leaf=""><span># TREM2 StromaÂ </span><span>0.42</span><span>Â TumorÂ </span><span>0.28</span></span></code><code><span leaf=""><span># è¯»å–æ‚£è€… A çš„ç»†èƒåˆ†å‰²æ•°æ®æ–‡ä»¶ï¼Œå°†å¤šä¸ªæ–‡ä»¶çš„æ•°æ®åˆå¹¶åˆ° csd æ•°æ®æ¡†ä¸­</span></span></code><code><span leaf=""><span>files=list_cell_seg_files(</span><span>"IHC_data_allsamples/Batch_Sp18_10879"</span><span>)</span></span></code><code><span leaf=""><span>csd=read_cell_seg_data(files[</span><span>1</span><span>])</span></span></code><code><span leaf=""><span>for</span><span>(i inÂ </span><span>2</span><span>:length(files)){</span></span></code><code><span leaf=""><span>Â  t=read_cell_seg_data(files[i])</span></span></code><code><span leaf=""><span>Â  csd=rbind(csd,t)</span></span></code><code><span leaf=""><span>}</span></span></code><code><span leaf=""><span># è®¡ç®— C1Q åœ¨å·¨å™¬ç»†èƒä¸­çš„ä¼˜åŠ¿æ¯”ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ° C1Q.macrophage.oddsratio å‘é‡ä¸­</span></span></code><code><span leaf=""><span># é¦–å…ˆç”Ÿæˆä¸€ä¸ªåˆ—è”è¡¨ï¼Œæ¯”è¾ƒ C1Q è¡¨è¾¾æ°´å¹³å’Œå·¨å™¬ç»†èƒæ ‡è®°ç‰©çš„å…³ç³»</span></span></code><code><span leaf=""><span>write.table(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>),sep=</span><span>"\t"</span><span>,quote=F)</span></span></code><code><span leaf=""><span># ä½¿ç”¨ fisher ç²¾ç¡®æ£€éªŒè®¡ç®—ä¼˜åŠ¿æ¯”ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ°å‘é‡ä¸­</span></span></code><code><span leaf=""><span>C1Q.macrophage.oddsratio=c(C1Q.macrophage.oddsratio,fisher.test(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>))$estimate)</span></span></code><code><span leaf=""><span># è®¡ç®— TREM2 åœ¨å·¨å™¬ç»†èƒä¸­çš„ä¼˜åŠ¿æ¯”ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ° TREM2.macrophage.oddsratio å‘é‡ä¸­</span></span></code><code><span leaf=""><span>write.table(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>),sep=</span><span>"\t"</span><span>,quote=F)</span></span></code><code><span leaf=""><span>TREM2.macrophage.oddsratio=c(TREM2.macrophage.oddsratio,fisher.test(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>))$estimate)</span></span></code><code><span leaf=""><span># è®¡ç®— APOE åœ¨å·¨å™¬ç»†èƒä¸­çš„ä¼˜åŠ¿æ¯”ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ° APOE.macrophage.oddsratio å‘é‡ä¸­</span></span></code><code><span leaf=""><span>write.table(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>),sep=</span><span>"\t"</span><span>,quote=F)</span></span></code><code><span leaf=""><span>APOE.macrophage.oddsratio=c(APOE.macrophage.oddsratio,fisher.test(table(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>,csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>))$estimate)</span></span></code><code><span leaf=""><span># æ ¹æ®ç»†èƒæ ‡è®°ç‰©çš„è¡¨è¾¾æ°´å¹³å¯¹ç»†èƒè¿›è¡Œåˆ†ç±»ï¼Œå¹¶å°†åˆ†ç±»ç»“æœå­˜å‚¨åœ¨ csd$celltype ä¸­</span></span></code><code><span leaf=""><span>csd$celltype=</span><span>"Other"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell CA9 (Opal 540) Mean`</span><span>&gt;</span><span>4.12</span><span>)]=</span><span>"CA9+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell CD3 (Opal 690) Â Mean`</span><span>&gt;</span><span>0.28</span><span>)]=</span><span>"CD3+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>)]=</span><span>"C1Q+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>)]=</span><span>"TREM2+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>)]=</span><span>"APOE+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"C1Q+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"TREM2+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"APOE+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>Â &amp; csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"C1Q+TREM2+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>Â &amp; csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"C1Q+APOE+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>Â &amp; csd$</span><span>`Entire Cell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"TREM2+APOE+CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$celltype[which(csd$</span><span>`Entire Cell C1q (Opal 520) Mean`</span><span>&gt;</span><span>2.5</span><span>Â &amp; csd$</span><span>`Entire Cell TREM2 (Opal 650) Mean`</span><span>&gt;</span><span>0.28</span><span>Â &amp; csd$</span><span>`EntirCell ApoE (Opal 620) Mean`</span><span>&gt;</span><span>2.02</span><span>Â &amp; csd$</span><span>`Entire Cell Macs (Opal 570) Mean`</span><span>&gt;</span><span>2.2</span><span>)]=</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span></span></code><code><span leaf=""><span># å°†ç»†èƒç±»å‹è½¬æ¢ä¸ºå› å­ç±»å‹ï¼Œå¹¶æŒ‡å®šå› å­æ°´å¹³</span></span></code><code><span leaf=""><span>csd$celltype=factor(csd$celltype,levels=c(</span><span>"CA9+"</span><span>,</span><span>"CD3+"</span><span>,</span><span>"CD68/CD163+"</span><span>,</span><span>"C1Q+CD68/CD163+"</span><span>,</span><span>"TREM2+CD68/CD163+"</span><span>,</span><span>"APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>,</span><span>"C1Q+APOE+CD68/CD163+"</span><span>,</span><span>"TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+"</span><span>,</span><span>"TREM2+"</span><span>,</span><span>"APOE+"</span><span>,</span><span>"Other"</span><span>))</span></span></code><code><span leaf=""><span># ç”Ÿæˆç»†èƒç±»å‹å’Œç»„ç»‡ç±»åˆ«äº¤å‰è¡¨ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶</span></span></code><code><span leaf=""><span>table(csd$celltype,csd$</span><span>`Tissue Category`</span><span>)</span></span></code><code><span leaf=""><span>write.table(table(csd$celltype,csd$</span><span>`Tissue Category`</span><span>),sep=</span><span>"\t"</span><span>,quote=F)</span></span></code><code><span leaf=""><span># è®¡ç®—ç»†èƒç±»å‹åœ¨ä¸åŒç»„ç»‡ç±»åˆ«ä¸­çš„é¢‘ç‡ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf=""><span>x=as.matrix(table(csd$celltype,csd$</span><span>`Tissue Category`</span><span>))</span></span></code><code><span leaf=""><span>x=as.data.frame(apply(x,</span><span>2</span><span>,function(y){y/sum(y)}))</span></span></code><code><span leaf=""><span># å°†è®¡ç®—å¾—åˆ°çš„é¢‘ç‡ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶</span></span></code><code><span leaf=""><span>write.table(x,sep=</span><span>"\t"</span><span>,quote=F)</span></span></code><code><span leaf=""><span># å°†åŸºè´¨ç»„ç»‡ä¸­çš„é¢‘ç‡ç»“æœæ·»åŠ åˆ° stroma_freqs ä¸­</span></span></code><code><span leaf=""><span>stroma_freqs=rbind(stroma_freqs,x$Stroma)</span></span></code><code><span leaf=""><span># å°†è‚¿ç˜¤ç»„ç»‡ä¸­çš„é¢‘ç‡ç»“æœæ·»åŠ åˆ° tumor_freqs ä¸­</span></span></code><code><span leaf=""><span>tumor_freqs=rbind(tumor_freqs,x$Tumor)</span></span></code><code><span leaf=""><span># å¦‚æœæœ‰æ­£å¸¸ç»„ç»‡çš„æ•°æ®ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ° normal_freqs ä¸­ï¼Œå¦åˆ™æ·»åŠ ä¸€è¡Œ NaN å€¼</span></span></code><code><span leaf=""><span>if</span><span>(ncol(x)==</span><span>3</span><span>){normal_freqs=rbind(normal_freqs,x$</span><span>`Adjacent normal`</span><span>)}Â </span><span>else</span><span>{normal_freqs=rbind(normal_freqs,rep(NaN,ncol(normal_freqs)))}</span></span></code><code><span leaf=""><span>####</span></span></code><code><span leaf=""><span>#### ä»¥ä¸‹éƒ¨åˆ†è®¡ç®— APOE+å·¨å™¬ç»†èƒä¸ APOE-å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒçš„å¹³å‡è·ç¦»ï¼Œå¹¶è¿›è¡Œç»Ÿè®¡æ£€éªŒ</span></span></code><code><span leaf=""><span>####</span></span></code><code><span leaf=""><span># å°†ç»†èƒç±»å‹èµ‹å€¼ç»™ csd$Phenotype</span></span></code><code><span leaf=""><span>csd$Phenotype=csd$celltype</span></span></code><code><span leaf=""><span># è®¡ç®—æ¯ä¸ªæ ·æœ¬ä¸­ç»†èƒåˆ° CA9+ç»†èƒçš„æœ€è¿‘è·ç¦»ï¼Œå­˜å‚¨åœ¨ distances åˆ—è¡¨ä¸­</span></span></code><code><span leaf=""><span># å¯¹äºæ¯ä¸ªæ ·æœ¬ï¼Œè°ƒç”¨ find_nearest_distance å‡½æ•°è®¡ç®—è·ç¦»</span></span></code><code><span leaf=""><span>distances=lapply(unique(csd$</span><span>`Sample Name`</span><span>),function(i){find_nearest_distance(csd[which(csd$</span><span>`Sample Name`</span><span>==i),],phenotypes=</span><span>"CA9+"</span><span>)})</span></span></code><code><span leaf=""><span>d=distances[[</span><span>1</span><span>]]</span></span></code><code><span leaf=""><span>for</span><span>(i inÂ </span><span>2</span><span>:length(distances)){</span></span></code><code><span leaf=""><span>Â  d=rbind(d,distances[[i]])</span></span></code><code><span leaf=""><span>}</span></span></code><code><span leaf=""><span># å°†è·ç¦»ç»“æœæ·»åŠ åˆ° csd æ•°æ®æ¡†ä¸­</span></span></code><code><span leaf=""><span>csd=cbind(csd,d)</span></span></code><code><span leaf=""><span># å°†ç»†èƒç±»å‹è½¬æ¢ä¸ºå­—ç¬¦å‹ï¼Œå­˜å‚¨åœ¨ csd$MacrophageType ä¸­</span></span></code><code><span leaf=""><span>csd$MacrophageType=as.character(csd$Phenotype)</span></span></code><code><span leaf=""><span># ç­›é€‰å‡ºç‰¹å®šç±»å‹çš„å·¨å™¬ç»†èƒæ•°æ®</span></span></code><code><span leaf=""><span>csd=csd[which(csd$MacrophageType %in% c(</span><span>"APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>,</span><span>"CD68/CD163+"</span><span>,</span><span>"TREM2+APOE+CD68/CD163+"</span><span>,</span><span>"TREM2+CD68/CD163+"</span><span>)),]</span></span></code><code><span leaf=""><span># å¯¹å·¨å™¬ç»†èƒç±»å‹è¿›è¡Œé‡æ–°ç¼–ç </span></span></code><code><span leaf=""><span>csd$MacrophageType[which(csd$MacrophageType %in% c(</span><span>"CD68/CD163+"</span><span>))]=</span><span>"CD68/CD163+"</span></span></code><code><span leaf=""><span>csd$MacrophageType[which(csd$MacrophageType %in% c(</span><span>"C1Q+TREM2+CD68/CD163+"</span><span>))]=</span><span>"CD68/CD163+APOE+"</span></span></code><code><span leaf=""><span># ç­›é€‰å‡º CD68/CD163+å’Œ CD68/CD163+APOE+ä¸¤ç§å·¨å™¬ç»†èƒç±»å‹çš„æ•°æ®</span></span></code><code><span leaf=""><span>csd=csd[which(csd$MacrophageType %in% c(</span><span>"CD68/CD163+"</span><span>,</span><span>"CD68/CD163+APOE+"</span><span>)),]</span></span></code><code><span leaf=""><span># ç»˜åˆ¶ APOE+å·¨å™¬ç»†èƒä¸ APOE-å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒè·ç¦»çš„å¯†åº¦å›¾</span></span></code><code><span leaf=""><span>ggplot(csd, aes(</span><span>`Distance to CA9+`</span><span>, color=MacrophageType)) +</span></span></code><code><span leaf=""><span>Â  geom_density(size=</span><span>1</span><span>)</span></span></code><code><span leaf=""><span># ç»˜åˆ¶ APOE+å·¨å™¬ç»†èƒä¸ APOE-å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒè·ç¦»çš„ç®±çº¿å›¾</span></span></code><code><span leaf=""><span>ggplot(csd, aes(MacrophageType,</span><span>`Distance to CA9+`</span><span>,color=MacrophageType)) +</span></span></code><code><span leaf=""><span>Â  geom_boxplot()</span></span></code><code><span leaf=""><span># è®¡ç®— CD68/CD163+å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒçš„å¹³å‡è·ç¦»ï¼ˆæ’é™¤ç¼ºå¤±å€¼ï¼‰</span></span></code><code><span leaf=""><span>mean(na.exclude(csd$</span><span>`Distance to CA9+`</span><span>[which(csd$MacrophageType==</span><span>"CD68/CD163+"</span><span>)]))</span></span></code><code><span leaf=""><span># è®¡ç®— CD68/CD163+APOE+å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒçš„å¹³å‡è·ç¦»ï¼ˆæ’é™¤ç¼ºå¤±å€¼ï¼‰</span></span></code><code><span leaf=""><span>mean(na.exclude(csd$</span><span>`Distance to CA9+`</span><span>[which(csd$MacrophageType==</span><span>"CD68/CD163+APOE+"</span><span>)]))</span></span></code><code><span leaf=""><span># è¿›è¡Œ t æ£€éªŒï¼Œæ¯”è¾ƒ CD68/CD163+å·¨å™¬ç»†èƒå’Œ CD68/CD163+APOE+å·¨å™¬ç»†èƒåˆ°è‚¿ç˜¤ç»†èƒçš„è·ç¦»å·®å¼‚</span></span></code><code><span leaf=""><span>t.test(csd$</span><span>`Distance to CA9+`</span><span>[which(csd$MacrophageType==</span><span>"CD68/CD163+"</span><span>)],csd$</span><span>`Distance to CA9+`</span><span>[which(csd$MacrophageType==</span><span>"CD68/CD163+APOE+"</span><span>)])</span></span></code><code><span leaf=""><span># å°†å½“å‰æ‚£è€…çš„è·ç¦»æ•°æ®å­˜å‚¨åˆ° csd_distance_to_tumor ä¸­</span></span></code><code><span leaf=""><span>csd_distance_to_tumor=csd</span></span></code><code><span leaf=""><span>####</span></span></code></pre></section><section><span><span leaf=""><span textstyle="">Â Single-cell protein activity analysis identifies recurrence-associated renal tumor macrophages. Cell. 2021 May</span></span></span></section><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡èµ„æ–™å…±äº«" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcDJiaFUU498wO4fW4vYADDWt9u9mfiakXeTS861ShkrLChr2M6B8eiaDIicyIbw7tjgjOz9npdrGAZuA/0?wx_fmt=png" data-signature="åŒ—äº¬å¤§å­¦åœ¨è¯»åšå£«ç”Ÿï¼Œæ—¥å¸¸åˆ†äº«ç”Ÿä¿¡èµ„æ–™ï¼Œä¸»è¦å…³æ³¨é¢†åŸŸï¼šå•ç»†èƒå’Œç©ºé—´æµ‹åºã€å¤šç»„å­¦åˆ†æã€å®åŸºå› ç»„ã€ç—…ç†ç»„å­¦ã€å½±åƒç»„å­¦ç­‰ç”Ÿç‰©ä¿¡æ¯å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ å†…å®¹ğŸŒ¬æ¬¢è¿å¤§å®¶äº¤æµå­¦ä¹ " data-id="Mzk0MjcyMDk3Mg==" data-is_biz_ban="0" data-service_type="1"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PjtseyzDU0xZc7Rg3Bj9DQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
