---
title: "回归模型和 t 检验 不就是差异分析吗"
date: 2025-01-11T11:11:51Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
回归模型和 t 检验 不就是差异分析吗 by 生信小博士
------
<div><p><span><em><span>前言</span></em></span></p><p><img data-galleryid="" data-imgfileid="100004957" data-ratio="0.7267683772538142" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaB6ed5BBicficmSVZbcXCn8B0BCBe9s6MSRR9lz18J9th174DEsIkQY8w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="721" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaB6ed5BBicficmSVZbcXCn8B0BCBe9s6MSRR9lz18J9th174DEsIkQY8w/640?wx_fmt=png&amp;from=appmsg"></p><h3><span><strong>2. 差异分析的本质</strong></span></h3><p><span><strong>差异分析</strong>的核心目标是：</span></p><ul><li><p><span>判断因变量（如基因表达量）在分组之间是否存在显著差异。</span></p></li><li><p><span>估计这种差异的大小及方向。</span></p></li></ul><h4><strong><br></strong></h4><h4><strong>差异分析的方法</strong></h4><ul><li><p><strong>传统方法</strong>：使用 t 检验或方差分析（ANOVA）。</p></li><ul><li><p>t 检验适用于两个组之间的比较。</p></li><li><p>ANOVA 适用于多个组之间的比较。</p></li></ul><li><p><strong>回归方法</strong>：通过回归模型分析分组变量的影响。</p></li><ul><li><p>适用于多个自变量（控制其他混杂因素）。</p></li><li><p>能同时输出差异的大小（回归系数）和显著性。</p></li></ul></ul><h3><strong><br></strong></h3><h3><strong>3. 回归模型与差异分析的联系与优势</strong></h3><h4><strong>(1) 联系</strong></h4><ul><li><p>如果模型中只有一个分组变量，线性回归分析等价于 t 检验。</p></li><li><p>多个分组时，线性回归可以扩展为方差分析的多组比较。</p></li></ul><h4><strong>(2) 优势</strong></h4><ol><li><p><strong>多变量控制</strong>：</p></li></ol><ul><li><p>回归模型可以同时考虑多个自变量，控制混杂因素的影响。</p></li><li><p>例如，分析基因表达量的分组差异时，还可以同时考虑年龄、性别等变量。</p></li></ul><li><p><strong>估计效应大小</strong>：</p></li><ul><li><p>回归系数不仅告诉我们差异是否显著，还提供了差异的具体大小和方向。</p></li><li><p>例如：分组系数<semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\beta_1 = 2</annotation></semantics>β1=2 表示组 B 比组 A 平均高 2 个单位。</p></li></ul><li><p><strong>适用范围广</strong>：</p></li><ul><li><p>回归模型适用于连续变量、分类变量等多种类型的自变量。</p></li></ul><p><span><strong><br></strong></span></p><p><span><strong>正文</strong></span></p><p><span><strong>如果仅比较两个组（如 A 和 B），回归模型与 t 检验的结果是一致的。</strong></span></p><hr><h3><span><strong>1. 回归模型与 t 检验的关系</strong></span></h3><h4><strong>(1) t 检验的核心思想</strong></h4><ul><li><p>t 检验用于比较两组之间的均值是否存在显著差异。</p></li></ul><p><img data-croporisrc="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaq6IsuyBoQ12qeWIRvuxZOAJKaBYhSlA8Ss3nMWgXHEhf1F4xUBvGeA/0?wx_fmt=png&amp;from=appmsg" data-cropx1="0" data-cropx2="745" data-cropy1="79.91349480968857" data-cropy2="600.6401384083044" data-galleryid="" data-imgfileid="100004952" data-ratio="0.7006711409395974" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaDwwkMP8WqqNb8TJa2vDpckFE2r17rFg0wvYsa6dhuSnNqkou2R683w/640?wx_fmt=jpeg" data-type="jpeg" data-w="745" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaDwwkMP8WqqNb8TJa2vDpckFE2r17rFg0wvYsa6dhuSnNqkou2R683w/640?wx_fmt=jpeg"></p><h4><strong>(3) 一致性来源</strong></h4><ul><li><p>当只有一个分组变量且只有两个组时：</p></li><ul><li><p>回归模型的分组系数（<semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow></semantics>）与 t 检验中计算的均值差一致。</p></li><li><p>回归模型中的 t 值和 p 值与独立样本 t 检验的结果完全一致。</p><hr><p><br></p></li></ul></ul><h3><span><strong>2. 回归模型中如何使用 t 检验？</strong></span></h3><p>在回归模型中，t 检验用于评估每个回归系数是否显著不同于 0。回归模型的 t 检验计算如下：</p><h4><strong>t 值公式</strong></h4><p><img data-galleryid="" data-imgfileid="100004954" data-ratio="0.3832923832923833" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibia5RmHVib1zT991S90flzZcAqic8fwn9w58ThNNic87NzBvnBkDOhSJxAcw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="407" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibia5RmHVib1zT991S90flzZcAqic8fwn9w58ThNNic87NzBvnBkDOhSJxAcw/640?wx_fmt=png&amp;from=appmsg"></p><h4><strong>意义</strong></h4><ul><li><p>t 值衡量回归系数的大小相对于随机波动的显著性。</p></li><li><p>对应的 p 值通过 t 值和自由度计算，判断回归系数是否显著。</p></li></ul><h4><strong><br></strong></h4><h4><strong>在两组比较中（A 和 B 的例子）</strong></h4><ul><li><p><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow></semantics> 是组 B 相对于组 A 的均值差。</p></li><li><p>t 值直接用于检验组间差异是否显著。</p></li></ul><p><br></p><p><span><strong><span>3. 示例：比较两组的 t 检验与回归模型</span></strong></span></p><p><img data-galleryid="" data-imgfileid="100004955" data-ratio="0.37756497948016415" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiasjF8Z2ia7AibRgybvo122Kf4nPq15wRQ7eN8aCYakjJ3U9SNzTH0Bj0w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="731" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiasjF8Z2ia7AibRgybvo122Kf4nPq15wRQ7eN8aCYakjJ3U9SNzTH0Bj0w/640?wx_fmt=png&amp;from=appmsg"></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><br></span></code><code><span>#比较两组的 t 检验与回归模型-----</span></code><code><span>if (F) {</span></code><code><span>  # 数据生成</span></code><code><span>  data &lt;- data.frame(</span></code><code><span>    Group = rep(c("A", "B"), each = 3),</span></code><code><span>    Expression = c(10, 12, 14, 20, 22, 24)</span></code><code><span>  );data</span></code><code><span><br></span></code><code><span>  # t 检验</span></code><code><span>  t_test &lt;- t.test(Expression ~ Group, data = data)</span></code><code><span>  t_test</span></code><code><span><br></span></code><code><span><br></span></code><code><span>  # 线性回归</span></code><code><span>  lm_model &lt;- lm(Expression ~ Group, data = data)</span></code><code><span>  summary(lm_model)</span></code><code><span><br></span></code><code><span>}</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100004956" data-ratio="0.7453646477132262" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaSaAsmTzeR1xxZl1agCE4lXG2NAFkibbLKicRdClSRl9iaK2FFI4Yaiay3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="809" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345SktfnEbrE8VxdkmLwerIdfibiaSaAsmTzeR1xxZl1agCE4lXG2NAFkibbLKicRdClSRl9iaK2FFI4Yaiay3g/640?wx_fmt=png&amp;from=appmsg"></p><h3><span><strong>4. 结果比较</strong></span></h3><h4><strong><br></strong></h4><h4><strong>回归模型和 t 检验结果的关系</strong></h4><ol><li><p><strong>均值差（组间差异）</strong>：</p></li></ol><ul><li><p>回归模型的 <code>GroupB</code> 系数是 12，表示组 B 比组 A 高 12。</p></li><li><p>t 检验比较的也是组均值差，结果一致。</p></li></ul><li><p><strong>t 值</strong>：</p></li><ul><li><p>回归模型中 <code>GroupB</code> 的 t 值是 6.124，与 t 检验的 t 值完全一致。</p></li></ul><li><p><strong>p 值</strong>：</p></li><p>回归模型中 <code>GroupB</code> 的 p 值是 0.003602，与 t 检验结果一致。</p><p><br></p><p><strong><span>5. 为什么使用回归模型更灵活？</span></strong></p><p>虽然回归模型和 t 检验在两组比较时结果一致，但回归模型有以下优势：</p><ol><li><p><strong>多变量控制</strong>：</p></li></ol><ul><li><p>回归模型可以同时引入其他变量（如性别、年龄），控制混杂因素的影响。</p></li><li><p>t 检验只能比较两组，无法处理多变量情况。</p></li></ul><li><p><strong>适应多组比较</strong>：</p></li><ul><li><p>回归模型可以扩展到多分类变量（如 A、B、C 多组比较）。</p></li><li><p>t 检验无法处理多组比较，需要用 ANOVA。</p></li></ul><li><p><strong>估计效应大小</strong>：</p></li><ul><li><p>回归模型可以直接输出组间差异的大小和方向（回归系数）。</p></li><li><p>t 检验只能判断差异显著性，无法直观描述效应大小。</p></li></ul><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4j-Czp6L0Wf-QYvGTbqkrg",target="_blank" rel="noopener noreferrer">原文链接</a>
