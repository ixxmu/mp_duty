---
title: "scanpy和seurat的所有Marker基因可视化方法帮你打包好啦"
date: 2025-01-12T23:57:28Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
scanpy和seurat的所有Marker基因可视化方法帮你打包好啦 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">我们在进行单细胞亚群命名时，是通过Marker基因来确定细胞的身份。然而在注释过程中，Marker基因的可视化是必不可少的，以前我们做了一个投票：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247500816&amp;idx=1&amp;sn=25568540a54d63225def0804c05025f8&amp;scene=21#wechat_redirect" data-linktype="2">可视化单细胞亚群的标记基因的5个方法</a>，是基于R编程语言的Seurat包的5个基础函数相信大家都是已经烂熟于心了：</p><ul data-tool="mdnice编辑器"><li><section>VlnPlot(pbmc, features = c("MS4A1", "CD79A"))</section></li><li><section>FeaturePlot(pbmc, features = c("MS4A1", "CD79A"))</section></li><li><section>RidgePlot(pbmc, features = c("MS4A1", "CD79A"), ncol = 1)</section></li><li><section>DotPlot(pbmc, features = unique(features)) + RotatedAxis()</section></li><li><section>DoHeatmap(subset(pbmc, downsample = 100), features = features, size = 3)</section></li></ul><p data-tool="mdnice编辑器">接下来我们一起看看基于R编程语言的Seurat包的5个基础函数的可视化，如何使用Python编程语言进行“平替”：</p><h3 data-tool="mdnice编辑器"><span></span><span>基于R编程语言的Seurat包</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><span>library</span>(gridExtra)<br><span>#加载实例数据</span><br>data(<span>'pbmc_small'</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>1.dotplot可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>DotPlot(pbmc_small,features=list(Monocyte=c(<span>"GP9"</span>,<span>"TUBB1"</span>,<span>"NGFRAP1"</span>),<br>        B=c(<span>"S100A8"</span>,<span>"S100A9"</span>,<span>"CD14"</span> ),Megakaryocyte=c(<span>"MS4A1"</span>,<span>"LINC00926"</span>,<span>"FCER2"</span> )))+<br>RotatedAxis()+labs(x=<span>''</span>,y=<span>''</span>)<br></code></pre><p><img data-imgfileid="100037044" data-ratio="0.6104328523862376" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkKpavDMQNRmicmaEBFMDcn7M5NlcxFjKx30MoE8gCrkAyDIxW8viaL0rQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="901" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkKpavDMQNRmicmaEBFMDcn7M5NlcxFjKx30MoE8gCrkAyDIxW8viaL0rQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>2.violin plot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>VlnPlot(pbmc_small,group.by =<span>'RNA_snn_res.1'</span>,features = c(<span>"S100A8"</span>,<span>"S100A9"</span>,<span>"CD14"</span>))<br></code></pre><p><img data-imgfileid="100037045" data-ratio="0.858034321372855" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkSmreWqAiaZHVfs2EUK3FxT7jW95VjHYNmnBxhcHeHPEHOLiadZicM25KA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="641" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkSmreWqAiaZHVfs2EUK3FxT7jW95VjHYNmnBxhcHeHPEHOLiadZicM25KA/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>3.stacked-violin plot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>VlnPlot(pbmc_small,<br>        features = c(<span>"GP9"</span>,<span>"TUBB1"</span>,<span>"NGFRAP1"</span>,<br>                     <span>"MS4A1"</span>,<span>"LINC00926"</span>,<span>"FCER2"</span>,<br>                     <span>"S100A8"</span>,<span>"S100A9"</span>,<span>"CD14"</span>),<br>        split.by = <span>'RNA_snn_res.1'</span>,stack = <span>TRUE</span>,<br>        flip=<span>TRUE</span>,<br>        cols=c(<span>'#E95C59'</span>, <span>'#53A85F'</span>, <span>'#57C3F3'</span>))+<br>theme(legend.position=<span>'none'</span>)+labs(x=<span>''</span>,y=<span>''</span>)<br></code></pre><p><img data-imgfileid="100037046" data-ratio="1.4031311154598827" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkFH9XRAeew9RV43osDhmdibddy0wSFVHvT5YQicA2smQ7Emn4Zj3UM93Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="511" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkFH9XRAeew9RV43osDhmdibddy0wSFVHvT5YQicA2smQ7Emn4Zj3UM93Q/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>4.Heatmap</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>DoHeatmap(pbmc_small,features = c(<span>"TUBB1"</span>,<span>"S100A8"</span>,<span>"S100A9"</span>))<br></code></pre><p><img data-imgfileid="100037047" data-ratio="0.6399345335515548" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk04kr5DhYwTeW5q2ibaMD27xTGDibW7wiaGoeyc6SeztMVq6k7pKRgC2kQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="611" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk04kr5DhYwTeW5q2ibaMD27xTGDibW7wiaGoeyc6SeztMVq6k7pKRgC2kQ/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>5.RidgePlot</span><span></span></h3><p data-tool="mdnice编辑器"><strong>原版：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>RidgePlot(pbmc_small, features = c(<span>"GP9"</span>,<span>"TUBB1"</span>,<span>"NGFRAP1"</span>,<br>                                   <span>"MS4A1"</span>,<span>"LINC00926"</span>,<span>"FCER2"</span>,<br>                                   <span>"S100A8"</span>,<span>"S100A9"</span>,<span>"CD14"</span>))<br></code></pre><p><img data-imgfileid="100037048" data-ratio="0.7127236580516899" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk6ymwf8TuBuFud2BoxUKULUovv0T5TXsicFk89DHpna5gCqk9zC9EExA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1006" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk6ymwf8TuBuFud2BoxUKULUovv0T5TXsicFk89DHpna5gCqk9zC9EExA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器"><strong>个性版：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>genes= c(<span>"GP9"</span>,<span>"TUBB1"</span>,<span>"NGFRAP1"</span>,<span>"MS4A1"</span>,<span>"LINC00926"</span>,<span>"FCER2"</span>,<span>"S100A8"</span>,<span>"S100A9"</span>,<span>"CD14"</span>)<br>pList = lapply(genes, <span>function</span>(x){<br>  RidgePlot(pbmc_small,features =x )+labs(x=<span>''</span>,y=<span>''</span>)+NoLegend()<br>})<br>gridExtra::grid.arrange(grobs = pList, ncol = <span>3</span>)<br></code></pre><p><img data-imgfileid="100037049" data-ratio="0.6476964769647696" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkQmzjdLssvzAG0bqgvrrZgdqZz6KnILB0omro3HAvquGC0eCJthr6Ug/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1107" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkQmzjdLssvzAG0bqgvrrZgdqZz6KnILB0omro3HAvquGC0eCJthr6Ug/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>scanpy</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>import</span> scanpy <span>as</span> sc<br><span>#加载实例数据</span><br>adata=sc.datasets.pbmc68k_reduced()<br>sc.tl.leiden(adata,resolution=<span>0.2</span>)<br>markers={<span>'B'</span>:[<span>'CD79B'</span>,<span>'CD79A'</span>,<span>'MS4A1'</span>],<br>         <span>'Plasma'</span>:[<span>'IGJ'</span>,<span>'MZB1'</span>,<span>'SPCS2'</span>],<br>         <span>'CD4+T'</span>:[<span>'CD3D'</span>,<span>'IL32'</span>,<span>'LDHB'</span>],<br>         <span>'Naive T'</span>:[<span>'HNRNPA1'</span>,<span>'NPM1'</span>,<span>'SNHG7'</span>],<br>         <span>'Monocyte'</span>:[<span>'FTL'</span>,<span>'AIF1'</span>,<span>'LST1'</span>],<br>         <span>'Dendritic'</span>:[<span>'FCER1A'</span>,<span>'LYZ'</span>,<span>'HLA-DRB1'</span>],<br>         <span>'Plasmacytoid dendritic'</span>:[<span>'IRF8'</span>,<span>'HLA-DPA1'</span>,<span>'CPVL'</span>],<br>         }<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>1.dotplot可视化</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.dotplot(adata,markers,<span>'leiden'</span>)<br></code></pre><p><img data-imgfileid="100037050" data-ratio="0.6119402985074627" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk5fiacFz93rbOgWEicicyC7nzzAHDgH7icMVx9HmDkiaODOwY7g9lYDDkMww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1139" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk5fiacFz93rbOgWEicicyC7nzzAHDgH7icMVx9HmDkiaODOwY7g9lYDDkMww/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>2.violin plot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.violin(adata,[<span>'IGJ'</span>,<span>'MZB1'</span>,<span>'SPCS2'</span>],<span>'leiden'</span>)<br></code></pre><p><img data-imgfileid="100037051" data-ratio="0.43071491615180935" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkKM1YAic8GLwltGpXhjagicst8teBCqKNtdI0lFibtoSiacfgAIbFNptOpA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1133" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkKM1YAic8GLwltGpXhjagicst8teBCqKNtdI0lFibtoSiacfgAIbFNptOpA/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>3.stacked-violin plot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.stacked_violin(adata,markers,<span>'leiden'</span>)<br></code></pre><p><img data-imgfileid="100037052" data-ratio="0.590633130962706" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkpcoM4JKOUTAqQNRIYjicfwx6oIlRmrKjdTCPVtXuuIkqFXHoGDa0naA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1153" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkpcoM4JKOUTAqQNRIYjicfwx6oIlRmrKjdTCPVtXuuIkqFXHoGDa0naA/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>4.matrixplot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.matrixplot(adata,markers,'leiden',standard_scale='var')<br></code></pre><p><img data-imgfileid="100037053" data-ratio="0.54296875" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjknP2qGK2Jn6oQxg1RFQZX8JOplp1qSZOO8fwMhpreUwKvx5ZCtrqxRA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjknP2qGK2Jn6oQxg1RFQZX8JOplp1qSZOO8fwMhpreUwKvx5ZCtrqxRA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">值得注意的，这个matrixplot可视化方法在基于R编程语言的Seurat包的里面没有对应的方法哦！其实这个matrixplot可视化方法就是下面的这个heatmap可视化方法的亚群平均值。</p><h3 data-tool="mdnice编辑器"><span></span><span>5.heatmap</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.heatmap(adata,markers,<span>'leiden'</span>,var_group_rotation=<span>True</span>)<br></code></pre><p><img data-imgfileid="100037054" data-ratio="0.4859375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkNVqA7qDVOMYU45PjaRSZoowt2KkT0KXw3pGXFWEa77V9CB9IzKDlPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjkNVqA7qDVOMYU45PjaRSZoowt2KkT0KXw3pGXFWEa77V9CB9IzKDlPw/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span></span><span>6.tracksplot</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>sc.pl.tracksplot(adata,markers,<span>'leiden'</span>)<br></code></pre><p><img data-imgfileid="100037055" data-ratio="0.6491666666666667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk7to14miaTI8rt7F2Ynn7ia91Vo8WWX8h2IUNP1icB3mOvZLiaYLxqD0nYw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQ13Ybh7SP1icBg6YUlP7pjk7to14miaTI8rt7F2Ynn7ia91Vo8WWX8h2IUNP1icB3mOvZLiaYLxqD0nYw/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">上面的是通过已知的基因标记来确定各个单细胞亚群的特征并且可视化，所以是需要自己准备好基因集，那些有生物学意义的基因。</p><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528328&amp;idx=1&amp;sn=33055906f1dca6958238a84b48405cd5&amp;chksm=9b4b2f33ac3ca6255cdf3d9e1422c6610aebd2fdece36ea0bd9d1cf838cbf1521b599ae81abe&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉松授‍课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a> ，你的生物信息学入门课</section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528133&amp;idx=1&amp;sn=2fc6bf3e8455222628c9814d6509c74f&amp;chksm=9b4b2e7eac3ca7687d2f12b37fa48bfe1b060b3c204df87dbf6e277321cfaeb8f5e4d283ca1e&amp;scene=21#wechat_redirect" textvalue="月薪两万找生信练习生（线下）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">月薪两万找生信练习生（线下）</a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247522831&amp;idx=2&amp;sn=1744efdf428465425a145ff3a982198b&amp;chksm=9b4bdab4ac3c53a28fbecbbff4f254f470b54a7a20468bb753b295b930315e1ec45bcbabc10b&amp;scene=21#wechat_redirect" textvalue="144线程640Gb内存服务器共享一年‍仍然是仅需800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">144线程640Gb内存服务器共享一年仍然是仅需800</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247519765&amp;idx=1&amp;sn=ce5a8c8182f854c88043059f8c2cb9ff&amp;chksm=9b4bceaeac3c47b88c19941d43dbb1401f3a92206481a0afc41159927868199643f795d62a7e&amp;scene=21#wechat_redirect" textvalue="千呼万唤始出来的独享生物信息学云服务器" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">千呼万唤始出来的独享生物信息学云服务器</a></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528144&amp;idx=1&amp;sn=be4d7e542d1077921024c86a4c130f16&amp;chksm=9b4b2e6bac3ca77d87a0ae0c12ae028d10225db19c8d7fb92b1299fa12f572bb769bcd92889b&amp;scene=21#wechat_redirect" textvalue="永久免费的生信进阶培训（线下）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">永久免费的生信进阶培训（线下）</a></section></li></ul></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/DE6F_oy0vo_GUbCpC9DVNQ",target="_blank" rel="noopener noreferrer">原文链接</a>
