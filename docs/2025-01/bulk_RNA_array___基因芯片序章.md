---
title: "bulk RNA-array | 基因芯片序章"
date: 2025-01-13T03:50:52Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
bulk RNA-array | 基因芯片序章 by 被炸熟的虾
------
<div><section><section><span>由于公众号改版，一些小伙伴可能收不到推送</span></section><section><span>点击上方</span> "<span><strong><span>被炸熟的虾</span></strong></span>" <span>设为星标</span></section><section><span>才能在第一时间获取文章内容哦</span></section></section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section><section><img data-imgfileid="100006408" data-ratio="0.221875" data-s="300,640" data-type="gif" data-w="640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/sIZTN4BrHpSPFtQnNOkqzIVumjqywXzjjVIOEbWAoXDMVRNnu4pbZ7IwKCqnlpErapibiaDH4iap3ibtHIxcg60zmg/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/sIZTN4BrHpSPFtQnNOkqzIVumjqywXzjjVIOEbWAoXDMVRNnu4pbZ7IwKCqnlpErapibiaDH4iap3ibtHIxcg60zmg/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section><p><span><span>基因芯片</span><span lang="EN-US">(Cene chip)</span><span>，又称</span><span lang="EN-US">DNA</span><span>芯片、</span><span lang="EN-US">DNA</span><span>微阵列（</span><span lang="EN-US">DNA microarray</span><span>），包括寡核苷酸微阵列（</span><span lang="EN-US">oligonucleotidemicroarray</span><span>）和</span><span lang="EN-US">cDNA</span><span>微阵列，是指采用原位合成（</span><span lang="EN-US">intusynthesis</span><span>）或显微打印手段，将大量的</span><span lang="EN-US">DNA</span><span>片段或探针固定在固体支持物（如玻璃片、硅片、尼龙膜等）上，形成二维</span><span lang="EN-US">DNA</span><span>探针阵列，然后与标记的样品进行杂交，<strong>通过检测杂交信号的强弱进而判断样品中靶分子的数量</strong>，也可以用于核酸样品的序列分析。</span></span></p><section><span><span>基因芯片的分类方式有多种，按用途分类主要包括：</span><span>表达谱芯片（</span><span lang="EN-US">Expression arrays</span><span>）、非编码</span><span lang="EN-US">RNA</span><span>芯片、外显子芯片（</span><span lang="EN-US">Exon array</span><span>）、甲基化芯片（</span><span lang="EN-US">Methylation arrays</span><span>）、</span><span lang="EN-US">SNP</span><span>芯片、比较基因组芯片（</span><span lang="EN-US">Array ComparativeGenomics Hybridization, array-CGH</span><span>）等</span></span></section><h2><span>一、存储数据库</span></h2><section><span><strong><span lang="EN-US">GEO数据库</span></strong><span>：最常见的存储数据库依旧是</span><span lang="EN-US">GEO</span><span>，全称</span><span lang="EN-US">Gene Expression Omnibus</span><span>，由美国国立生物技术信息中心（</span><span lang="EN-US">NCBI</span><span>）创建并维护。初始建立的时候，主要存储表达芯片数据，之后逐渐扩展到许多其它数据类型，比如二代测序以及其他形式的高通量基因组数据。</span><span lang="EN-US"><p></p></span></span></section><ul><li><p><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247485922&amp;idx=1&amp;sn=b6a10117db9d18d70201acd92b7a3b26&amp;scene=21#wechat_redirect" textvalue="常用数据库 | Gene Expression Omnibus (GEO)" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span><strong><span>常用数据库 | Gene Expression Omnibus (GEO)</span></strong></span></a></p></li></ul><section><span><span>对于表达谱芯片数据，</span><span lang="EN-US">GEO</span><span>记录类型为“</span><span lang="EN-US">Expression profilingby array</span><span>”、“</span><span lang="EN-US">Non-coding RNA profiling by array</span><span>”：</span></span><span lang="EN-US"><p></p></span></section><section><strong><span lang="EN-US"><img data-imgfileid="100006399" data-ratio="0.46574074074074073" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaiaLVZXI6lVNNnrhZRtibQVCpdiapbpoGV0FunFkEX4tkerS9ak4exJWpA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaiaLVZXI6lVNNnrhZRtibQVCpdiapbpoGV0FunFkEX4tkerS9ak4exJWpA/640?wx_fmt=png&amp;from=appmsg"></span></strong></section><section><span><strong><span lang="EN-US">ArrayExpress数据库</span></strong><span>：</span><span lang="EN-US">ArrayExpress</span><span>是<strong>欧洲生物信息协会（</strong></span><strong><span lang="EN-US">EMBL-EBI</span></strong><strong><span>）</span></strong><span>下属的功能基因组数据库，它既包含</span><span lang="EN-US">GEO</span><span>的所有数据，同时还包含</span><span lang="EN-US">ArrayExpress</span><span>自身以及其他数据库如</span><span lang="EN-US">Expression Atlas</span><span>、</span><span lang="EN-US">CCLE</span><span>等多种来源数据。</span></span></section><h2><span>二、主流的芯片技术</span></h2><h2><span><span>市场上主流的基因芯片产品主要来自三家公司：</span><span lang="EN-US">Affymetrix</span><span>公司、</span><span lang="EN-US">Agilent</span><span>公司和</span><span lang="EN-US">illumina</span><span>公司。不同芯片平台详细的技术原理建议阅读：</span></span></h2><ul><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzIzMzEzNjA4Mw==&amp;mid=2247484051&amp;idx=1&amp;sn=b05ba0d677b506eab0f981fe46ceb8d8&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>基因芯片技术的历史和发展</span></strong></span></a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI3ODY0NzY5Nw==&amp;mid=2247504450&amp;idx=4&amp;sn=58b66b3e4ad688ddf8669f62ff916b44&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>了解基因芯片的基本原理</span></strong></span></a></section></li><li><section><span>......</span></section></li></ul><section><span><p></p></span></section><section><span>最麻烦的地方就在于当<strong>下载的表达矩阵不符合预期</strong>，比如是<strong>空的</strong>，或者是<strong>有负值</strong>的时候，我们不得不通过处理原始数据来获取表达矩阵。此时，不同公司产品的适用方法截然不同<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Broken.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Broken.png">。我们以</span><span><span lang="EN-US">GEO</span><span>数据库中的表达谱芯片数据为例：</span></span><span lang="EN-US"><p></p></span></section><p><span><strong><span lang="EN-US">Affymetrix</span></strong></span><strong><span lang="EN-US"><p></p></span></strong></p><p><span lang="EN-US"><img data-imgfileid="100006400" data-ratio="0.4462962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaVZf1fib01r1adQxqCPAWw9IeSJL2rRf7z3LiadZI7VLt2dlyG7Zqomtg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaVZf1fib01r1adQxqCPAWw9IeSJL2rRf7z3LiadZI7VLt2dlyG7Zqomtg/640?wx_fmt=png&amp;from=appmsg"></span></p><section><span><span lang="EN-US">Supplementary files<span>（补充文件）</span></span><span>中有一个</span><span lang="EN-US">RAW</span><span>原始数据的压缩包，点开可以发现原始数据</span><span lang="EN-US">*.CEL</span><span>格式文件。处理方法较为统一，主要使用</span></span><span><strong><span>oligo</span></strong></span><span>包或</span><span><strong><span>affy</span></strong></span><span>包，步骤封装得特别好。</span><span lang="EN-US"><p></p></span></section><p><span><strong><span lang="EN-US">Illumina</span></strong></span><strong><span lang="EN-US"><p></p></span></strong></p><p><span><img data-imgfileid="100006401" data-ratio="0.8240740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaia3sJGNZk5juSCMLIVrjHL7ibCNDmIEt9bQdGwUHzvSFJvrJ6AnQwe1g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaia3sJGNZk5juSCMLIVrjHL7ibCNDmIEt9bQdGwUHzvSFJvrJ6AnQwe1g/640?wx_fmt=png&amp;from=appmsg"></span></p><section><span><span>有点反直觉的是</span><span lang="EN-US">non-normalized.txt.gz</span><span>文件才是我们主要关心的<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_05.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/2_05.png">，可以使用</span></span><span><strong><span>lumi</span></strong></span><span><span>包的</span></span><span><strong><span>lumiR.batch</span></strong></span><span><span>函数读取并进行背景校正、归一化和提取基因水平等后续分析。</span></span></section><section><span><span>需要注意的是，有时候这个文件的命名并不这样“规范”，例如</span><span lang="EN-US">GSE16997</span><span>数据集就变成了“</span><span lang="EN-US">GSE16997_raw.txt.gz</span><span>”<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/smiley_39b.png" data-ratio="1" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/smiley_39b.png">：</span></span><span lang="EN-US"><p></p></span></section><section><span><img data-imgfileid="100006402" data-ratio="0.3283236994219653" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaRKOrHjZks4Cp4K9cvZMFsUaas1icc40FdZUujLulO4aMoNQhQ1oR2cw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="865" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaRKOrHjZks4Cp4K9cvZMFsUaas1icc40FdZUujLulO4aMoNQhQ1oR2cw/640?wx_fmt=png&amp;from=appmsg"></span></section><section><span><span lang="EN-US">Illumina</span><span>芯片数据的</span><span lang="EN-US">Supplementary files</span><span>（补充文件）中包含的内容比较多样，此处是探针描述文件，包含探针的详细信息，如探针</span><span lang="EN-US">ID</span><span>、基因符号、</span><span lang="EN-US">RefSeq ID</span><span>等，可以用于数据注释和分析。别的数据集也可能是样本信息文件、实验设计文件、质量控制报告等等。</span></span><span lang="EN-US"><p></p></span></section><p><span><strong><span lang="EN-US">Agilent</span></strong></span></p><section><span><span>相比于前两者相对统一的格式，</span><span lang="EN-US">Agilent</span><span>公司的芯片比较难搞。个人目前碰到的、</span><span lang="EN-US">GEO</span><strong><span>下载的</span></strong><strong><span lang="EN-US">Agilent</span></strong><strong><span>表达矩阵</span></strong><span>绝大多数是有负值的<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_37@2x.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_37@2x.png">。</span></span></section><section><span><img data-imgfileid="100006403" data-ratio="0.45555555555555555" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaVSMcaM21hRRNwPWYfNUJBTMUA3licyBoljLBNBy7kHLSkZMPNcp00CQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3J1XgwwlDmXlMicdcibKufoiaaVSMcaM21hRRNwPWYfNUJBTMUA3licyBoljLBNBy7kHLSkZMPNcp00CQ/640?wx_fmt=png&amp;from=appmsg"></span></section><section><span><span lang="EN-US">Agilent</span><span>芯片的原始数据通常以</span><span lang="EN-US">TXT</span><span>文件的形式存储，包含了每个探针的强度值和注释信息。可以使用</span></span><span><strong><span>limma</span></strong></span><span><span>包处理，主要处理流程依旧是数据读取、背景校正、归一化和提取基因水平的表达量，但相比前两者可调步骤较多。</span><span lang="EN-US"><p></p></span></span></section><section><span>上述三组平台芯片数据的下载与处理我们后续一步步总结学习。</span></section><section><p><img data-imgfileid="100006404" data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="png" data-w="341" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></p><section data-tools="135编辑器" data-id="116886" draggable="true"><section><section><section><section><strong data-brushtype="text">被炸熟的虾</strong></section></section></section><section><section><section data-width="35%"><section><img data-cropselx1="0" data-cropselx2="115" data-cropsely1="0" data-cropsely2="115" data-imgfileid="100006405" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="258" data-width="100%" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section><section><section data-width="63%"><section><section><br></section><section><strong>自己的摸索，发现问题麻烦告诉作者，光速改正<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_24@2x.png" data-w="128" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/Expression/Expression_24@2x.png"></strong></section><section><strong><br></strong></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BOhsT_drlLRIOVnfo9bd-Q",target="_blank" rel="noopener noreferrer">原文链接</a>
