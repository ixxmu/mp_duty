---
title: "基因的功能推断之大队列高低分组后差异分析然后功能富集"
date: 2025-01-28T00:19:21Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
基因的功能推断之大队列高低分组后差异分析然后功能富集 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>前面我们强调了，<a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247531313&amp;idx=1&amp;sn=b794ca61a735be428cffd770920e66b5&amp;scene=21#wechat_redirect" data-linktype="2">基因功能推断的数据分析的重要性</a> ，接下来我们就演示一下<strong>常见的4种方法来进行基因的功能推断，首先是大队列高低分组后差异分析然后功能富集。</strong></p></blockquote><p data-tool="mdnice编辑器">我们以2023的这个肾癌数据挖掘文章为例，标题所：《SLC17A9-PTHLH-EMT axis promotes proliferation and invasion of clear renal cell carcinoma》，研究者们首先很好的说明了SLC17A9这个基因在肾癌里面所一个非常典型的癌基因：</p><ul data-tool="mdnice编辑器"><li><section>首先是在癌症样品里面相对于正常来说所高表达量的：SLC17A9 might serve as an unfa- vorable marker for ccRCC and be positively associated with poorer clinical prognosis.</section></li><li><section>然后 SLC17A9 was an unfavorable marker for ccRCC ：patients in the group having high SLC17A9 expression levels were associated with poor OS and DFS</section></li></ul><p data-tool="mdnice编辑器">如下所示：</p><p><img data-galleryid="" data-imgfileid="100047667" data-ratio="0.6129629629629629" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ajibOR3sp0NictibsgXjuky7JEp9KZoYOFSUFuMjDSGxDUPtyEDjTzzlNcNQxEmIN9EbWyLWc2Bbug/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ajibOR3sp0NictibsgXjuky7JEp9KZoYOFSUFuMjDSGxDUPtyEDjTzzlNcNQxEmIN9EbWyLWc2Bbug/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>非常典型的癌基因</figcaption></figure><p data-tool="mdnice编辑器">但是呢，Although SLC17A9 was identified as a biomarker for renal cancer, its role in tumor growth was unknown.</p><p data-tool="mdnice编辑器">这个时候就可以使用tcga数据库资源啦， 里面的肾癌转录组表达量矩阵就是大队列样品，仅仅是肿瘤样品就有522个，很简单的下载counts矩阵然后就可以差异分析 ，作者给出来的方法学所：</p><blockquote data-tool="mdnice编辑器"><span></span><p>All 522 samples of KIRC were initially divided into two groups according to the median expression of SLC17A9, and the ‘‘limma’’ package was then used to obtain the differential expressed genes (DEGs) related to SLC17A9, with adjusted p &lt; 0.05 and log2|FC| &gt; 1.</p></blockquote><p data-tool="mdnice编辑器">差异分析完成后，每个基因就有一个变化倍数，它就可以用来作为排序，然后就可以进行gsea分析，这个时候找到那些排名靠前的生物学功能就可以作为我们的目标基因的功能推断结果啦 ：</p><p><img data-galleryid="" data-imgfileid="100047668" data-ratio="0.4666666666666667" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ajibOR3sp0NictibsgXjuky7Vt4CBPbq96fWvQRw6YiaFkZSVKsKlkHahicqnLTqntQjIDv4vAKdqx4A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ajibOR3sp0NictibsgXjuky7Vt4CBPbq96fWvQRw6YiaFkZSVKsKlkHahicqnLTqntQjIDv4vAKdqx4A/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">前人已经证明过 SLC17A9 could positively regulate cell proliferation ，所以可以侧面验证这个推断所合理的，然后作者又聚焦了EMT这个明星通路，所以看了看 SLC17A9 and four EMT markers (namely, CDH1, CDH2, SNAI1, and VIM)  的具体的表达量相关性散点图。</p><p data-tool="mdnice编辑器">当然了，因为前面的差异分析有统计学阈值，所以也可以确定下 differentially expressed genes (DEGs) between the SLC17A9 high expression group and low expres- sions group，然后对上下调基因分别去做超几何分布检验看生物学功能情况。</p><p data-tool="mdnice编辑器">下面是一个示例代码：</p><pre data-tool="mdnice编辑器"><span></span><code>  <span># exp 是一个表达量矩阵</span><br>  <span># 然后this_gene 是 目标基因</span><br>  Group = ifelse(exp[ this_gene ,] &gt; median(exp[ this_gene ,]),<span>'high'</span>,<span>'low'</span>)<br>  table(Group)<br>  <span># 需要把Group转换成因子，并设置参考水平，指定levels，对照组在前，处理组在后</span><br>  Group = factor(Group,levels = c(<span>"low"</span>,<span>"high"</span>))<br>  Group<br>  table(Group) <br><br>  <span>#需要表达矩阵和Group，不需要改</span><br>    <span>library</span>(limma)<br>    design=model.matrix(~Group)<br>    fit=lmFit(exp,design)<br>    fit=eBayes(fit)<br>    deg=topTable(fit,coef=<span>2</span>,number = <span>Inf</span>)<br>    head(deg)<br>    <br>    <span>#为deg数据框添加几列</span><br>    <span>#1.加probe_id列，把行名变成一列</span><br>    <span>library</span>(dplyr)<br>    deg &lt;- mutate(deg,symbol=rownames(deg)) <br>    nrow(deg)<br>    head(deg)<br>    <br>    <span>#3.加change列,标记上下调基因</span><br>    logFC_t=<span>1</span><br>    P.Value_t = <span>0.05</span><br>    k1 = (deg$P.Value &lt; P.Value_t)&amp;(deg$logFC &lt; -logFC_t)<br>    k2 = (deg$P.Value &lt; P.Value_t)&amp;(deg$logFC &gt; logFC_t)<br>    deg &lt;- mutate(deg,change = ifelse(k1,<span>"down"</span>,ifelse(k2,<span>"up"</span>,<span>"stable"</span>)))<br>    table(deg$change)<br>    <br>    <span>#4.加ENTREZID列，用于富集分析（symbol转entrezid，然后inner_join）</span><br>    <span># 这里 </span><br>    <span>library</span>(clusterProfiler)<br>    <span>library</span>(org.Hs.eg.db)<br>    s2e &lt;- bitr(deg$symbol,<br>                fromType = <span>"SYMBOL"</span>,<br>                toType = <span>"ENTREZID"</span>,<br>                OrgDb = org.Hs.eg.db)<span>#人类</span><br>    <span># # #其他物种http://bioconductor.org/packages/release/BiocViews.html#___OrgDb</span><br>    dim(deg)<br>    deg &lt;- inner_join(deg,s2e,by=c(<span>"symbol"</span>=<span>"SYMBOL"</span>))<br>    dim(deg)<br>    head(deg)<br>    length(unique(deg$symbol))<br>    save(Group,deg,logFC_t,P.Value_t,this_gene,<br>         file =  paste0(this_gene,<span>"step4output.Rdata"</span>))<br></code></pre></section><section><mp-common-redpacket data-pluginname="redpacketcover" data-w="286" data-ratio="1.5664335664335665" data-name="%E7%94%9F%E4%BF%A1%E8%8F%9C%E9%B8%9F%E5%9B%A2" data-receiveimg="https%3A%2F%2Fsnssvppicd.video.qq.com%2Fsvid%2Fp0VkoI6zvYwPSRRO6DSxQjWvedCepggq16l4bZyJvf4zoIzlRNlYSs96S9raOxplM4yxwfAjkfrkWzIp8KTvHmA%3Fhy%3DSH" data-synthetic="0" data-coveruri="vNOiFpYWoEoC_sab" data-bizuin="3531108946" data-orderid="14574743816739589504" data-openimg="https%3A%2F%2Fsnssvppice.video.qq.com%2Fsvid%2Fp0VkoI6zvYwPSRRO6DSxQjeFdkemBntQDohRqDH_Mm4dtb37u6z4kkZDWRQqBlEu9P-1u1AmscvNN6oKW0opzzg%3Fhy%3DSH" data-is-purchase-order="" data-errortype=""></mp-common-redpacket></section><h2 data-tool="mdnice编辑器" data-remoteid="c1737719546615" data-cacheurl="https://files.mdnice.com/koala-2.png"><span>文末友情宣传：</span></h2><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527230&amp;idx=1&amp;sn=7156afcd5ab734c7d391b9048695747a&amp;scene=21#wechat_redirect" data-linktype="2">生信入门&amp;数据挖掘线上直播课2025年1月班</a></p><p data-tool="mdnice编辑器"><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" data-linktype="2">时隔5年，我们的生信技能树VIP学徒继续招生啦</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535760&amp;idx=2&amp;sn=1e02a2e982a046ecf6389231e6768d5b&amp;scene=21#wechat_redirect" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/OWYgR517DhifnHqChFwXsw",target="_blank" rel="noopener noreferrer">原文链接</a>
