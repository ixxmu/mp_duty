---
title: "å•ç»†èƒå…¨è‡ªåŠ¨æ³¨é‡Šç¯‡(ä¸€)â€”â€”clustifyr"
date: 2024-06-04T01:21:06Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡ç›Šç«™"
]
categories: ["Acdemic"]
---
å•ç»†èƒå…¨è‡ªåŠ¨æ³¨é‡Šç¯‡(ä¸€)â€”â€”clustifyr by ç”Ÿä¿¡ç›Šç«™
------
<div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027535" data-ratio="0.278125" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMPAYzVuuu7kWWdwm11CkFqCNnvH1tZrLRM9sQUZDXUAcv5tgavLnFsQ/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="640" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMPAYzVuuu7kWWdwm11CkFqCNnvH1tZrLRM9sQUZDXUAcv5tgavLnFsQ/640?wx_fmt=gif&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨"><code>ç”Ÿä¿¡ç›Šç«™ï¼Œä¸€ç‚¹å°±æœ‰ç›Š</code>ï¼<strong>ç¥å‹å‹ä»¬å¤©å¤©å¼€å¿ƒï¼Œæœˆæœˆå‘ CNS~</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="ç”Ÿä¿¡ç›Šç«™" data-alias="" data-signature="ç”Ÿç‰©ä¿¡æ¯æˆ–åŸºå› æµ‹åºæ•°æ®åˆ†æã€è½¯ä»¶ç®—æ³•ã€ç§‘ç ”ç»˜å›¾ã€Python/Perl/Rä»£ç åˆ†äº«ã€‚" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><hr data-tool="mdniceç¼–è¾‘å™¨"><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027531" data-ratio="0.3768518518518518" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMPhjmC1aXGbxWs2xGKyibgBTa36IbKnibO5ONDUVSdo7vImRF5IWuVdMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMPhjmC1aXGbxWs2xGKyibgBTa36IbKnibO5ONDUVSdo7vImRF5IWuVdMA/640?wx_fmt=png&amp;from=appmsg"><figcaption>è®¾æˆ‘ä¸ºğŸŒŸæ˜Ÿæ ‡ï¼Œæ¯å¤©å°±èƒ½ç¬¬ä¸€æ—¶é—´çœ‹åˆ°æ¨é€å•¦~</figcaption></figure><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨clustifyrï¼Ÿ</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœ<strong>ä¸äº†è§£ç›¸å…³ç³»ç»Ÿçš„åŸºç¡€ç”Ÿç‰©å­¦çŸ¥è¯†ï¼Œå•ç»†èƒè½¬å½•ç»„å¾ˆéš¾è¿›è¡Œæ³¨é‡Š</strong>ã€‚å³ä½¿å…·å¤‡è¿™äº›çŸ¥è¯†ï¼Œç”±äº<strong>ç¼ºä¹ç”±æ‰¹é‡ RNA æµ‹åºã€æµå¼ç»†èƒæœ¯ã€å…¶ä»–å•ç»†èƒ RNA æµ‹åºå¹³å°ç­‰å®šä¹‰çš„å¸¸è§æ ‡è®°åŸºå› </strong>çš„å¯æ£€æµ‹è¡¨è¾¾ï¼Œå‡†ç¡®è¯†åˆ«ä»å…·æœ‰æŒ‘æˆ˜æ€§ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">clustifyré€šè¿‡æä¾›ä½¿ç”¨æ‰¹é‡ RNA æµ‹åºæ•°æ®æˆ–æ ‡è®°åŸºå› åˆ—è¡¨ï¼ˆæ’åºæˆ–æœªæ’åºï¼‰<strong>è‡ªåŠ¨æ³¨é‡Š</strong>å•ä¸ªç»†èƒæˆ–ç°‡çš„åŠŸèƒ½è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚clustifyrå…è®¸å¯¹å•ç»†èƒ RNA æµ‹åºæ•°æ®é›†å’Œå‚è€ƒæ•°æ®ä¹‹é—´çš„<strong>è®¡ç®—ç›¸ä¼¼æ€§è¿›è¡Œæ¢ç´¢æ€§åˆ†æ</strong>ã€‚</p><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>2 å®‰è£…</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">è¦å®‰è£…clustifyrï¼Œå¿…é¡»å®‰è£…BiocManagerã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>install.packages(<span>"BiocManager"</span>)<br><br>BiocManager::install(<span>"clustifyr"</span>)<br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>3 ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š10x Genomics PBMCs</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä»å¤–å‘¨è¡€å•æ ¸ç»†èƒ (PBMC) ä¸­è·å– 10x Genomics 3â€™ scRNA-seq æ•°æ®é›†ï¼Œå¹¶ä½¿ç”¨ä» CITE-seq å®éªŒåˆ†é…çš„ scRNA-seq ç»†èƒç°‡æ³¨é‡Šç»†èƒç°‡ï¼ˆä½¿ç”¨ Seurat è¯†åˆ«ï¼‰ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(clustifyr)<br><span>library</span>(ggplot2)<br><span>library</span>(cowplot)<br><br><span>#Â MatrixÂ ofÂ normalizedÂ single-cellÂ RNA-seqÂ counts</span><br>pbmc_matrixÂ &lt;-Â clustifyr::pbmc_matrix_small<br><br><span>#Â meta.dataÂ tableÂ containingÂ clusterÂ assignmentsÂ forÂ eachÂ cell</span><br><span>#Â TheÂ tableÂ thatÂ weÂ areÂ usingÂ alsoÂ containsÂ theÂ knownÂ cellÂ identitiesÂ inÂ theÂ "classified"Â column</span><br>pbmc_metaÂ &lt;-Â clustifyr::pbmc_meta<br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>4 è®¡ç®—ç›¸å…³ç³»æ•°</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">ä¸ºäº†è¯†åˆ«ç»†èƒç±»å‹ï¼Œclustifyr()å‡½æ•°éœ€è¦å‡ ä¸ªè¾“å…¥ï¼š</p><ul data-tool="mdniceç¼–è¾‘å™¨"><li><section>inputï¼šSingleCellExperiment æˆ– Seurat å¯¹è±¡æˆ–æ ‡å‡†åŒ–å•ç»†èƒ RNA åºåˆ—è®¡æ•°çŸ©é˜µ</section></li><li><section>metadataï¼šåŒ…å«æ¯ä¸ªç»†èƒçš„èšç±»åˆ†é…çš„ meta.data è¡¨ï¼ˆå¦‚æœç»™å‡ºäº† Seurat å¯¹è±¡ï¼Œåˆ™ä¸éœ€è¦ï¼‰</section></li><li><section>ref_matï¼šåŒ…å«æ¯ç§æ„Ÿå…´è¶£çš„ç»†èƒç±»å‹çš„ RNA-seq è¡¨è¾¾æ•°æ®çš„å‚è€ƒçŸ©é˜µ</section></li><li><section>query_genesï¼šç”¨äºæ¯”è¾ƒçš„åŸºå› åˆ—è¡¨ï¼ˆå¯é€‰ä½†æ¨èï¼‰</section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨">å½“ä½¿ç”¨ scRNA-seq è®¡æ•°çŸ©é˜µæ—¶ï¼Œclustifyr()å°†è¿”å›æ¯ä¸ªç»†èƒç±»å‹å’Œç°‡çš„ç›¸å…³ç³»æ•°çŸ©é˜µï¼Œå…¶ä¸­è¡Œåä¸ç°‡ç¼–å·ç›¸å¯¹åº”ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â CalculateÂ correlationÂ coefficientsÂ forÂ eachÂ clusterÂ (spearmanÂ byÂ default)</span><br>vargenesÂ &lt;-Â pbmc_vargenes[<span>1</span>:<span>500</span>]<br><br>resÂ &lt;-Â clustify(<br>Â Â inputÂ =Â pbmc_matrix,Â <span>#Â matrixÂ ofÂ normalizedÂ scRNA-seqÂ countsÂ (orÂ SCE/SeuratÂ object)</span><br>Â Â metadataÂ =Â pbmc_meta,Â <span>#Â meta.dataÂ tableÂ containingÂ cellÂ clusters</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>,Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>Â Â ref_matÂ =Â cbmc_ref,Â <span>#Â matrixÂ ofÂ RNA-seqÂ expressionÂ dataÂ forÂ eachÂ cellÂ type</span><br>Â Â query_genesÂ =Â vargenesÂ <span>#Â listÂ ofÂ highlyÂ varibleÂ genesÂ identifiedÂ withÂ Seurat</span><br>)<br><br><span>#Â PeekÂ atÂ correlationÂ matrix</span><br>res[<span>1</span>:<span>5</span>,Â <span>1</span>:<span>5</span>]<br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â BÂ CD14+Â MonoÂ CD16+Â MonoÂ Â Â Â Â CD34+Â Â Â Â Â CD4Â T</span><br><span>#&gt;Â 0Â 0.6563466Â Â 0.6454029Â Â 0.6485863Â 0.7089861Â 0.8804508</span><br><span>#&gt;Â 1Â 0.6394363Â Â 0.6388404Â Â 0.6569401Â 0.7027430Â 0.8488750</span><br><span>#&gt;Â 2Â 0.5524081Â Â 0.9372089Â Â 0.8930158Â 0.5879264Â 0.5347312</span><br><span>#&gt;Â 3Â 0.8945380Â Â 0.5801453Â Â 0.6146857Â 0.6955897Â 0.6566739</span><br><span>#&gt;Â 4Â 0.5711643Â Â 0.5623870Â Â 0.5826233Â 0.6280913Â 0.7467347</span><br><br><span>#Â CallÂ cellÂ types</span><br>res2Â &lt;-Â cor_to_call(<br>Â Â cor_matÂ =Â res,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ correlationÂ coefficients</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>)<br>res2[<span>1</span>:<span>5</span>,Â ]<br><span>#&gt;Â #Â AÂ tibble:Â 5Â Ã—Â 3</span><br><span>#&gt;Â #Â Groups:Â Â Â seurat_clustersÂ [5]</span><br><span>#&gt;Â Â Â seurat_clustersÂ typeÂ Â Â Â Â Â Â Â Â Â Â r</span><br><span>#&gt;Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â &lt;dbl&gt;</span><br><span>#&gt;Â 1Â 3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â BÂ Â Â Â Â Â Â Â Â Â 0.895</span><br><span>#&gt;Â 2Â 2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CD14+Â MonoÂ 0.937</span><br><span>#&gt;Â 3Â 5Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CD16+Â MonoÂ 0.929</span><br><span>#&gt;Â 4Â 0Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CD4Â TÂ Â Â Â Â Â 0.880</span><br><span>#&gt;Â 5Â 1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CD4Â TÂ Â Â Â Â Â 0.849</span><br><br><span>#Â InsertÂ intoÂ originalÂ metadataÂ asÂ "type"Â column</span><br>pbmc_meta2Â &lt;-Â call_to_metadata(<br>Â Â resÂ =Â res2,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â data.frameÂ ofÂ calledÂ cellÂ typeÂ forÂ eachÂ cluster</span><br>Â Â metadataÂ =Â pbmc_meta,Â Â Â Â Â Â Â Â Â Â Â <span>#Â originalÂ meta.dataÂ tableÂ containingÂ cellÂ clusters</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ä¸ºäº†å¯è§†åŒ–clustifyr()ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥ plot_cor_heatmap()å‡½æ•°ç»˜åˆ¶æ¯ä¸ªç°‡å’Œæ¯ç§ç»†èƒç±»å‹çš„ç›¸å…³ç³»æ•°ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â CreateÂ heatmapÂ ofÂ correlationÂ coefficientsÂ usingÂ clustifyr()Â output</span><br>plot_cor_heatmap(cor_matÂ =Â res)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027533" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMnibEzMN7INZcDG6wMqFfWhfCb3M6UyU7RY20kgiblZmNWA9LRcnxoXNA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMnibEzMN7INZcDG6wMqFfWhfCb3M6UyU7RY20kgiblZmNWA9LRcnxoXNA/640?wx_fmt=png&amp;from=appmsg"></figure><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>5 ç»˜åˆ¶èšç±»èº«ä»½å’Œç›¸å…³ç³»æ•°</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">clustifyrè¿˜æä¾›äº†å°†ç›¸å…³ç³»æ•°å åŠ åœ¨é¢„å…ˆè®¡ç®—çš„ tSNE åµŒå…¥ï¼ˆæˆ–ä»»ä½•å…¶ä»–é™ç»´æ–¹æ³•çš„åµŒå…¥ï¼‰ä¸Šçš„å‡½æ•°ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â OverlayÂ correlationÂ coefficientsÂ onÂ UMAPsÂ forÂ theÂ firstÂ twoÂ cellÂ types</span><br>corr_umapsÂ &lt;-Â plot_cor(<br>Â Â cor_matÂ =Â res,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ ofÂ correlationÂ coefficientsÂ fromÂ clustifyr()</span><br>Â Â metadataÂ =Â pbmc_meta,Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â meta.dataÂ tableÂ containingÂ UMAPÂ orÂ tSNEÂ data</span><br>Â Â data_to_plotÂ =Â colnames(res)[<span>1</span>:<span>2</span>],Â <span>#Â nameÂ ofÂ cellÂ type(s)Â toÂ plotÂ correlationÂ coefficients</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>Â Â Â Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>)<br><br>plot_grid(<br>Â Â plotlistÂ =Â corr_umaps,<br>Â Â rel_widthsÂ =Â c(<span>0.47</span>,Â <span>0.53</span>)<br>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027532" data-ratio="0.3888888888888889" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMB8QHDhuTYuMsgdzx0uF3SjUpjyiaFRmTqSjbkdXPWA3Vz9b3j1remuw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMB8QHDhuTYuMsgdzx0uF3SjUpjyiaFRmTqSjbkdXPWA3Vz9b3j1remuw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">plot_best_call()å‡½æ•°å¯ç”¨äºå°†æ¯ä¸ªç°‡æ ‡è®°ä¸ºå…·æœ‰æœ€é«˜ç›¸å…³ç³»æ•°çš„ç»†èƒç±»å‹ã€‚ä½¿ç”¨è¯¥pot_dims()å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»˜åˆ¶æ¯ä¸ªç°‡çš„å·²çŸ¥èº«ä»½ï¼Œè¿™äº›èº«ä»½å­˜å‚¨åœ¨ meta.data è¡¨çš„â€œclassifiedâ€åˆ—ä¸­ã€‚ä¸‹å›¾æ˜¾ç¤ºï¼Œå‚è€ƒ RNA-seq æ•°æ®å’Œ 10x Genomics scRNA-seq æ•°æ®é›†ä¹‹é—´çš„æœ€é«˜ç›¸å…³æ€§ä»…é™äºæ­£ç¡®çš„ç»†èƒç°‡ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â LabelÂ clustersÂ withÂ clustifyrÂ cellÂ identities</span><br>clustifyr_typesÂ &lt;-Â plot_best_call(<br>Â Â cor_matÂ =Â res,Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ ofÂ correlationÂ coefficientsÂ fromÂ clustifyr()</span><br>Â Â metadataÂ =Â pbmc_meta,Â Â Â <span>#Â meta.dataÂ tableÂ containingÂ UMAPÂ orÂ tSNEÂ data</span><br>Â Â do_labelÂ =Â <span>TRUE</span>,Â Â Â Â Â Â Â Â <span>#Â shouldÂ theÂ featureÂ labelÂ beÂ shownÂ onÂ eachÂ cluster?</span><br>Â Â do_legendÂ =Â <span>FALSE</span>,Â Â Â Â Â Â <span>#Â shouldÂ theÂ legendÂ beÂ shown?</span><br>Â Â do_repelÂ =Â <span>FALSE</span>,Â Â Â Â Â Â Â <span>#Â useÂ ggrepelÂ toÂ avoidÂ overlappingÂ labels</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span><br>)Â +<br>Â Â ggtitle(<span>"clustifyrÂ cellÂ types"</span>)<br><br><span>#Â CompareÂ clustifyrÂ resultsÂ withÂ knownÂ cellÂ identities</span><br>known_typesÂ &lt;-Â plot_dims(<br>Â Â dataÂ =Â pbmc_meta,Â Â Â Â Â Â Â <span>#Â meta.dataÂ tableÂ containingÂ UMAPÂ orÂ tSNEÂ data</span><br>Â Â featureÂ =Â <span>"classified"</span>,Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ toÂ colorÂ clustersÂ by</span><br>Â Â do_labelÂ =Â <span>TRUE</span>,Â Â Â Â Â Â Â Â <span>#Â shouldÂ theÂ featureÂ labelÂ beÂ shownÂ onÂ eachÂ cluster?</span><br>Â Â do_legendÂ =Â <span>FALSE</span>,Â Â Â Â Â Â <span>#Â shouldÂ theÂ legendÂ beÂ shown?</span><br>Â Â do_repelÂ =Â <span>FALSE</span><br>)Â +<br>Â Â ggtitle(<span>"KnownÂ cellÂ types"</span>)<br><br>plot_grid(known_types,Â clustifyr_types)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027534" data-ratio="0.4583333333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMZDATJcE5S0ueSKCd1DFrGvTYJOLgDLGH1Kg6opbAs0NDL4swvbdj8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMZDATJcE5S0ueSKCd1DFrGvTYJOLgDLGH1Kg6opbAs0NDL4swvbdj8Q/640?wx_fmt=png&amp;from=appmsg"></figure><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>6 ä½¿ç”¨å·²çŸ¥æ ‡è®°åŸºå› å¯¹ç»†èƒè¿›è¡Œåˆ†ç±»</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">clustify_lists()å‡½æ•°å…è®¸æ ¹æ®å·²çŸ¥æ ‡è®°åŸºå› åˆ†é…ç»†èƒç±»å‹ã€‚è¯¥å‡½æ•°éœ€è¦ä¸€ä¸ªåŒ…å«æ¯ç§ç›®æ ‡ç»†èƒç±»å‹æ ‡è®°çš„è¡¨æ ¼ã€‚å¯ä»¥ä½¿ç”¨å¤šç§ç»Ÿè®¡æµ‹è¯•æ¥åˆ†é…ç»†èƒç±»å‹ï¼ŒåŒ…æ‹¬è¶…å‡ ä½•ã€Jaccardã€Spearman å’Œ GSEAã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â TakeÂ aÂ peekÂ atÂ markerÂ geneÂ table</span><br>cbmc_m<br><span>#&gt;Â Â Â CD4Â TÂ CD8Â TÂ MemoryÂ CD4Â TÂ CD14+Â MonoÂ NaiveÂ CD4Â TÂ Â Â NKÂ Â Â Â Â BÂ CD16+Â Mono</span><br><span>#&gt;Â 1Â ITM2AÂ Â CD8BÂ Â Â Â Â Â Â Â ADCY2Â Â Â Â Â S100A8Â Â Â Â Â Â Â CDHR3Â GNLYÂ Â IGHMÂ Â Â Â Â CDKN1C</span><br><span>#&gt;Â 2Â TXNIPÂ Â CD8AÂ Â Â Â Â Â Â PTGDR2Â Â Â Â Â S100A9Â Â DICER1-AS1Â NKG7Â CD79AÂ Â Â Â Â Â Â HES4</span><br><span>#&gt;Â 3Â Â Â AESÂ S100BÂ Â Â Â Â Â CD200R1Â Â Â Â Â Â Â Â LYZÂ Â Â Â Â Â Â RAD9AÂ CST7Â MS4A1Â Â Â Â Â Â Â Â CKB</span><br><span>#&gt;Â Â Â Â Â Â CD34+Â ErythÂ Â Â Â MkÂ Â Â Â DCÂ Â Â pDCs</span><br><span>#&gt;Â 1Â Â Â SPINK2Â Â Â HBMÂ Â Â PF4Â Â ENHOÂ LILRA4</span><br><span>#&gt;Â 2Â Â C1QTNF4Â Â AHSPÂ Â SDPRÂ Â CD1EÂ Â Â TPM2</span><br><span>#&gt;Â 3Â KIAA0125Â Â Â CA1Â TUBB1Â NDRG2Â Â Â Â SCT</span><br><br><span>#Â AvailableÂ metricsÂ include:Â "hyper",Â "jaccard",Â "spearman",Â "gsea"</span><br>list_resÂ &lt;-Â clustify_lists(<br>Â Â inputÂ =Â pbmc_matrix,Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ ofÂ normalizedÂ single-cellÂ RNA-seqÂ counts</span><br>Â Â metadataÂ =Â pbmc_meta,Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â meta.dataÂ tableÂ containingÂ cellÂ clusters</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>,Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>Â Â markerÂ =Â cbmc_m,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â listÂ ofÂ knownÂ markerÂ genes</span><br>Â Â metricÂ =Â <span>"pct"</span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â testÂ toÂ useÂ forÂ assigningÂ cellÂ types</span><br>)<br><br><span>#Â ViewÂ asÂ heatmap,Â orÂ plot_best_call</span><br>plot_cor_heatmap(<br>Â Â cor_matÂ =Â list_res,Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ ofÂ correlationÂ coefficientsÂ fromÂ clustify_lists()</span><br>Â Â cluster_rowsÂ =Â <span>FALSE</span>,Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â clusterÂ byÂ row?</span><br>Â Â cluster_columnsÂ =Â <span>FALSE</span>,Â Â Â Â Â Â Â Â Â <span>#Â clusterÂ byÂ column?</span><br>Â Â legend_titleÂ =Â <span>"%Â expressed"</span>Â Â Â Â Â <span>#Â titleÂ ofÂ heatmapÂ legend</span><br>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027538" data-ratio="0.6666666666666666" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMNqqZkrRwz4x9HkQV6QbE6x0wZyfXfKCgwSmNp2tXrej8o1B6FeZ6yg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMNqqZkrRwz4x9HkQV6QbE6x0wZyfXfKCgwSmNp2tXrej8o1B6FeZ6yg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â DownstreamÂ functionsÂ sameÂ asÂ clustify()</span><br><span>#Â CallÂ cellÂ types</span><br>list_res2Â &lt;-Â cor_to_call(<br>Â Â cor_matÂ =Â list_res,Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ correlationÂ coefficients</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>Â Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>)<br><br><span>#Â InsertÂ intoÂ originalÂ metadataÂ asÂ "list_type"Â column</span><br>pbmc_meta3Â &lt;-Â call_to_metadata(<br>Â Â resÂ =Â list_res2,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â data.frameÂ ofÂ calledÂ cellÂ typeÂ forÂ eachÂ cluster</span><br>Â Â metadataÂ =Â pbmc_meta,Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â originalÂ meta.dataÂ tableÂ containingÂ cellÂ clusters</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>,Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>Â Â rename_prefixÂ =Â <span>"list_"</span>Â Â Â Â Â Â Â Â Â Â <span>#Â setÂ aÂ prefixÂ forÂ theÂ newÂ column</span><br>)<br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>7 ç›´æ¥å¤„ç†SingleCellExperimentå¯¹è±¡</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">clustifyrè¿˜å¯ä»¥ä½¿ç”¨ SingleCellExperimentå¯¹è±¡ä½œä¸ºè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªæ–° SingleCellExperimentå¯¹è±¡ï¼Œå…¶ä¸­å°†ç»†èƒç±»å‹ä½œä¸º colData ä¸­çš„ä¸€åˆ—æ·»åŠ ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(SingleCellExperiment)<br>sceÂ &lt;-Â sce_pbmc()<br>resÂ &lt;-Â clustify(<br>Â Â inputÂ =Â sce,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â anÂ SCEÂ object</span><br>Â Â ref_matÂ =Â cbmc_ref,Â Â Â Â Â Â Â Â Â <span>#Â matrixÂ ofÂ RNA-seqÂ expressionÂ dataÂ forÂ eachÂ cellÂ type</span><br>Â Â cluster_colÂ =Â <span>"clusters"</span>,Â Â Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>Â Â obj_outÂ =Â <span>TRUE</span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â outputÂ SCEÂ objectÂ withÂ cellÂ typeÂ insertedÂ asÂ "type"Â column</span><br>)<br><br>colData(res)[<span>1</span>:<span>10</span>,Â c(<span>"type"</span>,Â <span>"r"</span>)]<br><span>#&gt;Â DataFrameÂ withÂ 10Â rowsÂ andÂ 2Â columns</span><br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â typeÂ Â Â Â Â Â Â Â Â r</span><br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;character&gt;Â &lt;numeric&gt;</span><br><span>#&gt;Â AAACATACAACCACÂ Â Â Â Â Â Â CD4Â TÂ Â 0.861083</span><br><span>#&gt;Â AAACATTGAGCTACÂ Â Â Â Â Â Â Â Â Â Â BÂ Â 0.909358</span><br><span>#&gt;Â AAACATTGATCAGCÂ Â Â Â Â Â Â CD4Â TÂ Â 0.861083</span><br><span>#&gt;Â AAACCGTGCTTCCGÂ Â CD14+Â MonoÂ Â 0.914543</span><br><span>#&gt;Â AAACCGTGTATGCGÂ Â Â Â Â Â Â Â Â Â NKÂ Â 0.894090</span><br><span>#&gt;Â AAACGCACTGGTACÂ Â Â Â Â Â Â CD4Â TÂ Â 0.861083</span><br><span>#&gt;Â AAACGCTGACCAGTÂ Â Â Â Â Â Â Â Â Â NKÂ Â 0.825784</span><br><span>#&gt;Â AAACGCTGGTTCTTÂ Â Â Â Â Â Â Â Â Â NKÂ Â 0.825784</span><br><span>#&gt;Â AAACGCTGTAGCCAÂ Â Â Â Â Â Â CD4Â TÂ Â 0.889149</span><br><span>#&gt;Â AAACGCTGTTTCTGÂ Â CD16+Â MonoÂ Â 0.929491</span><br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>8 ç›´æ¥å¤„ç†Seuratå¯¹è±¡</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">clustifyrè¿˜å¯ä»¥ä½¿ç”¨Seuratå¯¹è±¡ä½œä¸ºè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªæ–°Seuratå¯¹è±¡ï¼Œå…¶ä¸­å°†ç»†èƒç±»å‹æ·»åŠ ä¸ºmetaæ•°æ®ä¸­çš„ä¸€åˆ—ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>soÂ &lt;-Â so_pbmc()<br>resÂ &lt;-Â clustify(<br>Â Â inputÂ =Â so,Â Â Â Â Â Â <span>#Â aÂ SeuratÂ object</span><br>Â Â ref_matÂ =Â cbmc_ref,Â Â Â <span>#Â matrixÂ ofÂ RNA-seqÂ expressionÂ dataÂ forÂ eachÂ cellÂ type</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>,Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ clusters</span><br>Â Â obj_outÂ =Â <span>TRUE</span>Â Â <span>#Â outputÂ SeuratÂ objectÂ withÂ cellÂ typeÂ insertedÂ asÂ "type"Â column</span><br>)<br><br>res@meta.data[<span>1</span>:<span>10</span>,Â c(<span>"type"</span>,Â <span>"r"</span>)]<br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â typeÂ Â Â Â Â Â Â Â Â r</span><br><span>#&gt;Â AAACATACAACCACÂ Â Â Â Â Â CD4Â TÂ 0.8424452</span><br><span>#&gt;Â AAACATTGAGCTACÂ Â Â Â Â Â Â Â Â Â BÂ 0.8984684</span><br><span>#&gt;Â AAACATTGATCAGCÂ Â Â Â Â Â CD4Â TÂ 0.8424452</span><br><span>#&gt;Â AAACCGTGCTTCCGÂ CD14+Â MonoÂ 0.9319558</span><br><span>#&gt;Â AAACCGTGTATGCGÂ Â Â Â Â Â Â Â Â NKÂ 0.8816119</span><br><span>#&gt;Â AAACGCACTGGTACÂ Â Â Â Â Â CD4Â TÂ 0.8424452</span><br><span>#&gt;Â AAACGCTGACCAGTÂ Â Â Â Â Â Â Â Â NKÂ 0.8147040</span><br><span>#&gt;Â AAACGCTGGTTCTTÂ Â Â Â Â Â Â Â Â NKÂ 0.8147040</span><br><span>#&gt;Â AAACGCTGTAGCCAÂ Â Â Â Â Â CD4Â TÂ 0.8736163</span><br><span>#&gt;Â AAACGCTGTTTCTGÂ CD16+Â MonoÂ 0.9321784</span><br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>9 ä»å•ç»†èƒè¡¨è¾¾çŸ©é˜µæ„å»ºå‚è€ƒçŸ©é˜µ</span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨">æœ€ç®€å•çš„å½¢å¼æ˜¯ï¼Œé€šè¿‡æŒ‰ç°‡å¯¹å•ç»†èƒ RNA åºåˆ—è¡¨è¾¾çŸ©é˜µçš„è¡¨è¾¾è¿›è¡Œå¹³å‡ï¼ˆè¿˜åŒ…æ‹¬å–ä¸­ä½æ•°çš„é€‰é¡¹ï¼‰æ¥æ„å»ºå‚è€ƒçŸ©é˜µã€‚æ”¯æŒå¯¹æ•°å˜æ¢çŸ©é˜µæˆ–åŸå§‹è®¡æ•°çŸ©é˜µã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>new_ref_matrixÂ &lt;-Â average_clusters(<br>Â Â matÂ =Â pbmc_matrix,<br>Â Â metadataÂ =Â pbmc_meta<span>$classified</span>,Â <span>#Â orÂ useÂ metadataÂ =Â pbmc_meta,Â cluster_colÂ =Â "classified"</span><br>Â Â if_logÂ =Â TRUEÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â whetherÂ theÂ expressionÂ matrixÂ isÂ alreadyÂ logÂ transformed</span><br>)<br><br>head(new_ref_matrix)<br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â BÂ CD14+Â MonoÂ Â Â Â Â Â CD8Â TÂ Â Â Â Â Â Â Â Â DCÂ FCGR3A+Â Mono</span><br><span>#&gt;Â PPBPÂ Â Â 0.09375021Â 0.28763857Â 0.35662599Â 0.06527347Â Â Â Â 0.2442300</span><br><span>#&gt;Â LYZÂ Â Â Â 1.42699419Â 5.21550849Â 1.35146753Â 4.84714962Â Â Â Â 3.4034309</span><br><span>#&gt;Â S100A9Â 0.62123058Â 4.91453355Â 0.58823794Â 2.53310734Â Â Â Â 2.6277996</span><br><span>#&gt;Â IGLL5Â Â 2.44576997Â 0.02434753Â 0.03284986Â 0.10986617Â Â Â Â 0.2581198</span><br><span>#&gt;Â GNLYÂ Â Â 0.37877736Â 0.53592906Â 2.53161887Â 0.46959958Â Â Â Â 0.2903092</span><br><span>#&gt;Â FTLÂ Â Â Â 3.66698837Â 5.86217774Â 3.37056910Â 4.21848878Â Â Â Â 5.9518479</span><br><span>#&gt;Â Â Â Â Â Â Â Â MemoryÂ CD4Â TÂ NaiveÂ CD4Â TÂ Â Â Â Â Â Â Â Â NKÂ Â Platelet</span><br><span>#&gt;Â PPBPÂ Â Â Â Â 0.06494743Â Â 0.04883837Â 0.00000000Â 6.0941782</span><br><span>#&gt;Â LYZÂ Â Â Â Â Â 1.39466552Â Â 1.40165143Â 1.32701580Â 2.5303912</span><br><span>#&gt;Â S100A9Â Â Â 0.58080250Â Â 0.55679700Â 0.52098541Â 1.6775692</span><br><span>#&gt;Â IGLL5Â Â Â Â 0.04826212Â Â 0.03116080Â 0.05247669Â 0.2501642</span><br><span>#&gt;Â GNLYÂ Â Â Â Â 0.41001072Â Â 0.46041901Â 4.70481754Â 0.3845813</span><br><span>#&gt;Â FTLÂ Â Â Â Â Â 3.31062958Â Â 3.35611600Â 3.38471536Â 4.5508242</span><br><br><span>#Â ForÂ furtherÂ convenience,Â aÂ shortcutÂ functionÂ forÂ generatingÂ referenceÂ matrixÂ fromÂ `SingleCellExperiment`Â orÂ `seurat`Â objectÂ isÂ used.</span><br>new_ref_matrix_sceÂ &lt;-Â object_ref(<br>Â Â inputÂ =Â sce,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span>#Â SCEÂ object</span><br>Â Â cluster_colÂ =Â <span>"clusters"</span>Â Â Â Â Â Â Â <span>#Â nameÂ ofÂ columnÂ inÂ colDataÂ containingÂ cellÂ identities</span><br>)<br><br>new_ref_matrix_soÂ &lt;-Â seurat_ref(<br>Â Â seurat_objectÂ =Â so,Â Â Â Â Â Â Â Â <span>#Â SeuratÂ object</span><br>Â Â cluster_colÂ =Â <span>"seurat_clusters"</span>Â Â Â Â <span>#Â nameÂ ofÂ columnÂ inÂ meta.dataÂ containingÂ cellÂ identities</span><br>)<br><br>tail(new_ref_matrix_so)<br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0Â Â Â Â Â Â Â Â Â Â 1Â Â Â Â Â Â Â Â Â Â Â 2Â Â Â Â Â Â Â Â Â Â 3Â Â Â Â Â Â Â Â Â Â 4</span><br><span>#&gt;Â RHOCÂ Â Â 0.245754269Â 0.40431050Â 0.590053057Â 0.37702525Â 0.86466156</span><br><span>#&gt;Â CISHÂ Â Â 0.492444272Â 0.54773003Â 0.079843557Â 0.08962348Â 0.66024943</span><br><span>#&gt;Â CD27Â Â Â 1.195370020Â 1.28719850Â 0.100562312Â 0.54487892Â 1.28322681</span><br><span>#&gt;Â LILRA3Â 0.004576215Â 0.03686387Â 0.544743180Â 0.00000000Â 0.03409087</span><br><span>#&gt;Â CLIC2Â Â 0.007570624Â 0.00000000Â 0.021200958Â 0.00000000Â 0.00000000</span><br><span>#&gt;Â HEMGNÂ Â 0.034099324Â 0.04619359Â 0.006467157Â 0.00000000Â 0.00000000</span><br><span>#&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 5Â Â Â Â Â Â Â Â Â 6Â Â Â Â Â Â Â Â Â Â 7Â Â Â Â Â Â Â Â 8</span><br><span>#&gt;Â RHOCÂ Â Â 2.20162898Â 1.6518448Â 0.72661911Â 1.465067</span><br><span>#&gt;Â CISHÂ Â Â 0.10588034Â 0.1339815Â 0.18231747Â 0.000000</span><br><span>#&gt;Â CD27Â Â Â 0.09640885Â 0.1600911Â 0.04639912Â 0.000000</span><br><span>#&gt;Â LILRA3Â 1.35418074Â 0.0000000Â 0.00000000Â 0.000000</span><br><span>#&gt;Â CLIC2Â Â 0.00000000Â 0.0000000Â 0.46542832Â 0.000000</span><br><span>#&gt;Â HEMGNÂ Â 0.00000000Â 0.0000000Â 0.00000000Â 1.079083</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æ›´å¤šæ•™ç¨‹è¯·è®¿é—®ï¼šhttps://rnabioco.github.io/clustifyrdata/articles/otherformats.html</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>10 sessionInfo()</span><span></span></h2><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#&gt;Â RÂ versionÂ 4.3.3Â (2024-02-29)</span><br><span>#&gt;Â Platform:Â x86_64-pc-linux-gnuÂ (64-bit)</span><br><span>#&gt;Â RunningÂ under:Â UbuntuÂ 22.04.4Â LTS</span><br><span>#&gt;Â </span><br><span>#&gt;Â MatrixÂ products:Â default</span><br><span>#&gt;Â BLAS:Â Â Â /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3Â </span><br><span>#&gt;Â LAPACK:Â /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;Â Â LAPACKÂ versionÂ 3.10.0</span><br><span>#&gt;Â </span><br><span>#&gt;Â locale:</span><br><span>#&gt;Â Â [1]Â LC_CTYPE=en_US.UTF-8Â Â Â Â Â Â Â LC_NUMERIC=CÂ Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [3]Â LC_TIME=en_US.UTF-8Â Â Â Â Â Â Â Â LC_COLLATE=en_US.UTF-8Â Â Â Â </span><br><span>#&gt;Â Â [5]Â LC_MONETARY=en_US.UTF-8Â Â Â Â LC_MESSAGES=en_US.UTF-8Â Â Â </span><br><span>#&gt;Â Â [7]Â LC_PAPER=en_US.UTF-8Â Â Â Â Â Â Â LC_NAME=CÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [9]Â LC_ADDRESS=CÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â LC_TELEPHONE=CÂ Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [11]Â LC_MEASUREMENT=en_US.UTF-8Â LC_IDENTIFICATION=CÂ Â Â Â Â Â Â </span><br><span>#&gt;Â </span><br><span>#&gt;Â timeÂ zone:Â UTC</span><br><span>#&gt;Â tzcodeÂ source:Â systemÂ (glibc)</span><br><span>#&gt;Â </span><br><span>#&gt;Â attachedÂ baseÂ packages:</span><br><span>#&gt;Â [1]Â stats4Â Â Â Â statsÂ Â Â Â Â graphicsÂ Â grDevicesÂ utilsÂ Â Â Â Â datasetsÂ Â methodsÂ Â </span><br><span>#&gt;Â [8]Â baseÂ Â Â Â Â </span><br><span>#&gt;Â </span><br><span>#&gt;Â otherÂ attachedÂ packages:</span><br><span>#&gt;Â Â [1]Â SingleCellExperiment_1.24.0Â SummarizedExperiment_1.32.0</span><br><span>#&gt;Â Â [3]Â Biobase_2.62.0Â Â Â Â Â Â Â Â Â Â Â Â Â Â GenomicRanges_1.54.1Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [5]Â GenomeInfoDb_1.38.8Â Â Â Â Â Â Â Â Â IRanges_2.36.0Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [7]Â S4Vectors_0.40.2Â Â Â Â Â Â Â Â Â Â Â Â BiocGenerics_0.48.1Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [9]Â MatrixGenerics_1.14.0Â Â Â Â Â Â Â matrixStats_1.3.0Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [11]Â cowplot_1.1.3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ggplot2_3.5.0Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [13]Â clustifyr_1.15.4Â Â Â Â Â Â Â Â Â Â Â Â BiocStyle_2.30.0Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â </span><br><span>#&gt;Â loadedÂ viaÂ aÂ namespaceÂ (andÂ notÂ attached):</span><br><span>#&gt;Â Â [1]Â bitops_1.0-7Â Â Â Â Â Â Â Â Â Â Â Â rlang_1.1.3Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [3]Â magrittr_2.0.3Â Â Â Â Â Â Â Â Â Â clue_0.3-65Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [5]Â GetoptLong_1.0.5Â Â Â Â Â Â Â Â compiler_4.3.3Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â Â [7]Â png_0.1-8Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â systemfonts_1.0.6Â Â Â Â Â Â </span><br><span>#&gt;Â Â [9]Â vctrs_0.6.5Â Â Â Â Â Â Â Â Â Â Â Â Â shape_1.4.6.1Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [11]Â pkgconfig_2.0.3Â Â Â Â Â Â Â Â Â crayon_1.5.2Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [13]Â fastmap_1.1.1Â Â Â Â Â Â Â Â Â Â Â XVector_0.42.0Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [15]Â labeling_0.4.3Â Â Â Â Â Â Â Â Â Â utf8_1.2.4Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [17]Â rmarkdown_2.26Â Â Â Â Â Â Â Â Â Â ragg_1.3.0Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [19]Â purrr_1.0.2Â Â Â Â Â Â Â Â Â Â Â Â Â xfun_0.43Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [21]Â zlibbioc_1.48.2Â Â Â Â Â Â Â Â Â cachem_1.0.8Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [23]Â jsonlite_1.8.8Â Â Â Â Â Â Â Â Â Â highr_0.10Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [25]Â DelayedArray_0.28.0Â Â Â Â Â BiocParallel_1.36.0Â Â Â Â </span><br><span>#&gt;Â [27]Â cluster_2.1.6Â Â Â Â Â Â Â Â Â Â Â parallel_4.3.3Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [29]Â R6_2.5.1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â bslib_0.7.0Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [31]Â RColorBrewer_1.1-3Â Â Â Â Â Â parallelly_1.37.1Â Â Â Â Â Â </span><br><span>#&gt;Â [33]Â jquerylib_0.1.4Â Â Â Â Â Â Â Â Â Rcpp_1.0.12Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [35]Â bookdown_0.39Â Â Â Â Â Â Â Â Â Â Â iterators_1.0.14Â Â Â Â Â Â Â </span><br><span>#&gt;Â [37]Â knitr_1.46Â Â Â Â Â Â Â Â Â Â Â Â Â Â future.apply_1.11.2Â Â Â Â </span><br><span>#&gt;Â [39]Â Matrix_1.6-5Â Â Â Â Â Â Â Â Â Â Â Â tidyselect_1.2.1Â Â Â Â Â Â Â </span><br><span>#&gt;Â [41]Â abind_1.4-5Â Â Â Â Â Â Â Â Â Â Â Â Â yaml_2.3.8Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [43]Â doParallel_1.0.17Â Â Â Â Â Â Â codetools_0.2-20Â Â Â Â Â Â Â </span><br><span>#&gt;Â [45]Â listenv_0.9.1Â Â Â Â Â Â Â Â Â Â Â lattice_0.22-6Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [47]Â tibble_3.2.1Â Â Â Â Â Â Â Â Â Â Â Â withr_3.0.0Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [49]Â evaluate_0.23Â Â Â Â Â Â Â Â Â Â Â future_1.33.2Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [51]Â desc_1.4.3Â Â Â Â Â Â Â Â Â Â Â Â Â Â circlize_0.4.16Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [53]Â pillar_1.9.0Â Â Â Â Â Â Â Â Â Â Â Â BiocManager_1.30.22Â Â Â Â </span><br><span>#&gt;Â [55]Â foreach_1.5.2Â Â Â Â Â Â Â Â Â Â Â generics_0.1.3Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [57]Â sp_2.1-3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RCurl_1.98-1.14Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [59]Â munsell_0.5.1Â Â Â Â Â Â Â Â Â Â Â scales_1.3.0Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [61]Â globals_0.16.3Â Â Â Â Â Â Â Â Â Â glue_1.7.0Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [63]Â tools_4.3.3Â Â Â Â Â Â Â Â Â Â Â Â Â data.table_1.15.4Â Â Â Â Â Â </span><br><span>#&gt;Â [65]Â fgsea_1.28.0Â Â Â Â Â Â Â Â Â Â Â Â fs_1.6.3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [67]Â dotCall64_1.1-1Â Â Â Â Â Â Â Â Â fastmatch_1.1-4Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [69]Â grid_4.3.3Â Â Â Â Â Â Â Â Â Â Â Â Â Â tidyr_1.3.1Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [71]Â colorspace_2.1-0Â Â Â Â Â Â Â Â GenomeInfoDbData_1.2.11</span><br><span>#&gt;Â [73]Â cli_3.6.2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â textshaping_0.3.7Â Â Â Â Â Â </span><br><span>#&gt;Â [75]Â spam_2.10-0Â Â Â Â Â Â Â Â Â Â Â Â Â fansi_1.0.6Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [77]Â S4Arrays_1.2.1Â Â Â Â Â Â Â Â Â Â ComplexHeatmap_2.18.0Â Â </span><br><span>#&gt;Â [79]Â dplyr_1.1.4Â Â Â Â Â Â Â Â Â Â Â Â Â gtable_0.3.4Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [81]Â sass_0.4.9Â Â Â Â Â Â Â Â Â Â Â Â Â Â digest_0.6.35Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [83]Â progressr_0.14.0Â Â Â Â Â Â Â Â SparseArray_1.2.4Â Â Â Â Â Â </span><br><span>#&gt;Â [85]Â farver_2.1.1Â Â Â Â Â Â Â Â Â Â Â Â rjson_0.2.21Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [87]Â htmlwidgets_1.6.4Â Â Â Â Â Â Â SeuratObject_5.0.1Â Â Â Â Â </span><br><span>#&gt;Â [89]Â memoise_2.0.1Â Â Â Â Â Â Â Â Â Â Â entropy_1.3.1Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [91]Â htmltools_0.5.8.1Â Â Â Â Â Â Â pkgdown_2.0.9Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [93]Â lifecycle_1.0.4Â Â Â Â Â Â Â Â Â httr_1.4.7Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>#&gt;Â [95]Â GlobalOptions_0.1.2</span><br></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>ç›Šç«™å¯ä»¥è¯„è®ºã€ç•™è¨€å•¦ã€‚èµ¶ç´§å‘è¡¨æ‚¨çš„çœ‹æ³•å§~</span><span></span></h1><hr data-tool="mdniceç¼–è¾‘å™¨"><p data-tool="mdniceç¼–è¾‘å™¨">OKï¼Œä»Šå¤©çš„åˆ†äº«åˆ°æ­¤ä¸ºæ­¢ã€‚å’±ä»¬æ˜å¤©è§~</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>è”ç³»ç«™é•¿</span><span></span></h2><blockquote data-tool="mdniceç¼–è¾‘å™¨"><span>â</span><p>å¯¹<code>æœ¬ç¯‡æ–‡ç« æœ‰ç–‘é—®</code>ï¼Œæˆ–è€…æœ‰<code>ç§‘ç ”æœåŠ¡éœ€æ±‚</code>çš„å‹å‹å¯ä»¥åœ¨ç›Šç«™<code>å‘æ¶ˆæ¯ç•™è¨€</code>ï¼Œä¹Ÿæ¬¢è¿å„ä½ç«¥é‹<code>æ‰«ä¸‹é¢çš„äºŒç»´ç </code>åŠ å…¥æˆ‘ä»¬çš„ <code>QQ</code> äº¤æµç¾¤ã€‚</p></blockquote><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027537" data-ratio="1.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMcv8NBgTO5Td5Ig7VBic4AER8zu3xj9eRu9q77YTGxJjeYLkibX8ibDUEQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="512" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMcv8NBgTO5Td5Ig7VBic4AER8zu3xj9eRu9q77YTGxJjeYLkibX8ibDUEQ/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption>æœ€æ–°QQç¾¤</figcaption></figure><hr data-tool="mdniceç¼–è¾‘å™¨"><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027539" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMibyPRoiblwuuV0Dmuvp3RE99DzdwvYoial8AdDJJSiaeRtiaQNzKG8jm2kA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMibyPRoiblwuuV0Dmuvp3RE99DzdwvYoial8AdDJJSiaeRtiaQNzKG8jm2kA/640?wx_fmt=png&amp;from=appmsg"><figcaption>ç§‘ç ”æœåŠ¡</figcaption></figure><hr data-tool="mdniceç¼–è¾‘å™¨"><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100027541" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMMHaNbyj6Rd6XrcKfuVcnVYicVfqooCbnUDfQfYsNYq8qrQBBVbAgtoQ/640?wx_fmt=gif&amp;from=appmsg" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/mhoJzVKWSib9fZ15fROicIBV0ia3mRMSrtMMHaNbyj6Rd6XrcKfuVcnVYicVfqooCbnUDfQfYsNYq8qrQBBVbAgtoQ/640?wx_fmt=gif&amp;from=appmsg"><figcaption>æ‚¨çš„<code>å…³æ³¨ã€ç‚¹èµã€åœ¨çœ‹ã€è½¬å‘</code>æ˜¯å¯¹ç›Šç«™æœ€å¤§çš„<code>é¼“åŠ±å’Œæ”¯æŒ</code>å“ˆ</figcaption></figure><hr data-tool="mdniceç¼–è¾‘å™¨"></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzU1NTk0MTUxMg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/mhoJzVKWSib8n88v0Cj6koLMO8nOuGacicngmJdb0zgmMpxaXYnrB7sjV5iar1cTzTDLsicoyNKrjic1Hgric41HObSQ/0?wx_fmt=png" data-nickname="ç”Ÿä¿¡ç›Šç«™" data-alias="" data-signature="ç”Ÿç‰©ä¿¡æ¯æˆ–åŸºå› æµ‹åºæ•°æ®åˆ†æã€è½¯ä»¶ç®—æ³•ã€ç§‘ç ”ç»˜å›¾ã€Python/Perl/Rä»£ç åˆ†äº«ã€‚" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/GQiRQIbr1rx5xKYzC1My3Q",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
