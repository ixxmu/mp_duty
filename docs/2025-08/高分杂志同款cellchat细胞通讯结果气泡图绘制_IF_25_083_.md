---
title: "高分杂志同款cellchat细胞通讯结果气泡图绘制（IF=25.083）"
date: 2025-08-06T00:47:59Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
高分杂志同款cellchat细胞通讯结果气泡图绘制（IF=25.083） by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">收到群里面一个学员问下面这个图怎么绘制，今天又是每周一次的绘图时间，来看看！如果你也想加入我们的绘图群，进群方式见：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538699&amp;idx=1&amp;sn=871cb62f043fc30e1996066dc50430dd&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">绘图小技巧2025交流群</a></span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="" data-pm-slice="0 0 []"><span textstyle="">我们生信技能树</span></span><strong><span leaf=""><span textstyle="">每个月都有一期带领初学者，0基础的生信入门培训，</span><span textstyle="">会有各种贴心的答疑，甚至是新叶老师给你的一对一专属答疑，远程代码演示</span><span textstyle="">，快来：最新一期在</span><span textstyle="">8月4号</span></span></strong><span leaf=""><span textstyle="">，感兴趣的可以去看看呀：</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544311&amp;idx=1&amp;sn=d41b5838e799f52280e78703135bb603&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课8月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课8月班</span></a><span textstyle="">。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">这幅图来自<span textstyle="">2025年4月发表在J Hepatol.杂志</span>上的文献，标题为<span textstyle="">《FABP5+ lipid-loaded macrophages process tumour-derived unsaturated fatty acid signal to suppress T-cell antitumour immunity》。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">图如下：展示的是单细胞的细胞通讯结果，Mac细胞亚群与T细胞亚群之间特定的 immunosuppressive signalling interactions 分子之间的通讯情况，点的颜色表示通讯强度Prob，关于Prob的含义见我们之前的稿子：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247536318&amp;idx=1&amp;sn=cf0c131962bac2313a172952b91b1e1f&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">cellchat细胞通讯中 prob 与 pval 的含义是什么?</a></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYibgoChunaYhk4wDQv9X255IzqnbNlQeA8GBTcbxugpYa7guHq912e4A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.48333333333333334" data-type="png" data-w="1080" data-imgfileid="100061070" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYibgoChunaYhk4wDQv9X255IzqnbNlQeA8GBTcbxugpYa7guHq912e4A/640?wx_fmt=png&amp;from=appmsg"></span></figure><blockquote><p><span leaf="">Fig. 2. Fabp5+ lipid-loaded TAMs correlate with blunted T-cell activation. Dot plot (H) showing immunosuppressive signalling interactions (rows) between FABP5+ TAMs and T-lymphocyte subsets (columns).  AMs, tumour-associated macrophages;</span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">示例数据</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">这个数据呢作者放在了GEO上：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE237823</span></p><p data-tool="mdnice编辑器"><span leaf="">我们之前有个预处理的帖子：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538613&amp;idx=1&amp;sn=d47381d07bdef6e18d80f9a2a8cd2d35&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">单细胞数据GSE237823有四个样本但是读进去没有样本分组怎么办？</a>，但是还没有做注释，所以这里就用经典的pbmc3k的数据作为示例绘图吧，仅考虑代码技巧。</span></p><p data-tool="mdnice编辑器"><span leaf="">数据读取：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf="">library(SeuratData) </span><span><span leaf="">#加载seurat数据集  </span></span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(tidyverse)</span><span leaf=""><br></span><span leaf="">library(CellChat)</span><span leaf=""><br></span><span leaf="">library(patchwork)</span><span leaf=""><br></span><span leaf="">packageVersion(</span><span><span leaf="">"CellChat"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># InstallData("pbmc3k")  </span></span><span leaf=""><br></span><span leaf="">data(</span><span><span leaf="">"pbmc3k"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce &lt;- UpdateSeuratObject(pbmc3k) </span><span leaf=""><br></span><span leaf="">table(sce</span><span><span leaf="">$seurat_annotations</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(sce@meta.data)</span><span leaf=""><br></span><span leaf="">dim(sce)</span><span leaf=""><br></span><span><span leaf=""># 去掉没有注释信息的细胞</span></span><span leaf=""><br></span><span leaf="">sce &lt;- sce[ , </span><span><span leaf="">which</span></span><span leaf="">(!is.na(sce@meta.data</span><span><span leaf="">$seurat_annotations</span></span><span leaf="">))]</span><span leaf=""><br></span><span leaf="">sce &lt;- sce %&gt;% </span><span leaf=""><br></span><span leaf="">  NormalizeData %&gt;% </span><span leaf=""><br></span><span leaf="">  FindVariableFeatures %&gt;% </span><span leaf=""><br></span><span leaf="">  ScaleData</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce</span><span leaf=""><br></span><span leaf="">table(Idents(sce))</span><span leaf=""><br></span><span leaf="">Idents(sce) &lt;- </span><span><span leaf="">"seurat_annotations"</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYAlb1jX4uEtpM2f63gYLGpJVo8K4Tj4O1BDR6TsxCMIAmspFLjkQiazw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.07685185185185185" data-type="png" data-w="1080" data-imgfileid="100061067" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYAlb1jX4uEtpM2f63gYLGpJVo8K4Tj4O1BDR6TsxCMIAmspFLjkQiazw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">运行cellchat</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">cellchat的详细原理看：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247536318&amp;idx=1&amp;sn=cf0c131962bac2313a172952b91b1e1f&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">cellchat细胞通讯中 prob 与 pval 的含义是什么?</a></span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">创建cellchat对象</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">先从seurat里面提取对应的数据并创建cellchat对象：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 1.输入数据</span></span><span leaf=""><br></span><span><span leaf=""># For the gene expression data matrix, genes should be in rows with rownames and cells in columns with colnames. </span></span><span leaf=""><br></span><span><span leaf=""># Normalized data (e.g., library-size normalization and then log-transformed with a pseudocount of 1) is required </span></span><span leaf=""><br></span><span><span leaf=""># as input for CellChat analysis</span></span><span leaf=""><br></span><span leaf="">data.input = sce@assays</span><span><span leaf="">$RNA</span></span><span leaf="">@data </span><span><span leaf=""># normalized data matrix</span></span><span leaf=""><br></span><span leaf="">data.input[1:4,1:4]</span><span leaf=""><br></span><span leaf="">meta = sce@meta.data[, </span><span><span leaf="">"seurat_annotations"</span></span><span leaf="">,drop=F] </span><span><span leaf=""># a dataframe with rownames containing cell mata data</span></span><span leaf=""><br></span><span leaf="">colnames(meta) &lt;- </span><span><span leaf="">"labels"</span></span><span leaf=""><br></span><span leaf="">head(meta)</span><span leaf=""><br></span><span leaf="">table(meta)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 2.创建对象</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- createCellChat(object = data.input, meta = meta, group.by = </span><span><span leaf="">"labels"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">cellchat</span><span leaf=""><br></span><span leaf="">levels(cellchat@idents) </span><span><span leaf=""># show factor levels of the cell labels</span></span><span leaf=""><br></span><span leaf="">groupSize &lt;- as.numeric(table(cellchat@idents)) </span><span><span leaf=""># number of cells in each cell group</span></span><span leaf=""><br></span><span leaf="">groupSize</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">指定使用数据库</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">除了 "Non-protein Signaling" ：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 3.数据库</span></span><span leaf=""><br></span><span leaf="">CellChatDB &lt;- CellChatDB.human </span><span><span leaf=""># use CellChatDB.mouse if running on mouse data</span></span><span leaf=""><br></span><span leaf="">showDatabaseCategory(CellChatDB)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># use all CellChatDB except for "Non-protein Signaling" for cell-cell communication analysis</span></span><span leaf=""><br></span><span leaf="">CellChatDB.use &lt;- subsetDB(CellChatDB)</span><span leaf=""><br></span><span><span leaf=""># set the used database in the object</span></span><span leaf=""><br></span><span leaf="">cellchat@DB &lt;- CellChatDB.use</span><span leaf=""><br></span><span leaf="">cellchat</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">得到通讯网络</span></span><span></span></h3><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 4.鉴定亚群高表达基因</span></span><span leaf=""><br></span><span><span leaf=""># subset the expression data of signaling genes for saving computation cost</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- subsetData(cellchat) </span><span><span leaf=""># This step is necessary even if using the whole database</span></span><span leaf=""><br></span><span leaf="">future::plan(</span><span><span leaf="">"multisession"</span></span><span leaf="">, workers = 20) </span><span><span leaf=""># do parallel</span></span><span leaf=""><br></span><span><span leaf=""># CellChat identifies over-expressed ligands or receptors in one cell group</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- identifyOverExpressedGenes(cellchat)</span><span leaf=""><br></span><span leaf="">cellchat &lt;- identifyOverExpressedInteractions(cellchat)</span><span leaf=""><br></span><span leaf="">cellchat</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 5.计算probability</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- computeCommunProb(cellchat, </span><span><span leaf="">type</span></span><span leaf=""> = </span><span><span leaf="">"triMean"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">#&gt; triMean is used for calculating the average gene expression per cell group.</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 6.通路水平的通讯</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- computeCommunProbPathway(cellchat)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 7.计算汇总的通讯网络</span></span><span leaf=""><br></span><span leaf="">cellchat &lt;- aggregateNet(cellchat)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 8.提取细胞通讯结果</span></span><span leaf=""><br></span><span><span leaf=""># returns a data frame consisting of all the inferred cell-cell communications at the level of ligands/receptors</span></span><span leaf=""><br></span><span><span leaf=""># 默认 thresh ：threshold of the p-value for determining significant interaction</span></span><span leaf=""><br></span><span leaf="">df.net &lt;- subsetCommunication(cellchat, thresh = 0.05)</span><span leaf=""><br></span><span leaf="">head(df.net)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">得到的这个表格 df.net 就是细胞的详细通讯结果啦，可以保存出去详细查看结果以及挑选一些有意义的结果：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYGx08hgweXOltlNUDHW6A2YQOO29Kl3NMnwCibou3YggUUAFJRpUhQ4g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.10092592592592593" data-type="png" data-w="1080" data-imgfileid="100061069" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYGx08hgweXOltlNUDHW6A2YQOO29Kl3NMnwCibou3YggUUAFJRpUhQ4g/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">可视化绘图</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">绘制上面的气泡图很简单，使用 cellchat自带的 netVisual_bubble() 函数就可以了：</span></p><p data-tool="mdnice编辑器"><span leaf="">默认绘制所有细胞亚群间所有配受体(pvalue&lt;0.05)的结果：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">netVisual_bubble(cellchat,remove.isolate = F)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYrhgPOMBQPN2XPIAicpdewt1Y9FMGUZBSbnZ4Xqsx06hmtcpFOnYr3NA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7638888888888888" data-type="png" data-w="1080" data-imgfileid="100061071" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYrhgPOMBQPN2XPIAicpdewt1Y9FMGUZBSbnZ4Xqsx06hmtcpFOnYr3NA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">指定特定亚群：</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">使用sources.use 与 targets.use 参数：绘制 CD8+T cell与其他亚群的通讯结果</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 这里的数字为注释水平的顺序，从1开始，比如 5表示 "CD8 T" </span></span><span leaf=""><br></span><span leaf="">levels(cellchat@idents) </span><span><span leaf=""># show factor levels of the cell labels</span></span><span leaf=""><br></span><span><span leaf=""># [1] "Naive CD4 T"  "Memory CD4 T" "CD14+ Mono"   "B"            "CD8 T"        "FCGR3A+ Mono" "NK"           "DC"           "Platelet"  </span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">netVisual_bubble(cellchat, sources.use = 5, targets.use = c(1,2,3,4,6,7,8), remove.isolate = FALSE)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYibhGUHpxOX9FqsKL7IIVJsJ3ibvtaT3aX4base3XUzAjkibibB4VAdFDog/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7149425287356321" data-type="png" data-w="870" data-imgfileid="100061068" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYibhGUHpxOX9FqsKL7IIVJsJ3ibvtaT3aX4base3XUzAjkibibB4VAdFDog/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">再指定特定的通讯通路：</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">使用 pairLR.use 参数：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 指定通路</span></span><span leaf=""><br></span><span leaf="">unique(df.net</span><span><span leaf="">$pathway_name</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">pairLR.use &lt;- extractEnrichedLR(cellchat, signaling = c(</span><span><span leaf="">"MIF"</span></span><span leaf="">,</span><span><span leaf="">"CD40"</span></span><span leaf="">,</span><span><span leaf="">"CD99"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">pairLR.use</span><span leaf=""><br></span><span leaf="">netVisual_bubble(cellchat, sources.use = 5, targets.use = c(1,2,3,4,6,7,8), remove.isolate = FALSE,pairLR.use = pairLR.use)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYdIobHPWedib0h0mGbuv6hkhKicRpK0BWL9rXkoZ6sgeELdItCALaWVbQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.564299424184261" data-type="png" data-w="1042" data-imgfileid="100061075" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYdIobHPWedib0h0mGbuv6hkhKicRpK0BWL9rXkoZ6sgeELdItCALaWVbQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">美化</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">上面基本上就是绘制的过程了，现在简单修饰一下。</span></p><p data-tool="mdnice编辑器"><span leaf="">这里图中的格子线 函数中写死了，根据 netVisual_bubble 函数的源码，修改了格子线的粗细：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 美化</span></span><span leaf=""><br></span><span leaf="">p &lt;- netVisual_bubble(cellchat, sources.use = 5, targets.use = c(1,2,3,4,6,7,8), remove.isolate = FALSE,pairLR.use = pairLR.use, grid.on=T,color.grid = </span><span><span leaf="">"black"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 看颜色范围</span></span><span leaf=""><br></span><span leaf="">range(p</span><span><span leaf="">$data</span></span><span><span leaf="">$prob</span></span><span leaf="">,na.rm = T)</span><span leaf=""><br></span><span leaf="">summary(p</span><span><span leaf="">$data</span></span><span><span leaf="">$prob</span></span><span leaf="">,na.rm = T)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p1 &lt;- p + scale_size_continuous(range = c(4, 8), guide = </span><span><span leaf="">"none"</span></span><span leaf="">) +   </span><span><span leaf=""># 调整气泡大小范围</span></span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(</span><span leaf=""><br></span><span leaf="">    colours = c(</span><span><span leaf="">"#2760a9"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"#e50f20"</span></span><span leaf="">),  </span><span><span leaf=""># 定义颜色向量</span></span><span leaf=""><br></span><span leaf="">    values = scales::rescale(c(0.2, 0.35, 0.5)),  </span><span><span leaf=""># 定义颜色映射的范围</span></span><span leaf=""><br></span><span leaf="">    name = </span><span><span leaf="">"Commun. Prob."</span></span><span leaf=""> ) +  </span><span><span leaf=""># 图例标题 </span></span><span leaf=""><br></span><span leaf="">  xlab(label = NULL) + </span><span leaf=""><br></span><span leaf="">  ylab(label = NULL) + </span><span leaf=""><br></span><span leaf="">  geom_vline(xintercept = seq(1.5, length(unique(df.net</span><span><span leaf="">$source</span></span><span leaf="">)) - 0.5, 1)[1:6],lwd = 0.5) + </span><span><span leaf="">## 根据 netVisual_bubble 函数的源码，修改格子线的粗细</span></span><span leaf=""><br></span><span leaf="">  geom_hline(yintercept = seq(1.5, length(unique(df.net</span><span><span leaf="">$interaction_name_2</span></span><span leaf="">)) - 0.5, 1)[1:3], lwd = 0.5) + </span><span leaf=""><br></span><span leaf="">  theme(axis.title.x = element_text(size = 16),  </span><span><span leaf=""># 设置 x 轴标题字体大小</span></span><span leaf=""><br></span><span leaf="">    axis.title.y = element_text(size = 16),  </span><span><span leaf=""># 设置 y 轴标题字体大小</span></span><span leaf=""><br></span><span leaf="">    axis.text.x = element_text(size = 14),  </span><span><span leaf=""># 设置 x 轴刻度标签字体大小</span></span><span leaf=""><br></span><span leaf="">    axis.text.y = element_text(size = 14, face = </span><span><span leaf="">"italic"</span></span><span leaf="">),   </span><span><span leaf=""># 设置 y 轴刻度标签字体大小</span></span><span leaf=""><br></span><span leaf="">    panel.border = element_rect(color = </span><span><span leaf="">"black"</span></span><span leaf="">, fill=NA, size=1),  </span><span><span leaf=""># 设置四周边框的颜色和粗细</span></span><span leaf=""><br></span><span leaf="">    legend.key.size = unit(0.6, </span><span><span leaf="">'cm'</span></span><span leaf="">),  </span><span><span leaf=""># 设置图例键的大小</span></span><span leaf=""><br></span><span leaf="">    legend.text = element_text(size = 12),  </span><span><span leaf=""># 设置图例文本的大小</span></span><span leaf=""><br></span><span leaf="">    legend.title = element_text(size = 13)</span><span leaf=""><br></span><span leaf="">  ) </span><span leaf=""><br></span><span leaf="">p1</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 保存</span></span><span leaf=""><br></span><span leaf="">ggsave(filename = </span><span><span leaf="">"cellchat_bubble.pdf"</span></span><span leaf="">, width = 7.6, height = 4.5,plot = p1)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYMjCoclgEvO3qdSMR4FSMOic4P6Xt88ibOKYOQX9951AhyJicpwW8Tyygw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5888888888888889" data-type="png" data-w="1080" data-imgfileid="100061076" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwnPIpYZibH4zoksO2V4c1ibYMjCoclgEvO3qdSMR4FSMOic4P6Xt88ibOKYOQX9951AhyJicpwW8Tyygw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">完美，今天分享到这~</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544311&amp;idx=1&amp;sn=d41b5838e799f52280e78703135bb603&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课8月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课8月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YTO02blpdAi0PTI63TNtjA",target="_blank" rel="noopener noreferrer">原文链接</a>
