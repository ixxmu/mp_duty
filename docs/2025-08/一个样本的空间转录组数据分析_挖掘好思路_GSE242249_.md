---
title: "一个样本的空间转录组数据分析：挖掘好思路（GSE242249）"
date: 2025-08-05T08:20:51Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
一个样本的空间转录组数据分析：挖掘好思路（GSE242249） by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">空转这发展这么久了，还有只做一个样本的空转分析的，来看看。这篇文献于2024年4月23号发表在J Transl Med.杂志上，文献标题为<span textstyle="">《Integrating spatial transcriptomics and single-cell RNA-sequencing reveals the alterations in epithelial cells during nodular formation in benign prostatic hyperplasia》。</span></span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据背景</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">单细胞数据GEO编号为：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE172357</span></p><p data-tool="mdnice编辑器"><span leaf="">共84,835个细胞被注释为上皮细胞、间质细胞（内皮细胞、成纤维细胞和平滑肌细胞[SMC]）以及免疫细胞（T细胞、髓系细胞、浆细胞、肥大细胞和B细胞）。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100060953" data-ratio="0.3333333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiaAdDT1fBstA2uVBXzKcdR8WqSp18GfTwCtGxRtvNxu6ysHmVRbvmicxw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiaAdDT1fBstA2uVBXzKcdR8WqSp18GfTwCtGxRtvNxu6ysHmVRbvmicxw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">空间转录组数据 GSE242249：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE242249</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">GSM7757059_A4_matrix.csv.gz 9.0 Mb</span><span leaf=""><br></span><span leaf="">GSM7757059_aligned_fiducials.jpg.gz 1.8 Mb</span><span leaf=""><br></span><span leaf="">GSM7757059_detected_tissue_image.jpg.gz 1.9 Mb</span><span leaf=""><br></span><span leaf="">GSM7757059_scalefactors_json.json.gz 164 b</span><span leaf=""><br></span><span leaf="">GSM7757059_tissue_hires_image.png.gz 11.2 Mb</span><span leaf=""><br></span><span leaf="">GSM7757059_tissue_lowres_image.png.gz 1.0 Mb</span><span leaf=""><br></span><span leaf="">GSM7757059_tissue_positions_list.csv.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">良性前列腺增生BPH样本的ST切片用H&amp;E进行组织学染色（图1A），根据ST测序数据，spots水平数据被分为七个不同的簇（C0–C6）（图1A，B）。采用RCTD方法整合ST和scRNA-seq分析的结果，从而识别每个空间簇中的主要细胞类型（图1C–E）：</span></p><ul><li><section><span leaf="">以成纤维细胞（Fib）为主要成分的C0被鉴定为成纤维细胞簇，分布在结节区域内外。</span></section></li><li><section><span leaf="">C6由于其高B细胞和髓系细胞比例被鉴定为免疫簇，主要定位于结节区域外。</span></section></li><li><section><span leaf="">值得注意的是，鉴定出了四个上皮细胞簇（C1、C2、C3和C5），主要定位于以腺上皮细胞为主要成分的腺体上皮区域。</span></section></li><li><section><span leaf="">C1点的分布主要在结节区域内，而C2、C3和C5点的分布主要在结节区域外（图1F），这表明这些上皮细胞在结节形成中具有不同的功能角色。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8Qiaos985xcAIicMkkday1GbXtEBdLBicFsqu8sIjGA47zr9QQ3bicv20CRibg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.012962962962963" data-type="jpeg" data-w="1080" data-imgfileid="100060956" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8Qiaos985xcAIicMkkday1GbXtEBdLBicFsqu8sIjGA47zr9QQ3bicv20CRibg/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">反卷积方法：the robust cell type decomposition (RCTD) method (<span textstyle="">doublet_mode = ’full’</span>)</span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">空转数据读取</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">分别读取count矩阵和切片信息：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">library(data.table)</span><span leaf=""><br></span><span leaf="">library(RColorBrewer)</span><span leaf=""><br></span><span leaf="">library(anndata)</span><span leaf=""><br></span><span leaf="">library(Matrix)</span><span leaf=""><br></span><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">library(future)</span><span leaf=""><br></span><span leaf="">library(dplyr)</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(SeuratData)</span><span leaf=""><br></span><span leaf="">library(cowplot)</span><span leaf=""><br></span><span leaf="">library(patchwork) </span><span leaf=""><br></span><span leaf="">library(jsonlite)</span><span leaf=""><br></span><span leaf="">library(stringr)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 先读取表达矩阵</span></span><span leaf=""><br></span><span><span leaf=""># https://rdrr.io/github/satijalab/seurat/src/R/preprocessing.R</span></span><span leaf=""><br></span><span leaf="">ct &lt;- data.table::fread(</span><span><span leaf="">'GSE242249_RAW/GSM7757059_A4_matrix.csv.gz'</span></span><span leaf="">, data.table = F)</span><span leaf=""><br></span><span leaf="">ct[1:4,1:4]</span><span leaf=""><br></span><span leaf="">colnames(ct) &lt;- gsub(</span><span><span leaf="">'[.]4'</span></span><span leaf="">,</span><span><span leaf="">'-1'</span></span><span leaf="">,colnames(ct))</span><span leaf=""><br></span><span leaf="">rownames(ct) &lt;- ct[,1]</span><span leaf=""><br></span><span leaf="">ct &lt;- ct[,-1]</span><span leaf=""><br></span><span leaf="">ct[1:4,1:4]</span><span leaf=""><br></span><span leaf="">dim(ct)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建Seurat对象</span></span><span leaf=""><br></span><span leaf="">spatial &lt;- CreateSeuratObject(counts = ct, assay = </span><span><span leaf="">"Spatial"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">spatial</span><span leaf=""><br></span><span leaf="">head(colnames(spatial))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 读取HE切片信息</span></span><span leaf=""><br></span><span leaf="">list.files(</span><span><span leaf="">'GSE242249_RAW/spatial/'</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># https://satijalab.org/seurat/reference/read10x_image</span></span><span leaf=""><br></span><span><span leaf=""># should include files tissue_lowres_iamge.png, scalefactors_json.json and tissue_positions_list.csv</span></span><span leaf=""><br></span><span leaf="">img &lt;- Read10X_Image(image.dir = </span><span><span leaf="">'GSE242249_RAW/spatial/'</span></span><span leaf="">, filter.matrix = TRUE)</span><span leaf=""><br></span><span leaf="">img</span><span leaf=""><br></span><span leaf="">head(img</span><span><span leaf="">$centroids</span></span><span leaf="">@coords)</span><span leaf=""><br></span><span leaf="">tail(img</span><span><span leaf="">$centroids</span></span><span leaf="">@coords)</span><span leaf=""><br></span><span><span leaf=""># 取交集</span></span><span leaf=""><br></span><span leaf="">img &lt;- img[Cells(x = spatial)]</span><span leaf=""><br></span><span leaf="">DefaultAssay(spatial = img) &lt;- </span><span><span leaf="">"Spatial"</span></span><span leaf=""><br></span><span leaf="">spatial[[</span><span><span leaf="">'slice1'</span></span><span leaf="">]] &lt;- img</span><span leaf=""><br></span><span leaf="">spatial</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">总共有2945个spots：55411 features across 2945 samples within 2 assays</span></p><p data-tool="mdnice编辑器"><span leaf="">再简单可视化：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">plot1 &lt;- VlnPlot(spatial, features = </span><span><span leaf="">"nCount_Spatial"</span></span><span leaf="">, pt.size = 0.1) + NoLegend()</span><span leaf=""><br></span><span leaf="">plot1</span><span leaf=""><br></span><span leaf="">plot2 &lt;- SpatialFeaturePlot(spatial, features = </span><span><span leaf="">"nCount_Spatial"</span></span><span leaf="">,pt.size.factor = 2.3) + theme(legend.position = </span><span><span leaf="">"right"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">plot2</span><span leaf=""><br></span><span leaf="">wrap_plots(plot1, plot2)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiazDzic0WfDNumFXrTVtSYpmMfO27y0RyTiacUERqLhszwDU9UUic3psGicw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5703703703703704" data-type="jpeg" data-w="1080" data-imgfileid="100060955" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiazDzic0WfDNumFXrTVtSYpmMfO27y0RyTiacUERqLhszwDU9UUic3psGicw/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">标准的降维聚类分群：空转数据推荐使用SCT标准化</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 标准化降为聚类分群</span></span><span leaf=""><br></span><span leaf="">spatial &lt;- SCTransform(spatial, assay = </span><span><span leaf="">"Spatial"</span></span><span leaf="">, return.only.var.genes = FALSE, verbose = FALSE )</span><span leaf=""><br></span><span leaf="">spatial &lt;- RunPCA(spatial, assay = </span><span><span leaf="">"SCT"</span></span><span leaf="">, verbose = FALSE, pcs.compute=50)</span><span leaf=""><br></span><span leaf="">spatial &lt;- FindNeighbors(spatial, reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">, dims = 1:30)</span><span leaf=""><br></span><span leaf="">spatial &lt;- FindClusters(spatial, verbose = FALSE, resolution = c(seq(0.1,1.5,by=0.1),2))</span><span leaf=""><br></span><span leaf="">spatial &lt;- RunUMAP(spatial, reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">, dims = 1:30)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">head(spatial@meta.data)</span><span leaf=""><br></span><span leaf="">Idents(spatial) &lt;- </span><span><span leaf="">"SCT_snn_res.0.5"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p1 &lt;- DimPlot(spatial, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">, label = TRUE,pt.size = 2)</span><span leaf=""><br></span><span leaf="">p1</span><span leaf=""><br></span><span leaf="">p2 &lt;- SpatialDimPlot(spatial,label = TRUE, label.size = 3, pt.size.factor = 2.3)</span><span leaf=""><br></span><span leaf="">p2</span><span leaf=""><br></span><span leaf="">p1 + p2</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">聚类结果如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiaiblTYhV4AQ5FOEdCSnbMPmicUicN1RcgoZM5QicCETdDq9DbeNykR2ZHQQ/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5333333333333333" data-type="jpeg" data-w="1080" data-imgfileid="100060954" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wwFmjfhaLpTB2fRoxEts8QiaiblTYhV4AQ5FOEdCSnbMPmicUicN1RcgoZM5QicCETdDq9DbeNykR2ZHQQ/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">后面结合单细胞数据使用RCTD就可以得到反卷积的结果啦~</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544311&amp;idx=1&amp;sn=d41b5838e799f52280e78703135bb603&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课8月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课8月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ldav12-jIu9qX7vLaLHfZw",target="_blank" rel="noopener noreferrer">原文链接</a>
