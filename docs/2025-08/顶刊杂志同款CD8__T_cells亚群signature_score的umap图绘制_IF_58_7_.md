---
title: "顶刊杂志同款CD8+ T cells亚群signature score的umap图绘制（IF=58.7）"
date: 2025-08-28T15:38:15Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
顶刊杂志同款CD8+ T cells亚群signature score的umap图绘制（IF=58.7） by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">收到我们生信入门班的一个学员求助，希望能看看下面这篇高分文献中的图怎么分析和绘制！<span textstyle="">既然是学员的请求，当然马上开干！</span></span></p><p><span leaf=""><br></span></p><p><span leaf="">此外，我们生信技能树</span><strong><span leaf="">每个月都有一期带领初学者，0基础的生信入门培训，会有各种贴心的答疑，最新一期在7月3号</span></strong><span leaf="">，感兴趣的可以去看看呀：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543525&amp;idx=1&amp;sn=14058118935bd7393156b1d292dca8f9&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">7月3日开课：生信入门&amp;数据挖掘线上直播课7月班</a></span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">这幅图来自</span><strong><span leaf="">2023年5月29号发表在Nature Medicine杂志（IF=58.7）</span></strong><span leaf="">上的文献，标题为《Pan-cancer T cell atlas links a cellular stress response state to immunotherapy resistance》。主要展示了CD8+ T cells亚群中不同的基因集打分umap图展示：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYSicSh0vAQIw22QaYtV4lHeLlriaGRc2QH2Wx4qEyHlK1UppnfkRicbicvA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.41203703703703703" data-type="png" data-w="1080" data-imgfileid="100059973" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYSicSh0vAQIw22QaYtV4lHeLlriaGRc2QH2Wx4qEyHlK1UppnfkRicbicvA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">图注：</span></p><blockquote><p><span leaf="">Fig. 2 | Transcriptional diversity of CD8+ T cells. f, Expression of four representative gene signatures selected from e.</span></p><p><span leaf="">note: curated gene signatures (Fig. 2e and Supplementary Table 4)</span></p></blockquote><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">示例数据</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">因为这里只是为了展示打分技巧不涉及结果解读，所以就用经典的单细胞示例数据 pbmc3k 吧：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span><span leaf=""># install.packages('devtools')</span></span><span leaf=""><br></span><span><span leaf=""># devtools::install_github('satijalab/seurat-data')</span></span><span leaf=""><br></span><span leaf="">library(SeuratData) </span><span><span leaf="">#加载seurat数据集  </span></span><span leaf=""><br></span><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 加载数据</span></span><span leaf=""><br></span><span><span leaf=""># InstallData("pbmc3k")  </span></span><span leaf=""><br></span><span leaf="">data(</span><span><span leaf="">"pbmc3k"</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">sce &lt;- pbmc3k.final</span><span leaf=""><br></span><span leaf="">sce &lt;- UpdateSeuratObject(sce)</span><span leaf=""><br></span><span leaf="">table(Idents(sce)) </span><span leaf=""><br></span><span leaf="">DimPlot(sce,label = T)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYxxeQU0FS4j6xE6LCGSQB5BvWsNE14D5DiayWiaQ9oOZ6lYff8FwEmRGw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8417721518987342" data-type="png" data-w="948" data-imgfileid="100059971" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYxxeQU0FS4j6xE6LCGSQB5BvWsNE14D5DiayWiaQ9oOZ6lYff8FwEmRGw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">刚刚整理了一下这篇文献中使用的  gene signatures，见稿子：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543616&amp;idx=1&amp;sn=4f29e5fb07cbbfc78f91eb4e232e1b19&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">CNS大刊超爱用的CD8+ T cells亚群的gene signatures</a></span></p><p data-tool="mdnice编辑器"><span leaf="">这个图中的四个 signatures 薅出来：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 创建一个空的list对象</span></span><span leaf=""><br></span><span leaf="">gene_signatures &lt;- list(</span><span leaf=""><br></span><span leaf="">  Naive = c(</span><span><span leaf="">"IL7R"</span></span><span leaf="">, </span><span><span leaf="">"CCR7"</span></span><span leaf="">, </span><span><span leaf="">"SELL"</span></span><span leaf="">, </span><span><span leaf="">"FOXO1"</span></span><span leaf="">, </span><span><span leaf="">"KLF2"</span></span><span leaf="">, </span><span><span leaf="">"KLF3"</span></span><span leaf="">, </span><span><span leaf="">"LEF1"</span></span><span leaf="">, </span><span><span leaf="">"TCF7"</span></span><span leaf="">, </span><span><span leaf="">"ACTN1"</span></span><span leaf="">, </span><span><span leaf="">"FOXP1"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Activation_Effector_function = c(</span><span><span leaf="">"FAS"</span></span><span leaf="">, </span><span><span leaf="">"FASLG"</span></span><span leaf="">, </span><span><span leaf="">"CD44"</span></span><span leaf="">, </span><span><span leaf="">"CD69"</span></span><span leaf="">, </span><span><span leaf="">"CD38"</span></span><span leaf="">, </span><span><span leaf="">"NKG7"</span></span><span leaf="">, </span><span><span leaf="">"KLRB1"</span></span><span leaf="">, </span><span><span leaf="">"KLRD1"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"KLRF1"</span></span><span leaf="">, </span><span><span leaf="">"KLRG1"</span></span><span leaf="">, </span><span><span leaf="">"KLRK1"</span></span><span leaf="">, </span><span><span leaf="">"FCGR3A"</span></span><span leaf="">, </span><span><span leaf="">"CX3CR1"</span></span><span leaf="">, </span><span><span leaf="">"CD300A"</span></span><span leaf="">, </span><span><span leaf="">"FGFBP2"</span></span><span leaf="">, </span><span><span leaf="">"ID2"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"ID3"</span></span><span leaf="">, </span><span><span leaf="">"PRDM1"</span></span><span leaf="">, </span><span><span leaf="">"RUNX3"</span></span><span leaf="">, </span><span><span leaf="">"TBX21"</span></span><span leaf="">, </span><span><span leaf="">"ZEB2"</span></span><span leaf="">, </span><span><span leaf="">"BATF"</span></span><span leaf="">, </span><span><span leaf="">"IRF4"</span></span><span leaf="">, </span><span><span leaf="">"NR4A1"</span></span><span leaf="">, </span><span><span leaf="">"NR4A2"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"NR4A3"</span></span><span leaf="">, </span><span><span leaf="">"PBX3"</span></span><span leaf="">, </span><span><span leaf="">"ZNF683"</span></span><span leaf="">, </span><span><span leaf="">"HOPX"</span></span><span leaf="">, </span><span><span leaf="">"FOS"</span></span><span leaf="">, </span><span><span leaf="">"FOSB"</span></span><span leaf="">, </span><span><span leaf="">"JUN"</span></span><span leaf="">, </span><span><span leaf="">"JUNB"</span></span><span leaf="">, </span><span><span leaf="">"JUND"</span></span><span leaf="">, </span><span><span leaf="">"STAT1"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"STAT2"</span></span><span leaf="">, </span><span><span leaf="">"STAT5A"</span></span><span leaf="">, </span><span><span leaf="">"STAT6"</span></span><span leaf="">, </span><span><span leaf="">"STAT4"</span></span><span leaf="">, </span><span><span leaf="">"EOMES"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Cytotoxicity = c(</span><span><span leaf="">"GZMA"</span></span><span leaf="">, </span><span><span leaf="">"GZMB"</span></span><span leaf="">, </span><span><span leaf="">"GZMH"</span></span><span leaf="">, </span><span><span leaf="">"GZMK"</span></span><span leaf="">, </span><span><span leaf="">"GZMH"</span></span><span leaf="">, </span><span><span leaf="">"GNLY"</span></span><span leaf="">, </span><span><span leaf="">"PRF1"</span></span><span leaf="">, </span><span><span leaf="">"IFNG"</span></span><span leaf="">, </span><span><span leaf="">"TNF"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB1"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB6"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB9"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                    </span><span><span leaf="">"CTSA"</span></span><span leaf="">, </span><span><span leaf="">"CTSB"</span></span><span leaf="">, </span><span><span leaf="">"CTSC"</span></span><span leaf="">, </span><span><span leaf="">"CTSD"</span></span><span leaf="">, </span><span><span leaf="">"CTSW"</span></span><span leaf="">, </span><span><span leaf="">"CST3"</span></span><span leaf="">, </span><span><span leaf="">"CST7"</span></span><span leaf="">, </span><span><span leaf="">"CSTB"</span></span><span leaf="">, </span><span><span leaf="">"LAMP1"</span></span><span leaf="">, </span><span><span leaf="">"LAMP3"</span></span><span leaf="">, </span><span><span leaf="">"CAPN2"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Exhaustion = c(</span><span><span leaf="">"PDCD1"</span></span><span leaf="">, </span><span><span leaf="">"LAYN"</span></span><span leaf="">, </span><span><span leaf="">"HAVCR2"</span></span><span leaf="">, </span><span><span leaf="">"LAG3"</span></span><span leaf="">, </span><span><span leaf="">"CD244"</span></span><span leaf="">, </span><span><span leaf="">"CTLA4"</span></span><span leaf="">, </span><span><span leaf="">"LILRB1"</span></span><span leaf="">, </span><span><span leaf="">"TIGIT"</span></span><span leaf="">, </span><span><span leaf="">"TOX"</span></span><span leaf="">, </span><span><span leaf="">"VSIR"</span></span><span leaf="">, </span><span><span leaf="">"BTLA"</span></span><span leaf="">, </span><span><span leaf="">"ENTPD1"</span></span><span leaf="">, </span><span><span leaf="">"CD160"</span></span><span leaf="">, </span><span><span leaf="">"LAIR1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">gene_signatures</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">计算基因集打分</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">计算基因集打分有非常多算法：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535495&amp;idx=1&amp;sn=a7e5218bfeaa70ca81b1c5bc1d9ac832&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">使用decoupleR一次性实现11种基因集的活性打分（R与Python我都要）</a></span></p><p data-tool="mdnice编辑器"><span leaf="">我们这里就用文献中的吧：addModuleScore函数</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYFKsxI1DohUZt9XBKKqaqe2rhFjXqtpFX3hDkhnmRKW9nUveZxszQ3w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.24262607040913417" data-type="png" data-w="1051" data-imgfileid="100059969" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYFKsxI1DohUZt9XBKKqaqe2rhFjXqtpFX3hDkhnmRKW9nUveZxszQ3w/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">打分计算：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">#########################</span></span><span leaf=""><br></span><span><span leaf=""># AddModuleScore 得到的是每个细胞中算出来的我们感兴趣的基因的表达均值</span></span><span leaf=""><br></span><span><span leaf=""># 创建一个空的list对象</span></span><span leaf=""><br></span><span leaf="">gene_signatures &lt;- list(</span><span leaf=""><br></span><span leaf="">  Naive = c(</span><span><span leaf="">"IL7R"</span></span><span leaf="">, </span><span><span leaf="">"CCR7"</span></span><span leaf="">, </span><span><span leaf="">"SELL"</span></span><span leaf="">, </span><span><span leaf="">"FOXO1"</span></span><span leaf="">, </span><span><span leaf="">"KLF2"</span></span><span leaf="">, </span><span><span leaf="">"KLF3"</span></span><span leaf="">, </span><span><span leaf="">"LEF1"</span></span><span leaf="">, </span><span><span leaf="">"TCF7"</span></span><span leaf="">, </span><span><span leaf="">"ACTN1"</span></span><span leaf="">, </span><span><span leaf="">"FOXP1"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Activation_Effector_function = c(</span><span><span leaf="">"FAS"</span></span><span leaf="">, </span><span><span leaf="">"FASLG"</span></span><span leaf="">, </span><span><span leaf="">"CD44"</span></span><span leaf="">, </span><span><span leaf="">"CD69"</span></span><span leaf="">, </span><span><span leaf="">"CD38"</span></span><span leaf="">, </span><span><span leaf="">"NKG7"</span></span><span leaf="">, </span><span><span leaf="">"KLRB1"</span></span><span leaf="">, </span><span><span leaf="">"KLRD1"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"KLRF1"</span></span><span leaf="">, </span><span><span leaf="">"KLRG1"</span></span><span leaf="">, </span><span><span leaf="">"KLRK1"</span></span><span leaf="">, </span><span><span leaf="">"FCGR3A"</span></span><span leaf="">, </span><span><span leaf="">"CX3CR1"</span></span><span leaf="">, </span><span><span leaf="">"CD300A"</span></span><span leaf="">, </span><span><span leaf="">"FGFBP2"</span></span><span leaf="">, </span><span><span leaf="">"ID2"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"ID3"</span></span><span leaf="">, </span><span><span leaf="">"PRDM1"</span></span><span leaf="">, </span><span><span leaf="">"RUNX3"</span></span><span leaf="">, </span><span><span leaf="">"TBX21"</span></span><span leaf="">, </span><span><span leaf="">"ZEB2"</span></span><span leaf="">, </span><span><span leaf="">"BATF"</span></span><span leaf="">, </span><span><span leaf="">"IRF4"</span></span><span leaf="">, </span><span><span leaf="">"NR4A1"</span></span><span leaf="">, </span><span><span leaf="">"NR4A2"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"NR4A3"</span></span><span leaf="">, </span><span><span leaf="">"PBX3"</span></span><span leaf="">, </span><span><span leaf="">"ZNF683"</span></span><span leaf="">, </span><span><span leaf="">"HOPX"</span></span><span leaf="">, </span><span><span leaf="">"FOS"</span></span><span leaf="">, </span><span><span leaf="">"FOSB"</span></span><span leaf="">, </span><span><span leaf="">"JUN"</span></span><span leaf="">, </span><span><span leaf="">"JUNB"</span></span><span leaf="">, </span><span><span leaf="">"JUND"</span></span><span leaf="">, </span><span><span leaf="">"STAT1"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"STAT2"</span></span><span leaf="">, </span><span><span leaf="">"STAT5A"</span></span><span leaf="">, </span><span><span leaf="">"STAT6"</span></span><span leaf="">, </span><span><span leaf="">"STAT4"</span></span><span leaf="">, </span><span><span leaf="">"EOMES"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Cytotoxicity = c(</span><span><span leaf="">"GZMA"</span></span><span leaf="">, </span><span><span leaf="">"GZMB"</span></span><span leaf="">, </span><span><span leaf="">"GZMH"</span></span><span leaf="">, </span><span><span leaf="">"GZMK"</span></span><span leaf="">, </span><span><span leaf="">"GZMH"</span></span><span leaf="">, </span><span><span leaf="">"GNLY"</span></span><span leaf="">, </span><span><span leaf="">"PRF1"</span></span><span leaf="">, </span><span><span leaf="">"IFNG"</span></span><span leaf="">, </span><span><span leaf="">"TNF"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB1"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB6"</span></span><span leaf="">, </span><span><span leaf="">"SERPINB9"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                    </span><span><span leaf="">"CTSA"</span></span><span leaf="">, </span><span><span leaf="">"CTSB"</span></span><span leaf="">, </span><span><span leaf="">"CTSC"</span></span><span leaf="">, </span><span><span leaf="">"CTSD"</span></span><span leaf="">, </span><span><span leaf="">"CTSW"</span></span><span leaf="">, </span><span><span leaf="">"CST3"</span></span><span leaf="">, </span><span><span leaf="">"CST7"</span></span><span leaf="">, </span><span><span leaf="">"CSTB"</span></span><span leaf="">, </span><span><span leaf="">"LAMP1"</span></span><span leaf="">, </span><span><span leaf="">"LAMP3"</span></span><span leaf="">, </span><span><span leaf="">"CAPN2"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Exhaustion = c(</span><span><span leaf="">"PDCD1"</span></span><span leaf="">, </span><span><span leaf="">"LAYN"</span></span><span leaf="">, </span><span><span leaf="">"HAVCR2"</span></span><span leaf="">, </span><span><span leaf="">"LAG3"</span></span><span leaf="">, </span><span><span leaf="">"CD244"</span></span><span leaf="">, </span><span><span leaf="">"CTLA4"</span></span><span leaf="">, </span><span><span leaf="">"LILRB1"</span></span><span leaf="">, </span><span><span leaf="">"TIGIT"</span></span><span leaf="">, </span><span><span leaf="">"TOX"</span></span><span leaf="">, </span><span><span leaf="">"VSIR"</span></span><span leaf="">, </span><span><span leaf="">"BTLA"</span></span><span leaf="">, </span><span><span leaf="">"ENTPD1"</span></span><span leaf="">, </span><span><span leaf="">"CD160"</span></span><span leaf="">, </span><span><span leaf="">"LAIR1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">gene_signatures</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce =  AddModuleScore(object = sce,features = gene_signatures,name=names(gene_signatures) )</span><span leaf=""><br></span><span leaf="">colnames(sce@meta.data)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">得到四列打分值：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYLR9QgcGMlOqic15sf5dtG8LOQiblmwAo1oE5kVtWxZL48wcTM2CYyKYg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.22870370370370371" data-type="png" data-w="1080" data-imgfileid="100059972" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbYLR9QgcGMlOqic15sf5dtG8LOQiblmwAo1oE5kVtWxZL48wcTM2CYyKYg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">绘图：</span></span><span></span></h3><pre data-tool="mdnice编辑器"><code><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">p1 &lt;- FeaturePlot(sce,features = </span><span><span leaf="">"Naive1"</span></span><span leaf="">,order = T) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"Naive"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colors = c(</span><span><span leaf="">"#4f5da7"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"#ea3433"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">p1</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p2 &lt;- FeaturePlot(sce,features = </span><span><span leaf="">"Activation_Effector_function2"</span></span><span leaf="">,order = T) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"Activation/Effector_function"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colors = c(</span><span><span leaf="">"#4f5da7"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"#ea3433"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">p2</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p3 &lt;- FeaturePlot(sce,features = </span><span><span leaf="">"Cytotoxicity3"</span></span><span leaf="">,order = T) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"Cytotoxicity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colors = c(</span><span><span leaf="">"#4f5da7"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"#ea3433"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">p3</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p4 &lt;- FeaturePlot(sce,features = </span><span><span leaf="">"Exhaustion4"</span></span><span leaf="">,order = T) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"Exhaustion"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colors = c(</span><span><span leaf="">"#4f5da7"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"#ea3433"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">p4</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">library(patchwork)</span><span leaf=""><br></span><span leaf="">p &lt;- patchwork::wrap_plots(list(p1,p2,p3,p4), nrow = 1)</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span><span leaf="">ggsave(filename = </span><span><span leaf="">"cd8t_score.png"</span></span><span leaf="">, width = 16,height = 3.5,plot = p,</span><span><span leaf="">bg</span></span><span leaf=""> = </span><span><span leaf="">"white"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">结果如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbY2BCjxUC2mB39WQicBicp4QukFkeCiaEfjAYRXKhf0l3FwOkZJaSCORDOA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.21688741721854304" data-type="png" data-w="1812" data-imgfileid="100059970" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx0rUhMKapSu0aZIeeAgVbY2BCjxUC2mB39WQicBicp4QukFkeCiaEfjAYRXKhf0l3FwOkZJaSCORDOA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">是不是很简单，你学会了吗~</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课7月班</span></a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zUgmuov5buhm1mwoO4HpUQ",target="_blank" rel="noopener noreferrer">原文链接</a>
