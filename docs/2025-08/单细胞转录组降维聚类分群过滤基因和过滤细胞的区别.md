---
title: "单细胞转录组降维聚类分群过滤基因和过滤细胞的区别"
date: 2025-08-25T03:48:08Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
单细胞转录组降维聚类分群过滤基因和过滤细胞的区别 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>我们给了大家一个常规的可以批量导入全部的10x单细胞表达量矩阵文件夹的代码：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># 参考：https://mp.weixin.qq.com/s/tw7lygmGDAbpzMTx57VvFw</span><br>dir=<span>'GSE163558_RAW'</span><br>samples=list.files( dir  )<br><span>#samples=samples[1:2]</span><br>sceList = lapply(samples,<span>function</span>(pro){ <br>  <span># pro=samples[1] </span><br>  print(pro)  <br>  tmp = Read10X(file.path(dir,pro ) ) <br>  print(dim(tmp))<br>  <span>if</span>(length(tmp)==<span>2</span>){<br>    ct = tmp[[<span>1</span>]] <br>  }<span>else</span>{ct = tmp}<br>  print(dim(ct))<br>  sce =CreateSeuratObject(counts =  ct ,<br>                          project =  gsub(<span>'GSM[0-9]*_'</span>,<span>''</span>,pro)  ,<br>                          min.cells = <span>5</span>,<br>                          min.features = <span>300</span> )<br>  <span>return</span>(sce)<br>}) <br></code></pre><p data-tool="mdnice编辑器">里面有两个很重要的参数，  min.cells = 5,  和  min.features = 300 ，它们都是为了过滤我们的单细胞表达量矩阵，但是前者是过滤基因，后者是过滤细胞。以下是这两个参数的具体意义：</p><ol data-tool="mdnice编辑器"><li><section><strong>min.cells</strong>：</section></li></ol><ul><li><section>这个参数指定了一个基因需要在至少多少个细胞中表达（即检测到的表达量大于0）的最小细胞数。例如，如果设置 <code>min.cells = 5</code>，那么只有那些在至少5个细胞中表达的基因才会被保留在最终的表达矩阵中。这个过滤步骤有助于去除那些可能由于随机噪声或测序误差而在极少数细胞中被检测到的基因，这些基因不太可能对生物学解释有贡献。</section></li></ul><li><section><strong>min.features</strong>：</section></li><ul><li><section>这个参数指定了细胞需要表达的最小基因数。例如，如果设置 <code>min.features = 300</code>，那么只有表达超过300个基因的细胞才会被保留在分析中。这个过滤步骤有助于去除那些测序深度不足或质量较低的细胞，这些细胞可能无法提供足够的生物学信息，或者可能代表了技术或生物学上的异常情况。</section></li></ul><p data-tool="mdnice编辑器">使用这些过滤参数的目的是从原始数据中移除不可靠或不相关的信息，从而提高后续分析（如聚类、差异表达分析等）的准确性和可解释性。过滤后的数据集应该更加聚焦于生物学上有意义的变异，减少分析结果中的假阳性。在实际应用中，选择适当的过滤参数值需要考虑实验设计、测序深度、数据质量以及生物学问题。<strong>过滤参数的设置应该基于对数据的初步探索和理解，以及可能的领域知识。过滤过程应该谨慎进行，以确保不会无意中移除重要的生物学信号。</strong></p><p data-tool="mdnice编辑器">假如是比较早期的10x技术的单细胞转录组，如果你想从表达量矩阵里面看看中性粒细胞，它的整体文库就偏小，甚至可以修改   min.features = 300 成为   min.features = 200，如果是比较成熟的最近的10x技术的单细胞转录组，你也可以放宽这个阈值啦！</p><h3 data-tool="mdnice编辑器"><span></span><span>更多的细胞过滤参数</span><span></span></h3><p data-tool="mdnice编辑器">上面的min.features = 300 是规定了细胞的下限，它就是计算nFeature_RNA值，如果这个值过低说明细胞质量肯定是不行，但是过高也不是好事，因为有可能是双细胞。但是如果是处于细胞增殖状态的细胞或者恶性的肿瘤细胞，它的nFeature_RNA值本来就会很高。所以我们很少会设置nFeature_RNA值的上限。类似的3个常见的过滤参数及其意义：</p><ol data-tool="mdnice编辑器"><li><section><strong>nFeature_RNA</strong>：</section></li></ol><ul><li><section>这个参数代表每个细胞中检测到的基因特征（如基因或转录本）的数量。过滤掉低的<code>nFeature_RNA</code>值可以帮助去除那些测序深度不够或背景噪声较高的细胞。</section></li></ul><li><section><strong>nCount_RNA</strong>：</section></li><ul><li><section>这个参数表示细胞中所有基因的测序读段总数。它是一个衡量每个细胞测序数据总量的指标。去除<code>nCount_RNA</code>过低的细胞可以排除那些可能由于技术原因导致数据不足的细胞。</section></li></ul><li><section><strong>percent_mito</strong>：</section></li><ul><li><section>这个参数代表线粒体基因表达占总基因表达的比例。高比例的线粒体基因表达可能指示细胞应激或损伤。通过设置过滤阈值，可以去除可能不健康或死亡的细胞。</section></li></ul><p data-tool="mdnice编辑器">其中线粒体基因表达占总基因表达的比例是可以扩充到核糖体基因占比，红细胞基因占比等等。</p><p data-tool="mdnice编辑器">比如文献题目为“Revealing the transcriptional heterogeneity of organ-specific metastasis in human gastric cancer using single-cell RNA Sequencing”。通讯作者是浙江大学的范骁辉教授，于2022年发表在Clin Transl Med杂志（IF=10.6）。可以看到文章的过滤参数是：</p><p><img data-imgfileid="100049401" data-ratio="0.8233995584988962" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyNKxUWD7tHxp4lRAoqpmf6TzoAsADYmP9jbQsmALwZicvgSSnOvFVdQ8pROQxEpHrrm49CGMjMFOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="906" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyNKxUWD7tHxp4lRAoqpmf6TzoAsADYmP9jbQsmALwZicvgSSnOvFVdQ8pROQxEpHrrm49CGMjMFOg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>文章的过滤参数</figcaption></figure><p data-tool="mdnice编辑器">就需要使用下面的代码：</p><pre data-tool="mdnice编辑器"><span></span><code>tmp=subset(sce.all.filt,subset = percent_mito &lt; 20 &amp;<br>            <span>#nCount_RNA &lt;10000 &amp;</span><br>              nFeature_RNA &lt;5000 &amp;<br>             nFeature_RNA&gt;200)<br></code></pre><p data-tool="mdnice编辑器">很简单的可以看出来每个阈值都是为了过滤细胞哦：</p><ul data-tool="mdnice编辑器"><li><section><code>percent_mito &lt; 20</code>：过滤掉线粒体基因表达占比超过20%的细胞，这有助于去除可能由于细胞应激或损伤而异常表达线粒体基因的细胞。</section></li><li><section><code>nFeature_RNA &lt; 5000</code>：过滤掉表达特征数超过5000的细胞。这可能是为了去除高表达细胞，它们可能代表了技术异常或生物学上的异常状态，如细胞周期的某些阶段。</section></li><li><section><code>nFeature_RNA &gt; 200</code>：过滤掉表达特征数少于200的细胞，这有助于去除测序深度不足或背景噪声较高的细胞。</section></li></ul><p data-tool="mdnice编辑器">请注意，这些阈值的设定需要根据具体的数据集和实验目的来确定。<strong>研究人员可能需要通过探索性数据分析（EDA）来评估数据的分布，并根据数据的特定特征来调整过滤参数。</strong>此外，过滤决策可能需要基于领域知识和实验设计进行调整。</p><h3 data-tool="mdnice编辑器"><span></span><span>什么时候过滤基因呢</span><span></span></h3><p data-tool="mdnice编辑器">其实过滤基因的操作就是单细胞转录组标准流程里面的降维聚类分群环节的降维啦，</p><p data-tool="mdnice编辑器"><strong>过滤基因（Filtering Genes）</strong>：</p><ul data-tool="mdnice编辑器"><li><section><p>根据特定的标准（如表达水平、检测到的细胞数等）去除那些可能不可靠或生物学意义不大的基因。</p></section></li><li><section><p>主要是设置：<strong>min.cells = 5</strong>：</p></section></li><li><section><p>这个参数指定了一个基因需要在至少5个细胞中被检测到（即在这些细胞中表达量大于0）。这有助于过滤掉只在极少数细胞中表达的基因，这些基因可能由于随机噪声或技术变异而出现。</p></section></li></ul><p data-tool="mdnice编辑器"><strong>挑选高变基因（Highly Variable Genes, HVGs）</strong>：</p><ul data-tool="mdnice编辑器"><li><section>高变基因是指在细胞间表达差异较大的基因。这些基因在单细胞数据集中可能特别有信息量，因为它们可能与细胞状态、功能或身份有关。通常选择一定数量的高变基因进行后续分析，比如2000个。</section></li></ul><p data-tool="mdnice编辑器"><strong>降维（Dimensionality Reduction）</strong>：</p><ul data-tool="mdnice编辑器"><li><section>降维技术用于减少数据集中的变量数量，同时尽可能保留数据的重要结构和变异。在单细胞转录组分析中，常用的降维方法包括主成分分析（PCA）和t-分布随机邻域嵌入（t-SNE）。</section></li></ul></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533037&amp;idx=2&amp;sn=e6dd07e9339a84c8cbad2a9d6b42c8ca&amp;chksm=9b4b0156ac3c88403c55822722f6a93cde401fbb7b7cdbaee2a07211347e751ce414b7a47ec7&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然‍是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。 </span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dyUY3_bhsAZOjlzzwuSy0A",target="_blank" rel="noopener noreferrer">原文链接</a>
