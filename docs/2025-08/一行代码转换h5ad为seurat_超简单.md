---
title: "一行代码转换h5ad为seurat：超简单"
date: 2025-08-05T09:08:44Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
一行代码转换h5ad为seurat：超简单 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">前面我在写scanpy的h5ad转为R中的seurat对象时，写了这几个稿子：</span></p><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544455&amp;idx=1&amp;sn=b99733e323d0e090a711c863060c2fc6&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">100w个细胞的单细胞h5ad对象转换为seurat：python版本</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247539872&amp;idx=1&amp;sn=d94435d6e5e8700f1f2c5dd9e391f807&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">单细胞h5ad转成seurat对象后metadata信息丢失怎么办？(GSE156625)</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538661&amp;idx=1&amp;sn=0498c055ece839ff0ceca55b47a942cb&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">一步一个坑：单细胞数据的h5ad格式转换成R可读取对象</a></span></section></li></ul><p><span leaf=""><span textstyle="">万能的网友又给我支招了，这次给我推荐了一个我试过了后觉得超棒的方法：</span>使用 schard 包进行转换，一行代码就可！</span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span><span leaf="">schard包安装</span></span></h2><p data-tool="mdnice编辑器"><span leaf="" data-pm-slice="0 0 []"><span textstyle="">我们生信技能树</span></span><strong><span leaf=""><span textstyle="">每个月都有一期带领初学者，0基础的生信入门培训，</span><span textstyle="">会有各种贴心的答疑，甚至是新叶老师给你的一对一专属答疑，远程代码演示</span><span textstyle="">，快来：最新一期在</span><span textstyle="">8月4号</span></span></strong><span leaf=""><span textstyle="">，感兴趣的可以去看看呀：</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544311&amp;idx=1&amp;sn=d41b5838e799f52280e78703135bb603&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课8月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课8月班</span></a><span textstyle="">。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">包的网址：https://github.com/cellgeni/schard</span></p><p data-tool="mdnice编辑器"><span leaf="">首先安装一下，非常简单：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">options(download.file.method = </span><span><span leaf="">"libcurl"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(url.method = </span><span><span leaf="">"libcurl"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">## 使用西湖大学的 Bioconductor镜像</span></span><span leaf=""><br></span><span leaf="">options(BioC_mirror=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/bioconductor"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(</span><span><span leaf="">"repos"</span></span><span leaf="">=c(CRAN=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/CRAN/"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 安装</span></span><span leaf=""><br></span><span leaf="">devtools::install_github(</span><span><span leaf="">"cellgeni/schard"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">丝滑：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtmMeIPVO2cSjYDbDQ1Jz8I8UjUUcklUbRNFKWf2qKqIiayrKv0x1NNeg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.43425925925925923" data-type="png" data-w="1080" data-imgfileid="100060890" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtmMeIPVO2cSjYDbDQ1Jz8I8UjUUcklUbRNFKWf2qKqIiayrKv0x1NNeg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">使用</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">先把示例数据下载下来：</span></p><p data-tool="mdnice编辑器"><span leaf="">或者用我上面开头的帖子中数据</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(schard)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">download.file(</span><span><span leaf="">'https://datasets.cellxgene.cziscience.com/c5ac5c36-f60c-4680-8018-2d6cb65c0a37.h5ad'</span></span><span leaf="">,</span><span><span leaf="">'vis.heart.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">download.file(</span><span><span leaf="">'https://datasets.cellxgene.cziscience.com/8cc521c8-c4ff-4cba-a07b-cae67a9dcba9.h5ad'</span></span><span leaf="">,</span><span><span leaf="">'sn.heart.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">download.file(</span><span><span leaf="">'https://covid19.cog.sanger.ac.uk/baron16.processed.h5ad'</span></span><span leaf="">,</span><span><span leaf="">'ba16.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">转为Single Cell Experiment：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># load h5ad as Single Cell Experiment</span></span><span leaf=""><br></span><span leaf="">ba16.sce = schard::h5ad2sce(</span><span><span leaf="">'ba16.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ba16.sce</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtbh1Ke2vmujggBXdxqQE9LKrUrvPMK4H19aMK3pkrDqDCNDdoVKYnzw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.26481481481481484" data-type="png" data-w="1080" data-imgfileid="100060888" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtbh1Ke2vmujggBXdxqQE9LKrUrvPMK4H19aMK3pkrDqDCNDdoVKYnzw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">转为Seurat对象：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># load h5ad as Seurat</span></span><span leaf=""><br></span><span leaf="">snhx = schard::h5ad2seurat(</span><span><span leaf="">'sn.heart.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">snhx</span><span leaf=""><br></span><span leaf="">meta &lt;- snhx@meta.data</span><span leaf=""><br></span><span leaf="">head(snhx@meta.data)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">DimPlot(snhx,group.by = </span><span><span leaf="">"cell_state"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtibHKJfOhWlaqR2vymAp02QibibwzXmic5rT6HApFDmMiaE3XsY5xUhpMELg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9438058748403576" data-type="png" data-w="783" data-imgfileid="100060889" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtibHKJfOhWlaqR2vymAp02QibibwzXmic5rT6HApFDmMiaE3XsY5xUhpMELg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">空转数据转为seurat：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># load all visium samples as single Seurat object</span></span><span leaf=""><br></span><span leaf="">visx = schard::h5ad2seurat_spatial(</span><span><span leaf="">'vis.heart.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">visx</span><span leaf=""><br></span><span leaf="">head(visx@meta.data)</span><span leaf=""><br></span><span><span leaf=""># 可视化</span></span><span leaf=""><br></span><span leaf="">SpatialDimPlot(visx,group.by = </span><span><span leaf="">"cell_type"</span></span><span leaf="">,ncol = 2)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtsFWib1Z4aobnnEbMuzOsATkUbegoMR7NNUVNaORVogSjV7OmKFib3fJA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.48055555555555557" data-type="jpeg" data-w="1080" data-imgfileid="100060891" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wzBpBAgGn0k1AFuxibfUSFUtsFWib1Z4aobnnEbMuzOsATkUbegoMR7NNUVNaORVogSjV7OmKFib3fJA/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">其他的用法：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># or load as list of Seurat objects (per slide</span></span><span leaf=""><br></span><span leaf="">visl = schard::h5ad2seurat_spatial(</span><span><span leaf="">'vis.heart.h5ad'</span></span><span leaf="">,simplify = FALSE)</span><span leaf=""><br></span><span><span leaf=""># or load raw counts</span></span><span leaf=""><br></span><span leaf="">snhr = schard::h5ad2seurat(</span><span><span leaf="">'sn.heart.h5ad'</span></span><span leaf="">,use.raw = TRUE)</span><span leaf=""><br></span><span><span leaf=""># raw counts for visium</span></span><span leaf=""><br></span><span leaf="">visr = schard::h5ad2seurat_spatial(</span><span><span leaf="">'vis.heart.h5ad'</span></span><span leaf="">,use.raw = TRUE)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">是不是超棒！</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247544311&amp;idx=1&amp;sn=d41b5838e799f52280e78703135bb603&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课8月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课8月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/3zswmnJHLAcOcXSansd0-A",target="_blank" rel="noopener noreferrer">原文链接</a>
