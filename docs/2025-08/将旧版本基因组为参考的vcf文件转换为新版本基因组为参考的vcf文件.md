---
title: "将旧版本基因组为参考的vcf文件转换为新版本基因组为参考的vcf文件"
date: 2025-08-23T03:25:35Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
将旧版本基因组为参考的vcf文件转换为新版本基因组为参考的vcf文件 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">三代长读长测序越来越便宜，许多基因组都开始更新到了T2T水平，之前一些大群体重测序数据做的vcf文件用的是老版本基因组，需要将变异坐标迁移到新版本的基因组上。当然最准确的还是下载重测序数据直接用新版本的基因组重新call变异。但是这个需要比较充足的计算资源，时间相对也比较长。坐标迁移相对速度会快很多。</span></p><p data-tool="mdnice编辑器"><span leaf="">人类数据通常用liftover，查了一下这个工具，需要准备一个chain文件，不知道其他物种的chain文件怎么准备</span></p><p data-tool="mdnice编辑器"><span leaf="">https://biojuse.com/2025/02/12/VCF%20%E6%96%87%E4%BB%B6%E8%BD%AC%E5%9D%90%E6%A0%87%E7%9A%84%E6%96%B9%E6%B3%95%E6%B1%87%E6%80%BB%E5%8F%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</span></p><p data-tool="mdnice编辑器"><span leaf="">这个链接介绍了几种常用的坐标转换工具，但是也没说chain文件怎么准备</span></p><p data-tool="mdnice编辑器"><span leaf="">https://www.jianshu.com/p/6a9d481ad911</span></p><p data-tool="mdnice编辑器"><span leaf="">这个链接介绍了transanno这个工具，可以把minimap2的比对文件转换成chain文件，同时还有坐标转换的工具</span></p><p data-tool="mdnice编辑器"><span leaf="">transanno 工具的github主页</span></p><p data-tool="mdnice编辑器"><span leaf="">https://github.com/informationsea/transanno</span></p><p data-tool="mdnice编辑器"><span leaf="">这个工具直接用conda就可以安装</span></p><p data-tool="mdnice编辑器"><span leaf="">我这边安装的是0.4.5这个版本</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">基本用法</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">第一步是做基因组比对用minimap2</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">minimap2 -cx asm5 --cs QUERY_FASTA.fa REFERENCE_FASTA.fa &gt; PAF_FILE.paf</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">reference_fasta是 vcf文件原始的参考基因组</span></p><p data-tool="mdnice编辑器"><span leaf="">query_fasta是更新版的基因组</span></p><p data-tool="mdnice编辑器"><span leaf="">第二步是利用比对的paf格式的文件转换为chain文件</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">transanno minimap2chain PAF_FILE.paf --output chainfile.chain</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">第三步是转换vcf文件的坐标</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">transano liftvcf --original-assembly ref.fasta --new-assembly query.fasta --chain chainfile.chain --vcf raw.vcf --output raw.done.vcf --fail raw.failed.vcf</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">怎么来检查一下转换的位置是否准确呢，暂时没有搞明白</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">欢迎大家关注我的公众号</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">小明的数据分析笔记本</span></strong></p><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="小明的数据分析笔记本" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-id="MzI3NzQ3MTcxMg==" data-is_biz_ban="0" data-service_type="1" data-verify_status="1"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong><span leaf=""><br></span></strong></p><blockquote><span></span><p><span leaf="">小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</span></p></blockquote></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1oWCiBsKkKmQhRUYmMk0vA",target="_blank" rel="noopener noreferrer">原文链接</a>
