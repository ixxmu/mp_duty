---
title: "Pythonå•ç»†èƒå­¦ä¹ (Best practics)æµç¨‹ä¸€"
date: 2025-08-05T08:14:44Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ–¹èˆŸ"
]
categories: ["Acdemic"]
---
Pythonå•ç»†èƒå­¦ä¹ (Best practics)æµç¨‹ä¸€ by ç”Ÿä¿¡æ–¹èˆŸ
------
<div><section><span leaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡æ–¹èˆŸ" data-alias="shengxinfangzhou" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGfe15Xm0WHdoAMNGvE93bmxaF9iabfPiaO9ic6Tmd8XW1PMiaeuqicSFhCLQJibAUhHsamS1LbaJMFiaZXA/0?wx_fmt=png" data-signature="çƒ­çˆ±åŒ»å­¦å’Œæ•°æ®ç§‘å­¦ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œå­¦ä¹ å’Œæ•´ç†ç›¸å…³çš„çŸ¥è¯†ã€‚" data-id="MzkwMjYyMDA1OA==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></span></section><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100005032" data-ratio="1.0141752577319587" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU0mqBrVWRNfN9iaQq5A6CLsx7tdEJ2NP9ZypPgH4CiakZySx4NvibsaoJgw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="776" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU0mqBrVWRNfN9iaQq5A6CLsx7tdEJ2NP9ZypPgH4CiakZySx4NvibsaoJgw/640?wx_fmt=other&amp;from=appmsg"></span></figure><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å•ç»†èƒåˆ†ææ¡†æ¶: Bioconductor, Seurat, scverse</span></span><span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨è·å¾—è®¡æ•°çŸ©é˜µä¹‹åï¼Œå¦‚å‰æ‰€è¿°ï¼Œæ¢ç´¢æ€§æ•°æ®åˆ†æé˜¶æ®µå°±å¼€å§‹äº†ã€‚ç”±äºæ•°æ®çš„ä½“é‡å’Œå¤æ‚æ€§ï¼Œéœ€è¦ä½¿ç”¨ä¸“é—¨çš„å·¥å…·ã€‚åœ¨å•ç»†èƒåˆ†æçš„æ—©æœŸï¼Œäººä»¬é€šå¸¸ä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬æ¥åˆ†ææ•°æ®ï¼Œè€Œå¦‚ä»Šå·²ç»æœ‰äº†ä¸“ä¸ºæ­¤ç›®çš„è€Œè®¾è®¡çš„æ¡†æ¶ã€‚ç›®å‰æœ€æµè¡Œçš„ä¸‰ä¸ªé€‰æ‹©æ˜¯ï¼šåŸºäºRçš„ Bioconductorå’ŒSeuratç”Ÿæ€ç³»ç»Ÿï¼Œä»¥åŠåŸºäº Python çš„scverseç”Ÿæ€ç³»ç»Ÿã€‚è¿™äº›æ¡†æ¶ä¸ä»…åœ¨æ‰€ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸Šæœ‰æ‰€ä¸åŒï¼Œè¿˜åœ¨åº•å±‚æ•°æ®ç»“æ„å’Œå¯ç”¨çš„ä¸“ä¸šåˆ†æå·¥å…·ä¸Šå„å…·ç‰¹è‰²ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Bioconductorï¼šæ˜¯ä¸€ä¸ªå¼€å‘ã€æ”¯æŒå¹¶å…±äº«è‡ªç”±å¼€æºè½¯ä»¶çš„é¡¹ç›®ï¼Œä¸“æ³¨äºå¤šç§ç”Ÿç‰©å®éªŒæ•°æ®çš„ä¸¥æ ¼å’Œå¯é‡å¤æ€§åˆ†æï¼ŒåŒ…æ‹¬å•ç»†èƒæ•°æ®ã€‚ç»Ÿä¸€çš„å¼€å‘è€…ä¸ç”¨æˆ·ä½“éªŒã€ä¸°å¯Œçš„æ–‡æ¡£èµ„æ–™ä»¥åŠç”¨æˆ·å‹å¥½çš„ä½¿ç”¨ç¤ºä¾‹ï¼ˆvignettesï¼‰æ˜¯ Bioconductor çš„æœ€å¤§ä¼˜åŠ¿ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Seuratï¼šæ˜¯ä¸€ä¸ªå¹¿å—è®¤å¯çš„ R åŒ…ï¼Œä¸“é—¨ç”¨äºå•ç»†èƒæ•°æ®åˆ†æã€‚å®ƒæä¾›äº†è´¯ç©¿æ•´ä¸ªåˆ†ææµç¨‹çš„å·¥å…·ï¼Œæ¶µç›–äº†å¤šæ¨¡æ€æ•°æ®å’Œç©ºé—´è½¬å½•ç»„æ•°æ®ã€‚å®Œå–„çš„ç¤ºä¾‹æ–‡æ¡£ä»¥åŠåºå¤§çš„ç”¨æˆ·ç¾¤ä½“ä½¿å¾— Seurat æ·±å—æ¬¢è¿ã€‚ç„¶è€Œï¼Œå¯¹äºæå¤§è§„æ¨¡çš„æ•°æ®é›†ï¼ˆè¶…è¿‡ 50 ä¸‡ä¸ªç»†èƒï¼‰ï¼Œè¿™ä¸¤ä¸ª R æ–¹æ¡ˆå¯èƒ½ä¼šåœ¨å¯æ‰©å±•æ€§æ–¹é¢é‡åˆ°ç“¶é¢ˆï¼Œè¿™ä¿ƒä½¿ Python ç¤¾åŒºå¼€å‘äº† scverse ç”Ÿæ€ç³»ç»Ÿã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">scverseï¼šæ˜¯ä¸€ä¸ªç»„ç»‡ä»¥åŠç”Ÿæ€ç³»ç»Ÿï¼Œè‡´åŠ›äºä¸ºç”Ÿå‘½ç§‘å­¦æ„å»ºåŸºç¡€å·¥å…·ï¼Œæœ€åˆèšç„¦äºå•ç»†èƒæ•°æ®ã€‚å…¶ä¼˜åŠ¿åœ¨äºå¯æ‰©å±•æ€§å¼ºã€æ˜“äºæ‹“å±•ï¼Œå¹¶ä¸”ä¸ç°æœ‰çš„ Python æ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ å·¥å…·å…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ã€‚</span></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä½¿ç”¨AnnDataå­˜å‚¨æ•°æ®</span></span><span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç»è¿‡å¯¹é½å’ŒåŸºå› æ³¨é‡Šåï¼ŒåŸºå› ç»„æ•°æ®é€šå¸¸ä¼šæ€»ç»“ä¸ºç‰¹å¾çŸ©é˜µã€‚è¿™ä¸ªçŸ©é˜µçš„å½¢çŠ¶ä¸ºâ€œè§‚å¯Ÿæ•° x å˜é‡æ•°â€â€”â€”å¯¹äºå•ç»†èƒRNAæµ‹åºï¼Œè§‚å¯Ÿå¯¹åº”äºç»†èƒæ¡å½¢ç ï¼Œå˜é‡å¯¹åº”äºæ³¨é‡ŠåŸºå› ã€‚åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œè¯¥çŸ©é˜µçš„è§‚å¯Ÿå’Œå˜é‡ä¼šè¢«è®¡ç®—å¾—å‡ºçš„åº¦é‡ï¼ˆä¾‹å¦‚è´¨é‡æ§åˆ¶æŒ‡æ ‡æˆ–æ½œåœ¨ç©ºé—´åµŒå…¥ï¼‰ä»¥åŠå…ˆå‰çŸ¥è¯†ï¼ˆä¾‹å¦‚æ¥æºä¾›ä½“æˆ–æ›¿ä»£åŸºå› æ ‡è¯†ç¬¦ï¼‰è¿›è¡Œæ³¨é‡Šã€‚åœ¨scverseç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒAnnDataè¢«ç”¨æ¥å°†æ•°æ®çŸ©é˜µä¸è¿™äº›æ³¨é‡Šå…³è”èµ·æ¥ã€‚ä¸ºäº†å®ç°å¿«é€Ÿä¸”å†…å­˜é«˜æ•ˆçš„è½¬æ¢ï¼ŒAnnDataè¿˜æ”¯æŒç¨€ç–çŸ©é˜µå’Œéƒ¨åˆ†è¯»å–ã€‚è™½ç„¶AnnDataä¸Rç”Ÿæ€ç³»ç»Ÿä¸­çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚Bioconductorçš„SummarizedExperimentæˆ–Seuratçš„å¯¹è±¡ï¼‰å¤§ä½“ç›¸ä¼¼ï¼Œä½†RåŒ…ä½¿ç”¨çš„æ˜¯è½¬ç½®çš„ç‰¹å¾çŸ©é˜µã€‚ åœ¨å…¶æ ¸å¿ƒï¼ŒAnnDataå¯¹è±¡åœ¨Xä¸­å­˜å‚¨ä¸€ä¸ªç¨€ç–æˆ–å¯†é›†çŸ©é˜µï¼ˆåœ¨scRNA-seqçš„æƒ…å†µä¸‹ä¸ºè®¡æ•°çŸ©é˜µï¼‰ã€‚è¿™ä¸ªçŸ©é˜µçš„ç»´åº¦ä¸ºobs_names x var_namesï¼Œå…¶ä¸­obsï¼ˆè§‚å¯Ÿï¼‰å¯¹åº”äºç»†èƒçš„æ¡å½¢ç ï¼Œvarï¼ˆå˜é‡ï¼‰å¯¹åº”äºåŸºå› æ ‡è¯†ç¬¦ã€‚çŸ©é˜µXå‘¨å›´æ˜¯Pandas DataFrame obså’Œvarï¼Œåˆ†åˆ«ä¿å­˜ç»†èƒå’ŒåŸºå› çš„æ³¨é‡Šã€‚æ­¤å¤–ï¼ŒAnnDataè¿˜ä¿å­˜è§‚å¯Ÿï¼ˆobsmï¼‰æˆ–å˜é‡ï¼ˆvarmï¼‰çš„æ•´ä¸ªè®¡ç®—çŸ©é˜µï¼Œå…·æœ‰ç›¸åº”çš„ç»´åº¦ã€‚å°†ç»†èƒä¸ç»†èƒæˆ–åŸºå› ä¸åŸºå› å…³è”çš„å›¾å½¢ç»“æ„é€šå¸¸ä¿å­˜åœ¨obspå’Œvarpä¸­ã€‚ä»»ä½•å…¶ä»–ä¸é€‚åˆå…¶ä»–æ§½çš„æ•°æ®å°†ä½œä¸ºéç»“æ„åŒ–æ•°æ®ä¿å­˜åœ¨unsä¸­ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥åœ¨layersä¸­å­˜å‚¨Xçš„æ›´å¤šå€¼ã€‚ä½¿ç”¨åœºæ™¯ä¾‹å¦‚åœ¨countså±‚ä¸­å­˜å‚¨åŸå§‹çš„ã€æœªå½’ä¸€åŒ–çš„è®¡æ•°æ•°æ®ï¼Œè€Œåœ¨æœªå‘½åçš„é»˜è®¤å±‚ä¸­å­˜å‚¨å½’ä¸€åŒ–çš„æ•°æ®ã€‚ AnnDataä¸»è¦è®¾è®¡ç”¨äºå•æ¨¡æ€ï¼ˆä¾‹å¦‚ä»…ä¸ºscRNA-seqï¼‰æ•°æ®ã€‚</span></p><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">1.å¯¼å…¥</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">import numpy as np</span><span leaf=""><br></span><span leaf="">import pandas as pd</span><span leaf=""><br></span><span leaf="">import anndata as ad</span><span leaf=""><br></span><span leaf="">from scipy.sparse import csr_matrix</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">2.åˆå§‹åŒ–ä¸€ä¸ªAnnDataå¯¹è±¡</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">counts = csr_matrix(np.random.poisson(</span><span><span leaf="">1</span></span><span leaf="">, size=(</span><span><span leaf="">100</span></span><span leaf="">,Â </span><span><span leaf="">2000</span></span><span leaf="">)), dtype=np.float32)</span><span leaf=""><br></span><span leaf="">adata = ad.AnnData(counts)</span><span leaf=""><br></span><span leaf="">adata</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">3.æŸ¥çœ‹adata.X</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata.X</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">4.åˆ›å»ºobså’Œvarçš„åç§°</span></span><span></span></h5><ol><li><section><span leaf="">adata.obs_names = [f"Cell_{i:d}" for i in range(adata.n_obs)]ï¼šè¿™è¡Œä»£ç ä¸ºadataå¯¹è±¡çš„æ¯ä¸ªè§‚æµ‹ï¼ˆå³æ¯ä¸ªç»†èƒï¼‰åˆ›å»ºä¸€ä¸ªåç§°ã€‚ä»0åˆ°adata.n_obs-1ï¼Œç»™æ¯ä¸ªç»†èƒå‘½åä¸ºCell_0ã€Cell_1ã€...ã€Cell_99ã€‚</span></section></li><li><section><span leaf="">adata.var_names = [f"Gene_{i:d}" for i in range(adata.n_vars)]ï¼šè¿™è¡Œä»£ç ä¸ºadataå¯¹è±¡çš„æ¯ä¸ªå˜é‡ï¼ˆå³æ¯ä¸ªåŸºå› ï¼‰åˆ›å»ºä¸€ä¸ªåç§°ã€‚ä»0åˆ°adata.n_vars-1ï¼Œç»™æ¯ä¸ªåŸºå› å‘½åä¸ºGene_0ã€Gene_1ã€...ã€Gene_1999ã€‚</span></section></li><li><section><span leaf="">print(adata.obs_names[:10])ï¼šè¿™è¡Œä»£ç æ‰“å°å‡ºadataå¯¹è±¡å‰10ä¸ªè§‚æµ‹çš„åç§°ï¼Œä¹Ÿå°±æ˜¯Cell_0åˆ°Cell_9ã€‚</span></section></li></ol><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata.obs_names = [f</span><span><span leaf="">"Cell_{i:d}"</span></span><span leaf="">Â </span><span><span leaf="">for</span></span><span leaf="">Â iÂ </span><span><span leaf="">in</span></span><span leaf="">Â range(adata.n_obs)]</span><span leaf=""><br></span><span leaf="">adata.var_names = [f</span><span><span leaf="">"Gene_{i:d}"</span></span><span leaf="">Â </span><span><span leaf="">for</span></span><span leaf="">Â iÂ </span><span><span leaf="">in</span></span><span leaf="">Â range(adata.n_vars)]</span><span leaf=""><br></span><span leaf="">print(adata.obs_names[:</span><span><span leaf="">10</span></span><span leaf="">])</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">5.æ·»åŠ metadata</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯åˆ†åˆ«åœ¨è§‚æµ‹ï¼ˆæ ·æœ¬ï¼‰å’Œå˜é‡ï¼ˆç‰¹å¾ï¼‰å±‚é¢æ·»åŠ å…ƒæ•°æ®ã€‚è¦è®°ä½ï¼Œå°†è¿™äº›æ³¨é‡Šåˆ†åˆ«å­˜å‚¨åœ¨AnnDataå¯¹è±¡çš„.obså’Œ.varæ§½ä¸­ï¼Œ.obsç”¨äºç»†èƒæ³¨é‡Šï¼Œè€Œ.varç”¨äºåŸºå› æ³¨é‡Šã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ct = np.random.choice([</span><span><span leaf="">"B"</span></span><span leaf="">,Â </span><span><span leaf="">"T"</span></span><span leaf="">,Â </span><span><span leaf="">"Monocyte"</span></span><span leaf="">], size=(adata.n_obs,))</span><span leaf=""><br></span><span leaf="">adata.obs[</span><span><span leaf="">"cell_type"</span></span><span leaf="">] = pd.Categorical(ct) Â </span><span><span leaf=""># Categoricals are preferred for efficiency</span></span><span leaf=""><br></span><span leaf="">adata.obs</span><span leaf=""><br></span></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU06NrA5USDqmJfxHQD2MOYI12h1Ij8aRxapA0dRUHgZcQ5CzqBG1HbmA/640?wx_fmt=other&amp;from=appmsg" data-ratio="2.4901960784313726" data-type="other" data-w="153" data-imgfileid="100005034" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU06NrA5USDqmJfxHQD2MOYI12h1Ij8aRxapA0dRUHgZcQ5CzqBG1HbmA/640?wx_fmt=other&amp;from=appmsg"></span></figure><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">6.å–å­é›†</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™ä¸ªå–å­é›†æ–¹å¼å°±æœ‰ç‚¹Rè¯­è¨€çš„æ„Ÿè§‰</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">bdata = adata[adata.obs.cell_type ==Â </span><span><span leaf="">"B"</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">bdata</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">7.è§‚æµ‹/å˜é‡-ç­‰çº§çŸ©é˜µ</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨æ¯ä¸ªå±‚çº§ä¸Šéƒ½æœ‰å¤šç»´çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚æ•°æ®çš„UMAPåµŒå…¥ã€‚å¯¹äºè¿™ç§ç±»å‹çš„å…ƒæ•°æ®ï¼ŒAnnDataå…·æœ‰</span><code><span leaf="">.obsm/.varm</span></code><span leaf="">å±æ€§ã€‚æˆ‘ä»¬ä½¿ç”¨é”®æ¥è¯†åˆ«æ’å…¥çš„ä¸åŒçŸ©é˜µã€‚</span><code><span leaf="">.obsm/.varm</span></code><span leaf="">çš„é™åˆ¶æ˜¯ï¼Œ</span><code><span leaf="">.obsm</span></code><span leaf="">çŸ©é˜µçš„é•¿åº¦å¿…é¡»ç­‰äºè§‚æµ‹å€¼çš„æ•°é‡ï¼ˆ</span><code><span leaf="">.n_obs</span></code><span leaf="">ï¼‰ï¼Œè€Œ</span><code><span leaf="">.varm</span></code><span leaf="">çŸ©é˜µçš„é•¿åº¦å¿…é¡»ç­‰äºå˜é‡çš„æ•°é‡ï¼ˆ</span><code><span leaf="">.n_vars</span></code><span leaf="">ï¼‰ã€‚å®ƒä»¬å„è‡ªå¯ä»¥ç‹¬ç«‹å…·æœ‰ä¸åŒçš„ç»´åº¦æ•°é‡ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata.obsm[</span><span><span leaf="">"X_umap"</span></span><span leaf="">] = np.random.normal(</span><span><span leaf="">0</span></span><span leaf="">,Â </span><span><span leaf="">1</span></span><span leaf="">, size=(adata.n_obs,Â </span><span><span leaf="">2</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">adata.varm[</span><span><span leaf="">"gene_stuff"</span></span><span leaf="">] = np.random.normal(</span><span><span leaf="">0</span></span><span leaf="">,Â </span><span><span leaf="">1</span></span><span leaf="">, size=(adata.n_vars,Â </span><span><span leaf="">5</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">adata.obsm</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">8.éç»“æ„åŒ–å…ƒæ•°æ®</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">AnnData å…·æœ‰Â </span><em><span leaf="">uns</span></em><span leaf="">Â å±æ€§ï¼Œå®ƒå…è®¸å­˜å‚¨ä»»ä½•éç»“æ„åŒ–çš„å…ƒæ•°æ®ã€‚è¿™å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œä¾‹å¦‚ä¸€ä¸ªåˆ—è¡¨æˆ–ä¸€ä¸ªåŒ…å«ä¸€äº›å¯¹æˆ‘ä»¬æ•°æ®åˆ†ææœ‰ç”¨çš„é€šç”¨ä¿¡æ¯çš„å­—å…¸ã€‚è¯·å°½é‡åªä½¿ç”¨è¿™ä¸ªå±æ€§æ¥å­˜å‚¨ä¸èƒ½æœ‰æ•ˆä¿å­˜åœ¨å…¶ä»–å±æ€§ä¸­çš„æ•°æ®ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata.uns[</span><span><span leaf="">"random"</span></span><span leaf="">] = [</span><span><span leaf="">1</span></span><span leaf="">,Â </span><span><span leaf="">2</span></span><span leaf="">,Â </span><span><span leaf="">3</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">adata.uns</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#OverloadedDict, wrapping:</span></span><span leaf=""><br></span><span><span leaf=""># OrderedDict([('random', [1, 2, 3])])</span></span><span leaf=""><br></span><span><span leaf="">#With overloaded keys:</span></span><span leaf=""><br></span><span><span leaf=""># ['neighbors'].</span></span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">9.Layers</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨ AnnData ä¸­ä½¿ç”¨ layers æ˜¯ä¸ºäº†ä¾¿äºå­˜å‚¨å’Œç®¡ç†åŒä¸€æ•°æ®é›†çš„å¤šä¸ªæ•°æ®è¡¨ç¤ºæˆ–å˜æ¢ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata.layers[</span><span><span leaf="">"log_transformed"</span></span><span leaf="">] = np.log1p(adata.X)</span><span leaf=""><br></span><span leaf="">adata</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">10.å¦ä¸€ç§åˆ›å»ºmetadataçš„æ–¹å¼</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">obs_meta = pd.DataFrame(</span><span leaf=""><br></span><span leaf="">Â  Â  {</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"time_yr"</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">0</span></span><span leaf="">,Â </span><span><span leaf="">2</span></span><span leaf="">,Â </span><span><span leaf="">4</span></span><span leaf="">,Â </span><span><span leaf="">8</span></span><span leaf="">], adata.n_obs),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"subject_id"</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">"subject 1"</span></span><span leaf="">,Â </span><span><span leaf="">"subject 2"</span></span><span leaf="">,Â </span><span><span leaf="">"subject 4"</span></span><span leaf="">,Â </span><span><span leaf="">"subject 8"</span></span><span leaf="">], adata.n_obs),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"instrument_type"</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">"type a"</span></span><span leaf="">,Â </span><span><span leaf="">"type b"</span></span><span leaf="">], adata.n_obs),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"site"</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">"site x"</span></span><span leaf="">,Â </span><span><span leaf="">"site y"</span></span><span leaf="">], adata.n_obs),</span><span leaf=""><br></span><span leaf="">Â  Â  },</span><span leaf=""><br></span><span leaf="">Â  Â  index=adata.obs.index, Â </span><span><span leaf=""># these are the same IDs of observations as above!</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata = ad.AnnData(adata.X, obs=obs_meta, var=adata.var)</span><span leaf=""><br></span><span leaf="">adata</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">11.æå–æ•°æ®çš„æ–¹å¼</span></span><span></span></h5><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¯¹ AnnData è¿›è¡Œç´¢å¼•æ—¶ï¼Œæ•´æ•°å‚æ•° [] çš„è¡Œä¸ºå°†ç±»ä¼¼äº pandas çš„ .ilocï¼Œè€Œå­—ç¬¦ä¸²å‚æ•°çš„è¡Œä¸ºåˆ™ç±»ä¼¼äº .locã€‚AnnData å§‹ç»ˆå‡è®¾ä½¿ç”¨å­—ç¬¦ä¸²ç´¢å¼•</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata_view = adata[:</span><span><span leaf="">5</span></span><span leaf="">, [</span><span><span leaf="">"Gene_1"</span></span><span leaf="">,Â </span><span><span leaf="">"Gene_3"</span></span><span leaf="">]]</span><span leaf=""><br></span><span leaf="">adata_view</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">print(adata[:</span><span><span leaf="">3</span></span><span leaf="">,Â </span><span><span leaf="">"Gene_1"</span></span><span leaf="">].X.toarray().tolist())</span><span leaf=""><br></span><span leaf="">adata[:</span><span><span leaf="">3</span></span><span leaf="">,Â </span><span><span leaf="">"Gene_1"</span></span><span leaf="">].X = [</span><span><span leaf="">0</span></span><span leaf="">,Â </span><span><span leaf="">0</span></span><span leaf="">,Â </span><span><span leaf="">0</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">print(adata[:</span><span><span leaf="">3</span></span><span leaf="">,Â </span><span><span leaf="">"Gene_1"</span></span><span leaf="">].X.toarray().tolist())</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># [[0.0], [2.0], [1.0]]</span></span><span leaf=""><br></span><span><span leaf=""># [[0.0], [0.0], [0.0]]</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata_subset = adata[:</span><span><span leaf="">3</span></span><span leaf="">, [</span><span><span leaf="">"Gene_1"</span></span><span leaf="">,Â </span><span><span leaf="">"Gene_2"</span></span><span leaf="">]]</span><span leaf=""><br></span><span leaf="">adata_subset</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># å¢åŠ ä¸€åˆ—foo ,é‡Œé¢å«æœ‰æ•°å­—1ï¼š3</span></span><span leaf=""><br></span><span leaf="">adata_subset.obs[</span><span><span leaf="">"foo"</span></span><span leaf="">] = range(</span><span><span leaf="">3</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata[adata.obs.time_yr.isin([</span><span><span leaf="">2</span></span><span leaf="">,Â </span><span><span leaf="">4</span></span><span leaf="">])].obs.head()</span><span leaf=""><br></span></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100005033" data-ratio="0.4908616187989556" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU0mppNJiamuXNr2DJpgiasGG3vx6WYRy1PS0JFwpuRRZj8XDdqTrJ61VwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="383" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyHAYfZ09Xo2tzOrSPYJnTU0mppNJiamuXNr2DJpgiasGG3vx6WYRy1PS0JFwpuRRZj8XDdqTrJ61VwA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å‚è€ƒèµ„æ–™ï¼š</span></span><span></span></h4><ol><li><section><span leaf="">single-cell-best-practices-zh githubï¼šhttps://github.com/master-XS/single-cell-best-practices-zh/tree/development/jupyter-book/introduction</span></section></li></ol></section><p><span leaf=""><br></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æ³¨</span></strong><span leaf="">ï¼šè‹¥å¯¹å†…å®¹æœ‰ç–‘æƒ‘æˆ–è€…æœ‰å‘ç°æ˜ç¡®é”™è¯¯çš„æœ‹å‹ï¼Œè¯·è”ç³»åå°ã€‚æ›´å¤šç›¸å…³å†…å®¹å¯å…³æ³¨å…¬ä¼—å·ï¼š</span><strong><span leaf="">ç”Ÿä¿¡æ–¹èˆŸ</span></strong><span leaf="">Â ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span></span><span><span leaf="">ç»“å°¾</span></span><span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¬¢è¿åŠ å…¥"</span><strong><span leaf="">ç”Ÿä¿¡&amp;ä¸´åºŠ</span></strong><span leaf="">â€œäº¤æµç¾¤ï¼Œè‹¥æœ‰æ„å‘è¿›ç¾¤çš„å°ä¼™ä¼´è¯·åŠ å¾®ä¿¡ï¼š</span><strong><span leaf="">couqiliugeziba321</span></strong><span leaf="">ï¼Œè¯·æ³¨æ˜â€œ</span><strong><span leaf="">å•ä½æˆ–å­¦æ ¡-ä¸“ä¸šæˆ–æ–¹å‘-å§“åæˆ–æ˜µç§°</span></strong><span leaf="">â€ã€‚å¸Œæœ›è¿›ç¾¤çš„ä½ æ”¶è·çŸ¥è¯†çš„åŒæ—¶ä¹Ÿèƒ½å¤Ÿæ”¶è·å¿«ä¹~ ğŸ¤—<img data-imgfileid="100004857" data-ratio="0.5625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="720" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg"></span></p></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p></section></section><section><span><span leaf="">- END -</span></span></section><p><span leaf=""><br></span></p><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4bWJ9DUrqA38eYmQpy3Q-Q",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
