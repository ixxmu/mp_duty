---
title: "CNV究竟是细胞的福音还是噩梦？单细胞转录组数据到底有多复杂？今天，用 infercnv包为你答疑解惑！"
date: 2025-08-05T08:18:43Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
CNV究竟是细胞的福音还是噩梦？单细胞转录组数据到底有多复杂？今天，用 infercnv包为你答疑解惑！ by R语言学徒
------
<div><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.2222222222222222" data-s="300,640" data-type="jpeg" data-w="900" type="block" data-imgfileid="100012638" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section><span><span leaf="">同学们，今天师妹要向大家介绍一个超级重要的工具！它就是转录组学研究中的“神器”——infercnv包！infercnv包可是转录组学中专门帮我们进行细胞类型推断和拷贝数变异（CNV）分析的必备工具。首先什么是拷贝数变异（CNV）呢？就让师妹来告诉你吧，CNV指的是基因组中较大片段DNA的拷贝数变化，它可能与疾病的发生和发展相关。通过分析单细胞RNA-seq数据，infercnv能够检测细胞间的CNV变异，帮助我们识别基因组结构的差异，这对于研究细胞类型、揭示疾病机制和探索个体差异具有重要意义。</span></span></section><section><span><span><span leaf="">在本次课程中，我们将逐步学习如何安装和使用infercnv包进行细胞类型推断和CNV分析，并探讨其在转录组学研究中的应用。通过实际的示例和演示，同学们将了解如何准备数据、运行分析，并理解细胞类型推断和CNV分析对转录组学研究的重要性。</span></span><span><span leaf="">相信我，通过今天的分享，同学们都能成为使用infercnv包的高手！接下来，就让我们正式开启对infercnv包的学习之旅，共同探索转录组学研究的新前沿吧！</span></span><span leaf="">    </span></span><span><span leaf="">        </span></span><p><span leaf=""> </span></p></section><section><span><p></p></span></section><section><span><span leaf="">本次介绍的R包需要较多的硬件资源，在服务器可以更加流畅运行，同学们如果没有自己的服务器欢迎联系我们使用服务器租赁~此外师妹还提供生信分析，思路设计，文献复现等，有需要的小伙伴欢迎来撩~</span></span></section><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="194" data-imgfileid="100011261" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><section><p><span><strong><span leaf="">定制生信分析</span></strong></span></p><p><span><strong><span leaf="">生信云服务器</span></strong></span></p></section></section></section></section></section></section></section><section><span><p></p></span></section><section><span><span leaf="">infercnv包介绍</span></span></section><section><span><span leaf="">infercnv是一个用于单细胞转录组数据分析的R包，主要提供细胞类型推断和拷贝数变异（CNV）分析功能。CNV是指基因组中较大片段DNA的拷贝数变化，可能与疾病发生和发展相关。infercnv通过分析单细胞RNA-seq数据，可以检测细胞间的CNV变异，帮助识别基因组结构差异。这对于研究细胞类型、疾病机制和个体差异具有重要意义，有助于揭示基因组变异对细胞功能和表型的影响。通过infercnv包，用户可以深入探究单细胞数据中的CNV情况，为理解细胞间差异提供有力支持。</span></span><span><span leaf="">  </span></span><p><span leaf=""> </span></p></section><section><span><p></p></span></section><section><span><span leaf="">infercnv包及其扩展安装</span></span></section><section><span><span leaf="">infercnv包安装</span></span></section><section><span><span leaf="">需要R语言版本为4.3，在控制台中输入以下命令：</span></span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>if</span><span> </span>(!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))</span></code><code><span leaf="">    install.<span>packages</span>(<span>"BiocManager "</span>)    </span></code><code><span leaf=""><span>BiocManager</span>::<span>install</span>(<span>"infercnv"</span>) <span># 在BiocManager环境下安装infercnv</span></span></code></pre></section><section><span></span></section><section><span><span leaf="">infercnv所需要的依赖包较多，请同学们安装时，耐心等待。</span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QXKgTvZQhziacsQictw0jiauM6usZRXsus0jaKLJGFRH2CmHBDebmcdPqw/640?wx_fmt=png" data-ratio="0.17314814814814813" data-type="png" data-w="1080" height="96.1300048828125" width="553.739990234375" data-imgfileid="100018024" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QXKgTvZQhziacsQictw0jiauM6usZRXsus0jaKLJGFRH2CmHBDebmcdPqw/640?wx_fmt=png"></span></span></section><section><span><span leaf="">查看是否安装成功</span></span></section><section><ul><li></ul><pre data-lang="bash"><code><span leaf="">packageVersion(<span>"infercnv"</span>) <span># 查看infercnv版本</span></span></code></pre></section><section><span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QeiaXLRdUR2wCT2icPhV28G3IicSrfFgl0DSzwoJ3sJY3Yb1BZOczRLAdA/640?wx_fmt=png" data-ratio="0.14723320158102768" data-type="png" data-w="1012" height="81.52999877929688" width="553.739990234375" data-imgfileid="100018022" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QeiaXLRdUR2wCT2icPhV28G3IicSrfFgl0DSzwoJ3sJY3Yb1BZOczRLAdA/640?wx_fmt=png"></span></span></section><section><span><span leaf="">显示为1.18.1版本，则表示已经安装了infercnv包。</span></span></section><section><span><span leaf="">扩展安装：</span></span></section><section><span><span><span leaf="">如果同学们想使用热图对结果可视化，需要在安装软件包 tibble、tsvio 和 NGCHMR 后再安装扩展包 R inferCNV_NGCHM。若要安装扩展包，请在 R 命令窗口中键入以下命令：</span></span><span></span></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="ruby"><code><span leaf="">install.packages(<span>"tibble"</span>) <span># 安装tibble包</span></span></code><code><span leaf="">install.packages(<span>"devtools"</span>) <span># 安装devtools包</span></span></code><code><span leaf="">devtools::install_github(<span>"bmbroom/tsvio"</span>) <span># 安装tsvio</span></span></code><code><span leaf="">devtools::install_github(<span>"bmbroom/NGCHMR"</span>, ref=<span>"stable"</span>) <span># 安装 NGCHMR</span></span></code><code><span leaf="">devtools::install_github(<span>"broadinstitute/inferCNV_NGCHM"</span>) <span>#安装inferCNV_NGCHM</span></span></code></pre></section><section><span></span></section><section><span><span><span leaf="">所需要安装时间较长，希望同学们耐心等待。</span></span><span leaf="">    </span></span><page></page></section><section><span></span></section><section><span><span leaf="">infercnv包使用示例</span></span></section><section><span><span leaf="">数据准备：</span></span></section><section><span><span leaf="">读取原始计数矩阵和元数据，填充 infercnv 对象</span></span></section><section><span><span></span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span leaf="">library(infercnv) <span># 载入infercnv包</span></span></code><code><span leaf="">setwd(<span>"/R-4.3.3/library/infercnv/extdata"</span>) <span># 需要更换为自己R的安装位置</span></span></code><code><span leaf="">infercnv_obj &lt;- CreateInfercnvObject(</span></code><code><span leaf="">raw_counts_matrix = <span>"./oligodendroglioma_expression_downsampled.counts.matrix.gz"</span>, <span># 载入原始数据</span></span></code><code><span leaf="">annotations_file = <span>"./oligodendroglioma_annotations_downsampled.txt"</span>, <span># 载入注释文件</span></span></code><code><span leaf="">delim = <span>"\t"</span>,</span></code><code><span leaf="">gene_order_file = <span>"./gencode_downsampled.EXAMPLE_ONLY_DONT_REUSE.txt"</span>, <span># 载入基因目录文件</span></span></code><code><span leaf="">ref_group_names = c(<span>"Microglia/Macrophage"</span>, <span>"Oligodendrocytes (non-malignant)"</span>))</span></code><code><span leaf="">使用infercnv包进行基因拷贝突变数分析：</span></code><code><span leaf="">class(infercnv_obj) <span># 查看infercnv_obj对象类型</span></span></code></pre></section><section><span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QSUibA10B5fDjcmmkkDjv5XxQ1o5TqyibW2Pe0FwBYCXL5KU6LJDH9hfg/640?wx_fmt=png" data-ratio="0.1478029294274301" data-type="png" data-w="751" height="81.8699951171875" width="553.739990234375" data-imgfileid="100018026" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QSUibA10B5fDjcmmkkDjv5XxQ1o5TqyibW2Pe0FwBYCXL5KU6LJDH9hfg/640?wx_fmt=png"></span></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span leaf="">out_dir = getwd()</span></code><code><span leaf="">infercnv_obj_default = infercnv::run(</span></code><code><span leaf="">    infercnv_obj,  <span># 使用之前创建的infercnv对象infercnv_obj作为输入</span></span></code><code><span leaf="">    cutoff=1,  <span># 设置用于过滤细胞的表达量阈值，cutoff=1适用于Smart-seq2数据，cutoff=0.1适用于10x Genomics数据</span></span></code><code><span leaf="">    out_dir=out_dir,  <span># 指定输出结果的文件夹路径，out_dir是您之前定义的输出目录变量</span></span></code><code><span leaf="">    cluster_by_groups=TRUE,  <span># 根据指定的参考组进行细胞群集分析</span></span></code><code><span leaf="">    plot_steps=FALSE,  <span># 是否绘制分析步骤的图表，设置为FALSE表示不绘制</span></span></code><code><span leaf="">    denoise=TRUE,  <span># 是否对数据进行去噪处理，设置为TRUE表示进行去噪</span></span></code><code><span leaf="">    HMM=FALSE,  <span># 是否使用隐马尔可夫模型（Hidden Markov Model）进行分析，设置为FALSE表示不使用</span></span></code><code><span leaf="">    no_prelim_plot=TRUE,  <span># 是否绘制预处理后的细胞图谱，设置为TRUE表示不绘制</span></span></code><code><span leaf="">    png_res=60<span># 设置输出PNG图像的分辨率为60dpi    </span></span></code><code><span leaf="">)</span></code></pre></section><section><span></span></section><section><span><span leaf="">代码运行需要较长时间，最后运行结束如图所示：</span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QSQ01trA2wykqMOlWKb4MO0sK8fNSY9iaAianuZhK2orj2vxfrVMfZ4HA/640?wx_fmt=png" data-ratio="0.20092592592592592" data-type="png" data-w="1080" height="111.0" width="553.739990234375" data-imgfileid="100018025" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QSQ01trA2wykqMOlWKb4MO0sK8fNSY9iaAianuZhK2orj2vxfrVMfZ4HA/640?wx_fmt=png"></span></span></section><section><span><span leaf="">此时，本次分析的结果会输出到我们的工作目录，可以使用getwd()命令查看工作目录所在位置，打开工作目录，会看到两张图片的输出结果，如下图：</span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3Qp7PJbECoiaiaorlpvrTz1pM06DKcBUE0vqIVpXWDsbCZwUh55gn9FbXg/640?wx_fmt=png" data-ratio="0.20833333333333334" data-type="png" data-w="1080" height="115.47003173828125" width="553.739990234375" data-imgfileid="100018027" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3Qp7PJbECoiaiaorlpvrTz1pM06DKcBUE0vqIVpXWDsbCZwUh55gn9FbXg/640?wx_fmt=png"></span></span></section><section><span><span><span leaf="">其中infercnv_subclusters.png图像更为清晰，显示如下图：</span></span><span leaf="">    </span></span><page></page></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QHZ5KFbugpzoHXfvQ13edUgRrib3y9b2fGibAJzcsJZJZlF33qD7IZ4Zg/640?wx_fmt=png" data-ratio="0.9462962962962963" data-type="png" data-w="1080" height="450.5099792480469" width="479.51995849609375" data-imgfileid="100018028" src="https://mmbiz.qpic.cn/sz_mmbiz_png/zcicibWZessAw1Y3OHHbdbv0YISSRgfb3QHZ5KFbugpzoHXfvQ13edUgRrib3y9b2fGibAJzcsJZJZlF33qD7IZ4Zg/640?wx_fmt=png"></span></span></section><section><span><span leaf="">由图可知，蓝色表示单细胞转录组对应位置RNA表达下调，红色表示单细胞转录组对应位置RNA表达上调，可以理解为基因拷贝数变异（CNV）。则可以看到示例细胞中，绝大多数在1号染色体前半部分区段和19号染色体的后半部分区段均出现了下调，部分细胞在7号染色体和11号染色体的部分区段出现了下调，其余部分没有较为明显的上调。</span></span></section><section><span><span leaf="">          </span><p><span leaf=""> </span></p></span></section><section><span><span><span leaf="">以上就是对infercnv包的全部介绍了，通过本次学习，我们深入了解了infercnv包在单细胞转录组数据分析中的重要作用。在使用infercnv包的过程中，我们不仅学会了如何安装和使用该包，还掌握了对单细胞数据进行基因拷贝数变异分析的具体步骤。通过对示例数据的分析，我们更进一步理解了细胞间的CNV变异情况，并通过可视化结果直观地展示了分析的成果。sm 希望同学们能够充分利用infercnv包这一强大工具，探索更多有关单细胞转录组数据的奥秘，为生物学研究做出更大的贡献。让我们携手并进，共同探索科学的无限可能，为人类健康和生命科学的发展贡献自己的力量！</span></span></span></section><p><span leaf=""><br></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p><span leaf="">E</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">N</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">D</span></p></section></section><section><section powered-by="xiumi.us"><section><span leaf=""><br></span></section></section></section></section></section><p><span leaf=""><br></span></p><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="219" data-cropsely1="0" data-cropsely2="219" data-imgfileid="100013742" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><p><span leaf="">定制生信分析</span></p><p><span leaf="">课题思路设计</span></p><p><span leaf="">生信云服务器</span></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3073838745411518465#wechat_redirect" textvalue="生信实操" linktype="text" data-linktype="2">生信分析实操</a></span></p></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3113598048028459016#wechat_redirect" textvalue="生信文章思路" linktype="text" data-linktype="2">生信文章思路</a></span></p></section></section></section></section></section></section></section></section><section><span></span><page></page></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9TJdFevgnZAY12miZZaZWw",target="_blank" rel="noopener noreferrer">原文链接</a>
