---
title: "GEO数据库提供的count矩阵中带有小数是为什么？"
date: 2025-02-28T23:45:36Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
GEO数据库提供的count矩阵中带有小数是为什么？ by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span>我们生信马拉松授课群里面有个学员发了一个GSE数据集，问：</span></p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054863" data-ratio="0.158004158004158" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaicWMHYicPlS4W84gm5dluNemPBfic01vv6gVoRMcKyZobo4Pd4icibgsvRw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="481" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaicWMHYicPlS4W84gm5dluNemPBfic01vv6gVoRMcKyZobo4Pd4icibgsvRw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">来看看吧~</p><h2 data-tool="mdnice编辑器"><span></span><span>数据背景</span><span></span></h2><p data-tool="mdnice编辑器">数据编号为 GSE230214，链接：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE230214，总共有32个样本：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054862" data-ratio="0.9848024316109423" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaj5LFBa83NUWua7QW77gia8oIPzQzF5qn5qjluydEPZYd6Yiao1rsUqOA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="658" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaj5LFBa83NUWua7QW77gia8oIPzQzF5qn5qjluydEPZYd6Yiao1rsUqOA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">作者将原始count表达矩阵放在了附件：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054860" data-ratio="0.4449760765550239" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaibt1du5Y74AXA0sibyhVNK5zqgMYSGnUpasma1cBcA6EqyiaQg4ZoRpGg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="627" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaibt1du5Y74AXA0sibyhVNK5zqgMYSGnUpasma1cBcA6EqyiaQg4ZoRpGg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">我们下载下来看一下：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<span>#清空当前的工作环境</span><br>options(stringsAsFactors = F)<span>#不以因子变量读取</span><br>options(scipen = 20)<span>#不以科学计数法显示</span><br>library(data.table)<br>library(tinyarray)<br>library(stringr)<br>library(stringi)<br><br>acc &lt;- <span>"GSE230214"</span><br>data &lt;- data.table::fread(<span>"GSE230214_PBMC_counts.txt.gz"</span>, data.table = F)<br>data=data[!duplicated(data<span>$V1</span>),]<br>mat &lt;- data[,c( 2:ncol(data))]<br>rownames(mat)=data[,1]<br>mat[1:4,1:4]<br>range(mat)<br><br>keep_feature &lt;- rowSums (mat &gt; 1) &gt; 1 ;table(keep_feature)<br>ensembl_matrix &lt;- mat[keep_feature, ]  <br>rownames(ensembl_matrix)=rownames(mat)[keep_feature]<br>ensembl_matrix[1:4,1:4]<br></code></pre><p data-tool="mdnice编辑器">可以看到数据确实是存在小数的：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054859" data-ratio="0.2073170731707317" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriay8B6iaadNxqM9ibM0ks4rdR2Riav9DONiauyIrZ0FiaeGE4ICSDRFfFgm1g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="492" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriay8B6iaadNxqM9ibM0ks4rdR2Riav9DONiauyIrZ0FiaeGE4ICSDRFfFgm1g/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>追本溯源</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span></span><span>GSM样本方法处理描述</span><span></span></h3><p data-tool="mdnice编辑器">这个表达矩阵里面的值是如何来的，我们一般会选择一个GSM样本：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM7196518，点击进去看看数据的处理方式：</p><figure data-tool="mdnice编辑器"><img alt="image-20250218181551394" data-imgfileid="100054861" data-ratio="0.3384146341463415" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaxzqJl1ZnWfVFTMVHcOwico6babRBciccnz3ibyzuaAIzYlRxjV44CIZdA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="656" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaxzqJl1ZnWfVFTMVHcOwico6babRBciccnz3ibyzuaAIzYlRxjV44CIZdA/640?wx_fmt=png&amp;from=appmsg"><figcaption><br></figcaption></figure><p data-tool="mdnice编辑器">在 Data processing 这一行，数据处理如下：</p><blockquote data-tool="mdnice编辑器"><span></span><p>Quality control of RNA-seq data was performed using the pipeline RAPiD-nf. FastQCv.0.11.6, a final report was generated for each FASTQ file to assess general sequencing quality. Assembly: hg19 Supplementary files format and content: tab-delimited text files include rawcounts for each Sample</p></blockquote><p data-tool="mdnice编辑器"><span>但是这里并没有提供基因count是如何来的，没有答案~</span></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>我们再来看一下 文章中的描述：</span><span></span></h3><p data-tool="mdnice编辑器">这个数据发表的文章为：<strong>Amadori L, Calcagno C, Fernandez DM, Koplev S et al. Systems immunology-based drug repurposing framework to target inflammation in atherosclerosis. Nat Cardiovasc Res 2023 Jun;2(6):550-571. PMID: 37771373</strong></p><p data-tool="mdnice编辑器"><strong>找到方法部分</strong>：<strong>这里对于PBMC的数据采用的star比对、参考基因组为GRCh38，没有描述定量过程</strong>。</p><p data-tool="mdnice编辑器"><span>即使是 文章中其他的组织RNA-Seq分析过程，也是用的featureCounts定量，而featureCounts定量的结果一般为整数</span>。</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054868" data-ratio="0.5712962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaxxU1UFSFXV6dth3IZBlpWZ8KX4PO2XY118Gdnkv0jzKk7h9XXWliaog/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaxxU1UFSFXV6dth3IZBlpWZ8KX4PO2XY118Gdnkv0jzKk7h9XXWliaog/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>最终解决办法</span><span></span></h2><p data-tool="mdnice编辑器"><span>追溯到这里，这个GSE230214_PBMC_counts.txt.gz文件中的count值中的小数如何来的，已经无解，大概率是作者这里描述有误，没有描述清楚过程</span>，此外这个文章提供了分析代码在：https://github.com/giannarellilab/Systems-immunology-based-drug-repurposing-framework-totarget-inflammation-in-atherosclerosis。可以前往学习学一下。数据处理部分提到的 <code>the pipeline RAPiD-nf</code>也值得我们学习：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054865" data-ratio="0.5593419506462984" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaiaticdAhUVU9V4DIMbudQDcdn34gtfI7mM5jFXZOLmWBLFJJs0bHCUCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="851" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriaiaticdAhUVU9V4DIMbudQDcdn34gtfI7mM5jFXZOLmWBLFJJs0bHCUCA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><span>最终的解决办法是：下载这个数据的fq，自己去进行定量</span>：PRJNA957897</p><p data-tool="mdnice编辑器"><strong>如果你在学习过程中也遇到了上述类似问题，但迟迟找不到解决办法，可以看看我们下面的招生，为生信入门者保驾护航，我们提供无微不至的答疑~</strong></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>开课时间</span><span></span></h3><p data-tool="mdnice编辑器">接下来的直播互动授课开始时间<strong>是2025年3月3日， 晚上跟直播白天可以很方便的实践操作！</strong></p><p data-tool="mdnice编辑器">我们的课程每月滚动开班，在线直播互动授课，可以根据自己的时间安排就近报名，随时插班或者咨询下一期报名。</p><p data-tool="mdnice编辑器">我们的马拉松生信课程已经有了一年多线下全国巡讲、四年多线上互动授课的积累，有经验丰富的专业教学团队，已有数千名学员从培训班毕业，<strong>仅致谢我们的正式发表文章就有200+篇</strong>（文末有文章列表）！欢迎选择影响了无数生信学习者、桃李满天下的生信技能树。</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>报名咨询</span><span></span></h3><p data-tool="mdnice编辑器">如果你已经熟悉了我们的课程，就联系我们报名吧~（添加好友务必备注 高校或者工作单位+姓名+马拉松，方便后续认识）</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054866" data-ratio="0.9782608695652174" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriagyVptiatlGpmye3D2L5JUUQuyhbDLcRXym1Zs5SHOR0gYCVaayiasOpg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="920" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4ww50k2rIfyx7icQCGVXjZdriagyVptiatlGpmye3D2L5JUUQuyhbDLcRXym1Zs5SHOR0gYCVaayiasOpg/640?wx_fmt=other&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>更加详细的课程介绍：</span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><strong><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538467&amp;idx=1&amp;sn=aa5500b24a92b86355c242d02e742f1b&amp;token=1439264254&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">生信入门&amp;数据挖掘线上直播课3月班</a></strong></span></h4></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/xYTohrUT0_rg27DlJx6VaA",target="_blank" rel="noopener noreferrer">原文链接</a>
