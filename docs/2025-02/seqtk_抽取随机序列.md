---
title: "seqtk—抽取随机序列"
date: 2025-02-26T01:20:51Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
seqtk—抽取随机序列 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6">工欲善其事 必先利其器</strong></p></section></section></section></section></section></section></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">25年的新梗“干中学”相信大家都不陌生。诚然，在实践中学习是一种极为高效且充满活力的方式。当面对一项任务时，明确的需求如同一盏明灯，让我们能够有的放矢地投入精力。而每一次的尝试与探索，成就看得见的进步。这种“干中学”的过程，不仅让我们在实践中积累经验，更赋予了我们面对未知的勇气和解决问题的能力。今天我们就来学习一个具体的需求：从FastQ文件随机抽取一定数量的reads 。</p><h2 data-tool="mdnice编辑器"><span>FastQ文件</span></h2><p data-tool="mdnice编辑器">首选我们要了解fastq文件——FASTQ是基于文本的，保存生物序列（通常是核酸序列）和其测序质量信息的标准格式。其序列以及质量信息都是使用一个ASCII字符来表示，常用于高通量测序数据的存储。最初由Sanger开发，目的是将FASTA序列与质量数据放到一起，目前已经成为高通量测序结果的标准格式。</p><p data-tool="mdnice编辑器">FASTQ格式常以四部分组成：</p><ul data-tool="mdnice编辑器"><li><section>第一部分：以@开头紧接着是序列的标识符和可选择的描述信息。和fasta格式的第一行相似。</section></li><li><section>第二部分：是原始序列信息</section></li><li><section>第三部分：以+开始，后面可再接与第一部分相同的序列标识符或者描述信息。一般都只是一个+</section></li><li><section>第四部分：以ASCII字符表示第二行碱基序列的测序质量。</section></li></ul><figure data-tool="mdnice编辑器"><img alt="fastq文件示例" data-imgfileid="100048470" data-ratio="0.1712962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaJNiaSVQkibkWu466dy0DMLynA3DU8Rvjq5djfqjiaWWR5Mu6U9tp3DPcA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaJNiaSVQkibkWu466dy0DMLynA3DU8Rvjq5djfqjiaWWR5Mu6U9tp3DPcA/640?wx_fmt=png&amp;from=appmsg"><figcaption>fastq文件示例</figcaption></figure><p data-tool="mdnice编辑器">其次我可以查询一下哪有已有的工具可以实现，比如：seqtk</p><h2 data-tool="mdnice编辑器"><span>seqtk</span></h2><p data-tool="mdnice编辑器">seqtk 是一款轻量级且高效的生物信息学工具，专门用于处理 <strong>FASTA/Q 格式的序列文件</strong>（如测序数据）。它由 Heng Li（李恒，SAMtools、BWA 等工具的作者）开发，广泛应用于序列数据预处理、格式转换、随机抽样等场景。</p><h3 data-tool="mdnice编辑器"><span>如何安装</span></h3><p data-tool="mdnice编辑器">安装非常简单，从Github下载压缩包，解压，编译即可。当然也可以使用Conda安装。</p><pre data-tool="mdnice编辑器"><code><span>#</span><span>#编译安装</span><br>wget -c https://github.com/lh3/seqtk/archive/refs/tags/v1.4.tar.gz<br>tar -xf v1.4.tar.gz<br><br>cd seqtk-1.4/<br>make<br><span><br><br>#</span><span>#方法二：</span><br>conda activate RNAseq<br>conda install -y seqtk<br></code></pre><figure data-tool="mdnice编辑器"><img alt="安装" data-imgfileid="100048471" data-ratio="0.9787037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaibE1ozF0bQRAHFHIMbbrO8ceThib9ANBkAsTSsdxHtGRu6nqic8cOd3uA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaibE1ozF0bQRAHFHIMbbrO8ceThib9ANBkAsTSsdxHtGRu6nqic8cOd3uA/640?wx_fmt=png&amp;from=appmsg"><figcaption>安装</figcaption></figure><h3 data-tool="mdnice编辑器"><span>随机抽样</span></h3><pre data-tool="mdnice编辑器"><code><span><br>#</span><span> 随机抽取 10000 条 reads（设置随机种子 -s 避免重复）</span><br>seqtk sample -s 123 SRR23698412_1.fastq.gz 10000 &gt; SRR23698412_1_subset.fastq<br>seqtk sample -s 123 SRR23698412_2.fastq.gz 10000 &gt; SRR23698412_2_subset.fastq<br><br></code></pre><p data-tool="mdnice编辑器"><strong>注意</strong>：对双端文件（如 sample_1.fastq.gz 和 sample_2.fastq.gz）抽样时，需使用相同的随机种子（-s 参数），确保配对的 reads 被同步抽取。</p><figure data-tool="mdnice编辑器"><img alt="抽样示例" data-imgfileid="100048472" data-ratio="0.47962962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaFcHiawpCGGhF13Jc4oKYhcAdRRChnyjQTqh9IQ7OhcxWCKCQKsiatBBg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los86wKZvYu8wFn4RIkgMvkhaFcHiawpCGGhF13Jc4oKYhcAdRRChnyjQTqh9IQ7OhcxWCKCQKsiatBBg/640?wx_fmt=png&amp;from=appmsg"><figcaption>抽样示例</figcaption></figure><h3 data-tool="mdnice编辑器"><span>其余用法：</span></h3><h5 data-tool="mdnice编辑器"><span>FASTQ 转 FASTA</span></h5><p data-tool="mdnice编辑器">保留序列名称和质量值信息（可选）：</p><pre data-tool="mdnice编辑器"><code>seqtk seq -A input.fastq.gz &gt; output.fasta<br></code></pre><h5 data-tool="mdnice编辑器"><span>截取序列子区间</span></h5><p data-tool="mdnice编辑器">提取每条序列的第 10 到 100 个碱基：</p><pre data-tool="mdnice编辑器"><code>seqtk subseq input.fasta 10-100 &gt; output_sub.fasta<br></code></pre><h5 data-tool="mdnice编辑器"><span>过滤短序列</span></h5><p data-tool="mdnice编辑器">保留长度 ≥ 50 bp 的序列：</p><pre data-tool="mdnice编辑器"><code>seqtk seq -L 50 input.fastq.gz &gt; filtered.fastq<br></code></pre><h5 data-tool="mdnice编辑器"><span>合并双端数据</span></h5><p data-tool="mdnice编辑器">将双端 FASTQ 文件合并为交错格式（interleaved）：</p><pre data-tool="mdnice编辑器"><code>seqtk mergepe sample_1.fastq sample_2.fastq &gt; merged.fastq<br></code></pre></section><p><br></p><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section><section powered-by="xmyeditor.com" data-md5="8b46d"><img data-imgfileid="100048467" data-ratio="0.6940298507462687" data-type="gif" data-w="134" data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section></section></section></section></section></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538714&amp;idx=2&amp;sn=38f40dc5f0c33b125b12853368ea535a&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课3月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>生信入门&amp;数据挖掘线上直播课3月班</span></a><span>，你的生物信息学入门课</span></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a><br></section></li><li><p><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>满足你生信分析计算需求的低价解决方案</span></a><br></p></li><li><p><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538207&amp;idx=1&amp;sn=92833750b121a0b45e31f82092b9ac1a&amp;scene=21#wechat_redirect" textvalue="千呼万唤，让我们广州线下约起" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>千呼万唤，让我们广州线下约起</span></a></p></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vCMlECtwuN_2XxA9zpYZqA",target="_blank" rel="noopener noreferrer">原文链接</a>
