---
title: "单细胞cellranger定量：一个样本有多个run如何处理？（三）"
date: 2025-02-22T14:09:41Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
单细胞cellranger定量：一个样本有多个run如何处理？（三） by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span leaf="">本次实战学习的单细胞+空转分析的文献，于2022年1月发表在Cell Res杂志（IF=28.2）上，标题为：<span textstyle="">Identification of HSC/MPP expansion units in fetal liver by single-cell spatiotemporal transcriptomics</span>。上一期的文献背景介绍以及数据下载见：</span></p><ul><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247531730&amp;idx=1&amp;sn=dc9d59368935a3c3b8e16d4de9004283&amp;scene=21#wechat_redirect"><span leaf="">单细胞+空转分析之数据下载：胎肝中的造血干细胞/多能祖细胞（一）</span></a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528135&amp;idx=1&amp;sn=e059e5d90b64b5d63c65dabaa560257f&amp;scene=21#wechat_redirect"><span leaf="">单细胞+空转分析之空转spaceranger定量：胎肝中的造血干细胞/多能祖细胞（二）</span></a></section></li></ul><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">今天来学习实战：10x 单细胞转录组数据 的上游cell ranger定量！一个样本有多个run如何处理？</span></span><span><span leaf=""><br></span></span></h3><h2 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">1、单细胞数据整理</span></span><span><span leaf=""><br></span></span><span><span leaf=""> </span></span></h2><p data-tool="mdnice编辑器"><span leaf="">单细胞共四个样本，物种为小鼠</span></p><section data-tool="mdnice编辑器"><table><thead><tr><th><section><span leaf="">Project accession</span></section></th><th><section><span leaf="">Sample title</span></section></th><th><section><span leaf="">Organism</span></section></th><th><section><span leaf="">Breed</span></section></th><th><section><span leaf="">Strain</span></section></th><th><section><span leaf="">Age</span></section></th><th><section><span leaf="">Age unit</span></section></th></tr></thead><tbody><tr><td><section><span leaf="">PRJCA002426</span></section></td><td><section><span leaf="">E11.5 Fetal Liver</span></section></td><td><section><span leaf="">Mus musculus</span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf="">11.5</span></section></td><td><section><span leaf="">Day</span></section></td></tr><tr><td><section><span leaf="">PRJCA002426</span></section></td><td><section><span leaf="">E12.5 Fetal Liver</span></section></td><td><section><span leaf="">Mus musculus</span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf="">12.5</span></section></td><td><section><span leaf="">Day</span></section></td></tr><tr><td><section><span leaf="">PRJCA002426</span></section></td><td><section><span leaf="">E13.5 Fetal Liver</span></section></td><td><section><span leaf="">Mus musculus</span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf="">13.5</span></section></td><td><section><span leaf="">Day</span></section></td></tr><tr><td><section><span leaf="">PRJCA002426</span></section></td><td><section><span leaf="">E14.5 Fetal Liver</span></section></td><td><section><span leaf="">Mus musculus</span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf=""><br></span></section></td><td><section><span leaf="">14.5</span></section></td><td><section><span leaf="">Day</span></section></td></tr></tbody></table></section><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">1.1 fq重命名</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">定量所需要的fq格式标准如下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">sampleID_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">sampleID_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">fq与样本的对应关系如下：一个样本有多个run，需要放在同一个文件夹中</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibBRSTxGEeM5dibogs9hxJCdTcrYVLPZZXFW6LTNZ1PlpqLQPANmibSicug/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-imgfileid="100044565" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibBRSTxGEeM5dibogs9hxJCdTcrYVLPZZXFW6LTNZ1PlpqLQPANmibSicug/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">样本重命名：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 构建文件夹</span></span><span leaf=""><br></span><span leaf="">mkdir E11-5</span><span leaf=""><br></span><span leaf="">mkdir E12-5</span><span leaf=""><br></span><span leaf="">mkdir E13-5</span><span leaf=""><br></span><span leaf="">mkdir E14-5</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">偷懒，写了个下面这样笨重的脚本，哈哈哈哈哈...............（偷偷地感觉有点丢脸）</span></p><p data-tool="mdnice编辑器"><span leaf="">样本：E11.5 fetal liver</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 样本：E11.5 fetal liver</span></span><span leaf=""><br></span><span leaf="">mv CRR126262/* CRR126263/* CRR126264/* CRR126265/* E11-5/</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> E11-5/</span><span leaf=""><br></span><span leaf="">mv CRR126262_f1.fastq.gz E11-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126262_r2.fastq.gz E11-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126263_f1.fastq.gz E11-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126263_r2.fastq.gz E11-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126264_f1.fastq.gz E11-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126264_r2.fastq.gz E11-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126265_f1.fastq.gz E11-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126265_r2.fastq.gz E11-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">样本：E12.5 fetal liver</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 样本：E12.5 fetal liver</span></span><span leaf=""><br></span><span leaf="">mv CRR126266/* CRR126267/* CRR126268/* CRR126269/* CRR126270/* CRR126271/* CRR126272/* CRR126273/* E12-5/</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> E12-5/</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126266_f1.fastq.gz E12-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126266_r2.fastq.gz E12-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126267_f1.fastq.gz E12-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126267_r2.fastq.gz E12-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126268_f1.fastq.gz E12-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126268_r2.fastq.gz E12-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126269_f1.fastq.gz E12-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126269_r2.fastq.gz E12-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126270_f1.fastq.gz E12-5_S1_L005_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126270_r2.fastq.gz E12-5_S1_L005_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126271_f1.fastq.gz E12-5_S1_L006_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126271_r2.fastq.gz E12-5_S1_L006_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126272_f1.fastq.gz E12-5_S1_L007_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126272_r2.fastq.gz E12-5_S1_L007_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126273_f1.fastq.gz E12-5_S1_L008_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126273_r2.fastq.gz E12-5_S1_L008_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">样本：E13.5 fetal liver</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 样本：E13.5 fetal liver</span></span><span leaf=""><br></span><span leaf="">mv CRR126274/* CRR126275/* CRR126276/* CRR126277/* E13-5/</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> E13-5/</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126274_f1.fastq.gz E13-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126274_r2.fastq.gz E13-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126275_f1.fastq.gz E13-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126275_r2.fastq.gz E13-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126276_f1.fastq.gz E13-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126276_r2.fastq.gz E13-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126277_f1.fastq.gz E13-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126277_r2.fastq.gz E13-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">样本：E14.5 fetal liver</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 样本：E13.5 fetal liver</span></span><span leaf=""><br></span><span leaf="">mv CRR*/* E14-5/</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> E14-5/</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126278_f1.fastq.gz E14-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126278_r2.fastq.gz E14-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126279_f1.fastq.gz E14-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126279_r2.fastq.gz E14-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126280_f1.fastq.gz E14-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126280_r2.fastq.gz E14-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126281_f1.fastq.gz E14-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126281_r2.fastq.gz E14-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126282_f1.fastq.gz E14-5_S1_L005_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126282_r2.fastq.gz E14-5_S1_L005_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126283_f1.fastq.gz E14-5_S1_L006_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126283_r2.fastq.gz E14-5_S1_L006_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126284_f1.fastq.gz E14-5_S1_L007_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126284_r2.fastq.gz E14-5_S1_L007_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">mv CRR126285_f1.fastq.gz E14-5_S1_L008_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">mv CRR126285_r2.fastq.gz E14-5_S1_L008_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">1.2 处理好之后的数据结构：</span></span><span><span leaf=""><br></span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">E11-5</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E11-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">└── E11-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">E12-5</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L005_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L005_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L006_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L006_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L007_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L007_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E12-5_S1_L008_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">└── E12-5_S1_L008_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">E13-5</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E13-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">└── E13-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">E14-5</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L001_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L001_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L002_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L002_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L003_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L003_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L004_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L004_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L005_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L005_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L006_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L006_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L007_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L007_R2_001.fastq.gz</span><span leaf=""><br></span><span leaf="">├── E14-5_S1_L008_R1_001.fastq.gz</span><span leaf=""><br></span><span leaf="">└── E14-5_S1_L008_R2_001.fastq.gz</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibJGe5N0sIuvW6QA0e8Pz6thUYiconqGIFa9tI0uosWEqJxEtfJRDN1ww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-imgfileid="100044564" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibJGe5N0sIuvW6QA0e8Pz6thUYiconqGIFa9tI0uosWEqJxEtfJRDN1ww/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">2、配置环境：</span></span><span><span leaf=""><br></span></span><span><span leaf=""> </span></span></h2><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">2.1、安装 cell ranger</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">下载最新版本：Cell Ranger 9.0.1 (Feb 6, 2025)：https://www.10xgenomics.com/support/software/cell-ranger/downloads</span></p><p data-tool="mdnice编辑器"><span leaf="">安装命令指导：https://www.10xgenomics.com/support/software/cell-ranger/latest/tutorials/cr-tutorial-in</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/biosoft</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 下载</span></span><span leaf=""><br></span><span leaf="">wget -O cellranger-9.0.1.tar.gz </span><span><span leaf="">"https://cf.10xgenomics.com/releases/cell-exp/cellranger-9.0.1.tar.gz?Expires=1740207495&amp;Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&amp;Signature=UGfEoyQbyoSLrdFeW5jsoDysyzwUnpGca5q~A9GR9b709szhXcWYiXvSd09wvMx8-6fScXV59yPAUUqRCSz8HLF2rDnTAyN3s6JnFIUtkZ2vsmp1HItWuB30vMTBF8Ecx~8bPtkKrDvha~x5tt~wZOElfIF-OJgPZuvU5Og62wrnisKn9Ws7REAI2o9BuTmX2zqQfnIRUSgRhTCLHZw6rhKUNdavAN8TZlBJCU9Rbf9KqOKEU90XNSO3hLzxYf-AcKfDRa6PJp4i5NoS0hRpJ2SUsW8QOfgVbDNTb05Wybeo0vlPCxw0pIpVaY~9Pt8Y7KSizXHFZVJ6yK43IPayww__"</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 解压</span></span><span leaf=""><br></span><span leaf="">tar -zxvf cellranger-9.0.1.tar.gz</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 可以直接绝对路径使用</span></span><span leaf=""><br></span><span leaf="">/nas1/zhangj/biosoft/cellranger-9.0.1/cellranger -h</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">帮助文档如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibWk28eia9mZjTApicGfCe28aMS40W85BpYI08kCRDGs24ldsraj1Xrrbw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-imgfileid="100044566" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRibD02u6bdG5DaJpL8WpB3ibWk28eia9mZjTApicGfCe28aMS40W85BpYI08kCRDGs24ldsraj1Xrrbw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">2.2、参考基因组下载</span></span><span><span leaf=""><br></span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">mkdir /nas1/zhangj/database/Cell_Ranger</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/database/Cell_Ranger</span><span leaf=""><br></span><span><span leaf=""># 下载</span></span><span leaf=""><br></span><span leaf="">wget -c </span><span><span leaf="">"https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCm39-2024-A.tar.gz"</span></span><span leaf=""><br></span><span leaf="">tar -zxvf refdata-gex-GRCm39-2024-A.tar.gz</span><span leaf=""><br></span></code></pre><h2 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">3、cell ranger定量</span></span><span><span leaf=""><br></span></span><span><span leaf=""> </span></span></h2><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">3.1 参数含义</span></span><span><span leaf=""><br></span></span></h3><ul><li><section><code><span leaf="">--id</span></code><span leaf="">：输出目录</span></section></li><li><section><code><span leaf="">--transcriptome</span></code><span leaf="">：输入参考基因组</span></section></li><li><section><code><span leaf="">--fastqs</span></code><span leaf="">：输入的fq数据文件夹</span></section></li><li><section><code><span leaf="">--sample</span></code><span leaf="">：样本的名字，与fq保持一致</span></section></li><li><section><code><span leaf="">--localcores</span></code><span leaf="">：线程数</span></section></li><li><section><code><span leaf="">--localmem</span></code><span leaf="">：允许使用的内存（GB）</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">运行的命令示例如下：</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 运行示例代码</span></span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /home/jdoe/runs</span><span leaf=""><br></span><span leaf="">cellranger count --id=sample345 \</span><span leaf=""><br></span><span leaf="">           --transcriptome=/opt/refdata-gex-GRCh38-2020-A \</span><span leaf=""><br></span><span leaf="">           --fastqs=/home/jdoe/runs/HAWT7ADXX/outs/fastq_path \</span><span leaf=""><br></span><span leaf="">           --sample=mysample \</span><span leaf=""><br></span><span leaf="">           --create-bam=</span><span><span leaf="">true</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">           --localcores=8 \</span><span leaf=""><br></span><span leaf="">           --localmem=64</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">3.2 生成sh命令</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">我总共有112个线程，一次投递两个样本上去，一个样本32个线程是可以的，生成一个完整的sh命令：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf=""># 创建文件夹</span></span><span leaf=""><br></span><span leaf="">mkdir /nas1/zhangj/project/PRJCA002426/Cellranger_count</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/project/PRJCA002426/Cellranger_count</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 定义变量</span></span><span leaf=""><br></span><span leaf="">cellranger=/nas1/zhangj/biosoft/cellranger-9.0.1/cellranger</span><span leaf=""><br></span><span leaf="">input=/nas1/zhangj/project/PRJCA002426/data/rawdata/CRA002489/</span><span leaf=""><br></span><span leaf="">output=/nas1/zhangj/project/PRJCA002426/Cellranger_count</span><span leaf=""><br></span><span leaf="">ref=/nas1/zhangj/database/Cell_Ranger/refdata-gex-GRCm39-2024-A</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 生成sh</span></span><span leaf=""><br></span><span leaf="">ls -d  ../data/rawdata/CRA002489/E* |awk -F</span><span><span leaf="">'/'</span></span><span><span leaf="">'{print $NF}'</span></span><span leaf=""> |</span><span><span leaf="">while</span></span><span><span leaf="">read</span></span><span leaf=""> sampleid</span><span leaf=""><br></span><span><span leaf="">do</span></span><span leaf=""><br></span><span><span leaf="">echo</span></span><span><span leaf="">"cd </span><span><span leaf="">${output}</span></span><span leaf=""> &amp;&amp; </span><span><span leaf="">$cellranger</span></span><span leaf=""> count --id=</span><span><span leaf="">$sampleid</span></span><span leaf=""> --transcriptome=</span><span><span leaf="">$ref</span></span><span leaf=""> --fastqs=</span><span><span leaf="">$input</span></span><span leaf="">/</span><span><span leaf="">$sampleid</span></span><span leaf=""> --sample=</span><span><span leaf="">$sampleid</span></span><span leaf=""> --localcores=32 --localmem=64 --create-bam=true "</span></span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""> &gt;cellranger_count.sh</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">cellranger_count.sh 内容如下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/project/PRJCA002426/Cellranger_count &amp;&amp; /nas1/zhangj/biosoft/cellranger-9.0.1/cellranger count --id=E11-5 --transcriptome=/nas1/zhangj/database/Cell_Ranger/refdata-gex-GRCm39-2024-A --fastqs=/nas1/zhangj/project/PRJCA002426/data/rawdata/CRA002489//E11-5 --sample=E11-5 --localcores=32 --localmem=64 --create-bam=</span><span><span leaf="">true</span></span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/project/PRJCA002426/Cellranger_count &amp;&amp; /nas1/zhangj/biosoft/cellranger-9.0.1/cellranger count --id=E12-5 --transcriptome=/nas1/zhangj/database/Cell_Ranger/refdata-gex-GRCm39-2024-A --fastqs=/nas1/zhangj/project/PRJCA002426/data/rawdata/CRA002489//E12-5 --sample=E12-5 --localcores=32 --localmem=64 --create-bam=</span><span><span leaf="">true</span></span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/project/PRJCA002426/Cellranger_count &amp;&amp; /nas1/zhangj/biosoft/cellranger-9.0.1/cellranger count --id=E13-5 --transcriptome=/nas1/zhangj/database/Cell_Ranger/refdata-gex-GRCm39-2024-A --fastqs=/nas1/zhangj/project/PRJCA002426/data/rawdata/CRA002489//E13-5 --sample=E13-5 --localcores=32 --localmem=64 --create-bam=</span><span><span leaf="">true</span></span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> /nas1/zhangj/project/PRJCA002426/Cellranger_count &amp;&amp; /nas1/zhangj/biosoft/cellranger-9.0.1/cellranger count --id=E14-5 --transcriptome=/nas1/zhangj/database/Cell_Ranger/refdata-gex-GRCm39-2024-A --fastqs=/nas1/zhangj/project/PRJCA002426/data/rawdata/CRA002489//E14-5 --sample=E14-5 --localcores=32 --localmem=64 --create-bam=</span><span><span leaf="">true</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">3.3 并行投递</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">多任务并行神器，同时提交 2 个任务。</span><code><span leaf="">ParaFly </span></code><span leaf="">这个软件又是张永杰介绍过的！上次以为他没有介绍呢，喊他告诉我在这里，在他的玩转服务器系列中：</span><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530641&amp;idx=1&amp;sn=c3c97936dc9961c150d79070e7ecf8dc&amp;scene=21#wechat_redirect"><span leaf="">玩转服务器—提交并行任务</span></a><span leaf="">。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">nohup ParaFly -c cellranger_count.sh -CPU 2 1&gt;cellranger_count.sh.log 2&gt;&amp;1 &amp;</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">又估计要等一晚上了~</span></p><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">文末友情宣传</span></span><span><span leaf=""><br></span></span></h3><ul><li><section><span leaf="">最新一期生信入门：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538467&amp;idx=1&amp;sn=aa5500b24a92b86355c242d02e742f1b&amp;scene=21#wechat_redirect"><span leaf="">生信入门&amp;数据挖掘线上直播课3月班</span></a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect"><span leaf="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535760&amp;idx=2&amp;sn=1e02a2e982a046ecf6389231e6768d5b&amp;scene=21#wechat_redirect"><span leaf="">满足你生信分析计算需求的低价解决方案</span></a></section></li><li><section><span leaf="">生信技能树新课：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247537192&amp;idx=1&amp;sn=f146eabfbd1faefe9d4c85fc68a7dca3&amp;scene=21#wechat_redirect"><span leaf="">掌握Python，解锁单细胞数据的无限可能</span></a></section></li></ul></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/XQ_E_qdCWL_iGiU71iLtUg",target="_blank" rel="noopener noreferrer">原文链接</a>
