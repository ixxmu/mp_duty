---
title: "é¡¶åˆŠå¤ç° | ä¸€ç»´/äºŒç»´/å¤šç»´å˜é‡é—´çš„ç›¸å…³æ€§çƒ­å›¾"
date: 2025-02-20T11:19:26Z
draft: ["false"]
tags: [
  "fetched",
  "MsTtç¬”è®°"
]
categories: ["Acdemic"]
---
é¡¶åˆŠå¤ç° | ä¸€ç»´/äºŒç»´/å¤šç»´å˜é‡é—´çš„ç›¸å…³æ€§çƒ­å›¾ by MsTtç¬”è®°
------
<div><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTtç¬”è®°" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="ğŸ’•Keep learning ä»£ç åˆ†äº«ğŸ˜¹åªåˆ†äº«ï¼Œä¸ç­”ç–‘ï¼Œæ„Ÿè°¢ç†è§£" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-powered-by="yiban.io"><span><span leaf=""><br></span></span></section><section data-mpa-powered-by="yiban.io"><span><span leaf="">è¯·å°Šé‡åŸåˆ›åŠ³åŠ¨æˆæœ</span></span></section><p><span><span leaf="">æœªç»å…è®¸ï¼Œä¸å¾—è½¬è½½</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä»Šå¤©æˆ‘ä»¬æ¥å¤ç°ä¸‰ç§ç›¸å…³æ€§çƒ­å›¾ï¼š</span></p><ul><li><section><span leaf=""><span textstyle="">ä¸€ç»´å˜é‡</span>çš„ç›¸å…³æ€§çƒ­å›¾ï¼ˆ</span><strong><span leaf="">corrplot</span></strong><span leaf="">ï¼‰</span></section></li><li><section><span leaf=""><span textstyle="">äºŒç»´å˜é‡</span>çš„ç›¸å…³æ€§çƒ­å›¾ï¼ˆ</span><strong><span leaf="">pheatmap</span></strong><span leaf="">ï¼‰</span></section></li><li><section><span leaf=""><span textstyle="">å¤šç»´å˜é‡</span>çš„ç›¸å…³æ€§çƒ­å›¾ï¼ˆ</span><strong><span leaf="">linkET</span></strong><span leaf="">ï¼‰</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">é€šè¿‡è¿™äº›çƒ­å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°åˆ†æå’Œç†è§£æ•°æ®ä¹‹é—´çš„å…³ç³»å’Œç›¸äº’å½±å“ï¼Œä»è€Œæ›´å¥½åœ°è¿›è¡Œæ•°æ®åˆ†æå’Œå†³ç­–ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°1ï¼š ä¸€ç»´å˜é‡</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¬¬ 1 ç¯‡æ˜¯Â </span><strong><span leaf="">Nature</span></strong><span leaf="">Â æ–‡ç« ä¸­ (Borton, M.A., McGivern, B.B., Willi, K.R. et al. A functional microbiome catalogue crowdsourced from North American rivers. Nature 637, 103â€“112 (2025). https://doi.org/10.1038/s41586-024-08240-z) çš„ Fig.3b</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cwzoicgCW08KL5njOXcWI2UhvXjiaKfFb2XN7aBHX4fW39kw8SjRDmlw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8509554140127389" data-type="png" data-w="785" data-imgfileid="100000826" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cwzoicgCW08KL5njOXcWI2UhvXjiaKfFb2XN7aBHX4fW39kw8SjRDmlw/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™ä¸ªç›¸å…³æ€§çƒ­å›¾å±•ç¤ºäº†46ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ï¼š</span></p><ul><li><section><span leaf="">è¿™äº›å˜é‡åˆ†ä¸ºå››ä¸ªç»„ï¼Œç”¨ä¸åŒçš„é¢œè‰²è¡¨ç¤ºã€‚</span></section></li><li><section><span leaf="">æ¯ä¸ªå•å…ƒæ ¼è¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ Pearson ç›¸å…³ç³»æ•°ï¼Œé¢œè‰²ä»çº¢è‰²ï¼ˆè´Ÿç›¸å…³ï¼‰åˆ°é»‘è‰²ï¼ˆæ­£ç›¸å…³ï¼‰ï¼Œé¢œè‰²çš„å¼ºåº¦è¡¨ç¤ºç›¸å…³æ€§çš„å¼ºåº¦ï¼›ç©ºæ ¼åˆ™è¡¨ç¤ºè¯¥ç›¸å…³æ€§åœ¨ç»Ÿè®¡ä¸Šä¸æ˜¾è‘—ï¼ˆP &gt; 0.05ï¼‰ï¼Œåªæœ‰æ˜¾è‘—çš„ç›¸å…³æ€§æ‰è¢«æ˜¾ç¤ºã€‚</span></section></li><li><section><span leaf="">è¿™ç§å¯è§†åŒ–æ–¹æ³•åœ¨å¤šå˜é‡åˆ†æä¸­éå¸¸æœ‰ç”¨ï¼Œæœ‰åŠ©äºæ­ç¤ºå¤æ‚æ•°æ®é›†ä¸­çš„å…³é”®æ¨¡å¼å’Œè¶‹åŠ¿ã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cm6DXiaiaEnoo7s37xyYbaH3sAbcJ7nKicTXzjoVicNVmubrg4sic8utgqg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9227323628219485" data-type="png" data-w="893" data-imgfileid="100000827" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cm6DXiaiaEnoo7s37xyYbaH3sAbcJ7nKicTXzjoVicNVmubrg4sic8utgqg/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨Â <span textstyle="">R corrplot</span>Â åŒ…å¤ç°ï¼Œç”±äºæ•°æ®æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸åŸå›¾çš„è¶‹åŠ¿ä¸åŒã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½RåŒ…ï¼Œå‡†å¤‡æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf=""><span>library(RColorBrewer)</span></span></code><code><span leaf=""><span>library(corrplot)</span></span></code><code><span leaf=""><span>library(ggplot2)</span></span></code><code><span leaf=""><span>library(grid)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ–‡ä»¶</span></span></code><code><span leaf=""><span>dataÂ </span><span>&lt;-</span><span>Â read.csv(</span><span>'corrplot/data/data.csv'</span><span>,row.namesÂ </span><span>=</span><span>Â </span><span>1</span><span>, check.namesÂ </span><span>=</span><span>Â F)</span></span></code><code><span leaf=""><span>group</span><span>Â </span><span>&lt;-</span><span>Â read.csv("corrplot/data/group.csv", check.namesÂ </span><span>=</span><span>Â </span><span>FALSE</span><span>)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®é¢œè‰²</span></span></code><code><span leaf=""><span># color bar</span></span></code><code><span leaf=""><span>colÂ </span><span>=</span><span>Â (brewer.pal(nÂ </span><span>=</span><span>Â </span><span>8</span><span>, nameÂ </span><span>=</span><span>Â "RdGy"))</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆ†ç±»åŠå˜é‡çš„é¢œè‰²</span></span></code><code><span leaf=""><span>coltextÂ </span><span>&lt;-</span><span>Â c("#66009b", "#00defc", "#ff9933", "#00089d")</span></span></code><code><span leaf=""><span>group</span><span>$colorÂ </span><span>&lt;-</span><span>Â coltext[factor(</span><span>group</span><span>$Type, levelsÂ </span><span>=</span><span>Â c("Microbial", "Site", "Land use", "Watershed"))]</span></span></code><code><span leaf=""><span>variable_colorÂ </span><span>&lt;-</span><span>Â </span><span>group</span><span>[</span><span>match</span><span>(colnames(data),Â </span><span>group</span><span>$Variable),]$color</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥å˜é‡å€¼å’Œåˆ†ç»„ä¿¡æ¯ï¼Œå¹¶è®¾ç½®çƒ­å›¾å’Œåˆ†ç»„çš„é¢œè‰²ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç›¸å…³æ€§åˆ†æ</span></span></h2><section><ul><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span># è®¡ç®—ç›¸å…³æ€§</span></span></code><code><span leaf=""><span>data_logÂ </span><span>&lt;-</span><span>Â </span><span>log10</span><span>(dataÂ </span><span>+</span><span>Â </span><span>0.000001</span><span>)</span></span></code><code><span leaf=""><span>corÂ </span><span>&lt;-</span><span>Â cor(data_log, useÂ </span><span>=</span><span>Â </span><span>'pairwise.complete.obs'</span><span>,Â </span><span>method</span><span>Â </span><span>=</span><span>Â </span><span>'pearson'</span><span>)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ç›¸å…³æ€§æ£€éªŒ</span></span></code><code><span leaf=""><span>p.matÂ </span><span>&lt;-</span><span>Â cor.mtest(cor, conf.levelÂ </span><span>=</span><span>Â </span><span>.95</span><span>)$p</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">cor()</span></code><span leaf="">å‡½æ•°è®¡ç®—æ•°æ®çš„ç›¸å…³æ€§ã€‚å…ˆå°†æ•°æ®è½¬æ¢ä¸ºå¯¹æ•°å°ºåº¦ï¼Œæœ‰åŠ©äºå‡å°æ•°æ®çš„å·®å¼‚æ€§ï¼Œæ›´å¥½åœ°å±•ç¤ºæ•°æ®çš„ç‰¹å¾ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">cor.mtest()</span></code><span leaf="">å‡½æ•°è¯„ä¼°ç›¸å…³çŸ©é˜µä¸­çš„æ¯ä¸ªç›¸å…³ç³»æ•°æ˜¯å¦æ˜¾è‘—ï¼š</span></p><ul><li><section><code><span leaf="">cor.mtest(cor, conf.level = .95)</span></code><span leaf="">ï¼šå¯¹ç›¸å…³çŸ©é˜µ cor è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒï¼Œç½®ä¿¡æ°´å¹³ä¸º 95%ï¼Œè¾“å‡ºç›¸å…³ç³»æ•°çš„ p å€¼ç­‰ä¿¡æ¯ã€‚</span></section></li><li><section><code><span leaf="">$p</span></code><span leaf="">ï¼šæå–å…¶ä¸­çš„ p å€¼çŸ©é˜µã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span leaf="">1. ç›¸å…³æ€§çƒ­å›¾</span><span></span></h4><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span>corrplot(cor,Â </span><span>method</span><span>Â </span><span>=</span><span>Â "square", typeÂ </span><span>=</span><span>Â "upper",Â </span><span>order</span><span>Â </span><span>=</span><span>Â "original",</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®på€¼æ ·å¼</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â p.matÂ </span><span>=</span><span>Â p.mat, sig.levelÂ </span><span>=</span><span>Â </span><span>0.01</span><span>, insigÂ </span><span>=</span><span>Â "blank",Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®color bar</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â colÂ </span><span>=</span><span>Â col, cl.posÂ </span><span>=</span><span>Â "b",Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®æ–‡æœ¬é¢œè‰²åŠå­—ä½“å¤§å°</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â tl.colÂ </span><span>=</span><span>Â variable_color, tl.cexÂ </span><span>=</span><span>Â </span><span>0.7</span><span>,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®å››å‘¨è¾¹è·ï¼Œåœ¨å³ä¾§é¢„ç•™æ³¨é‡Šä¿¡æ¯çš„ç©ºé—´</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â marÂ </span><span>=</span><span>Â c(</span><span>0</span><span>,Â </span><span>0</span><span>,Â </span><span>0</span><span>,Â </span><span>1</span><span>))</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">corrplot()</span></code><span leaf="">å‡½æ•°ç»˜åˆ¶ç›¸å…³æ€§çƒ­å›¾ï¼š</span></p><ul><li><section><code><span leaf="">method = "square"</span></code><span leaf="">: è®¾ç½®å½¢çŠ¶ä¸ºæ–¹å½¢ã€‚</span></section></li><li><section><code><span leaf="">type = "upper"</span></code><span leaf="">: ç»˜åˆ¶çŸ©é˜µçš„ä¸Šä¸‰è§’éƒ¨åˆ†ã€‚</span></section></li><li><section><code><span leaf="">order = "original"</span></code><span leaf="">: è®¾ç½®çŸ©é˜µçš„æ’åˆ—é¡ºåºã€‚"original" è¡¨ç¤ºä¿æŒåŸå§‹é¡ºåºä¸å˜ã€‚</span></section></li><li><section><code><span leaf="">p.mat = p.mat</span></code><span leaf="">: è®¾ç½®å…ˆå‰è®¡ç®—çš„ p å€¼çŸ©é˜µã€‚</span></section></li><li><section><code><span leaf="">sig.level = 0.01</span></code><span leaf="">: è®¾ç½®æ˜¾è‘—æ€§æ°´å¹³ä¸º 0.01ã€‚</span></section></li><li><section><code><span leaf="">insig = "blank"</span></code><span leaf="">: è®¾ç½®éæ˜¾è‘—çš„ç›¸å…³ç³»æ•°ä¸ºâ€œç©ºç™½â€ã€‚å³ï¼Œp å€¼å¤§äºæ˜¾è‘—æ€§æ°´å¹³æ—¶ï¼Œç›¸å…³ç³»æ•°çš„æ–¹æ ¼å°†è¢«ç•™ç©ºï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°å€¼æˆ–é¢œè‰²ã€‚</span></section></li><li><section><code><span leaf="">tl.col = variable_color</span></code><span leaf="">: è®¾ç½®å˜é‡ï¼ˆè½´æ ‡ç­¾ï¼‰çš„æ–‡æœ¬é¢œè‰²ã€‚</span></section></li></ul><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3PdRUL8R8iaBJCL9XnSKFRRDfdsdAXNCaw9SmvvZNqaaycbX4K19YMpA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.2466460268317854" data-s="300,640" data-type="png" data-w="969" type="block" data-imgfileid="100000828" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3PdRUL8R8iaBJCL9XnSKFRRDfdsdAXNCaw9SmvvZNqaaycbX4K19YMpA/640?wx_fmt=png&amp;from=appmsg"></section><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span leaf="">2. æ³¨é‡Š</span><span></span></h4><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span>ggplot(</span><span>group</span><span>, aes(xÂ </span><span>=</span><span>Â </span><span>10</span><span>, yÂ </span><span>=</span><span>Â seq_along(Variable)))Â </span><span>+</span></span></code><code><span leaf=""><span>Â  geom_rect(aes(xmin</span><span>=</span><span>0</span><span>, xmax</span><span>=</span><span>0.4</span><span>,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  ymin</span><span>=</span><span>seq_along(Variable)</span><span>-0.5</span><span>, ymax</span><span>=</span><span>seq_along(Variable)</span><span>+</span><span>0.5</span><span>,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  fillÂ </span><span>=</span><span>Â factor(Type, levelsÂ </span><span>=</span><span>Â c("Microbial", "Site", "Land use", "Watershed")),Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  colorÂ </span><span>=</span><span>Â factor(Type, levelsÂ </span><span>=</span><span>Â c("Microbial", "Site", "Land use", "Watershed"))))Â </span><span>+</span></span></code><code><span leaf=""><span>Â  geom_text(aes(xÂ </span><span>=</span><span>Â </span><span>0.5</span><span>, yÂ </span><span>=</span><span>Â seq_along(Variable), labelÂ </span><span>=</span><span>Â Variable),Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  hjustÂ </span><span>=</span><span>Â </span><span>0</span><span>, size</span><span>=</span><span>2.5</span><span>, color</span><span>=</span><span>"black")Â </span><span>+</span></span></code><code><span leaf=""><span>Â  scale_fill_manual(</span><span>values</span><span>=</span><span>coltext)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  scale_color_manual(</span><span>values</span><span>=</span><span>coltext)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  annotate(geom</span><span>=</span><span>'text'</span><span>, xÂ </span><span>=</span><span>Â </span><span>0.2</span><span>, yÂ </span><span>=</span><span>Â </span><span>5</span><span>, labelÂ </span><span>=</span><span>Â "Microbial", size</span><span>=</span><span>2.5</span><span>, color</span><span>=</span><span>"white", angleÂ </span><span>=</span><span>Â </span><span>90</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  annotate(geom</span><span>=</span><span>'text'</span><span>, xÂ </span><span>=</span><span>Â </span><span>0.2</span><span>, yÂ </span><span>=</span><span>Â </span><span>14</span><span>, labelÂ </span><span>=</span><span>Â "Site", size</span><span>=</span><span>2.5</span><span>, color</span><span>=</span><span>"black", angleÂ </span><span>=</span><span>Â </span><span>90</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  annotate(geom</span><span>=</span><span>'text'</span><span>, xÂ </span><span>=</span><span>Â </span><span>0.2</span><span>, yÂ </span><span>=</span><span>Â </span><span>26.5</span><span>, labelÂ </span><span>=</span><span>Â "Land use", size</span><span>=</span><span>2.5</span><span>, color</span><span>=</span><span>"black", angleÂ </span><span>=</span><span>Â </span><span>90</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  annotate(geom</span><span>=</span><span>'text'</span><span>, xÂ </span><span>=</span><span>Â </span><span>0.2</span><span>, yÂ </span><span>=</span><span>Â </span><span>38</span><span>, labelÂ </span><span>=</span><span>Â "Watershed", size</span><span>=</span><span>2.5</span><span>, color</span><span>=</span><span>"white", angleÂ </span><span>=</span><span>Â </span><span>90</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  xlab(</span><span>NULL</span><span>)Â </span><span>+</span><span>Â ylab(</span><span>NULL</span><span>)Â </span><span>+</span><span>Â </span></span></code><code><span leaf=""><span>Â  scale_y_reverse()Â </span><span>+</span></span></code><code><span leaf=""><span>Â  theme_void()Â </span><span>+</span></span></code><code><span leaf=""><span>Â  theme(legend.positionÂ </span><span>=</span><span>Â "none")</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">geom_rect()</span></code><span leaf="">ï¼šç»˜åˆ¶çŸ©å½¢</span></p><ul><li><section><code><span leaf="">xmin = 0, xmax = 0.4</span></code><span leaf="">ï¼šæ¯ä¸ªçŸ©å½¢çš„æ°´å¹³èŒƒå›´ï¼Œä» 0 åˆ° 0.4ã€‚æ‰€æœ‰çŸ©å½¢å®½åº¦ç›¸åŒã€‚</span></section></li><li><section><code><span leaf="">ymin = seq_along(Variable)-0.5, ymax = seq_along(Variable)+0.5</span></code><span leaf="">ï¼šæ¯ä¸ªçŸ©å½¢çš„å‚ç›´èŒƒå›´ã€‚æ¯ä¸ªçŸ©å½¢çš„ y ä½ç½®å¯¹åº” Variable çš„å…ƒç´ é¡ºåºï¼Œ-0.5 å’Œ +0.5 æ˜¯ç”¨æ¥åˆ›å»ºæ¯ä¸ªçŸ©å½¢çš„ä¸Šä¸‹è¾¹ç•Œï¼Œä½¿å¾—æ¯ä¸ªçŸ©å½¢å‚ç›´æ–¹å‘ä¸Šæœ‰ä¸€å®šçš„é«˜åº¦ï¼ˆ1å•ä½çš„é«˜åº¦ï¼‰ã€‚</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">geom_text()</span></code><span leaf="">ï¼šæ·»åŠ æ–‡æœ¬æ ‡ç­¾</span></p><ul><li><section><code><span leaf="">x = 0.5</span></code><span leaf="">ï¼šæ–‡æœ¬ä½äºçŸ©å½¢çš„ä¸­é—´ï¼ˆæ°´å¹³å±…ä¸­ï¼‰ã€‚</span></section></li><li><section><code><span leaf="">y = seq_along(Variable)</span></code><span leaf="">ï¼šæ–‡æœ¬ä½ç½®ã€‚</span></section></li><li><section><code><span leaf="">hjust = 0</span></code><span leaf="">ï¼šæ–‡æœ¬å¯¹é½æ–¹å¼ï¼Œ0 è¡¨ç¤ºå·¦å¯¹é½ã€‚</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">annotate()</span></code><span leaf="">ï¼šæ·»åŠ å‚ç›´æ–‡æœ¬æ ‡ç­¾</span></p><ul><li><section><code><span leaf="">x</span></code><span leaf="">å’Œ</span><code><span leaf="">y</span></code><span leaf="">æ§åˆ¶æ–‡æœ¬çš„ä½ç½®ã€‚</span></section></li></ul><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3gt2IibJrEu3vJYiaj4Lic5DGQMVP0NIDAWic5qooGARzoicqtzFnFJiaKTrg/640?wx_fmt=png&amp;from=appmsg" data-ratio="2.4069478908188584" data-s="300,640" data-type="png" data-w="403" type="block" data-imgfileid="100000829" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3gt2IibJrEu3vJYiaj4Lic5DGQMVP0NIDAWic5qooGARzoicqtzFnFJiaKTrg/640?wx_fmt=png&amp;from=appmsg"></section><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span leaf="">3.åˆå¹¶å›¾ç‰‡</span><span></span></h4><section><ul><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span>pdf(</span><span>"corrplot/corrplot.correlation_heatmap.pdf"</span><span>, width = 10, height = 8)</span></span></code><code><span leaf=""><span>p1</span></span></code><code><span leaf=""><span>vie1 &lt;- viewport(width=0.38, height=0.585, x=0.9, y=0.36)</span></span></code><code><span leaf=""><span>print</span><span>(p2, vp=vie1)</span></span></code><code><span leaf=""><span>dev.off()</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">grid::viewport()</span></code><span leaf="">å‡½æ•°æ¥ç²¾ç¡®æ§åˆ¶ç»„åˆå›¾å½¢çš„ä½ç½®å’Œå¤§å°ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cm6DXiaiaEnoo7s37xyYbaH3sAbcJ7nKicTXzjoVicNVmubrg4sic8utgqg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9227323628219485" data-type="png" data-w="893" data-imgfileid="100000830" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3cm6DXiaiaEnoo7s37xyYbaH3sAbcJ7nKicTXzjoVicNVmubrg4sic8utgqg/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°2ï¼šäºŒç»´å˜é‡</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¬¬ 2 ç¯‡æ˜¯Â </span><strong><span leaf="">Nature Genetics</span></strong><span leaf="">Â æ–‡ç« ä¸­ (FranzÃ©n, L., Olsson Lindvall, M., HÃ¼hn, M. et al. Mapping spatially resolved transcriptomes in human and mouse pulmonary fibrosis. Nat Genet 56, 1725â€“1736 (2024). https://doi.org/10.1038/s41588-024-01819-2) çš„ Fig.1f</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3NB0KDKtXLnicR2fOX2kAqaiaDKKG1bdHOGY6dCS6oEN7oT9jW94n7CyA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.851764705882353" data-type="png" data-w="850" data-imgfileid="100000831" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3NB0KDKtXLnicR2fOX2kAqaiaDKKG1bdHOGY6dCS6oEN7oT9jW94n7CyA/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™ä¸ªç›¸å…³æ€§çƒ­å›¾å±•ç¤ºäº† NMF å› å­ä¸ç»†èƒç±»å‹ä¹‹é—´çš„å…³ç³»ï¼š</span></p><ul><li><section><span leaf="">çƒ­å›¾é¡¶éƒ¨çš„åˆ—è¡¨ç¤º NMF å› å­ï¼Œå·¦ä¾§çš„è¡Œè¡¨ç¤ºä¸åŒçš„ç»†èƒç±»å‹ï¼Œè¿™äº›ç»†èƒç±»å‹è¢«åˆ†ä¸ºäº”ä¸ªç»„ã€‚</span></section></li><li><section><span leaf="">çƒ­å›¾ä¸­çš„é¢œè‰²è¡¨ç¤º Pearson ç›¸å…³ç³»æ•°ï¼Œé¢œè‰²ä»ç»¿è‰²ï¼ˆè´Ÿç›¸å…³ï¼‰åˆ°ç´«è‰²ï¼ˆæ­£ç›¸å…³ï¼‰ï¼Œé¢œè‰²çš„å¼ºåº¦è¡¨ç¤ºç›¸å…³æ€§çš„å¼ºåº¦ï¼Œç™½è‰²è¡¨ç¤ºæ²¡æœ‰æ˜¾è‘—ç›¸å…³æ€§ã€‚</span></section></li><li><section><span leaf="">çƒ­å›¾é¡¶éƒ¨å’Œå·¦ä¾§çš„æ ‘çŠ¶å›¾æ˜¾ç¤ºäº† NMF å› å­å’Œç»†èƒç±»å‹çš„å±‚æ¬¡èšç±»ç»“æœï¼Œå¸®åŠ©è¯†åˆ«ç›¸ä¼¼çš„å› å­å’Œç»†èƒç±»å‹ã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3zlIPqF2AYvWGjBWclP44HXKy9m3ViaEZCwpsGCSmDAayVmDqGPryjhQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6429980276134122" data-type="png" data-w="1014" data-imgfileid="100000834" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3zlIPqF2AYvWGjBWclP44HXKy9m3ViaEZCwpsGCSmDAayVmDqGPryjhQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨Â <span textstyle="">R pheatmap</span>Â åŒ…å¤ç°ï¼Œå­¦ä¹ åˆ°çš„æŠ€å·§:</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¦‚ä½•åˆ›å»ºä¸€ä¸ªå¯¹ç§°çš„é¢œè‰²åˆ»åº¦ï¼Ÿå…ˆæ ¹æ®æ•°æ®çš„èŒƒå›´åˆ›å»ºä¸€ä¸ªæ•°å€¼å‘é‡ï¼Œç”¨è¿™äº›å‘é‡æ¥å®šä¹‰çƒ­å›¾çš„é¢œè‰²åŒºé—´ï¼Œå†ä½¿ç”¨</span><code><span leaf="">breaks</span></code><span leaf="">å‚æ•°æ¥åˆ›å»ºé¢œè‰²åˆ»åº¦ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½RåŒ…ï¼Œå‡†å¤‡æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf=""><span>library(pheatmap)</span></span></code><code><span leaf=""><span>library(dplyr)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ–‡ä»¶</span></span></code><code><span leaf=""><span># ä¸¤ä¸ªçŸ©é˜µçš„ç›¸å…³æ€§ç³»æ•°</span></span></code><code><span leaf=""><span>r_dataÂ </span><span>&lt;-</span><span>Â read.csv(</span><span>'pheatmap/data/cell_factor_corr.csv'</span><span>,row.namesÂ </span><span>=</span><span>Â </span><span>1</span><span>, check.namesÂ </span><span>=</span><span>Â F)</span></span></code><code><span leaf=""><span># åˆ†ç»„ä¿¡æ¯ï¼Œç”¨äºçƒ­å›¾çš„åˆ†ç±»æ³¨é‡Š</span></span></code><code><span leaf=""><span>group_rowÂ </span><span>&lt;-</span><span>Â read.csv(</span><span>'pheatmap/data/group_row.csv'</span><span>,row.namesÂ </span><span>=</span><span>Â </span><span>1</span><span>, check.namesÂ </span><span>=</span><span>Â F)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®é¢œè‰²</span></span></code><code><span leaf=""><span>#çƒ­å›¾çš„ color bar</span></span></code><code><span leaf=""><span>col_scale_makoÂ </span><span>&lt;-</span><span>Â viridis::mako(</span><span>13</span><span>, directionÂ </span><span>=</span><span>Â </span><span>-1</span><span>)[</span><span>1</span><span>:</span><span>10</span><span>]</span></span></code><code><span leaf=""><span>col_scale_actonÂ </span><span>&lt;-</span><span>Â scico::scico(</span><span>10</span><span>, directionÂ </span><span>=</span><span>Â </span><span>-1</span><span>, paletteÂ </span><span>=</span><span>Â "acton")</span></span></code><code><span leaf=""><span>my_colorÂ </span><span>&lt;-</span><span>Â c(rev(col_scale_mako[</span><span>1</span><span>:</span><span>8</span><span>]), "white", col_scale_acton[</span><span>1</span><span>:</span><span>8</span><span>])</span></span></code><code><span leaf=""><span>col_lengthÂ </span><span>&lt;-</span><span>Â length(my_color)</span></span></code><code><span leaf=""><span>#æ ¹æ®æ•°æ®çš„èŒƒå›´ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹ç§°çš„é¢œè‰²åˆ»åº¦</span></span></code><code><span leaf=""><span>abs_max_valÂ </span><span>&lt;-</span><span>Â </span><span>max</span><span>(r_data, na.rmÂ </span><span>=</span><span>Â T)</span></span></code><code><span leaf=""><span>ph_breaksÂ </span><span>&lt;-</span><span>Â c(seq(</span><span>-</span><span>abs_max_val,Â </span><span>0</span><span>, length.out</span><span>=</span><span>ceiling</span><span>(col_length</span><span>/</span><span>2</span><span>)Â </span><span>+</span><span>Â </span><span>1</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â seq(abs_max_val</span><span>/</span><span>col_length, abs_max_val, length.out</span><span>=</span><span>floor</span><span>(col_length</span><span>/</span><span>2</span><span>)))</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆ†ç»„çš„é¢œè‰²</span></span></code><code><span leaf=""><span>group_colorsÂ </span><span>=</span><span>Â list(</span></span></code><code><span leaf=""><span>Â  cell_groupÂ </span><span>=</span><span>Â setNames(c("#b36692", "#fbb03c", "#0070bc", "#faee90", "#a0e0b8"),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nmÂ </span><span>=</span><span>Â group_row$cell_groupÂ </span><span>%&gt;%</span><span>Â </span><span>unique</span><span>()Â </span><span>%&gt;%</span><span>Â sort()))</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥ç›¸å…³æ€§æ•°æ®å’Œåˆ†ç»„ä¿¡æ¯ï¼Œå¹¶è®¾ç½®çƒ­å›¾å’Œåˆ†ç»„çš„é¢œè‰²ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åˆ›å»ºå¯¹ç§°çš„ breaksï¼š</span></p><ul><li><section><span leaf="">è®¡ç®—æ•°æ®çŸ©é˜µä¸­ç»å¯¹å€¼çš„æœ€å¤§å€¼ (abs_max_val)</span></section></li><li><section><span leaf="">ä½¿ç”¨</span><code><span leaf="">seq()</span></code><span leaf="">å‡½æ•°ä» -abs_max_val åˆ° 0 åˆ›å»ºä¸€ç»„ breaksã€‚</span></section></li><li><section><span leaf="">ä½¿ç”¨</span><code><span leaf="">seq()</span></code><span leaf="">å‡½æ•°ä» abs_max_val / col_length åˆ° abs_max_val åˆ›å»ºå¦ä¸€ç»„ breaksã€‚</span></section></li><li><section><span leaf="">åˆå¹¶ä¸¤ç»„ breaks ä»¥ç¡®ä¿é¢œè‰²åˆ»åº¦å¯¹ç§°ã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span leaf=""><span>pheatmap(</span><span>as</span><span>.matrix(r_data),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®é¢œè‰²æ¢¯åº¦</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â colorÂ </span><span>=</span><span>Â my_color,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â breaksÂ </span><span>=</span><span>Â ph_breaks,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®æ ¼å­</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â cellwidthÂ </span><span>=</span><span>Â </span><span>10</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â cellheightÂ </span><span>=</span><span>Â </span><span>10</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #border_colorÂ </span><span>=</span><span>Â </span><span>"grey50"</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®è¡Œ</span><span>/åˆ—treeä¸ªæ•°</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â cutree_cols = 3,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â cutree_rows = 3,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®èšç±»æ ‘æ ·å¼</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â treeheight_row = 12,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â treeheight_col = 10,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®è¡Œæ³¨é‡Š</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â annotation_row = group_row,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â annotation_colors = group_colors,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â annotation_names_row = F,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®è¡Œ/åˆ—çš„å­—ä½“</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â fontsize_rowÂ </span><span>=</span><span>Â </span><span>10</span><span>,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â fontsize_colÂ </span><span>=</span><span>Â </span><span>10</span><span>,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â angle_colÂ </span><span>=</span><span>Â </span><span>90</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â #è®¾ç½®</span><span>NAæ ¼å­</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â na_colÂ </span><span>=</span><span>Â </span><span>"grey80"</span><span>)</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨</span><code><span leaf="">pheatmap()</span></code><span leaf="">å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ªçƒ­å›¾:</span></p><ul><li><section><span leaf="">color = my_colorï¼šè®¾ç½®çƒ­å›¾çš„é¢œè‰²æ¢¯åº¦ã€‚</span></section></li><li><section><span leaf="">breaks = ph_breaksï¼šå®šä¹‰é¢œè‰²åˆ†æ®µçš„æ–­ç‚¹ã€‚</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3zlIPqF2AYvWGjBWclP44HXKy9m3ViaEZCwpsGCSmDAayVmDqGPryjhQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6429980276134122" data-type="png" data-w="1014" data-imgfileid="100000833" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3zlIPqF2AYvWGjBWclP44HXKy9m3ViaEZCwpsGCSmDAayVmDqGPryjhQ/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°3ï¼šå¤šç»´å˜é‡</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¬¬ 3 ç¯‡æ˜¯Â </span><strong><span leaf="">Nature communications</span></strong><span leaf="">Â æ–‡ç« ä¸­ (Ji, M., Zhou, J., Li, Y. et al. Biodiversity of mudflat intertidal viromes along the Chinese coasts. Nat Commun 15, 8611 (2024). https://doi.org/10.1038/s41467-024-52996-x) çš„ Fig.5a</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3m0a2wBYic5SWT2zpv2987BBNzkXKEbzhicjGylGxPn0ytxsQY7DrSGIw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5982742090124641" data-type="png" data-w="1043" data-imgfileid="100000835" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3m0a2wBYic5SWT2zpv2987BBNzkXKEbzhicjGylGxPn0ytxsQY7DrSGIw/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™å¼ å›¾å±•ç¤ºäº†ç¯å¢ƒå› ç´ ä¸ç—…æ¯’/å¾®ç”Ÿç‰©ç¾¤è½ä¹‹é—´çš„å…³ç³»ï¼š</span></p><ul><li><section><span leaf=""><span textstyle="">éƒ¨åˆ† Mantel test</span>ï¼šå·¦ä¾§çš„èŠ‚ç‚¹è¡¨ç¤ºä¸åŒçš„ç¾¤è½ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„è¾¹è¡¨ç¤ºç¾¤è½ä¸ç¯å¢ƒå› ç´ ä¹‹é—´çš„ Mantel ç›¸å…³ç³»æ•°ï¼ˆMantel's rï¼‰å’Œæ˜¾è‘—æ€§ï¼ˆMantel's pï¼‰ï¼Œè¾¹çš„é¢œè‰²å’Œå®½åº¦è¡¨ç¤º Mantel çš„ r å’Œ p å€¼ã€‚</span></section></li><li><section><span leaf=""><span textstyle="">Pearson ç›¸å…³ç³»æ•°</span>ï¼šå³ä¾§çƒ­å›¾ä¸­çš„é¢œè‰²è¡¨ç¤ºä¸åŒç¯å¢ƒå› ç´ ä¹‹é—´çš„ Pearson ç›¸å…³ç³»æ•°ï¼Œä»è´Ÿç›¸å…³ï¼ˆ-1ï¼Œçº¢è‰²ï¼‰åˆ°æ­£ç›¸å…³ï¼ˆ1ï¼Œè“è‰²ï¼‰ã€‚é¢œè‰²çš„å¼ºåº¦è¡¨ç¤ºç›¸å…³æ€§çš„å¼ºåº¦ï¼Œçƒ­å›¾ä¸­çš„æ˜Ÿå·è¡¨ç¤ºç›¸å…³æ€§çš„æ˜¾è‘—æ€§æ°´å¹³ã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3QQ6ic4ZRPrPHSyKw8tsKEc7KeBmY7UuH23JfqSbicv7UAuWXUXpVQO9Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6533466533466533" data-type="png" data-w="1001" data-imgfileid="100000836" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3QQ6ic4ZRPrPHSyKw8tsKEc7KeBmY7UuH23JfqSbicv7UAuWXUXpVQO9Q/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨<span textstyle="">Â </span><span textstyle="">R linkET</span>Â åŒ…å¤ç°ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½RåŒ…ï¼Œå‡†å¤‡æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="objectivec"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf=""><span>library(linkET)</span></span></code><code><span leaf=""><span>library(ggplot2)</span></span></code><code><span leaf=""><span>library(Hmisc)</span></span></code><code><span leaf=""><span>library(dplyr)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ–‡ä»¶</span></span></code><code><span leaf=""><span># ç¯å¢ƒå› å­</span></span></code><code><span leaf=""><span>env&lt;-read.csv(</span><span>'mantel_test/data/Environment.CSV'</span><span>,row.names =Â </span><span>1</span><span>, check.names = F)</span></span></code><code><span leaf=""><span># å„ç±»ç¾¤è½æ•°æ®</span></span></code><code><span leaf=""><span>host&lt;-t(read.delim(</span><span>'mantel_test/data/host.txt'</span><span>,row.names =Â </span><span>1</span><span>))</span></span></code><code><span leaf=""><span>mOTUs&lt;-t(read.delim(</span><span>'mantel_test/data/mOTUs.txt'</span><span>,row.names =Â </span><span>1</span><span>))Â </span></span></code><code><span leaf=""><span>virus&lt;-t(read.delim(</span><span>'mantel_test/data/virus.txt'</span><span>,row.names =Â </span><span>1</span><span>))</span></span></code><code><span leaf=""><span>vOTUs&lt;-t(read.delim(</span><span>'mantel_test/data/vOTUs.txt'</span><span>,row.names =Â </span><span>1</span><span>))</span></span></code><code><span leaf=""><span># æ ·æœ¬çš„åœ°ç†ä½ç½®(ç»çº¬åº¦)</span></span></code><code><span leaf=""><span>geo&lt;-read.csv(</span><span>'mantel_test/data/distance.CSV'</span><span>,row.names =Â </span><span>1</span><span>)</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥ç¯å¢ƒå› å­æ•°æ®ã€å„ç±»ç¾¤è½æ•°æ®ã€ä»¥åŠæ ·æœ¬çš„åœ°ç†ä½ç½®æ•°æ®ï¼ˆä½œä¸ºç¯å¢ƒæ§åˆ¶å˜é‡ï¼Œæ¥æ¶ˆé™¤å™ªéŸ³ï¼Œä½¿åˆ†ææ›´åŠ ç²¾ç»†ï¼‰ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">Mantel æµ‹è¯•</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span leaf=""><span>spec &lt;-Â </span><span>as</span><span>.</span><span>data</span><span>.frame(cbind(host, mOTUs, virus, vOTUs))</span></span></code><code><span leaf=""><span>mantel &lt;- mantel_test(spec, env[</span><span>1</span><span>:</span><span>11</span><span>],</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  spec_select = list(</span><span>"host"</span><span>Â =Â </span><span>1</span><span>:ncol(host),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span>"mOTUs"</span><span>Â = (ncol(host)+</span><span>1</span><span>):(ncol(host)+ncol(mOTUs)),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span>"virus"</span><span>Â = (ncol(host)+ncol(mOTUs)+</span><span>1</span><span>):(ncol(host)+ncol(mOTUs)+ncol(virus)),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span>"vOTUs"</span><span>Â = (ncol(host)+ncol(mOTUs)+ncol(virus)+</span><span>1</span><span>):(ncol(host)+ncol(mOTUs)+ncol(virus)+ncol(vOTUs))),</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  env_ctrl = geo,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ä½¿ç”¨mantel.partialè®¡ç®—ç›¸å…³æ€§ï¼Œè¿™ç§æ–¹æ³•å…è®¸åœ¨è®¡ç®—ç›¸å…³æ€§æ—¶æ§åˆ¶å…¶ä»–å˜é‡çš„å½±å“</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mantel_fun =Â </span><span>"mantel.partial"</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  permutations =Â </span><span>999</span><span>) %&gt;%Â </span></span></code><code><span leaf=""><span>Â  # å¯¹åˆ†æç»“æœä¸­rå’Œpçš„å€¼, è®¾å®šä¸€ä¸ªåˆ†ç±»åŒºé—´</span></span></code><code><span leaf=""><span>Â  mutate(r_value = cut(r, breaks = c(-Inf,Â </span><span>0.1</span><span>,Â </span><span>0.2</span><span>, Inf),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  labels = c(</span><span>"&lt; 0.1"</span><span>,Â </span><span>"0.1 - 0.2"</span><span>,Â </span><span>"&gt;= 0.2"</span><span>)),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â p_value = cut(p, breaks = c(-Inf,Â </span><span>0.001</span><span>,Â </span><span>0.05</span><span>, Inf),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  labels = c(</span><span>"&lt; 0.001"</span><span>,Â </span><span>"0.001 - 0.05"</span><span>,Â </span><span>"&gt;= 0.05"</span><span>)))</span></span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨éƒ¨åˆ† Mantel æµ‹è¯•ï¼ˆmantel.partialï¼‰æ¥è®¡ç®—ç‰©ç§æ•°æ®å’Œç¯å¢ƒæ•°æ®ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå¹¶æ ¹æ® r å€¼å’Œ p å€¼çš„å¤§å°ï¼Œå°†ç»“æœåˆ†æˆä¸åŒçš„åŒºé—´è¿›è¡Œåˆ†ç±»ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf=""><span># ç¯å¢ƒå› å­ä¸­æœ‰ç¼ºå¤±å€¼ï¼Œéœ€è¦è½¬æˆ</span><span>numeric</span><span>ç±»å‹</span></span></code><code><span leaf=""><span>env_numericÂ </span><span>&lt;-</span><span>Â apply(env[,</span><span>1</span><span>:</span><span>11</span><span>],</span><span>2</span><span>,as.numeric)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>qcorrplot(rcorr(env_numeric), typeÂ </span><span>=</span><span>Â "upper", diagÂ </span><span>=</span><span>Â </span><span>FALSE</span><span>, grid_sizeÂ </span><span>=</span><span>Â </span><span>0.4</span><span>,grid_colÂ </span><span>=</span><span>Â "lightgray")Â </span><span>+</span></span></code><code><span leaf=""><span>Â  geom_square(linetype</span><span>=</span><span>0</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  geom_couple(dataÂ </span><span>=</span><span>Â mantel, aes(colourÂ </span><span>=</span><span>Â p_value, sizeÂ </span><span>=</span><span>Â r_value), Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  node.shapeÂ </span><span>=</span><span>Â </span><span>21</span><span>, node.sizeÂ </span><span>=</span><span>Â </span><span>2</span><span>, node.colourÂ </span><span>=</span><span>Â "#0000ff", node.fillÂ </span><span>=</span><span>Â "#9ba9f1",</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  curvatureÂ </span><span>=</span><span>Â </span><span>0.1</span><span>)Â </span><span>+</span></span></code><code><span leaf=""><span>Â  scale_fill_gradientn(limitsÂ </span><span>=</span><span>Â c(</span><span>-1</span><span>,Â </span><span>1</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â breaksÂ </span><span>=</span><span>Â seq(</span><span>-1</span><span>,Â </span><span>1</span><span>,Â </span><span>0.5</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â coloursÂ </span><span>=</span><span>Â c("#FF8040","white","#5BC2CD"))Â </span><span>+</span><span>Â </span></span></code><code><span leaf=""><span>Â  scale_size_manual(</span><span>values</span><span>Â </span><span>=</span><span>Â c(</span><span>0.2</span><span>,Â </span><span>0.5</span><span>,Â </span><span>0.8</span><span>))</span><span>+</span><span>Â </span></span></code><code><span leaf=""><span>Â  scale_colour_manual(</span><span>values</span><span>=</span><span>c("#87CEEB","#9ACD32","gray"))Â </span><span>+</span></span></code><code><span leaf=""><span>Â  guides(sizeÂ </span><span>=</span><span>Â guide_legend(titleÂ </span><span>=</span><span>Â expression("Mantel's"Â </span><span>~</span><span>Â italic("r")),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â override.aesÂ </span><span>=</span><span>Â list(colourÂ </span><span>=</span><span>Â "grey35"),Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span>order</span><span>Â </span><span>=</span><span>Â </span><span>2</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â colourÂ </span><span>=</span><span>Â guide_legend(titleÂ </span><span>=</span><span>Â expression("Mantel's"Â </span><span>~</span><span>Â italic("p")),Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â override.aesÂ </span><span>=</span><span>Â list(sizeÂ </span><span>=</span><span>Â </span><span>2</span><span>),Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span>order</span><span>Â </span><span>=</span><span>Â </span><span>1</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â fillÂ </span><span>=</span><span>Â guide_colorbar(titleÂ </span><span>=</span><span>Â expression("Pearson's"Â </span><span>~</span><span>Â italic("r")),Â </span><span>order</span><span>Â </span><span>=</span><span>Â </span><span>3</span><span>))</span><span>+</span></span></code><code><span leaf=""><span>Â  geom_mark(only_markÂ </span><span>=</span><span>Â T,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  sizeÂ </span><span>=</span><span>Â </span><span>6</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  sig_levelÂ </span><span>=</span><span>Â c(</span><span>0.05</span><span>,Â </span><span>0.01</span><span>,Â </span><span>0.001</span><span>),</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  sig_thresÂ </span><span>=</span><span>Â </span><span>0.05</span><span>,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  colourÂ </span><span>=</span><span>Â "black")</span></span></code></pre></section><ul><li><section><span leaf="">ä½¿ç”¨</span><code><span leaf="">rcorr()</span></code><span leaf="">å‡½æ•°è®¡ç®— Pearson ç›¸å…³ç³»æ•°çŸ©é˜µï¼Œå¹¶é€šè¿‡</span><code><span leaf="">qcorrplot()</span></code><span leaf="">å‡½æ•°ç»˜åˆ¶ç›¸å…³æ€§å›¾ã€‚</span></section></li><li><section><span leaf="">ä½¿ç”¨</span><code><span leaf="">geom_couple()</span></code><span leaf="">å‡½æ•°æ·»åŠ  Mantel æµ‹è¯•ç»“æœçš„è¿çº¿ï¼š</span></section></li><ul><li><section><code><span leaf="">data = mantel</span></code><span leaf="">ï¼šä½¿ç”¨ä¹‹å‰è®¡ç®—çš„ Mantel æµ‹è¯•ç»“æœæ•°æ®ã€‚</span></section></li><li><section><code><span leaf="">aes(colour = p_value, size = r_value)</span></code><span leaf="">ï¼šä½¿ç”¨ p_value ä½œä¸ºé¢œè‰²ï¼Œr_value ä½œä¸ºçº¿çš„ç²—ç»†ã€‚</span></section></li><li><section><span leaf="">curvature = 0.1ï¼šè®¾ç½®è¿çº¿çš„å¼¯æ›²åº¦ã€‚</span></section></li></ul><li><section><span leaf="">ä½¿ç”¨</span><code><span leaf="">geom_mark()</span></code><span leaf="">ï¼šæ·»åŠ æ˜¾è‘—æ€§*æ ‡è®°ï¼š</span></section></li><ul><li><section><span leaf="">only_mark = Tï¼šä»…æ ‡è®°æ˜¾è‘—æ€§ã€‚</span></section></li><li><section><span leaf="">sig_level = c(0.05, 0.01, 0.001)ï¼šè®¾ç½®æ˜¾è‘—æ€§æ°´å¹³ã€‚</span></section></li><li><section><span leaf="">sig_thres = 0.05ï¼šè®¾ç½®æ˜¾è‘—æ€§é˜ˆå€¼ã€‚</span></section></li></ul></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3QQ6ic4ZRPrPHSyKw8tsKEc7KeBmY7UuH23JfqSbicv7UAuWXUXpVQO9Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6533466533466533" data-type="png" data-w="1001" data-imgfileid="100000837" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLwuib5kEicZqH7Ao9SNGJ8Q3QQ6ic4ZRPrPHSyKw8tsKEc7KeBmY7UuH23JfqSbicv7UAuWXUXpVQO9Q/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">è·å–ä»¥ RProject å½¢å¼ä¿å­˜çš„ç»˜å›¾ä»£ç å’Œæµ‹è¯•æ•°æ®ï¼Œåå°å›å¤å…³é”®è¯:Â </span></span><strong><em><span leaf=""><span textstyle="">250210_correlation_heatmaps</span></span></em></strong></p><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="4d363462-efe8-46ed-b51a-0c512d098706" data-pid="101_14835066"></mp-common-cpsad></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/yPGgFO8Y050w5itmkcpvoQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
