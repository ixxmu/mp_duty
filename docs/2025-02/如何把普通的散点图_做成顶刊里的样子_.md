---
title: "如何把普通的散点图，做成顶刊里的样子？"
date: 2025-02-20T11:20:47Z
draft: ["false"]
tags: [
  "fetched",
  "MsTt笔记"
]
categories: ["Acdemic"]
---
如何把普通的散点图，做成顶刊里的样子？ by MsTt笔记
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section data-mpa-powered-by="yiban.io"><span>请尊重原创劳动成果</span></section><p><span>未经允许，不得转载</span></p><p data-tool="mdnice编辑器">今天来复现 <strong>Nature</strong> 文章中 (Zhu, C., Boehme, S.C., Feld, L.G. et al. Single-photon superradiance in individual caesium lead halide quantum dots. Nature 626, 535–541 (2024). https://doi.org/10.1038/s41586-023-07001-8) 的 Extended Data Fig. 2</p><h2 data-tool="mdnice编辑器"><span></span><span>原图</span></h2><section><br></section><p><img data-galleryid="" data-imgfileid="100000168" data-ratio="0.8062157221206582" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOtbC0n6tfWILt9lz0u4AicIWEr26L2ia64XYFRzwtOoILJ4v0teY8FjYw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="547" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOtbC0n6tfWILt9lz0u4AicIWEr26L2ia64XYFRzwtOoILJ4v0teY8FjYw/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">这个图很好地展示了数据：</p><ul data-tool="mdnice编辑器"><li><section>散点图展示了数据的分布情况；颜色代表不同的分组，可以快速比较不同组之间的差异和趋势。</section></li><li><section>拟合曲线展示了变量之间的整体模式，比如是否存在线性关系或其他趋势。</section></li><li><section>均值和双向误差线展示了不同组之间的均值差异，以及数据的离散程度。</section></li></ul><p data-tool="mdnice编辑器">通过这三种图表的结合，可以一目了然地理解数据的多方面信息：从个体数据的分布到整体趋势的探索，再到组内和组间的比较。</p><h2 data-tool="mdnice编辑器"><span></span><span>复现图</span></h2><section><br></section><p><img data-galleryid="" data-imgfileid="100000169" data-ratio="0.848297213622291" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOvahukry8RsBq4QLr3ftaIm2CySZXm4aRcibHwcNwUZ6bu9d1siaWreUA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="646" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOvahukry8RsBq4QLr3ftaIm2CySZXm4aRcibHwcNwUZ6bu9d1siaWreUA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">复现过程中学习到的技巧:</p><ul data-tool="mdnice编辑器"><li><section>如何给各组的均值添加双向的误差棒，常见的是给每个点，仅在 Y 轴方向添加误差棒。</section></li><li><section>如何在图例中添加拟合曲线和均值的标签，因为这两个图形是不分组的，ggplot2 默认不会生成图例。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>加载R包，准备数据</span></h2><pre data-tool="mdnice编辑器"><code><span># Load required packages:</span><br><span>library</span>(ggplot2)<br><span>library</span>(plyr)<br><span>library</span>(ggh4x)<br><br><span># Read data</span><br>df &lt;- read.csv(<span>"data.csv"</span>)<br><br><span># Set colour</span><br>mycol = c(<span>"#4C9DCA"</span>, <span>"#89CAF0"</span>, <span>"#4EBB9E"</span>, <span>"#EFBB4D"</span>, <span>"#E28F4D"</span>)<br><br><span># Summarise data:</span><br>subdf &lt;- ddply(df, .(Group), summarise, <br>               X = mean(Energy), Y = mean(Lifetime), <br>               X_sd = sd(Energy), Y_sd = sd(Lifetime))<br></code></pre><p data-tool="mdnice编辑器">使用<code>plyr::ddply()</code>函数按照设定的分组计算各变量的均值和标准差，两个变量分别对应 X 轴和 Y 轴。</p><h2 data-tool="mdnice编辑器"><span></span><span>绘图-散点图</span></h2><pre data-tool="mdnice编辑器"><code>ggplot() +<br>  geom_point(data = df, <br>             aes(x = Energy, y = Lifetime, <br>                 color = factor(Group, levels = c(<span>"7nm"</span>, <span>"9nm"</span>, <span>"13nm"</span>, <span>"16nm"</span>, <span>"23nm"</span>))), <br>             size = <span>4</span>, alpha = <span>0.8</span>) +<br>  guides(color = guide_legend(override.aes = list(alpha = <span>1</span>))) + <br>  scale_color_manual(values = mycol)<br></code></pre><p data-tool="mdnice编辑器">使用<code>factor()</code>函数固定分组的绘图顺序。</p><p data-tool="mdnice编辑器">使用<code>guide_legend(override.aes = list(alpha = 1))</code>函数可以独立设置图例中点的外观，而不影响图中点的属性，这里是修改了图例中点的透明度。</p><p><img data-galleryid="" data-imgfileid="100000170" data-ratio="0.7712691771269177" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOuhgc4mcY0lTUMlmwWfTMdVPM5n6ZdNk8n66yZUJVKpWEVfZYyY3MTQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="717" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOuhgc4mcY0lTUMlmwWfTMdVPM5n6ZdNk8n66yZUJVKpWEVfZYyY3MTQ/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="mdnice编辑器"><span></span><span>绘图-拟合曲线</span></h2><pre data-tool="mdnice编辑器"><code>ggplot() +<br>  geom_point(data = df, <br>             aes(x = Energy, y = Lifetime, <br>                 color = factor(Group, levels = c(<span>"7nm"</span>, <span>"9nm"</span>, <span>"13nm"</span>, <span>"16nm"</span>, <span>"23nm"</span>))), <br>             size = <span>4</span>, alpha = <span>0.8</span>) +<br>  guides(color = guide_legend(override.aes = list(alpha = <span>1</span>))) + <br>  scale_color_manual(values = mycol) + <br>  geom_smooth(data = df, <br>              aes(x = Energy, y = Lifetime, group = <span>"1"</span>, linetype = <span>"Smooth"</span>), <br>              method = <span>"lm"</span>, formula = y ~ poly(x, <span>2</span>), <br>              se = <span>FALSE</span>, color = <span>"black"</span>, size = <span>1</span>) +<br>  scale_linetype_manual(values = <span>"dashed"</span>, labels = <span>"theory"</span>)<br></code></pre><p data-tool="mdnice编辑器">在拟合曲线中，增加<code>aes(group = "1", linetype = "Smooth")</code>参数来确保所有数据被视为一个组并绘制一条曲线，同时指定线的类型用于展示到图例中。</p><p data-tool="mdnice编辑器">使用<code>scale_linetype_manual()</code>函数设置线条类型和标签，其中<code>values = "dashed"</code>指定了曲线的类型为虚线，<code>labels = "theory"</code>指定了图例的标签为 "theory"。</p><p><img data-galleryid="" data-imgfileid="100000171" data-ratio="0.7755960729312763" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAO4tw5iaFUXbWbuwG5Bd58XKLhYNqApK4SMyBGBf8G5TqMB1IKgwic85MA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="713" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAO4tw5iaFUXbWbuwG5Bd58XKLhYNqApK4SMyBGBf8G5TqMB1IKgwic85MA/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="mdnice编辑器"><span></span><span>绘图-均值及双向误差棒</span></h2><pre data-tool="mdnice编辑器"><code>ggplot() +<br>  geom_point(data = df, <br>             aes(x = Energy, y = Lifetime, <br>                 color = factor(Group, levels = c(<span>"7nm"</span>, <span>"9nm"</span>, <span>"13nm"</span>, <span>"16nm"</span>, <span>"23nm"</span>))), <br>             size = <span>4</span>, alpha = <span>0.8</span>) +<br>  guides(color = guide_legend(override.aes = list(alpha = <span>1</span>))) + <br>  scale_color_manual(values = mycol) + <br>  geom_smooth(data = df, <br>              aes(x = Energy, y = Lifetime, group = <span>"1"</span>, linetype = <span>"Smooth"</span>), <br>              method = <span>"lm"</span>, formula = y ~ poly(x, <span>2</span>), <br>              se = <span>FALSE</span>, color = <span>"black"</span>, size = <span>1</span>) +<br>  scale_linetype_manual(values = <span>"dashed"</span>, labels = <span>"theory"</span>) + <br>  geom_errorbar(data = subdf, aes(x = X,<br>                    ymin = (Y-Y_sd), <br>                    ymax = (Y+Y_sd)), <br>                width = <span>0.002</span>, size = <span>0.8</span>) +<br>  geom_errorbarh(data = subdf, aes(y = Y, <br>                     xmin = (X-X_sd), <br>                     xmax = (X+X_sd)), <br>                 height = <span>15</span>, size = <span>0.8</span>) +<br>  geom_point(data = subdf,aes(x = X, y = Y, shape = <span>"Points"</span>), cex = <span>7</span>) +<br>  scale_shape_manual(values = <span>18</span>, labels = <span>"mean"</span>)<br></code></pre><p data-tool="mdnice编辑器">使用<code>geom_errorbar()</code>和<code>geom_errorbarh()</code>函数分别绘制 X 轴和 Y 轴方向的误差棒，其中<code>width</code>和<code>height</code>这两个参数需要根据自己的数据进行调整。</p><p data-tool="mdnice编辑器">使用<code>geom_point()</code>函数绘制各组均值的点，跟拟合曲线一样，通过设置<code>aes(shape = "Points")</code>来指定点的类型用于展示到图例中，然后使用<code>scale_shape_manual()</code>函数设置点的类型和标签。</p><p><img data-galleryid="" data-imgfileid="100000172" data-ratio="0.7759103641456583" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOXRVzb19ehuNWslelMpmZG7Ux9qRqs7CIcBaY3HR85rUOF0icS0HJ4Pw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="714" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAOXRVzb19ehuNWslelMpmZG7Ux9qRqs7CIcBaY3HR85rUOF0icS0HJ4Pw/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="mdnice编辑器"><span></span><span>绘图-坐标轴设置</span></h2><pre data-tool="mdnice编辑器"><code>ggplot() +<br>  geom_point(data = df, <br>             aes(x = Energy, y = Lifetime, <br>                 color = factor(Group, levels = c(<span>"7nm"</span>, <span>"9nm"</span>, <span>"13nm"</span>, <span>"16nm"</span>, <span>"23nm"</span>))), <br>             size = <span>4</span>, alpha = <span>0.8</span>) +<br>  guides(color = guide_legend(override.aes = list(alpha = <span>1</span>))) + <br>  scale_color_manual(values = mycol) + <br>  geom_smooth(data = df, <br>              aes(x = Energy, y = Lifetime, group = <span>"1"</span>, linetype = <span>"Smooth"</span>), <br>              method = <span>"lm"</span>, formula = y ~ poly(x, <span>2</span>), <br>              se = <span>FALSE</span>, color = <span>"black"</span>, size = <span>1</span>) +<br>  scale_linetype_manual(values = <span>"dashed"</span>, labels = <span>"theory"</span>) + <br>  geom_errorbar(data = subdf, aes(x = X,<br>                    ymin = (Y-Y_sd), <br>                    ymax = (Y+Y_sd)), <br>                width = <span>0.002</span>, size = <span>0.8</span>) +<br>  geom_errorbarh(data = subdf, aes(y = Y, <br>                     xmin = (X-X_sd), <br>                     xmax = (X+X_sd)), <br>                 height = <span>15</span>, size = <span>0.8</span>) +<br>  geom_point(data = subdf,aes(x = X, y = Y, shape = <span>"Points"</span>), cex = <span>7</span>) +<br>  scale_shape_manual(values = <span>18</span>, labels = <span>"mean"</span>) +<br>  scale_x_continuous(guide = <span>"axis_minor"</span>,<br>                     breaks = seq(<span>2.32</span>, <span>2.44</span>, <span>0.02</span>), <br>                     sec.axis = dup_axis()) + <br>  scale_y_continuous(guide = <span>"axis_minor"</span>,<br>                     breaks = seq(<span>0</span>, <span>800</span>, <span>100</span>), <br>                     sec.axis = dup_axis()) + <br>  labs(x = <span>"Energy (eV)"</span>,y = <span>"Lifetime (ps)"</span>)+<br>  theme_bw(base_size = <span>18</span>) +<br>  theme(panel.grid = element_blank(),<br>        axis.text = element_text(color = <span>"black"</span>, size = <span>14</span>),<br>        legend.title = element_blank(),<br>        legend.margin = margin(),<br>        legend.text = element_text(size = <span>14</span>),<br>        legend.position = c(<span>0.02</span>, <span>0.98</span>), <br>        legend.justification = c(<span>0</span>,<span>1</span>),<br>        legend.spacing.y = unit(<span>0.1</span>, <span>"cm"</span>),<br>        axis.ticks.length.x.bottom = unit(<span>0.25</span>, <span>"cm"</span>),<br>        axis.ticks.length.y.left = unit(<span>0.25</span>, <span>"cm"</span>),<br>        axis.ticks.length.x.top = unit(-<span>0.25</span>,<span>"cm"</span>),<br>        axis.ticks.length.y.right = unit(-<span>0.25</span>,<span>"cm"</span>),<br>        ggh4x.axis.ticks.length.minor = rel(<span>0.4</span>),<br>        axis.text.x.top = element_blank(),<br>        axis.text.y.right = element_blank())<br></code></pre><p data-tool="mdnice编辑器">原图的坐标轴上面有小刻度线，而且四个方向都有刻度线，这里使用<code>ggh4x</code>包来实现，这个包的功能很强大，强烈推荐。</p><p data-tool="mdnice编辑器">在<code>scale_x/y_continuous()</code>函数中，添加<code>guide = "axis_minor"</code>参数就能在 X/Y 轴上添加小刻度线了，大/小刻度线的长度可以在<code>theme()</code>函数中，使用<code>axis.ticks.length</code>和<code>ggh4x.axis.ticks.length.minor</code>参数来设置。</p><p data-tool="mdnice编辑器">在<code>scale_x/y_continuous()</code>函数中，添加<code>sec.axis = dup_axis()</code>参数用于为上轴和右轴添加与下轴和左轴相同的刻度和标签。使用<code>theme()</code>函数中的<code>axis.ticks.length.x.top</code>和<code>axis.ticks.length.y.right</code>自定义上轴和右轴的刻度标签。</p><p><img data-galleryid="" data-imgfileid="100000173" data-ratio="0.8171262699564587" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAONRyHYQLQ3E6tcoI10VIaoS8B2qy6FEhulN14SH0C5QrcK31iaWibKXnA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="689" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLJKlunagss8URHMlZddWAONRyHYQLQ3E6tcoI10VIaoS8B2qy6FEhulN14SH0C5QrcK31iaWibKXnA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器"><br></p><p data-tool="mdnice编辑器"><span>获取以 <strong>RProject</strong> 形式保存的绘图代码、测试数据和注释文件，后台回复关键词: <em><strong>240619_dot_group_bierrorbar</strong></em></span></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/g9SKePDDacxj-VFMo4T38g",target="_blank" rel="noopener noreferrer">原文链接</a>
