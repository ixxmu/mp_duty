---
title: "不只是人类！340+物种的转录组表达矩阵Ensembl ID转换为symbol"
date: 2025-02-24T01:39:20Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
不只是人类！340+物种的转录组表达矩阵Ensembl ID转换为symbol by 生信星球
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013059" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013061" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"></span><span><span leaf=""> 今天是生信星球陪你的</span><span><strong><span leaf="">第1033天</span></strong></span></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013060" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png">   </span></section><section><blockquote><section><span><span leaf="">公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。</span></span><span><span leaf="">我的课程都是循环开课，</span></span><span><span leaf="">点进去咨询微信↓</span></span><span leaf=""><br></span></section><section><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247496614&amp;idx=1&amp;sn=4177354e87d394a022c3d410f482546a&amp;scene=21#wechat_redirect" textvalue="生信分‍析直播课程" data-itemshowtype="11" target="_blank" linktype="text" data-linktype="2">生信分析直播课程</a>(每月初开一期，下一期3月初)</span></section><section><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494919&amp;idx=2&amp;sn=967d8dcf0f9a22047ae0bd442b9d4ee6&amp;scene=21#wechat_redirect" textvalue="生信新手保护学‍习小组" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">生信新手保护学习小组</a>（每月两期）</span></section><section><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;chksm=fdfba53eca8c2c286522b2accc0d4cb9dda7cd9a5b36695e66d393abb5bff396d6bcaa4c9cb8&amp;scene=21#wechat_redirect" textvalue="单细胞陪伴学习小组内测完成，长期招生中" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">单细胞陪伴学习小组</a>（每月两期）</span></section></blockquote></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">0.背景知识</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">转录组数据，我们能拿到的表达矩阵通常是以Ensembl ID 为行名的，一长串，格式是ENS...。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">exp = read.csv(</span><span><span leaf="">'GSE280770_gene_count_matrix.csv.gz'</span></span><span leaf="">,row.names = </span><span><span leaf="">1</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">exp[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">]</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">##                    Control.1 Control.2 Control.3</span></span><span leaf=""><br></span><span><span leaf="">## ENSMUSG00000028180      6338      7525      6061</span></span><span leaf=""><br></span><span><span leaf="">## ENSMUSG00000028182       116       140       133</span></span><span leaf=""><br></span><span><span leaf="">## ENSMUSG00000028185         2         0         0</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">但后续的分析需要基因symbol，也就是CD14，PPBP这样的基因名字。</span></p><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">1.人、小鼠、大鼠有捷径</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">如何转换呢？这个需要10行左右的R语言代码，因为比较固定，且难度稍高，所以我写了一个函数，可以完成人类、小鼠、大鼠这三个物种的ID转换，我们可以:</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">library</span></span><span leaf="">(tinyarray)</span><span leaf=""><br></span><span leaf="">exp = trans_exp_new(exp,species = </span><span><span leaf="">'mouse'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">exp[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">]</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">##               Control.1 Control.2 Control.3 Hi.Glu.1</span></span><span leaf=""><br></span><span><span leaf="">## 4933401J01Rik         0         0         0        0</span></span><span leaf=""><br></span><span><span leaf="">## Gm26206               0         0         0        0</span></span><span leaf=""><br></span><span><span leaf="">## Xkr4                 38        56        79       88</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">species支持mouse，rat和human，human是默认值。</span></p><p data-tool="mdnice编辑器"><span leaf="">如果遇到这样的提示：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">exp = trans_exp_new(exp,species = </span><span><span leaf="">'mouse'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Loading required namespace: AnnoProbe</span><span leaf=""><br></span><span leaf="">0 rownames transformed after duplicate rows removed</span><span leaf=""><br></span><span leaf="">Warning message:</span><span leaf=""><br></span><span leaf="">In AnnoProbe::annoGene(rownames(exp), ID_type = </span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">, species = species) :</span><span leaf=""><br></span><span leaf="">  100% of input IDs are fail to annotate... </span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">有以下可能：</span></p><p data-tool="mdnice编辑器"><span leaf="">1.没有写species，默认是人，但数据不是人的。</span></p><p data-tool="mdnice编辑器"><span leaf="">2.表达矩阵的行名不是ENSEMBL id，而是其他的ID。</span></p><p data-tool="mdnice编辑器"><span leaf="">3.ENSEMBL不在行名上，在第一列上。</span></p><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">2.其他物种怎么办呢</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">稍微麻烦一点，需要从gtf文件中提取。ESEMBLid和gene symbol的对应关系，然后再转换。</span></p><p data-tool="mdnice编辑器"><span leaf="">首先我们了解一下什么是gtf：他是参考基因组注释文件，记录了每条染色体的每个位置是什么基因，以及这个基因的各种ID，其中就有我们需要的ESEMBLid和gene symbol。</span></p><p data-tool="mdnice编辑器"><span leaf="">去哪里下载呢？ESEMBL网站上面有342个物种(2025.2.23)的参考基因组注释。</span></p><p data-tool="mdnice编辑器"><span leaf="">在这个页面上可以看到最新版：</span></p><p data-tool="mdnice编辑器"><span leaf="">https://ftp.ensembl.org/pub/current_gtf/</span></p><p data-tool="mdnice编辑器"><span leaf="">例如牛牛，就可以找到牛的文件夹，找到gtf或者chr.gtf，下载它</span></p><p data-tool="mdnice编辑器"><span leaf="">我把物种挑出来，让kimi完成了翻译，整理出了目前所有的物种，翻动查看：</span></p><section><section><section><section data-cacheurl="" data-remoteid=""><section><section><p><span leaf="">Acanthochromis polyacanthus：多棘刺蝶鱼</span></p><p><span leaf="">Accipiter nisus：雀鹰</span></p><p><span leaf="">Ailuropoda melanoleuca：大熊猫</span></p><p><span leaf="">Amazona collaria：红领亚马逊鹦鹉</span></p><p><span leaf="">Amphilophus citrinellus：中美洲大头鱼</span></p><p><span leaf="">Amphiprion ocellaris：小丑鱼（橙色小丑鱼）</span></p><p><span leaf="">Amphiprion percula：大嘴小丑鱼</span></p><p><span leaf="">Anabas testudineus：攀鲈</span></p><p><span leaf="">Anas platyrhynchos：绿头鸭</span></p><p><span leaf="">Anas platyrhynchos platyrhynchos：绿头鸭（普通亚种）</span></p><p><span leaf="">Anas zonorhyncha：斑嘴鸭</span></p><p><span leaf="">Anolis carolinensis：绿安乐蜥</span></p><p><span leaf="">Anser brachyrhynchus：短嘴鹅</span></p><p><span leaf="">Anser cygnoides：天鹅鹅</span></p><p><span leaf="">Aotus nancymaae：南美夜猴</span></p><p><span leaf="">Apteryx haastii：哈斯特恐鸟</span></p><p><span leaf="">Apteryx owenii：欧文恐鸟</span></p><p><span leaf="">Apteryx rowi：罗威恐鸟</span></p><p><span leaf="">Aquila chrysaetos chrysaetos：金雕</span></p><p><span leaf="">Astatotilapia calliptera：花丽丽鱼</span></p><p><span leaf="">Astyanax mexicanus：墨西哥脂鲤</span></p><p><span leaf="">Astyanax mexicanus pachon：墨西哥脂鲤（帕乔恩洞穴亚种）</span></p><p><span leaf="">Athene cunicularia：穴小鸮</span></p><p><span leaf="">Balaenoptera musculus：蓝鲸</span></p><p><span leaf="">Betta splendens：斗鱼</span></p><p><span leaf="">Bison bison bison：美洲野牛</span></p><p><span leaf="">Bos grunniens：牦牛</span></p><p><span leaf="">Bos indicus hybrid：瘤牛杂交种</span></p><p><span leaf="">Bos mutus：野牦牛</span></p><p><span leaf="">Bos taurus：普通牛</span></p><p><span leaf="">Bos taurus hybrid：普通牛杂交种</span></p><p><span leaf="">Bubo bubo：雕鸮</span></p><p><span leaf="">Buteo japonicus：日本鸢</span></p><p><span leaf="">Caenorhabditis elegans：秀丽隐杆线虫</span></p><p><span leaf="">Cairina moschata domestica：家养麝香鸭</span></p><p><span leaf="">Calidris pugnax：小滨鹬</span></p><p><span leaf="">Calidris pygmaea：小杓鹬</span></p><p><span leaf="">Callithrix jacchus：狨猴</span></p><p><span leaf="">Callorhinchus milii：银鲛</span></p><p><span leaf="">Camarhynchus parvulus：小地雀</span></p><p><span leaf="">Camelus dromedarius：单峰驼</span></p><p><span leaf="">Canis lupus dingo：澳洲野犬</span></p><p><span leaf="">Canis lupus familiaris：家犬</span></p><p><span leaf="">Canis lupus familiarisbasenji：巴仙吉犬</span></p><p><span leaf="">Canis lupus familiarisboxer：拳师犬</span></p><p><span leaf="">Canis lupus familiarisgreatdane：大丹犬</span></p><p><span leaf="">Canis lupus familiarisgsd：德国牧羊犬</span></p><p><span leaf="">Capra hircus：山羊</span></p><p><span leaf="">Capra hircus blackbengal：黑孟加拉山羊</span></p><p><span leaf="">Capra hircus gca015443085v1：山羊（基因组版本1）</span></p><p><span leaf="">Capra hircus gca026652205v1：山羊（基因组版本2）</span></p><p><span leaf="">Carassius auratus：金鱼</span></p><p><span leaf="">Carlito syrichta：菲律宾眼镜猴</span></p><p><span leaf="">Castor canadensis：北美河狸</span></p><p><span leaf="">Catagonus wagneri：瓦格纳角豚</span></p><p><span leaf="">Catharus ustulatus：灰猫鸫</span></p><p><span leaf="">Cavia aperea：巴西豚鼠</span></p><p><span leaf="">Cavia porcellus：豚鼠</span></p><p><span leaf="">Cebus imitator：卷尾猴</span></p><p><span leaf="">Cercocebus atys：白臀猴</span></p><p><span leaf="">Cervus hanglu yarkandensis：新疆马鹿</span></p><p><span leaf="">Chelonoidis abingdonii：平塔岛象龟</span></p><p><span leaf="">Chelydra serpentina：美洲鳖</span></p><p><span leaf="">Chinchilla lanigera：长毛豚鼠</span></p><p><span leaf="">Chlorocebus sabaeus：绿猴</span></p><p><span leaf="">Choloepus hoffmanni：霍夫曼二趾树懒</span></p><p><span leaf="">Chrysemys picta bellii：中西部彩龟</span></p><p><span leaf="">Chrysolophus pictus：金鱼（红冠金鱼）</span></p><p><span leaf="">Ciona intestinalis：海鞘</span></p><p><span leaf="">Ciona savignyi：萨维尼海鞘</span></p><p><span leaf="">Clupea harengus：鲱鱼</span></p><p><span leaf="">Colobus angolensis palliatus：安哥拉疣猴</span></p><p><span leaf="">Corvus moneduloides：新喀鸦</span></p><p><span leaf="">Cottoperca gobio：欧亚狗鱼</span></p><p><span leaf="">Coturnix japonica：日本鹌鹑</span></p><p><span leaf="">Cricetulus griseus chok1gshd：灰仓鼠（CHOK1GSHD品系）</span></p><p><span leaf="">Cricetulus griseus crigri：灰仓鼠（C57BL/6J品系）</span></p><p><span leaf="">Cricetulus griseus picr：灰仓鼠（PICR品系）</span></p><p><span leaf="">Crocodylus porosus：咸水鳄</span></p><p><span leaf="">Cyanistes caeruleus：蓝山雀</span></p><p><span leaf="">Cyclopterus lumpus：大西洋狼鱼</span></p><p><span leaf="">Cynoglossus semilaevis：半滑舌鳎</span></p><p><span leaf="">Cyprinodon variegatus：多色鳉</span></p><p><span leaf="">Cyprinus carpio carpio：普通鲤鱼</span></p><p><span leaf="">Cyprinus carpio germanmirror：德国镜鲤</span></p><p><span leaf="">Cyprinus carpio hebaored：红鲤鱼</span></p><p><span leaf="">Cyprinus carpio huanghe：黄河鲤鱼</span></p><p><span leaf="">Danio rerio：斑马鱼</span></p><p><span leaf="">Dasypus novemcinctus：九带犰狳</span></p><p><span leaf="">Delphinapterus leucas：白鲸</span></p><p><span leaf="">Denticeps clupeoides：似鲱鱼</span></p><p><span leaf="">Dicentrarchus labrax：欧洲鲈鱼</span></p><p><span leaf="">Dipodomys ordii：奥尔德鼠</span></p><p><span leaf="">Dromaius novaehollandiae：鸸鹋</span></p><p><span leaf="">Drosophila melanogaster：黑腹果蝇</span></p><p><span leaf="">Echeneis naucrates：船stanbul吸盘鱼</span></p><p><span leaf="">Echinops telfairi：塞舌尔毛象龟</span></p><p><span leaf="">Electrophorus electricus：电鳗</span></p><p><span leaf="">Eptatretus burgeri：布尔氏七鳃鳗</span></p><p><span leaf="">Equus asinus：驴</span></p><p><span leaf="">Equus caballus：马</span></p><p><span leaf="">Erinaceus europaeus：欧洲刺猬</span></p><p><span leaf="">Erpetoichthys calabaricus：卡拉巴蛇鱼</span></p><p><span leaf="">Erythrura gouldiae：红尾草雀</span></p><p><span leaf="">Esox lucius：北方狗鱼</span></p><p><span leaf="">Falco tinnunculus：隼</span></p><p><span leaf="">Felis catus：家猫</span></p><p><span leaf="">Ficedula albicollis：白尾鹟</span></p><p><span leaf="">Fukomys damarensis：达马拉鼹鼠</span></p><p><span leaf="">Fundulus heteroclitus：大西洋鳉</span></p><p><span leaf="">Gadus morhua：大西洋鳕鱼</span></p><p><span leaf="">Gadus morhua gca010882105v1：大西洋鳕鱼（基因组版本1）</span></p><p><span leaf="">Gallus gallus：家鸡</span></p><p><span leaf="">Gallus gallus gca000002315v5：家鸡（基因组版本5）</span></p><p><span leaf="">Gallus gallus gca016700215v2：家鸡（基因组版本2）</span></p><p><span leaf="">Gambusia affinis：短尾鳉</span></p><p><span leaf="">Gasterosteus aculeatus：三刺鱼</span></p><p><span leaf="">Gasterosteus aculeatus gca006229185v1：三刺鱼（基因组版本1）</span></p><p><span leaf="">Gasterosteus aculeatus gca006232265v1：三刺鱼（基因组版本2）</span></p><p><span leaf="">Gasterosteus aculeatus gca006232285v1：三刺鱼（基因组版本3）</span></p><p><span leaf="">Geospiza fortis：中地雀</span></p><p><span leaf="">Gopherus agassizii：阿加西龟</span></p><p><span leaf="">Gopherus evgoodei：伊万龟</span></p><p><span leaf="">Gorilla gorilla：西部低地大猩猩</span></p><p><span leaf="">Gouania willdenowi：威登氏藤</span></p><p><span leaf="">Haplochromis burtoni：伯顿丽鱼</span></p><p><span leaf="">Heterocephalus glaber female：裸鼹鼠（雌性）</span></p><p><span leaf="">Heterocephalus glaber male：裸鼹鼠（雄性）</span></p><p><span leaf="">Hippocampus comes：虎尾海马</span></p><p><span leaf="">Homo sapiens：智人</span></p><p><span leaf="">Hucho hucho：大西洋鲑</span></p><p><span leaf="">Ictalurus punctatus：斑点叉尾鮰</span></p><p><span leaf="">Ictidomys tridecemlineatus：十三条纹地松鼠</span></p><p><span leaf="">Jaculus jaculus：长尾跳鼠</span></p><p><span leaf="">Junco hyemalis：暗眼雀</span></p><p><span leaf="">Kryptolebias marmoratus：斑点鳉</span></p><p><span leaf="">Labrus bergylta：大西洋海鲈</span></p><p><span leaf="">Larimichthys crocea：大黄鱼</span></p><p><span leaf="">Lates calcarifer：非洲鲈鱼</span></p><p><span leaf="">Laticauda laticaudata：平尾海蛇</span></p><p><span leaf="">Latimeria chalumnae：西印度洋腔棘鱼</span></p><p><span leaf="">Lepidothrix coronata：冠羽雀</span></p><p><span leaf="">Lepisosteus oculatus：长吻雀鳝</span></p><p><span leaf="">Leptobrachium leishanense：荔波髭蟾</span></p><p><span leaf="">Lonchura striata domestica：家养斑文鸟</span></p><p><span leaf="">Loxodonta africana：非洲象</span></p><p><span leaf="">Lynx canadensis：加拿大猞猁</span></p><p><span leaf="">Macaca fascicularis：猕猴</span></p><p><span leaf="">Macaca mulatta：恒河猴</span></p><p><span leaf="">Macaca nemestrina：食蟹猕猴</span></p><p><span leaf="">Malurus cyaneus samueli：蓝翅琴鸟</span></p><p><span leaf="">Manacus vitellinus：黄腹拟雀</span></p><p><span leaf="">Mandrillus leucophaeus：白鼻长尾猴</span></p><p><span leaf="">Marmota marmota marmota：阿尔卑斯土拨鼠</span></p><p><span leaf="">Mastacembelus armatus：非洲鳗</span></p><p><span leaf="">Maylandia zebra：斑马神仙</span></p><p><span leaf="">Meleagris gallopavo：火鸡</span></p><p><span leaf="">Melopsittacus undulatus：虎皮鹦鹉</span></p><p><span leaf="">Meriones unguiculatus：蒙古沙鼠</span></p><p><span leaf="">Mesocricetus auratus：金黄仓鼠</span></p><p><span leaf="">Microcebus murinus：小鼠狐猴</span></p><p><span leaf="">Microtus ochrogaster：草原田鼠</span></p><p><span leaf="">Mola mola：海洋太阳鱼</span></p><p><span leaf="">Monodelphis domestica：短尾负鼠</span></p><p><span leaf="">Monodon monoceros：独角鲸</span></p><p><span leaf="">Monopterus albus：白鳝</span></p><p><span leaf="">Moschus moschiferus：麝香鹿</span></p><p><span leaf="">Mus caroli：卡罗里鼠</span></p><p><span leaf="">Mus musculus：小鼠</span></p><p><span leaf="">Mus musculus 129s1svimj：129S1/SvImJ品系小鼠</span></p><p><span leaf="">Mus musculus aj：AJ品系小鼠</span></p><p><span leaf="">Mus musculus akrj：AKR/J品系小鼠</span></p><p><span leaf="">Mus musculus balbcj：BALB/cJ品系小鼠</span></p><p><span leaf="">Mus musculus c3hhej：C3H/HeJ品系小鼠</span></p><p><span leaf="">Mus musculus c57bl6nj：C57BL/6NJ品系小鼠</span></p><p><span leaf="">Mus musculus casteij：CAST/EiJ品系小鼠</span></p><p><span leaf="">Mus musculus cbaj：CBA/J品系小鼠</span></p><p><span leaf="">Mus musculus dba2j：DBA/2J品系小鼠</span></p><p><span leaf="">Mus musculus fvbnj：FVB/NJ品系小鼠</span></p><p><span leaf="">Mus musculus lpj：LP/J品系小鼠</span></p><p><span leaf="">Mus musculus nodshiltj：NOD/ShiLtJ品系小鼠</span></p><p><span leaf="">Mus musculus nzohlltj：NZO/HlLtJ品系小鼠</span></p><p><span leaf="">Mus musculus pwkphj：PWK/PhJ品系小鼠</span></p><p><span leaf="">Mus musculus wsbeij：WSB/EiJ品系小鼠</span></p><p><span leaf="">Mus pahari：帕哈里鼠</span></p><p><span leaf="">Mus spicilegus：草堆鼠</span></p><p><span leaf="">Mus spretus：西班牙鼠</span></p><p><span leaf="">Mustela putorius furo：家养鼬</span></p><p><span leaf="">Myotis lucifugus：北美蝙蝠</span></p><p><span leaf="">Myripristis murdjan：红鳍笛鲷</span></p><p><span leaf="">Naja naja：印度眼镜蛇</span></p><p><span leaf="">Nannospalax galili：加利利鼠</span></p><p><span leaf="">Neogobius melanostomus：黑嘴虾虎鱼</span></p><p><span leaf="">Neolamprologus brichardi：布里查德丽鱼</span></p><p><span leaf="">Neovison vison：美洲貂</span></p><p><span leaf="">Nomascus leucogenys：白颊长臂猿</span></p><p><span leaf="">Notamacropus eugenii：欧文袋鼠</span></p><p><span leaf="">Notechis scutatus：东部虎蛇</span></p><p><span leaf="">Nothobranchius furzeri：福氏鳉</span></p><p><span leaf="">Nothoprocta perdicaria：秘鲁地雀</span></p><p><span leaf="">Numida meleagris：珍珠鸡</span></p><p><span leaf="">Ochotona princeps：北美鼠兔</span></p><p><span leaf="">Octodon degus：草原鼠</span></p><p><span leaf="">Oncorhynchus kisutch：红鲑</span></p><p><span leaf="">Oncorhynchus mykiss：虹鳟</span></p><p><span leaf="">Oncorhynchus tshawytscha：帝王鲑</span></p><p><span leaf="">Oreochromis aureus：金口丽鱼</span></p><p><span leaf="">Oreochromis niloticus：尼罗罗非鱼</span></p><p><span leaf="">Ornithorhynchus anatinus：鸭嘴兽</span></p><p><span leaf="">Oryctolagus cuniculus：家兔</span></p><p><span leaf="">Oryzias javanicus：爪哇稻鱼</span></p><p><span leaf="">Oryzias latipes：日本稻鱼</span></p><p><span leaf="">Oryzias latipes hni：日本稻鱼（HNI品系）</span></p><p><span leaf="">Oryzias latipes hsok：日本稻鱼（HSOK品系）</span></p><p><span leaf="">Oryzias melastigma：黑斑稻鱼</span></p><p><span leaf="">Oryzias sinensis：中华稻鱼</span></p><p><span leaf="">Otolemur garnettii：加内特夜猴</span></p><p><span leaf="">Otus sunia：太阳角鸮</span></p><p><span leaf="">Ovis aries：绵羊</span></p><p><span leaf="">Ovis aries gca011170295v1：绵羊（基因组版本1）</span></p><p><span leaf="">Ovis aries gca018804185v1：绵羊（基因组版本2）</span></p><p><span leaf="">Ovis aries gca022416685v1：绵羊（基因组版本3）</span></p><p><span leaf="">Ovis aries gca022416695v1：绵羊（基因组版本4）</span></p><p><span leaf="">Ovis aries gca022416915v1：绵羊（基因组版本5）</span></p><p><span leaf="">Ovis aries gca022432825v1：绵羊（基因组版本6）</span></p><p><span leaf="">Ovis aries gca022432835v1：绵羊（基因组版本7）</span></p><p><span leaf="">Ovis aries gca024222175v1：绵羊（基因组版本8）</span></p><p><span leaf="">Ovis aries rambouillet：拉姆布伊莱特绵羊</span></p><p><span leaf="">Pan paniscus：倭黑猩猩</span></p><p><span leaf="">Pan troglodytes：黑猩猩</span></p><p><span leaf="">Panthera leo：非洲狮</span></p><p><span leaf="">Panthera pardus：豹</span></p><p><span leaf="">Panthera tigris altaica：东北虎</span></p><p><span leaf="">Papio anubis：狒狒</span></p><p><span leaf="">Parambassis ranga：兰加鱼</span></p><p><span leaf="">Paramormyrops kingsleyae：金斯利电鱼</span></p><p><span leaf="">Parus major：大山雀</span></p><p><span leaf="">Pavo cristatus：孔雀</span></p><p><span leaf="">Pelodiscus sinensis：中华鳖</span></p><p><span leaf="">Pelusios castaneus：栗色侧颈龟</span></p><p><span leaf="">Periophthalmus magnuspinnatus：大鳍弹涂鱼</span></p><p><span leaf="">Peromyscus maniculatus bairdii：贝氏鼠</span></p><p><span leaf="">Petromyzon marinus：海鳗</span></p><p><span leaf="">Phascolarctos cinereus：考拉</span></p><p><span leaf="">Phasianus colchicus：环颈雉</span></p><p><span leaf="">Phocoena sinus：江豚</span></p><p><span leaf="">Physeter catodon：抹香鲸</span></p><p><span leaf="">Piliocolobus tephrosceles：灰头疣猴</span></p><p><span leaf="">Podarcis muralis：壁蜥</span></p><p><span leaf="">Poecilia formosa：墨西哥丽鳉</span></p><p><span leaf="">Poecilia latipinna：帆鳍鳉</span></p><p><span leaf="">Poecilia mexicana：墨西哥鳉</span></p><p><span leaf="">Poecilia reticulata：孔雀鱼</span></p><p><span leaf="">Pogona vitticeps：鬃狮蜥</span></p><p><span leaf="">Pongo abelii：苏门答腊猩猩</span></p><p><span leaf="">Procavia capensis：岩蹄兔</span></p><p><span leaf="">Prolemur simus：小指狐猴</span></p><p><span leaf="">Propithecus coquereli：白臀狐猴</span></p><p><span leaf="">Pseudonaja textilis：东部棕蛇</span></p><p><span leaf="">Pteropus vampyrus：大果蝠</span></p><p><span leaf="">Pundamilia nyererei：尼雷尔丽鱼</span></p><p><span leaf="">Pygocentrus nattereri：红腹锯脂鲤</span></p><p><span leaf="">Rattus norvegicus：挪威鼠</span></p><p><span leaf="">Rattus norvegicus shrspbbbutx：SHRSP品系大鼠</span></p><p><span leaf="">Rattus norvegicus shrutx：SHR品系大鼠</span></p><p><span leaf="">Rattus norvegicus wkybbb：WKY品系大鼠</span></p><p><span leaf="">Rhinolophus ferrumequinum：大马蹄蝠</span></p><p><span leaf="">Rhinopithecus bieti：滇金丝猴</span></p><p><span leaf="">Rhinopithecus roxellana：川金丝猴</span></p><p><span leaf="">Saccharomyces cerevisiae：酿酒酵母</span></p><p><span leaf="">Saimiri boliviensis boliviensis：玻利维亚卷尾猴</span></p><p><span leaf="">Salarias fasciatus：带纹雀鲷</span></p><p><span leaf="">Salmo salar：大西洋鲑</span></p><p><span leaf="">Salmo salar gca021399835v1：大西洋鲑（基因组版本1）</span></p><p><span leaf="">Salmo salar gca923944775v1：大西洋鲑（基因组版本2）</span></p><p><span leaf="">Salmo salar gca931346935v2：大西洋鲑（基因组版本3）</span></p><p><span leaf="">Salmo trutta：褐鲑</span></p><p><span leaf="">Salvator merianae：红耳龟</span></p><p><span leaf="">Sander lucioperca：欧亚狗鱼</span></p><p><span leaf="">Sarcophilus harrisii：塔斯马尼亚恶魔</span></p><p><span leaf="">Sciurus vulgaris：欧亚红松鼠</span></p><p><span leaf="">Scleropages formosus：金龙鱼</span></p><p><span leaf="">Scophthalmus maximus：大菱鲆</span></p><p><span leaf="">Serinus canaria：金丝雀</span></p><p><span leaf="">Seriola dumerili：大西洋黄尾鱼</span></p><p><span leaf="">Seriola lalandi dorsalis：黄尾鱼</span></p><p><span leaf="">Sinocyclocheilus anshuiensis：安顺金线鲃</span></p><p><span leaf="">Sinocyclocheilus grahami：格拉汉姆金线鲃</span></p><p><span leaf="">Sinocyclocheilus rhinocerous：犀牛金线鲃</span></p><p><span leaf="">Sorex araneus：北欧鼩鼱</span></p><p><span leaf="">Sparus aurata：欧洲海鲈</span></p><p><span leaf="">Spermophilus dauricus：达乌尔旱獭</span></p><p><span leaf="">Sphaeramia orbicularis：圆尾雀鲷</span></p><p><span leaf="">Sphenodon punctatus：喙头蜥</span></p><p><span leaf="">Stachyris ruficeps：红头雀</span></p><p><span leaf="">Stegastes partitus：大西洋雀鲷</span></p><p><span leaf="">Strigops habroptila：鸮鹦鹉</span></p><p><span leaf="">Strix occidentalis caurina：西部猫头鹰</span></p><p><span leaf="">Struthio camelus australis：非洲鸵鸟</span></p><p><span leaf="">Suricata suricatta：蜜獾</span></p><p><span leaf="">Sus scrofa：野猪</span></p><p><span leaf="">Sus scrofa bamei：巴美猪</span></p><p><span leaf="">Sus scrofa berkshire：伯克夏猪</span></p><p><span leaf="">Sus scrofa gca007644095v1：猪（基因组版本1）</span></p><p><span leaf="">Sus scrofa gca015776825v1：猪（基因组版本2）</span></p><p><span leaf="">Sus scrofa gca017957985v1：猪（基因组版本3）</span></p><p><span leaf="">Sus scrofa gca018555405v1：猪（基因组版本4）</span></p><p><span leaf="">Sus scrofa gca019290145v1：猪（基因组版本5）</span></p><p><span leaf="">Sus scrofa gca020567905v1：猪（基因组版本6）</span></p><p><span leaf="">Sus scrofa gca021656055v1：猪（基因组版本7）</span></p><p><span leaf="">Sus scrofa gca024718415v1：猪（基因组版本8）</span></p><p><span leaf="">Sus scrofa hampshire：汉普夏猪</span></p><p><span leaf="">Sus scrofa jinhua：金华猪</span></p><p><span leaf="">Sus scrofa landrace：兰德瑞斯猪</span></p><p><span leaf="">Sus scrofa largewhite：大白猪</span></p><p><span leaf="">Sus scrofa meishan：梅山猪</span></p><p><span leaf="">Sus scrofa pietrain：皮特兰猪</span></p><p><span leaf="">Sus scrofa rongchang：荣昌猪</span></p><p><span leaf="">Sus scrofa tibetan：藏猪</span></p><p><span leaf="">Sus scrofa usmarc：USMARC猪</span></p><p><span leaf="">Sus scrofa wuzhishan：五指山猪</span></p><p><span leaf="">Taeniopygia guttata：斑胸草雀</span></p><p><span leaf="">Takifugu rubripes：红鳍东方鲀</span></p><p><span leaf="">Terrapene carolina triunguis：三趾箱龟</span></p><p><span leaf="">Tetraodon nigroviridis：绿鳍四齿鲀</span></p><p><span leaf="">Theropithecus gelada：格拉达狒狒</span></p><p><span leaf="">Tupaia belangeri：白足树鼩</span></p><p><span leaf="">Tursiops truncatus：宽吻海豚</span></p><p><span leaf="">Urocitellus parryii：帕里氏土拨鼠</span></p><p><span leaf="">Ursus americanus：美洲黑熊</span></p><p><span leaf="">Ursus maritimus：北极熊</span></p><p><span leaf="">Ursus thibetanus thibetanus：喜马拉雅棕熊</span></p><p><span leaf="">Varanus komodoensis：科莫多龙</span></p><p><span leaf="">Vicugna pacos：羊驼</span></p><p><span leaf="">Vombatus ursinus：裸鼻袋熊</span></p><p><span leaf="">Vulpes vulpes：赤狐</span></p><p><span leaf="">Xenopus tropicalis：热带爪蟾</span></p><p><span leaf="">Xiphophorus couchianus：库奇鳉</span></p><p><span leaf="">Xiphophorus maculatus：斑马鳉</span></p><p><span leaf="">Zalophus californianus：加州海狮</span></p><p><span leaf="">Zonotrichia albicollis：白喉带鹀</span></p><p><span leaf="">Zosterops lateralis melanops：黑眼斑背雀</span></p></section></section></section></section></section></section><p data-tool="mdnice编辑器"><span leaf="">上下翻动可以查看全部物种。如有翻译不对的，还请指正。</span></p><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">3.从gtf文件中提取id对应关系</span></span><span><span leaf=""><br></span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(rtracklayer)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(dplyr)</span><span leaf=""><br></span><span leaf="">gtf &lt;- import(</span><span><span leaf="">'Bos_taurus.ARS-UCD1.3.113.chr.gtf.gz'</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">as.numeric(object.size(gtf)/(</span><span><span leaf="">1024</span></span><span leaf="">^</span><span><span leaf="">2</span></span><span leaf="">))</span><span><span leaf="">#大小MB</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">## [1] 299.566</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">gtf = as.data.frame(gtf)</span><span leaf=""><br></span><span leaf="">colnames(gtf)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">##  [1] "seqnames"                     "start"                       </span></span><span leaf=""><br></span><span><span leaf="">##  [3] "end"                          "width"                       </span></span><span leaf=""><br></span><span><span leaf="">##  [5] "strand"                       "source"                      </span></span><span leaf=""><br></span><span><span leaf="">##  [7] "type"                         "score"                       </span></span><span leaf=""><br></span><span><span leaf="">##  [9] "phase"                        "gene_id"                     </span></span><span leaf=""><br></span><span><span leaf="">## [11] "gene_version"                 "gene_name"                   </span></span><span leaf=""><br></span><span><span leaf="">## [13] "gene_source"                  "gene_biotype"                </span></span><span leaf=""><br></span><span><span leaf="">## [15] "transcript_id"                "transcript_version"          </span></span><span leaf=""><br></span><span><span leaf="">## [17] "transcript_name"              "transcript_source"           </span></span><span leaf=""><br></span><span><span leaf="">## [19] "transcript_biotype"           "tag"                         </span></span><span leaf=""><br></span><span><span leaf="">## [21] "exon_number"                  "exon_id"                     </span></span><span leaf=""><br></span><span><span leaf="">## [23] "exon_version"                 "protein_id"                  </span></span><span leaf=""><br></span><span><span leaf="">## [25] "protein_version"              "projection_parent_transcript"</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">ids = gtf[,c(</span><span><span leaf="">'gene_id'</span></span><span leaf="">,</span><span><span leaf="">'gene_name'</span></span><span leaf="">)]</span><span leaf=""><br></span><span leaf="">ids = distinct_all(ids)</span><span leaf=""><br></span><span leaf="">ids = na.omit(ids)</span><span leaf=""><br></span><span leaf="">nrow(ids)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">## [1] 19953</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">head(ids)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">##              gene_id gene_name</span></span><span leaf=""><br></span><span><span leaf="">## 1 ENSBTAG00000012908    HSPA13</span></span><span leaf=""><br></span><span><span leaf="">## 2 ENSBTAG00000054574    ABCC13</span></span><span leaf=""><br></span><span><span leaf="">## 4 ENSBTAG00000019314     USP25</span></span><span leaf=""><br></span><span><span leaf="">## 6 ENSBTAG00000034347     RBM11</span></span><span leaf=""><br></span><span><span leaf="">## 7 ENSBTAG00000038512      LIPI</span></span><span leaf=""><br></span><span><span leaf="">## 8 ENSBTAG00000010462     ROBO2</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf=""><br></span></span><span><span leaf="">4.转换ID</span></span><span><span leaf=""><br></span></span></h3><p data-tool="mdnice编辑器"><span leaf="">转录组数据的表达矩阵都是在GEO页面最后的补充资料里。</span></p><p data-tool="mdnice编辑器"><span leaf="">下载并读取它，不同的文件读取方式是不相同的。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span leaf="">exp = read.delim(</span><span><span leaf="">'GSE153242_counts.txt.gz'</span></span><span leaf="">,row.names = </span><span><span leaf="">1</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(rownames(exp) %</span><span><span leaf="">in</span></span><span leaf="">% ids$gene_id)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">## </span></span><span leaf=""><br></span><span><span leaf="">## FALSE  TRUE </span></span><span leaf=""><br></span><span><span leaf="">##  9272 18335</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">library</span></span><span leaf="">(tinyarray)</span><span leaf=""><br></span><span leaf="">exp = trans_array(exp,ids,from = </span><span><span leaf="">'gene_id'</span></span><span leaf="">,to = </span><span><span leaf="">'gene_name'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">exp[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">]</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""><span leaf=""><br></span></span><code><span><span leaf="">##          S1   S2   S3   S4</span></span><span leaf=""><br></span><span><span leaf="">## HSPA13 1205 1987 1317 1020</span></span><span leaf=""><br></span><span><span leaf="">## ABCC13   35   41   33   34</span></span><span leaf=""><br></span><span><span leaf="">## USP25  2005 1933 2068 2116</span></span><span leaf=""><br></span><span><span leaf="">## RBM11    45   20   24   14</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">这样就完成啦！</span></p><p data-tool="mdnice编辑器"><span leaf="">trans_array函数可以帮你完成id转换，from和to是从哪一列的ID转换为哪一列的ID。</span></p><p data-tool="mdnice编辑器"><span leaf="">在转换时，遇到一个gene symbol对应多个</span><span><span leaf="">Ensembl</span></span><span leaf=""> id的情况，是直接去重复的，这个无所谓，就千把的基因是这样的，没必要求平均值或者纠结取舍，不同方法差别甚小。</span></p></section><p><span leaf=""><br></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qUBTsvIojs_BsTMCHcSJZQ",target="_blank" rel="noopener noreferrer">原文链接</a>
