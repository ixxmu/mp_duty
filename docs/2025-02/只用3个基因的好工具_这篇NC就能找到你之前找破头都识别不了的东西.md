---
title: "åªç”¨3ä¸ªåŸºå› çš„å¥½å·¥å…·ï¼Œè¿™ç¯‡NCå°±èƒ½æ‰¾åˆ°ä½ ä¹‹å‰æ‰¾ç ´å¤´éƒ½è¯†åˆ«ä¸äº†çš„ä¸œè¥¿"
date: 2025-02-06T04:11:29Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡èµ„æ–™å…±äº«"
]
categories: ["Acdemic"]
---
åªç”¨3ä¸ªåŸºå› çš„å¥½å·¥å…·ï¼Œè¿™ç¯‡NCå°±èƒ½æ‰¾åˆ°ä½ ä¹‹å‰æ‰¾ç ´å¤´éƒ½è¯†åˆ«ä¸äº†çš„ä¸œè¥¿ by ç”Ÿä¿¡èµ„æ–™å…±äº«
------
<div><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡èµ„æ–™å…±äº«" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcDJiaFUU498wO4fW4vYADDWt9u9mfiakXeTS861ShkrLChr2M6B8eiaDIicyIbw7tjgjOz9npdrGAZuA/0?wx_fmt=png" data-signature="åŒ—äº¬å¤§å­¦åœ¨è¯»åšå£«ç”Ÿï¼Œæ—¥å¸¸åˆ†äº«ç”Ÿä¿¡èµ„æ–™ï¼Œä¸»è¦å…³æ³¨é¢†åŸŸï¼šå•ç»†èƒå’Œç©ºé—´æµ‹åºã€å¤šç»„å­¦åˆ†æã€å®åŸºå› ç»„ã€ç—…ç†ç»„å­¦ã€å½±åƒç»„å­¦ç­‰ç”Ÿç‰©ä¿¡æ¯å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ å†…å®¹ğŸŒ¬æ¬¢è¿å¤§å®¶äº¤æµå­¦ä¹ " data-id="Mzk0MjcyMDk3Mg==" data-is_biz_ban="0" data-service_type="1"></mp-common-profile></section><section><span leaf=""><span textstyle="">æ˜¨å¤©çš„NCï¼Œéå¸¸æœ‰è¶£ï¼Œæœªæ¥è‚¯å®šèƒ½ç”¨åˆ°çš„å·¥å…·</span></span></section><section><span><span leaf=""><span textstyle="">â€œMANAscoreâ€ç®—æ³•ï¼Œä»…é€šè¿‡åˆ†æä¸‰ä¸ªå…³é”®åŸºå› çš„è¡¨è¾¾æ°´å¹³ï¼Œå³å¯é«˜æ•ˆè¯†åˆ«è‚¿ç˜¤å¾®ç¯å¢ƒä¸­å…·æœ‰æŠ—è‚¿ç˜¤æ´»æ€§çš„å…ç–«ç»†èƒ</span></span></span></section><section><span><span leaf=""><br></span></span><ul><li><section nodeleaf=""><img data-imgfileid="100000347" data-ratio="0.38796296296296295" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsyKZAIg3yXnLoNhxzk7mkea1ZNZvyGvkmnwXZxSRCMTdWLtdMdh2oHkA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsyKZAIg3yXnLoNhxzk7mkea1ZNZvyGvkmnwXZxSRCMTdWLtdMdh2oHkA/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsy8NS8M1aqLH4iaYX7nTVgzpQDLAu18ziblmiaBJToowNlwyZVV8y3QQluQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.3055555555555556" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100000350" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsy8NS8M1aqLH4iaYX7nTVgzpQDLAu18ziblmiaBJToowNlwyZVV8y3QQluQ/640?wx_fmt=png&amp;from=appmsg"></section><p><strong><span><span leaf=""><br></span></span></strong></p></li><li><section nodeleaf=""><img data-imgfileid="100000349" data-ratio="0.6351851851851852" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsyQ5h0Mny5B035TcP1YTstsKqoEd2RV2RdnSyOFcAOia0L4cv5ADUtJNA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZcdzgkNQzGU2LWE9oVgQNsyQ5h0Mny5B035TcP1YTstsKqoEd2RV2RdnSyOFcAOia0L4cv5ADUtJNA/640?wx_fmt=png&amp;from=appmsg"></section><p><strong><span><span leaf=""><br></span></span></strong></p></li><li><p><strong><span leaf=""><span textstyle="">CXCL13</span></span></strong><span leaf=""><span textstyle="">ï¼ˆè¶‹åŒ–å› å­ï¼Œæ ‡å¿—Tç»†èƒæ´»åŒ–ï¼‰</span></span></p></li><li><p><strong><span leaf=""><span textstyle="">ENTPD1ï¼ˆCD39ï¼‰</span></span></strong><span leaf=""><span textstyle="">ï¼ˆä»£è°¢é…¶ï¼Œä¸Tç»†èƒè€—ç«­ç›¸å…³ï¼‰</span></span></p></li><li><p><strong><span leaf=""><span textstyle="">IL7R</span></span></strong><span leaf=""><span textstyle="">ï¼ˆç™½ä»‹ç´ 7å—ä½“ï¼Œä½è¡¨è¾¾æç¤ºè®°å¿†åŠŸèƒ½å‡å¼±ï¼‰</span></span></p></li></ul><span leaf=""><span textstyle="">è¿™ä¸ªæ–¹æ³•å…·æœ‰</span></span><span><span leaf=""><span textstyle="">è·¨ç™Œç§ã€è·¨æŠ—åŸç±»å‹çš„æ™®é€‚æ€§ï¼Œä¸ç”¨æ‹…å¿ƒè‡ªå·±çš„ç—…ç§ä»–ä¸è¯†åˆ«ã€‚</span></span></span></section><section><span leaf=""><span textstyle="">ä»–çš„æ€§èƒ½</span></span><span leaf=""><span textstyle="">æ˜¾è‘—ä¼˜äºæ­¤å‰åŸºäº243ä¸ªåŸºå› çš„ç®—æ³•</span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="swift"><code><span leaf=""><span>###Â </span><span>MANAscoreç®—æ³•ä½¿ç”¨æ•™ç¨‹ï¼ˆä¸­æ–‡æ³¨é‡Šç‰ˆï¼‰</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>#Â </span><span>---------------</span><span>Â </span><span>1</span><span>. æ¦‚è¿°Â </span><span>---------------</span></span></code><code><span leaf=""><span># ç›®æ ‡ï¼šé€šè¿‡</span><span>CXCL13</span><span>ã€</span><span>ENTPD1</span><span>(</span><span>CD39</span><span>)</span><span>ã€</span><span>IL7Rä¸‰ä¸ªåŸºå› çš„è¡¨è¾¾æƒé‡</span></span></code><code><span leaf=""><span># Â  Â  Â  è¯†åˆ«è‚¿ç˜¤ç‰¹å¼‚æ€§</span><span>Tç»†èƒï¼ˆTILï¼‰</span></span></code><code><span leaf=""><span># ä¼˜åŠ¿ï¼šè·¨ç™Œç§é€‚ç”¨ï¼ˆè‚ºç™Œ</span><span>ã€</span><span>é»‘è‰²ç´ ç˜¤</span><span>ã€</span><span>å¤´é¢ˆç™Œç­‰ï¼‰</span></span></code><code><span leaf=""><span># Â  Â  Â  æ”¯æŒæ–°æŠ—åŸ</span><span>ã€</span><span>ç™Œç¾æŠ—åŸ</span><span>ã€</span><span>ç—…æ¯’æŠ—åŸç­‰å¤šç§è‚¿ç˜¤æŠ—åŸç±»å‹</span></span></code><code><span leaf=""><span># è¾“å…¥ï¼šå•ç»†èƒ</span><span>RNAæµ‹åºæ•°æ®ï¼ˆSeuratå¯¹è±¡ï¼‰</span></span></code><code><span leaf=""><span># è¾“å‡ºï¼š</span><span>MANAscoreè¯„åˆ†</span><span>ã€</span><span>é«˜è¡¨è¾¾</span><span>TILæ ‡è®°</span><span>ã€</span><span>è‚¿ç˜¤ååº”æ€§</span><span>Tç»†èƒå…‹éš†</span><span>(pTRC)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>#Â </span><span>---------------</span><span>Â </span><span>2</span><span>. è¾“å…¥æ•°æ®å‡†å¤‡Â </span><span>---------------</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>###Â </span><span>2.1</span><span>Â åŠ è½½æ•°æ®</span></span></code><code><span leaf=""><span># è¯»å–ä¿å­˜çš„</span><span>Seuratå¯¹è±¡ï¼ˆéœ€æ›¿æ¢å®é™…è·¯å¾„ï¼‰</span></span></code><code><span leaf=""><span>serÂ </span><span>&lt;-</span><span>Â readRDS('</span><span>/the/</span><span>folder</span><span>/of/</span><span>object.rds') Â </span></span></code><code><span leaf=""><span># è®¾ç½®é»˜è®¤åˆ†æç»„ä¸º</span><span>RNAè¡¨è¾¾æ•°æ®</span></span></code><code><span leaf=""><span>DefaultAssay(ser)Â </span><span>&lt;-</span><span>Â '</span><span>RNA</span><span>'</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>###Â </span><span>2.2</span><span>Â æ•°æ®é¢„å¤„ç†</span></span></code><code><span leaf=""><span># æŸ¥çœ‹æ ·æœ¬ç»†èƒæ•°é‡åˆ†å¸ƒ</span></span></code><code><span leaf=""><span>dÂ </span><span>&lt;-</span><span>Â ser[[]]Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  group_by(sample)Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  summarise(n</span><span>=</span><span>n())Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  arrange(n)</span></span></code><code><span leaf=""><span>print</span><span>(d) Â # æ‰“å°å„æ ·æœ¬ç»†èƒæ•°</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆå§‹åŒ–å­˜å‚¨å¯¹è±¡</span></span></code><code><span leaf=""><span>ser_saverÂ </span><span>=</span><span>Â </span><span>NULL</span><span>Â  # å­˜å‚¨</span><span>SAVERå¡«è¡¥åçš„æ•°æ®</span></span></code><code><span leaf=""><span>datÂ </span><span>=</span><span>Â </span><span>NULL</span><span>Â  Â  Â  Â  # å­˜å‚¨ä¸‰åŸºå› æ ‡å‡†åŒ–æ•°æ®</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å¾ªç¯å¤„ç†æ¯ä¸ªæ ·æœ¬</span></span></code><code><span leaf=""><span>for</span><span>(iÂ </span><span>in</span><span>Â </span><span>1</span><span>:dim(d)[</span><span>1</span><span>]){</span></span></code><code><span leaf=""><span>Â  sÂ </span><span>=</span><span>Â d[i,]</span><span>$sample</span></span></code><code><span leaf=""><span>Â Â </span><span>print</span><span>(paste(</span><span>"æ­£åœ¨å¤„ç†æ ·æœ¬:"</span><span>, s))</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  # æå–å½“å‰æ ·æœ¬å­é›†</span></span></code><code><span leaf=""><span>Â  subserÂ </span><span>=</span><span>Â subset(ser, subsetÂ </span><span>=</span><span>Â sampleÂ </span><span>==</span><span>Â s)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  #Â </span><span>SAVERå¡«è¡¥ï¼ˆéœ€å®‰è£…saveråŒ…ï¼‰</span></span></code><code><span leaf=""><span>Â  subser_countÂ </span><span>=</span><span>Â subser[['</span><span>RNA</span><span>']]</span><span>$counts</span></span></code><code><span leaf=""><span>Â  subser_saverÂ </span><span>=</span><span>Â saver(subser_count,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ncoresÂ </span><span>=</span><span>Â </span><span>96</span><span>, Â # å¹¶è¡Œè®¡ç®—æ ¸æ•°ï¼ˆæ ¹æ®æœåŠ¡å™¨è°ƒæ•´ï¼‰</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  estimates.onlyÂ </span><span>=</span><span>Â </span><span>T</span><span>)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  # åˆ†ä½æ•°å½’ä¸€åŒ–Â </span><span>&amp;</span><span>Â </span><span>Z</span><span>-</span><span>scoreæ ‡å‡†åŒ–</span></span></code><code><span leaf=""><span>Â  ser_saver_normÂ </span><span>&lt;-</span><span>Â normalize.quantiles(subser_saver,Â </span><span>copy</span><span>=</span><span>TRUE</span><span>)</span></span></code><code><span leaf=""><span>Â  colnames(ser_saver_norm)Â </span><span>&lt;-</span><span>Â colnames(subser_saver)</span></span></code><code><span leaf=""><span>Â  rownames(ser_saver_norm)Â </span><span>&lt;-</span><span>Â rownames(subser_saver)</span></span></code><code><span leaf=""><span>Â  ser_saver_norm_scaleÂ </span><span>&lt;-</span><span>Â scale(ser_saver_norm) Â # åˆ—æ ‡å‡†åŒ–</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  # æå–ç›®æ ‡åŸºå› ï¼š</span><span>CXCL13</span><span>,Â </span><span>ENTPD1</span><span>,Â </span><span>IL7R</span></span></code><code><span leaf=""><span>Â  genesÂ </span><span>&lt;-</span><span>Â c('</span><span>CXCL13</span><span>','</span><span>ENTPD1</span><span>','</span><span>IL7R</span><span>')</span></span></code><code><span leaf=""><span>Â  subdatÂ </span><span>&lt;-</span><span>Â ser_saver_norm_scale[genes,]Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  Â  t()Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  Â Â </span><span>as</span><span>.data.frame()</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  datÂ </span><span>&lt;-</span><span>Â rbind(dat, subdat) Â # åˆå¹¶æ‰€æœ‰æ ·æœ¬æ•°æ®</span></span></code><code><span leaf=""><span>}</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ä¿å­˜å¡«è¡¥åçš„ä¸‰åŸºå› æ•°æ®</span></span></code><code><span leaf=""><span>write.csv(dat,Â </span><span>"dat_3gene_imputation.csv"</span><span>, quote</span><span>=</span><span>FALSE</span><span>)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>###Â </span><span>2.3</span><span>Â æå–åŸå§‹ä¸‰åŸºå› æ•°æ®ï¼ˆéå¡«è¡¥ï¼‰</span></span></code><code><span leaf=""><span>RNA_3gene</span><span>Â </span><span>&lt;-</span><span>Â ser</span><span>@assays</span><span>$RNA$data</span><span>[genes,]Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â Â </span><span>as</span><span>.matrix()Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â  t()Â </span><span>%&gt;%</span><span>Â </span></span></code><code><span leaf=""><span>Â Â </span><span>as</span><span>.data.frame()</span></span></code><code><span leaf=""><span>write.csv(</span><span>RNA_3gene</span><span>,Â </span><span>"dat_3gene_RNA.csv"</span><span>, quote</span><span>=</span><span>FALSE</span><span>)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>#Â </span><span>---------------</span><span>Â </span><span>3</span><span>. é¢„æµ‹</span><span>MANAscore</span><span>Â </span><span>---------------</span></span></code><code><span leaf=""><span># ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>### é€‰é¡¹</span><span>1</span><span>ï¼šä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ç›´æ¥é¢„æµ‹</span></span></code><code><span leaf=""><span># å‘½ä»¤è¡Œæ‰§è¡Œï¼ˆéœ€å®‰è£…manascoreåŒ…ï¼‰</span></span></code><code><span leaf=""><span># manascore predict è¾“å…¥å¡«è¡¥æ•°æ® è¾“å…¥åŸå§‹æ•°æ® è¾“å‡ºå¡«è¡¥è¯„åˆ† è¾“å‡ºåŸå§‹è¯„åˆ†</span></span></code><code><span leaf=""><span>manascore predict input_imputation_3_gene.csv input_non_imputation_3_gene.csv output_imputation_score.csv output_non_imputation_score.csv</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>### é€‰é¡¹</span><span>2</span><span>ï¼šä»å¤´è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹</span></span></code><code><span leaf=""><span># å‘½ä»¤è¡Œæ‰§è¡Œï¼ˆå°†è‡ªåŠ¨ä¿å­˜æ¨¡å‹åˆ°å½“å‰ç›®å½•ï¼‰</span></span></code><code><span leaf=""><span>manascore train_predict input_imputation_3_gene.csv input_non_imputation_3_gene.csv output_imputation_score.csv output_non_imputation_score.csv</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>#Â </span><span>---------------</span><span>Â </span><span>4</span><span>. å®šä¹‰é«˜è¡¨è¾¾</span><span>TILï¼ˆMANAscorehiï¼‰</span><span>Â </span><span>---------------</span></span></code><code><span leaf=""><span># æ ¹æ®æ ·æœ¬å¼‚è´¨æ€§è®¾ç½®ä¸ªä½“åŒ–é˜ˆå€¼</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>mÂ </span><span>&lt;-</span><span>Â ser[[]]Â </span><span>%&gt;%</span><span>Â group_by(sample)Â </span><span>%&gt;%</span><span>Â summarise(n</span><span>=</span><span>n())</span></span></code><code><span leaf=""><span>D</span><span>Â </span><span>&lt;-</span><span>Â </span><span>NULL</span><span>Â  Â  Â  # å­˜å‚¨æ‰€æœ‰ç»†èƒæ³¨é‡Š</span></span></code><code><span leaf=""><span>Cutoff</span><span>Â </span><span>&lt;-</span><span>Â </span><span>NULL</span><span>Â # å­˜å‚¨å„æ ·æœ¬é˜ˆå€¼</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>for</span><span>(zÂ </span><span>in</span><span>Â </span><span>1</span><span>:length(m[,</span><span>1</span><span>])){</span></span></code><code><span leaf=""><span>Â  sÂ </span><span>=</span><span>Â m[z,]</span><span>$sample</span></span></code><code><span leaf=""><span>Â Â </span><span>print</span><span>(paste(</span><span>"å¤„ç†æ ·æœ¬:"</span><span>, s))</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  # æå–å½“å‰æ ·æœ¬æ•°æ®</span></span></code><code><span leaf=""><span>Â  dÂ </span><span>=</span><span>Â ser[[]]Â </span><span>%&gt;%</span><span>Â filter(sampleÂ </span><span>==</span><span>Â s)</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  #Â </span><span>---</span><span>Â æ­¥éª¤</span><span>1</span><span>ï¼šè®¡ç®—å¡«è¡¥æ•°æ®é˜ˆå€¼Â </span><span>---</span></span></code><code><span leaf=""><span>Â  diÂ </span><span>&lt;-</span><span>Â density(d</span><span>$score_i</span><span>) Â # æ ¸å¯†åº¦ä¼°è®¡</span></span></code><code><span leaf=""><span>Â  trough1Â </span><span>&lt;-</span><span>Â </span><span>NULL</span></span></code><code><span leaf=""><span>Â  # å¯»æ‰¾æœ€åä¸€ä¸ªæ³¢è°·ï¼ˆæœ€ç»ˆé˜ˆå€¼ï¼‰</span></span></code><code><span leaf=""><span>Â Â </span><span>for</span><span>Â (iÂ </span><span>in</span><span>Â </span><span>2</span><span>:(length(di</span><span>$y</span><span>)</span><span>-</span><span>1</span><span>)) {</span></span></code><code><span leaf=""><span>Â  Â Â </span><span>if</span><span>Â (di</span><span>$y</span><span>[i</span><span>-</span><span>1</span><span>]Â </span><span>&gt;=</span><span>Â di</span><span>$y</span><span>[i]Â </span><span>&amp;</span><span>Â di</span><span>$y</span><span>[i]Â </span><span>&lt;=</span><span>Â di</span><span>$y</span><span>[i</span><span>+</span><span>1</span><span>]) {</span></span></code><code><span leaf=""><span>Â  Â  Â  trough1Â </span><span>&lt;-</span><span>Â cbind(trough1, c(di</span><span>$x</span><span>[i], di</span><span>$y</span><span>[i]))</span></span></code><code><span leaf=""><span>Â  Â  }</span></span></code><code><span leaf=""><span>Â  }</span></span></code><code><span leaf=""><span>Â  cutoff1Â </span><span>=</span><span>Â trough1[,dim(trough1)[</span><span>2</span><span>]][</span><span>1</span><span>]</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  #Â </span><span>---</span><span>Â æ­¥éª¤</span><span>2</span><span>ï¼šè®¡ç®—éå¡«è¡¥æ•°æ®é˜ˆå€¼Â </span><span>---</span></span></code><code><span leaf=""><span>Â  dniÂ </span><span>&lt;-</span><span>Â density(d</span><span>$score_ni</span><span>)</span></span></code><code><span leaf=""><span>Â  trough2Â </span><span>&lt;-</span><span>Â </span><span>NULL</span></span></code><code><span leaf=""><span>Â Â </span><span>for</span><span>Â (iÂ </span><span>in</span><span>Â </span><span>2</span><span>:(length(dni</span><span>$y</span><span>)</span><span>-</span><span>1</span><span>)) {</span></span></code><code><span leaf=""><span>Â  Â Â </span><span>if</span><span>Â (dni</span><span>$y</span><span>[i</span><span>-</span><span>1</span><span>]Â </span><span>&gt;=</span><span>Â dni</span><span>$y</span><span>[i]Â </span><span>&amp;</span><span>Â dni</span><span>$y</span><span>[i]Â </span><span>&lt;=</span><span>Â dni</span><span>$y</span><span>[i</span><span>+</span><span>1</span><span>]) {</span></span></code><code><span leaf=""><span>Â  Â  Â  trough2Â </span><span>&lt;-</span><span>Â cbind(trough2, c(dni</span><span>$x</span><span>[i], dni</span><span>$y</span><span>[i]))</span></span></code><code><span leaf=""><span>Â  Â  }</span></span></code><code><span leaf=""><span>Â  }</span></span></code><code><span leaf=""><span>Â  cutoff2Â </span><span>=</span><span>Â trough2[,dim(trough2)[</span><span>2</span><span>]][</span><span>1</span><span>]</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  #Â </span><span>---</span><span>Â æ ‡è®°é«˜è¡¨è¾¾ç»†èƒÂ </span><span>---</span></span></code><code><span leaf=""><span>Â  d</span><span>$it</span><span>Â </span><span>=</span><span>Â ifelse(d</span><span>$score_i</span><span>Â </span><span>&gt;</span><span>Â cutoff1, 'hi', 'lo') Â # å¡«è¡¥æ•°æ®æ ‡è®°</span></span></code><code><span leaf=""><span>Â  d</span><span>$nt</span><span>Â </span><span>=</span><span>Â ifelse(d</span><span>$score_ni</span><span>Â </span><span>&gt;</span><span>Â cutoff2, 'hi', 'lo') # éå¡«è¡¥æ ‡è®°</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>Â  #Â </span><span>---</span><span>Â å¯è§†åŒ–éªŒè¯Â </span><span>---</span></span></code><code><span leaf=""><span>Â  # ç”Ÿæˆæ•£ç‚¹å›¾ä¸å¯†åº¦å›¾ï¼ˆç•¥ï¼Œè¯¦è§åŸä»£ç ï¼‰</span></span></code><code><span leaf=""><span>Â  # ä¿å­˜ç»“æœ</span></span></code><code><span leaf=""><span>Â Â </span><span>D</span><span>Â </span><span>&lt;-</span><span>Â rbind(</span><span>D</span><span>, d)</span></span></code><code><span leaf=""><span>Â Â </span><span>Cutoff</span><span>Â </span><span>=</span><span>Â rbind(</span><span>Cutoff</span><span>, data.frame(sample</span><span>=</span><span>s,Â </span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cutoff_i</span><span>=</span><span>cutoff1,</span></span></code><code><span leaf=""><span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cutoff_ni</span><span>=</span><span>cutoff2))</span></span></code><code><span leaf=""><span>}</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ç­›é€‰åŒé«˜è¡¨è¾¾ç»†èƒ</span></span></code><code><span leaf=""><span>D</span><span>Â </span><span>%&gt;%</span><span>Â filter(itÂ </span><span>==</span><span>Â 'hi'Â </span><span>&amp;</span><span>Â ntÂ </span><span>==</span><span>'hi')Â </span><span>%&gt;%</span><span>Â dim()Â </span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ä¿å­˜å®Œæ•´æ³¨é‡Šæ•°æ®</span></span></code><code><span leaf=""><span>saveRDS(</span><span>D</span><span>, '</span><span>MANAscore</span><span>.rds')</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>#Â </span><span>---------------</span><span>Â </span><span>5</span><span>. å®šä¹‰pTRCï¼ˆè‚¿ç˜¤ååº”æ€§</span><span>Tç»†èƒå…‹éš†ï¼‰</span><span>Â </span><span>---------------</span></span></code><code><span leaf=""><span># æ ¸å¿ƒé€»è¾‘ï¼šå…±äº«ç›¸åŒ</span><span>TCRä¸”å…‹éš†å¤§å°</span><span>â‰¥</span><span>5</span><span>çš„ç»†èƒç¾¤</span></span></code><code><span leaf=""><span># éœ€è¦æ•´åˆ</span><span>TCRåºåˆ—æ•°æ®ï¼ˆéœ€åœ¨Seuratå¯¹è±¡ä¸­åŒ…å«TCRä¿¡æ¯ï¼‰</span></span></code><code><span leaf=""><span># å…·ä½“å®ç°å‚è€ƒåŸå§‹è®ºæ–‡çš„å…‹éš†å®šä¹‰æ–¹æ³•</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>### å…³é”®å‚æ•°è¯´æ˜</span></span></code><code><span leaf=""><span>#Â </span><span>-</span><span>Â clone_size_threshold: å®šä¹‰å…‹éš†çš„æœ€å°ç»†èƒæ•°ï¼ˆé»˜è®¤</span><span>5</span><span>ï¼‰</span></span></code><code><span leaf=""><span>#Â </span><span>-</span><span>Â min_manascorehi_cells: å…‹éš†ä¸­</span><span>MANAscorehiç»†èƒæœ€å°æ•°é‡ï¼ˆé»˜è®¤5ï¼‰</span></span></code><code><span leaf=""><span># è¾“å‡ºï¼šåŒ…å«å…‹éš†</span><span>ID</span><span>ã€</span><span>ç»†èƒæ•°</span><span>ã€</span><span>MANAscoreå‡å€¼ç­‰ä¿¡æ¯çš„è¡¨æ ¼</span></span></code></pre></section><p><span><strong><span><span leaf="">è¿™æ¬¡ç”Ÿä¿¡çš„å¤§çº²å†…å®¹è¿›è¡Œå…¨é¢çš„è°ƒæ•´ï¼Œæƒ³äº†è§£ç”Ÿä¿¡çš„ï¼Œè·Ÿç­çš„ï¼Œå¯ä»¥çœ‹ä¸‹é¢</span></span><strong><span leaf="">ğŸ‘‡è¿™ä¸ªæ–‡ç« </span></strong></strong></span></p><p><span><strong><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247483882&amp;idx=2&amp;sn=dcbadc65ca30d4b8d6f8d322b253719f&amp;scene=21#wechat_redirect" textvalue="æƒ³å­¦ç”Ÿä¿¡ï¼Ÿé‚£å°±çœ‹çœ‹è¿™ä¸ªä»åŸºç¡€åˆ°å¤šç»„å­¦ã€ç©ºé—´ã€æœºå™¨å­¦ä¹ ä¸€æ¡é¾™å…¨æ‰“é€š" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">æƒ³å­¦ç”Ÿä¿¡ï¼Ÿé‚£å°±çœ‹çœ‹è¿™ä¸ªä»åŸºç¡€åˆ°å¤šç»„å­¦ã€ç©ºé—´ã€æœºå™¨å­¦ä¹ ä¸€æ¡é¾™å…¨æ‰“é€š</span></a></span></strong></span></p><p><span><strong><span><span leaf="">å•ç»†èƒæ•°æ®åˆ†æéœ€æ±‚çš„å¯ä»¥çœ‹</span><strong><strong><span leaf="">ğŸ‘‡è¿™ä¸ªæ–‡ç« </span></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247483852&amp;idx=2&amp;sn=2a856d23c71b7997bd2b86b93e329ec0&amp;scene=21#wechat_redirect" textvalue="æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš" data-itemshowtype="11" target="_blank" linktype="text" data-linktype="2">æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš</a></span></strong></strong></span></strong></span></p><ul><li><strong></strong></li><li><section data-role="outer" label="Powered by 135editor.com onekey"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p data-brushtype="text"><strong><strong><strong><span leaf="">åè‹”â†©ï¸å²¸å·å³å¯éœå¾—ä»Šæ—¥çš„ä»£ç å’ŒåŸæ–‡ï¼Œä»Šæ—¥å…³é”®è¯ï¼š250204</span></strong></strong></strong></p></section></section></section></section></section></section></section><span><span leaf="">Zeng, Z., Zhang, T., Zhang, J.Â </span></span><i><span leaf="">et al.</span></i><span><span leaf="">Â A minimal gene set characterizes TIL specific for diverse tumor antigens across different cancer types.Â </span></span><i><span leaf="">Nat Commun</span></i><span><span leaf="">Â </span></span><b><span leaf="">16</span></b><span><span leaf="">, 1070 (2025).</span></span></li></ul><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/uV7zvc3tpsUysAVDAm6pjg",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
