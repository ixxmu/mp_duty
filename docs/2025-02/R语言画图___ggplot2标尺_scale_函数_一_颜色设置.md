---
title: "R语言画图 | ggplot2标尺（scale）函数（一）颜色设置"
date: 2025-02-10T00:34:37Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
R语言画图 | ggplot2标尺（scale）函数（一）颜色设置 by 被炸熟的虾
------
<div><section><span><strong><span>前言：</span></strong></span></section><section><span>来填很久前挖的坑——</span><a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247488724&amp;idx=1&amp;sn=89deba642fbed85a66e58d8968bd31a4&amp;token=1803065442&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R语言画图 | ggplot2 基础语法简述</a></section><hr><p><span></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><code><span>scale_*</span></code><span>函数是</span><code><span>ggplot2</span></code><span>中用于调整图形属性的核心工具，涵盖了颜色、形状、大小、透明度、坐标轴和图例等方方面面。通过灵活使用这些函数，可以创建高度定制化的数据可视化图形。</span></p><p><span><code><span>scale_*</span></code><span>函数</span>的基本结构是：</span><span>scale_映射类型_数据类型()</span></p><ul><li><section><span>映射类型：边框颜色（</span><span>color</span><span>）、填充颜色（</span><span>fill</span><span>）、线型（</span><span>linetype</span><span>）、形状（</span><span>shape</span><span>）、大小（</span><span>size</span><span>），</span><span>x</span><span>轴和</span><span>y</span><span>轴等。</span></section></li><li><section><span>数据类型：</span></section></li><ul><li><section><span>连续型：适用于数值型数据，例如用于根据数值范围映射颜色。</span></section></li><li><section><span>分散型：适用于分类数据，例如离散变量的颜色映射。</span></section></li><li><section><span>自定义：通过</span><code><span>scale_XXX_manual</span></code><span> 函数可以完全自定义映射规则。</span></section></li><li><section><span>同一型：通过</span><code><span>scale_XXX_identity</span></code><span> 函数，可以直接将数据值作为映射值，例如将数据中的颜色值直接用于颜色映射。</span></section></li><li><section><span>特殊转换：适用于特定数据类型或需要特殊转换的场景，如对数、平方根、分箱、日期时间等。</span></section></li></ul></ul><p><code><span>ggplot2</span></code><span>的标尺函数有一大堆：</span></p><pre><code>scalex &lt;- ls(<span>"package:ggplot2"</span>, pattern=<span>"^scale.+"</span>)<br>length(scalex)<span>#[1] 131</span><br>head(scalex)<br><span>#[1] "scale_alpha"            "scale_alpha_binned"     "scale_alpha_continuous"</span><br><span>#[4] "scale_alpha_date"       "scale_alpha_datetime"   "scale_alpha_discrete"  </span><br>tail(scalex)<br><span>#[1] "scale_y_datetime" "scale_y_discrete" "scale_y_log10"    "scale_y_reverse" </span><br><span>#[5] "scale_y_sqrt"     "scale_y_time"    </span><br></code></pre><p><span>以下是按照映射类型和数据类型对</span><code><span>ggplot2</span></code><span>的</span><code><span>scale</span></code><span>函数进行分类的表格（部分）：</span></p><p><img data-galleryid="" data-imgfileid="100006576" data-ratio="2.270231213872832" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1PK6RjoCibK0ibPs6hm4JRDMfXqNbEkTeRygrH4RzkEMrywJzsNKcgrNg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1PK6RjoCibK0ibPs6hm4JRDMfXqNbEkTeRygrH4RzkEMrywJzsNKcgrNg/640?wx_fmt=png&amp;from=appmsg"></p><p><span>使用</span><span>R</span><span>语言自带的</span><span>mpg</span><span>数据集进行演示，</span><span>mpg</span><span>数据集内置于</span><code><span>ggplot2</span></code><span>包中。它记录了不同汽车的燃油效率及相关属性：</span></p><pre><code><span>library</span>(ggplot2)<br>head(mpg)<br><span># A tibble: 6 × 11</span><br><span>#  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class  </span><br><span>#  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  </span><br><span>#1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compact</span><br><span>#2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compact</span><br><span>#3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compact</span><br><span>#4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compact</span><br><span>#5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compact</span><br><span>#6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compact</span><br></code></pre><p><strong>变量说明</strong></p><p><img data-galleryid="" data-imgfileid="100006577" data-ratio="0.9446107784431138" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1hSeTAeaVnXE97KbQ4A8qibj3FCGqx8OoOdVHMdzkEtFgz8KYAfrYrEA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="668" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1hSeTAeaVnXE97KbQ4A8qibj3FCGqx8OoOdVHMdzkEtFgz8KYAfrYrEA/640?wx_fmt=png&amp;from=appmsg"></p><section><span>先从颜色设置开始</span>。<code><span>scale_*</span></code><span>函数中与颜色相关的函数主要用于调整</span><span>线条、点、边框等的颜色（</span><code><span>scale_color_</span></code><span>系列</span><span>）</span><span>以及</span><span>填充区域</span><span>的颜色（</span><code><span>scale_fill_</span></code><span><span>系列</span>）</span><span>。</span></section><h2><span>1、连续型变量颜色调整</span></h2><ul><li><section><code><span>scale_color_continuous():</span></code><span> </span><span>设置</span><span>连续型变量的颜色渐变。</span></section></li></ul><p><span>对于数据为非因子型的颜色映射，</span><code><span>ggplot2</span></code><span>自动使用</span><code><span>continuous</span></code><span>类型颜色标尺表示连续颜色空间。可以使用</span><code><span>scale_color_continuous</span></code><span>函数进行修改：</span></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_continuous(low = <span>"blue"</span>, high = <span>"red"</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100006580" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pQfNQs7ic7eZicSwBskoJey1zFtB2BCnsdrSRE41vGOWc8vKsLIQoK9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pQfNQs7ic7eZicSwBskoJey1zFtB2BCnsdrSRE41vGOWc8vKsLIQoK9Q/640?wx_fmt=png&amp;from=appmsg"></p><p><span>通过参数</span><code><span>low</span></code><span>和</span><code><span>high</span></code><span>分别设置低端和高端数据的颜色，中间颜色根据颜色空间</span><span>space</span><span>自动计算； </span><code><span>type</span></code><span> 参数用于指定渐变色的类型：</span></p><ul><li><section><code><span>type = "gradient"</span></code><span>：默认的双色渐变。</span></section></li><li><section><code><span>type = "viridis"</span></code><span>：感知上均匀的渐变色方案，适用于大多数场景。</span></section></li><li><section><code><span>type = "plasma"</span></code><span>：从黄色到红色的渐变，适用于突出高值。</span></section></li><li><section><code><span>type = "magma"</span></code><span>：从黑色到红色的渐变，适用于突出低值。</span></section></li><li><section><code><span>type = "inferno"</span></code><span>：从黑色到黄色的渐变，适用于突出高值。</span></section></li><li><section><code><span>type = "cividis"</span></code><span>：从蓝色到黄色的渐变，适用于突出中间值。</span></section></li><li><section><code><span>type = "manual"</span></code><span>：手动指定颜色映射。</span></section></li></ul><p><span>这个参数很少使用，记录一下是为了方便理解</span><code><span>ggplot2</span></code><span>提供的另一个功能重叠的函数</span><code><span>scale_color_gradient()</span></code><span>：</span></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_gradient(low = <span>"blue"</span>, high = <span>"red"</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100006581" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pQfNQs7ic7eZicSwBskoJey1zFtB2BCnsdrSRE41vGOWc8vKsLIQoK9Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pQfNQs7ic7eZicSwBskoJey1zFtB2BCnsdrSRE41vGOWc8vKsLIQoK9Q/640?wx_fmt=png&amp;from=appmsg"></p><p><span>以下两步是完全等效的：</span></p><pre><code>scale_color_continuous(low = <span>"white"</span>, high = <span>"blue"</span>,type = <span>"gradient"</span>)<br>scale_color_gradient(low = <span>"white"</span>, high = <span>"blue"</span>)<br></code></pre><p><span>如果想要设置中间过渡颜色，可以借助</span><code><span>scale_color_gradient2()</span></code><span>函数——</span></p><ul><li><section><code><span>scale_color_gradient2()</span></code><span>: 通过参数</span><code><span>low</span></code><span>、</span><code><span>mid</span></code><span>和</span><code><span>high</span></code><span>分别设置三种颜色的渐变（低、中、高）。示例中间点设置为</span><span>20</span><span>（白色）</span><span>。</span></section></li></ul><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_gradient2(low = <span>"blue"</span>, mid = <span>"white"</span>, high = <span>"red"</span>, midpoint = <span>20</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100006582" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1H7BRGnlxfQ6AG9iarL90ncFfYWeXuoNSXkEcZaA15cOP493qeuib5nsw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1H7BRGnlxfQ6AG9iarL90ncFfYWeXuoNSXkEcZaA15cOP493qeuib5nsw/640?wx_fmt=png&amp;from=appmsg"></p><p><span>更复杂的</span><code><span>scale_fill_gradientn()</span></code><span>函数可以使用</span><code><span>colours</span></code><span>参数设置多个中间颜色，适合需要精细控制渐变色的场景：</span></p><pre><code><span>library</span>(ggplot2)<br><span># 第一个图：使用 scale_color_gradientn</span><br>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_gradientn(colors = c(<span>"blue"</span>, <span>"green"</span>, <span>"yellow"</span>, <span>"orange"</span>, <span>"red"</span>),<br>                        values = c(<span>0</span>, <span>0.25</span>, <span>0.5</span>, <span>0.75</span>, <span>1</span>))<br><span># 第二个图：修正 values 参数</span><br>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_gradientn(colors = c(<span>"blue"</span>, <span>"green"</span>, <span>"yellow"</span>, <span>"orange"</span>, <span>"red"</span>),<br>                        values = c(<span>0</span>, <span>0.1</span>, <span>0.2</span>, <span>0.75</span>, <span>1</span>))  <br></code></pre><ul><li><section><code><span>colors = c("blue", "green", "yellow", "orange", "red")</span></code><span>定义了渐变色。</span></section></li><li><section><code><span>values = c(0, 0.25, 0.5, 0.75, 1)</span></code><span> 定义了颜色变化的具体位置，</span><span>0</span><span>：最小值对应蓝色；</span><span>0.25</span><span>：数据范围的</span><span>25%</span><span>处对应绿色；</span><span>0.5</span><span>：数据范围的</span>50%<span>处对应黄色；</span>0.75<span>：数据范围的</span>75%<span>处对应橙色；</span><span>1</span><span>：最大值对应红色。</span></section></li></ul><p><img data-galleryid="" data-imgfileid="100006583" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1B1jDESd5ZuGEqHqqMCZFBeMh9lvRhrZiatrv7hblufEegn4hovwNWfA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1B1jDESd5ZuGEqHqqMCZFBeMh9lvRhrZiatrv7hblufEegn4hovwNWfA/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100006584" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1tta8FNP0UHXECicMxFxBdVBOgAX6pbWajykiaRzrAtyWbHl0Gud8MibEQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1tta8FNP0UHXECicMxFxBdVBOgAX6pbWajykiaRzrAtyWbHl0Gud8MibEQ/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><span>第二个图相比第一个缩减了蓝色-绿色映射范围。</span></strong></p><h2><span>2、离散型变量颜色调整</span></h2><p><span>如果数据是因子型的颜色映射，修改标尺就需要使用相应的离散型颜色标尺，例如</span><code><span>scale_color_discrete</span></code><span>。</span></p><ul><li><section><code><span>scale_color_discrete()</span></code></section></li></ul><p><code><span>scale_color_discrete()</span></code><span>会自动为离散变量的每个类别分配一组默认的颜色，这些颜色通常是均匀分布的，以确保不同类别之间的区分度。</span></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_discrete()<br></code></pre><p><img data-galleryid="" data-imgfileid="100006585" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1qsxoO0rdkQISfOc9nYglRSicV7HQCd1TKibgu5BmvqXh64feajkzwYBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1qsxoO0rdkQISfOc9nYglRSicV7HQCd1TKibgu5BmvqXh64feajkzwYBA/640?wx_fmt=png&amp;from=appmsg"></p><p><code><span>scale_color_discrete()</span></code><span>可以通过设置色调范围（</span><code><span>h</span></code><span>）、饱和度（</span><code><span>c</span></code><span>）和亮度（</span><code><span>l</span></code><span>）调整颜色，但灵活性相对较低且较难把控。</span></p><pre><code>p6 &lt;- ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>      geom_point(size = <span>5</span>)  +<br>      scale_color_discrete()<br>p7 &lt;- ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>      geom_point(size = <span>5</span>)  +<br>      scale_color_discrete(c = <span>50</span>)<br>p8 &lt;- ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>      geom_point(size = <span>5</span>)  +<br>      scale_color_discrete(h = c(<span>180</span>, <span>300</span>))<br></code></pre><p><img data-galleryid="" data-imgfileid="100006587" data-ratio="0.8685185185185185" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pmHW29wUpm2HSzz4saX5zu0jefkIiawy2XhNfLBDtDcQ6JhHibX3N5zw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1pmHW29wUpm2HSzz4saX5zu0jefkIiawy2XhNfLBDtDcQ6JhHibX3N5zw/640?wx_fmt=png&amp;from=appmsg"></p><p><span>如果需要自定义颜色分配，通常需要切换到</span><code><span>scale_color_manual()</span></code><span>。</span></p><ul><li><section><code><span>scale_color_manual()</span></code><span>:</span></section></li></ul><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_manual(values = c(<span>"red"</span>, <span>"blue"</span>, <span>"green"</span>, <span>"orange"</span>, <span>"purple"</span>, <span>"pink"</span>, <span>"brown"</span>))<br></code></pre><p><img data-galleryid="" data-imgfileid="100006588" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1xibr9uibeCpHR2gh5YULxRjJBn4UjUjEoFESZS8hAdGS0dHUUyiczRPYg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1xibr9uibeCpHR2gh5YULxRjJBn4UjUjEoFESZS8hAdGS0dHUUyiczRPYg/640?wx_fmt=png&amp;from=appmsg"></p><p><strong><span>提供颜色数量必须大于等于离散变量的类别数量</span></strong><span>，否则会报错。</span></p><h2><span>3、结合内置调色板</span></h2><ul><li><section><span>使用</span>ColorBrewer<span>调色板</span></section></li></ul><p><code><span>scale_color_brewer()</span></code><span>函数可以直接使用</span><code><span>RColorBrewer</span></code><span>包预定义的一些调色板。使用时需要注意调色板可提供的颜色数量（</span>8-11<span>种），如果超过最大颜色数就不合适了。</span></p><p><img alt="图片" data-imgfileid="100006599" data-ratio="0.5101851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc59icVG7jDvPtb2MEiazxA6g9msFwMEwvEllghD8JBTjicgqM0xBRUbBV2g/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc59icVG7jDvPtb2MEiazxA6g9msFwMEwvEllghD8JBTjicgqM0xBRUbBV2g/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p><img alt="图片" data-imgfileid="100006600" data-ratio="0.5101851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc5mgaFSwnWSwB0xJyaKBbnpsEm0dU6SgHlUyD7BhDINLfd0ISNEUVx9Q/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc5mgaFSwnWSwB0xJyaKBbnpsEm0dU6SgHlUyD7BhDINLfd0ISNEUVx9Q/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p><img alt="图片" data-imgfileid="100006601" data-ratio="0.5101851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc5b6buCuhWTuueiaG64Qr39WN2V7eID71dIjUwfiaqjve8WDQSIKvM3lHQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3IWZflhHmyUW2wG7icYW3tc5b6buCuhWTuueiaG64Qr39WN2V7eID71dIjUwfiaqjve8WDQSIKvM3lHQ/640?wx_fmt=other&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_brewer(palette = <span>"Set1"</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100006590" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1ehztc8fuIljX2ee0XCLKicofEUOEtPcwonnrhl9XPibp3DEn8TrI81UQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1ehztc8fuIljX2ee0XCLKicofEUOEtPcwonnrhl9XPibp3DEn8TrI81UQ/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><section><span>使用</span>Viridis<span>调色板</span></section></li></ul><p><span><strong><span>离散变量（分类变量）</span></strong></span><span>：使用</span><code><span>scale_color_viridis_d()</span></code><span>或</span><code><span>scale_fill_viridis_d()</span></code><span>：</span></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = class)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_viridis_d()  <span># d 表示 discrete（离散）</span><br></code></pre><p><img data-galleryid="" data-imgfileid="100006591" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1jPDiahrtm19qLMb8KDKAPUn1mQWSDGicibBafywfjzSbEzVicop15fmPbg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1jPDiahrtm19qLMb8KDKAPUn1mQWSDGicibBafywfjzSbEzVicop15fmPbg/640?wx_fmt=png&amp;from=appmsg"></p><p><span><strong><span>连续变量</span></strong></span><span>：使用</span><code><span>scale_color_viridis_c()</span></code><span>或</span><code><span>scale_fill_viridis_c()</span></code><span>：</span></p><pre><code>ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +<br>  geom_point(size = <span>5</span>) +<br>  scale_color_viridis_c()  <span># c 表示 continuous（连续）</span><br></code></pre><p><img data-galleryid="" data-imgfileid="100006592" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1OWicdZvZbzZxBeoW8XKxPNpkqUA6qE4E9AGF1DPs9kTDM3ghe2iajFoQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1OWicdZvZbzZxBeoW8XKxPNpkqUA6qE4E9AGF1DPs9kTDM3ghe2iajFoQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span>关于</span>R<span>语言中的配色包之前写过一些，可以配合使用：</span></p><ul><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247487423&amp;idx=1&amp;sn=c5e6aa0fa6b355d642c24f5359da87c6&amp;chksm=c086d377f7f15a616219533d48525d14813944ce89cdb0475844389305eb69dda8b6627a6f6e&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>R语言画图 | 经典配色R包 RColorBrewer + ggsci + randomcoloR</span></strong></span></a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247487618&amp;idx=1&amp;sn=bd666401c3aceb2d606f052ebfa3a916&amp;chksm=c086cc4af7f1455cfee972a82ca69e871e7eead531e4306f91e559efe3fe06e41df84330f3c0&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>R语言画图 | 经典配色R包 paletteer</span></strong></span></a></section></li></ul><h2><span>4、填充颜色调整</span></h2><p><span>如果需要设置颜色填充，将</span>color/colour<span>替换成</span>fill<span>就可以了，函数都是类似的，挑几个展示一下——</span></p><ul><li><section><code><span>scale_fill_manual()</span></code><span>: 手动指定填充颜色。</span></section></li></ul><pre><code>ggplot(mpg, aes(x = displ, y = hwy, fill = class)) +<br>  geom_point(size = <span>5</span>, shape = <span>21</span>, color = <span>"black"</span>) +<span>#外边缘用黑色</span><br>  scale_fill_manual(values = c(<span>"red"</span>, <span>"blue"</span>, <span>"green"</span>, <span>"orange"</span>, <span>"purple"</span>, <span>"pink"</span>, <span>"brown"</span>))<br></code></pre><p><img data-galleryid="" data-imgfileid="100006593" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1xGIVzU7ykWKbicoE9xolwiaPC28DFGaSUv5UcH19EaVeq7RmfjPEJ7Rw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1xGIVzU7ykWKbicoE9xolwiaPC28DFGaSUv5UcH19EaVeq7RmfjPEJ7Rw/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><section><code><span>scale_fill_brewer()</span></code><span>: 使用</span>ColorBrewer<span>调色板。</span></section></li></ul><pre><code>ggplot(mpg, aes(x = class, fill = class)) +<br>  geom_bar() +<br>  scale_fill_brewer(palette = <span>"Set2"</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100006594" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia13BgF2LiakgKdUmsKibuB5xKesicvmPoiawpOplyQkx8Tg3LlzoUFuvZp3A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia13BgF2LiakgKdUmsKibuB5xKesicvmPoiawpOplyQkx8Tg3LlzoUFuvZp3A/640?wx_fmt=png&amp;from=appmsg"></p><ul><li><section><code><span>scale_fill_viridis_d()</span></code><span>: 使用</span>Viridis<span>调色板。</span></section></li></ul><pre><code>ggplot(mpg, aes(x = class, fill = class)) +<br>  geom_bar() +<br>  scale_fill_viridis_d()<br></code></pre><p><img data-galleryid="" data-imgfileid="100006595" data-ratio="0.38425925925925924" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1ZMkIibIa6XSyYKaTKZHayjziagBY84T6HJeNiaqwjiaX7QJ2N5ibvGmfic8g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1ZMkIibIa6XSyYKaTKZHayjziagBY84T6HJeNiaqwjiaX7QJ2N5ibvGmfic8g/640?wx_fmt=png&amp;from=appmsg"></p><p><code><span>ggplot2</span></code><span>内置的颜色标尺函数还有很多</span></p><pre><code>ls(<span>"package:ggplot2"</span>, pattern=<span>"^scale_fill.+"</span>)<br><span># [1] "scale_fill_binned"     "scale_fill_brewer"     "scale_fill_continuous"</span><br><span># [4] "scale_fill_date"       "scale_fill_datetime"   "scale_fill_discrete"  </span><br><span># [7] "scale_fill_distiller"  "scale_fill_fermenter"  "scale_fill_gradient"  </span><br><span>#[10] "scale_fill_gradient2"  "scale_fill_gradientn"  "scale_fill_grey"      </span><br><span>#[13] "scale_fill_hue"        "scale_fill_identity"   "scale_fill_manual"    </span><br><span>#[16] "scale_fill_ordinal"    "scale_fill_steps"      "scale_fill_steps2"    </span><br><span>#[19] "scale_fill_stepsn"     "scale_fill_viridis_b"  "scale_fill_viridis_c" </span><br><span>#[22] "scale_fill_viridis_d" </span><br>ls(<span>"package:ggplot2"</span>, pattern=<span>"^scale_color.+"</span>)<br><span># [1] "scale_color_binned"     "scale_color_brewer"     "scale_color_continuous"</span><br><span># [4] "scale_color_date"       "scale_color_datetime"   "scale_color_discrete"  </span><br><span># [7] "scale_color_distiller"  "scale_color_fermenter"  "scale_color_gradient"  </span><br><span>#[10] "scale_color_gradient2"  "scale_color_gradientn"  "scale_color_grey"      </span><br><span>#[13] "scale_color_hue"        "scale_color_identity"   "scale_color_manual"    </span><br><span>#[16] "scale_color_ordinal"    "scale_color_steps"      "scale_color_steps2"    </span><br><span>#[19] "scale_color_stepsn"     "scale_color_viridis_b"  "scale_color_viridis_c" </span><br><span>#[22] "scale_color_viridis_d" </span><br><span>#ls("package:ggplot2", pattern="^scale_colour.+")</span><br></code></pre><p><span>比如</span><code><span>scale_fill_grey()</span></code><span>用于将填充颜色（</span><code><span>fill</span></code><span>）映射为灰度颜色：</span><span></span></p><p><span>通过</span><code><span>start</span></code><span>和</span><code><span>end</span></code><span>参数来定义<span>灰度值的范围（</span></span>0<span>-</span>1）<span>，其中</span>0<span>表示纯黑色、</span>1<span>表示纯白色。值越小颜色越深（接近黑色），值越大颜色越浅（接近白色）。默认</span><code><span>start = 0.2</span></code><span>、</span><code><span>end = 0.8</span></code><span> 。</span><code><span>na.value</span></code><span>用于设置</span>NA<span>值的颜色，默认为红色</span><span>。</span></p><pre><code>p16 &lt;- ggplot(mpg, aes(x = class, fill = class)) +<br>      geom_bar() + <br>      scale_fill_grey()<br>p17 &lt;- ggplot(mpg, aes(x = class, fill = class)) +<br>      geom_bar() + <br>      scale_fill_grey(start = <span>0.1</span>, end = <span>0.6</span>)  <span># 从深灰到中灰</span><br><span># 添加 NA 值</span><br>mpg_na &lt;- mpg<br>mpg_na$class[<span>1</span>:<span>3</span>] &lt;- <span>NA</span><br>p18 &lt;- ggplot(mpg_na, aes(x = class, fill = class)) +<br>      geom_bar() +<br>      scale_fill_grey(na.value = <span>"blue"</span>)  <span># 将 NA 值填充为蓝色</span><br></code></pre><p><img data-galleryid="" data-imgfileid="100006596" data-ratio="0.8685185185185185" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1Y7U4dltK9PYPcy9BRsCMjC4PckkdFNLk2L6LJg4Fsdcugon5OXWBsw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3L2Vo0DML8PlNrqxB78SRia1Y7U4dltK9PYPcy9BRsCMjC4PckkdFNLk2L6LJg4Fsdcugon5OXWBsw/640?wx_fmt=png&amp;from=appmsg"></p><p><span>其他的就不一一介绍了</span></p><p><span><strong><br></strong></span></p><p><span><strong>下面标尺函数后续的慢慢补齐<img data-ratio="1" data-w="128" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Addoil.png" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Addoil.png"></strong></span></p><h3><span><strong>二、调整形状（Shape）</strong></span></h3><h3><span><strong>三、调整大小（Size）</strong></span></h3><h3><span><strong>四、调整透明度（Alpha）</strong></span></h3><h3><span><strong>五、调整坐标轴（Axis）</strong></span></h3><h3><span><strong>六、调整图例（Legend）</strong></span></h3><section><span><strong>......<br></strong></span></section><h3><span><strong><br></strong></span></h3><h3><span><strong>参考文章：</strong></span></h3><p><span><strong><span>1、小赖de生信笔记：</span></strong></span><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0MzIzMDg4OA==&amp;action=getalbum&amp;album_id=3817248010376167426&amp;scene=173&amp;subscene=&amp;sessionid=svr_23cf6d08da9&amp;enterid=1738911008&amp;from_msgid=2247483759&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" data-linktype="2"><span><strong><span>ggplot2</span></strong></span></a></p><p><span><strong><span>2、生物信息医学苑：</span></strong></span><a href="https://mp.weixin.qq.com/s?__biz=Mzg5ODY1NDkwMA==&amp;mid=2247484809&amp;idx=1&amp;sn=cfb13675e3028d2454f792ad26718df2&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>ggplot2作图：标尺（scale）设置</span></strong></span></a></p><p><span><strong><span>3、生信中转站：</span></strong></span><a href="https://mp.weixin.qq.com/s?__biz=MzkyMjc1NzEwMQ==&amp;mid=2247484683&amp;idx=1&amp;sn=b8cfb9fc1acc3595826450a2172df8ea&amp;scene=21#wechat_redirect" data-linktype="2"><span><strong><span>ggplot 中的颜色scale(part2)</span></strong></span></a><span></span></p></section><section><span></span></section><h3><span></span></h3><section><span></span></section><section><img data-imgfileid="100003752" data-ratio="0.05278592375366569" data-type="png" data-w="341" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section data-tools="135编辑器" data-id="116886" draggable="true"><section><section><section><section><strong data-brushtype="text">被炸熟的虾</strong></section></section></section><section><section><section data-width="35%"><section><img data-cropselx1="0" data-cropselx2="115" data-cropsely1="0" data-cropsely2="115" data-imgfileid="100003750" data-ratio="1" data-type="jpeg" data-w="258" data-width="100%" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/dRYYdqiaan3JjDfj2H8p6gg3CB25AGthbwzrotao4ev5tIe0utthbZRK8yOoDOuTzOSoTSnPWn61IdDCnXsnaiag/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section><section data-width="63%"><section><section><strong>自己的摸索，发现问题麻烦告诉作者，光速回来改正</strong><strong><img data-imgfileid="100003751" data-ratio="1" data-type="png" data-w="64" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3KLQGNxibvI4SdtUfxjINkz2DO8cGEPTgbcMJ357RvXJ7IvWU2p7anljpePpakI9oKu3icJxobBDp5w/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></strong></section></section></section></section></section></section></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/SE0-VpQuWQof2277SOAEfQ",target="_blank" rel="noopener noreferrer">原文链接</a>
