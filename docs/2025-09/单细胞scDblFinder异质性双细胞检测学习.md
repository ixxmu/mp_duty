---
title: "单细胞scDblFinder异质性双细胞检测学习"
date: 2025-09-15T00:23:56Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
单细胞scDblFinder异质性双细胞检测学习 by 生信方舟
------
<div><section><span leaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="生信方舟" data-alias="shengxinfangzhou" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGfe15Xm0WHdoAMNGvE93bmxaF9iabfPiaO9ic6Tmd8XW1PMiaeuqicSFhCLQJibAUhHsamS1LbaJMFiaZXA/0?wx_fmt=png" data-signature="热爱医学和数据科学，站在巨人的肩膀上，学习和整理相关的知识。" data-id="MzkwMjYyMDA1OA==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></span></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">scDblFinder包含了一系列用于在单细胞测序数据中检测和处理双细胞/多细胞（即在同一个液滴或反应体系中捕获了多个细胞）的方法，这些方法可以补充基于细胞标签和SNP的复用样本双细胞检测：</span><strong><span leaf=""><span textstyle="">1. 哈希/基因型方法能够识别来源于不同样本的双细胞（即使它们是同类型细胞形成的同质性双细胞，比如A样本的T细胞和B样本的T细胞），这种情况在转录组水平上往往与真实单细胞几乎无法区分（因此本工具包通常无法识别）；2. 但哈希/基因型方法这种方法无法检测来自同一样本的双细胞，即使它们是由不同细胞类型形成的异质性双细胞</span></span></strong><span leaf=""><span textstyle="">。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">相比之下，</span><strong><span leaf=""><span textstyle="">scDblFinder 提供的方法主要针对异质性双细胞的识别，而在大多数分析场景中，这类双细胞也是最需要关注和处理的</span></span></strong><span leaf=""><span textstyle="">。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">研究者还提供了其他研究团队得到的bencmark结果，scDblFinder在平均 AUPRC 和 AUROC 值上表现最佳，并且在 10%识别率下，其精确率（precision）、召回率（recall）和真阴性率（TNR）等指标也位居首位。<img data-imgfileid="100005358" data-ratio="0.5824074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIppAefRA5x4MlkZhQDmEMIPtYeMeJBlj8f3rExVlZBbDUMt98Uq7p40Q/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIppAefRA5x4MlkZhQDmEMIPtYeMeJBlj8f3rExVlZBbDUMt98Uq7p40Q/640?wx_fmt=jpeg&amp;from=appmsg"></span></p><h4 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">分析流程</span></span><span></span></h4><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.导入</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">proj = </span><span><span leaf="">"scRNA"</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(scDblFinder)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(stringr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(qs)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(harmony)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">scRNA &lt;- qread(</span><span><span leaf="">"sce_celltype.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Idents(scRNA) &lt;- </span><span><span leaf="">"celltype"</span></span><span leaf=""><br></span><span leaf="">DimPlot(scRNA,label = </span><span><span leaf="">T</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">2.数据预处理</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 设定assay</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(BiocParallel)</span><span leaf=""><br></span><span leaf="">sc_data &lt;- as.SingleCellExperiment(scRNA)</span><span leaf=""><br></span><span leaf="">sc_data &lt;- scDblFinder(sc_data, </span><span leaf=""><br></span><span leaf="">                       samples=</span><span><span leaf="">"orig.ident"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                       BPPARAM=MulticoreParam(</span><span><span leaf="">4</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">scRNA &lt;- CreateSeuratObject(</span><span leaf=""><br></span><span leaf="">    counts = assay(sc_data, </span><span><span leaf="">"counts"</span></span><span leaf="">),  </span><span><span leaf=""># 提取基因表达矩阵</span></span><span leaf=""><br></span><span leaf="">    assay = </span><span><span leaf="">"RNA"</span></span><span leaf="">,                  </span><span><span leaf=""># 命名数据层为RNA</span></span><span leaf=""><br></span><span leaf="">    meta.data = as.data.frame(colData(sc_data))  </span><span><span leaf=""># 携带质检结果</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(scRNA$scDblFinder.class) </span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.走一遍标准化流程</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">f = </span><span><span leaf="">"sce.qs"</span></span><span leaf=""><br></span><span leaf="">sce = scRNA %&gt;% </span><span leaf=""><br></span><span leaf="">  NormalizeData() %&gt;%</span><span leaf=""><br></span><span leaf="">  FindVariableFeatures() %&gt;%</span><span leaf=""><br></span><span leaf="">  ScaleData(features = rownames(.)) %&gt;%</span><span leaf=""><br></span><span leaf="">  RunPCA(features = VariableFeatures(.))  %&gt;%</span><span leaf=""><br></span><span leaf="">  RunHarmony(group.by.vars =</span><span><span leaf="">"orig.ident"</span></span><span leaf="">)  %&gt;% </span><span leaf=""><br></span><span leaf="">  FindNeighbors(dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                verbose = </span><span><span leaf="">FALSE</span></span><span leaf="">) %&gt;%  </span><span leaf=""><br></span><span leaf="">  FindClusters(resolution = </span><span><span leaf="">0.6</span></span><span leaf="">) %&gt;% </span><span leaf=""><br></span><span leaf="">  RunUMAP(dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">) %&gt;% </span><span leaf=""><br></span><span leaf="">  RunTSNE(dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 保存对象</span></span><span leaf=""><br></span><span leaf="">qsave(sce,file = f)</span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.可视化</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">p1 &lt;- DimPlot(sce,label = </span><span><span leaf="">T</span></span><span leaf="">,group.by = </span><span><span leaf="">"celltype"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p2 &lt;- DimPlot(sce,label = </span><span><span leaf="">T</span></span><span leaf="">,group.by = </span><span><span leaf="">"scDblFinder.class"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p1|p2</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005359" data-ratio="0.4101851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIpvMcuYVlZc1WXLsDFAbjy8STotCfEa6K2ex9Tu7fEEmGd0r3ctqmvxA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIpvMcuYVlZc1WXLsDFAbjy8STotCfEa6K2ex9Tu7fEEmGd0r3ctqmvxA/640?wx_fmt=png&amp;from=appmsg">这个R包用起来感觉比DoubletFinder方便的多~</span></p></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><strong><span leaf="">注</span></strong><span leaf="">：若对内容有疑惑或者有发现明确错误的朋友，请联系后台。更多相关内容可关注公众号：</span><strong><span leaf="">生信方舟</span></strong><span leaf=""> 。</span></p><h2 data-tool="mdnice编辑器"><span></span><span></span><span><span leaf="">结尾</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">欢迎加入"</span><strong><span leaf="">生信&amp;临床</span></strong><span leaf="">“交流群，若有意向进群的小伙伴请加微信：</span><strong><span leaf="">couqiliugeziba321</span></strong><span leaf="">，请注明“</span><strong><span leaf="">单位或学校-专业或方向-姓名或昵称</span></strong><span leaf="">”。希望进群的你收获知识的同时也能够收获快乐~ 🤗<img data-imgfileid="100004857" data-ratio="0.5625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="720" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg"></span></p></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p></section></section><section><span><span leaf="">- END -</span></span></section><p><span leaf=""><br></span></p><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qBshbktGLLzLIK3QCVnsbA",target="_blank" rel="noopener noreferrer">原文链接</a>
