---
title: "å•ç»†èƒscDblFinderå¼‚è´¨æ€§åŒç»†èƒæ£€æµ‹å­¦ä¹ "
date: 2025-09-15T00:23:56Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ–¹èˆŸ"
]
categories: ["Acdemic"]
---
å•ç»†èƒscDblFinderå¼‚è´¨æ€§åŒç»†èƒæ£€æµ‹å­¦ä¹  by ç”Ÿä¿¡æ–¹èˆŸ
------
<div><section><span leaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡æ–¹èˆŸ" data-alias="shengxinfangzhou" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGfe15Xm0WHdoAMNGvE93bmxaF9iabfPiaO9ic6Tmd8XW1PMiaeuqicSFhCLQJibAUhHsamS1LbaJMFiaZXA/0?wx_fmt=png" data-signature="çƒ­çˆ±åŒ»å­¦å’Œæ•°æ®ç§‘å­¦ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œå­¦ä¹ å’Œæ•´ç†ç›¸å…³çš„çŸ¥è¯†ã€‚" data-id="MzkwMjYyMDA1OA==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></span></section><p><span leaf=""><br></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">scDblFinderåŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºåœ¨å•ç»†èƒæµ‹åºæ•°æ®ä¸­æ£€æµ‹å’Œå¤„ç†åŒç»†èƒ/å¤šç»†èƒï¼ˆå³åœ¨åŒä¸€ä¸ªæ¶²æ»´æˆ–ååº”ä½“ç³»ä¸­æ•è·äº†å¤šä¸ªç»†èƒï¼‰çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥è¡¥å……åŸºäºç»†èƒæ ‡ç­¾å’ŒSNPçš„å¤ç”¨æ ·æœ¬åŒç»†èƒæ£€æµ‹ï¼š</span><strong><span leaf=""><span textstyle="">1. å“ˆå¸Œ/åŸºå› å‹æ–¹æ³•èƒ½å¤Ÿè¯†åˆ«æ¥æºäºä¸åŒæ ·æœ¬çš„åŒç»†èƒï¼ˆå³ä½¿å®ƒä»¬æ˜¯åŒç±»å‹ç»†èƒå½¢æˆçš„åŒè´¨æ€§åŒç»†èƒï¼Œæ¯”å¦‚Aæ ·æœ¬çš„Tç»†èƒå’ŒBæ ·æœ¬çš„Tç»†èƒï¼‰ï¼Œè¿™ç§æƒ…å†µåœ¨è½¬å½•ç»„æ°´å¹³ä¸Šå¾€å¾€ä¸çœŸå®å•ç»†èƒå‡ ä¹æ— æ³•åŒºåˆ†ï¼ˆå› æ­¤æœ¬å·¥å…·åŒ…é€šå¸¸æ— æ³•è¯†åˆ«ï¼‰ï¼›2. ä½†å“ˆå¸Œ/åŸºå› å‹æ–¹æ³•è¿™ç§æ–¹æ³•æ— æ³•æ£€æµ‹æ¥è‡ªåŒä¸€æ ·æœ¬çš„åŒç»†èƒï¼Œå³ä½¿å®ƒä»¬æ˜¯ç”±ä¸åŒç»†èƒç±»å‹å½¢æˆçš„å¼‚è´¨æ€§åŒç»†èƒ</span></span></strong><span leaf=""><span textstyle="">ã€‚</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç›¸æ¯”ä¹‹ä¸‹ï¼Œ</span><strong><span leaf=""><span textstyle="">scDblFinder æä¾›çš„æ–¹æ³•ä¸»è¦é’ˆå¯¹å¼‚è´¨æ€§åŒç»†èƒçš„è¯†åˆ«ï¼Œè€Œåœ¨å¤§å¤šæ•°åˆ†æåœºæ™¯ä¸­ï¼Œè¿™ç±»åŒç»†èƒä¹Ÿæ˜¯æœ€éœ€è¦å…³æ³¨å’Œå¤„ç†çš„</span></span></strong><span leaf=""><span textstyle="">ã€‚</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç ”ç©¶è€…è¿˜æä¾›äº†å…¶ä»–ç ”ç©¶å›¢é˜Ÿå¾—åˆ°çš„bencmarkç»“æœï¼ŒscDblFinderåœ¨å¹³å‡ AUPRC å’Œ AUROC å€¼ä¸Šè¡¨ç°æœ€ä½³ï¼Œå¹¶ä¸”åœ¨ 10%è¯†åˆ«ç‡ä¸‹ï¼Œå…¶ç²¾ç¡®ç‡ï¼ˆprecisionï¼‰ã€å¬å›ç‡ï¼ˆrecallï¼‰å’ŒçœŸé˜´æ€§ç‡ï¼ˆTNRï¼‰ç­‰æŒ‡æ ‡ä¹Ÿä½å±…é¦–ä½ã€‚<img data-imgfileid="100005358" data-ratio="0.5824074074074074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIppAefRA5x4MlkZhQDmEMIPtYeMeJBlj8f3rExVlZBbDUMt98Uq7p40Q/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIppAefRA5x4MlkZhQDmEMIPtYeMeJBlj8f3rExVlZBbDUMt98Uq7p40Q/640?wx_fmt=jpeg&amp;from=appmsg"></span></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">åˆ†ææµç¨‹</span></span><span></span></h4><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">1.å¯¼å…¥</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">proj =Â </span><span><span leaf="">"scRNA"</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(scDblFinder)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(stringr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(qs)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(harmony)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">scRNA &lt;- qread(</span><span><span leaf="">"sce_celltype.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Idents(scRNA) &lt;-Â </span><span><span leaf="">"celltype"</span></span><span leaf=""><br></span><span leaf="">DimPlot(scRNA,label =Â </span><span><span leaf="">T</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">2.æ•°æ®é¢„å¤„ç†</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># è®¾å®šassay</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(BiocParallel)</span><span leaf=""><br></span><span leaf="">sc_data &lt;- as.SingleCellExperiment(scRNA)</span><span leaf=""><br></span><span leaf="">sc_data &lt;- scDblFinder(sc_data,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â samples=</span><span><span leaf="">"orig.ident"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â BPPARAM=MulticoreParam(</span><span><span leaf="">4</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">scRNA &lt;- CreateSeuratObject(</span><span leaf=""><br></span><span leaf="">Â  Â  counts = assay(sc_data,Â </span><span><span leaf="">"counts"</span></span><span leaf="">), Â </span><span><span leaf=""># æå–åŸºå› è¡¨è¾¾çŸ©é˜µ</span></span><span leaf=""><br></span><span leaf="">Â  Â  assay =Â </span><span><span leaf="">"RNA"</span></span><span leaf="">, Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># å‘½åæ•°æ®å±‚ä¸ºRNA</span></span><span leaf=""><br></span><span leaf="">Â  Â  meta.data = as.data.frame(colData(sc_data)) Â </span><span><span leaf=""># æºå¸¦è´¨æ£€ç»“æœ</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(scRNA$scDblFinder.class)Â </span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">3.èµ°ä¸€éæ ‡å‡†åŒ–æµç¨‹</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">f =Â </span><span><span leaf="">"sce.qs"</span></span><span leaf=""><br></span><span leaf="">sce = scRNA %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  NormalizeData() %&gt;%</span><span leaf=""><br></span><span leaf="">Â  FindVariableFeatures() %&gt;%</span><span leaf=""><br></span><span leaf="">Â  ScaleData(features = rownames(.)) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  RunPCA(features = VariableFeatures(.)) Â %&gt;%</span><span leaf=""><br></span><span leaf="">Â  RunHarmony(group.by.vars =</span><span><span leaf="">"orig.ident"</span></span><span leaf="">) Â %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  FindNeighbors(dims =Â </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  reduction =Â </span><span><span leaf="">"harmony"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  verbose =Â </span><span><span leaf="">FALSE</span></span><span leaf="">) %&gt;% Â </span><span leaf=""><br></span><span leaf="">Â  FindClusters(resolution =Â </span><span><span leaf="">0.6</span></span><span leaf="">) %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  RunUMAP(dims =Â </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,reduction =Â </span><span><span leaf="">"harmony"</span></span><span leaf="">) %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  RunTSNE(dims =Â </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">15</span></span><span leaf="">,reduction =Â </span><span><span leaf="">"harmony"</span></span><span leaf="">)Â </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># ä¿å­˜å¯¹è±¡</span></span><span leaf=""><br></span><span leaf="">qsave(sce,file = f)</span><span leaf=""><br></span></code></pre><h5 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">4.å¯è§†åŒ–</span></span><span></span></h5><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">p1 &lt;- DimPlot(sce,label =Â </span><span><span leaf="">T</span></span><span leaf="">,group.by =Â </span><span><span leaf="">"celltype"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p2 &lt;- DimPlot(sce,label =Â </span><span><span leaf="">T</span></span><span leaf="">,group.by =Â </span><span><span leaf="">"scDblFinder.class"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p1|p2</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100005359" data-ratio="0.4101851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIpvMcuYVlZc1WXLsDFAbjy8STotCfEa6K2ex9Tu7fEEmGd0r3ctqmvxA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGUf2Sc6ZDV5jZh91xcJNIpvMcuYVlZc1WXLsDFAbjy8STotCfEa6K2ex9Tu7fEEmGd0r3ctqmvxA/640?wx_fmt=png&amp;from=appmsg">è¿™ä¸ªRåŒ…ç”¨èµ·æ¥æ„Ÿè§‰æ¯”DoubletFinderæ–¹ä¾¿çš„å¤š~</span></p></section><p><span leaf=""><br></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æ³¨</span></strong><span leaf="">ï¼šè‹¥å¯¹å†…å®¹æœ‰ç–‘æƒ‘æˆ–è€…æœ‰å‘ç°æ˜ç¡®é”™è¯¯çš„æœ‹å‹ï¼Œè¯·è”ç³»åå°ã€‚æ›´å¤šç›¸å…³å†…å®¹å¯å…³æ³¨å…¬ä¼—å·ï¼š</span><strong><span leaf="">ç”Ÿä¿¡æ–¹èˆŸ</span></strong><span leaf="">Â ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span></span><span><span leaf="">ç»“å°¾</span></span><span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¬¢è¿åŠ å…¥"</span><strong><span leaf="">ç”Ÿä¿¡&amp;ä¸´åºŠ</span></strong><span leaf="">â€œäº¤æµç¾¤ï¼Œè‹¥æœ‰æ„å‘è¿›ç¾¤çš„å°ä¼™ä¼´è¯·åŠ å¾®ä¿¡ï¼š</span><strong><span leaf="">couqiliugeziba321</span></strong><span leaf="">ï¼Œè¯·æ³¨æ˜â€œ</span><strong><span leaf="">å•ä½æˆ–å­¦æ ¡-ä¸“ä¸šæˆ–æ–¹å‘-å§“åæˆ–æ˜µç§°</span></strong><span leaf="">â€ã€‚å¸Œæœ›è¿›ç¾¤çš„ä½ æ”¶è·çŸ¥è¯†çš„åŒæ—¶ä¹Ÿèƒ½å¤Ÿæ”¶è·å¿«ä¹~ ğŸ¤—<img data-imgfileid="100004857" data-ratio="0.5625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="720" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg"></span></p></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p></section></section><section><span><span leaf="">- END -</span></span></section><p><span leaf=""><br></span></p><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qBshbktGLLzLIK3QCVnsbA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
