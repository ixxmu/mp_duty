---
title: "单细胞西北特供营No.11：Python分析单细胞数据"
date: 2025-09-01T00:22:14Z
draft: ["false"]
tags: [
  "fetched",
  "周运来就是我"
]
categories: ["Acdemic"]
---
单细胞西北特供营No.11：Python分析单细胞数据 by 周运来就是我
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-pm-slice="0 0 []"><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><section><section><section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg></section></section><section><section><p><span><strong></strong><span><strong><span leaf="">第11期</span><span leaf=""><br></span></strong></span></span></p><p><span><strong><strong><span leaf="">前情回顾</span></strong></strong></span></p></section></section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg><section><section><section><section><p><span leaf=""><br></span></p></section></section></section></section><hr><p><span leaf=""><br></span></p><section><section><section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg></section></section><section><section><p><span><strong></strong><span><strong><span leaf="">第十期</span><span leaf=""><br></span></strong></span></span></p><p><span><strong><strong><span leaf="">彩练当空·2024</span></strong></strong></span></p></section></section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg><p><span leaf=""><br></span></p></section></section></section></section></section><p><span leaf=""><br></span></p><section><section><section><section><p><span leaf=""><br></span></p></section></section></section></section><hr><p><span leaf=""><br></span></p><section><section><section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg></section></section><section><section><p><span><strong></strong><span><strong><span leaf="">第十期</span><span leaf=""><br></span></strong></span></span></p><p><span><strong><strong><span leaf="">彩练当空·2024</span></strong></strong></span></p></section></section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg><p><span leaf=""><br></span></p></section></section></section></section></section><p><span leaf=""><br></span></p></section></section></section></section></section><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015540&amp;idx=1&amp;sn=e3476f530d78d1109b4636bcd79ff8a2&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.10：多样本单细胞分析，批次到底怎么判断？" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.10-1：多样本单细胞分析，批次到底怎么判断？</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015530&amp;idx=1&amp;sn=103acc686c7ebf51902c8fb9031cb4ed&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.10：最好的单细胞入门R包，Seurat，没有之一" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.10：最好的单细胞入门R包，Seurat，没有之一</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015518&amp;idx=1&amp;sn=58c8daa089fed141c90f6761e615f17c&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.9：单细胞高级分析条目" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.9：单细胞高级分析条目</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015507&amp;idx=1&amp;sn=cb35b471641feb00266feb3fca348e12&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.8：单细胞分析框架与标准流程" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.8：单细胞分析框架与标准流程</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015495&amp;idx=1&amp;sn=b85d7b50cc9c08b302e549c2cc247f34&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.7-1：R语言数据科学实战" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.7-1：R语言数据科学实战</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015483&amp;idx=1&amp;sn=1d71cf26ccb4d416220261e6c9ec773c&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.7：R和R studio下载与安装" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.7：R和R studio下载与安装</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015474&amp;idx=1&amp;sn=97b59fd4fa19fac1cdc1f088607224a9&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.6：从测序数据到表达矩阵" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.6：从测序数据到表达矩阵</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015463&amp;idx=1&amp;sn=ad0d3f904551df14ae6edce9b6a87c2a&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.4-5：生信躲不开Linux" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.4-5：生信躲不开Linux</a></span></p></section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015451&amp;idx=1&amp;sn=a42f55e1f2ddfb863e1850f0042b34d9&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.3：单细胞数据科学概念与过程" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.3：单细胞数据科学概念与过程</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015434&amp;idx=1&amp;sn=0d42148db5d496db4475571dc3622034&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.2：单细胞多组学新技术" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.2：单细胞多组学新技术</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015403&amp;idx=1&amp;sn=71fc9890bf1310234592ad8ea4f3e454&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.1: 单细胞研究思路与案例" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.1: 单细胞研究思路与案例</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0OTIxNTY1NQ==&amp;mid=2652015402&amp;idx=1&amp;sn=76569d168313dfe172841715534a5699&amp;scene=21#wechat_redirect" textvalue="单细胞西北特供营No.0: 个人单细胞生信学习经验分享" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞西北特供营No.0: 个人单细胞生信学习经验分享</a></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">毕业之后，一直从事生命科学与医学的基础科研服务工作，2019年开始，接触西北五省(陕西、甘肃、青海、宁夏、新疆)单细胞与空间组学方向的科学团队。实际科研项目的合作以及如</span><strong><span leaf="">《现代医学之源：西北联大与西北医学事业》</span></strong><span leaf="">的阅读，让我对西北区域开展生命科学与医学研究的主要方向有了些许认识，如注重医工交叉、生态学、高原生物、高原医学、民族医学等。在踏上这片广袤土地的第一刻，我就在思考：如何为这里的科学家，提供更好的单细胞与空间组学技术服务。</span></p><p data-tool="mdnice编辑器"><span leaf="">工作中勤勤恳恳，推进科研项目进展，与科学家一道发文章、促转化。这自然是分内之事。最近有朋友建议，还可以把这些年做自己单细胞与空间组学的经验释放出来，特别是2015年至今做生物信息分析的经验。</span></p><p data-tool="mdnice编辑器"><span leaf="">于是，有了这个系列：单细胞西北特供营二十三章。</span></p><p data-tool="mdnice编辑器"><span leaf="">西北五省生命科学与医学课题组可免费领取每一章的课件(不是一次性的)，也可以约我线上或线下分享、讲解、培训，内容可以涵盖单细胞、空间组学、生物信息、人工智能大模型(仅限虚拟细胞和CellFM)。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWt7ZXcCKJcrXoEVvB1udyZzcDc4Ks9PLaOyiblcx97Zh0K2aYKkO26XA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.358187134502924" data-type="png" data-w="684" data-imgfileid="504531903" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWt7ZXcCKJcrXoEVvB1udyZzcDc4Ks9PLaOyiblcx97Zh0K2aYKkO26XA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">所有高亮的内容，都是我几乎每年更新的课件，里面也容纳了单细胞与空间组学的样本处理、数据分析、环境部署、课后答疑的经验。因生信答疑而在学术文章中致谢我的有几篇呐。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWhmLbVQqfn1U37LnXHNy8P2HzicCN8TRSp29DtpQF1XSic5VYgfn6VUTA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9556962025316456" data-type="png" data-w="158" data-imgfileid="504531904" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWhmLbVQqfn1U37LnXHNy8P2HzicCN8TRSp29DtpQF1XSic5VYgfn6VUTA/640?wx_fmt=png&amp;from=appmsg"></span></figure><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="3 13 []"><p data-pm-slice="0 0 []"><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><section><section><section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg></section></section><section><section><p><span><strong></strong><span><strong><span leaf="">第11期</span><span leaf=""><br></span></strong></span></span></p><p><span><strong><strong><span leaf="">Python单细胞数据分析</span></strong></strong></span></p></section></section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg><section><section><section><section><p><span leaf=""><br></span></p></section></section></section></section></section></section></section></section></section></section></section><p data-tool="mdnice编辑器"><span leaf="">就我个人而言，是先学习了R语言，之后再学习Python的。单细胞数据分析这两年随着数据量的增加，和python分析工具的成熟，python也成为单细胞生物信息入门语言之一。</span></p><p data-tool="mdnice编辑器"><span leaf="">在入门单细胞数据分析的时候，有两个语言摆在面前，一个是R语言，一个是Python。有时候会有纠结，到底学哪个比较好？只要选好一个，大部分的概念是相通的，不推荐两门语言一起学习。</span></p><p data-tool="mdnice编辑器"><span leaf="">这个文档本身有大量技术细节和代码示例，大部分来自scanpy的官网，更让我们知道python分析单细胞数据的库、包、参数。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="504531907" data-ratio="0.4583333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWb0liaL7rW6A5ooQj06wEHubGPHULLicY8EBOL99Ls78w9zlgdicia8JSVQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWb0liaL7rW6A5ooQj06wEHubGPHULLicY8EBOL99Ls78w9zlgdicia8JSVQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这里我们先从单细胞分析的技术需求切入，再分模块说明课件内容，最后强调学习资源。需要特别突出两点：</span></p><ul><li><section><span leaf="">一是Python生态的优势（处理大规模数据更高效），</span></section></li><li><section><span leaf="">二是实操性（包含完整代码流程和可视化案例）。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">至少让我们知道，文章中看起来很炫酷的图，在这里也讲究几行代码。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">sc.pl.heatmap(pbmc, marker_genes_dict, groupby=</span><span><span leaf="">'clusters'</span></span><span leaf="">, cmap=</span><span><span leaf="">'viridis'</span></span><span leaf="">, dendrogram=True)</span><span leaf=""><br></span><span leaf="">plt.savefig(</span><span><span leaf="">'plot/gene_heat.png'</span></span><span leaf="">, bbox_inches=</span><span><span leaf="">"tight"</span></span><span leaf="">, dpi=100) ; plt.close()</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sc.pl.tracksplot(pbmc, marker_genes_dict, groupby=</span><span><span leaf="">'clusters'</span></span><span leaf="">, dendrogram=True)</span><span leaf=""><br></span><span leaf="">plt.savefig(</span><span><span leaf="">'plot/gene_track.png'</span></span><span leaf="">, bbox_inches=</span><span><span leaf="">"tight"</span></span><span leaf="">, dpi=100) ; plt.close()</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOW0H7eSp2QLfiaSSStFYDrhZibzWibFQErdGsojF4WJmVIblAhPV2ibUXzMQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.34444444444444444" data-type="png" data-w="1080" data-imgfileid="504531905" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOW0H7eSp2QLfiaSSStFYDrhZibzWibFQErdGsojF4WJmVIblAhPV2ibUXzMQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">对于医学课题组，还要强调课件中肝癌研究的真实数据案例（GSE125449数据集），这能直接体现方法学的应用价值。技术细节如</span><strong><span leaf="">AnnData</span></strong><span leaf="">数据结构可以提及但不用深入，课题组更关心的是如何快速上手解决实际问题。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWBmJ9vGAr5IhxtvAIWUueUqQ7LCrL3dNSHG823gWyrmBWwbicMhZibncw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3814814814814815" data-type="png" data-w="1080" data-imgfileid="504531906" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWBmJ9vGAr5IhxtvAIWUueUqQ7LCrL3dNSHG823gWyrmBWwbicMhZibncw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">简单提一下关于Scanpy vs Seurat的对比，主要集中在三个维度：语言特性、计算效率、可视化能力。值得强调的是：</span></p><ul><li><section><span leaf="">1 效率优势部分有实验数据支持——Scanpy处理百万级细胞时显著优于Seurat，这在大规模临床样本分析中至关重要。但需说明测试环境（如是否相同硬件）。</span></section></li><li><section><span leaf="">2 R的交互式可视化确实更友好，但文档提到Scanpy可通过Matplotlib定制。</span></section></li><li><section><span leaf="">3 实际案例中的肝癌微环境研究（GSE125449）展示了Scanpy处理真实数据的能力，特别是细胞周期校正和亚群注释的代码示例，能打消用户对Python分析深度的疑虑。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">需要规避的误区：不能贬低R的价值。应强调Seurat在算法创新（如SCTransform）和社区支持上的优势，建议互补使用。例如差异分析用Seurat，流程化大数据用Scanpy。</span></p><p data-tool="mdnice编辑器"><span leaf="">今年这本用python实现的单细胞数据分析电子书，我看有小伙伴在翻译，也是一份不错的学习一文档。https://www.sc-best-practices.org/preamble.html#</span></p><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWoWTlkvHkH2WseGKvzguDUMf3LMZRQw6Xreumv0l3R7XagXMyX64cxQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4935185185185185" data-type="png" data-w="1080" data-imgfileid="504531911" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOWoWTlkvHkH2WseGKvzguDUMf3LMZRQw6Xreumv0l3R7XagXMyX64cxQ/640?wx_fmt=png&amp;from=appmsg"></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><section><section><section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg></section></section><section><section><p><span><strong></strong><span><strong><span leaf="">第11期</span><span leaf=""><br></span></strong></span></span></p><p><span><strong><strong><span leaf="">真情推荐</span></strong></strong></span></p></section></section><section><section><svg viewbox="0 0 1 1" role="img" aria-label="插图"></svg><section><section><section><section><p><span leaf=""><br></span></p></section></section></section></section></section></section></section></section></section></section><p><span leaf=""><br></span></p><p data-tool="mdnice编辑器"><span leaf="">在这二十三章中，每一章的PPT最后，我都尽量放上推荐阅读，以拓宽培训课的知识面。在思考整体性的同时，也兼顾连续性，那么，如何领取特供材料或参与培训，或想让我看看手里的样本适不适合做单细胞测序呢？关于单细胞与空间组学的一切：</span></p><blockquote><p><span leaf="">单细胞西北特供人：15850542986，周运来。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">也欢迎转发给身边关心单细胞与空间技术的亲戚、老师、同学、朋友。</span></p><p data-tool="mdnice编辑器"><span leaf="">下期预告：《</span><strong><span leaf="">12. 单细胞数据科学中的项目管理.pdf</span></strong><span leaf="">》</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOW1V5YIUu1iaQAPYNZjXFDnKCeqsbWeZaIlDq9vwUYTYtOT1ogwZRUbTQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.47413793103448276" data-type="png" data-w="580" data-imgfileid="504531909" src="https://mmbiz.qpic.cn/mmbiz_png/rt6BleHxlicm4vzXibEPFT0bPmh6NvlXOW1V5YIUu1iaQAPYNZjXFDnKCeqsbWeZaIlDq9vwUYTYtOT1ogwZRUbTQ/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LvOKXz_dp6qztUQ2vZwWnQ",target="_blank" rel="noopener noreferrer">原文链接</a>
