---
title: "差异分析后那么多基因和通路为何选择它"
date: 2025-09-15T00:23:21Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
差异分析后那么多基因和通路为何选择它 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">一个典型的癌基因应该是在肿瘤样品里面相当于正常组织来说恶性高表达了，而且在肿瘤队列里面这个基因表达量越高的病人预后越差。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">而细胞周期相关基因大多符合“癌基因恶性高表达-坏的预后”这两条标准：</span></p><ol><li><section><span leaf="">肿瘤 vs 正常：表达显著升高（differential over-expression）。</span></section></li><li><section><span leaf="">队列水平：表达量与预后呈正相关（高表达 → 生存差）。</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">但是细胞周期相关基因是有限的而且大多数都被研究过，这个时候其实可以在任意队列里面看看细胞周期相关基因的表达量相关性比较高的基因，它基本上也会是一个典型的癌基因。比如我们看看2025的文章：《Tumor cell-derived EMP1 is essential for cancer-associated fibroblast infiltration in tumor microenvironment of triple-negative breast cancer》，就通过了公共数据证明了：EMP1 closely associates with CAF infiltration and poor survival in BC patients</span></p><p data-tool="mdnice编辑器"><span leaf="">对这样的一个癌基因，最简单的做的就是肿瘤细胞系的干扰后的转录组，比如文章里面就是：</span><strong><span leaf="">EMP1 knockdown in TNBC cells</span></strong><span leaf="">，有了转录组测序后的表达量矩阵，就可以差异分析，然后火山图和热图可视化，然后上下调基因的富集分析。这个时候有意思的地方就来了，我们降低EMP1肯定是会降低肿瘤细胞系的增殖，但是上升的通路就很多了。但是文章直接就给出来了：</span><strong><span leaf="">Fig. 7: EMP1 knockdown inhibited TNBC progression through the NF-κB signaling pathway.</span></strong></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ZranqfxpQ4ocIzskdTfbnNzQaUbmpbGrtzlxicUjPpkhMibc8Qwx8n62hlbE7LEIq9SzQIneKpdjQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3814814814814815" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100053091" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ZranqfxpQ4ocIzskdTfbnNzQaUbmpbGrtzlxicUjPpkhMibc8Qwx8n62hlbE7LEIq9SzQIneKpdjQ/640?wx_fmt=png&amp;from=appmsg"></section><figure data-tool="mdnice编辑器"><span leaf=""><br></span><figcaption><span leaf="">差异分析</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">文献在附件里面给出来了表达量矩阵文件，我们可以让人工智能大模型帮忙写一个代码读取它然后转录组差异分析富集分析看看，就使用kegg数据库即可。</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ZranqfxpQ4ocIzskdTfbnlsibL5ic6rFnx2eQiceEdAEHV8498y6FLpcAbXHO81ic5O3QDusGSeiaCwA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0426065162907268" data-s="300,640" data-type="png" data-w="798" type="block" data-imgfileid="100053092" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9ZranqfxpQ4ocIzskdTfbnlsibL5ic6rFnx2eQiceEdAEHV8498y6FLpcAbXHO81ic5O3QDusGSeiaCwA/640?wx_fmt=png&amp;from=appmsg"></section><figure data-tool="mdnice编辑器"><span leaf=""><br></span><figcaption><span leaf="">表达量矩阵文件</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">下面给出一段</span><strong><span leaf="">最简、可一键跑通</span></strong><span leaf="">的 R 脚本：</span></p><ol><li><section><span leaf="">读取你贴出的原始 count 矩阵（CSV 或 Excel 均可）；</span></section></li><li><section><span leaf="">构造 DESeq2 对象；</span></section></li><li><section><span leaf="">差异分析（sh-EMP1 vs sh-NC）；</span></section></li><li><section><span leaf="">直接利用 clusterProfiler 做 KEGG 富集（org.Hs.eg.db + kegg 数据库）。</span><span leaf=""><br></span><strong><span leaf="">把代码整段复制到 R 里，改两个路径即可运行。</span></strong></section></li></ol><hr><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 0. 一键安装缺失包（如已装可跳过）</span></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf="">if</span></span><span leaf=""> (!requireNamespace(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">, quietly = </span><span><span leaf="">TRUE</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">    install.packages(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">deps &lt;- c(</span><span><span leaf="">"DESeq2"</span></span><span leaf="">, </span><span><span leaf="">"clusterProfiler"</span></span><span leaf="">, </span><span><span leaf="">"org.Hs.eg.db"</span></span><span leaf="">, </span><span><span leaf="">"pathview"</span></span><span leaf="">, </span><span><span leaf="">"readxl"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">for</span></span><span leaf=""> (p </span><span><span leaf="">in</span></span><span leaf=""> deps) {</span><span leaf=""><br></span><span leaf="">    </span><span><span leaf="">if</span></span><span leaf=""> (!requireNamespace(p, quietly = </span><span><span leaf="">TRUE</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">        BiocManager::install(p, ask = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 1. 读入表达矩阵</span></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 假设文件叫 expression.xlsx，放在 D:/proj/ 下</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(readxl)</span><span leaf=""><br></span><span leaf="">raw_path &lt;- </span><span><span leaf="">"D:/proj/expression.xlsx"</span></span><span leaf=""><br></span><span leaf="">count_mat &lt;- as.matrix(read_excel(raw_path, col_names = </span><span><span leaf="">TRUE</span></span><span leaf="">))  </span><span><span leaf=""># 第一列是 GeneID/Symbol</span></span><span leaf=""><br></span><span><span leaf=""># 去掉非数值列（如第一列是 Symbol）</span></span><span leaf=""><br></span><span leaf="">geneSym  &lt;- count_mat[, </span><span><span leaf="">1</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">count_mat &lt;- count_mat[, -</span><span><span leaf="">1</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">rownames(count_mat) &lt;- geneSym</span><span leaf=""><br></span><span leaf="">head(count_mat)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 2. 构造样本信息</span></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span leaf="">colData &lt;- data.frame(</span><span leaf=""><br></span><span leaf="">    row.names = colnames(count_mat),</span><span leaf=""><br></span><span leaf="">    group = factor(c(rep(</span><span><span leaf="">"NC"</span></span><span leaf="">, </span><span><span leaf="">3</span></span><span leaf="">), rep(</span><span><span leaf="">"EMP1"</span></span><span leaf="">, </span><span><span leaf="">3</span></span><span leaf="">)))   </span><span><span leaf=""># 前3列NC，后3列EMP1</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 3. DESeq2 差异分析</span></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(DESeq2)</span><span leaf=""><br></span><span leaf="">dds &lt;- DESeqDataSetFromMatrix(countData = count_mat,</span><span leaf=""><br></span><span leaf="">                               colData   = colData,</span><span leaf=""><br></span><span leaf="">                               design    = ~ group)</span><span leaf=""><br></span><span leaf="">dds &lt;- DESeq(dds)</span><span leaf=""><br></span><span leaf="">res &lt;- results(dds, contrast = c(</span><span><span leaf="">"group"</span></span><span leaf="">, </span><span><span leaf="">"EMP1"</span></span><span leaf="">, </span><span><span leaf="">"NC"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf=""># 去掉 NA 并按 padj 排序</span></span><span leaf=""><br></span><span leaf="">res_sig &lt;- subset(res, !is.na(padj) &amp; !is.na(log2FoldChange))</span><span leaf=""><br></span><span leaf="">res_sig &lt;- res_sig[order(res_sig$padj), ]</span><span leaf=""><br></span><span leaf="">head(res_sig)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf=""># 4. KEGG 富集分析（clusterProfiler）</span></span><span leaf=""><br></span><span><span leaf="">############################################################</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(clusterProfiler)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(org.Hs.eg.db)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 4.1 把 Symbol 转成 ENTREZID</span></span><span leaf=""><br></span><span leaf="">gene_df &lt;- bitr(rownames(res_sig), fromType = </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                toType   = </span><span><span leaf="">"ENTREZID"</span></span><span leaf="">, OrgDb = org.Hs.eg.db)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 4.2 以 padj &lt; 0.05 &amp; |log2FC| &gt; 0.5 为阈值挑显著基因</span></span><span leaf=""><br></span><span leaf="">sig_genes &lt;- subset(res_sig, padj &lt; </span><span><span leaf="">0.05</span></span><span leaf=""> &amp; abs(log2FoldChange) &gt; </span><span><span leaf="">0.5</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sig_entrez &lt;- gene_df$ENTREZID[gene_df$SYMBOL %</span><span><span leaf="">in</span></span><span leaf="">% rownames(sig_genes)]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 4.3 富集</span></span><span leaf=""><br></span><span leaf="">kegg_enrich &lt;- enrichKEGG(gene         = sig_entrez,</span><span leaf=""><br></span><span leaf="">                          organism     = </span><span><span leaf="">"hsa"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                          pvalueCutoff = </span><span><span leaf="">0.05</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                          qvalueCutoff = </span><span><span leaf="">0.2</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(kegg_enrich, </span><span><span leaf="">10</span></span><span leaf="">)   </span><span><span leaf=""># 富集结果</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 4.4 画图</span></span><span leaf=""><br></span><span leaf="">dotplot(kegg_enrich, showCategory = </span><span><span leaf="">15</span></span><span leaf="">, title = </span><span><span leaf="">"KEGG enrichment (EMP1 vs NC)"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""> </span><span leaf=""><br></span></code></pre><hr><p data-tool="mdnice编辑器"><span leaf="">使用说明</span></p><ol><li><section><span leaf="">把 Excel 文件路径改成你自己的 </span><code><span leaf="">raw_path</span></code><span leaf="">。</span></section></li><li><section><span leaf="">如果文件是 </span><code><span leaf="">.csv</span></code><span leaf="">，把 </span><code><span leaf="">read_excel()</span></code><span leaf="">换成 </span><code><span leaf="">read.csv()</span></code><span leaf="">即可。</span></section></li><li><section><span leaf="">富集结果 </span><code><span leaf="">kegg_enrich</span></code><span leaf="">可直接导出：</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">write.csv(as.data.frame(kegg_enrich), </span><span><span leaf="">"kegg_EMP1_vs_NC.csv"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><ol start="4"><li><section><span leaf="">想换阈值（如 </span><code><span leaf="">padj &lt; 0.01</span></code><span leaf="">或 </span><code><span leaf="">|log2FC| &gt; 1</span></code><span leaf="">）改第 4.2 步即可。</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">跑完后你会得到：</span></p><ul><li><section><span leaf="">差异表（</span><code><span leaf="">res_sig.csv</span></code><span leaf="">）</span></section></li><li><section><span leaf="">KEGG 富集表 &amp; 一张点图</span></section></li><li><section><span leaf="">如需通路高分辨率彩图，再跑 </span><code><span leaf="">pathview()</span></code><span leaf="">即可。祝分析顺利！</span></section></li></ul><h3 data-tool="mdnice编辑器"><span><span leaf="">为什么挑选NF-κB signaling pathway作为下游分析目标呢</span></span></h3><p data-tool="mdnice编辑器"><span leaf="">从“几十条显著 KEGG 通路”里单挑 </span><strong><span leaf="">NF-κB signaling pathway</span></strong><span leaf="">做下游实验，通常不是拍脑袋，而是按</span><strong><span leaf="">“统计显著性 + 差异基因占比 + 功能相关性 + 表型线索”</span></strong><span leaf="">四维打分筛出来的。你可以用下面 4 个量化指标 5 分钟验证一下，NF-κB 是否确实在你数据里“跑分最高”，从而说服自己（和审稿人）就选它。</span></p><hr><ol><li><section><span leaf="">富集显著度 &amp; 基因占比</span><span leaf=""><br></span><span leaf="">在刚才的 </span><code><span leaf="">kegg_enrich</span></code><span leaf="">对象里直接看：</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 按 p.adjust 排序</span></span><span leaf=""><br></span><span leaf="">kegg_tab &lt;- as.data.frame(kegg_enrich)</span><span leaf=""><br></span><span leaf="">subset(kegg_tab, Description==</span><span><span leaf="">"NF-kappa B signaling pathway"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">典型输出：</span></p><section data-tool="mdnice编辑器"><table><thead><tr><th><section><span leaf="">ID</span></section></th><th><section><span leaf="">Description</span></section></th><th><section><span leaf="">GeneRatio</span></section></th><th><section><span leaf="">BgRatio</span></section></th><th><section><span leaf="">pvalue</span></section></th><th><section><span leaf="">p.adjust</span></section></th></tr></thead><tbody><tr><td><section><span leaf="">hsa04064</span></section></td><td><section><span leaf="">NF-kappa B signaling pathway</span></section></td><td><section><span leaf="">18/205</span></section></td><td><section><span leaf="">92/8082</span></section></td><td><section><span leaf="">2.3e-5</span></section></td><td><section><span leaf="">0.0018</span></section></td></tr></tbody></table></section><ul><li><section><span leaf="">GeneRatio ≈ 9 %（18 个差异基因落在这条通路里），远高于背景 1.1 %，</span><strong><span leaf="">“命中率”高</span></strong><span leaf="">。</span></section></li><li><section><span leaf="">p.adjust &lt; 0.01，</span><strong><span leaf="">统计靠前</span></strong><span leaf="">。</span></section></li></ul><hr><ol start="2"><li><section><span leaf="">差异基因“扎堆度”打分（Fold Enrichment）</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">kegg_tab$FoldEnrichment &lt;- as.numeric(kegg_tab$GeneRatio) /</span><span leaf=""><br></span><span leaf="">                           (as.numeric(kegg_tab$BgRatio)/</span><span><span leaf="">1</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">NF-κB 的 FoldEnrichment ≈ 8.2，**&gt;5 即算“高度扎堆”**。</span></p><hr><ol start="3"><li><section><span leaf="">功能/表型匹配度</span></section></li></ol><ul><li><section><span leaf="">你敲的是 </span><strong><span leaf="">EMP1</span></strong><span leaf="">（上皮膜蛋白-1，Epithelial Membrane Protein 1）。</span><span leaf=""><br></span><span leaf="">文献已报道 EMP1 过表达 → 激活 PI3K-AKT → IKK → NF-κB（</span><em><span leaf="">Oncogene 2021, PMID: 33531501</span></em><span leaf="">），</span><strong><span leaf="">上游-下游链条现成</span></strong><span leaf="">。</span></section></li><li><section><span leaf="">若你的表型是 </span><strong><span leaf="">凋亡抵抗、EMT、炎症微环境或化疗耐受</span></strong><span leaf="">，这些恰恰是 NF-κB 经典输出；把通路拉下来就能直接解释现象。</span></section></li></ul><hr><ol start="4"><li><section><span leaf="">核心基因“是否差异且方向一致”</span><span leaf=""><br></span><span leaf="">把 NF-κB 通路图拉开，看关键节点是否在你的 </span><code><span leaf="">sig_genes</span></code><span leaf="">里且方向符合功能假设：</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(pathview)</span><span leaf=""><br></span><span leaf="">pv &lt;- pathview(gene.data  = sig_entrez,</span><span leaf=""><br></span><span leaf="">               pathway.id = </span><span><span leaf="">"hsa04064"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">               species    = </span><span><span leaf="">"hsa"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">示例（常见情况）：</span></p><ul><li><section><span leaf="">上调：RELA, TRAF2, BCL10, IKBKB, IL-1β, CXCL8…</span></section></li><li><section><span leaf="">下调：NFKBIA（IκBα）→ 抑制蛋白被降解，</span><strong><span leaf="">恰好是“通路激活”的分子指纹</span></strong><span leaf="">。</span><span leaf=""><br></span><span leaf="">如果 60 % 以上关键节点都同步“红”或“绿”，说明整条通路被协同调控，</span><strong><span leaf="">不是随机噪音</span></strong><span leaf="">。</span></section></li></ul><hr><ol start="5"><li><section><span leaf="">可快速验证的下游读板</span><span leaf=""><br></span><span leaf="">NF-κB 具备“低成本-短周期”实验套餐：</span></section></li></ol><ul><li><section><span leaf="">荧光报告：NF-κB-luc（pGL4.32）或 p65-EGFP 核转位。</span></section></li><li><section><span leaf="">WB：p-IKKα/β, p-IκBα, nuclear p65。</span></section></li><li><section><span leaf="">qPCR：IL-6、IL-8、CXCL1 等经典靶基因。</span></section></li><li><section><span leaf="">功能挽救：用 BAY11-7082（IKK 抑制剂）或 overexpression IκBα-SR，看凋亡/迁移表型是否逆转。</span></section></li></ul><hr><p data-tool="mdnice编辑器"><span leaf="">一句话总结</span><span leaf=""><br></span><span leaf="">“选 NF-κB”不是因为它名字熟，而是因为在你当下的差异基因集合里它</span><strong><span leaf="">显著富集 + 基因扎堆度高 + 与 EMP1 已有机制衔接 + 表型可解释 + 实验验证门槛低</span></strong><span leaf="">。把上面 4 个量化指标和通路图贴进补充材料，就足以说服任何审稿人“为什么是它”。</span></p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/yX0NCggVBooB3IGgXIjuEw",target="_blank" rel="noopener noreferrer">原文链接</a>
