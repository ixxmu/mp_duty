---
title: "为什么你的图总是显得“土气”，而顶刊的图却看起来那么“高级”？"
date: 2025-09-04T13:49:38Z
draft: ["false"]
tags: [
  "fetched",
  "MsTt笔记"
]
categories: ["Acdemic"]
---
为什么你的图总是显得“土气”，而顶刊的图却看起来那么“高级”？ by MsTt笔记
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTt笔记" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="SCI绘图，Python/R，生物信息，数理统计，多组学原理" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf=""><br></span></span></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf="">请尊重原创劳动成果🙏</span></span></section><p><span><span leaf="">未经允许，不可抄袭，转载请注明出处！</span></span></p><p data-tool="mdnice编辑器"><span leaf="">顶刊的图之所以看起来“高级”，并非因为用了多么复杂的技术，而在于对细节的极致追求和清晰的信息传递。</span></p><p data-tool="mdnice编辑器"><span leaf="">今天，我们就来将普通的散点图，“改造”至顶刊级别。</span></p><section nodeleaf=""><img data-imgfileid="100001619" data-ratio="0.8342592592592593" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0pKzEibo3TorlD8WDAajLvWlWGDwVEcOH8Awg96hHRvYsOjCYJxw3QHA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0pKzEibo3TorlD8WDAajLvWlWGDwVEcOH8Awg96hHRvYsOjCYJxw3QHA/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现一</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第一篇是 </span><strong><span leaf="">Nature</span></strong><span leaf=""> 文章中 (Schneider-Mizell, C.M., Bodor, A.L., Brittain, D. et al. Inhibitory specificity from a connectomic census of mouse visual cortex. Nature 640, 448–458 (2025). https://doi.org/10.1038/s41586-024-07780-8) 的 Fig. 5e</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100001620" data-ratio="0.7796420581655481" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0qAYHfGZb7cn6AB0UK2SRiaTWDEtDeO5iapuypic2IribgmpqvSGoYUloEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="894" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0qAYHfGZb7cn6AB0UK2SRiaTWDEtDeO5iapuypic2IribgmpqvSGoYUloEw/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100001621" data-ratio="0.7738231917336394" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0cDZicrTtLBSjjWaxmxS5d3qIeoUT4tBklcQWVCoodwg52OFRvxugX7Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="871" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0cDZicrTtLBSjjWaxmxS5d3qIeoUT4tBklcQWVCoodwg52OFRvxugX7Q/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载R包，准备数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># 加载必要的包</span></span></code><code><span leaf="">library(ggplot2)    <span># 用于数据可视化</span></span></code><code><span leaf="">library(dplyr)      <span># 用于数据操作和转换</span></span></code><code><span leaf="">library(readxl)     <span># 用于读取Excel文件</span></span></code><code><span leaf="">library(showtext)   <span># 用于中文字体支持</span></span></code><code><span leaf="">showtext_auto()     <span># 自动启用showtext字体渲染</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 从Excel文件读取数据</span></span></code><code><span leaf=""><span>data</span> &lt;- read_excel(<span>"data1.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建分组变量</span></span></code><code><span leaf=""><span>data</span> &lt;- <span>data</span> %&gt;%</span></code><code><span leaf="">  mutate(size_group = case_when(</span></code><code><span leaf="">    frac_syn &lt; <span>0.05</span> ~ <span>"&lt;5%"</span>,                       <span># 小于5%的组</span></span></code><code><span leaf="">    frac_syn &gt;= <span>0.05</span> &amp; frac_syn &lt; <span>0.15</span> ~ <span>"5-15%"</span>,  <span># 5%-15%的组</span></span></code><code><span leaf="">    frac_syn &gt;= <span>0.15</span> &amp; frac_syn &lt; <span>0.30</span> ~ <span>"15-30%"</span>, <span># 15%-30%的组</span></span></code><code><span leaf="">    frac_syn &gt;= <span>0.30</span> ~ <span>"≥30%"</span>                      <span># 大于等于30%的组</span></span></code><code><span leaf="">  ))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 排序处理</span></span></code><code><span leaf=""><span>data</span><span>$</span>`Motif <span>Group</span>` &lt;- factor(</span></code><code><span leaf="">  <span>data</span><span>$</span>`Motif <span>Group</span>`,</span></code><code><span leaf="">  levels = <span>sort</span>(unique(as.numeric(<span>data</span><span>$</span>`Motif <span>Group</span>`)), decreasing = TRUE)</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>data</span><span>$</span>`M<span>-type</span>` &lt;- factor(</span></code><code><span leaf="">  <span>data</span><span>$</span>`M<span>-type</span>`,</span></code><code><span leaf="">  levels = c(<span>"L2a"</span>,<span>"L2b"</span>,<span>"L2c"</span>,<span>"L3a"</span>,<span>"L3b"</span>,</span></code><code><span leaf="">             <span>"L4a"</span>,<span>"L4b"</span>,<span>"L4c"</span>,<span>"L5a"</span>,<span>"L5b"</span>,<span>"L5ET"</span>,<span>"L5NP"</span>,</span></code><code><span leaf="">             <span>"L6short-a"</span>,<span>"L6short-b"</span>,<span>"L6tall-a"</span>,<span>"L6tall-b"</span>,<span>"L6tall-c"</span>,<span>"L6wm"</span>)</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 定义颜色映射</span></span></code><code><span leaf="">my_color &lt;- c(<span>"L2a"</span>=<span>"#73943c"</span>,<span>"L2b"</span>=<span>"#5fb946"</span>,<span>"L2c"</span>=<span>"#75c492"</span>,<span>"L3a"</span>=<span>"#a8862e"</span>,<span>"L3b"</span>=<span>"#f3d458"</span>,</span></code><code><span leaf="">              <span>"L4a"</span>=<span>"#00679a"</span>,<span>"L4b"</span>=<span>"#4890cd"</span>,<span>"L4c"</span>=<span>"#b3c5e4"</span>,<span>"L5a"</span>=<span>"#5f4a9e"</span>,<span>"L5b"</span>=<span>"#9f90c4"</span>,<span>"L5ET"</span>=<span>"#07733a"</span>,<span>"L5NP"</span>=<span>"#e71f8e"</span>,</span></code><code><span leaf="">              <span>"L6short-a"</span>=<span>"#8b288e"</span>,<span>"L6short-b"</span>=<span>"#c680b6"</span>,<span>"L6tall-a"</span>=<span>"#7a1131"</span>,<span>"L6tall-b"</span>=<span>"#d21f27"</span>,<span>"L6tall-c"</span>=<span>"#f37a37"</span>,<span>"L6wm"</span>=<span>"#8d55a1"</span>)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，根据frac_syn数值进行分组。设定展示顺序和分组颜色。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">普通气泡图</span></span></h2><section><ul><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>ggplot</span>(data, aes(x = `M-type`, y = `Motif Group`)) +</span></code><code><span leaf="">  <span>geom_point</span>(aes(size = size_group, fill = `M-type`),</span></code><code><span leaf="">             <span>color</span> = <span>"black"</span>, stroke = <span>0</span>.<span>5</span>, shape = <span>21</span>) + </span></code><code><span leaf="">  <span>guides</span>(fill = <span>"none"</span>) +</span></code><code><span leaf="">  <span>theme</span>(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>))</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ibbcwo9Z53PRbG6gywZiaT2t1amG09eFSXzyyv7YI3FyZTU7c7jStQUA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6203703703703703" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001624" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ibbcwo9Z53PRbG6gywZiaT2t1amG09eFSXzyyv7YI3FyZTU7c7jStQUA/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Nature 复现图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>ggplot</span>(data, aes(x = `M-type`, y = `Motif Group`)) +</span></code><code><span leaf="">  <span>geom_point</span>(aes(size = size_group, fill = `M-type`),</span></code><code><span leaf="">             <span>color</span> = <span>"black"</span>, stroke = <span>0</span>.<span>5</span>, shape = <span>21</span>) +   # 黑色边框，形状<span>21</span>为可填充的圆</span></code><code><span leaf="">  <span>scale_size_manual</span>(values = c(<span>"&lt;5%"</span> = -Inf, <span>"5-15%"</span> = <span>2</span>.<span>5</span>, <span>"15-30%"</span> = <span>6</span>.<span>5</span>, <span>"≥30%"</span> = <span>9</span>),</span></code><code><span leaf="">                    <span>name</span> = <span>"Frac Syn"</span>,   # 图例标题</span></code><code><span leaf="">                    <span>breaks</span> = c(<span>"&lt;5%"</span>,<span>"5-15%"</span>, <span>"15-30%"</span>, <span>"≥30%"</span>),  # 图例中显示的 breaks</span></code><code><span leaf="">                    <span>guide</span> = guide_legend(override.aes = list(fill = <span>"black"</span>, color = <span>"black"</span>))) +  # 图例点黑色实心</span></code><code><span leaf="">  <span>scale_fill_manual</span>(values = my_color, guide = <span>"none"</span>) +</span></code><code><span leaf="">  <span>coord_cartesian</span>(clip = <span>"off"</span>) +</span></code><code><span leaf="">  <span>scale_x_discrete</span>(position = <span>"top"</span>, expand = expansion(mult = c(<span>0</span>.<span>08</span>, <span>0</span>.<span>08</span>))) + </span></code><code><span leaf="">  <span>scale_y_discrete</span>(expand = expansion(mult = c(<span>0</span>.<span>08</span>, <span>0</span>.<span>08</span>))) +</span></code><code><span leaf="">  <span>geom_segment</span>(x = -<span>0</span>.<span>3</span>, xend = -<span>0</span>.<span>3</span>, y = <span>0</span>.<span>95</span>, yend = <span>18</span>.<span>05</span>, color = <span>"black"</span>, linewidth = <span>0</span>.<span>8</span>) +</span></code><code><span leaf="">  <span>geom_segment</span>(x = <span>0</span>.<span>95</span>, xend = <span>18</span>.<span>05</span>, y = <span>19</span>.<span>3</span>, yend = <span>19</span>.<span>3</span>, color = <span>"black"</span>, linewidth = <span>0</span>.<span>8</span>) +</span></code><code><span leaf="">  <span>annotate</span>(<span>"segment"</span>,</span></code><code><span leaf="">           <span>x</span> = c(<span>3</span>.<span>5</span>, <span>5</span>.<span>5</span>, <span>8</span>.<span>5</span>, <span>12</span>.<span>5</span>, <span>14</span>.<span>5</span>, <span>17</span>.<span>5</span>, <span>18</span>.<span>5</span>),</span></code><code><span leaf="">           <span>xend</span> = c(<span>3</span>.<span>5</span>, <span>5</span>.<span>5</span>, <span>8</span>.<span>5</span>, <span>12</span>.<span>5</span>, <span>14</span>.<span>5</span>, <span>17</span>.<span>5</span>, <span>18</span>.<span>5</span>),</span></code><code><span leaf="">           <span>y</span> = <span>1</span>, yend = <span>18</span>,</span></code><code><span leaf="">           <span>color</span> = <span>"black"</span>, linewidth = <span>0</span>.<span>2</span>)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0cDZicrTtLBSjjWaxmxS5d3qIeoUT4tBklcQWVCoodwg52OFRvxugX7Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7738231917336394" data-type="png" data-w="871" data-imgfileid="100001625" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0cDZicrTtLBSjjWaxmxS5d3qIeoUT4tBklcQWVCoodwg52OFRvxugX7Q/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现二</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第二篇是 </span><strong><span leaf="">Nature</span></strong><span leaf=""> 文章中 (Ryan, F.J., Clarke, M., Lynn, M.A. et al. Bifidobacteria support optimal infant vaccine responses. Nature 641, 456–464 (2025). https://doi.org/10.1038/s41586-025-08796-4) 的 Fig. 5e</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0bwKPdEKr0MHgOqDzY3vpDYrExQE8y5IQE7QnDbBVYdbeRDBZchP9FA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6009389671361502" data-type="png" data-w="1065" data-imgfileid="100001626" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0bwKPdEKr0MHgOqDzY3vpDYrExQE8y5IQE7QnDbBVYdbeRDBZchP9FA/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ugPwxZcKlUWOPZzPHI5q1CrhIMDC7kiburjmSQanQRBb8Zhyh7Ek4ZA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5740740740740741" data-type="png" data-w="1080" data-imgfileid="100001627" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ugPwxZcKlUWOPZzPHI5q1CrhIMDC7kiburjmSQanQRBb8Zhyh7Ek4ZA/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载R包，准备数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># 加载必要的包</span></span></code><code><span leaf="">library(ggplot2)    <span># 用于数据可视化</span></span></code><code><span leaf="">library(dplyr)      <span># 用于数据操作和转换</span></span></code><code><span leaf="">library(tidyr)      <span># 用于数据整理（特别是pivot_longer函数）</span></span></code><code><span leaf="">library(readxl)     <span># 用于读取Excel文件</span></span></code><code><span leaf="">library(scales)     <span># 用于调整坐标轴标签格式（如comma函数）</span></span></code><code><span leaf="">library(ggpubr)     <span># 用于添加统计比较（如stat_compare_means函数）</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 从Excel文件读取数据</span></span></code><code><span leaf=""><span>data</span> &lt;- read_excel(<span>"data2.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 将数据从宽格式转换为长格式</span></span></code><code><span leaf="">data_long &lt;- <span>data</span> %&gt;% </span></code><code><span leaf="">  pivot_longer(</span></code><code><span leaf="">    cols = starts_with(<span>"Mouse"</span>), </span></code><code><span leaf="">    names_to = <span>"Mouse"</span>, </span></code><code><span leaf="">    values_to = <span>"Value"</span> </span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 设置因子顺序，确保在绘图时按照指定顺序显示</span></span></code><code><span leaf="">data_long<span>$</span>`Cell <span>type</span>` &lt;- factor(data_long<span>$</span>`Cell <span>type</span>`,</span></code><code><span leaf="">                                levels = c(<span>"DC"</span>,<span>"cDC"</span>,<span>"cDC1"</span>,<span>"cDC2"</span>,<span>"pDC"</span>,<span>"mDC"</span>,<span>"CD11b+"</span>,<span>"rDC"</span>))</span></code><code><span leaf="">data_long<span>$Group</span> &lt;- factor(data_long<span>$Group</span>,</span></code><code><span leaf="">                          levels = c(<span>"GF mock"</span>,<span>"SPF mock"</span>,<span>"GF PCV13"</span>,<span>"SPF PCV13"</span>))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 定义每组对应的颜色</span></span></code><code><span leaf="">color_map &lt;- c(</span></code><code><span leaf="">  <span>"GF mock"</span> = <span>"#3853a2"</span>,</span></code><code><span leaf="">  <span>"SPF mock"</span> = <span>"#31b24c"</span>,</span></code><code><span leaf="">  <span>"GF PCV13"</span> = <span>"#3853a2"</span>,</span></code><code><span leaf="">  <span>"SPF PCV13"</span> = <span>"#31b24c"</span></span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，将数据从宽格式转换为长格式，并定义分组展示顺序和颜色。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">普通散点图</span></span></h2><section><ul><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>ggplot</span>(data_long, aes(x = interaction(Group, `Cell type`), y = Value, color = Group)) +</span></code><code><span leaf="">  <span>geom_point</span>(stroke = <span>1</span>.<span>5</span>, position = position_dodge(width = <span>0</span>.<span>6</span>)) +</span></code><code><span leaf="">  <span>theme</span>(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>))</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0rg8OBXztxIpqibuVQE1TFRgA3A1iaVibrqOiaSvDuOdanxNhWUxO7Vnqvg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5814814814814815" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001622" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0rg8OBXztxIpqibuVQE1TFRgA3A1iaVibrqOiaSvDuOdanxNhWUxO7Vnqvg/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Nature 复现图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span leaf="">ggplot(data_long, aes(<span>x</span> = interaction(Group, <span>`Cell type`</span>), <span>y</span> = Value, </span></code><code><span leaf="">                      color = Group, shape = Group, size = Group)) +</span></code><code><span leaf="">  geom_point(stroke = <span>1.5</span>, position = position_dodge(width = <span>0</span>.<span>6</span>)) +</span></code><code><span leaf="">  scale_shape_manual(<span>values</span> = shape_map) +</span></code><code><span leaf="">  scale_size_manual(<span>values</span> = size_map) +</span></code><code><span leaf="">  scale_color_manual(<span>values</span> = color_map,</span></code><code><span leaf="">                     guide = guide_legend(override.aes = list(size = <span>4</span>))) +</span></code><code><span leaf="">  scale_y_continuous(limits = c(<span>0</span>, <span>6000</span>), </span></code><code><span leaf="">                     breaks = se<span>q(0, 6000, 2000)</span>,</span></code><code><span leaf="">                     labels = comma,</span></code><code><span leaf="">                     expand = c(<span>0</span>, <span>0</span>)) +</span></code><code><span leaf="">  coord_cartesian(clip = <span>"off"</span>) +</span></code><code><span leaf="">  invisible(lapply(comparisons_list, function(<span>x</span>) {</span></code><code><span leaf="">    stat_compare_means(aes(group = Group),</span></code><code><span leaf="">                       comparisons = list(<span>x</span>$comparison),   <span># 指定比较组</span></span></code><code><span leaf="">                       method = <span>"t.test"</span>, paired = TRUE,   <span># 使用配对t检验</span></span></code><code><span leaf="">                       label = <span>"p.signif"</span>, label.y = <span>x</span>$label_y, size = <span>7</span>,  <span># 显示显著性符号</span></span></code><code><span leaf="">                       tip.length = <span>0</span>)   <span># 移除显著性线的尖端</span></span></code><code><span leaf="">  })) +</span></code><code><span leaf="">  geom_vline(xintercept = se<span>q(4.5, 28.5, by = 4)</span>, size = <span>0</span>.<span>8</span>,</span></code><code><span leaf="">             linetype = <span>"11"</span>, color = <span>"black"</span>) +</span></code><code><span leaf="">  annotate(<span>"text"</span>, <span>x</span> = cell_centers$center, <span>y</span> = <span>0</span>, label = cell_centers$`Cell type<span>`, </span></span></code><code><span leaf="">           size = 5, angle = 45, hjust = 1.5, vjust = 1.5)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ugPwxZcKlUWOPZzPHI5q1CrhIMDC7kiburjmSQanQRBb8Zhyh7Ek4ZA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5740740740740741" data-type="png" data-w="1080" data-imgfileid="100001628" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKKO1pbE5aPYVwztd4mIZMia0ugPwxZcKlUWOPZzPHI5q1CrhIMDC7kiburjmSQanQRBb8Zhyh7Ek4ZA/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">获取以 RProject 形式保存的</span></span><strong><span leaf=""><span textstyle="">绘图代码+注释+数据模板</span></span></strong><span leaf=""><span textstyle="">，后台回复关键词: </span></span><strong><em><span leaf=""><span textstyle="">250904_bubble_plot</span></span></em></strong></p></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v121" data-goodssouce="1" data-traceid="2c3497e3-d8d3-4ff4-85e5-ddd9be978147" data-pid="101_14835066"></mp-common-cpsad></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v121" data-goodssouce="1" data-traceid="2c3497e3-d8d3-4ff4-85e5-ddd9be978147" data-pid="101_14324026"></mp-common-cpsad></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qgYSXPXKQgWxvAV9JGCp2A",target="_blank" rel="noopener noreferrer">原文链接</a>
