---
title: "顶刊杂志 （IF=27.2）同款自带“仙气”的单细胞亚群高表达基因热图"
date: 2025-09-15T00:19:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
顶刊杂志 （IF=27.2）同款自带“仙气”的单细胞亚群高表达基因热图 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">今天分享一篇文献中的热图，<span textstyle="">这个热图取胜点在于配色：配色活力满满，很像刚刚成熟咬一口的那个水蜜桃的果肉颜色，谁看了会不喜欢！</span>图来自文献《Single-cell atlas of human liver and blood immune cells across fatty liver disease stages reveals distinct signatures linked to liver dysfunction and fibrogenesis》，于<span textstyle="">2025年8月29号发表在顶刊杂志 nature immunology （IF=27.2）</span>上。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">关于热图，我们前面介绍了这几款，都是高颜值：</span></p><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247536217&amp;idx=1&amp;sn=3f1893e79b3474230cd3993c37d2aa34&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">带有疾病进展的多分组差异结果如何展示？</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247537091&amp;idx=1&amp;sn=23f4aa643cf8c731221c3abe857ce150&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">高颜值复杂热图绘制小技巧</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543969&amp;idx=1&amp;sn=88deac17e38be5cdb45eb36885e6b2c8&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">顶刊杂志同款高颜值热图+文字注释框（IF=25.476）</a></span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">今天的热图主要应用在单细胞转录组中，展示不同的但细胞亚群高表达基因，配色真的非常优秀！图注：</span></p><blockquote><p><span leaf="">Fig. 4 | DC subsets and association with MASLD/MASH progression. heatmaps of differentially expressed genes in cDC1, </span><em><span leaf="">HLA</span><strong><span leaf="">「hi」</span></strong><span leaf="">S100**hi</span></em><span leaf=""> cDC2, </span><em><span leaf="">S100</span><strong><span leaf="">「hi」</span></strong><span leaf="">HLA**lo</span></em><span leaf=""> cDC2 and pDC subclusters.</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100061934" data-ratio="1.0416666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0DFWBK3NrojoB0O5ylib1ZPvEHZQicrRibrMmcjYWB8Zvsm4pcxkF3eeGQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0DFWBK3NrojoB0O5ylib1ZPvEHZQicrRibrMmcjYWB8Zvsm4pcxkF3eeGQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">示例数据</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">这篇文献好像没有提供数据，所以就用经典的单细胞数据pbmc3k进行演示吧：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf="">library(SeuratData) </span><span><span leaf=""><a topic-id="mfb6h5o3-np9j1z" data-topic="1">#加载seurat数据集</a>  </span></span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(tidyverse)</span><span leaf=""><br></span><span leaf="">library(patchwork)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># InstallData("pbmc3k")  </span></span><span leaf=""><br></span><span leaf="">data(</span><span><span leaf="">"pbmc3k"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce &lt;- UpdateSeuratObject(pbmc3k) </span><span leaf=""><br></span><span leaf="">table(sce</span><span><span leaf="">$seurat_annotations</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(sce@meta.data)</span><span leaf=""><br></span><span leaf="">dim(sce)</span><span leaf=""><br></span><span><span leaf=""># 去掉没有注释信息的细胞</span></span><span leaf=""><br></span><span leaf="">sce &lt;- sce[ , </span><span><span leaf="">which</span></span><span leaf="">(!is.na(sce@meta.data</span><span><span leaf="">$seurat_annotations</span></span><span leaf="">))]</span><span leaf=""><br></span><span leaf="">sce &lt;- sce %&gt;% </span><span leaf=""><br></span><span leaf="">  NormalizeData %&gt;% </span><span leaf=""><br></span><span leaf="">  FindVariableFeatures %&gt;% </span><span leaf=""><br></span><span leaf="">  ScaleData(features = rownames(sce)) %&gt;% </span><span leaf=""><br></span><span leaf="">  RunPCA() %&gt;% </span><span leaf=""><br></span><span leaf="">  FindNeighbors(dims = 1:10) %&gt;% </span><span leaf=""><br></span><span leaf="">  FindClusters(resolution = 0.5) %&gt;% </span><span leaf=""><br></span><span leaf="">  RunUMAP(dims = 1:10, umap.method = </span><span><span leaf="">"uwot"</span></span><span leaf="">, metric = </span><span><span leaf="">"cosine"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce</span><span leaf=""><br></span><span leaf="">table(Idents(sce))</span><span leaf=""><br></span><span leaf="">Idents(sce) &lt;- </span><span><span leaf="">"seurat_annotations"</span></span><span leaf=""><br></span><span leaf="">DimPlot(sce,reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">, label = T)</span><span leaf=""><br></span></code></pre><blockquote><p><span leaf="">注意上面 进行 ScaleData 的时候用所有的基因，不然后面绘制热图就是提示缺少基因。</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0MPZPHZWVnZko4g3JPvLTG83dlPzRxHv8icDc4Gp0X5LsC6jEAObaN1Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9110047846889953" data-type="png" data-w="1045" data-imgfileid="100061932" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0MPZPHZWVnZko4g3JPvLTG83dlPzRxHv8icDc4Gp0X5LsC6jEAObaN1Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">差异分析获取top10基因</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">大家数据的 FindAllMarkers 函数做差异：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 亚群差异分析</span></span><span leaf=""><br></span><span leaf="">pbmc.markers &lt;- FindAllMarkers(sce, only.pos = TRUE,min.pct = 0.25,  thresh.use = 0.25)</span><span leaf=""><br></span><span leaf="">pbmc.markers %&gt;%</span><span leaf=""><br></span><span leaf="">  group_by(cluster) %&gt;%</span><span leaf=""><br></span><span leaf="">  dplyr::filter(avg_log2FC &gt; 1)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">top10 &lt;- pbmc.markers %&gt;%</span><span leaf=""><br></span><span leaf="">  group_by(cluster) %&gt;%</span><span leaf=""><br></span><span leaf="">  dplyr::filter(avg_log2FC &gt; 1) %&gt;%</span><span leaf=""><br></span><span leaf="">  slice_head(n = 10) %&gt;%</span><span leaf=""><br></span><span leaf="">  ungroup()</span><span leaf=""><br></span><span leaf="">  </span><span leaf=""><br></span><span leaf="">table(top10</span><span><span leaf="">$cluster</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0kOibAOcsEVE8uvrl8bia6HVMKBWIVocTvcicVZF7TgJqGz1CEjMTLZkDg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.07314814814814814" data-type="png" data-w="1080" data-imgfileid="100061931" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0kOibAOcsEVE8uvrl8bia6HVMKBWIVocTvcicVZF7TgJqGz1CEjMTLZkDg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">热图绘制</span></span></h2><blockquote><p><span leaf="">绘图前的提取基因表达，制作列注释条，设置颜色：</span></p></blockquote><pre data-tool="mdnice编辑器"><code><span leaf="">anno &lt;- data.frame(celltype=sce</span><span><span leaf="">$seurat_annotations</span></span><span leaf="">, cluster=sce</span><span><span leaf="">$seurat_clusters</span></span><span leaf="">, row.names = colnames(sce))</span><span leaf=""><br></span><span leaf="">head(anno)</span><span leaf=""><br></span><span leaf="">anno &lt;- anno[order(anno</span><span><span leaf="">$celltype</span></span><span leaf="">), ]</span><span leaf=""><br></span><span leaf="">                   </span><span leaf=""><br></span><span leaf="">data &lt;- sce[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]]</span><span><span leaf="">$scale</span></span><span leaf="">.data[unique(top10</span><span><span leaf="">$gene</span></span><span leaf="">), ]</span><span leaf=""><br></span><span leaf="">data[data&gt;2] &lt;- 2</span><span leaf=""><br></span><span leaf="">data[data&lt; -2] &lt;- -2</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 保证亚群顺序</span></span><span leaf=""><br></span><span leaf="">data &lt;- data[, rownames(anno)]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># Specify colors</span></span><span leaf=""><br></span><span leaf="">ann_colors = list(</span><span leaf=""><br></span><span leaf="">  celltype=c(</span><span><span leaf="">'Naive CD4 T'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-ivegb3" data-topic="1">#117733</a>"</span></span><span leaf="">,</span><span><span leaf="">'Memory CD4 T'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-o3ybte" data-topic="1">#cc61b0</a>"</span></span><span leaf="">,</span><span><span leaf="">'CD14+ Mono'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-3rm2o8" data-topic="1">#99c945</a>"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">             </span><span><span leaf="">'B'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-iw3oro" data-topic="1">#2f8ac4</a>"</span></span><span leaf="">,</span><span><span leaf="">'CD8 T'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-uv8762" data-topic="1">#8d59ea</a>"</span></span><span leaf="">,</span><span><span leaf="">'FCGR3A+ Mono'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-0k51wv" data-topic="1">#dddcd8</a>"</span></span><span leaf="">,</span><span><span leaf="">'NK'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-bikmwf" data-topic="1">#d12125</a>"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">             </span><span><span leaf="">'DC'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-tcrx0q" data-topic="1">#1daa7e</a>"</span></span><span leaf="">,</span><span><span leaf="">'Platelet'</span></span><span leaf="">=</span><span><span leaf="">"<a topic-id="mfb6h5o3-r5hm9v" data-topic="1">#86cde4</a>"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ann_colors</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">绘图：用简单的 pheatmap 包：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(pheatmap)</span><span leaf=""><br></span><span leaf="">pdf(file = </span><span><span leaf="">"cluster_top10.pdf"</span></span><span leaf="">,width = 9,height = 10)</span><span leaf=""><br></span><span leaf="">pheatmap(data,scale = </span><span><span leaf="">"none"</span></span><span leaf="">,treeheight_row = 0,treeheight_col = 0,show_colnames = F,</span><span leaf=""><br></span><span leaf="">         annotation_col = anno[,1,drop=F],annotation_names_col=F,</span><span leaf=""><br></span><span leaf="">         cluster_cols = F,cluster_rows = F,  annotation_colors = ann_colors,</span><span leaf=""><br></span><span leaf="">         col = colorRampPalette(c(</span><span><span leaf="">"<a topic-id="mfb6h5o3-2nilme" data-topic="1">#ceb0ff</a>"</span></span><span leaf="">,</span><span><span leaf="">"white"</span></span><span leaf="">,</span><span><span leaf="">"<a topic-id="mfb6h5o3-g2ihcs" data-topic="1">#ff4628</a>"</span></span><span leaf="">))(100),</span><span leaf=""><br></span><span leaf="">         fontsize_row=8</span><span leaf=""><br></span><span leaf="">         )</span><span leaf=""><br></span><span leaf="">dev.off()</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">结果如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0Bick0QoqpMkyK3LN7UfCmWQsSPibtPW5kw3UHOAgDntaU8JJ0h2VzQvA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.112037037037037" data-type="png" data-w="1080" data-imgfileid="100061933" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzO9xoftoDZtfKvSBWER5h0Bick0QoqpMkyK3LN7UfCmWQsSPibtPW5kw3UHOAgDntaU8JJ0h2VzQvA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h1 data-tool="mdnice编辑器"><span></span><span><span leaf="">这个配色是不是很漂亮！</span></span></h1></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">如果上面的代码学习对你来说有困难，可以看看下面的链接！</span></p></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247545329&amp;idx=1&amp;sn=71930835b79306606c59d7aa8c632490&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课9月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课9月班</span></a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/tRgtahToCVXPWCG25-8Vfw",target="_blank" rel="noopener noreferrer">原文链接</a>
