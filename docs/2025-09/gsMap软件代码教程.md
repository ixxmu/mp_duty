---
title: "gsMapè½¯ä»¶ä»£ç æ•™ç¨‹"
date: 2025-09-03T03:25:44Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡å®åº“"
]
categories: ["Acdemic"]
---
gsMapè½¯ä»¶ä»£ç æ•™ç¨‹ by ç”Ÿä¿¡å®åº“
------
<div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å‰è¨€</span></span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapæ˜¯ä¸€ä¸ªæ•´åˆç©ºé—´è½¬å½•ç»„å’ŒGWASæ•°æ®ç”¨äºæ¨æ–­ä¸å¤æ‚æ€§çŠ¶å…³è”çš„ç»†èƒç±»å‹å’Œç©ºé—´åŒºåŸŸçš„è½¯ä»¶åŒ…ã€‚åœ¨ä¹‹å‰çš„æ¨æ–‡ï¼š<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247495882&amp;idx=1&amp;sn=fd13fd8f2a48fc5fc4d970dd38fcabd2&amp;scene=21#wechat_redirect" textvalue="Natureé‡ç£…ï¼šgsMapå·¥å…·å®ç°åŸºå› ç»„å’Œç©ºè½¬è”åˆåˆ†æ" data-itemshowtype="0" linktype="text" data-linktype="2">Natureé‡ç£…ï¼šgsMapå·¥å…·å®ç°åŸºå› ç»„å’Œç©ºè½¬è”åˆåˆ†æ</a>ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»äº†gsMapçš„åŠŸèƒ½æ¡†æ¶ï¼›å¹¶ä¸”åœ¨åç»­æ¨æ–‡ï¼š<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247495883&amp;idx=1&amp;sn=f54cb5a437ef2d8e3c6a854375e0400f&amp;scene=21#wechat_redirect" textvalue="gsMapç®—æ³•åŸç†ä»‹ç»" data-itemshowtype="0" linktype="text" data-linktype="2">gsMapç®—æ³•åŸç†ä»‹ç»</a>ä¸­ï¼Œä»‹ç»äº†gsMapçš„åŸºæœ¬å·¥ä½œåŸç†ï¼›æœ¬æ–‡å°†ç»§ç»­é€šè¿‡ä»£ç å®æ“ï¼Œä»‹ç»gsMapçš„å…·ä½“ä½¿ç”¨æ–¹æ³•ã€‚</span></p><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å®‰è£…</span></span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">é¦–å…ˆåˆ›å»ºPython 3.10çš„Condaç¯å¢ƒ</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">conda create -n gsMap python=3.10</span><span leaf=""><br></span><span leaf="">conda activate gsMap</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapæœ‰3ç§å®‰è£…æ–¹æ³•ï¼Œå°ç¼–é‡‡ç”¨çš„æ˜¯ä½¿ç”¨pipå®‰è£…</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">pip install gsMap</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä¹Ÿèƒ½ä½¿ç”¨condaå®‰è£…</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">conda install bioconda::gsmap</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å½“pipæˆ–è€…condaè‡ªåŠ¨å®‰è£…å¤±è´¥æ—¶ï¼Œä¹Ÿèƒ½æœ¬åœ°æºç å®‰è£…</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gitÂ </span><span><span leaf="">clone</span></span><span leaf="">Â https://github.com/JianYang-Lab/gsMap</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf="">Â gsMap</span><span leaf=""><br></span><span leaf="">pip install -e .</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å®‰è£…å¥½åï¼Œä½¿ç”¨å¸®åŠ©å‘½ä»¤æ£€éªŒæ˜¯å¦å®‰è£…æˆåŠŸ</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap --</span><span><span leaf="">help</span></span><span leaf=""><br></span></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ•°æ®æ ¼å¼</span></span><span></span></h1><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸‹è½½å‚è€ƒä¿¡æ¯</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapé¦–å…ˆéœ€è¦ä¸€ç³»åˆ—å‚è€ƒä¿¡æ¯ï¼Œè¿™äº›å¯é€šè¿‡å¦‚ä¸‹å‘½ä»¤ä¸‹è½½ï¼ˆæœ‰æ¡ä»¶å»ºè®®å¼€ğŸªœæ›´å¿«ï¼‰</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">wget https://yanglab.westlake.edu.cn/data/gsMap/gsMap_resource.tar.gz</span><span leaf=""><br></span><span leaf="">tar -xvzf gsMap_resource.tar.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ£€æŸ¥ä¸€ä¸‹ä¸‹è½½çš„æ–‡ä»¶</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">tree -L 2 gsMap_resource</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsMap_resource</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ genome_annotation</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ enhancer</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ gtf</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ homologs</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ human_macaque_marmoset_mouse_homologs.txt.gz</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ macaque_human_homologs.txt</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ mouse_human_homologs.txt</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ LD_Reference_Panel</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ 1000G_EUR_Phase3_plink</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ LDSC_resource</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ hapmap3_snps</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ weights_hm3_no_hla</span><span leaf=""><br></span><span leaf="">â””â”€â”€ quick_mode</span><span leaf=""><br></span><span leaf="">Â  Â  â”œâ”€â”€ baseline</span><span leaf=""><br></span><span leaf="">Â  Â  â”œâ”€â”€ SNP_gene_pair</span><span leaf=""><br></span><span leaf="">Â  Â  â””â”€â”€ snp_gene_weight_matrix.h5ad</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¯ä»¥å‘ç°ï¼Œå‚è€ƒæ•°æ®ä¸»è¦åŒ…å«å‚è€ƒåŸºå› ç»„æ³¨é‡Šä¿¡æ¯ï¼Œå„ç»„ç»‡çš„enhancerè°ƒæ§ä¿¡æ¯ï¼Œè·¨ç‰©ç§åŒæºåŸºå› ä¿¡æ¯ã€LDå‚è€ƒæ•°æ®ã€SNPæƒé‡ä¿¡æ¯ä»¥åŠä¸€äº›ç¼“å­˜å¥½çš„äººçš„SNPå’ŒåŸºå› å¯¹åº”ä¿¡æ¯ï¼Œä¾¿äºå¿«é€Ÿè¯»å–ã€‚è¿™äº›å‚è€ƒæ•°æ®åœ¨æ¯æ¬¡è¿è¡ŒgsMapæ—¶ç›´æ¥ä½¿ç”¨å³å¯ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸‹è½½ç¤ºä¾‹æ•°æ®</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½œè€…æä¾›äº†ä¸€å¥—ç¤ºä¾‹è¾“å…¥æ•°æ®ä¾›è½¯ä»¶æµ‹è¯•å’Œå­¦ä¹ ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">wget https://yanglab.westlake.edu.cn/data/gsMap/gsMap_example_data.tar.gz</span><span leaf=""><br></span><span leaf="">tar -xvzf gsMap_example_data.tar.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ£€æŸ¥ç¤ºä¾‹æ•°æ®çš„ç›®å½•</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsMap_example_data</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ GWAS</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ BCX2_MCHC_EA_GWAMA.sumstats.gz</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ GIANT_EUR_Height_2022_Nature.sumstats.gz</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ gwas_config.yaml</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ IQ_NG_2018.sumstats.gz</span><span leaf=""><br></span><span leaf="">â””â”€â”€ ST</span><span leaf=""><br></span><span leaf="">Â  Â  â”œâ”€â”€ E16.5_E1S1.MOSTA.h5ad</span><span leaf=""><br></span><span leaf="">Â  Â  â””â”€â”€ E16.5_E2S11.MOSTA.h5ad</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¤ºä¾‹æ•°æ®åŒ…å«è¾“å…¥çš„ç©ºè½¬ï¼ˆSTï¼‰å’ŒGWASæ•°æ®ã€‚ç©ºè½¬æ•°æ®æ˜¯å¤§å®¶éå¸¸ç†Ÿæ‚‰çš„h5adæ ¼å¼ï¼Œèƒ½ç›´æ¥è¢«Scanpyè¯»å–ä¸ºAnnDataå¯¹è±¡</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â scanpyÂ </span><span><span leaf="">as</span></span><span leaf="">Â sc</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">adata = sc.read_h5ad(</span><span><span leaf="">"gsMap_example_data/ST/E16.5_E1S1.MOSTA.h5ad"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">AnnDataå¯¹è±¡ä¸­å¿…é¡»åŒ…å«åŸå§‹countçŸ©é˜µã€ç©ºé—´åæ ‡ä¿¡æ¯ã€‚ç»†èƒ/ç»„ç»‡æ³¨é‡Šä¿¡æ¯ä¸ºå¯é€‰é¡¹ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">print(adata.layers[</span><span><span leaf="">'count'</span></span><span leaf="">].shape)</span><span leaf=""><br></span><span leaf="">print(adata.obsm[</span><span><span leaf="">"spatial"</span></span><span leaf="">].shape)</span><span leaf=""><br></span><span leaf="">print(adata.obs[</span><span><span leaf="">"annotation"</span></span><span leaf="">].value_counts().head())</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">(121767, 28204)</span><span leaf=""><br></span><span leaf="">(121767, 2)</span><span leaf=""><br></span><span leaf="">annotation</span><span leaf=""><br></span><span leaf="">Brain Â  Â  Â  Â  Â  Â  Â  Â 17374</span><span leaf=""><br></span><span leaf="">Liver Â  Â  Â  Â  Â  Â  Â  Â 14167</span><span leaf=""><br></span><span leaf="">Cavity Â  Â  Â  Â  Â  Â  Â  11287</span><span leaf=""><br></span><span leaf="">Muscle Â  Â  Â  Â  Â  Â  Â  Â 9853</span><span leaf=""><br></span><span leaf="">Connective tissue Â  Â  8803</span><span leaf=""><br></span><span leaf="">Name: count, dtype: int64</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><em><span leaf="">è¿™ç¤ºä¾‹æ•°æ®çš„ç»†èƒé‡æ¯”æˆ‘åšçš„æ­£å¼è¯¾é¢˜è¿˜å¤šï¼Œæ²¡ç‚¹é’èƒ½åŠ›å‘ä¸äº†natureå•Šã€‚</span></em><span leaf=""><br></span><span leaf="">GWASæ•°æ®éœ€æ•´ç†æˆä»¥ä¸‹æ ¼å¼ï¼ŒåŒ…å«SNPåç§°ã€å˜å¼‚å‰åç¢±åŸºã€Zæ£€éªŒç»Ÿè®¡é‡å’Œæ ·æœ¬é‡ã€‚è®ºæ–‡ä¸­</span><span data-formula="\chi^2=Z^2"><span data-formula="\chi^2=Z^2"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -833.9 3547.7 1037.9" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="3C7" d="M576 -125Q576 -147 547 -175T487 -204H476Q394 -204 363 -157Q334 -114 293 26L284 59Q283 58 248 19T170 -66T92 -151T53 -191Q49 -194 43 -194Q36 -194 31 -189T25 -177T38 -154T151 -30L272 102L265 131Q189 405 135 405Q104 405 87 358Q86 351 68 351Q48 351 48 361Q48 369 56 386T89 423T148 442Q224 442 258 400Q276 375 297 320T330 222L341 180Q344 180 455 303T573 429Q579 431 582 431Q600 431 600 414Q600 407 587 392T477 270Q356 138 353 134L362 102Q392 -10 428 -89T490 -168Q504 -168 517 -156T536 -126Q539 -116 543 -115T557 -114T571 -115Q576 -118 576 -125Z"></path></g><g data-mml-node="mn" transform="translate(626, 363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1307.3, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2363.1, 0)"><g data-mml-node="mi"><path data-c="5A" d="M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z"></path></g><g data-mml-node="mn" transform="translate(781, 363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g><g></g></svg></span></span><span leaf="">ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">zcat IQ_NG_2018.sumstats.gz | head -n 5</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">SNP A1 A2 Z N</span><span leaf=""><br></span><span leaf="">rs12184267 T C 0.916 225955</span><span leaf=""><br></span><span leaf="">rs12184277 G A 0.656 226215</span><span leaf=""><br></span><span leaf="">rs12184279 A C 1.050 226224</span><span leaf=""><br></span><span leaf="">rs116801199 T G 0.300 226626</span><span leaf=""><br></span></code></pre><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¿«é€Ÿå…¥é—¨</span></span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ•´ç†å¥½è¾“å…¥æ•°æ®ä»¥åï¼Œè¿è¡ŒgsMapå°±å¾ˆæ–¹ä¾¿äº†ï¼Œåªéœ€ä¸€è¡Œå‘½ä»¤ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap quick_mode \</span><span leaf=""><br></span><span leaf="">Â  Â --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --gsMap_resource_dirÂ </span><span><span leaf="">'../gsMap_resource'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --hdf5_pathÂ </span><span><span leaf="">'../gsMap_example_data/ST/E16.5_E1S1.MOSTA.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sumstats_fileÂ </span><span><span leaf="">'../gsMap_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™é‡Œçš„å‚æ•°ä¹Ÿéå¸¸æ˜¾è€Œæ˜“è§ï¼Œç›¸ä¿¡ä¸éœ€è¦è¿‡å¤šè§£é‡Šå°ä¼™ä¼´ä»¬ä¹Ÿèƒ½çœ‹æ‡‚ã€‚å°±æ˜¯æ³¨æ„</span><code><span leaf="">workdir</span></code><span leaf="">å‚æ•°è¡¨ç¤ºçš„æ˜¯è¾“å‡ºæ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œè€Œè¾“å‡ºæ–‡ä»¶å¤¹åˆ™æŒ‰</span><code><span leaf="">sample_name</span></code><span leaf="">å‚æ•°è¿›è¡Œå‘½åã€‚</span><span leaf=""><br></span><span leaf="">ä¸€å¥—å…¨æ–°çš„æ•°æ®è¿è¡Œæ—¶é—´ä¼šå¾ˆé•¿ï¼Œè¿™é‡Œå¤§æ¦‚è¿è¡Œäº†8ä¸ªå¤šå°æ—¶ï¼Œå¾—åˆ°äº†ä»¥ä¸‹è¾“å‡ºæ–‡ä»¶å¤¹</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">tree -L 2 E16.5_E1S1.MOSTA/</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">E16.5_E1S1.MOSTA/</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ cauchy_combination</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ E16.5_E1S1.MOSTA_IQ.Cauchy.csv.gz</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ find_latent_representations</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ E16.5_E1S1.MOSTA_add_latent.h5ad</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ generate_ldscore</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ baseline -&gt; /data/h01006/software_test/gsMap/gsMap_resource/quick_mode/baseline</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ E16.5_E1S1.MOSTA_generate_ldscore.done</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ SNP_gene_pair -&gt; /data/h01006/software_test/gsMap/gsMap_resource/quick_mode/SNP_gene_pair</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ gsMap_pipeline_E16.5_E1S1.MOSTA_20250701_171043.log</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ latent_to_gene</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ E16.5_E1S1.MOSTA_gene_marker_score.feather</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ report</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ IQ</span><span leaf=""><br></span><span leaf="">â””â”€â”€ spatial_ldsc</span><span leaf=""><br></span><span leaf="">Â  Â  â””â”€â”€ E16.5_E1S1.MOSTA_IQ.csv.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å…¶ä»–çš„è¾“å‡ºæ–‡ä»¶æˆ‘ä»¬åé¢å†ä»‹ç»ï¼Œç°åœ¨ä¸»è¦å…³æ³¨reportæ–‡ä»¶å¤¹ã€‚é‡Œé¢æŒ‰ç…§æ€§çŠ¶åç§°å‚¨å­˜ç»“æœï¼Œæ¯ä¸ªç»“æœéƒ½æœ‰ä¸€ä¸ªhtmlæ ¼å¼çš„æŠ¥å‘Šæ–‡ä»¶ï¼Œå¯ä»¥ç”¨æµè§ˆå™¨æ‰“å¼€ã€‚</span><span leaf=""><br></span><span leaf="">ç¬¬ä¸€ä¸ªç»“æœæ˜¯æ€§çŠ¶ä¸spotçš„å…³è”æ€§på€¼çš„ç»„ç»‡ç©ºé—´åˆ†å¸ƒå›¾ï¼Œå±•ç¤ºäº†ç©ºé—´ç»„ç»‡ä¸­æ¯ä¸ªspotçš„-log10(p)å€¼ã€‚è¿™ä¸ªå›¾æ˜¯äº¤äº’å¼çš„ï¼Œå°†å…‰æ ‡ç§»ä¸Šå»å¯ä»¥çœ‹åˆ°å¯¹åº”spotçš„æ³¨é‡Šã€ç©ºé—´ä½ç½®å’Œpå€¼ï¼ŒåŒå‡»å³è¾¹çš„ç»„ç»‡ç±»å‹è¿˜èƒ½å•ç‹¬è§‚æµ‹å¯¹åº”çš„ç»„ç»‡ã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYM5Tia6AHuAKpLaEvK3ycVphB9OvAFQq9bodquqyxn8p3Vw6YrXoBThA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.099074074074074" data-type="png" data-w="1080" data-imgfileid="100012394" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYM5Tia6AHuAKpLaEvK3ycVphB9OvAFQq9bodquqyxn8p3Vw6YrXoBThA/640?wx_fmt=png&amp;from=appmsg">ç„¶åæ˜¯å„ç»„ç»‡æŸ¯è¥¿åˆå¹¶æ£€éªŒåçš„ç»“æœï¼Œå¯ä»¥å‘ç°æŸ¯è¥¿åˆå¹¶æ£€éªŒçš„på€¼è¦æ˜æ˜¾å°äºå•çº¯çš„åŒºåŸŸå†…på€¼çš„ä¸­ä½æ•°ã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYomRyDW3RttUQ53hZ6l10O0C7UJgLY57GGGKdR0jXicDBMhpBK73UFtA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2175925925925926" data-type="png" data-w="1080" data-imgfileid="100012390" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYomRyDW3RttUQ53hZ6l10O0C7UJgLY57GGGKdR0jXicDBMhpBK73UFtA/640?wx_fmt=png&amp;from=appmsg">æ›¼å“ˆé¡¿å›¾æ•´ä½“å‘ˆç°çš„æ˜¯GWASçš„ç»“æœï¼Œå±•ç¤ºäº†SNPä¸æ€§çŠ¶çš„å…³è”æ€§på€¼ã€‚è¿™å¼ å›¾ä¹Ÿæ˜¯äº¤äº’å¼çš„ï¼Œå…‰æ ‡æŒ‡å‘SNPå¯ä»¥çœ‹åˆ°å®ƒçš„åŸºå› ç»„ä½ç½®ã€SNPåç§°ã€å¯¹åº”çš„åŸºå› ã€æ³¨é‡Šçš„ç»†èƒæˆ–ç»„ç»‡ä»¥åŠæ³¨é‡ŠLDåˆ†æ•°ä¸GWASå¡æ–¹ç»Ÿè®¡é‡çš„Pearsonç›¸å…³ç³»æ•°ï¼ˆPCCï¼‰ã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYpuuzAw1nMA62XVxPID0ImEEE6CEBYeTic7LrdQbiaEtD6R9BR3j0EQcg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.23981481481481481" data-type="png" data-w="1080" data-imgfileid="100012392" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYpuuzAw1nMA62XVxPID0ImEEE6CEBYeTic7LrdQbiaEtD6R9BR3j0EQcg/640?wx_fmt=png&amp;from=appmsg">ç„¶åæ˜¯åŸºå› è¡¨è¾¾å’ŒGSSåˆ†æ•°çš„åˆ†å¸ƒï¼Œå¯ä»¥é€‰æ‹©ä»»ä½•åŸºå› æŸ¥çœ‹ã€‚å¯ä»¥çœ‹å‡ºï¼ŒGSSæ¯”åŸºå› è¡¨è¾¾é‡å·®å¼‚æ›´ä¸ºæ˜æ˜¾ã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYJdAkvOhzL3NibddmOX15bd62ic1wLzmr1tUTXNL4hz9Hp9lpJAbAVJTQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9351851851851852" data-type="png" data-w="1080" data-imgfileid="100012391" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYJdAkvOhzL3NibddmOX15bd62ic1wLzmr1tUTXNL4hz9Hp9lpJAbAVJTQ/640?wx_fmt=png&amp;from=appmsg"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYryIQ6Lje5fqNeZLSBFd2urkAnUllXdibcibPiaEBickXHf9HlEgBUx5e4w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7435185185185185" data-type="png" data-w="1080" data-imgfileid="100012393" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYryIQ6Lje5fqNeZLSBFd2urkAnUllXdibcibPiaEBickXHf9HlEgBUx5e4w/640?wx_fmt=png&amp;from=appmsg">ç„¶åæ˜¯50ä¸ªè¡¨è¾¾æœ€ç‰¹å¼‚çš„åŸºå› å’Œç»„ç»‡åŒºåŸŸ/ç»†èƒç±»å‹å¯¹åŠå…¶GSSå’ŒPCCçš„å±•ç¤ºã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCY2heMtXsgClnsAwWHlg6xwjA7bqQUoT2LLyiaEfZPayicuU5Y3WrcKz3Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6537037037037037" data-type="png" data-w="1080" data-imgfileid="100012396" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCY2heMtXsgClnsAwWHlg6xwjA7bqQUoT2LLyiaEfZPayicuU5Y3WrcKz3Q/640?wx_fmt=png&amp;from=appmsg">æœ€åå°±æ˜¯ä¸€äº›è¿è¡Œç›¸å…³ä¿¡æ¯äº†<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYnd3EgmoqCh7JJwP8kicqdXD7UibLc5AGKg5icWibiaXdW9OERoUKEjT7O5A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5611111111111111" data-type="png" data-w="1080" data-imgfileid="100012395" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYnd3EgmoqCh7JJwP8kicqdXD7UibLc5AGKg5icWibiaXdW9OERoUKEjT7O5A/640?wx_fmt=png&amp;from=appmsg"></span></p><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åˆ†æ­¥è¿è¡Œ</span></span><span></span></h1><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä¸ºäº†å¸®åŠ©ç”¨æˆ·æ›´å¥½çš„ç†è§£gsMapç®—æ³•çš„åº•å±‚é€»è¾‘ä»¥åŠè®©æ•°æ®å¤„ç†è¿‡ç¨‹æ›´çµæ´»ï¼Œä½œè€…è®¾ç½®äº†gsMapçš„åˆ†å¸ƒè¿è¡ŒåŠŸèƒ½ï¼Œä¸‹é¢æ˜¯gsMapæ¯ä¸ªæ­¥éª¤åˆ†å¼€è¿è¡Œçš„æ•™ç¨‹ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¯»æ‰¾æ½œåœ¨è¡¨å¾ï¼ˆå¯é€‰ï¼‰</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapçš„ç¬¬ä¸€æ­¥æ˜¯å°†ç©ºé—´è½¬å½•ç»„çš„è¡¨è¾¾çŸ©é˜µã€ç©ºé—´åæ ‡åŠç»†èƒç±»å‹è¾“å…¥GATç½‘ç»œä¸­å­¦ä¹ æ¯ä¸ªspotçš„æ½œåœ¨åµŒå…¥è¡¨å¾ã€‚å®ƒç”±ä¸‹é¢ä¸€è¡Œä»£ç å®Œæˆï¼š</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥12ä¸‡ä¸ªç»†èƒå¤§çº¦éœ€è¦60Gå†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_find_latent_representations \</span><span leaf=""><br></span><span leaf="">Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --input_hdf5_pathÂ </span><span><span leaf="">'../gsMap_example_data/ST/E16.5_E1S1.MOSTA.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿è¡Œå®Œæˆåï¼Œåœ¨è¾“å‡ºç›®å½•ä¸­ç”Ÿæˆäº†ç›®å½•</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">find_latent_representations/</span><span leaf=""><br></span><span leaf="">â””â”€â”€ E16.5_E1S1.MOSTA_add_latent.h5ad</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨scanpyè¯»å–è¿™ä¸ªh5adæ–‡ä»¶ï¼Œé‡Œé¢å­˜å‚¨çš„æ˜¯ä¸€ä¸ªadataå¯¹è±¡ã€‚å®ƒçš„</span><code><span leaf="">obsm</span></code><span leaf="">ä¸­å¤šå‡ºäº†</span><code><span leaf="">latent_GVAE</span></code><span leaf="">ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯ä¸€è¡Œå­˜å‚¨ç€æ¯ä¸ªspotçš„30ç»´åµŒå…¥ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â scanpyÂ </span><span><span leaf="">as</span></span><span leaf="">Â sc</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">adata = sc.read_h5ad(</span><span><span leaf="">"step/E16.5_E1S1.MOSTA/find_latent_representations/E16.5_E1S1.MOSTA_add_latent.h5ad"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">adata.obsm[</span><span><span leaf="">'latent_GVAE'</span></span><span leaf="">].shape</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">array([[ 0.00952553, -0.08907691, -0.06804881, ..., -0.03316928, -0.04227457, Â 0.01298398],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â [ 0.01311077, -0.09554639, -0.06435487, ..., -0.03155136, -0.04299155, Â 0.0202301 ],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â [ 0.01806523, -0.09366009, -0.06114935, ..., -0.02755435, -0.0463993 , Â 0.02227518],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â ...,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â [-0.03978971, -0.07202866, -0.02012973, ..., -0.01995548, -0.06187748, -0.00288487],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â [-0.03788416, -0.07053255, -0.01871764, ..., -0.02421809, -0.06079815, Â 0.00054346],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â [-0.04278402, -0.06833802, -0.01483879, ..., -0.02659683, -0.06472453, Â 0.00366877]], dtype=float32)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å½“ç„¶è¿™ä¸€æ­¥æ˜¯å¯é€‰çš„ï¼Œå¦‚æœå°ä¼™ä¼´ä»¬ä¸å–œæ¬¢ä½¿ç”¨GVAEè·å¾—æ½œåœ¨åµŒå…¥çš„è¯ä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–é™ç»´æ–¹æ³•å¦‚PCAç­‰æ¥å¾—åˆ°spotçš„è¡¨å¾ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">è®¡ç®—GSS</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨è·å¾—äº†spotçš„è¡¨å¾åï¼ŒgsMapé€šè¿‡è¡¨å¾é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ç¡®å®šç©ºé—´åŸŸï¼Œç„¶åè®¡ç®—æ¯ä¸ªspotä¸ºä¸­å¿ƒçš„ç©ºé—´åŸŸçš„GSSåˆ†æ•°ã€‚è¿™ä¸ªè¿‡ç¨‹ç”¨ä¸‹é¢çš„ä»£ç å®ç°ï¼Œæœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å‚æ•°ï¼š</span></p><ul><li><section><code><span leaf="">num_neighbour_spatial</span></code><span leaf="">ï¼šè¡¨ç¤ºä¸focal spotç©ºé—´æ¬§æ°è·ç¦»æœ€è¿‘çš„201ä¸ªspotï¼Œè¿™æ˜¯åˆæ­¥åˆ’å®šçš„æœç´¢èŒƒå›´ã€‚</span></section></li><li><section><code><span leaf="">num_neighbour</span></code><span leaf="">ï¼šè¡¨ç¤ºåœ¨ä¸Šè¿°æœç´¢èŒƒå›´å†…é€‰æ‹©ä¸focal spotåµŒå…¥çš„ä½™å¼¦ç›¸ä¼¼åº¦æœ€é«˜çš„51ä¸ªspotä½œä¸ºå¾®ç©ºé—´åŸŸã€‚</span><code><span leaf="">mouse_human_homologs.txt</span></code><span leaf="">æ˜¯åŒæºåŸºå› è½¬æ¢çš„å‚è€ƒæ–‡ä»¶ï¼Œå®ƒè¦æ±‚å·¦è¾¹åˆ—ç»™çš„æ˜¯ç©ºè½¬å¯¹åº”ç‰©ç§çš„åŸºå› åï¼Œå³è¾¹åˆ—ç»™çš„æ˜¯GWASå¯¹åº”ç‰©ç§çš„åŸºå› åã€‚</span></section></li></ul><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">head mouse_human_homologs.txt</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">MOUSE_GENE_SYM HUMAN_GENE_SYM</span><span leaf=""><br></span><span leaf="">Hsfy2 HSFY1</span><span leaf=""><br></span><span leaf="">Gm5788 EIF1AY</span><span leaf=""><br></span><span leaf="">Gm21677 RBMY1B</span><span leaf=""><br></span><span leaf="">Tbl1x TBL1Y</span><span leaf=""><br></span><span leaf="">Pcdh11x PCDH11Y</span><span leaf=""><br></span><span leaf="">Uty UTY</span><span leaf=""><br></span><span leaf="">Dazl DAZ1</span><span leaf=""><br></span><span leaf="">Tgif2lx2 TGIF2LY</span><span leaf=""><br></span><span leaf="">Prkx PRKY</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿è¡Œè¿™ä¸€æ­¥çš„ä»£ç ï¼š</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥12ä¸‡ä¸ªç»†èƒå¤§çº¦éœ€è¦45Gå†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_latent_to_gene \</span><span leaf=""><br></span><span leaf="">Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --latent_representationÂ </span><span><span leaf="">'latent_GVAE'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --num_neighbour 51 \</span><span leaf=""><br></span><span leaf="">Â  Â  --num_neighbour_spatial 201 \</span><span leaf=""><br></span><span leaf="">Â  Â  --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿è¡Œå®Œä»¥åå¾—åˆ°ä»¥ä¸‹ç»“æœ</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">latent_to_gene/</span><span leaf=""><br></span><span leaf="">â””â”€â”€ E16.5_E1S1.MOSTA_gene_marker_score.feather</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">featheræ–‡ä»¶æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ç”¨äºæ›´é«˜æ•ˆåœ°å‚¨å­˜æ•°æ®æ¡†ï¼Œå¯ä»¥ä½¿ç”¨pyarrowåŒ…è¿›è¡Œè¯»å–ã€‚è¿™æ˜¯ä¸€ä¸ªè¡Œä¸ºåŸºå› ï¼Œåˆ—ä¸ºspotçš„GSSæ‰“åˆ†çŸ©é˜µã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â pyarrow.featherÂ </span><span><span leaf="">as</span></span><span leaf="">Â feather</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gss = feather.read_feather(</span><span><span leaf="">"step/E16.5_E1S1.MOSTA/latent_to_gene/E16.5_E1S1.MOSTA_gene_marker_score.feather"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">gss.iloc[</span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">5</span></span><span leaf="">,Â </span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">5</span></span><span leaf="">]</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cell_name HUMAN_GENE_SYM 190_194 190_195 190_196 190_197</span><span leaf=""><br></span><span leaf="">0 C11orf58 0.000000 0.00000 0.00000 0.000000</span><span leaf=""><br></span><span leaf="">1 C18orf21 0.000000 0.00000 0.00000 0.000000</span><span leaf=""><br></span><span leaf="">2 C2orf76 1.933594 1.84082 1.84082 1.834961</span><span leaf=""><br></span><span leaf="">3 KIAA0930 0.000000 0.00000 0.00000 0.000000</span><span leaf=""><br></span><span leaf="">4 C2orf49 0.000000 0.00000 0.00000 0.000000</span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç”ŸæˆLDåˆ†æ•°</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¾—åˆ°åŸºå› çš„GSSåï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å»ºç«‹åŸºå› å’ŒSNPçš„æ˜ å°„ã€‚æœ‰ä»¥ä¸‹3ç§æ˜ å°„æ–¹å¼ï¼š</span></p><ol><li><section><span leaf="">é€šè¿‡åŸºå› TSSä½ç½®ï¼Œéœ€è¦æŒ‡å®šå‚æ•°ï¼š</span></section></li></ol><ul><li><section><code><span leaf="">gene_window_size</span></code><span leaf="">ï¼šåŸºå› bodyä¸Šä¸‹æ¸¸çš„è·ç¦»ã€‚åœ¨è¿™ä¸ªçª—å£å†…çš„SNPéƒ½ä¼šç›´æ¥è·Ÿç›¸åº”çš„åŸºå› æ˜ å°„ã€‚å¦‚æœä¸€ä¸ªSNPè½å…¥å¤šä¸ªåŸºå› çš„çª—å£ä¸­ï¼Œé‚£ä¹ˆå°†ä¼šæ˜ å°„åˆ°è·ç¦»TSSæœ€è¿‘çš„åŸºå› ã€‚</span></section></li></ul><ol start="2"><li><section><span leaf="">é€šè¿‡enhancerå’ŒåŸºå› çš„è°ƒæ§å…³ç³»ï¼Œè½å…¥åŸºå› bodyå’Œenhancerçš„SNPéƒ½ä¼šæ˜ å°„åˆ°å¯¹åº”åŸºå› ï¼Œéœ€è¦æŒ‡å®šä»¥ä¸‹å‚æ•°ï¼š</span></section></li></ol><ul><li><section><code><span leaf="">enhancer_annotation_file</span></code><span leaf="">ï¼šæŒ‡å®šenhancer-åŸºå› å¯¹åº”å…³ç³»çš„æ³¨é‡Šæ–‡ä»¶ã€‚</span></section></li><li><section><code><span leaf="">snp_multienhancer_strategy</span></code><span leaf="">ï¼šå½“SNPè½å…¥å¤šä¸ªåŸºå› çš„enhanceråŒºåŸŸæ—¶é‡‡å–çš„ç­–ç•¥ã€‚'max_mkscore'è¡¨ç¤ºæ˜ å°„åˆ°GSSæœ€å¤§çš„åŸºå› ï¼›'nearest_TSS'è¡¨ç¤ºæ˜ å°„åˆ°TSSæœ€è¿‘çš„åŸºå› ã€‚</span></section></li><li><section><code><span leaf="">gene_window_enhancer_priority</span></code><span leaf="">ï¼šå½“SNPåŒæ—¶è½å…¥åŸºå› çª—å£å’Œenhanceræ—¶é‡‡å–çš„ç­–ç•¥ã€‚åœ¨ä»…è€ƒè™‘enhanceræ—¶éœ€è®¾ä¸º'enhancer_only'ã€‚åœ¨ä¸‹ä¸€ç§æƒ…å†µä¸‹ï¼Œ'gene_window_first'å’Œ'enhancer_first'åˆ†åˆ«è¡¨ç¤ºä¼˜å…ˆæ˜ å°„åŸºå› çª—å£å’Œenhancerã€‚</span><span leaf=""><br></span><span leaf="">enhanceræ³¨é‡Šæ–‡ä»¶ä¸ºè¿™ç§å½¢å¼ï¼š</span></section></li></ul><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">head ABC_roadmap_merged.bed</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Chromosome Start End symbol</span><span leaf=""><br></span><span leaf="">chr1 32803048 32803704 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 32856711 32857379 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33169042 33169769 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33225064 33226048 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33226459 33227433 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33446521 33447063 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33454352 33455149 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33457470 33459019 A3GALT2</span><span leaf=""><br></span><span leaf="">chr1 33515824 33516453 A3GALT2</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">gsMapçš„å‚è€ƒæ–‡ä»¶ä¸­è¿˜æä¾›äº†äººä¸åŒç»„ç»‡å™¨å®˜ä¸­çš„enhanceræ³¨é‡Šï¼Œå¯ä»¥æ ¹æ®è‡ªå·±åˆ†æçš„æ ·æœ¬ç±»å‹çµæ´»é€‰æ‹©ï¼Œè€Œå¿«é€Ÿæ¨¡å¼åˆ™æ²¡æœ‰è¿™ä¸ªå‚æ•°å¯é€‰ã€‚</span></strong><span leaf=""><br></span><span leaf="">3. åŒæ—¶è€ƒè™‘åŸºå› bodyä¸Šä¸‹æ¸¸çª—å£å’Œenhancerï¼Œéœ€è¦æŒ‡å®šä¸Šè¿°æ‰€æœ‰å‚æ•°ï¼Œå°ç¼–è¿™æ¬¡ç”¨è¿™ç§æƒ…å†µè¿›è¡Œæ¼”ç¤ºï¼Œè¿™æ­¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿è¡Œã€‚</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥å¤§çº¦éœ€è¦40Gå†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">for</span></span><span leaf="">Â CHROMÂ </span><span><span leaf="">in</span></span><span leaf="">Â {1..22}</span><span leaf=""><br></span><span><span leaf="">do</span></span><span leaf=""><br></span><span leaf="">Â  Â  gsmap run_generate_ldscore \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --chromÂ </span><span><span leaf="">$CHROM</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --bfile_rootÂ </span><span><span leaf="">'../gsMap_resource/LD_Reference_Panel/1000G_EUR_Phase3_plink/1000G.EUR.QC'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --keep_snp_rootÂ </span><span><span leaf="">'../gsMap_resource/LDSC_resource/hapmap3_snps/hm'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --gtf_annotation_fileÂ </span><span><span leaf="">'../gsMap_resource/genome_annotation/gtf/gencode.v46lift37.basic.annotation.gtf'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --gene_window_size 50000 \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --enhancer_annotation_fileÂ </span><span><span leaf="">'../gsMap_resource/genome_annotation/enhancer/by_tissue/ALL/ABC_roadmap_merged.bed'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --snp_multiple_enhancer_strategyÂ </span><span><span leaf="">'max_mkscore'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --gene_window_enhancer_priorityÂ </span><span><span leaf="">'gene_window_first'</span></span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™ä¸€æ­¥ä¼šäº§ç”Ÿå¾ˆå¤šç»“æœï¼Œå’±ä¸ç®¡é‚£äº›ä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œé‡ç‚¹çœ‹è¿™ä¸¤ä¸ªç›®å½•ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">SNP_gene_pair/</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ SNP_gene_pair_chr10.feather</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ ...</span><span leaf=""><br></span><span leaf="">â””â”€â”€ SNP_gene_pair_chr9.feather</span><span leaf=""><br></span><span leaf="">w_ld/</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ weights.10.l2.ldscore.gz</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ ...</span><span leaf=""><br></span><span leaf="">â””â”€â”€ weights.9.l2.ldscore.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">SNP_gene_pair</span></code><span leaf="">å‚¨å­˜çš„å°±æ˜¯SNPå’ŒåŸºå› çš„æ˜ å°„ä¿¡æ¯ã€‚æˆ‘ä»¬å…ˆè¯»å–chr1é‚£ä¸ªæ–‡ä»¶çœ‹çœ‹</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â pyarrow.featherÂ </span><span><span leaf="">as</span></span><span leaf="">Â feather</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">snp_gene = feather.read_feather(</span><span><span leaf="">"step/E16.5_E1S1.MOSTA/generate_ldscore/SNP_gene_pair/SNP_gene_pair_chr1.feather"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">snp_gene.iloc[</span><span><span leaf="">860</span></span><span leaf="">:</span><span><span leaf="">865</span></span><span leaf="">, :]</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Â SNP gene_name CHR BP CM</span><span leaf=""><br></span><span leaf="">860 rs145881258 SAMD11 1 876067 0.620827</span><span leaf=""><br></span><span leaf="">861 rs71628924 SAMD11 1 876200 0.620827</span><span leaf=""><br></span><span leaf="">862 rs4372192 SAMD11 1 876499 0.620827</span><span leaf=""><br></span><span leaf="">863 rs72902600 SAMD11 1 876949 0.620827</span><span leaf=""><br></span><span leaf="">864 rs114982608 NOC2L 1 877147 0.620827</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨è¿™ä¸ªè¡¨æ ¼ä¸­ï¼Œå¦‚æœSNPæ²¡æœ‰æ˜ å°„çš„åŸºå› ï¼Œåˆ™gene_nameä¸ºNoneï¼›BPè¡¨ç¤ºSNPåœ¨æŸ“è‰²ä½“ä¸Šçš„ç‰©ç†ä½ç½®ï¼Œå•ä½ä¸ºbpï¼›CMè¡¨ç¤ºSNPåœ¨æŸ“è‰²ä½“ä¸Šçš„é—ä¼ ä½ç½®ï¼Œå•ä½ä¸ºå˜æ‘©ã€‚</span><span leaf=""><br></span><span leaf="">è¿™ä¸€æ­¥é™¤äº†å»ºç«‹SNPå’ŒåŸºå› çš„æ˜ å°„å¤–ï¼Œè¿˜ä¼šè®¡ç®—SNPçš„è¿é”ä¸å¹³è¡¡ï¼ˆLDï¼‰åˆ†æ•°ï¼Œå®ƒçš„å½¢å¼ä¸ºï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">zcat weights.1.l2.ldscore.gz | head</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">CHR SNP BP CM L2</span><span leaf=""><br></span><span leaf="">1 rs3131972 752721 0.4888678 4.282165</span><span leaf=""><br></span><span leaf="">1 rs3131969 754182 0.48973366 4.4342103</span><span leaf=""><br></span><span leaf="">1 rs3131967 754334 0.48979417 4.4342103</span><span leaf=""><br></span><span leaf="">1 rs1048488 760912 0.49250725 4.3271613</span><span leaf=""><br></span><span leaf="">1 rs12562034 768448 0.49571378 1.2600546</span><span leaf=""><br></span><span leaf="">1 rs12124819 776546 0.49944228 2.0366306</span><span leaf=""><br></span><span leaf="">1 rs4040617 779322 0.50070773 4.124312</span><span leaf=""><br></span><span leaf="">1 rs2905036 792480 0.53674447 2.9040823</span><span leaf=""><br></span><span leaf="">1 rs4970383 838555 0.62082653 3.3426797</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å…¶ä¸­L2å°±æ˜¯SNPçš„LDåˆ†æ•°ï¼Œå®ƒè¶Šé«˜è¯´æ˜SNPè·Ÿä¸´è¿‘SNPçš„è¿é”ä¸å¹³è¡¡ç¨‹åº¦è¶Šé«˜ã€‚ç„¶è€ŒgsMapçš„å‚è€ƒæ•°æ®ä¸­æä¾›äº†äººçš„å„SNPçš„LDåˆ†æ•°ï¼Œæ‰€ä»¥åç»­åˆ†æä¸€èˆ¬ä¸ç”¨è¿™é‡Œç®—å‡ºæ¥çš„LDåˆ†æ•°ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç©ºé—´LDSCåˆ†æ</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¾—åˆ°äº†åŸºå› å’ŒSNPçš„æ˜ å°„å…³ç³»åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æ•´åˆGWASæ•°æ®è¿›è¡ŒLDSCåˆ†æäº†ã€‚è¿™é‡Œæ²¡å•¥å‚æ•°ç‰¹åˆ«éœ€è¦è§£é‡Šçš„ï¼Œå°±æ˜¯</span><code><span leaf="">w_file</span></code><span leaf="">åé¢æ¥çš„æ˜¯LDåˆ†æ•°æ–‡ä»¶çš„å‰ç¼€ã€‚</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥å¤§çº¦éœ€è¦40Gå†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_spatial_ldsc \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">"."</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sumstats_fileÂ </span><span><span leaf="">'../gsMap_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --w_fileÂ </span><span><span leaf="">'../gsMap_resource/LDSC_resource/weights_hm3_no_hla/weights.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --num_process 10</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿è¡Œç»“æœå°±æ˜¯ä¸€ä¸ªcsvè¡¨æ ¼ï¼Œå­˜å‚¨ç€æ¯ä¸ªspotçš„LDSCå›å½’çš„</span><span data-formula="\beta"><span data-formula="\beta"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -705 566 899" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path></g></g></g><g></g></svg></span></span><span leaf="">å€¼ä»¥åŠblock-jackknifeæ–¹æ³•è®¡ç®—çš„æ ‡å‡†è¯¯ã€zç»Ÿè®¡é‡å’Œpå€¼ã€‚è¿™ä¸ªè¡¨æ ¼å¯ä»¥è¿›ä¸€æ­¥å¯¼å…¥Seurat/AnnDataå¯¹è±¡ä¸­è¿›è¡Œåˆ†æå’Œå¯è§†åŒ–ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">zcat E16.5_E1S1.MOSTA_IQ.csv.gz | head</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">spot,beta,se,z,p</span><span leaf=""><br></span><span leaf="">190_194,-8.760567138111535e-09,2.3904128827941287e-09,-3.664876139669813,0.9998762708438821</span><span leaf=""><br></span><span leaf="">190_195,-1.017986287894897e-08,1.8104173514659798e-09,-5.622937092768061,0.999999990613111</span><span leaf=""><br></span><span leaf="">190_196,-9.676589019076809e-09,1.7393880753927583e-09,-5.563214532726867,0.999999986757502</span><span leaf=""><br></span><span leaf="">190_197,-8.654820922724944e-09,1.7101907418698534e-09,-5.060734285850543,0.9999997911775429</span><span leaf=""><br></span><span leaf="">190_198,-9.285564032846918e-09,1.6392959203110825e-09,-5.664361094173183,0.9999999926213325</span><span leaf=""><br></span><span leaf="">190_199,-8.68369809825401e-09,1.706017320378527e-09,-5.090040994617389,0.9999998210069435</span><span leaf=""><br></span><span leaf="">190_200,-7.79527285731608e-09,1.6845775390074085e-09,-4.627434877179493,0.9999981488870429</span><span leaf=""><br></span><span leaf="">190_201,-8.744531510222193e-09,1.7063147137160712e-09,-5.124805781682589,0.9999998510776975</span><span leaf=""><br></span><span leaf="">190_202,-7.892295642543661e-09,1.7265129666357858e-09,-4.57123450275747,0.9999975757034143</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å¾—åˆ°äº†æ¯ä¸ªspotä¸è¡¨å‹å…³è”çš„æ˜¾è‘—æ€§på€¼ï¼ŒgsMapåˆ†æçš„ä¸»ä½“éƒ¨åˆ†ä¹Ÿå·²ç»å®Œæˆäº†ã€‚åé¢ä¸¤éƒ¨ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©æ€§è¿è¡Œã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æŸ¯è¥¿åˆå¹¶æ£€éªŒï¼ˆå¯é€‰ï¼‰</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æŸ¯è¥¿åˆå¹¶æ£€éªŒå°±æ˜¯æŠŠspotçš„på€¼æŒ‰ç»„ç»‡æˆ–ç»†èƒç±»å‹è¿›è¡Œåˆå¹¶ã€‚ä½¿ç”¨ä¸‹é¢ä»£ç å®Œæˆã€‚</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥å¤§çº¦éœ€è¦12Gçš„å†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_cauchy_combination \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿è¡Œç»“æœæ˜¯ä¸€ä¸ªcsvè¡¨æ ¼ï¼Œè®°å½•ç€æŸ¯è¥¿åˆå¹¶æ£€éªŒçš„på€¼ä»¥åŠç®€å•å–ä¸­ä½æ•°çš„på€¼ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">zcat E16.5_E1S1.MOSTA_IQ.Cauchy.csv.gz | head</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">annotation,p_cauchy,p_median</span><span leaf=""><br></span><span leaf="">Brain,1.7822683407008737e-26,9.443479488838352e-16</span><span leaf=""><br></span><span leaf="">Spinal cord,1.2455551008640988e-20,5.945566346850132e-13</span><span leaf=""><br></span><span leaf="">Dorsal root ganglion,6.3162808316974406e-12,3.984616094128103e-09</span><span leaf=""><br></span><span leaf="">Choroid plexus,1.9943233731112286e-09,4.902085774857428e-06</span><span leaf=""><br></span><span leaf="">Sympathetic nerve,8.755048019892797e-09,6.910435592108675e-07</span><span leaf=""><br></span><span leaf="">Mucosal epithelium,5.986670119750848e-06,0.0067753931043148</span><span leaf=""><br></span><span leaf="">Meninges,9.19767922591408e-06,0.1482752689335825</span><span leaf=""><br></span><span leaf="">Muscle,1.2536003082930236e-05,0.0059370242200209</span><span leaf=""><br></span><span leaf="">Cartilage primordium,2.195056642739779e-05,0.0325189969669502</span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æŠ¥å‘Šç”Ÿæˆï¼ˆå¯é€‰ï¼‰</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨å®Œæˆä¸Šè¿°è¿‡ç¨‹åï¼Œå¦‚æœç”¨æˆ·æƒ³ç”Ÿæˆä¸€ä»½åƒå¿«é€Ÿæ¨¡å¼é‚£ç§æŠ¥å‘Šï¼Œå¯ä»¥ç”¨ä¸‹é¢ä»£ç ç”Ÿæˆï¼š</span><span leaf=""><br></span><strong><span leaf="">è¿™ä¸€æ­¥éœ€è¦çº¦60Gå†…å­˜</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_report \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sumstats_fileÂ </span><span><span leaf="">'../gsMap_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --top_corr_genes 50</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">top_corr_genes</span></code><span leaf="">æ§åˆ¶çš„æ˜¯æŠ¥å‘Šä¸­å±•ç¤ºçš„GSSä¸-log10(p_value)ç›¸å…³æ€§æœ€é«˜çš„50ä¸ªåŸºå› ï¼›å¦‚æœè¦å±•ç¤ºæ„Ÿå…´è¶£çš„åŸºå› ï¼Œå¯ä»¥ç”¨</span><code><span leaf="">selected_genes</span></code><span leaf="">æŒ‡å®šã€‚</span></p><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">é«˜çº§ç”¨æ³•</span></span><span></span></h1><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">è‡ªå®šä¹‰æ½œåœ¨åµŒå…¥</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å°ç¼–åœ¨å‰é¢ä¹Ÿæåˆ°è¿‡ï¼Œæ½œåœ¨åµŒå…¥ä¸ä¸€å®šéœ€è¦GVAEå­¦ä¹ å‡ºæ¥çš„ï¼Œå¯ä»¥é€šè¿‡ä»»ä½•é™ç»´ç®—æ³•è®¡ç®—å¾—åˆ°ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€è¦æŠŠåµŒå…¥çŸ©é˜µä½œä¸ºAnnDataå¯¹è±¡çš„obsmåŸŸï¼Œå…¶ä¸­æ¯ä¸€è¡Œä¸ºå•ä¸ªspotçš„åµŒå…¥å‘é‡å°±è¡Œã€‚ç„¶ååœ¨</span><code><span leaf="">gsmap run_latent_to_gene</span></code><span leaf="">çš„</span><code><span leaf="">latent_representation</span></code><span leaf="">å‚æ•°ä¸­æŒ‡å®šåµŒå…¥çŸ©é˜µçš„åç§°å°±å¥½ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># This could be any key in the obsm field of the AnnData object.</span></span><span leaf=""><br></span><span leaf="">latent_customized =Â </span><span><span leaf="">'latent_customized'</span></span><span leaf=""><br></span><span leaf="">gsmap run_latent_to_gene \</span><span leaf=""><br></span><span leaf="">Â  Â  --input_hdf5_pathÂ </span><span><span leaf="">'sample1.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --workdirÂ </span><span><span leaf="">'./workdir'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --sample_nameÂ </span><span><span leaf="">'sample1'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --latent_representationÂ </span><span><span leaf="">$latent_customized</span></span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ¡ä»¶åˆ†æ</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨ç”ŸæˆLDåˆ†æ•°æ­¥éª¤ä¸­ï¼Œä¹Ÿå¯ä»¥åŠ å…¥ä¸€äº›åŸºçº¿æŒ‡æ ‡ç”¨ä½œLDSCåˆ†æçš„å¯¹ç…§ã€‚äººçš„åŸºçº¿å‚è€ƒæ•°æ®å¯ä»¥ä¸‹è½½ä¸º</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">wget https://yanglab.westlake.edu.cn/data/gsMap/gsMap_additional_annotation.tar.gz</span><span leaf=""><br></span><span leaf="">tar -xvzf gsMap_additional_annotation.tar.gz</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨gsMap_additional_annotationç›®å½•ä¸­å­˜æ”¾ç€æ¯æ¡æŸ“è‰²ä½“çš„åŸºçº¿æ³¨é‡Šæ–‡ä»¶ï¼Œä»¥1å·æŸ“è‰²ä½“ä¸ºä¾‹</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">zcat baseline.1.annot.gz | head | cut -f 1-7</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">CHR BP SNP CM Coding_UCSC Coding_UCSC.extend.500 Conserved_LindbladToh</span><span leaf=""><br></span><span leaf="">1 11008 rs575272151 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 11012 rs544419019 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 13110 rs540538026 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 13116 rs62635286 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 13118 rs200579949 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 13273 rs531730856 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 13550 rs554008981 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 14464 rs546169444 0.0 0 0 0</span><span leaf=""><br></span><span leaf="">1 14599 rs531646671 0.0 0 0 0</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä»ç¬¬5åˆ—å¼€å§‹ï¼Œåé¢æ¯ä¸€åˆ—éƒ½è®°å½•ç€SNPæ‰€åœ¨ä½ç½®çš„å±æ€§ï¼Œå¦‚æ˜¯å¦æ˜¯ç¼–ç åŒºã€promoterã€intronã€5'UTRç­‰ã€‚è¿™äº›å±æ€§å¾€å¾€æ˜¯è·Ÿè¡¨å‹æ— å…³çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½œä¸ºLDSCåˆ†æåŸºçº¿å‚è€ƒå˜é‡ã€‚</span><span leaf=""><br></span><span leaf="">è¦åŠ ä¸Šè¿™äº›åŸºçº¿å˜é‡ï¼Œåªéœ€åœ¨ç”ŸæˆLDåˆ†æ•°æ­¥éª¤å°†</span><code><span leaf="">additional_baseline_annotation</span></code><span leaf="">å‚æ•°è®¾ä¸ºåŸºçº¿æ³¨é‡Šæ–‡ä»¶å¤¹åç§°å³å¯ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">for</span></span><span leaf="">Â CHROMÂ </span><span><span leaf="">in</span></span><span leaf="">Â {1..22}</span><span leaf=""><br></span><span><span leaf="">do</span></span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  gsmap run_generate_ldscore \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --chromÂ </span><span><span leaf="">$CHROM</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --bfile_rootÂ </span><span><span leaf="">'../gsMap_resource/LD_Reference_Panel/1000G_EUR_Phase3_plink/1000G.EUR.QC'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --keep_snp_rootÂ </span><span><span leaf="">'../gsMap_resource/LDSC_resource/hapmap3_snps/hm'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --gtf_annotation_fileÂ </span><span><span leaf="">'../gsMap_resource/genome_annotation/gtf/gencode.v46lift37.basic.annotation.gtf'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --gene_window_size 50000 \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  --additional_baseline_annotationÂ </span><span><span leaf="">'gsMap_additional_annotation'</span></span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç”Ÿç‰©å­¦é‡å¤</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåšå¤šä¸ªç©ºè½¬åˆ‡ç‰‡ä½œä¸ºç”Ÿç‰©å­¦é‡å¤ã€‚gsMapå¯¹ç”Ÿç‰©å­¦é‡å¤çš„æ•´åˆä¸»è¦åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">è®¡ç®—åˆ‡ç‰‡å‡å€¼</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapå¯ä»¥è®¡ç®—æ¯ä¸ªåŸºå› åœ¨æ‰€æœ‰åˆ‡ç‰‡ä¸­çš„åŸºå› è¡¨è¾¾æ’åºçš„å‡å€¼ã€‚è¿™äº›å‡å€¼åˆå¯ä½œä¸ºå‚ç…§ç”¨äºæ¯ä¸ªæ ·æœ¬çš„GSSçš„è®¡ç®—ï¼Œä»è€Œå¯ä»¥å¢åŠ æ ·æœ¬é—´æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯æ¯”æ€§ã€‚é€šè¿‡ä»¥ä¸‹ä»£ç è¿›è¡Œè®¡ç®—ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap create_slice_mean \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_name_listÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â </span><span><span leaf="">'E16.5_E2S11.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --h5ad_listÂ </span><span><span leaf="">'../gsMap_example_data/ST/E16.5_E1S1.MOSTA.h5ad'</span></span><span leaf="">Â </span><span><span leaf="">'../gsMap_example_data/ST/E16.5_E2S11.MOSTA.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --slice_mean_output_fileÂ </span><span><span leaf="">'sample_slice_mean.parquet'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è®¡ç®—å¾—åˆ°äº†ä¸€ä¸ªparquetæ–‡ä»¶ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§å­˜å‚¨æ•°æ®æ¡†çš„æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡pandasè¯»å–</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â pandasÂ </span><span><span leaf="">as</span></span><span leaf="">Â pd</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">df = pd.read_parquet(</span><span><span leaf="">"replicate/sample_slice_mean.parquet"</span></span><span leaf="">, engine=</span><span><span leaf="">"pyarrow"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">df.head()</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Â G_Mean frac</span><span leaf=""><br></span><span leaf="">gene Â </span><span leaf=""><br></span><span leaf="">0610010F05Rik 8014.482320 0.095213</span><span leaf=""><br></span><span leaf="">0610010K14Rik 8760.099930 0.220422</span><span leaf=""><br></span><span leaf="">0610012G03Rik 9218.004314 0.286876</span><span leaf=""><br></span><span leaf="">0610030E20Rik 7728.556558 0.050133</span><span leaf=""><br></span><span leaf="">0610040J01Rik 7518.777238 0.016676</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ•°æ®æ¡†å­˜å‚¨ç€æ¯ä¸ªåŸºå› çš„å¹³å‡è¡¨è¾¾æ’åå’Œè¡¨è¾¾æ¯”ä¾‹ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åˆ‡ç‰‡å‡å€¼ç”¨äºå¿«é€Ÿæ¨¡å¼</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨å¤šæ ·æœ¬å‡å€¼ä¿®æ­£å¿«é€Ÿæ¨¡å¼è¿è¡Œï¼Œåªéœ€åœ¨</span><code><span leaf="">gM_slices</span></code><span leaf="">å‚æ•°æŒ‡å®šparquetæ–‡ä»¶å³å¯ã€‚æ³¨æ„è¿™é‡Œåªä»¥å…¶ä¸­ä¸€ä¸ªæ ·æœ¬ä¸ºä¾‹ï¼Œå¦ä¸€ä¸ªæ ·æœ¬ä¹Ÿæ˜¯ç›¸åŒçš„æ–¹å¼è¿›è¡Œä¿®æ­£ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap quick_mode \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --gsMap_resource_dirÂ </span><span><span leaf="">'../gsMap_resource'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --hdf5_pathÂ </span><span><span leaf="">'../gsMap_example_data/ST/E16.5_E1S1.MOSTA.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --sumstats_fileÂ </span><span><span leaf="">'../gsMap_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  --gM_slicesÂ </span><span><span leaf="">'sample_slice_mean.parquet'</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åˆ‡ç‰‡å‡å€¼ç”¨äºåˆ†æ­¥æ¨¡å¼</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">åœ¨åˆ†æ­¥æ¨¡å¼ä¸­ï¼Œ</span><code><span leaf="">gM_slice</span></code><span leaf="">å‚æ•°åœ¨è®¡ç®—GSSé‚£ä¸€æ­¥æŒ‡å®šã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_latent_to_gene \</span><span leaf=""><br></span><span leaf="">Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --sample_nameÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --latent_representationÂ </span><span><span leaf="">'latent_GVAE'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --num_neighbour 51 \</span><span leaf=""><br></span><span leaf="">Â  Â  --num_neighbour_spatial 201 \</span><span leaf=""><br></span><span leaf="">Â  Â  --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --gM_slicesÂ </span><span><span leaf="">'sample_slice_mean.parquet'</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤šæ ·æœ¬æŸ¯è¥¿åˆå¹¶æ£€éªŒ</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">gsMapè¿˜èƒ½å¯¹å¤šæ ·æœ¬ä¸­çš„ç›¸åŒç»†èƒæˆ–ç»„ç»‡ç±»å‹è¿›è¡ŒæŸ¯è¥¿åˆå¹¶æ£€éªŒï¼Œåªéœ€åœ¨</span><code><span leaf="">sample_name_list</span></code><span leaf="">å‚æ•°æŒ‡å®šå¤šä¸ªæ ·æœ¬çš„è¾“å‡ºç›®å½•ï¼Œå¹¶ä¸”åœ¨</span><code><span leaf="">output_file</span></code><span leaf="">å‚æ•°é¢å¤–æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„å³å¯ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap run_cauchy_combination \</span><span leaf=""><br></span><span leaf="">Â  Â  --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --sample_name_listÂ </span><span><span leaf="">'E16.5_E1S1.MOSTA'</span></span><span leaf="">Â </span><span><span leaf="">'E16.5_E2S11.MOSTA'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --annotationÂ </span><span><span leaf="">'annotation'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â  --output_fileÂ </span><span><span leaf="">'combined_IQ_cauchy_combination.csv.gz'</span></span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">10X Visiumæ•°æ®å®ä¾‹</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å‰é¢çš„æ•™ç¨‹éƒ½æ˜¯ç”¨Stereo-seqçš„ç¤ºä¾‹æ•°æ®ï¼Œç„¶è€Œé™¤äº†Stereo-seqï¼Œ10X Visiumä¹Ÿæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç©ºé—´ç»„å­¦æŠ€æœ¯ã€‚è™½ç„¶Visiumæ²¡æœ‰å•ç»†èƒåˆ†è¾¨ç‡ï¼Œä½†æ˜¯ä¹Ÿèƒ½ä½¿ç”¨gsMapåœ¨ç»„ç»‡æˆ–è€…ç©ºé—´äºšç¾¤å±‚é¢è¿›è¡Œåˆ†æã€‚</span><span leaf=""><br></span><span leaf="">é¦–å…ˆä¸‹è½½Visiumçš„ç¤ºä¾‹æ•°æ®</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">wget https://yanglab.westlake.edu.cn/data/gsMap/gsMap_resource.tar.gz</span><span leaf=""><br></span><span leaf="">tar -xvzf gsMap_resource.tar.gz</span><span leaf=""><br></span><span leaf="">tree Visium_example_data</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Visium_example_data</span><span leaf=""><br></span><span leaf="">â”œâ”€â”€ GWAS</span><span leaf=""><br></span><span leaf="">â”‚ Â  â”œâ”€â”€ IQ_NG_2018.sumstats.gz</span><span leaf=""><br></span><span leaf="">â”‚ Â  â””â”€â”€ Serum_creatinine.sumstats.gz</span><span leaf=""><br></span><span leaf="">â””â”€â”€ ST</span><span leaf=""><br></span><span leaf="">Â  Â  â”œâ”€â”€ V1_Adult_Mouse_Brain_Coronal_Section.h5ad</span><span leaf=""><br></span><span leaf="">Â  Â  â”œâ”€â”€ V1_Mouse_Brain_Sagittal_Posterior_Section.h5ad</span><span leaf=""><br></span><span leaf="">Â  Â  â””â”€â”€ V1_Mouse_Kidney.h5ad</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¯ä»¥å‘ç°ï¼Œç¤ºä¾‹æ•°æ®ä¸­GWASæ•°æ®åŒ…å«æœ‰IQå’Œè¡€æ¸…è‚Œé…è¿™ä¸¤ç§è¡¨å‹ã€‚æˆ‘ä»¬é‡ç‚¹å…³æ³¨ç©ºè½¬æ•°æ®ï¼ŒåŒ…å«æˆå¹´å°é¼ å† çŠ¶åˆ‡ç‰‡ã€æˆå¹´å°é¼ çŸ¢çŠ¶åˆ‡ç‰‡ä»¥åŠæˆå¹´å°é¼ è‚¾è„ã€‚è¿™é‡Œæˆ‘ä»¬è¯»å–æˆå¹´å°é¼ å† çŠ¶åˆ‡ç‰‡çš„æ ·æœ¬çœ‹çœ‹</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â scanpyÂ </span><span><span leaf="">as</span></span><span leaf="">Â sc</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">corocal_brain = sc.read_h5ad(</span><span><span leaf="">"visium/Visium_example_data/ST/V1_Adult_Mouse_Brain_Coronal_Section.h5ad"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">corocal_brain</span><span leaf=""><br></span><span leaf="">corocal_brain.obs.head()</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">AnnData object with n_obs Ã— n_vars = 2902 Ã— 32285</span><span leaf=""><br></span><span leaf="">Â  Â  obs:Â </span><span><span leaf="">'in_tissue'</span></span><span leaf="">,Â </span><span><span leaf="">'array_row'</span></span><span leaf="">,Â </span><span><span leaf="">'array_col'</span></span><span leaf="">,Â </span><span><span leaf="">'domain'</span></span><span leaf=""><br></span><span leaf="">Â  Â  var:Â </span><span><span leaf="">'gene_ids'</span></span><span leaf="">,Â </span><span><span leaf="">'feature_types'</span></span><span leaf="">,Â </span><span><span leaf="">'genome'</span></span><span leaf=""><br></span><span leaf="">Â  Â  uns:Â </span><span><span leaf="">'spatial'</span></span><span leaf=""><br></span><span leaf="">Â  Â  obsm:Â </span><span><span leaf="">'spatial'</span></span><span leaf=""><br></span><span leaf="">Â  Â  layers:Â </span><span><span leaf="">'count'</span></span><span leaf=""><br></span><span leaf="">Â in_tissue array_row array_col domain</span><span leaf=""><br></span><span leaf="">AAACAAGTATCTCCCA-1 1 50 102 4</span><span leaf=""><br></span><span leaf="">AAACAGAGCGACTCCT-1 1 14 94 2</span><span leaf=""><br></span><span leaf="">AAACAGTGTTCCTGGG-1 1 73 43 1</span><span leaf=""><br></span><span leaf="">AAACATTTCCCGGATT-1 1 61 97 5</span><span leaf=""><br></span><span leaf="">AAACCGGGTAGGTACC-1 1 42 28 3</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å¯ä»¥å‘ç°ï¼Œ10X Visiumçš„AnnDataæ ¼å¼ä¸Stereo-seqçš„åŸºæœ¬ç±»ä¼¼ã€‚åŒºåˆ«å°±åœ¨äº10X Visiumæ— æ³•æ³¨é‡Šspotä¸ºå…·ä½“çš„ç»†èƒç±»å‹ï¼Œåªæœ‰é€šè¿‡èšç±»åˆ’åˆ†çš„domainã€‚</span><span leaf=""><br></span><span leaf="">Visiumæ•°æ®çš„gsMapåˆ†ææ–¹æ³•è·ŸStereo-seqæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ä¸ºäº†çœäº‹ï¼Œå°ç¼–ç›´æ¥æŠŠ3ä¸ªæ ·æœ¬çš„gsMapåˆ†æå†™æˆäº†ä¸€ä¸ªè„šæœ¬ç»Ÿä¸€è¿è¡Œã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gsmap quick_mode \</span><span leaf=""><br></span><span leaf="">Â  Â --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sample_nameÂ </span><span><span leaf="">'V1_Adult_Mouse_Brain_Coronal_Section'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --gsMap_resource_dirÂ </span><span><span leaf="">'../gsMap_resource'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --hdf5_pathÂ </span><span><span leaf="">'Visium_example_data/ST/V1_Adult_Mouse_Brain_Coronal_Section.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --annotationÂ </span><span><span leaf="">'domain'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sumstats_fileÂ </span><span><span leaf="">'Visium_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gsmap quick_mode \</span><span leaf=""><br></span><span leaf="">Â  Â --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sample_nameÂ </span><span><span leaf="">'V1_Mouse_Brain_Sagittal_Posterior_Section'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --gsMap_resource_dirÂ </span><span><span leaf="">'../gsMap_resource'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --hdf5_pathÂ </span><span><span leaf="">'Visium_example_data/ST/V1_Mouse_Brain_Sagittal_Posterior_Section.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --annotationÂ </span><span><span leaf="">'domain'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sumstats_fileÂ </span><span><span leaf="">'Visium_example_data/GWAS/IQ_NG_2018.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --trait_nameÂ </span><span><span leaf="">'IQ'</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gsmap quick_mode \</span><span leaf=""><br></span><span leaf="">Â  Â --workdirÂ </span><span><span leaf="">'.'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --homolog_fileÂ </span><span><span leaf="">'../gsMap_resource/homologs/mouse_human_homologs.txt'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sample_nameÂ </span><span><span leaf="">'V1_Mouse_Kidney'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --gsMap_resource_dirÂ </span><span><span leaf="">'../gsMap_resource'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --hdf5_pathÂ </span><span><span leaf="">'Visium_example_data/ST/V1_Mouse_Kidney.h5ad'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --annotationÂ </span><span><span leaf="">'domain'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --data_layerÂ </span><span><span leaf="">'count'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --sumstats_fileÂ </span><span><span leaf="">'Visium_example_data/GWAS/Serum_creatinine.sumstats.gz'</span></span><span leaf="">Â \</span><span leaf=""><br></span><span leaf="">Â  Â --trait_nameÂ </span><span><span leaf="">'Serum_creatinine'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è·‘å®Œä»¥åï¼Œæˆ‘ä»¬çœ‹çœ‹æˆå¹´å°é¼ å† çŠ¶åˆ‡ç‰‡çš„åˆ†æç»“æœæŠ¥å‘Šã€‚<img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCY5kibj6KA1XI5My6eLnKIibj4JjkrLUn6n6hOX8MMjBuqCfGPBEJ5qIyA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.124074074074074" data-type="png" data-w="1080" data-imgfileid="100012398" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCY5kibj6KA1XI5My6eLnKIibj4JjkrLUn6n6hOX8MMjBuqCfGPBEJ5qIyA/640?wx_fmt=png&amp;from=appmsg">å¯ä»¥å‘ç°ï¼ŒVisiumæ•°æ®æŠ¥å‘Šçš„å¯è§†åŒ–æ•ˆæœä¸å¤ªå¥½ï¼Œspotè¿‡å¤§ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æ˜¾ç¤ºH&amp;EæŸ“è‰²çš„åˆ‡ç‰‡ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯å°†åˆ†æç»“æœå¯¼å…¥Scanpyä¸­è¿›è¡Œå¯è§†åŒ–ã€‚æˆ‘ä»¬é¦–å…ˆå¯è§†åŒ–ä¸€ä¸‹på€¼ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">import</span></span><span leaf="">Â pandasÂ </span><span><span leaf="">as</span></span><span leaf="">Â pd</span><span leaf=""><br></span><span><span leaf="">import</span></span><span leaf="">Â numpyÂ </span><span><span leaf="">as</span></span><span leaf="">Â np</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p_value_res = pd.read_csv(</span><span><span leaf="">"visium/V1_Adult_Mouse_Brain_Coronal_Section/spatial_ldsc/V1_Adult_Mouse_Brain_Coronal_Section_IQ.csv.gz"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p_value_res.index = p_value_res[</span><span><span leaf="">'spot'</span></span><span leaf="">].values</span><span leaf=""><br></span><span leaf="">corocal_brain.obs = corocal_brain.obs.merge(</span><span leaf=""><br></span><span leaf="">Â  Â  right=p_value_res,</span><span leaf=""><br></span><span leaf="">Â  Â  how=</span><span><span leaf="">'left'</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  left_index=</span><span><span leaf="">True</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  right_index=</span><span><span leaf="">True</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">corocal_brain.obs[</span><span><span leaf="">'-log10(p)'</span></span><span leaf="">] =Â </span><span><span leaf="">-1</span></span><span leaf="">Â * corocal_brain.obs[</span><span><span leaf="">'p'</span></span><span leaf="">].apply(</span><span><span leaf="">lambda</span></span><span leaf="">Â x:Â </span><span><span leaf="">0</span></span><span leaf="">Â </span><span><span leaf="">if</span></span><span leaf="">Â x ==Â </span><span><span leaf="">0</span></span><span leaf="">Â </span><span><span leaf="">else</span></span><span leaf="">Â np.log10(x))</span><span leaf=""><br></span><span leaf="">sc.pl.spatial(corocal_brain, color=</span><span><span leaf="">'-log10(p)'</span></span><span leaf="">, size=</span><span><span leaf="">1</span></span><span leaf="">, frameon=</span><span><span leaf="">False</span></span><span leaf="">, img_key=</span><span><span leaf="">'hires'</span></span><span leaf="">, cmap=</span><span><span leaf="">'magma'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYR8Lr9c3c95mpTbia1iakyfg5EEX6YmaaKNLOdQ8JhbWGKpfvyFl3Y6uA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.312849162011173" data-type="png" data-w="716" data-imgfileid="100012397" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYR8Lr9c3c95mpTbia1iakyfg5EEX6YmaaKNLOdQ8JhbWGKpfvyFl3Y6uA/640?wx_fmt=png&amp;from=appmsg">å¯ä»¥å‘ç°è¿™ä¸ªæ ·æœ¬æ˜¯ä»¥è§å…‰æˆåƒä¸ºåº•ç‰‡åšçš„ç©ºè½¬ï¼Œå¯è§†åŒ–æ¸…æ¥šå¤šäº†ã€‚</span><span leaf=""><br></span><span leaf="">æŠ¥å‘Šé‡Œè¿˜æœ‰é’ˆå¯¹åŸºå› çš„GSSçš„å¯è§†åŒ–å±•ç¤ºï¼Œé‚£æˆ‘ä»¬ä¹Ÿåœ¨Scanpyé‡Œå®ç°ä¸€ä¸‹å­ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">from</span></span><span leaf="">Â pyarrowÂ </span><span><span leaf="">import</span></span><span leaf="">Â feather</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gss = feather.read_feather(</span><span><span leaf="">"visium/V1_Adult_Mouse_Brain_Coronal_Section/latent_to_gene/V1_Adult_Mouse_Brain_Coronal_Section_gene_marker_score.feather"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">gss.index = gss[</span><span><span leaf="">'HUMAN_GENE_SYM'</span></span><span leaf="">].values</span><span leaf=""><br></span><span leaf="">gss = gss.drop(columns=[</span><span><span leaf="">'HUMAN_GENE_SYM'</span></span><span leaf="">])</span><span leaf=""><br></span><span leaf="">gss = gss.T</span><span leaf=""><br></span><span leaf="">corocal_brain.obs = corocal_brain.obs.merge(</span><span leaf=""><br></span><span leaf="">Â  Â  right=gss,</span><span leaf=""><br></span><span leaf="">Â  Â  how=</span><span><span leaf="">'left'</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  left_index=</span><span><span leaf="">True</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  right_index=</span><span><span leaf="">True</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sc.pl.spatial(corocal_brain, color=</span><span><span leaf="">'EPHX4'</span></span><span leaf="">, size=</span><span><span leaf="">1</span></span><span leaf="">, frameon=</span><span><span leaf="">False</span></span><span leaf="">, img_key=</span><span><span leaf="">'hires'</span></span><span leaf="">, cmap=</span><span><span leaf="">'magma'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYOxa7QFQPNPHic07KPjUSJvJ1xMdV5OjvodYzVM8IVZQWZZpSMyd1BibA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.3183730715287518" data-type="png" data-w="713" data-imgfileid="100012399" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7calxDyI9mY9DEr36eCTibCYOxa7QFQPNPHic07KPjUSJvJ1xMdV5OjvodYzVM8IVZQWZZpSMyd1BibA/640?wx_fmt=png&amp;from=appmsg">æ³¨æ„è¿™é‡Œæˆ‘æŠŠ</span><code><span leaf="">gss</span></code><span leaf="">çŸ©é˜µæ”¾åœ¨</span><code><span leaf="">obs</span></code><span leaf="">ä¸­æ˜¯å› ä¸ºç©ºè½¬æ˜¯é¼ çš„æ•°æ®ï¼Œä½†æ˜¯è®¡ç®—å‡ºçš„</span><code><span leaf="">gss</span></code><span leaf="">çŸ©é˜µæ˜¯äººçš„åŸºå› ã€‚å¦‚æœç©ºè½¬æ•°æ®ä¹Ÿæ˜¯äººçš„è¯éœ€è¦æŠŠ</span><code><span leaf="">gss</span></code><span leaf="">çŸ©é˜µæ”¾åœ¨</span><code><span leaf="">layer</span></code><span leaf="">ä¸­ï¼Œéœ€è¦å¯è§†åŒ–çš„æ—¶å€™ç›´æ¥å°†</span><code><span leaf="">gss</span></code><span leaf="">çŸ©é˜µä½œä¸ºä¸»çŸ©é˜µ</span><code><span leaf="">X</span></code><span leaf="">ã€‚</span><span leaf=""><br></span><span leaf="">gsMapçš„</span><span leaf="">è½¯ä»¶æ•™ç¨‹å°±</span><span leaf="">åˆ°è¿™é‡Œå•¦ï¼Œå°ä¼™ä¼´ä»¬ä¸‹æ¬¡è§ï½</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><h1 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span leaf="">GitHubé“¾æ¥ï¼šhttps://github.com/JianYang-Lab/gsMap</span></h1></section><p data-pm-slice="2 1 []"><span leaf=""><br></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7cwqaibulibXfhkQdkqSW0H9M5riaAVfSBb3ibibCZHnqViahn3dyukTiaJU0sKzC2xXD8U2Pa39ra5dz9xg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="jpeg" data-w="430" data-croporisrc="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7cwqaibulibXfhkQdkqSW0H9M5riaAVfSBb3ibibCZHnqViahn3dyukTiaJU0sKzC2xXD8U2Pa39ra5dz9xg/0?wx_fmt=jpeg&amp;from=appmsg" data-cropselx2="203" data-cropsely2="203" data-imgfileid="100010845" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7cwqaibulibXfhkQdkqSW0H9M5riaAVfSBb3ibibCZHnqViahn3dyukTiaJU0sKzC2xXD8U2Pa39ra5dz9xg/640?wx_fmt=jpeg&amp;from=appmsg"></section><h3 data-tool="mdniceç¼–è¾‘å™¨"><span><span leaf="">å…³æ³¨å…¬ä¼—å·ï¼Œä¸‹å›æ›´æ–°ä¸è¿·è·¯</span></span></h3><section><span leaf=""><br></span></section><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡å®åº“" data-alias="sxbk2020" data-from="2" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f0yanILMQZCnw1duTMROQRvgDqVjlYcrljTRy1E4ZLppLG6zicdd3h0IwjLpxnum1V5KsowibJM1sw/0?wx_fmt=png" data-signature="æœ¬å…¬ä¼—å·åªç”¨äºç”Ÿä¿¡çŸ¥è¯†çš„æ”¶é›†ä¸ä¼ æ’­ï¼Œä»¥åŠç”Ÿä¿¡äººä¹‹é—´äº’ç›¸äº¤æµå’Œå­¦ä¹ ï¼Œä¸ä¼šæ¶‰åŠä»»ä½•å•†ä¸šåˆ©ç›Šã€‚æœ¬å…¬ä¼—å·å„å°ç¼–å¹³æ—¶å¿™äºç§‘ç ”ï¼Œæ›´æ–°æ–‡ç« è¾ƒå…¶å®ƒåŒç±»å‹å…¬ä¼—å·è¾ƒæ…¢ï¼Œä½†ä¿æŒå®ç¼ºæ¯‹æ»¥çš„æœ¬å¿ƒï¼Œåªæ›´æ–°å¯¹å¤§å®¶æœ‰ç”¨çš„æ¨æ–‡ã€‚" data-id="MzI4MjY5ODI1Nw==" data-is_biz_ban="0"></mp-common-profile></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LwFv0cy9LbqQdSuLevnZ8w",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
