---
title: "MEGAHIT宏基因组组装流程及结果简析"
date: 2025-09-21T01:28:23Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
MEGAHIT宏基因组组装流程及结果简析 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">本来还想着开学之前可以整理完宏基因组分析流程呢，结果还是高估了我的勤奋以及低估了我的磨叽，果然立下flag就会倒，那就还是啥时候整理完就算啥时候叭！</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">上周已经完成开学报道——<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247496110&amp;idx=1&amp;sn=c26896211f40205efb995cfdbb468996&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">开学啦开学啦！欢迎新同学！</a>，这周要开始上课咯，准备课余时间好好学习宏基因组以及看文献！宿舍的工位也浅浅布置了一下，就差一个小灯了！</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdFe4tCRdiaDZiaPlQXE3MOgYSoaicpLJtJiaestJ94jN2zc4S7LhRHAoyWw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.75" data-type="jpeg" data-w="1080" data-imgfileid="100012467" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdFe4tCRdiaDZiaPlQXE3MOgYSoaicpLJtJiaestJ94jN2zc4S7LhRHAoyWw/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">上期简单介绍了一下<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247496064&amp;idx=1&amp;sn=17817a0ef5c18c6133a71ade4a94f29c&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">宏基因组组装必备软件清单</a>，接下来就要一一了解一下不同软件的使用及代码和结果了，那首先就学习MEGAHIT 宏基因组组装流程。</span></strong></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">🧩 MEGAHIT简介</span></span><span></span></h3><blockquote><span></span><p><span leaf="">Github介绍链接：https://github.com/voutcn/megahit</span></p></blockquote><blockquote><span></span><p><span leaf="">MEGAHIT 是一款超快速且内存高效的 NGS 组装软件。它针对宏基因组进行了优化，但也适用于通用单基因组组装（小型或哺乳动物规模）和单细胞组装。</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdXBZ1EWbwiaJbaxtAhHBFyicEotvCfpPCd30wbxRXMo6QcSDoeRWa6lPg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6796296296296296" data-type="png" data-w="1080" data-imgfileid="100012465" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdXBZ1EWbwiaJbaxtAhHBFyicEotvCfpPCd30wbxRXMo6QcSDoeRWa6lPg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">功能</span></strong><span leaf="">：用于将宏基因组测序reads进行</span><strong><span leaf="">de novo组装</span></strong><span leaf="">，构建contigs。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">特点</span></strong><span leaf="">：</span></p><ul><li><section><span leaf="">基于de Bruijn图算法，适合处理</span><strong><span leaf="">复杂、高多样性</span></strong><span leaf="">的宏基因组数据。</span></section></li><li><section><span leaf="">支持</span><strong><span leaf="">双端/单端/混合</span></strong><span leaf="">reads输入。</span></section></li><li><section><span leaf="">提供多种预设参数（如</span><code><span leaf="">meta-large</span></code><span leaf="">、</span><code><span leaf="">meta-sensitive</span></code><span leaf="">）以适应不同数据类型。</span></section></li></ul><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">组装代码及结果理解</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">整体分析流程概览：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdxPOOxUQeqoiapkTUzuUSvPA8oNL8dlgP8AorABSvUwk2B4HWKmObdZw/640?wx_fmt=png&amp;from=appmsg" data-ratio="3.3365384615384617" data-type="png" data-w="416" data-imgfileid="100012464" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdxPOOxUQeqoiapkTUzuUSvPA8oNL8dlgP8AorABSvUwk2B4HWKmObdZw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">宏基因组分析更多详细的内容，沈老师</span><strong><span leaf="">整理了详细的代码分享在了gitee上面，感兴趣的朋友可以关注一下hhh</span></strong></p><blockquote><span></span><p><span leaf="">https://gitee.com/shen_qingchun/veterinary_metagenome</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdhpyBbIibLiaFdSeD1WXIv7o6vYgaiaiaEhdtoyM2nM0DObqzC8wHHAJRFw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5518518518518518" data-type="png" data-w="1080" data-imgfileid="100012466" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdhpyBbIibLiaFdSeD1WXIv7o6vYgaiaiaEhdtoyM2nM0DObqzC8wHHAJRFw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">1. 创建输出目录</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">mkdir temp/megahit</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdIwcEqwV4Y143wTTRbJ8jyaRL0QQQzjccwGqKqzEiae7eb06iazJZFE8w/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.035928143712575" data-type="png" data-w="334" data-imgfileid="100012463" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdIwcEqwV4Y143wTTRbJ8jyaRL0QQQzjccwGqKqzEiae7eb06iazJZFE8w/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">首先创建一个临时目录 </span><code><span leaf="">temp/megahit</span></code><span leaf="">，用于存放 MEGAHIT 的组装结果。</span></p><p data-tool="mdnice编辑器"><span leaf="">MEGAHIT 默认不会自动创建输出目录，若目录不存在会报错。因此提前创建是必要的。</span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">2. 单个样品测试运行</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">先跑一个样品（</span><code><span leaf="">Hebei_sheep_lungD</span></code><span leaf="">）作为测试，验证流程是否流畅。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">id=Hebei_sheep_lungD</span><span leaf=""><br></span><span leaf="">megahit -t 8 \</span><span leaf=""><br></span><span leaf="">-1  hostsq_rm//</span><span><span leaf="">${id}</span></span><span leaf="">_1.fastq \</span><span leaf=""><br></span><span leaf="">-2  hostsq_rm//</span><span><span leaf="">${id}</span></span><span leaf="">_2.fastq \</span><span leaf=""><br></span><span leaf="">-o temp/megahit/</span><span><span leaf="">${id}</span></span><span leaf="">mega</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><strong><span leaf="">参数解释</span></strong><span leaf="">：</span></p><ul><li><section><code><span leaf="">-t 8</span></code><span leaf="">：使用 8 个线程。</span></section></li><li><section><code><span leaf="">-1</span></code><span leaf=""> 和 </span><code><span leaf="">-2</span></code><span leaf="">：双端测序数据（已去宿主）。</span></section></li><li><section><code><span leaf="">-o</span></code><span leaf="">：输出目录命名为 </span><code><span leaf="">${id}mega</span></code><span leaf="">，即 </span><code><span leaf="">Hebei_sheep_lungDmega</span></code><span leaf="">。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdv35ztYa5RzV8zXEpnKflpZKT6AAd3QTFXxNu5CjTOicQiaPc9lvTJLKg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4030054644808743" data-type="png" data-w="732" data-imgfileid="100012470" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdv35ztYa5RzV8zXEpnKflpZKT6AAd3QTFXxNu5CjTOicQiaPc9lvTJLKg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">因为流程中使用的是测试数据，所以测序数据都比较小，组装得到的结果也会比较小一些。</span></p><section data-tool="mdnice编辑器"><table><thead><tr><th><section><span leaf="">文件名</span></section></th><th><section><span leaf="">大小</span></section></th><th><section><span leaf="">作用说明</span></section></th></tr></thead><tbody><tr><td><strong><span leaf="">final.contigs.fa</span></strong></td><td><strong><span leaf="">256.9 KB</span></strong></td><td><section><span leaf="">✅ </span><strong><span leaf="">最重要的结果文件</span></strong><span leaf="">：组装得到的所有 contigs（重叠群），FASTA 格式，后续分析（基因预测、注释、分箱）都靠它。</span></section></td></tr><tr><td><strong><span leaf="">log</span></strong></td><td><section><span leaf="">129.5 KB</span></section></td><td><section><span leaf="">组装过程的详细日志，包括内存使用、k-mer 分布、每一步耗时等，</span><strong><span leaf="">调参或排错时必须查看</span></strong><span leaf="">。</span></section></td></tr><tr><td><strong><span leaf="">options.json</span></strong></td><td><section><span leaf="">978 B</span></section></td><td><section><span leaf="">记录你运行 MEGAHIT 时的所有参数（k-mer 范围、线程数、输入文件等），</span><strong><span leaf="">可重复性保障</span></strong><span leaf="">。</span></section></td></tr><tr><td><strong><span leaf="">checkpoints.txt</span></strong></td><td><section><span leaf="">262 B</span></section></td><td><section><span leaf="">记录组装过程中哪些步骤已完成，</span><strong><span leaf="">断点续跑</span></strong><span leaf="">用得上（MEGAHIT 支持断点续跑）。</span></section></td></tr><tr><td><strong><span leaf="">done</span></strong></td><td><section><span leaf="">0 B</span></section></td><td><section><span leaf="">空文件，</span><strong><span leaf="">标志组装成功完成</span></strong><span leaf="">。如果它存在，说明 MEGAHIT 正常结束。</span></section></td></tr></tbody></table></section><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPd0icm4ibUFzgORF3KgAtVRI2JaotOANuCWe6DABWHL5F0rMiaIsEwF7oHg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.41944444444444445" data-type="png" data-w="1080" data-imgfileid="100012472" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPd0icm4ibUFzgORF3KgAtVRI2JaotOANuCWe6DABWHL5F0rMiaIsEwF7oHg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">3. 批量处理所有样品</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">测试完分析代码没问题之后，就可以对全部的测试样品循环进行分析，从之前整理好的</span><code><span leaf="">metadata.txt</span></code><span leaf=""> 中逐行读取样品 ID，循环运行 MEGAHIT。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdr2MEIvVvibMYUp6dpFRgYPTxUPRgvmWbnYj39SppDaMC7umA7LibY5wg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4976671850699845" data-type="png" data-w="643" data-imgfileid="100012469" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdr2MEIvVvibMYUp6dpFRgYPTxUPRgvmWbnYj39SppDaMC7umA7LibY5wg/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cat metadata.txt | </span><span><span leaf="">while</span></span><span leaf=""> </span><span><span leaf="">read</span></span><span leaf=""> id ; </span><span><span leaf="">do</span></span><span leaf=""> time megahit -t 8 \</span><span leaf=""><br></span><span leaf="">-1  hostsq_rm//</span><span><span leaf="">${id}</span></span><span leaf="">_1.fastq \</span><span leaf=""><br></span><span leaf="">-2  hostsq_rm//</span><span><span leaf="">${id}</span></span><span leaf="">_2.fastq \</span><span leaf=""><br></span><span leaf="">-o temp/megahit/</span><span><span leaf="">${id}</span></span><span leaf="">mega/; \</span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">会依次对四个测试数据进行组装，分别得到其组装好的结果保存在文件夹里面！</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPd0eDSmkaBYRMWhQYmRWRoYGftQUia3wOLjoytKtOUuI4K17IZgrWnqXg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5096774193548387" data-type="png" data-w="310" data-imgfileid="100012468" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPd0eDSmkaBYRMWhQYmRWRoYGftQUia3wOLjoytKtOUuI4K17IZgrWnqXg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">4. 统计组装结果</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">使用 </span><code><span leaf="">seqkit stat</span></code><span leaf=""> 统计所有样品的 </span><code><span leaf="">final.contigs.fa</span></code><span leaf=""> 文件，输出每个文件的序列数、总碱基数、N50 等关键指标。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cp /home/rcgh/train/trains/seqkit ./</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">./seqkit </span><span><span leaf="">stat</span></span><span leaf=""> temp/megahit/*/final.contigs.fa &gt; megahit_results.txt</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">cat megahit_results.txt</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">因为测试文件比较小，所以得到的结果数据会比较小，实际分析过程中得到的结果数据应该大些。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdsxBAspRx9lOWkM4tKmlCuXpeok2h2DlO1Ommvhu6RLJdibfwbAZoM9A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.13240740740740742" data-type="png" data-w="1080" data-imgfileid="100012471" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdsxBAspRx9lOWkM4tKmlCuXpeok2h2DlO1Ommvhu6RLJdibfwbAZoM9A/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">5. 预览 contigs 文件</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">查看组装结果文件的前 6 行（通常是前 3 条 contig 的 FASTA 格式），并截取前 60 个字符，确认格式正确。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">head -n6 temp/megahit/Hebei_sheep_lungDmega/final.contigs.fa | cut -c1-60</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdEfqELKRdZTjbc3lY9Iq1uGDH7TjFCWW31YuVN7NcQIOdNJpVJNn5gw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2361111111111111" data-type="png" data-w="1080" data-imgfileid="100012477" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdEfqELKRdZTjbc3lY9Iq1uGDH7TjFCWW31YuVN7NcQIOdNJpVJNn5gw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">6. 备份重要结果</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">将每个样品的最终 contigs 文件复制到 </span><code><span leaf="">result/megahit/</span></code><span leaf=""> 目录下，统一归档，便于后续分析（如基因预测、注释等）。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">mkdir -p result/megahit/</span><span leaf=""><br></span><span leaf="">cat metadata.txt | </span><span><span leaf="">while</span></span><span leaf=""> </span><span><span leaf="">read</span></span><span leaf=""> id ; </span><span><span leaf="">do</span></span><span leaf=""><br></span><span leaf="">  cp temp/megahit/</span><span><span leaf="">${id}</span></span><span leaf="">mega/final.contigs.fa result/megahit/</span><span><span leaf="">${id}</span></span><span leaf="">_final.contigs.fa</span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdNlrc7SXxTfulvywBhBQc33Kdiau9hjm2URn52Oz3ibxo2BBY39VibibObA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4628975265017668" data-type="png" data-w="566" data-imgfileid="100012476" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YHMTH0V6gCRJETkibxX2fPdNlrc7SXxTfulvywBhBQc33Kdiau9hjm2URn52Oz3ibxo2BBY39VibibObA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">清理中间文件（可选）</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">删除 MEGAHIT 中间过程文件（如 </span><code><span leaf="">intermediate_contigs</span></code><span leaf=""> 目录），节省磁盘空间。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cat metadata.txt | </span><span><span leaf="">while</span></span><span leaf=""> </span><span><span leaf="">read</span></span><span leaf=""> id ; </span><span><span leaf="">do</span></span><span leaf=""><br></span><span leaf="">  /bin/rm -rf temp/megahit/</span><span><span leaf="">${id}</span></span><span leaf="">mega/intermediate_contigs</span><span leaf=""><br></span><span><span leaf="">done</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">正经结尾</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">下期准备学习</span><strong><span leaf="">metaSPAdes精细组装</span></strong><span leaf="">，之前使用SPAdes组装了一下布鲁氏菌的数据，正好可以对比看看流程有没有不一样！</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/cqRuU6Qwr0RWBc20eyqhCw",target="_blank" rel="noopener noreferrer">原文链接</a>
