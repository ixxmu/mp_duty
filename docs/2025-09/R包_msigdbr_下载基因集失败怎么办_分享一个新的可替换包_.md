---
title: "R包 msigdbr 下载基因集失败怎么办：分享一个新的可替换包！"
date: 2025-09-03T16:41:54Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
R包 msigdbr 下载基因集失败怎么办：分享一个新的可替换包！ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">最近我们生信入门班的学员总是遇到同样的下面的报错：msigdbr 下载基因集出现错误，链接失效啦！</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQCghUAsYMcp3kyjgaSMvtVMyYTEtibpfPgxvialTI8Sick39vzV7g2y7hA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.16797642436149313" data-type="png" data-w="1018" data-imgfileid="100061852" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQCghUAsYMcp3kyjgaSMvtVMyYTEtibpfPgxvialTI8Sick39vzV7g2y7hA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">现在我们给大家分享两个思路~</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">第一个方法：使用我新发的超好用的R包 GSEAtopics</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">业内大佬顾祖光的一个包 GSEAtopics， 使用方法如下：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(devtools)</span><span leaf=""><br></span><span leaf="">install_github(</span><span><span leaf="">"jokergoo/GSEAtopics"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#### MSigDB</span></span><span leaf=""><br></span><span leaf="">library(GSEAtopics)</span><span leaf=""><br></span><span leaf="">list_msigdb_versions()</span><span leaf=""><br></span><span leaf="">list_msigdb_collections(</span><span><span leaf="">"2025.1.Hs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">list_msigdb_collections(</span><span><span leaf="">"2025.1.Mm"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">lt = get_msigdb(version = </span><span><span leaf="">"2025.1.Mm"</span></span><span leaf="">, collection = </span><span><span leaf="">"mh.all"</span></span><span leaf="">, gene_id_type = c(</span><span><span leaf="">"symbols"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">lt[1:2]</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wybiby1cYHOUKPyG600kTStfaoibcNgxhjsw76sTUwVjZ3nlBiaWXrTh7WicU4lO24ZMhMa9ibCvJdflew/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=7" alt="图片" data-ratio="0.24351851851851852" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wybiby1cYHOUKPyG600kTStfaoibcNgxhjsw76sTUwVjZ3nlBiaWXrTh7WicU4lO24ZMhMa9ibCvJdflew/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1#imgIndex=7"></span><figcaption><span leaf="">图片</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">这个方法在帖子中有更多详细的介绍：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543660&amp;idx=1&amp;sn=2b383cec1bf23edc1b2afbdbad20f321&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">一个关于基因集富集分析的全面介绍</a></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">第二个方法：直接去GSEA官网下载</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">GSEA官网在2025年进行了一次超大更新，同时添加了小鼠的基因集：https://www.gsea-msigdb.org/</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQoicfAB90LoRCaUxwCQKb7RtydWROONc7OBnvjdPZ73WUMSuaicXQWWcg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.3777777777777778" data-type="png" data-w="1080" data-imgfileid="100061853" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQoicfAB90LoRCaUxwCQKb7RtydWROONc7OBnvjdPZ73WUMSuaicXQWWcg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">去 MsigDB 数据库下载所有通路的gmt文件：msigdb.v2024.1.Hs.symbols.gmt，只有20几M，很快就下载完了！</span></p><p data-tool="mdnice编辑器"><span leaf="">https://www.gsea-msigdb.org/gsea/msigdb/collections.jsp</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQaTHSxUibNPRjYPbjbiang9C5CIMU3szYmwT9gNysHRbVE96UeYXOGibWA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.31966224366706875" data-type="png" data-w="829" data-imgfileid="100061851" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQaTHSxUibNPRjYPbjbiang9C5CIMU3szYmwT9gNysHRbVE96UeYXOGibWA/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">library(clusterProfiler)</span><span leaf=""><br></span><span leaf="">library(org.Hs.eg.db)</span><span leaf=""><br></span><span leaf="">library(GSEABase)</span><span leaf=""><br></span><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">library(tidyverse)</span><span leaf=""><br></span><span><span leaf="">#</span></span><span leaf=""><br></span><span><span leaf=""># 所有通路读取方法</span></span><span leaf=""><br></span><span leaf="">geneset &lt;- read.gmt(</span><span><span leaf="">"msigdb.v2024.1.Hs.symbols.gmt"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">geneset_EPCAM &lt;- geneset[geneset</span><span><span leaf="">$gene</span></span><span leaf=""> == </span><span><span leaf="">"EPCAM"</span></span><span leaf="">,]</span><span leaf=""><br></span><span leaf="">head(geneset_EPCAM)</span><span leaf=""><br></span><span leaf="">dim(geneset_EPCAM)</span><span leaf=""><br></span><span leaf="">str(geneset_EPCAM)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">当然也可以下载单个数据库的通路，然后读取进去：</span></p><p data-tool="mdnice编辑器"><span leaf="">https://www.gsea-msigdb.org/gsea/msigdb/human/collections.jsp</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQuN7PkCDeyPvVOspAa7mYXy2iaQujwvXotuS0YsXEjCJI5ia82Pf26pCg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.363888888888889" data-type="png" data-w="1080" data-imgfileid="100061854" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzt3lIZosYnwBwEQ5W3owtQuN7PkCDeyPvVOspAa7mYXy2iaQujwvXotuS0YsXEjCJI5ia82Pf26pCg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">是不是超简单！</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">如果上面的代码学习对你来说有困难，可以看看下面的链接！</span></p></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247545329&amp;idx=1&amp;sn=71930835b79306606c59d7aa8c632490&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课9月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课9月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/8EDoIGefjwslWWX4w0nSdQ",target="_blank" rel="noopener noreferrer">原文链接</a>
