---
title: "文章发表：aplot让你轻松画出复杂的图"
date: 2025-09-01T02:27:56Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
文章发表：aplot让你轻松画出复杂的图 by YuLabSMU
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">aplot发表</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">aplot包<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MzcyMDU1NQ==&amp;mid=2247819444&amp;idx=1&amp;sn=4a9aad349a7ff3d811e35f50a98d6f9d&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">发表在The Innovation期刊</a>上。</span></p><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI0MzcyMDU1NQ==&amp;mid=2247819444&amp;idx=1&amp;sn=4a9aad349a7ff3d811e35f50a98d6f9d&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTPJxHpf0XeFfdRA4JL6fWN7xHBicuXu8aSKEMEp2NonEJuiaIiaWqBODJg/640?wx_fmt=png&amp;from=appmsg" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTPJxHpf0XeFfdRA4JL6fWN7xHBicuXu8aSKEMEp2NonEJuiaIiaWqBODJg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.29907407407407405" data-type="png" data-w="1080" data-backw="558" data-backh="167" data-imgfileid="100013811" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTPJxHpf0XeFfdRA4JL6fWN7xHBicuXu8aSKEMEp2NonEJuiaIiaWqBODJg/640?wx_fmt=png&amp;from=appmsg"></span></a></figure><p data-tool="mdnice编辑器"><span leaf="">开发这个包的灵感来自于我在<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247486677&amp;idx=1&amp;sn=c9af4ab4642db5e7f3eff04f392be17d&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">2018年发的MBE文章</a>。</span></p><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247486677&amp;idx=1&amp;sn=c9af4ab4642db5e7f3eff04f392be17d&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTicicQIO8xb0nxkyr5z6gibYg3dl2cnjm7FbicEiagMaVfavpM3KVSiaTBpLw/640?wx_fmt=png&amp;from=appmsg" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTicicQIO8xb0nxkyr5z6gibYg3dl2cnjm7FbicEiagMaVfavpM3KVSiaTBpLw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5592592592592592" data-type="png" data-w="1080" data-backw="558" data-backh="312" data-imgfileid="100013813" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTicicQIO8xb0nxkyr5z6gibYg3dl2cnjm7FbicEiagMaVfavpM3KVSiaTBpLw/640?wx_fmt=png&amp;from=appmsg"></span></a></figure><p data-tool="mdnice编辑器"><span leaf="">可以说这是对数据整合和可视化长期思考所得，进行高度抽象才提出这两个方法，而这两个方法，分别激发了我开发出来<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247489236&amp;idx=1&amp;sn=d03a6f74aed1ddc85483b364b6e1da5d&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">aplot</a>和<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247497224&amp;idx=1&amp;sn=1180d26acd5a15b014a750266de96f5e&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">ggtangle</a>两个包。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复杂图不再复杂</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">aplot作为一个拼图包，和大家所熟知的拼图包cowplot和patchwork是不一样的。不是把图放在一起，而是把图中的数据进行关联，就像文章图2所展示，你画几个图，无需考虑数据间的关系，每个图画起来都比较简单，但是你一旦用aplot的</span><code><span leaf="">insert_top</span></code><span leaf="">、</span><code><span leaf="">insert_bottom</span></code><span leaf="">、</span><code><span leaf="">insert_left</span></code><span leaf="">和</span><code><span leaf="">insert_right</span></code><span leaf="">系列函数进行拼图，这些函数会试图去把数据给关联起来，对每个小图的内容进行重新排列，以使得图与图之间信息是对应的。最终出来底下G图这样复杂的图，如果要手搓这个图，难度很大，用aplot，很简单。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTXFEr1CSfjzYs7BX7xwFZ0XmL0yzZXibd4uWU9TwU3es1Ft8nAmobZ1Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9833333333333333" data-type="png" data-w="1080" data-backw="558" data-backh="549" data-imgfileid="100013815" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTXFEr1CSfjzYs7BX7xwFZ0XmL0yzZXibd4uWU9TwU3es1Ft8nAmobZ1Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这个包的重点，就是这个功能，是我<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247489567&amp;idx=1&amp;sn=4510e1e05cfab5f302675b1b5b1febea&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">开发它的初衷</a>。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">你也能创作复杂图</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">能够拼的图种类是比较多的：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT3sECzVro2nT9XpF86Cf8d4D9ZLJCTPjg8y1QqdMdODlgFITGfgocXQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9453703703703704" data-type="png" data-w="1080" data-backw="558" data-backh="528" data-imgfileid="100013814" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT3sECzVro2nT9XpF86Cf8d4D9ZLJCTPjg8y1QqdMdODlgFITGfgocXQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">当然你也可以自己创作一些，因为怎么拼随便你嘛。比如前面图2的单细胞marker基因表达热图，我就拼了通路富集分析结果。比如这里的A图中，oncoplot就被拿来再拼TCGA中相应基因在两个肿瘤中表达量分布。再比如E图，upsetplot我们可以用aplot拼出来，但既然是拼的，我干嘛不拼点别的呢？于是我们就搞了这个不一样的upsetplot。世界的大门一下就打开了。</span></p><p data-tool="mdnice编辑器"><span leaf="">说到oncoplot，是由一个学生李申锁贡献的代码，详见《<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247493033&amp;idx=1&amp;sn=12e81d8324be0dc1c041a1b14daf25b8&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">ggplot2版本的oncoplot来了</a>》，在我面前露一手，然后跟我说要申请博士，但由于我没有名额，然后也就没有然后了。虽然接触时间短，也过了比较长一段时间，但贡献我是不会忘记的。顺道说一下，露一手是想<span textstyle="">读研读博做博后的正确打开方式</span>，太有说服力了。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTFiauTmMibPS2LYGb5LhxyZMDQSbDcibZibHaZpxPfsj6UYLOFe7vaGSAKg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4133971291866029" data-type="png" data-w="1045" data-backw="558" data-backh="231" data-imgfileid="100013817" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTFiauTmMibPS2LYGb5LhxyZMDQSbDcibZibHaZpxPfsj6UYLOFe7vaGSAKg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">普通的拼图</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">aplot另外的功能是</span><code><span leaf="">plot_list()</span></code><span leaf="">，就是普通的拼图的，图不会变，只是简单地组合起来放在一起。虽然patchwork包做得很好，但老狗学不了新把戏，早期用惯了</span><code><span leaf="">cowplot::plot_grid</span></code><span leaf="">，我就想来一个类似的，当然也不完全一样，我还是有我自己的一点东西在里面。</span></p><ol><li><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491115&amp;idx=1&amp;sn=3f18a40e76e9617bfcfd90ac97a53083&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">啥都能拼</a>：base plot、ggplot2、图片等。</span></p></section></li><li><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492956&amp;idx=1&amp;sn=aa6c7679ce64e6f3463d3b8b7d517918&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">万物皆可分面</a>：这些拼在一起的图，只要你给个名字，就会变成像分面的label一样，在出图时呈现。</span></p></section></li><li><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491495&amp;idx=1&amp;sn=51b1e8fec992d1170fc46c8f27d52736&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">保持YuLab团队的五毛效果</a>：我们开发一些包，比如说ggbreak，它所呈现的效果，你用其它的拼图工具，可能就不兼容了，但我们自己，自成一统。配合得舒舒服服的。</span></p></section></li></ol><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491115&amp;idx=1&amp;sn=3f18a40e76e9617bfcfd90ac97a53083&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTkrSDkUekm1deMp6kWMGwqQwpTKqdGwyDEAoT7y5Ch5SibDC0s2qByUA/640?wx_fmt=jpeg&amp;from=appmsg" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTkrSDkUekm1deMp6kWMGwqQwpTKqdGwyDEAoT7y5Ch5SibDC0s2qByUA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5175" data-type="jpeg" data-w="800" data-backw="538" data-backh="278" data-imgfileid="100013824" src="https://mmbiz.qpic.cn/mmbiz_jpg/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTkrSDkUekm1deMp6kWMGwqQwpTKqdGwyDEAoT7y5Ch5SibDC0s2qByUA/640?wx_fmt=jpeg&amp;from=appmsg"></span></a></figure><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247492956&amp;idx=1&amp;sn=aa6c7679ce64e6f3463d3b8b7d517918&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT769A5SPcjcqT8lGR3kawibPzKkY30uke08jrEVNG8md5cmFasEwVicUg/640?wx_fmt=png&amp;from=appmsg" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT769A5SPcjcqT8lGR3kawibPzKkY30uke08jrEVNG8md5cmFasEwVicUg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8859649122807017" data-type="png" data-w="684" data-backw="538" data-backh="477" data-imgfileid="100013825" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT769A5SPcjcqT8lGR3kawibPzKkY30uke08jrEVNG8md5cmFasEwVicUg/640?wx_fmt=png&amp;from=appmsg"></span></a></figure><figure data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247491495&amp;idx=1&amp;sn=51b1e8fec992d1170fc46c8f27d52736&amp;poc_token=HLZ8d2ijwRkTWPjhJtN8Bseltxhov8bngGX3vju4&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTnQEzZRhXT6DL3pLFdM1qyQeyHwfAA5d5PAktQzNH6f6hftLgpemNfg/640?wx_fmt=png&amp;from=appmsg" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTnQEzZRhXT6DL3pLFdM1qyQeyHwfAA5d5PAktQzNH6f6hftLgpemNfg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7077114427860697" data-type="png" data-w="804" data-backw="538" data-backh="381" data-imgfileid="100013826" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTnQEzZRhXT6DL3pLFdM1qyQeyHwfAA5d5PAktQzNH6f6hftLgpemNfg/640?wx_fmt=png&amp;from=appmsg"></span></a></figure><p><span leaf=""><br></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">GA图创作</span></span><span></span></h2><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTNUVKcgNrAxEmYaIia7tnEGXFPosngTooUBkianHC7cZiayhzkmgSc57pQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8324074074074074" data-type="png" data-w="1080" data-backw="558" data-backh="464" data-imgfileid="100013819" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nTNUVKcgNrAxEmYaIia7tnEGXFPosngTooUBkianHC7cZiayhzkmgSc57pQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">一开始画了一版，呈现4个函数的功能，我觉得（1）和图一太重复；（2）这4个函数是可以自由组合，反复使用的，这点体现不出来。所以我提了意见，用一条彩带，后面虚化，代表 </span><strong><span leaf="">未完待续</span></strong><span leaf=""> ，还能继续调用这些函数 </span><strong><span leaf="">。</span></strong><span leaf=""> 然后可以把aplot拟人化，成为舞动彩带者。至于上面拼图的元素，我的想法是哆啦A梦的口袋，后面双斌提出来说感觉口袋是aplot这个人的，考虑换成云朵☁。一开始设计师就在云上面平铺了几个图，我觉得不行，跟设计师说，想想天兵天将要捉拿孙悟空的场景，图要堆不同的层，后面可以虚化一些，体现人多势众的感觉。就这样出来我们这张GA图。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">我是第一人</span></span><span></span></h2><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT1uVRr46Zs1YdaAibReYK6ndt6CntEuXFcOhNgBLlRoHoKtky0O6dHcA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5111111111111111" data-type="png" data-w="1080" data-backw="558" data-backh="285" data-imgfileid="100013818" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRdzdJC4licXQwusnbru2nT1uVRr46Zs1YdaAibReYK6ndt6CntEuXFcOhNgBLlRoHoKtky0O6dHcA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">aplot的灵感来自于2018年我的文章，在ggtree中孕育了好几年。然后我在2020年就开发出来并放出到CRAN上。解决我前面小标题写的 </span><strong><span leaf="">复杂图不再复杂</span></strong><span leaf=""> 这个问题，aplot必须是第一个工具。现在有类似的工具，包括python的<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247495792&amp;idx=1&amp;sn=40412fb98c96e5698b6356beeee9ca08&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Marsilea</a>和R的ggalign。第一个是最难的，因为你要产生想法，要在没有任何借鉴的情况下去实现。现在aplot的功能可能不是最全的，但aplot肯定是最容易用的，能解决你大多数的问题。</span></p><section nodeleaf=""><img data-imgfileid="100013934" data-ratio="0.7796296296296297" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kRDL6vO7WW9mELLh64buPXAI45DI9OmhyxPC8mUDicHhNiao02CgicAZibcoPXayxJvAicOiaJAUSwibYLw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4kRDL6vO7WW9mELLh64buPXAI45DI9OmhyxPC8mUDicHhNiao02CgicAZibcoPXayxJvAicOiaJAUSwibYLw/640?wx_fmt=png&amp;from=appmsg"></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rOjUWbKcZXYGprqRfOhtjw",target="_blank" rel="noopener noreferrer">原文链接</a>
