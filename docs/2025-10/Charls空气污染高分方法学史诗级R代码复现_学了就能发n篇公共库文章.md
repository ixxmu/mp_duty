---
title: "Charlsç©ºæ°”æ±¡æŸ“é«˜åˆ†æ–¹æ³•å­¦å²è¯—çº§Rä»£ç å¤ç°ï¼Œå­¦äº†å°±èƒ½å‘nç¯‡å…¬å…±åº“æ–‡ç« "
date: 2025-10-08T23:45:14Z
draft: ["false"]
tags: [
  "fetched",
  "å®æˆ˜åŒ»å­¦ç»Ÿè®¡"
]
categories: ["Acdemic"]
---
Charlsç©ºæ°”æ±¡æŸ“é«˜åˆ†æ–¹æ³•å­¦å²è¯—çº§Rä»£ç å¤ç°ï¼Œå­¦äº†å°±èƒ½å‘nç¯‡å…¬å…±åº“æ–‡ç«  by å®æˆ˜åŒ»å­¦ç»Ÿè®¡
------
<div><p data-mpa-powered-by="yiban.io"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/Zb9jB9p1cKG8hm4AQmFw4MEhbUWroVODb7BBtbH7G3Ihib23GYEDa2ibMQd3rpWv1ExCzibpVnPFLzibhicuCbIibIAg/640?wx_fmt=jpeg&amp;watermark=1#imgIndex=0" data-ratio="0.29444444444444445" data-s="300,640" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/Zb9jB9p1cKG8hm4AQmFw4MEhbUWroVODb7BBtbH7G3Ihib23GYEDa2ibMQd3rpWv1ExCzibpVnPFLzibhicuCbIibIAg/640?wx_fmt=jpeg&amp;watermark=1#imgIndex=0"></span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Zb9jB9p1cKGAAa124Ik6SAg6kXjw7NOVereYZ0SoyJa0RoibDPOfiapQlgyrSsK4FKt6qic66cicwoJDyQbB4ZkWrg/640?wx_fmt=gif#imgIndex=1" data-ratio="0.2777777777777778" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/Zb9jB9p1cKGAAa124Ik6SAg6kXjw7NOVereYZ0SoyJa0RoibDPOfiapQlgyrSsK4FKt6qic66cicwoJDyQbB4ZkWrg/640?wx_fmt=gif#imgIndex=1"></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¯å¢ƒé¢†åŸŸäº¤å‰ä¸´åºŠæµè¡Œç—…å­¦æ•°æ®ï¼Œå¾€å¾€è”åˆå°±å¯ä»¥å‘é«˜åˆ†SCIç¯å¢ƒç±»æ‚å¿—ï¼ŒIFåˆ†æ•°ç»å¸¸&gt;10åˆ†ã€‚å¯ä»¥è¯´æ‹¿ç€ä½ æ‰‹ä¸­çš„å¤šä¸­å¿ƒæ¨ªæ–­é¢ã€çºµå‘é˜Ÿåˆ—æ•°æ®å°±å¯ä»¥è„‘æ´å¤§å¼€ï¼Œé“¾æ¥ä»»æ„ç©ºæ°”æ±¡æŸ“å‰ç«¯æ•°æ®ï¼Œåˆ†æåç«¯ç»“å±€çš„å…³è”å…³ç³»ã€‚Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">PM2.5ã€PM1ã€O3ç­‰ç­‰ç¯å¢ƒæ•°æ®ï¼Œæ˜¯ä¸€ä¸ªå®è§‚ä¸‡ç‰©äº’è”æŒ‡æ ‡å¯ä»¥ä¸‡èƒ½è¿æ¥ä»»æ„ç–¾ç—…å’Œç»“å±€ï¼Œæ ·æœ¬é‡è¶³å¤Ÿå¤§çš„æ•°æ®é›†å°±å¯ä»¥å¹²ï¼æœ¬æ–‡æ˜¯å›½åº†æœŸé—´æ·±åº¦å†™ä½œçš„æ–‡ç« ï¼Œç»†èŠ‚è¶…å¤šï¼Œå†…å®¹æå…¶è¯¦ç»†ï¼Œå¹²è´§æ»¡æ»¡çš„ï¼Œå–œæ¬¢å°±å¤šå¤šè½¬å‘ç‚¹ä¸ªèµå“¦ã€‚Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ¬æ–‡å†…å®¹è¶…é•¿ï¼Œæƒ³è·Ÿç€æˆ‘å­¦ç¡¬æ ¸çš„æŠ€æœ¯å¯ä»¥å…³æ³¨å³å°†é—ªäº®ç™»åœºçš„è¶…é«˜æ€§ä»·æ¯”Bæ¬¾è¯¾ç¨‹å“¦ã€‚<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxNTUzNDMyNQ==&amp;mid=2650960664&amp;idx=1&amp;sn=0451853a669fbacdc679409e13b752c2&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">çˆ†æ¬¾ï¼AI+RCT+çœŸå®ä¸–ç•Œ+å› æœæœºå™¨å­¦ä¹ +äº¤å‰å­¦ç§‘+çºµå‘æ•°æ®ï¼Œ150å°æ—¶</a></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJpqCOia9GwYXwWzZqKdRPQ4pbIIg4wwAyJAE8cjl19FAqiamLaSgfF1UA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5518518518518518" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477146" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJpqCOia9GwYXwWzZqKdRPQ4pbIIg4wwAyJAE8cjl19FAqiamLaSgfF1UA/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJGQ48yzN3pqtwznOfWPuTgAg8NBRN9n3vFH1pu2hJZQy0ERuzjSt98g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5361111111111111" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477147" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJGQ48yzN3pqtwznOfWPuTgAg8NBRN9n3vFH1pu2hJZQy0ERuzjSt98g/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸€ã€PM2.5ç³»åˆ—ç¯å¢ƒæ•°æ®</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ›¾å‡ ä½•æ—¶ï¼ŒPMæ•°æ®è¢«ç¯å¢ƒä¸“ä¸šçš„äººå£«è§†è‹¥çå®ä¸è‚¯è½»æ˜“åˆ†äº«ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä»–ä»¬åƒé¥­çš„å®¶ä¼™ã€‚æˆ‘ä¹Ÿæ›¾ç»åœ¨78å¹´å‰é—®è¿‡å¾ˆå¤šä»ä¸šè€…ï¼Œéƒ½è®³è«å¦‚æ·±ã€‚å¦‚ä»Šéšç€æ—¶ä»£å‘å±•ï¼Œå¤§å®¶å¯ä»¥ååˆ†æ–¹ä¾¿çš„æ‹¿åˆ°å¼€æºç¯å¢ƒæ•°æ®ï¼Œè¿™å¯¹æœ¬å°±æ˜¯ä¸¾æ­¥ç»´è‰°çš„ç¯å¢ƒä¸“ä¸šåˆåŠ å‰§äº†æ¶æ€§ç«äº‰ã€‚ å¼€æºæ•°æ®ä¸­ï¼ŒCHAP:Â <span textstyle="">https://weijing-rs.github.io/product.html</span>ï¼Œå°±æ˜¯ååˆ†ä¼˜ç§€çš„å¼€æºé›†ã€‚CHAP æ•°æ®é›†åŒ…å« 7 ç§ä¸»è¦ç©ºæ°”æ±¡æŸ“ç‰©ï¼ˆå³Â <span textstyle="">PM1ã€PM2.5ã€PM10ã€O3ã€NO2ã€SO2 å’Œ CO</span>ï¼‰ï¼Œ PM2.5 åŒ–å­¦æˆåˆ†ï¼ˆå³ SO42-ã€NO3-ã€NH4+ã€Cl-ã€BC å’Œ OMï¼‰ï¼Œä»¥åŠç¯å¢ƒå¤šç¯èŠ³çƒƒï¼ˆPAHsï¼‰ï¼ŒåŒ…æ‹¬ 7 ç§è‡´ç™Œ PAHsï¼ˆå³ BaAã€Chrã€BbFã€BkFã€BaPã€DahAã€IcdPï¼‰ã€‚è¯¥ CHAP æ•°æ®é›†ä¸ºå…¬å¼€ä¸”å…è´¹å‘æ‰€æœ‰ç”¨æˆ·å¼€æ”¾ï¼é™¤äº†PM1ã€åŒ–å­¦æˆåˆ†ã€PAHSç­‰æ¶‰åŠä½œè€…è¦æ‹¿æ¥å½“é€šè®¯ä½œè€…ç­¹ç çš„é«˜ç«¯æ•°æ®é›†ï¼Œå…¶ä»–ä½œè€…éƒ½å¾ˆå¤§æ–¹çš„å…¬å¼€äº†ã€‚ä¹Ÿè¶³å¤Ÿå¤§å®¶å‘ç‚¹å°åˆ†æ‚å¿—äº†ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJwvZOoBPmibv3cXCTib73iaJJcruJrUrFPmADdqBww5KT6MtFuyPl1VMzw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5462962962962963" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477148" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJwvZOoBPmibv3cXCTib73iaJJcruJrUrFPmADdqBww5KT6MtFuyPl1VMzw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJ1GJmxu1Zv4UQeQ4TVtHc8WGc7IF9jou8zaSQFOtQ0tVA00rjiaGnRAg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.525" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477150" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJ1GJmxu1Zv4UQeQ4TVtHc8WGc7IF9jou8zaSQFOtQ0tVA00rjiaGnRAg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJiaoOz7FqONgG3pOZD8zxoJHljMx68gY3XvjYWJNN6NY6gCvMibqxUqHg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5703703703703704" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477149" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJiaoOz7FqONgG3pOZD8zxoJHljMx68gY3XvjYWJNN6NY6gCvMibqxUqHg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJbUCCaPRMn3U1Q5wWicdINX8EOVbnh5icD7xgnX5kqKicPwU0CdqKIsnuQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5462962962962963" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477151" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJbUCCaPRMn3U1Q5wWicdINX8EOVbnh5icD7xgnX5kqKicPwU0CdqKIsnuQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJ4pQdznRwWBQGzmPHFGekQ7IU1Dpoic3bgk60VCgEU96jXH3iakVqr42Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5481481481481482" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477152" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJ4pQdznRwWBQGzmPHFGekQ7IU1Dpoic3bgk60VCgEU96jXH3iakVqr42Q/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJCgQExwibFNqutu2HSQ3laTLNb8xcJWyyX1NBzWk4qPMElZibNZUkqogg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5879629629629629" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477153" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJCgQExwibFNqutu2HSQ3laTLNb8xcJWyyX1NBzWk4qPMElZibNZUkqogg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">äºŒã€èŒƒæ–‡</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Pubmedæœç´¢charls+PM2.5å¯ä»¥å‘ç°è®¸å¤šæ–‡ç« ã€‚æˆ‘è¿™é‡Œä¸¾å‡ ä¸ªä¾‹å­ï¼Œå…¶ä¸­åˆ©ç”¨æˆ‘ä»¬ä¹‹å‰æä¾›çš„æ•°æ®é›†å¤ç°ä¸€ä¸‹å…¨æ–‡ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJuUjTerjsMSyDiblztn8yuibbQ9zgb862icjBdCIqjdj8E98vW1eyZdAmw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.562962962962963" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477155" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJuUjTerjsMSyDiblztn8yuibbQ9zgb862icjBdCIqjdj8E98vW1eyZdAmw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJKB2lhOu7UD3gemiclqkQOO3geGyQbKHKotVXmYayvN2zrNNUydPEYEw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5425925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477156" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJKB2lhOu7UD3gemiclqkQOO3geGyQbKHKotVXmYayvN2zrNNUydPEYEw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJN9PhJK6xMhT1EFcxcib2jjCuxsTr3MdHmkS0mmPDwCguRWMg34ItK2w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.562962962962963" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477154" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJN9PhJK6xMhT1EFcxcib2jjCuxsTr3MdHmkS0mmPDwCguRWMg34ItK2w/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Â ä¸‰ã€Rä»£ç Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">é’ˆå¯¹èŒƒæ–‡5ï¼ŒORä¸”ä»…ç”¨charls2015æ•°æ®è¾ƒä¸ºçŸ­å¹³å¿«ã€‚æˆ‘å¤ç°å…¨æ–‡å¦‚ä¸‹ã€‚ å»chapä¸Šä¸‹è½½æ•°æ®ï¼Œç›´æ¥ä¸‹è½½å¤ªå¤§ä¸€ç™¾å¤šGï¼Œåªéœ€ä¸‹Mã€Yæ•°æ®å³å¯ï¼Œä¸è¿‡åªèƒ½æ‰‹åŠ¨ä¸€ä¸ªä¸ªä¸‹ã€‚å½“ç„¶Bæ¬¾è¯¾ç¨‹éƒ½æœ‰èµ é€æ•°æ®é›†å’Œä»£ç ï¼Œè®©ä½ å¿«é€Ÿå¤ç°charlsç³»åˆ—å¤šç¯‡æ–‡ç« ã€‚Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">3.1 æ•°æ®æ•´ç†Â </span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span></h3><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJy4wy63IYkRII8bSUQWLuJKupHVBZSrujGXSsv5ehTNVFENIy3QWoYA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5435185185185185" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477159" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJy4wy63IYkRII8bSUQWLuJKupHVBZSrujGXSsv5ehTNVFENIy3QWoYA/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJuqL7y6c8ic8RuF8Y89D29XVjXsbBBRicbyXdicKBKTiczBV4QBnVTP8j1Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5370370370370371" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477161" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJuqL7y6c8ic8RuF8Y89D29XVjXsbBBRicbyXdicKBKTiczBV4QBnVTP8j1Q/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJOJib2tsGMW8aa7DBDw21lqN2sh1EQX4yJ9ibRib0X9lj9oOqC0QeYtbYw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.525" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477160" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJOJib2tsGMW8aa7DBDw21lqN2sh1EQX4yJ9ibRib0X9lj9oOqC0QeYtbYw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">3.2 SCIåŸºçº¿è¡¨ä¸çº³å…¥æ’é™¤Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æˆ‘å°è¯•å¤ç°äº†å…¨æ–‡çº³å…¥æ’é™¤ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰2000äººå·¦å³çš„å‡ºå…¥ã€‚æµç¨‹æ˜¯æ²¡å¤ªå¤§é—®é¢˜çš„ï¼ŒæŒ‰ç…§çº³å…¥æ’é™¤è€ƒè™‘çš„ä¹Ÿæ¯”è¾ƒå‘¨ç¥¥ã€‚æ­¥éª¤éš¾ç‚¹åœ¨åŸå¸‚è·å–è½¬ä¸º<span textstyle="">ç™¾åº¦ â†’ å…ˆ BD-09 â†’ GCJ-02 â†’ WGS84åæ ‡ç³»</span>ï¼Œä¸https://zenodo.org/communities/chap/records?q=&amp;l=list&amp;p=1&amp;s=10&amp;sort=newest æä¾›çš„chapæ•°æ®é›†.nsè¿›è¡Œå®Œç¾åŒ¹é…ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJQxNjlNAM6ZgoG2eNTF9qtzVAnmANsFPqKaUvrxfzic7honbuRSNZVIQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5407407407407407" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477162" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJQxNjlNAM6ZgoG2eNTF9qtzVAnmANsFPqKaUvrxfzic7honbuRSNZVIQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJib4icFtXRdpGfW4kEiaSNhv8WmYlkfibJBEp5MJUvBG7uiawQWmTxmMnqYA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5879629629629629" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477163" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJib4icFtXRdpGfW4kEiaSNhv8WmYlkfibJBEp5MJUvBG7uiawQWmTxmMnqYA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">3.3 æ•°æ®æ•´ç†Rä»£ç </span><span leaf="">Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">éš¾ç‚¹åœ¨äºæ‹¼éŸ³åŸå¸‚ä¸å›½é™…æ¥è½¨ï¼Œç¦»çº¿maps::world.citiesåŸå¸‚ä¸å…¨ï¼Œè‡ªåŠ¨ç‰ˆç™¾åº¦åœ°å›¾å¼€æ”¾å¹³å°AKå¯¹ä¸­æ–‡è¯†åˆ«å·å¯¹æ‹¼éŸ³å’Œè‹±æ–‡è¯†åˆ«å¼±ã€‚ç»¼ä¸Šï¼Œæˆ‘å°è¯•äº†ç¦»çº¿å’ŒAKåœ¨çº¿æº¯æº2ç§æ–¹æ³•ç»„åˆï¼Œä»¥ä¾¿åç»­å›½é™…å…¬å…±æ•°æ®åº“è”åˆè¯†åˆ«ç»çº¬åº¦ç”¨ã€‚ç¦»çº¿ç‰ˆå®Œå…¨ä»£ç è§<span textstyle="">æ–‡æœ«åˆ†äº«</span>ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJqJWHafydT1h4Phw6tnvK5YBIDL2BPMFHfnoTuKdgHuv3wSwqMuPibuQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5601851851851852" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477164" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJqJWHafydT1h4Phw6tnvK5YBIDL2BPMFHfnoTuKdgHuv3wSwqMuPibuQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJJzeMlEUj6X9VH4p1nibSbia7hYvoLFicEBaoaAhGWW1t0Op9KvvrRaC5Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6814814814814815" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477165" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJJzeMlEUj6X9VH4p1nibSbia7hYvoLFicEBaoaAhGWW1t0Op9KvvrRaC5Q/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJE8hFM2jIbnCL4DEib4tvldeJEk23hFK6rT0xmYuQ0A8eFsTCr5dw7rg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5694444444444444" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477166" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJE8hFM2jIbnCL4DEib4tvldeJEk23hFK6rT0xmYuQ0A8eFsTCr5dw7rg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJghBKkPpvTiaBH6M21zDVfKtkQPNpic9rTLM5CBAmkKvz2m4Ts5KBbFow/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5574074074074075" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477167" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJghBKkPpvTiaBH6M21zDVfKtkQPNpic9rTLM5CBAmkKvz2m4Ts5KBbFow/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJVicncCVOjhjd8EiazzFxibZKfXSX3WEUHjpGhjybkGaCJAiaGA0W8QmZUA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5564814814814815" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477168" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJVicncCVOjhjd8EiazzFxibZKfXSX3WEUHjpGhjybkGaCJAiaGA0W8QmZUA/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJljXgiaBjUBpIS6Y2BqTFmc7qessZrSPicUUq18v9OQvrUDNvibGC0eQYw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.55" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477169" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJljXgiaBjUBpIS6Y2BqTFmc7qessZrSPicUUq18v9OQvrUDNvibGC0eQYw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJGpic0TMoSQzQaNqzxmGhFoZpJMVb82JcJVNmnGfRGPkiamLlyahOxx0Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5268518518518519" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477171" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJGpic0TMoSQzQaNqzxmGhFoZpJMVb82JcJVNmnGfRGPkiamLlyahOxx0Q/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJvaicDZDxeNgJRT6ybUmoM0t7DnQJ17Wl9eMEJ3IXb5Ip5U6sLkQePSQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5601851851851852" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477170" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJvaicDZDxeNgJRT6ybUmoM0t7DnQJ17Wl9eMEJ3IXb5Ip5U6sLkQePSQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf=""><br></span><span><span leaf="">#Â <a topic-id="mgi7mk0j-apqibj" data-topic="1">#charls</a>Â PMç³»åˆ—ORèŒƒæ–‡å¤ç°,å®æˆ˜åŒ»å­¦ç»Ÿè®¡</span></span><span leaf=""><br></span><span><span leaf="">#--- æ™ºèŸcharls_20112020listå…¨é›†.RData</span></span><span leaf=""><br></span><span leaf="">setwd(</span><span><span leaf="">"D:/è‚ä¸ªäººæ–‡ä»¶/å‰¯ä¸šé¡¹ç›®/å¹¿å·æ™ºèŸæ•°æ®æœ‰é™å…¬å¸/Aæ¬¾2024è¯¾ä»¶/8.å…¬å…±æ•°æ®åº“/CHARLS"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">pacman::p_load(haven,dplyr,stringr,purrr,lcmm,LCTMtools)</span><span leaf=""><br></span><span leaf="">load(</span><span><span leaf="">"D:/è‚ä¸ªäººæ–‡ä»¶/å‰¯ä¸šé¡¹ç›®/å¹¿å·æ™ºèŸæ•°æ®æœ‰é™å…¬å¸/Aæ¬¾2024è¯¾ä»¶/8.å…¬å…±æ•°æ®åº“/CHARLS/æ™ºèŸcharls_20112020listå…¨é›†.RData"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0j-bnn8oy" data-topic="1">#ä¿®å¤ä¸­æ–‡</a>ï¼Œä¿®å¤ä¸äº†</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0j-kolspz" data-topic="1">#charls</a>_v2020[["charls_2011"]][["psu"]]$city Â  &lt;- iconv(charls_v2020[["charls_2011"]][["psu"]]$city, from = "GBK", to = "UTF-8")</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#-----1. æºæ•°æ®ä½“æ£€16406äºº-------</span></span><span leaf=""><br></span><span><span leaf="">#-----é€‰å–æ¨ªæ–­é¢2015,åšä½“æ£€æœ‰16406äºº</span></span><span leaf=""><br></span><span leaf="">bio2015 &lt;- charls_v2020[[</span><span><span leaf="">"charls_2015"</span></span><span leaf="">]][[</span><span><span leaf="">"biomarker"</span></span><span leaf="">]]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#--è¯»å–åŸºçº¿æ•°æ®è¡¥é½</span></span><span leaf=""><br></span><span leaf="">data.popu &lt;- charls_v2020[[</span><span><span leaf="">"bdmph"</span></span><span leaf="">]][[</span><span><span leaf="">"bdmph_population"</span></span><span leaf="">]]</span><span leaf=""><br></span><span><span leaf=""># ğŸŒŸ åˆ é™¤ gender ä¸º NA çš„è¡Œ, å¹¶ id Â wave è”åˆé‡å¤é€‰å–å”¯ä¸€è¡Œ</span></span><span leaf=""><br></span><span leaf="">data.popu &lt;- data.popu[!is.na(data.popu</span><span><span leaf="">$gender</span></span><span leaf="">) , ]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0j-vwgkyq" data-topic="1">#21092äºº</a>Â 2015åŸºçº¿</span></span><span leaf=""><br></span><span leaf="">data.2015 &lt;- data.popu[data.popu</span><span><span leaf="">$wave</span></span><span leaf="">Â == 2015, ]Â </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#-----2. çº³å…¥æ’é™¤-------</span></span><span leaf=""><br></span><span><span leaf="">#---2015ä¸”åšbiomarkerä½“æ£€ 16392äºº</span></span><span leaf=""><br></span><span leaf="">temp.df &lt;- data.2015 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(bio2015, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0j-joypie" data-topic="1">#age</a>&gt;=45,Â </span></span><span leaf=""><br></span><span leaf="">temp.df2 &lt;- temp.df %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(age &gt;= 45) Â </span><span><span leaf=""><a topic-id="mgi7mk0j-hke2li" data-topic="1">#15456äºº</a></span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0j-j4a5z3" data-topic="1">#è¡€æ¶²æ£€æµ‹2011</a>+2015</span></span><span leaf=""><br></span><span><span leaf=""># 21097äºº2015å¹´æŠ½è¡€ï¼Œç©ºè…¹è¡€ç³–11363äºº</span></span><span leaf=""><br></span><span><span leaf="">#---æ–¹æ³•1</span></span><span leaf=""><br></span><span leaf="">blood &lt;- charls_v2020[[</span><span><span leaf="">"charls_derived"</span></span><span leaf="">]][[</span><span><span leaf="">"blood"</span></span><span leaf="">]]</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0j-ysd30w" data-topic="1">#11363äºº</a></span></span><span leaf=""><br></span><span leaf="">blood2015 &lt;- blood %&gt;% Â filter(wave == 2015) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(bl_fasting == 1) Â </span><span leaf=""><br></span><span leaf="">names(blood2015)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#---æ–¹æ³•2ï¼Œ</span></span><span leaf=""><br></span><span leaf="">blood2 &lt;- charls_v2020[[</span><span><span leaf="">"charls_2015"</span></span><span leaf="">]][[</span><span><span leaf="">"blood"</span></span><span leaf="">]]</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0j-cur823" data-topic="1">#11364äººå·®ä¸å¤š</a></span></span><span leaf=""><br></span><span leaf="">blood20152 &lt;- blood2 %&gt;% Â filter(bl_fasting == 1) Â </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#---<a topic-id="mgi7mk0j-7b43ix" data-topic="1">#ä»…ä¿ç•™ç©ºè…¹æ£€æŸ¥è€…</a>Â 10705äºº</span></span><span leaf=""><br></span><span leaf="">temp.df3 &lt;- temp.df2 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(blood2015, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)Â </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#---<a topic-id="mgi7mk0j-fvqdc4" data-topic="1">#è¿›è¡Œæµ‹é‡ä¹‹å‰</a>Â 30 åˆ†é’Ÿå†…ï¼Œå—è¯•è€…æ˜¯å¦å¸çƒŸã€è¿åŠ¨ã€è¿›é£Ÿå’Œé¥®é…’ï¼Œ9198äºº</span></span><span leaf=""><br></span><span leaf="">pm_ids_clean &lt;- charls_v2020[[</span><span><span leaf="">"charls_derived"</span></span><span leaf="">]][[</span><span><span leaf="">"physical_measures"</span></span><span leaf="">]] %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(wave == 2015, bpact30 == 0) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(id) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># åªè¦ id</span></span><span leaf=""><br></span><span leaf="">temp.df4 &lt;- temp.df3 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(pm_ids_clean, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#---<a topic-id="mgi7mk0j-6wr53l" data-topic="1">#è…°å›´ä¸missing</a>ï¼Œ9147äºº</span></span><span leaf=""><br></span><span leaf="">pm_ids_clean &lt;- charls_v2020[[</span><span><span leaf="">"charls_derived"</span></span><span leaf="">]][[</span><span><span leaf="">"physical_measures"</span></span><span leaf="">]] %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(wave == 2015, !is.na(mwaist)) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(id) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># åªè¦ id</span></span><span leaf=""><br></span><span leaf="">temp.df5 &lt;- temp.df4 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(pm_ids_clean, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-9g6gga" data-topic="1">#SBP</a>Â DBPè¡€å‹éƒ½ä¸ç¼ºå¤±ï¼Œ9112äºº</span></span><span leaf=""><br></span><span leaf="">pm_ids_clean &lt;- charls_v2020[[</span><span><span leaf="">"charls_derived"</span></span><span leaf="">]][[</span><span><span leaf="">"physical_measures"</span></span><span leaf="">]] %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter( wave == 2015,!is.na(systo),!is.na(diasto) ) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(id)</span><span leaf=""><br></span><span><span leaf=""># åªè¦ id</span></span><span leaf=""><br></span><span leaf="">temp.df6 &lt;- temp.df5 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(pm_ids_clean, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#--ç”˜æ²¹ä¸‰é…¯ï¼ˆTGï¼‰ã€é«˜å¯†åº¦è„‚è›‹ç™½ï¼ˆHDLï¼‰ã€ç©ºè…¹è¡€ç³–ï¼ˆFBGï¼‰æˆ– C ååº”è›‹ç™½ï¼ˆCRPï¼‰æ•°æ®ä¸ç¼ºå¤±</span></span><span leaf=""><br></span><span leaf="">blood2015_clean &lt;- blood2015 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(Â </span><span leaf=""><br></span><span leaf="">Â  Â  !is.na(bl_tg), Â  Â  Â  Â  Â </span><span><span leaf=""># TG ä¸ç¼ºå¤±</span></span><span leaf=""><br></span><span leaf="">Â  Â  !is.na(bl_hdl), Â  Â  Â  Â Â </span><span><span leaf=""># HDL ä¸ç¼ºå¤±</span></span><span leaf=""><br></span><span leaf="">Â  Â  !is.na(bl_glu), Â  Â  Â  Â Â </span><span><span leaf=""># ç©ºè…¹è¡€ç³– ä¸ç¼ºå¤±</span></span><span leaf=""><br></span><span leaf="">Â  Â  !is.na(bl_crp) Â  Â  Â  Â  Â </span><span><span leaf=""># CRP ä¸ç¼ºå¤±</span></span><span leaf=""><br></span><span leaf="">Â  ) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(id)</span><span leaf=""><br></span><span><span leaf=""># åªè¦ id, 9104äºº</span></span><span leaf=""><br></span><span leaf="">temp.df7 &lt;- temp.df6 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  semi_join(blood2015_clean, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#---â¤ï¸ .nsæ–‡ä»¶è¯»å– CHAP_PM1_Y1K_2013_V3.nc æ–‡ä»¶æ˜¯ HDF5 æ ¼å¼çš„ NetCDF4 æ–‡ä»¶</span></span><span leaf=""><br></span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#------3. psu ç»çº¬åº¦----</span></span><span leaf=""><br></span><span><span leaf="">#----1ï¸âƒ£ ç¦»çº¿ç‰ˆâ†’ psuç»çº¬åº¦----</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-15jb7k" data-topic="1">#ç¦»çº¿åŸå¸‚ç»çº¬åº¦åŒ¹é…</a>ï¼ˆä¸éœ€è¦ä¸Šç½‘ï¼‰</span></span><span leaf=""><br></span><span><span leaf=""># æ€è·¯ï¼šç”¨ maps::world.cities æä¾›çš„ä¸­å›½ï¼ˆå«å°æ¹¾ï¼‰åŸå¸‚ç»çº¬åº¦åšâ€œè¯å…¸â€ï¼ŒÂ </span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-ynsevk" data-topic="1">#å°†</a>Â psu$city_eng è¿›è¡Œè§„èŒƒåŒ–å¤„ç†åï¼Œä¸è¯å…¸åšæ¨¡ç³ŠåŒ¹é…ï¼Œå¾—åˆ°æ¯ä¸ªåŸå¸‚çš„è¡Œæ”¿ä¸­å¿ƒç»çº¬åº¦ã€‚</span></span><span leaf=""><br></span><span leaf="">pacman::p_load(dplyr, stringr, fuzzyjoin, maps, tibble)</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-waybcd" data-topic="1">#psuæŠ½æ ·çœå¸‚</a></span></span><span leaf=""><br></span><span leaf="">psu &lt;- charls_v2020[[</span><span><span leaf="">"charls_2011"</span></span><span leaf="">]][[</span><span><span leaf="">"psu"</span></span><span leaf="">]]</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-09ouz8" data-topic="1">#world</a>.cities æ•°æ®é›†æ¥è‡ª maps åŒ…ï¼ŒåŒ…å«å…¨çƒåŸå¸‚ååŠç»çº¬åº¦ï¼ˆlong/latï¼‰ï¼Œ</span></span><span leaf=""><br></span><span><span leaf=""># åªä¿ç•™ä¸­å›½ä¸å°æ¹¾</span></span><span leaf=""><br></span><span leaf="">data(</span><span><span leaf="">"world.cities"</span></span><span leaf="">, package =Â </span><span><span leaf="">"maps"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">gaz &lt;- world.cities %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(country.etc %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"China"</span></span><span leaf="">,Â </span><span><span leaf="">"Taiwan"</span></span><span leaf="">)) %&gt;% Â Â </span><span><span leaf=""># è§†åˆ†æå£å¾„è€Œå®šï¼Œä¹Ÿå¯åªç”¨ China</span></span><span leaf=""><br></span><span leaf="">Â  transmute(</span><span leaf=""><br></span><span leaf="">Â  Â  city_gaz_raw Â = name, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># åŸå§‹åŸå¸‚åï¼ˆè‹±æ–‡ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  Â  city_gaz_norm = str_to_lower(str_replace_all(name,Â </span><span><span leaf="">"[^a-zA-Z0-9]"</span></span><span leaf="">,Â </span><span><span leaf="">""</span></span><span leaf="">)), Â </span><span><span leaf=""># è§„èŒƒåŒ–ï¼šå°å†™å¹¶å»æ‰éå­—æ¯æ•°å­—</span></span><span leaf=""><br></span><span leaf="">Â  Â  longitude Â  Â  = long, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># ç»åº¦</span></span><span leaf=""><br></span><span leaf="">Â  Â  latitude Â  Â  Â = lat, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf=""># çº¬åº¦</span></span><span leaf=""><br></span><span leaf="">Â  Â  pop Â  Â  Â  Â  Â  = pop Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># åŸå¸‚äººå£ï¼ˆç”¨äºå¹³æ‰‹æ—¶ä¼˜å…ˆäººå£æ›´å¤šè€…ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  ) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(city_gaz_norm, .keep_all = TRUE) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># å»é‡ï¼šåŒååŸå¸‚å–ä¸€æ¡ï¼ˆé€šå¸¸ä¿ç•™äººå£æ›´å¤§/æ›´å¸¸è§è€…ï¼‰</span></span><span leaf=""><br></span><span><span leaf=""># å¯¹ psu$city_eng åšè§„èŒƒåŒ–</span></span><span leaf=""><br></span><span><span leaf=""># ç›®æ ‡ï¼šæŠŠå„ç§è‹±æ–‡å†™æ³•ï¼ˆå¤§å°å†™ã€ç©ºæ ¼ã€è¿å­—ç¬¦ã€å¤‡æ³¨åç¼€ï¼‰ç»Ÿä¸€åˆ°â€œå¯æ¯”â€çš„å½¢å¼ï¼Œ</span></span><span leaf=""><br></span><span><span leaf=""># ä¾¿äºåç»­æ¨¡ç³ŠåŒ¹é…æé«˜å‘½ä¸­ç‡ã€‚</span></span><span leaf=""><br></span><span leaf="">stopifnot(</span><span><span leaf="">"city_eng"</span></span><span leaf="">Â %</span><span><span leaf="">in</span></span><span leaf="">% names(psu)) Â </span><span><span leaf=""># ä¿æŠ¤æ€§æ£€æŸ¥ï¼šå¿…é¡»æœ‰ city_eng åˆ—</span></span><span leaf=""><br></span><span leaf="">psu_norm &lt;- psu %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(</span><span leaf=""><br></span><span leaf="">Â  Â  city_eng_raw Â = city_eng, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf=""># ä¿ç•™åŸå§‹è‹±æ–‡åŸå¸‚å</span></span><span leaf=""><br></span><span leaf="">Â  Â  city_eng_norm = str_to_lower(str_replace_all(city_eng,Â </span><span><span leaf="">"[^a-zA-Z0-9]"</span></span><span leaf="">,Â </span><span><span leaf="">""</span></span><span leaf="">)),Â </span><span><span leaf=""># è§„èŒƒåŒ–ï¼šå°å†™+å»æ‰éå­—æ¯æ•°å­—</span></span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># å»æ‰å¸¸è§åç¼€æˆ–æ°‘æ—å½¢å®¹è¯ï¼ˆprefecture/region/league/autonomous ç­‰ï¼‰ï¼Œ</span></span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># ä¾‹å¦‚â€œchuxiong yi autonomous prefectureâ€å»æ‰åç¼€ï¼Œä¾¿äºåŒ¹é…åˆ°â€œchuxiongâ€</span></span><span leaf=""><br></span><span leaf="">Â  Â  city_eng_norm = str_replace_all(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  city_eng_norm,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  c(</span><span><span leaf="">"autonomousprefecture"</span></span><span leaf="">Â =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"mongolian"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"uygur"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"kazakh"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"prefecture"</span></span><span leaf="">Â  Â  Â  Â  Â  Â =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"region"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"league"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"airport"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  =Â </span><span><span leaf="">""</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â Â </span><span><span leaf="">"city"</span></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â =Â </span><span><span leaf="">""</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Â  Â  ) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  Â  Â  str_squish() Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><span><span leaf=""># å†æ¬¡å‹ç¼©å¤šä½™ç©ºæ ¼ï¼ˆä¿é™©ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  )</span><span leaf=""><br></span><span leaf="">â€¦â€¦</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#------------4. æµ‹è¯•.nsè¯»å–-----</span></span><span leaf=""><br></span><span><span leaf="">#------3ï¸âƒ£ .nsç¿»è½¬æ …æ ¼PM1 2013-------</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-6auvre" data-topic="1">#r</a>_rotï¼ˆç¿»è½¬/æ—‹è½¬ä¹‹åçš„ PM1 æ …æ ¼ï¼Œå·²ç»è®¾ç½®äº† extent å’Œ CRS = WGS84ï¼‰</span></span><span leaf=""><br></span><span><span leaf=""># åŠ è½½å¿…è¦åŒ…,æ—¶é—´è¾ƒä¹…ï¼</span></span><span leaf=""><br></span><span><span leaf=""># options(install.packages.compile.from.source = "never") Â # ç¦æ­¢ä»æºç ç¼–è¯‘</span></span><span leaf=""><br></span><span><span leaf=""># install.packages("ncdf4") Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ç›´æ¥è£…ncdf4ï¼Œè¿˜æ˜¯åç»­é”™è¯¯</span></span><span leaf=""><br></span><span leaf="">pacman::p_load(ncdf4,raster,terra,rhdf5)Â </span><span leaf=""><br></span><span><span leaf=""># 1. å…ˆå®šä¹‰æ–‡ä»¶è·¯å¾„Â </span></span><span leaf=""><br></span><span leaf="">nc_file &lt;-Â </span><span><span leaf="">"D:/è‚ä¸ªäººæ–‡ä»¶/å‰¯ä¸šé¡¹ç›®/å¹¿å·æ™ºèŸæ•°æ®æœ‰é™å…¬å¸/Bæ¬¾ç¯å¢ƒä¸çœŸå®ä¸–ç•Œçºµå‘æ•°æ®/ç¯å¢ƒäº¤å‰/CHAP/pm1/CHAP_PM1_Y1K_2013_V3.nc"</span></span><span leaf=""><br></span><span><span leaf="">#--rhdf5 æŠŠ.nc é‡Œçš„ç»çº¬åº¦ä¸å˜é‡è¯»å‡ºæ¥äº¤ç»™terra è®¾ç½® extent/CRS</span></span><span leaf=""><br></span><span><span leaf=""># 1) çœ‹çœ‹æ–‡ä»¶é‡Œéƒ½æœ‰ä»€ä¹ˆèŠ‚ç‚¹ï¼ˆæ‰¾ lon/lat/å˜é‡ åç§°ï¼‰</span></span><span leaf=""><br></span><span leaf="">h5ls(nc_file)</span><span leaf=""><br></span><span><span leaf=""># 2) è¯»ç»çº¬åº¦ä¸æ±¡æŸ“å˜é‡</span></span><span leaf=""><br></span><span leaf="">lon &lt;- h5read(nc_file,Â </span><span><span leaf="">"lon"</span></span><span leaf="">) Â  Â  Â  Â </span><span><span leaf=""># æˆ– "longitude"ã€"/lon"</span></span><span leaf=""><br></span><span leaf="">lat &lt;- h5read(nc_file,Â </span><span><span leaf="">"lat"</span></span><span leaf="">) Â  Â  Â  Â </span><span><span leaf=""># æˆ– "latitude"ã€"/lat"</span></span><span leaf=""><br></span><span leaf="">pm Â &lt;- h5read(nc_file,Â </span><span><span leaf="">"PM1"</span></span><span leaf="">) Â  Â  Â  Â </span><span><span leaf=""># æ¯”å¦‚ "PM1"ï¼›è‹¥æ˜¯ 3D (timeÃ—latÃ—lon)ï¼Œå†é€‰æ—¶é—´å±‚</span></span><span leaf=""><br></span><span><span leaf=""># 3) æ„é€  SpatRaster</span></span><span leaf=""><br></span><span><span leaf=""># Â  å‡è®¾ pm ä¸º 2D çŸ©é˜µï¼Œç»´åº¦ä¸º [lat, lon]ï¼ˆå…ˆç¡®è®¤ dim(pm) == c(length(lat), length(lon))ï¼‰</span></span><span leaf=""><br></span><span leaf="">r &lt;- rast(pm)</span><span leaf=""><br></span><span><span leaf=""># 4) è®¾å®šç©ºé—´èŒƒå›´å’Œåæ ‡ç³»ï¼ˆWGS84ï¼‰</span></span><span leaf=""><br></span><span leaf="">ext(r) &lt;- c(min(lon), max(lon), min(lat), max(lat))</span><span leaf=""><br></span><span leaf="">crs(r) &lt;-Â </span><span><span leaf="">"EPSG:4326"</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># è‹¥ lat æ˜¯ä»åŒ—åˆ°å—ï¼ˆé€’å‡ï¼‰ï¼Œéœ€è¦ç¿»è½¬ä¸€ä¸‹ï¼š</span></span><span leaf=""><br></span><span><span leaf="">if</span></span><span leaf="">Â (length(lat) &gt; 1 &amp;&amp; lat[2] &lt; lat[1]) r &lt;- flip(r, direction =Â </span><span><span leaf="">"vertical"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 5) å¯è§†åŒ–/è£å‰ª/è¾“å‡º,åäº†</span></span><span leaf=""><br></span><span leaf="">plot(r)</span><span leaf=""><br></span><span><span leaf=""># å‡è®¾åŸæ•°æ®è¦†ç›– 70E-140E, 15N-55N</span></span><span leaf=""><br></span><span leaf="">m &lt;- as.matrix(r, wide=TRUE)</span><span leaf=""><br></span><span leaf="">m_rot &lt;- t(apply(m, 2, rev)) Â Â </span><span><span leaf=""># é¡ºæ—¶é’ˆæ—‹è½¬ 90Â°</span></span><span leaf=""><br></span><span leaf="">r_rot &lt;- rast(m_rot)</span><span leaf=""><br></span><span leaf="">ext(r_rot) &lt;- c(70, 140, 15, 55) Â </span><span><span leaf=""># æ‰‹åŠ¨è¡¥ä¸Šç»çº¬åº¦èŒƒå›´</span></span><span leaf=""><br></span><span leaf="">crs(r_rot) &lt;-Â </span><span><span leaf="">"EPSG:4326"</span></span><span leaf=""><br></span><span leaf="">plot(r_rot)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#-----4ï¸âƒ£ é“¾æ¥ psu_geo_pm1 2013-------</span></span><span leaf=""><br></span><span leaf="">pacman::p_load(terra, sf, dplyr)</span><span leaf=""><br></span><span><span leaf=""># 1) æŠŠ psu_geo è½¬æ¢ä¸º SpatVector ç‚¹å›¾å±‚</span></span><span leaf=""><br></span><span leaf="">pts &lt;- terra::vect(</span><span leaf=""><br></span><span leaf="">Â  psu_geo,</span><span leaf=""><br></span><span leaf="">Â  geom = c(</span><span><span leaf="">"wgs_lon"</span></span><span leaf="">,Â </span><span><span leaf="">"wgs_lat"</span></span><span leaf="">), Â Â </span><span><span leaf=""># åˆ—åè¦å’Œ psu_geo é‡Œçš„ä¸€è‡´</span></span><span leaf=""><br></span><span leaf="">Â  crs =Â </span><span><span leaf="">"EPSG:4326"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  keepgeom = TRUE</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 2) ä»æ …æ ¼æå–å¯¹åº”ç‚¹çš„ PM1 å€¼</span></span><span leaf=""><br></span><span leaf="">pm1_2013 &lt;- terra::extract(r_rot, pts, ID=FALSE) Â </span><span leaf=""><br></span><span><span leaf=""># è¿”å›ä¸€ä¸ªæ•°æ®æ¡†ï¼ŒæŒ‰ç‚¹é¡ºåº</span></span><span leaf=""><br></span><span><span leaf=""># 3) åˆå¹¶å› psu_geo</span></span><span leaf=""><br></span><span leaf="">psu_geo_pm1 &lt;- psu_geo %&gt;%</span><span leaf=""><br></span><span leaf="">Â  bind_cols(pm1_2013 = pm1_2013[,1]) Â </span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#------------6. Â æœ€ç»ˆçº³æ’â†’ temp.df8-----</span></span><span leaf=""><br></span><span><span leaf=""># temp.df7 åˆå¹¶psu_geo_all</span></span><span leaf=""><br></span><span leaf="">pacman::p_load(dplyr, stringr)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 1) æ„é€  temp.df7 idåŒ¹é…å‰7ä½æ•°</span></span><span leaf=""><br></span><span leaf="">temp.df7_keyed &lt;- temp.df7 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(</span><span leaf=""><br></span><span leaf="">Â  Â  id_chr = as.character(id),</span><span leaf=""><br></span><span leaf="">Â  Â  comm7 Â = str_sub(id_chr, 1, 7) Â Â </span><span><span leaf=""># å–å‰7ä½</span></span><span leaf=""><br></span><span leaf="">Â  )</span><span leaf=""><br></span><span><span leaf=""># 2) ç»Ÿä¸€ psu_geo_all çš„é”®ç±»å‹</span></span><span leaf=""><br></span><span leaf="">psu_geo_all_keyed &lt;- psu_geo_all %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(communityid = as.character(communityid))</span><span leaf=""><br></span><span><span leaf=""># 3) å¦‚ communityid æœ‰é‡å¤ï¼Œå…ˆå»é‡ï¼ˆä¿ç•™ç¬¬ä¸€æ¬¡ï¼›å¯æ”¹ä¸ºå…¶å®ƒè§„åˆ™ï¼‰</span></span><span leaf=""><br></span><span leaf="">dup_check &lt;- psu_geo_all_keyed %&gt;%</span><span leaf=""><br></span><span leaf="">Â  count(communityid, name =Â </span><span><span leaf="">"n"</span></span><span leaf="">) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(n &gt; 1)</span><span leaf=""><br></span><span leaf="">psu_geo_all_dedup &lt;- psu_geo_all_keyed %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(communityid, .keep_all = TRUE)</span><span leaf=""><br></span><span><span leaf=""># 4) å·¦è¿æ¥ï¼šæŠŠ psu_geo_all çš„å…¨éƒ¨åˆ—å¹¶åˆ° temp.df7</span></span><span leaf=""><br></span><span leaf="">temp.df8 &lt;- temp.df7_keyed %&gt;%</span><span leaf=""><br></span><span leaf="">Â  left_join(psu_geo_all_dedup, by = c(</span><span><span leaf="">"comm7"</span></span><span leaf="">Â =Â </span><span><span leaf="">"communityid"</span></span><span leaf="">)) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  dplyr::select(-id_chr, -comm7) Â Â </span><span><span leaf=""># æ¸…ç†ä¸´æ—¶åˆ—</span></span><span leaf=""><br></span><span><span leaf=""># # å¯é€‰ï¼šçœ‹çœ‹åŒ¹é…ç‡</span></span><span leaf=""><br></span><span><span leaf=""># match_rate &lt;- mean(!is.na(temp.df8$province_eng)) Â # ç”¨å…¶ä¸­ä¸€åˆ—åšåˆ¤æ–­</span></span><span leaf=""><br></span><span><span leaf=""># message(sprintf("åŒ¹é…ç‡ï¼š%.1f%%", 100 * match_rate))</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#-----------7. ğŸ“ paperæ•°æ® -----</span></span><span leaf=""><br></span><span><span leaf="">##-----7.1 x covs-------</span></span><span leaf=""><br></span><span leaf="">names(temp.df8)Â </span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-8sb9z9" data-topic="1">#æ–°å¢ä¸œä¸­è¥¿åœ°åŒºregion</a>ï¼Œçœä»½åˆ’åˆ†</span></span><span leaf=""><br></span><span leaf="">temp.df8 &lt;- temp.df8 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(region = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># ä¸œéƒ¨</span></span><span leaf=""><br></span><span leaf="">Â  Â  province_eng %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"Beijing"</span></span><span leaf="">,</span><span><span leaf="">"Tianjin"</span></span><span leaf="">,</span><span><span leaf="">"Hebei"</span></span><span leaf="">,</span><span><span leaf="">"Shanghai"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">"Jiangsu"</span></span><span leaf="">,</span><span><span leaf="">"Zhejiang"</span></span><span leaf="">,</span><span><span leaf="">"Fujian"</span></span><span leaf="">,</span><span><span leaf="">"Shandong"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">"Guangdong"</span></span><span leaf="">,</span><span><span leaf="">"Hainan"</span></span><span leaf="">) ~Â </span><span><span leaf="">"East"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># ä¸­éƒ¨</span></span><span leaf=""><br></span><span leaf="">Â  Â  province_eng %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"Shanxi"</span></span><span leaf="">,</span><span><span leaf="">"Anhui"</span></span><span leaf="">,</span><span><span leaf="">"Jiangxi"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">"Henan"</span></span><span leaf="">,</span><span><span leaf="">"Hubei"</span></span><span leaf="">,</span><span><span leaf="">"Hunan"</span></span><span leaf="">) ~Â </span><span><span leaf="">"Midland"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># è¥¿éƒ¨</span></span><span leaf=""><br></span><span leaf="">Â  Â  province_eng %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"Inner Mongolia"</span></span><span leaf="">,</span><span><span leaf="">"Guangxi"</span></span><span leaf="">,</span><span><span leaf="">"Chongqing"</span></span><span leaf="">,</span><span><span leaf="">"Sichuan"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">"Guizhou"</span></span><span leaf="">,</span><span><span leaf="">"Yunnan"</span></span><span leaf="">,</span><span><span leaf="">"Tibet"</span></span><span leaf="">,</span><span><span leaf="">"Shaanxi"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">"Gansu"</span></span><span leaf="">,</span><span><span leaf="">"Qinghai"</span></span><span leaf="">,</span><span><span leaf="">"Ningxia"</span></span><span leaf="">,</span><span><span leaf="">"Xinjiang"</span></span><span leaf="">) ~Â </span><span><span leaf="">"West"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># ä¸œåŒ—ï¼ˆæ ¹æ®ä½ éœ€è¦å†³å®šå¹¶åˆ°å“ªä¸€ç±»ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  Â  province_eng %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"Liaoning"</span></span><span leaf="">,</span><span><span leaf="">"Jilin"</span></span><span leaf="">,</span><span><span leaf="">"Heilongjiang"</span></span><span leaf="">) ~Â </span><span><span leaf="">"Midland"</span></span><span leaf="">,Â </span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""><a topic-id="mgi7mk0k-qosfjt" data-topic="1">#province</a>_eng %in% c("Liaoning","Jilin","Heilongjiang") ~ "Northeast"</span></span><span leaf=""><br></span><span leaf="">Â  Â  TRUE ~ NA_character_</span><span leaf=""><br></span><span leaf="">Â  ))</span><span leaf=""><br></span><span leaf="">paper.1 &lt;- Â temp.df8 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  dplyr::select(</span><span leaf=""><br></span><span leaf="">Â  Â  id,</span><span leaf=""><br></span><span leaf="">Â  Â  age,</span><span leaf=""><br></span><span leaf="">Â  Â  gender,</span><span leaf=""><br></span><span leaf="">Â  Â  residence = residence_tag,</span><span leaf=""><br></span><span leaf="">Â  Â  education = edu_1_tag, Â Â </span><span><span leaf=""># æˆ–æ”¹æˆ edu_2_tag</span></span><span leaf=""><br></span><span leaf="">Â  Â  marital = marry_1_tag, Â Â </span><span><span leaf=""># æˆ–ç»„åˆ marry_1/2/3</span></span><span leaf=""><br></span><span leaf="">Â  Â  household_exp = income_household,</span><span leaf=""><br></span><span leaf="">Â  Â  smoking = smoke_1_tag, Â Â </span><span><span leaf=""># æˆ–ç»“åˆ smoke_2_tag</span></span><span leaf=""><br></span><span leaf="">Â  Â  drinking = drink_1_tag, Â </span><span><span leaf=""># æˆ–ç»“åˆ drink_2/3</span></span><span leaf=""><br></span><span leaf="">Â  Â  physical_activity = physical_activity_tag,</span><span leaf=""><br></span><span leaf="">Â  Â </span><span><span leaf="">## cooking_fuel = Cooking_fuel_type, # å¾…ç¡®è®¤Â </span></span><span leaf=""><br></span><span leaf="">Â  Â  region,</span><span leaf=""><br></span><span leaf="">Â  Â  waist,</span><span leaf=""><br></span><span leaf="">Â  Â  tg = bl_tg,</span><span leaf=""><br></span><span leaf="">Â  Â  hdl = bl_hdl,</span><span leaf=""><br></span><span leaf="">Â  Â  fbg = bl_glu,</span><span leaf=""><br></span><span leaf="">Â  Â  sbp,</span><span leaf=""><br></span><span leaf="">Â  Â  dbp,</span><span leaf=""><br></span><span leaf="">Â  Â  crp = bl_crp,Â </span><span><span leaf=""><a topic-id="mgi7mk0k-ofdtnm" data-topic="1">#æ ¸å¿ƒxå˜é‡</a></span></span><span leaf=""><br></span><span leaf="">Â  Â  anti_htn = itvtn_hypertension_drug_tag,</span><span leaf=""><br></span><span leaf="">Â  Â  anti_dm = itvtn_insulin_or_diabetes_drug_tagÂ </span><span leaf=""><br></span><span leaf="">Â  Â </span><span><span leaf="">## mets Â <a topic-id="mgi7mk0k-dwr824" data-topic="1">#ä½ çš„Yå˜é‡</a>Â </span></span><span leaf=""><br></span><span leaf="">Â  )</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-1cowj2" data-topic="1">#å¼•å…¥å›ºæ€ç‡ƒçƒ§</a></span></span><span leaf=""><br></span><span leaf="">fuel &lt;- charls_v2020[[</span><span><span leaf="">"charls_derived"</span></span><span leaf="">]][[</span><span><span leaf="">"financial_housing"</span></span><span leaf="">]]</span><span leaf=""><br></span><span><span leaf=""># 1) å– fuel ä¸­ wave==2015ï¼Œç•™ä¸‹ id å’Œ cooking_fuel_typeï¼Œå¹¶å¯¹ id å»é‡</span></span><span leaf=""><br></span><span leaf="">fuel_2015 &lt;- fuel %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(wave == 2015) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  select(id, cooking_fuel_type) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  distinct(id, .keep_all = TRUE)</span><span leaf=""><br></span><span><span leaf=""># 2) ä¸ paper æŒ‰ id å·¦è¿æ¥ï¼Œåªæ–°å¢ cooking_fuel_type</span></span><span leaf=""><br></span><span leaf="">paper.2 &lt;- paper.1 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  left_join(fuel_2015, by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">##-----7.2 yâ†’ mets------</span></span><span leaf=""><br></span><span leaf="">library(dplyr)</span><span leaf=""><br></span><span leaf="">library(stringr)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">df &lt;- temp.df8 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># 0) è‡ªåŠ¨åˆ¤æ–­å•ä½ï¼ˆç²—ç•¥ä½†å®ç”¨ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  Â  tg_unit Â = ifelse(median(bl_tg, Â na.rm=TRUE) Â &gt; 10,Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">,Â </span><span><span leaf="">"mmol"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  hdl_unit = ifelse(median(bl_hdl, na.rm=TRUE) Â &gt; 10,Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">,Â </span><span><span leaf="">"mmol"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  glu_unit = ifelse(median(bl_glu, na.rm=TRUE) Â &gt; 20,Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">,Â </span><span><span leaf="">"mmol"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â  tg_thr Â  = ifelse(tg_unit Â ==Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">, 150, 1.7),</span><span leaf=""><br></span><span leaf="">Â  Â  hdl_m_thr= ifelse(hdl_unit ==Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">, Â 40, 1.04),</span><span leaf=""><br></span><span leaf="">Â  Â  hdl_f_thr= ifelse(hdl_unit ==Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">, Â 50, 1.29),</span><span leaf=""><br></span><span leaf="">Â  Â  glu_thr Â = ifelse(glu_unit ==Â </span><span><span leaf="">"mgdl"</span></span><span leaf="">, 100, 5.6),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># 1) æ€§åˆ«åˆ° 1/2</span></span><span leaf=""><br></span><span leaf="">Â  Â  gender_num = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  is.numeric(gender) ~ as.numeric(gender),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  is.character(gender) &amp; str_to_lower(gender) %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"male"</span></span><span leaf="">,</span><span><span leaf="">"m"</span></span><span leaf="">,</span><span><span leaf="">"ç”·"</span></span><span leaf="">) ~ 1,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  is.character(gender) &amp; str_to_lower(gender) %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">"female"</span></span><span leaf="">,</span><span><span leaf="">"f"</span></span><span leaf="">,</span><span><span leaf="">"å¥³"</span></span><span leaf="">) ~ 2,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_real_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># 2) äº”ä¸ªæˆåˆ†</span></span><span leaf=""><br></span><span leaf="">Â  Â  high_wc = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(gender_num) &amp; !is.na(waist) &amp;</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  ((gender_num==1 &amp; waist&gt;=85) | (gender_num==2 &amp; waist&gt;=80)) ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(gender_num) &amp; !is.na(waist) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># è¯ç‰©å­—æ®µæ›´ç¨³å¥ï¼šå…è®¸ 1/0 æˆ– "Yes/No"</span></span><span leaf=""><br></span><span leaf="">Â  Â  anti_htn_flag = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  is.na(itvtn_hypertension_drug_tag) ~ NA,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  itvtn_hypertension_drug_tag %</span><span><span leaf="">in</span></span><span leaf="">% c(1,</span><span><span leaf="">"1"</span></span><span leaf="">,</span><span><span leaf="">"Yes"</span></span><span leaf="">,</span><span><span leaf="">"yes"</span></span><span leaf="">,</span><span><span leaf="">"Y"</span></span><span leaf="">,</span><span><span leaf="">"y"</span></span><span leaf="">,</span><span><span leaf="">"æ˜¯"</span></span><span leaf="">,</span><span><span leaf="">"æœ‰"</span></span><span leaf="">) ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  itvtn_hypertension_drug_tag %</span><span><span leaf="">in</span></span><span leaf="">% c(0,</span><span><span leaf="">"0"</span></span><span leaf="">,</span><span><span leaf="">"No"</span></span><span leaf="">,</span><span><span leaf="">"no"</span></span><span leaf="">,</span><span><span leaf="">"N"</span></span><span leaf="">,</span><span><span leaf="">"n"</span></span><span leaf="">,</span><span><span leaf="">"å¦"</span></span><span leaf="">,</span><span><span leaf="">"æ— "</span></span><span leaf="">) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â  anti_dm_flag = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  is.na(itvtn_insulin_or_diabetes_drug_tag) ~ NA,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  itvtn_insulin_or_diabetes_drug_tag %</span><span><span leaf="">in</span></span><span leaf="">% c(1,</span><span><span leaf="">"1"</span></span><span leaf="">,</span><span><span leaf="">"Yes"</span></span><span leaf="">,</span><span><span leaf="">"yes"</span></span><span leaf="">,</span><span><span leaf="">"Y"</span></span><span leaf="">,</span><span><span leaf="">"y"</span></span><span leaf="">,</span><span><span leaf="">"æ˜¯"</span></span><span leaf="">,</span><span><span leaf="">"æœ‰"</span></span><span leaf="">) ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  itvtn_insulin_or_diabetes_drug_tag %</span><span><span leaf="">in</span></span><span leaf="">% c(0,</span><span><span leaf="">"0"</span></span><span leaf="">,</span><span><span leaf="">"No"</span></span><span leaf="">,</span><span><span leaf="">"no"</span></span><span leaf="">,</span><span><span leaf="">"N"</span></span><span leaf="">,</span><span><span leaf="">"n"</span></span><span leaf="">,</span><span><span leaf="">"å¦"</span></span><span leaf="">,</span><span><span leaf="">"æ— "</span></span><span leaf="">) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â  high_bp = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  (!is.na(sbp) &amp; sbp&gt;=130) | (!is.na(dbp) &amp; dbp&gt;=85) | anti_htn_flag==1L ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  (!is.na(sbp) | !is.na(dbp) | !is.na(anti_htn_flag)) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â  low_hdl = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(gender_num) &amp; !is.na(bl_hdl) &amp;</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  ((gender_num==1 &amp; bl_hdl &lt; hdl_m_thr) | (gender_num==2 &amp; bl_hdl &lt; hdl_f_thr)) ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(gender_num) &amp; !is.na(bl_hdl) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â  high_tg = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(bl_tg) &amp; bl_tg &gt;= tg_thr ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(bl_tg) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  ),</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span leaf=""><br></span><span leaf="">Â  Â  high_glu = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  (!is.na(bl_glu) &amp; bl_glu &gt;= glu_thr) | anti_dm_flag==1L ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  (!is.na(bl_glu) | !is.na(anti_dm_flag)) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  )</span><span leaf=""><br></span><span leaf="">Â  ) %&gt;%</span><span leaf=""><br></span><span leaf="">Â  mutate(</span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf=""># ç¼ºå¤±ä¸è®¡åˆ†ï¼ˆè‹¥è¦â€œæœ‰ç¼ºå¤±åˆ™NAâ€ï¼Œç”¨ä½ æ³¨é‡Šé‡Œé‚£æ®µæ›¿æ¢ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  Â  MetS_risk_num = rowSums(across(c(high_wc,high_bp,low_hdl,high_tg,high_glu)), na.rm = TRUE),</span><span leaf=""><br></span><span leaf="">Â  Â  mets = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(MetS_risk_num) &amp; MetS_risk_num &gt;= 3 ~ 1L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  !is.na(MetS_risk_num) ~ 0L,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  TRUE ~ NA_integer_</span><span leaf=""><br></span><span leaf="">Â  Â  )</span><span leaf=""><br></span><span leaf="">Â  )</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># å„æˆåˆ†é˜³æ€§ç‡</span></span><span leaf=""><br></span><span leaf="">sapply(df[,c(</span><span><span leaf="">"high_wc"</span></span><span leaf="">,</span><span><span leaf="">"high_bp"</span></span><span leaf="">,</span><span><span leaf="">"low_hdl"</span></span><span leaf="">,</span><span><span leaf="">"high_tg"</span></span><span leaf="">,</span><span><span leaf="">"high_glu"</span></span><span leaf="">)],Â </span><span><span leaf="">function</span></span><span leaf="">(x) mean(x==1, na.rm=TRUE))</span><span leaf=""><br></span><span><span leaf=""># æ€»ä½“ MetS ç‡</span></span><span leaf=""><br></span><span leaf="">mean(df</span><span><span leaf="">$mets</span></span><span leaf="">==1, na.rm=TRUE)</span><span leaf=""><br></span><span><span leaf=""># ç»„æˆæ•°åˆ†å¸ƒ</span></span><span leaf=""><br></span><span leaf="">table(df</span><span><span leaf="">$MetS_risk_num</span></span><span leaf="">, useNA=</span><span><span leaf="">"ifany"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#----ğŸŒŸ æœ€ç»ˆè®ºæ–‡æ•°æ®-----</span></span><span leaf=""><br></span><span leaf="">paper &lt;- paper.2 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  left_join(df %&gt;% select(id, mets), by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#----ğŸŒŸ æœ€ç»ˆè®ºæ–‡æ•°æ®-----</span></span><span leaf=""><br></span><span leaf="">paper &lt;- paper.2 %&gt;%</span><span leaf=""><br></span><span leaf="">Â  left_join(df %&gt;% select(id, mets), by =Â </span><span><span leaf="">"id"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">3.4 ç»Ÿè®¡Rä»£ç Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ€ç»ˆåˆ†ææ•°æ®ä¸è¿‡ç¨‹å¦‚ä¸‹ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJvaicDZDxeNgJRT6ybUmoM0t7DnQJ17Wl9eMEJ3IXb5Ip5U6sLkQePSQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5601851851851852" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477172" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJvaicDZDxeNgJRT6ybUmoM0t7DnQJ17Wl9eMEJ3IXb5Ip5U6sLkQePSQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJBVNGiaIOoCNvrIXibJK2q4Fph3n7KcrvjWQwywCGnJNrn6KYNmR3YDIw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.549074074074074" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477175" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJBVNGiaIOoCNvrIXibJK2q4Fph3n7KcrvjWQwywCGnJNrn6KYNmR3YDIw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJY3Diba69Z4kuaYVaz67kNR4ia41JEicAgZZ2vWpmNUKGubWKwdedjich7w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4666666666666667" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477174" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJY3Diba69Z4kuaYVaz67kNR4ia41JEicAgZZ2vWpmNUKGubWKwdedjich7w/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJjyUYxGk1icw2ynXk06WBLBY1Io7lCV36W3naFcURP4Ekc5behDLKkOQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.41203703703703703" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503477173" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJjyUYxGk1icw2ynXk06WBLBY1Io7lCV36W3naFcURP4Ekc5behDLKkOQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">OKï¼Œå®Œç¾å¤åˆ»ä¸”æ›´ä¼˜ç¾ï¼Œä½ å¯ä»¥ç”¨ä»£ç æ›¿æ¢ä»»æ„ç»“å±€å˜é‡ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#-----------8. ğŸ“ æ™ºèŸ table1 -----</span></span><span leaf=""><br></span><span leaf="">str(paper)</span><span leaf=""><br></span><span leaf="">convars &lt;- c(</span><span><span leaf="">"age"</span></span><span leaf="">,Â </span><span><span leaf="">"waist"</span></span><span leaf="">,Â </span><span><span leaf="">"sbp"</span></span><span leaf="">,Â </span><span><span leaf="">"dbp"</span></span><span leaf="">,Â </span><span><span leaf="">"tg"</span></span><span leaf="">,Â </span><span><span leaf="">"hdl"</span></span><span leaf="">,Â </span><span><span leaf="">"fbg"</span></span><span leaf="">,Â </span><span><span leaf="">"crp"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#--physical_activity &gt;40% åˆ é™¤æ­¤å˜é‡</span></span><span leaf=""><br></span><span leaf="">catvars &lt;- c(</span><span><span leaf="">"gender"</span></span><span leaf="">,Â </span><span><span leaf="">"residence"</span></span><span leaf="">,Â </span><span><span leaf="">"education"</span></span><span leaf="">,Â </span><span><span leaf="">"marital"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â </span><span><span leaf="">"smoking"</span></span><span leaf="">,Â </span><span><span leaf="">"drinking"</span></span><span leaf="">, Â </span><span><span leaf="">##"physical_activity"ç§»å‡º</span></span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â </span><span><span leaf="">"region"</span></span><span leaf="">,Â </span><span><span leaf="">"anti_htn"</span></span><span leaf="">,Â </span><span><span leaf="">"anti_dm"</span></span><span leaf="">,Â </span><span><span leaf="">"cooking_fuel_type"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">paper[convars] &lt;- lapply(paper[convars], as.numeric)</span><span leaf=""><br></span><span leaf="">paper[catvars] &lt;- lapply(paper[catvars], factor)</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-h5ay58" data-topic="1">#åˆ†ç»„yvar</a></span></span><span leaf=""><br></span><span leaf="">yvar =Â </span><span><span leaf="">"mets"</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0k-66qj1v" data-topic="1">#time</a>="ftime"</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0k-0wovg8" data-topic="1">#xvar</a>="sleeptime"</span></span><span leaf=""><br></span><span><span leaf=""># ç¡®ä¿ time å˜é‡ä¸åŒ…å«åœ¨ convars ä¸­!</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0k-wfmy4l" data-topic="1">#convars</a>Â &lt;- setdiff(convars, "time")</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-1fy2ij" data-topic="1">#é™¤äº†y</a>Â å’Œ timeå˜é‡= vars,xåœ¨varé‡Œé¢ï¼</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0k-an4wz0" data-topic="1">#vars</a>Â &lt;- c(catvars,convars)</span></span><span leaf=""><br></span><span><span leaf=""># covsæ˜¯æ’é™¤ä¸»è¦å› ç´  xvar</span></span><span leaf=""><br></span><span><span leaf="">#<a topic-id="mgi7mk0k-x696lx" data-topic="1">#covs</a>Â &lt;- setdiff(vars, xvar)</span></span><span leaf=""><br></span><span><span leaf=""># æŸ¥çœ‹ç¼ºå¤±æ¯”ä¾‹Â </span></span><span leaf=""><br></span><span leaf="">colMeans(is.na(paper[, c(convars, catvars, yvar)]))</span><span leaf=""><br></span><span leaf="">library(VIM)</span><span leaf=""><br></span><span leaf="">aggr(paper[, c(convars, catvars, yvar)], numbers = TRUE, prop = TRUE)</span><span leaf=""><br></span><span leaf="">â€¦</span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-md7k8x" data-topic="1">#æ‰§è¡Œ</a>Â 5 é‡æ’è¡¥ + åˆå¹¶ï¼ˆè¿ç»­å–å‡å€¼ã€å› å­å–ä¼—æ•°ï¼‰</span></span><span leaf=""><br></span><span leaf="">MI_data &lt;- fix_na(factorCols = factorCols, data = missdata, n = 5)</span><span leaf=""><br></span><span leaf="">paper_MI &lt;- paper</span><span leaf=""><br></span><span leaf="">paper_MI[, vars_use] &lt;- MI_data[, vars_use]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## ç®€å•æ£€æŸ¥ï¼Œç¼ºå¤±0</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-zj0nom" data-topic="1">#sapply</a>(MI_data[, convars], function(x) mean(is.na(x))) Â # è¿ç»­å˜é‡ç¼ºå¤±åº”æ¥è¿‘ 0</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-tzt54p" data-topic="1">#sapply</a>(MI_data[, factorCols], function(x) mean(is.na(x))) Â # å› å­ç¼ºå¤±åº”æ¥è¿‘ 0</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mgi7mk0k-fq8r5c" data-topic="1">#table</a>(paper_MI$mets, useNA = "ifany")</span></span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å››ã€å‘æ•£æ€ç»´</span></span><span></span></h2><blockquote><span><span leaf="">â€œ</span></span><p><span leaf="">1.<span textstyle="">ä»»æ„é˜Ÿåˆ—æˆ–å…¬å…±æ•°æ®åº“</span>å…¶å®éƒ½å¯ä»¥ç»“åˆchapè¿›è¡ŒPMç³»åˆ—æ¢ç´¢ï¼Œä¸Šæ¸¸æ˜¯ä¸‡èƒ½çš„ï¼Œä¸‹æ¸¸ç»“å±€ä»»æ„yå°±å¯æ— é™é‡å¤åˆ·æ–‡ç« ã€‚</span></p></blockquote><blockquote><span><span leaf="">â€œ</span></span><p><span leaf="">2.OR HR RRéƒ½å¯ä»¥ï¼ŒPMç³»åˆ—çš„é€‰æ‹©ä¹Ÿå¯ä»¥å¤šæ ·ï¼Œå¯ä»¥ä¼ ç»ŸaORã€aHRã€ä¹Ÿå¯å¹¿ä¹‰å€¾å‘è¯„åˆ†æ›´å‰æ²¿æŠ€æœ¯æ¢ç´¢<span textstyle="">PMç³»åˆ—å› æœæ¨æ–­(Bæ¬¾ç‰¹è‰²ï¼Œè¿‘æœŸçƒ­é—¨å‘æ–‡</span>)ã€‚</span></p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">3.å¤ç°charlsï¼ŒåŸæ–‡æ•°æ®ä¸ä¸€è‡´ï¼Œä¹Ÿæ˜¯å…¬å…±æ•°æ®åº“çŸ›ç›¾ä¹‹ä¸€ã€‚ä¸¥è°¨æº¯æºè€å¿ƒç¼ºä¸€ä¸å¯ã€‚Â </span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">4.æ¡ˆä¾‹è¿‡ç¨‹æˆç†Ÿæº¯æºï¼Œä¸¾ä¸€åä¸‰ï¼Œå®æˆ˜å…¬å…±æ•°æ®åº“ç³»åˆ—ï¼Œä¸”å¯å¤åˆ¶æ¨å¹¿è¶…å¤šideaå¤åˆ»ã€‚Bæ¬¾è¯¾ç¨‹æä¾›å…¬å…±æ•°æ®åº“è¯¦ç»†ä»‹ç»ä¸å‰æ²¿æ–¹æ³•ï¼Œè®©ä½ è„‘æ´å¤§å¼€ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">äº”ã€å°ç»“</span></span><span></span></h2><blockquote><span><span leaf="">â€œ</span></span><p><span leaf="">Charlsç­‰ç­‰å…¬å…±åº“+PM2.5ï¼Œç¯å¢ƒäº¤å‰å‘é«˜åˆ†ç¥å™¨ï¼Œè·Ÿç€ä»£ç ä¸€è·¯nextç‹‚å¥”å§ã€‚</span></p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨"><span data-mpa-action-id="mgi7oijg14b9" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">ç¦åˆ©</span>ï¼Œæœ¬æ–‡æ–‡çŒ®ä¸chapéƒ¨åˆ†ä»£ç è·å–æ–¹æ³•ï¼Œå‘é€å…¬ä¼—å·èŠå¤©ï¼š</span><span mpa-font-style="mgi7oiiyhjo"><span leaf="">1009</span></span></span></p></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJMh0rT0QhImQWXoQnvEI4RH0bbdpeawWDViadKQia9GUZMibSKS2SbaVGg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9981481481481481" data-s="300,640" data-type="png" data-w="540" type="block" data-imgfileid="503477145" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKHPCFouTTxfPxlhueCMcCDJMh0rT0QhImQWXoQnvEI4RH0bbdpeawWDViadKQia9GUZMibSKS2SbaVGg/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf=""><br></span></p><p><span leaf="">Â </span></p><p><span leaf=""><span textstyle="">æœ€åä¸º10æœˆåº•çš„Bæ¬¾æ‰“ä¸ªcallï¼Œè¶…çº§ç²¾å½©çº¦èµ·æ¥å§ï¼</span></span></p><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKGGZuqdTrgZNRx8rjQ4XshS5B4QfP3zvfsiaUMo17zq8SY1uJSgCNcrbbxcdJicNT1rVibamcjnuI46g/640?wx_fmt=png&amp;from=appmsg&amp;watermark=1#imgIndex=4" data-ratio="0.41759259259259257" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="503476987" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Zb9jB9p1cKGGZuqdTrgZNRx8rjQ4XshS5B4QfP3zvfsiaUMo17zq8SY1uJSgCNcrbbxcdJicNT1rVibamcjnuI46g/640?wx_fmt=png&amp;from=appmsg&amp;watermark=1#imgIndex=4"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span leaf="">ABç»Ÿè®¡ï¼ŒCå†™ä½œ</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Aæ¬¾ç»Ÿè®¡ä¹é˜³ç¥åŠŸï¼Œ<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxNTUzNDMyNQ==&amp;mid=2650957787&amp;idx=1&amp;sn=b8ac4502e4f58f9b3fc422424fb7b605&amp;scene=21#wechat_redirect" textvalue="ã€Šå®æˆ˜åŒ»å­¦ç»Ÿè®¡ç²¾å“è¯¾ç¨‹ã€‹Aæ¬¾-1æŠ˜ï¼ç²¾ç¾è¯¾ä»¶ä¸€é”®RåŒ…æ·±åº¦ç»Ÿè®¡é¢„æµ‹æ¨¡å‹å…¬å…±æ•°æ®åº“è§£æå¤ç°" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">ã€Šå®æˆ˜åŒ»å­¦ç»Ÿè®¡ç²¾å“è¯¾ç¨‹ã€‹Aæ¬¾-1æŠ˜ï¼ç²¾ç¾è¯¾ä»¶ä¸€é”®RåŒ…æ·±åº¦ç»Ÿè®¡é¢„æµ‹æ¨¡å‹å…¬å…±æ•°æ®åº“è§£æå¤ç°</span></a><span textstyle="">ã€‚</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Â Cæ¬¾å†™ä½œæ˜“ç­‹ç»ï¼Œ<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxNTUzNDMyNQ==&amp;mid=2650958439&amp;idx=1&amp;sn=116de541b21f4d6652f746f2b3f89c34&amp;scene=21#wechat_redirect" textvalue="ä»0åˆ°é¡¶åˆŠsciç²¾å“å†™ä½œè¯¾ç¨‹-å…¨ç½‘é¦–å‘" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">ä»0åˆ°é¡¶åˆŠsciç²¾å“å†™ä½œè¯¾ç¨‹-å…¨ç½‘é¦–å‘</span></a><span textstyle="">ã€‚Â </span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Bæ¬¾ç»Ÿè®¡ç‹¬å­¤ä¹å‰‘ï¼Œ<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxNTUzNDMyNQ==&amp;mid=2650960664&amp;idx=1&amp;sn=0451853a669fbacdc679409e13b752c2&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">çˆ†æ¬¾ï¼AI+RCT+çœŸå®ä¸–ç•Œ+å› æœæœºå™¨å­¦ä¹ +äº¤å‰å­¦ç§‘+çºµå‘æ•°æ®ï¼Œ150å°æ—¶</span></a>Â </span></p><p><span leaf=""><br></span></p><p><span leaf=""><br></span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/Zb9jB9p1cKG8hm4AQmFw4MEhbUWroVODSM6oRdH8y44mp2Tz05ZuoGlU9V6LJ4GCclbRw49C3e6Xu6lAXBTUuw/640?wx_fmt=jpeg&amp;watermark=1#imgIndex=22" data-ratio="0.29444444444444445" data-s="300,640" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/Zb9jB9p1cKG8hm4AQmFw4MEhbUWroVODSM6oRdH8y44mp2Tz05ZuoGlU9V6LJ4GCclbRw49C3e6Xu6lAXBTUuw/640?wx_fmt=jpeg&amp;watermark=1#imgIndex=22"></span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Zb9jB9p1cKGAAa124Ik6SAg6kXjw7NOVXKrDp4PMw7UW54MUVRCnNFCE5M7ibSlwHjEicOt4jSoicySYeLt8rPcKg/640?wx_fmt=gif#imgIndex=23" data-ratio="0.2777777777777778" data-type="gif" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_gif/Zb9jB9p1cKGAAa124Ik6SAg6kXjw7NOVXKrDp4PMw7UW54MUVRCnNFCE5M7ibSlwHjEicOt4jSoicySYeLt8rPcKg/640?wx_fmt=gif#imgIndex=23"></span></p><p><span leaf=""><br></span></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/NcxQhDFVo6Ge1Mia2OwQGQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
