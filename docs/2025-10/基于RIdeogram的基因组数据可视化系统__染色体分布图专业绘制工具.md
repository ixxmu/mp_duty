---
title: "基于RIdeogram的基因组数据可视化系统——染色体分布图专业绘制工具"
date: 2025-10-02T08:51:13Z
draft: ["false"]
tags: [
  "fetched",
  "小丫画图"
]
categories: ["Acdemic"]
---
基于RIdeogram的基因组数据可视化系统——染色体分布图专业绘制工具 by 小丫画图
------
<div><section data-pm-slice="2 2 []"><span leaf="">小丫碎碎念：发文章画了那么多矢量图，“写”矢量图还是第一次见。用R来“生成SVG代码”，而不是直接用R的绘图系统画图。<span textstyle="">像素级精准</span>控制每个图形元素的位置、颜色、大小等参数，而不是依赖R的默认布局。</span></section><section><span leaf="">继</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>雷达图</span><span leaf="">FigureYa8radarChart之后，作者又通过“写”矢量图的方式画了</span><span leaf="">FigureYa10chromosome。</span></section><section nodeleaf=""><img data-imgfileid="100002743" data-ratio="0.950925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58ga1picibThN1Iy96c2MibN5YKXQb2tAXgiaORzZNPSHuajEuWqrH81fY1uw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58ga1picibThN1Iy96c2MibN5YKXQb2tAXgiaORzZNPSHuajEuWqrH81fY1uw/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf="">可以到github查看</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>R脚本：</span><span leaf=""><br></span></section><section><span leaf="">https://github.com/TickingClock1992/RIdeogram/tree/master/R</span></section><section><span leaf="">作者把多种遗传学研究所需的染色体展示方式都画出来，写成了R包，跟着作者写的手册一步步操作即可：</span><span leaf="" data-pm-slice='1 1 ["para",null]'><br></span></section><p><span leaf="">https://cran.r-project.org/web/packages/RIdeogram/vignettes/RIdeogram.html</span></p><section><span leaf="" data-pm-slice='1 1 ["para",null]'>使用起来很方便，成为高被引</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>《<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5NjUyNzkxMg==&amp;mid=2247488569&amp;idx=1&amp;sn=0a283cae353ad0ef22524ed385e0a56e&amp;scene=21#wechat_redirect" textvalue="文章发表：画最好看的核型图" data-itemshowtype="0" linktype="text" data-linktype="2">文章发表：画最好看的核型图</a>》</span></section><section nodeleaf=""><img data-imgfileid="100002744" data-ratio="0.6851851851851852" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58gKIAbpq5aECzCkmjXnJNXPBEN0YZq2Jv0OoXDO7wS8bqb7PUTj61lSA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58gKIAbpq5aECzCkmjXnJNXPBEN0YZq2Jv0OoXDO7wS8bqb7PUTj61lSA/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100002741" data-ratio="0.31296296296296294" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58gIphps9KPahupU2ickibFAiaicQ9prZQMeice50pR67SFcGwVwCcwKuGliaicQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58gIphps9KPahupU2ickibFAiaicQ9prZQMeice50pR67SFcGwVwCcwKuGliaicQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100002742" data-ratio="0.6824074074074075" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58ggx2NsSHiakEDuX6mf414QPCL3RnjvvrZhBoNMjAGyhPHwXJZmqnJtLA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzcKrYmQYvUSLicDwuX5OL58ggx2NsSHiakEDuX6mf414QPCL3RnjvvrZhBoNMjAGyhPHwXJZmqnJtLA/640?wx_fmt=png&amp;from=appmsg"></section><hr><section><p><span leaf="">随着R包发布和更新，FigureYa10chromosomeV2_update的作用变成了带你管中窥豹，可见一斑。</span></p><p><span leaf=""><br></span></p><section><span leaf="">编辑：Kailai</span></section><h2 data-heading="true"><span leaf="">需求描述 requirement description</span></h2><p><span leaf="">用R代码画出paper里的直的染色体分布图</span></p><figure><span leaf=""><img data-imgfileid="100002446" data-ratio="0.7060931899641577" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzenYzFiclnaeJiaESqbzQZ0VFvpZkh49qZCnFZX7DPsZGKThmc04CjCWbn3eC9D13DdEA5CGadRYiaibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="837" title="null" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzenYzFiclnaeJiaESqbzQZ0VFvpZkh49qZCnFZX7DPsZGKThmc04CjCWbn3eC9D13DdEA5CGadRYiaibQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption></figcaption></figure><p><span leaf="">出自https://academic.oup.com/brain/article/138/3/616/333368</span></p><h2 data-heading="true"><span leaf="">应用场景 application scenario</span></h2><p><span leaf="">差异表达基因（RNA-seq）、开放染色质（DNase/ATAC-seq）、CTCF结合位点（ChIP-seq）、突变位点（WGS）或DNA甲基化（WGBS）在染色体上的分布，或者只是画Ideogram</span></p><h2 data-heading="true"><span leaf="">环境设置 environment setting</span></h2><pre><span hidden=""><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" width="45px" height="13px" viewbox="0 0 450 130"><ellipse cx="50" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"></ellipse><ellipse cx="225" cy="65" rx="50" ry="52" stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"></ellipse><ellipse cx="400" cy="65" rx="50" ry="52" stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"></ellipse></svg></span><code><span><span leaf=""><a topic-id="mg8xrron-tu800k" data-topic="1">#install</a>.packages("RIdeogram")</span></span><span leaf=""><br></span><span leaf="">library</span><span><span leaf="">(</span></span><span leaf="">RIdeogram</span><span><span leaf="">)</span></span><span leaf=""><br></span><span leaf="">Sys.setenv</span><span><span leaf="">(</span></span><span leaf="">LANGUAGE </span><span><span leaf="">=</span></span><span><span leaf="">"en"</span></span><span><span leaf="">)</span></span><span><span leaf=""><a topic-id="mg8xrroo-bnuk34" data-topic="1">#显示英文报错信息</a> display English error messages</span></span><span leaf=""><br></span><span leaf="">options</span><span><span leaf="">(</span></span><span leaf="">stringsAsFactors </span><span><span leaf="">=</span></span><span><span leaf="">FALSE</span></span><span><span leaf="">)</span></span><span><span leaf=""><a topic-id="mg8xrroo-p2kajl" data-topic="1">#禁止chr转成factor</a> prohibit the conversion of chr to factor</span></span></code></pre><h2 data-heading="true"><span leaf="">输入文件 Input file</span></h2><p><span leaf="">三个输入文件，其中第一个文件必需提供，第二和第三个文件非必需：</span></p><ul><li><section><span leaf="">• karyotype.csv，用于画染色体轮廓。包含五列：第一列为染色体名，第二、三列为染色体的起始和终止点。如果能提供着丝粒的开始和结束位置，就给出第四列（起始）和第五列（终止），如果着丝粒位置未知，就只给前三列。0-based基因组坐标(以0-based开始、1-based结束)。</span></section></li><li><section><span leaf="">• easy_input_heatmap.csv，用来绘制染色体heatmap。包含四列，第一列染色体名，第二、三列为染色体上的位置，第四列为相应位置上的值。例如差异基因的log2foldchange、甲基化水平等。</span></section></li><li><section><span leaf="">• easy_input_mark.csv，如果想画染色体旁边的形状标记，就要提供这个文件。包含六列，第一列type，第二列形状（只支持三种形状：box正方形、triangle三角形和circle圆。如果需要标记的特征超过3种，就用第六列里的颜色区分吧，例如红色的三角形，蓝色的三角形等），第三列染色体，第四、五列染色体上的位置，第六列颜色。**注意：**同一type对应的颜色一致。</span></section></li></ul><pre><span hidden=""><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" width="45px" height="13px" viewbox="0 0 450 130"><ellipse cx="50" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"></ellipse><ellipse cx="225" cy="65" rx="50" ry="52" stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"></ellipse><ellipse cx="400" cy="65" rx="50" ry="52" stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"></ellipse></svg></span><code><span><span leaf=""># 染色体长度、中心粒位置</span></span><span leaf=""><br></span><span><span leaf=""># chromosome length, centromere position</span></span><span leaf=""><br></span><span leaf="">karyotype </span><span><span leaf="">&lt;-</span></span><span leaf=""> read.csv</span><span><span leaf="">(</span></span><span><span leaf="">"karyotype.csv"</span></span><span><span leaf="">)</span></span><span leaf=""><br></span><span leaf="">karyotype</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 染色体上的heatmap</span></span><span leaf=""><br></span><span><span leaf=""># heatmap on chromosomes</span></span><span leaf=""><br></span><span leaf="">gene_density </span><span><span leaf="">&lt;-</span></span><span leaf=""> read.csv</span><span><span leaf="">(</span></span><span><span leaf="">"easy_input_heatmap.csv"</span></span><span><span leaf="">)</span></span><span leaf=""><br></span><span leaf="">head</span><span><span leaf="">(</span></span><span leaf="">gene_density</span><span><span leaf="">)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 染色体旁边的形状标记</span></span><span leaf=""><br></span><span><span leaf=""># shape markers next to chromosomes</span></span><span leaf=""><br></span><span leaf="">Random_RNAs_500 </span><span><span leaf="">&lt;-</span></span><span leaf=""> read.csv</span><span><span leaf="">(</span></span><span><span leaf="">"easy_input_mark.csv"</span></span><span><span leaf="">)</span></span><span leaf=""><br></span><span leaf="">head</span><span><span leaf="">(</span></span><span leaf="">Random_RNAs_500</span><span><span leaf="">)</span></span></code></pre><h2 data-heading="true"><span leaf="">开始画图 Start drawing</span></h2><pre><span hidden=""><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" width="45px" height="13px" viewbox="0 0 450 130"><ellipse cx="50" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"></ellipse><ellipse cx="225" cy="65" rx="50" ry="52" stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"></ellipse><ellipse cx="400" cy="65" rx="50" ry="52" stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"></ellipse></svg></span><code><span leaf="">ideogram</span><span><span leaf="">(</span></span><span leaf="">karyotype </span><span><span leaf="">=</span></span><span leaf=""> karyotype</span><span><span leaf="">,</span></span><span leaf="">         </span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-7a4sqd" data-topic="1">#如果没提供easy</a>_input_heatmap.csv，就在下面两行前面加#</span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-9jxqal" data-topic="1">#If</a> easy_input_heatmap.csv is not provided, precede the following two lines with#</span></span><span leaf="">         overlaid </span><span><span leaf="">=</span></span><span leaf=""> gene_density</span><span><span leaf="">,</span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-jyuvkm" data-topic="1">#染色体上heatmap的配色</a></span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-9b55zx" data-topic="1">#color</a> matching of heatmap on chromosomes</span></span><span leaf="">         colorset1 </span><span><span leaf="">=</span></span><span><span leaf="">c</span></span><span><span leaf="">(</span></span><span><span leaf="">"forestgreen"</span></span><span><span leaf="">,</span></span><span><span leaf="">"gold"</span></span><span><span leaf="">,</span></span><span><span leaf="">"deeppink3"</span></span><span><span leaf="">)</span></span><span><span leaf="">,</span></span><span leaf="">         </span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-8x6999" data-topic="1">#如果没提供easy</a>_input_mark.csv，就在下面这行前面加#</span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-mstil8" data-topic="1">#If</a> easy_input_mark.csv is not provided, prefix the following line with#</span></span><span leaf="">         label </span><span><span leaf="">=</span></span><span leaf=""> Random_RNAs_500</span><span><span leaf="">,</span></span><span leaf="">         label_type </span><span><span leaf="">=</span></span><span><span leaf="">"marker"</span></span><span><span leaf="">,</span></span><span leaf="">         </span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-ixjmge" data-topic="1">#染色体宽度</a>，默认170</span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-kz2mg7" data-topic="1">#chromosome</a> width, default 170</span></span><span leaf="">         width </span><span><span leaf="">=</span></span><span><span leaf="">180</span></span><span><span leaf="">,</span></span><span><span leaf=""><a topic-id="mg8xrroo-2mo1za" data-topic="1">#注意</a>：太宽会跑出画布外面 Note: If it's too wide, it will extend beyond the canvas</span></span><span leaf="">         </span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-xc6m84" data-topic="1">#图例的位置</a></span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-yez722" data-topic="1">#position</a> of legend</span></span><span leaf="">         Lx </span><span><span leaf="">=</span></span><span><span leaf="">160</span></span><span><span leaf="">,</span></span><span><span leaf=""><a topic-id="mg8xrroo-ij5xj8" data-topic="1">#图例左上角跟左边的距离</a> distance from the top left corner of the legend to the left side</span></span><span leaf="">         Ly </span><span><span leaf="">=</span></span><span><span leaf="">20</span></span><span><span leaf="">,</span></span><span><span leaf=""><a topic-id="mg8xrroo-uk5bgb" data-topic="1">#图例左上角跟顶端的距离</a> distance from the upper left corner of the legend to the top </span></span><span leaf="">         </span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-fxdlk1" data-topic="1">#输出文件</a></span></span><span leaf="">         </span><span><span leaf=""><a topic-id="mg8xrroo-j8tpy5" data-topic="1">#output</a> file</span></span><span leaf="">         output </span><span><span leaf="">=</span></span><span><span leaf="">"chromosome.svg"</span></span><span><span leaf="">)</span></span><span><span leaf=""><a topic-id="mg8xrroo-aigkjn" data-topic="1">#只支持svg格式</a> only svg format is supported</span></span><span><span leaf=""># 可以转成png，方便查看</span></span><span><span leaf=""># It can be converted to png for easy viewing</span></span><span leaf="">convertSVG</span><span><span leaf="">(</span></span><span><span leaf="">"chromosome.svg"</span></span><span><span leaf="">,</span></span><span leaf=""> device </span><span><span leaf="">=</span></span><span><span leaf="">"png"</span></span><span><span leaf="">)</span></span></code></pre><h2 data-heading="true"><span leaf="">格式转换 format conversion</span></h2><p><span leaf="">运行完上面这段，当前文件夹里会生成一个“chromosome.svg”文件，是矢量图。可以用Inkscape、Illustrator等工具打开、编辑、转换成其他格式。</span></p><p><span leaf="">还可以运行下面这段把svg转成pdf或tiff、jpg、png等格式的文件</span></p><pre><span hidden=""><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" width="45px" height="13px" viewbox="0 0 450 130"><ellipse cx="50" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"></ellipse><ellipse cx="225" cy="65" rx="50" ry="52" stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"></ellipse><ellipse cx="400" cy="65" rx="50" ry="52" stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"></ellipse></svg></span><code><span><span leaf=""><a topic-id="mg8xrroo-nn6ooo" data-topic="1">#svg2pdf或svg2tiff</a>、svg2jpg、svg2png</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mg8xrroo-scux1v" data-topic="1">#svg2pdf</a> or svg2tiff、svg2jpg、svg2png</span></span><span leaf=""><br></span><span leaf="">svg2pdf</span><span><span leaf="">(</span></span><span><span leaf="">"chromosome.svg"</span></span><span><span leaf="">,</span></span><span leaf=""><br></span><span leaf="">        width </span><span><span leaf="">=</span></span><span><span leaf="">12</span></span><span><span leaf="">,</span></span><span leaf=""> height </span><span><span leaf="">=</span></span><span><span leaf="">8</span></span><span><span leaf="">,</span></span><span><span leaf=""><a topic-id="mg8xrroo-550aoo" data-topic="1">#画布大小</a> canvas size</span></span><span leaf=""><br></span><span leaf="">        dpi </span><span><span leaf="">=</span></span><span><span leaf="">300</span></span><span><span leaf="">)</span></span></code></pre><figure><span leaf=""><img data-imgfileid="100002445" data-ratio="0.5842592592592593" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzenYzFiclnaeJiaESqbzQZ0VFibRvBqEtnRyhpysS4upIIOc9Jz74ZBPMODaWLMNEGibB00BgMo2YSL8g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" title="null" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzenYzFiclnaeJiaESqbzQZ0VFibRvBqEtnRyhpysS4upIIOc9Jz74ZBPMODaWLMNEGibB00BgMo2YSL8g/640?wx_fmt=png&amp;from=appmsg"></span><span data-pm-slice="0 0 []"><section data-pm-slice="5 3 []"><section><figure><span data-pm-slice="0 0 []"><section data-pm-slice='5 3 ["para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"figure","attributes":{"style":"box-sizing: border-box; border-width: 0px; border-style: solid; border-color: hsl(var(--border)); margin: 1.5em 8px; text-align: left; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, \"Helvetica Neue\", \"PingFang SC\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif; font-size: 16px; color: rgb(63, 63, 63);"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"color: rgb(31, 35, 40); font-family: -apple-system, \"system-ui\", \"Segoe UI\", \"Noto Sans\", Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\"; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;","data-pm-slice":"0 0 []"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><section><span data-pm-slice="0 0 []"><h1 tabindex="-1" dir="auto" data-pm-slice="0 0 []"><span leaf="">代码及输入、输出文件</span></h1></span></section><p><span leaf="">https://github.com/ying-ge/FigureYa/tree/main/</span><span leaf="">FigureYa10chromosomeV2_update</span></p></section></span></figure></section><h1 tabindex="-1" dir="auto" data-pm-slice="0 0 []"><span leaf="">Citation</span></h1><section><span data-pm-slice="0 0 []"><span leaf="">Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005</span></span></section><section><span leaf=""><br></span></section><section><span leaf="">Hao Z, Lv D, Ge Y, Shi J, Weijers D, Yu G, Chen J. 2020. RIdeogram: drawing SVG graphics to visualize and map genome-wide data on the idiograms. PeerJ Comput. Sci. 6:e251 http://doi.org/10.7717/peerj-cs.251</span></section></section></span></figure></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Txmv60Uju5ncrXLz9rbpBg",target="_blank" rel="noopener noreferrer">原文链接</a>
