---
title: "了解自己的本地数据库 - org.Hs.eg.db"
date: 2025-10-07T14:54:13Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
了解自己的本地数据库 - org.Hs.eg.db by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">org.Hs.eg.db 是Bioconductor 平台专为R语言打造的人类基因注释数据包，可以理解为本地化的小型基因数据库。它集成了NCBI等权威资源的人类基因基础信息，包括基因ID、基因符号、染色体位置、功能注释（如GO、KEGG）等内容。</span></p><p data-tool="mdnice编辑器"><span leaf="">作为一个结构化的数据包，org.Hs.eg.db不 仅支持在R环境下高效检索和转换基因信息，还广泛兼容常用的生物信息学分析工具。无论是开展基因功能富集、注释分析，还是进行基因ID标准化，org.Hs.eg.db 都能为生信工作者提供快速、可靠的数据支持，使基因注释的获取变得如调用一个小型数据库般高效便捷。</span></p><p data-tool="mdnice编辑器"><span leaf="">这次我们深度解析一下这个</span><code><span leaf="">"小型数据库"</span></code><span leaf="">。</span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">安装加载包</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">第一步就是通用的安装加载方法啦。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">if</span></span><span leaf=""> (!</span><span><span leaf="">require</span></span><span leaf="">(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">, quietly = </span><span><span leaf="">TRUE</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">    install.packages(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">BiocManager::install(</span><span><span leaf="">"org.Hs.eg.db"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(org.Hs.eg.db)</span><span leaf=""><br></span></code></pre><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">初步了解结构</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">查看该包都提供了哪些对象和方法：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; ls(</span><span><span leaf="">"package:org.Hs.eg.db"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.eg"</span></span><span leaf="">                </span><span><span leaf="">"org.Hs.eg_dbconn"</span></span><span leaf="">        </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">3</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.eg_dbfile"</span></span><span leaf="">         </span><span><span leaf="">"org.Hs.eg_dbInfo"</span></span><span leaf="">        </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">5</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.eg_dbschema"</span></span><span leaf="">       </span><span><span leaf="">"org.Hs.eg.db"</span></span><span leaf="">            </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">7</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egACCNUM"</span></span><span leaf="">          </span><span><span leaf="">"org.Hs.egACCNUM2EG"</span></span><span leaf="">      </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">9</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egALIAS2EG"</span></span><span leaf="">        </span><span><span leaf="">"org.Hs.egCHR"</span></span><span leaf="">            </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">11</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egCHRLENGTHS"</span></span><span leaf="">      </span><span><span leaf="">"org.Hs.egCHRLOC"</span></span><span leaf="">         </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">13</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egCHRLOCEND"</span></span><span leaf="">       </span><span><span leaf="">"org.Hs.egENSEMBL"</span></span><span leaf="">        </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">15</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egENSEMBL2EG"</span></span><span leaf="">      </span><span><span leaf="">"org.Hs.egENSEMBLPROT"</span></span><span leaf="">    </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">17</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egENSEMBLPROT2EG"</span></span><span><span leaf="">"org.Hs.egENSEMBLTRANS"</span></span><span leaf="">   </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">19</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egENSEMBLTRANS2EG"</span></span><span><span leaf="">"org.Hs.egENZYME"</span></span><span leaf="">         </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">21</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egENZYME2EG"</span></span><span leaf="">       </span><span><span leaf="">"org.Hs.egGENENAME"</span></span><span leaf="">       </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">23</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egGENETYPE"</span></span><span leaf="">        </span><span><span leaf="">"org.Hs.egGO"</span></span><span leaf="">             </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">25</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egGO2ALLEGS"</span></span><span leaf="">       </span><span><span leaf="">"org.Hs.egGO2EG"</span></span><span leaf="">          </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">27</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egMAP"</span></span><span leaf="">             </span><span><span leaf="">"org.Hs.egMAP2EG"</span></span><span leaf="">         </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">29</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egMAPCOUNTS"</span></span><span leaf="">       </span><span><span leaf="">"org.Hs.egOMIM"</span></span><span leaf="">           </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">31</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egOMIM2EG"</span></span><span leaf="">         </span><span><span leaf="">"org.Hs.egORGANISM"</span></span><span leaf="">       </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">33</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egPATH"</span></span><span leaf="">            </span><span><span leaf="">"org.Hs.egPATH2EG"</span></span><span leaf="">        </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">35</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egPFAM"</span></span><span leaf="">            </span><span><span leaf="">"org.Hs.egPMID"</span></span><span leaf="">           </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">37</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egPMID2EG"</span></span><span leaf="">         </span><span><span leaf="">"org.Hs.egPROSITE"</span></span><span leaf="">        </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">39</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egREFSEQ"</span></span><span leaf="">          </span><span><span leaf="">"org.Hs.egREFSEQ2EG"</span></span><span leaf="">      </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">41</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egSYMBOL"</span></span><span leaf="">          </span><span><span leaf="">"org.Hs.egSYMBOL2EG"</span></span><span leaf="">      </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">43</span></span><span leaf="">] </span><span><span leaf="">"org.Hs.egUCSCKG"</span></span><span leaf="">          </span><span><span leaf="">"org.Hs.egUNIPROT"</span></span><span leaf="">  </span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">可以发现，这个包还是有很多对象和函数存在，其中主要包含以下映射：</span></p><section data-tool="mdnice编辑器"><table><thead><tr><th data-colwidth="202"><font><span leaf="">org.Hs.egACCNUM</span></font></th><th><font><span leaf="">Entrez基因ID与GenBank登录号的映射</span></font></th></tr></thead><tbody><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egALIAS2EG</span></font></td><td><font><span leaf="">常用基因别名与Entrez基因ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.eg.db</span></font></td><td><font><span leaf="">Bioconductor注释数据包</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egCHR</span></font></td><td><font><span leaf="">Entrez基因ID与染色体的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egCHRLENGTHS</span></font></td><td><font><span leaf="">各染色体长度的命名向量</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egCHRLOC</span></font></td><td><font><span leaf="">Entrez基因ID与染色体定位的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egENSEMBL</span></font></td><td><font><span leaf="">Ensembl基因ID与Entrez基因ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egENSEMBLPROT</span></font></td><td><font><span leaf="">Ensembl蛋白ID与Entrez基因ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egENSEMBLTRANS</span></font></td><td><font><span leaf="">Ensembl转录本ID与Entrez基因ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egENZYME</span></font></td><td><font><span leaf="">Entrez基因ID与酶委员会(EC)编号的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egGENENAME</span></font></td><td><font><span leaf="">Entrez基因ID与基因全名的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egGENETYPE</span></font></td><td><font><span leaf="">Entrez基因ID与基因类型的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egGO</span></font></td><td><font><span leaf="">Entrez基因ID与基因本体论（GO）ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egMAP</span></font></td><td><font><span leaf="">Entrez基因ID与细胞遗传图谱/染色体带的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egMAPCOUNTS</span></font></td><td><font><span leaf="">各类注释映射的对应条目数量</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egOMIM</span></font></td><td><font><span leaf="">Entrez基因ID与人类孟德尔遗传(MIM)号的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egORGANISM</span></font></td><td><font><span leaf="">本注释包所对应的物种（人类）</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egPATH</span></font></td><td><font><span leaf="">Entrez基因ID与KEGG通路ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egPFAM</span></font></td><td><font><span leaf="">Entrez基因ID与PFAM蛋白家族ID的映射（已废弃）</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egPMID</span></font></td><td><font><span leaf="">Entrez基因ID与PubMed文献ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egPROSITE</span></font></td><td><font><span leaf="">Entrez基因ID与PROSITE蛋白结构域ID的映射（已废弃）</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egREFSEQ</span></font></td><td><font><span leaf="">Entrez基因ID与RefSeq序列号的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egSYMBOL</span></font></td><td><font><span leaf="">Entrez基因ID与标准基因符号的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egUCSCKG</span></font></td><td><font><span leaf="">UCSC Known Gene登录号与Entrez基因ID的映射（已弃用）</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.egUNIPROT</span></font></td><td><font><span leaf="">UniProt蛋白ID与Entrez基因ID的映射</span></font></td></tr><tr><td data-colwidth="202"><font><span leaf="">org.Hs.eg_dbconn</span></font></td><td><font><span leaf="">收集注释数据库相关信息</span></font></td></tr></tbody></table></section><p data-tool="mdnice编辑器"><font><span leaf="">这些数据对象是一种 AnnDbBimap 对象，是 Bioconductor 注释包（如 org.Hs.eg.db、org.Mm.eg.db、org.Hs.eg.db 等）中用于存储双向映射关系（双向字典/bimap）的一种特殊R对象。它主要用于基因ID、符号、数据库编号、注释和其他生物信息学ID之间的高效、灵活的映射和查询。</span></font></p><p data-tool="mdnice编辑器"><font><span leaf="">可以转换为 </span></font><code><span leaf="">&lt;font style="color:rgb(29, 28, 27);"&gt;list&lt;/font&gt;</span></code><font><span leaf=""> 格式进行查看:</span></font></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; class(org.Hs.egSYMBOL)</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"AnnDbBimap"</span></span><span leaf=""><br></span><span leaf="">attr(,</span><span><span leaf="">"package"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"AnnotationDbi"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">&gt; as.list(org.Hs.egSYMBOL)[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">5</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">$`1`</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"A1BG"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">$`2`</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"A2M"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">$`3`</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"A2MP1"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">$`9`</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"NAT1"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">$`10`</span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"NAT2"</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">从数据结构中看出，都是以 </span><font><span leaf="">Entrez 基因为映射的结构，可以看到 Entrez基因ID 1 对应的 SYMBOL ID 就是 A1BG。</span></font></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><font><span leaf="">R 通用注释接口</span></font></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">org.Hs.eg.db 本身不是“函数”，是注释数据对象。这些一系列的对象和映射表，需要通过</span><font><span leaf="">R 里的通用注释接口（如 </span></font><code><span leaf="">select()</span></code><font><span leaf="">、</span></font><code><span leaf="">keys()</span></code><font><span leaf="">、</span></font><code><span leaf="">columns()</span></code><font><span leaf="">）或直接操作映射对象来用它。</span></font></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; columns(org.Hs.eg.db)</span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"ACCNUM"</span></span><span leaf="">       </span><span><span leaf="">"ALIAS"</span></span><span leaf="">        </span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">      </span><span><span leaf="">"ENSEMBLPROT"</span></span><span><span leaf="">"ENSEMBLTRANS"</span></span><span><span leaf="">"ENTREZID"</span></span><span leaf="">    </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">7</span></span><span leaf="">] </span><span><span leaf="">"ENZYME"</span></span><span leaf="">       </span><span><span leaf="">"EVIDENCE"</span></span><span leaf="">     </span><span><span leaf="">"EVIDENCEALL"</span></span><span><span leaf="">"GENENAME"</span></span><span leaf="">     </span><span><span leaf="">"GENETYPE"</span></span><span leaf="">     </span><span><span leaf="">"GO"</span></span><span leaf="">          </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">13</span></span><span leaf="">] </span><span><span leaf="">"GOALL"</span></span><span leaf="">        </span><span><span leaf="">"IPI"</span></span><span leaf="">          </span><span><span leaf="">"MAP"</span></span><span leaf="">          </span><span><span leaf="">"OMIM"</span></span><span leaf="">         </span><span><span leaf="">"ONTOLOGY"</span></span><span leaf="">     </span><span><span leaf="">"ONTOLOGYALL"</span></span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">19</span></span><span leaf="">] </span><span><span leaf="">"PATH"</span></span><span leaf="">         </span><span><span leaf="">"PFAM"</span></span><span leaf="">         </span><span><span leaf="">"PMID"</span></span><span leaf="">         </span><span><span leaf="">"PROSITE"</span></span><span leaf="">      </span><span><span leaf="">"REFSEQ"</span></span><span leaf="">       </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">      </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">25</span></span><span leaf="">] </span><span><span leaf="">"UCSCKG"</span></span><span leaf="">       </span><span><span leaf="">"UNIPROT"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">&gt; keytypes(org.Hs.eg.db)</span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"ACCNUM"</span></span><span leaf="">       </span><span><span leaf="">"ALIAS"</span></span><span leaf="">        </span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">      </span><span><span leaf="">"ENSEMBLPROT"</span></span><span><span leaf="">"ENSEMBLTRANS"</span></span><span><span leaf="">"ENTREZID"</span></span><span leaf="">    </span><span leaf=""><br></span><span leaf=""> [</span><span><span leaf="">7</span></span><span leaf="">] </span><span><span leaf="">"ENZYME"</span></span><span leaf="">       </span><span><span leaf="">"EVIDENCE"</span></span><span leaf="">     </span><span><span leaf="">"EVIDENCEALL"</span></span><span><span leaf="">"GENENAME"</span></span><span leaf="">     </span><span><span leaf="">"GENETYPE"</span></span><span leaf="">     </span><span><span leaf="">"GO"</span></span><span leaf="">          </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">13</span></span><span leaf="">] </span><span><span leaf="">"GOALL"</span></span><span leaf="">        </span><span><span leaf="">"IPI"</span></span><span leaf="">          </span><span><span leaf="">"MAP"</span></span><span leaf="">          </span><span><span leaf="">"OMIM"</span></span><span leaf="">         </span><span><span leaf="">"ONTOLOGY"</span></span><span leaf="">     </span><span><span leaf="">"ONTOLOGYALL"</span></span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">19</span></span><span leaf="">] </span><span><span leaf="">"PATH"</span></span><span leaf="">         </span><span><span leaf="">"PFAM"</span></span><span leaf="">         </span><span><span leaf="">"PMID"</span></span><span leaf="">         </span><span><span leaf="">"PROSITE"</span></span><span leaf="">      </span><span><span leaf="">"REFSEQ"</span></span><span leaf="">       </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">      </span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">25</span></span><span leaf="">] </span><span><span leaf="">"UCSCKG"</span></span><span leaf="">       </span><span><span leaf="">"UNIPROT"</span></span><span leaf="">  </span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">虽然两个结构输出的内容是一样的，但实际上，这两个函数在设计意义上是有区别的。</span></p><ul><li><section><code><span leaf="">keytypes()</span></code><font><span leaf=""> ：你能用哪些类型作为检索的关键字</span></font></section></li><li><section><code><span leaf="">columns()</span></code><font><span leaf=""> ：你能输出哪些数据内容</span></font></section></li></ul><p data-tool="mdnice编辑器"><font><span leaf="">大多数数据库（如 GO.db、KEGG.db、其他 OrganismDb包）这二者可能有差别。比如 GENENAME 通常是内容而不是检索ID。但 org.Hs.eg.db 这个包做得很全，它所有内容都可以索引查询，所以看起来一模一样。</span></font></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><font><span leaf="">核心用法</span></font></span><span></span></h2><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">获取所有可用的基因ID</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; all_entrez &lt;- keys(org.Hs.eg.db, keytype = </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">&gt; length(all_entrez)  </span><span><span leaf=""># 看看有多少</span></span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">193279</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">&gt; head(all_entrez)    </span><span><span leaf=""># 看前几个</span></span><span leaf=""><br></span><span leaf="">[</span><span><span leaf="">1</span></span><span leaf="">] </span><span><span leaf="">"A1BG"</span></span><span leaf="">  </span><span><span leaf="">"A2M"</span></span><span leaf="">   </span><span><span leaf="">"A2MP1"</span></span><span leaf=""> </span><span><span leaf="">"NAT1"</span></span><span leaf="">  </span><span><span leaf="">"NAT2"</span></span><span leaf="">  </span><span><span leaf="">"NATP"</span></span><span leaf=""> </span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">查询注释</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这是最核心的功能。用 select() 可批量查注释：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; select(org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">+        keys = c(</span><span><span leaf="">"1"</span></span><span leaf="">, </span><span><span leaf="">"2"</span></span><span leaf="">, </span><span><span leaf="">"3"</span></span><span leaf="">, </span><span><span leaf="">"9"</span></span><span leaf="">, </span><span><span leaf="">"10"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">+        keytype = </span><span><span leaf="">"ENTREZID"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">+        columns = c(</span><span><span leaf="">"SYMBOL"</span></span><span leaf="">, </span><span><span leaf="">"GENENAME"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">'select()'</span></span><span leaf=""> returned </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">1</span></span><span leaf=""> mapping between keys and columns</span><span leaf=""><br></span><span leaf="">  ENTREZID SYMBOL                           GENENAME</span><span leaf=""><br></span><span><span leaf="">1</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf="">   A1BG             alpha-</span><span><span leaf="">1</span></span><span leaf="">-B glycoprotein</span><span leaf=""><br></span><span><span leaf="">2</span></span><span leaf="">        </span><span><span leaf="">2</span></span><span leaf="">    A2M              alpha-</span><span><span leaf="">2</span></span><span leaf="">-macroglobulin</span><span leaf=""><br></span><span><span leaf="">3</span></span><span leaf="">        </span><span><span leaf="">3</span></span><span leaf="">  A2MP1 alpha-</span><span><span leaf="">2</span></span><span leaf="">-macroglobulin pseudogene </span><span><span leaf="">1</span></span><span leaf=""><br></span><span><span leaf="">4</span></span><span leaf="">        </span><span><span leaf="">9</span></span><span leaf="">   NAT1              N-acetyltransferase </span><span><span leaf="">1</span></span><span leaf=""><br></span><span><span leaf="">5</span></span><span leaf="">       </span><span><span leaf="">10</span></span><span leaf="">   NAT2              N-acetyltransferase </span><span><span leaf="">2</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">select() 直接返回的就是一个 </span><code><span leaf="">data.frame</span></code><span leaf="">。</span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><font><span leaf="">查询GO注释</span></font></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; select(org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">+        keys = c(</span><span><span leaf="">"1"</span></span><span leaf="">, </span><span><span leaf="">"2"</span></span><span leaf="">, </span><span><span leaf="">"3"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">+        keytype = </span><span><span leaf="">"ENTREZID"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">+        columns = c(</span><span><span leaf="">"GO"</span></span><span leaf="">, </span><span><span leaf="">"ONTOLOGY"</span></span><span leaf="">, </span><span><span leaf="">"EVIDENCE"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">'select()'</span></span><span leaf=""> returned </span><span><span leaf="">1</span></span><span leaf="">:many mapping between keys and columns</span><span leaf=""><br></span><span leaf="">   ENTREZID         GO ONTOLOGY EVIDENCE</span><span leaf=""><br></span><span><span leaf="">1</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0003674</span></span><span leaf="">       MF       ND</span><span leaf=""><br></span><span><span leaf="">2</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0005576</span></span><span leaf="">       CC      HDA</span><span leaf=""><br></span><span><span leaf="">3</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0005576</span></span><span leaf="">       CC      IDA</span><span leaf=""><br></span><span><span leaf="">4</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0005576</span></span><span leaf="">       CC      TAS</span><span leaf=""><br></span><span><span leaf="">5</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0005615</span></span><span leaf="">       CC      HDA</span><span leaf=""><br></span><span><span leaf="">6</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0005886</span></span><span leaf="">       CC      IBA</span><span leaf=""><br></span><span><span leaf="">7</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0008150</span></span><span leaf="">       BP       ND</span><span leaf=""><br></span><span><span leaf="">8</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0031093</span></span><span leaf="">       CC      TAS</span><span leaf=""><br></span><span><span leaf="">9</span></span><span leaf="">         </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0034774</span></span><span leaf="">       CC      TAS</span><span leaf=""><br></span><span><span leaf="">10</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0062023</span></span><span leaf="">       CC      HDA</span><span leaf=""><br></span><span><span leaf="">11</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0070062</span></span><span leaf="">       CC      HDA</span><span leaf=""><br></span><span><span leaf="">12</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">0072562</span></span><span leaf="">       CC      HDA</span><span leaf=""><br></span><span><span leaf="">13</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf=""> GO:</span><span><span leaf="">1904813</span></span><span leaf="">       CC      TAS</span><span leaf=""><br></span><span><span leaf="">14</span></span><span leaf="">        </span><span><span leaf="">2</span></span><span leaf=""> GO:</span><span><span leaf="">0001553</span></span><span leaf="">       BP      IEA</span><span leaf=""><br></span><span><span leaf="">15</span></span><span leaf="">        </span><span><span leaf="">2</span></span><span leaf=""> GO:</span><span><span leaf="">0001869</span></span><span leaf="">       BP      IDA</span><span leaf=""><br></span><span><span leaf="">16</span></span><span leaf="">        </span><span><span leaf="">2</span></span><span leaf=""> GO:</span><span><span leaf="">0002020</span></span><span leaf="">       MF      IBA</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">查询基因名转ID</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; select(org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">+        keys = c(</span><span><span leaf="">"TP53"</span></span><span leaf="">, </span><span><span leaf="">"BRCA1"</span></span><span leaf="">, </span><span><span leaf="">"GAPDH"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">+        keytype = </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">+        columns = c(</span><span><span leaf="">"ENTREZID"</span></span><span leaf="">, </span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">'select()'</span></span><span leaf=""> returned </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">1</span></span><span leaf=""> mapping between keys and columns</span><span leaf=""><br></span><span leaf="">  SYMBOL ENTREZID         ENSEMBL</span><span leaf=""><br></span><span><span leaf="">1</span></span><span leaf="">   TP53     </span><span><span leaf="">7157</span></span><span leaf=""> ENSG00000141510</span><span leaf=""><br></span><span><span leaf="">2</span></span><span leaf="">  BRCA1      </span><span><span leaf="">672</span></span><span leaf=""> ENSG00000012048</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">查询染色体、基因描述</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; select(org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">+        keys = c(</span><span><span leaf="">"7157"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">+        keytype = </span><span><span leaf="">"ENTREZID"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">+        columns = c(</span><span><span leaf="">"SYMBOL"</span></span><span leaf="">, </span><span><span leaf="">"CHR"</span></span><span leaf="">, </span><span><span leaf="">"GENENAME"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">'select()'</span></span><span leaf=""> returned </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">1</span></span><span leaf=""> mapping between keys and columns</span><span leaf=""><br></span><span leaf="">  ENTREZID SYMBOL CHR          GENENAME</span><span leaf=""><br></span><span><span leaf="">1</span></span><span leaf="">     </span><span><span leaf="">7157</span></span><span leaf="">   TP53  </span><span><span leaf="">17</span></span><span leaf=""> tumor protein p53</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">获得全部symbol-EntrezID注释表</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; df &lt;- select(org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">+              keys = keys(org.Hs.eg.db, keytype=</span><span><span leaf="">"ENTREZID"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">+              keytype = </span><span><span leaf="">"ENTREZID"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">+              columns = c(</span><span><span leaf="">"SYMBOL"</span></span><span leaf="">, </span><span><span leaf="">"GENENAME"</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">'select()'</span></span><span leaf=""> returned </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">1</span></span><span leaf=""> mapping between keys and columns</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">&gt; head(df)</span><span leaf=""><br></span><span leaf="">  ENTREZID SYMBOL                           GENENAME</span><span leaf=""><br></span><span><span leaf="">1</span></span><span leaf="">        </span><span><span leaf="">1</span></span><span leaf="">   A1BG             alpha-</span><span><span leaf="">1</span></span><span leaf="">-B glycoprotein</span><span leaf=""><br></span><span><span leaf="">2</span></span><span leaf="">        </span><span><span leaf="">2</span></span><span leaf="">    A2M              alpha-</span><span><span leaf="">2</span></span><span leaf="">-macroglobulin</span><span leaf=""><br></span><span><span leaf="">3</span></span><span leaf="">        </span><span><span leaf="">3</span></span><span leaf="">  A2MP1 alpha-</span><span><span leaf="">2</span></span><span leaf="">-macroglobulin pseudogene </span><span><span leaf="">1</span></span><span leaf=""><br></span><span><span leaf="">4</span></span><span leaf="">        </span><span><span leaf="">9</span></span><span leaf="">   NAT1              N-acetyltransferase </span><span><span leaf="">1</span></span><span leaf=""><br></span><span><span leaf="">5</span></span><span leaf="">       </span><span><span leaf="">10</span></span><span leaf="">   NAT2              N-acetyltransferase </span><span><span leaf="">2</span></span><span leaf=""><br></span></code></pre></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/eXVRpKFCRjQghGad2AVAKw",target="_blank" rel="noopener noreferrer">原文链接</a>
