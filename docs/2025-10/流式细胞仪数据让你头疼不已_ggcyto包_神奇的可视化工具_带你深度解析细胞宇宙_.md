---
title: "流式细胞仪数据让你头疼不已？ggcyto包！神奇的可视化工具，带你深度解析细胞宇宙！"
date: 2025-10-07T12:15:53Z
draft: ["false"]
tags: [
  "fetched",
  "云生信"
]
categories: ["Acdemic"]
---
流式细胞仪数据让你头疼不已？ggcyto包！神奇的可视化工具，带你深度解析细胞宇宙！ by 云生信
------
<div><section data-mpa-powered-by="yiban.io" nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.2222222222222222" data-s="300,640" data-type="jpeg" data-w="900" data-croporisrc="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/0?wx_fmt=jpeg&amp;from=appmsg" data-cropselx2="578" data-cropsely2="128" data-imgfileid="100012638" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section><span><span leaf=""><img data-imgfileid="100009825" data-ratio="0.25092592592592594" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticUfibfXtSWs6Yhy29icibeC9DCYVhULpmOb0lpSw8NjHPibG14HHbDsiaojA/640?wx_fmt=png" data-type="png" data-w="1080" height="138.74000549316406" width="553.739990234375" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticUfibfXtSWs6Yhy29icibeC9DCYVhULpmOb0lpSw8NjHPibG14HHbDsiaojA/640?wx_fmt=png"></span></span></section><section><span><span leaf="">今天师妹要向大家介绍一个在流式细胞仪数据可视化领域非常重要的R包——ggcyto包！想象一下，当我们在实验室里使用流式细胞仪时，每个细胞就像是一颗微小的星球，带着独特的特征和属性。相信大家都知道，流式细胞仪是一种关键的技术，它能够以高通量的方式来帮我们探索单个细胞的多种属性，如大小、形态和表面标记物的表达。而ggcyto包作为R语言的一个重要扩展包，就像是我们的望远镜和地图，带领我们可视化和分析流式细胞仪数据。ggcyto包为我们提供了丰富多彩的绘图函数，能够通过单参数的密度图和双参数的散点图，帮助我们直观地理解不同细胞群体之间的关系和特征。</span></span></section><section><span><span><span leaf="">在本次学习中，我们将深入探讨ggcyto包的功能和应用，学会如何加载流式细胞仪数据，绘制各种类型的图形，并对数据进行进一步的分析和解读。通过实际操作和示例演示，我们将更深入地了解流式细胞仪数据的特征和规律，为后续的生物学研究提供重要的参考和支持。我相信，通过今天的学习，同学们将能够更好地应用ggcyto包，在生物学的海洋中航行得更远，探索得更深！接下里就让我们一起开启对ggcyto包的学习之旅吧！</span></span><span leaf="">    </span></span><page></page></section><section><span></span></section><section><span><span leaf="">本次介绍的R包需要较多的硬件资源，在服务器可以更加流畅运行，同学们如果没有自己的服务器欢迎联系我们使用服务器租赁~</span></span></section><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="194" data-imgfileid="100011261" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><section><p><span><strong><span leaf="">定制生信分析</span></strong></span></p><p><span><strong><span leaf="">生信云服务器</span></strong></span></p></section></section></section></section></section></section></section><section><span><p></p></span></section><section><span><span leaf="">ggcyto包介绍</span></span></section><section><span><span leaf="">ggcyto包是一个专门用于可视化流式细胞仪数据的R包，旨在帮助用户更直观地理解细胞特征。通过ggcyto，用户可以轻松绘制各种图形，如散点图和密度图，展示不同参数的分布情况，并支持双参数图像的绘制，以探索参数之间的相关性。此外，ggcyto还提供了对细胞表面标记物的可视化支持，有助于用户识别不同细胞群体。综上所述，ggcyto为生物学家和研究人员提供了一个强大而灵活的工具，帮助他们更深入地分析和解读流式细胞仪数据，为科学研究和医学应用提供了有力支持。</span></span><span><span leaf="">    </span></span><p><span leaf=""> </span></p></section><section><span><p></p></span></section><section><span><span leaf="">ggcyto包安装</span></span></section><section><span><span leaf="">需要R语言版本为4.3，在控制台中输入以下命令：</span></span></section><section><span></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>if</span><span> </span>(!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))</span></code><code><span leaf="">    install.<span>packages</span>(<span>"BiocManager "</span>)</span></code><code><span leaf=""><span>BiocManager</span>::<span>install</span>(<span>"ggcyto"</span>) <span># 在BiocManager环境下安装ggcyto    </span></span></code><code><span leaf="">查看是否安装成功</span></code><code><span leaf=""><span>packageVersion</span>(<span>"ggcyto"</span>) <span># 查看ggcyto版本</span></span></code></pre></section><section><span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTtic1kb3DqfGxCUanicj262iabmKpAqAtDia9DjkAR6gyibpTwf1ib8ykialXticw/640?wx_fmt=png" data-ratio="0.11764705882352941" data-type="png" data-w="1054" height="65.1300048828125" width="553.739990234375" data-imgfileid="100009821" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTtic1kb3DqfGxCUanicj262iabmKpAqAtDia9DjkAR6gyibpTwf1ib8ykialXticw/640?wx_fmt=png"></span></span></section><section><span><span leaf="">显示为1.30.2版本，则表示已经安装了ggcyto包。</span></span></section><section><span><span leaf="">除此之外，后续示例还需要使用flowWorkspaceData包，我们可以提前安装，安装命令如下：</span></span></section><section><ul><li></ul><pre data-lang="php"><code><span leaf=""><span>BiocManager</span>::<span>install</span>(<span>"flowWorkspaceData"</span>) <span># 在BiocManager环境下安装flowWorkspaceData包      </span></span></code></pre></section><section><span><p></p></span></section><section><span><span leaf="">使用ggcyto包可视化流式细胞仪数据</span></span></section><section><span><span leaf="">载入需要的包和数据：</span></span></section><section><span><span leaf="">在本文中我们将采用flowWorkspaceData包中的示例数据为例进行流式细胞仪数据可视化演示，同学们可以采用自己课题的数据按照步骤一步步进行，就可得到想要的可视化结果。</span></span></section><section><span><span leaf="">载入包和示例数据的命令如下：</span></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 载入 ggcyto 包，用于可视化流式细胞仪数据</span></span></code><code><span leaf=""><span>library</span>(ggcyto)</span></code><code><span leaf=""><span># 设置数据目录，这里使用了流式细胞仪数据包中的示例数据目录</span></span></code><code><span leaf=""><span>dataDir</span> &lt;- system.file(<span>"extdata"</span>, package = <span>"flowWorkspaceData"</span>)</span></code><code><span leaf=""><span># 使用示例数据目录中的 gs_bcell_auto 工作空间    </span></span></code><code><span leaf=""><span>gs</span> &lt;- load_gs(list.files(dataDir, pattern = <span>"gs_bcell_auto"</span>, full = TRUE))</span></code><code><span leaf=""><span># 载入示例数据集 GvHDdata(GvHD)</span></span></code><code><span leaf=""><span># 将数据存储在名为 fs 的对象中</span></span></code><code><span leaf=""><span>fs</span> &lt;- GvHD[subset(pData(GvHD), Patient %in% <span>5</span> &amp; Visit %in% c(<span>5</span>:<span>6</span>))$name]</span></code></pre></section><section><span></span></section><section><span><span leaf="">可视化流式细胞仪数据：</span></span></section><section><span><span leaf="">我们可以使用autoplot函数来对流式细胞仪数据可视化，如果传递的参数只有一个则默认的y轴为geom_density，如果传递的参数为两个，则分别作为x轴和y轴来展示对应参数的分布规律，相关的命令如下：</span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 绘制 FSC-H 参数的散点图</span></span></code><code><span leaf="">autoplot(fs, x = <span>'FSC-H'</span>)</span></code></pre></section><section><span></span></section><section><span><span leaf="">其中FSC-H为前向散射（Forward Scatter，FSC），它是测量细胞沿着激光束方向散射的光的参数。FSC-H 表示前向散射信号的强度，通常与细胞的大小相关，因为大的细胞会在前向方向上散射更多的光。</span></span></section><section><span><span><span leaf="">输出的结果如下图：</span></span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticDCJZp1ibCuzOZHFeTJbB0qicRf11Aic4XebM3NcmVrfe9llPLXcv2ibbcQ/640?wx_fmt=png" data-ratio="0.4" data-type="png" data-w="1080" height="221.33999633789062" width="552.8800048828125" data-imgfileid="100009822" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticDCJZp1ibCuzOZHFeTJbB0qicRf11Aic4XebM3NcmVrfe9llPLXcv2ibbcQ/640?wx_fmt=png"></span></span></section><section><span><span leaf="">由图即可清晰展示细胞大小分布规律，接下来我们可以使用autoplot函数绘制双参数图像，命令如下：</span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 绘制 FSC-H 和 SSC-H 参数的双参数散点图，设置网格密度为 64</span></span></code><code><span leaf="">autoplot(fs, x = <span>'FSC-H'</span>, y = <span>'SSC-H'</span>, bins = 64)</span></code></pre></section><section><span></span></section><section><span><span leaf="">其中SSC-H为侧向散射（Side Scatter，SSC），它是测量细胞沿着激光束侧向散射的光的参数。SSC-H 表示侧向散射信号的强度，通常与细胞的复杂性和颗粒性相关，因为细胞内的颗粒或结构会导致侧向散射。</span></span></section><section><span><span leaf="">显示结果如下：</span></span></section><section><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticxL7gCiaTYtiaeBUAYIxptxbe1kNht8hZBAGeCYhBWsvcgNZ8vy7DDU0A/640?wx_fmt=png" data-ratio="0.4" data-type="png" data-w="1080" height="221.34002685546875" width="552.8800048828125" data-imgfileid="100009823" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticxL7gCiaTYtiaeBUAYIxptxbe1kNht8hZBAGeCYhBWsvcgNZ8vy7DDU0A/640?wx_fmt=png"></span></span></section><section><span><span><span leaf="">除此之外，我们可以直接使用autoplot函数画出样本所有参数的分布图，并且同时绘制出细胞表面标记物分布规律，命令如下：</span></span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 绘制第一个样本的散点图，并使用细胞表面标记物的标签</span></span></code><code><span leaf=""><span>autoplot</span>(fs[[<span>1</span>]]) + labs_cyto(<span>"marker"</span>)</span></code></pre></section><section><span></span></section><section><span><span leaf="">显示结果如下图：</span></span></section><section><span><span leaf=""><img data-imgfileid="100009824" data-ratio="0.6324074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticiclyW98Ph7iayCcGxyoPzHqkz13drWkmHhslRR4g7y4Dn4Kxht985ibIA/640?wx_fmt=png" data-type="png" data-w="1080" height="344.4100341796875" width="544.8699951171875" src="https://mmbiz.qpic.cn/mmbiz_png/YHGRXkSxjSTyWzBMJ1oPKqJExhs1fTticiclyW98Ph7iayCcGxyoPzHqkz13drWkmHhslRR4g7y4Dn4Kxht985ibIA/640?wx_fmt=png"></span></span></section><section><span><span leaf="">至此，我们可以在一张图上清晰展示流式细胞仪的重要参数分布规律，其中包括FSC、SSC、CD15、CD45、CD14、FL2以及CD33，这些参数的分布规律可以帮助我们识别不同类型的细胞群体，并对其进行定量和定性分析。FSC（前向散射）和SSC（侧向散射）参数通常用于评估细胞的大小和复杂性，而CD15、CD45、CD14、FL2和CD33等标记物则用于鉴别不同的细胞类型或表型。通过在一张图上同时展示这些参数的分布情况，我们可以更全面地了解样本中不同细胞群体的特征，并进一步进行数据解读和分析。</span></span></section><section><span></span></section><section><span><span><span leaf="">以上就是对于ggcyto包的全部介绍了，通过本次的学习，我们深入了解了ggcyto包在流式细胞仪数据可视化方面的强大功能。从细胞大小到表面标记物的分布，ggcyto包为我们提供了丰富多彩的可视化方式，帮助我们更直观地理解样本中不同细胞群体的特征。流式细胞仪数据的分析和解读是生物学研究中至关重要的一环，而ggcyto包的出现无疑为我们提供了一个高效、便捷的工具。师妹希望大家继续深入学习ggcyto包，掌握其更多高级功能，将其应用于自己的研究中。通过不断地探索和实践，我们将能够更加准确地解读流式细胞仪数据，为生物信息学的进步贡献自己的一份力量。让我们一起努力，继续探索前沿科学，开拓学术视野！</span></span><span leaf=""> </span></span><span leaf=""><br></span></section><p><span leaf=""><br></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p><span leaf="">E</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">N</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">D</span></p></section></section><section><section powered-by="xiumi.us"><section><span leaf=""><br></span></section></section></section></section></section><p><span leaf=""><br></span></p><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="219" data-cropsely1="0" data-cropsely2="219" data-imgfileid="100013742" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><p><span leaf="">定制生信分析</span></p><p><span leaf="">课题思路设计</span></p><p><span leaf="">生信云服务器</span></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3073838745411518465#wechat_redirect" textvalue="生信实操" linktype="text" data-linktype="2">生信分析实操</a></span></p></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3113598048028459016#wechat_redirect" textvalue="生信文章思路" linktype="text" data-linktype="2">生信文章思路</a></span></p></section></section></section></section></section></section></section></section><section><page></page></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/O-_gtP07wiqcUfrG7r-A2A",target="_blank" rel="noopener noreferrer">原文链接</a>
