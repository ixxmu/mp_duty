---
title: "顶刊复现 | 火山图+富集网络图/条形图"
date: 2025-10-30T14:49:45Z
draft: ["false"]
tags: [
  "fetched",
  "MsTt笔记"
]
categories: ["Acdemic"]
---
顶刊复现 | 火山图+富集网络图/条形图 by MsTt笔记
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTt笔记" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="SCI绘图，Python/R，生物信息，数理统计，多组学原理" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf=""><br></span></span></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf="">请尊重原创劳动成果🙏</span></span></section><p><span><span leaf="">未经允许，不可抄袭，转载请注明出处！</span></span></p><p data-tool="mdnice编辑器"><span leaf="">今天来复现3张顶刊中的</span><strong><span leaf="">火山图+富集图</span></strong><span leaf="">（volcano &amp; enrichment plot）。</span></p><ul><li><section><span leaf="">火山图的作用：是<span textstyle="">“筛选器”</span>。它从成千上万的基因/蛋白中，快速、直观地筛选出那些具有显著生物学变化的目标。</span></section></li><li><section><span leaf="">富集图的作用：是<span textstyle="">“解释器”</span>。它对这些筛选出的目标进行功能解读，揭示它们主要参与哪些生物学过程、通路或具有哪些功能。</span></section></li></ul><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbZJeAicUJY2mo6bAr8tBzHrnO6871OSQ4yFyrHwicndRRLFS1IBneS0mA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.3462962962962963" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001692" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbZJeAicUJY2mo6bAr8tBzHrnO6871OSQ4yFyrHwicndRRLFS1IBneS0mA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">火山图数据：</span>来自差异表达分析，需要至少包含三列：</span></p><ul><li><section><span leaf="">基因ID：如基因名或转录本ID。</span></section></li><li><section><span leaf="">差异倍数：log2(Fold Change)，即log2FC。</span></section></li><li><section><span leaf="">显著性P值：P值或者经过多重检验校正后的p-adjust。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">富集分析数据：</span>进行GO或KEGG富集分析，需要：</span></p><ul><li><section><span leaf="">目标基因集：筛选出的差异表达基因列表。</span></section></li><li><section><span leaf="">背景基因集：检测到的所有基因，或对应物种全部基因。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现一</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第一篇是 </span><strong><span leaf="">Nature Communications</span></strong><span leaf=""> 文章中 (Piatti, L., Batzilla, A., Nakaki, F. et al. Plasmodium falciparum egress disrupts endothelial junctions and activates JAK-STAT signaling in a microvascular 3D blood-brain barrier model. Nat Commun 16, 7262 (2025). https://doi.org/10.1038/s41467-025-62514-2) 的 Fig. 2ef</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbumV9T9Zr98HcjWxKeQxJG5eCHD2h2HEAAUJ8lUKB06X6Rq1ntAoz7Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.43425925925925923" data-type="png" data-w="1080" data-imgfileid="100001694" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbumV9T9Zr98HcjWxKeQxJG5eCHD2h2HEAAUJ8lUKB06X6Rq1ntAoz7Q/640?wx_fmt=png&amp;from=appmsg"></span></p><ul><li><section><strong><span leaf="">火山图</span></strong><span leaf="">：呈现内皮细胞在iRBC释放介质培养24小时后差异表达基因的分析结果。图中红色和蓝色圆点分别代表显著上、下调的基因（FDR &lt; 0.05，|log2FC| &gt; 0.1），并标注了部分下调基因。</span></section></li><li><section><strong><span leaf="">GO富集网络图</span></strong><span leaf="">：对显著下调基因进行的GO功能富集分析。网络节点代表最显著的GO条目，连线表示条目间存在超过20%的基因重叠。分析采用超几何分布检验，并进行了多重检验校正。</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb3Mp9AmFTI6rwclb9jalEPT7xXxfbPwwpg6ezbKxNM8YsNLBibLuCptw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4564814814814815" data-type="png" data-w="1080" data-imgfileid="100001695" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb3Mp9AmFTI6rwclb9jalEPT7xXxfbPwwpg6ezbKxNM8YsNLBibLuCptw/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载R包，准备数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span leaf=""><span># 加载必要的包</span></span></code><code><span leaf="">library(tidyverse)        <span># 数据清洗与可视化核心包（包含 ggplot2, dplyr 等）</span></span></code><code><span leaf="">library(readxl)           <span># 用于读取Excel文件</span></span></code><code><span leaf="">library(patchwork)        <span># 用于拼图（plot_grid）</span></span></code><code><span leaf="">library(ggrepel)          <span># 用于添加标签，避免文字重叠</span></span></code><code><span leaf="">library(ggtext)</span></code><code><span leaf="">library(clusterProfiler)</span></code><code><span leaf="">library(org.Hs.eg.db)</span></code><code><span leaf="">library(aPEAR)</span></code><code><span leaf=""><br></span></code><code><span leaf="">data1 &lt;- read_xlsx(<span>"data1.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">data1_sig &lt;- data1 %&gt;%</span></code><code><span leaf="">  <span>filter</span>(p.adj &lt; <span>0.05</span>, <span>abs</span>(LogFC) &gt; <span>0</span>) %&gt;%</span></code><code><span leaf="">  arrange(p.adj) %&gt;%</span></code><code><span leaf="">  mutate(</span></code><code><span leaf="">    Expression = case_when(</span></code><code><span leaf="">      LogFC &gt;= <span>0.1</span> &amp; p.adj &lt; <span>0.05</span> ~ <span>"Up-regulated"</span>,</span></code><code><span leaf="">      LogFC &lt;= -<span>0.1</span> &amp; p.adj &lt; <span>0.05</span> ~ <span>"Down-regulated"</span>,</span></code><code><span leaf="">      TRUE ~ <span>"Unchanged"</span></span></code><code><span leaf="">    )</span></code><code><span leaf="">  )</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，筛选差异表达基因，并依据其表达变化方向将其划分为上调和下调两组。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-火山图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>p1</span> &lt;- ggplot(data1_sig, aes(LogFC, -log(p.adj,<span>10</span>))) + </span></code><code><span leaf="">  <span>geom_point</span>(aes(color = Expression), size = <span>0</span>.<span>8</span>) +</span></code><code><span leaf="">  <span>scale_color_manual</span>(values = c(<span>"dodgerblue3"</span>, <span>"gray50"</span>, <span>"firebrick3"</span>)) +</span></code><code><span leaf="">  <span>labs</span>(x = expression(<span>"log"</span>[<span>2</span>]*<span>"FC"</span>), y = expression(<span>"-log"</span>[<span>10</span>]*<span>"FDR"</span>)) + </span></code><code><span leaf="">  <span>ggtitle</span>(<span>"Endothelial cells"</span>) +</span></code><code><span leaf="">  <span>coord_flip</span>(clip = <span>"off"</span>) +</span></code><code><span leaf="">  <span>geom_text_repel</span>(data = top_genes,</span></code><code><span leaf="">                   <span>mapping</span> = aes(LogFC, -log(p.adj,<span>10</span>), label = gene),</span></code><code><span leaf="">                   <span>size</span> = <span>5</span>, seed = <span>233</span>, </span></code><code><span leaf="">                   <span>min</span>.segment.length = <span>0</span>, </span></code><code><span leaf="">                   <span>force</span>  = <span>12</span>,            </span></code><code><span leaf="">                   <span>force_pull</span>  = <span>2</span>,        </span></code><code><span leaf="">                   <span>box</span>.padding = <span>0</span>.<span>1</span>,      </span></code><code><span leaf="">                   <span>max</span>.overlaps = Inf,      </span></code><code><span leaf="">                   <span>segment</span>.alpha = <span>0</span>.<span>5</span>)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbElJPl9PDvickwnwQWgYVPIUz6sLEASWv9AemvkKUwRC2vpK7bCu1aiaQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0776439089692103" data-s="300,640" data-type="png" data-w="747" type="block" data-imgfileid="100001696" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbElJPl9PDvickwnwQWgYVPIUz6sLEASWv9AemvkKUwRC2vpK7bCu1aiaQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-富集网络图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>data1_sig_down</span> &lt;- data1_sig[data1_sig$LogFC &lt; -<span>0</span>.<span>1</span>, ]</span></code><code><span leaf=""><span>gene_down</span> &lt;- data1_sig_down$gene</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 使用clusterProfiler包进行GO富集分析</span></span></code><code><span leaf=""><span>ego_down</span> &lt;- enrichGO(gene          = gene_down,</span></code><code><span leaf="">                     <span>keyType</span>       = <span>"SYMBOL"</span>,</span></code><code><span leaf="">                     <span>OrgDb</span>         = org.Hs.eg.db,</span></code><code><span leaf="">                     <span>pAdjustMethod</span> = <span>"BH"</span>,</span></code><code><span leaf="">                     <span>ont</span>           = <span>"BP"</span>,</span></code><code><span leaf="">                     <span>pvalueCutoff</span>  = <span>0</span>.<span>05</span>,</span></code><code><span leaf="">                     <span>qvalueCutoff</span>  = <span>0</span>.<span>05</span>,</span></code><code><span leaf="">                     <span>readable</span>      = TRUE,</span></code><code><span leaf="">                     <span>maxGSSize</span>     = <span>1500</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>ego_down_plot_data</span> &lt;- ego_down@result %&gt;% filter(qvalue &lt; <span>0</span>.<span>0001</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 使用aPEAR包进行网络图绘制</span></span></code><code><span leaf=""><span>p2</span> &lt;- enrichmentNetwork(ego_down_plot_data, </span></code><code><span leaf="">                        <span>simMethod</span> = 'jaccard',</span></code><code><span leaf="">                        <span>drawEllipses</span> = TRUE, </span></code><code><span leaf="">                        <span>fontSize</span> = <span>4</span>.<span>5</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>p3</span> &lt;- p2 + </span></code><code><span leaf="">  <span>scale_color_gradient</span>(low = <span>"blue"</span>, high = <span>"white"</span>) +</span></code><code><span leaf="">  <span>ggtitle</span>(<span>"Endothelial cells"</span>)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbvEnDShmbsSBhLEmpGwOMIKtcHa8U3TmJ6ytwXwBdOI962omLkia7BmQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7668112798264642" data-s="300,640" data-type="png" data-w="922" type="block" data-imgfileid="100001697" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbvEnDShmbsSBhLEmpGwOMIKtcHa8U3TmJ6ytwXwBdOI962omLkia7BmQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-组合图形</span></span></h2><section><ul><li></ul><pre data-lang="apache"><code><span leaf=""><span>p1</span> + p3 + plot_layout(widths = c(<span>1</span>, <span>1</span>.<span>2</span>))  <a topic-id="mhdec058-3ogdmz" data-topic="1">#控制左右图比例</a>，右图略宽</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbr6zKGgibQao5W7GIeV8dHStZN6WlCJN8QnofyhFshnfNQ1icT7OlWucw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.45925925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001698" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbr6zKGgibQao5W7GIeV8dHStZN6WlCJN8QnofyhFshnfNQ1icT7OlWucw/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现二</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第二篇是 </span><strong><span leaf="">iMeta</span></strong><span leaf=""> 文章中 (Feng Zhang, Rong Li, Yasong Liu, Jinliang Liang et al. Integrative cross-tissue analysis unveils complement-immunoglobulin augmentation and dysbiosis-related fatty acid metabolic remodeling during mammalian aging. iMeta. 2025;e70027. https://doi.org/10.1002/imt2.70027) 的 Figure. 3AB</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbMQ2CDX08TqHbaQy9rhg9icaop1mqnyZ4ggcutB79DeiawJmmkUgeWpHw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.30462962962962964" data-type="png" data-w="1080" data-imgfileid="100001699" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbMQ2CDX08TqHbaQy9rhg9icaop1mqnyZ4ggcutB79DeiawJmmkUgeWpHw/640?wx_fmt=png&amp;from=appmsg"></span></p><ul><li><section><strong><span leaf="">火山图</span></strong><span leaf="">：展示了年轻与年老组血浆中的差异表达蛋白</span></section></li><li><section><strong><span leaf="">GO富集条形图</span></strong><span leaf="">：揭示了这些蛋白的生物学功能。</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb7aOlQQia0eHfRRf7xUCWvLrlq0DkU8UZwdIO7bMwibKLDoLRMG0wxHNA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.31851851851851853" data-type="png" data-w="1080" data-imgfileid="100001700" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb7aOlQQia0eHfRRf7xUCWvLrlq0DkU8UZwdIO7bMwibKLDoLRMG0wxHNA/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载R包，准备数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf="">library(ggplot2)</span></code><code><span leaf="">library(dplyr)</span></code><code><span leaf="">library(ggrepel)</span></code><code><span leaf="">library(readxl)</span></code><code><span leaf="">library(patchwork)</span></code><code><span leaf=""><br></span></code><code><span leaf="">data2_volcano &lt;- read_excel(<span>"data2.xlsx"</span>, sheet = <span>"volcano"</span>)</span></code><code><span leaf="">data2_volcano &lt;- data2_volcano %&gt;%</span></code><code><span leaf="">  mutate(</span></code><code><span leaf="">    <span>group</span> = case_when(</span></code><code><span leaf="">      log2<span>FC</span> &gt; <span>0.3</span> &amp; Pvalue &lt; <span>0.05</span> ~ <span>"Up"</span>,</span></code><code><span leaf="">      log2<span>FC</span> &lt; <span>-0</span>.<span>3</span> &amp; Pvalue &lt; <span>0.05</span> ~ <span>"Down"</span>,</span></code><code><span leaf="">      TRUE ~ <span>"Not Sig"</span></span></code><code><span leaf="">    )</span></code><code><span leaf="">  )</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，筛选差异蛋白，并依据其表达变化方向将其划分为上调和下调两组。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-火山图</span></span></h2><section><ul><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>p1</span> &lt;- ggplot(data2_volcano, aes(x = log2FC, y = -log10(Pvalue), color = group)) +</span></code><code><span leaf="">  <span>geom_point</span>(size = <span>2</span>, alpha = <span>0</span>.<span>9</span>) +</span></code><code><span leaf="">  <span>scale_color_manual</span>(values = c(<span>"Down"</span> = <span>"#513965"</span>, <span>"Not Sig"</span> = <span>"gray80"</span>, <span>"Up"</span> = <span>"#9e3f58"</span>)) +</span></code><code><span leaf="">  <span>geom_vline</span>(xintercept = c(-<span>0</span>.<span>3</span>, <span>0</span>.<span>3</span>), linetype = <span>"dashed"</span>) +</span></code><code><span leaf="">  <span>geom_hline</span>(yintercept = -log10(<span>0</span>.<span>05</span>), linetype = <span>"dashed"</span>)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbF17R8iaM9UoXkwichd3ySUQOEGwx8ZI5CEAP5rpV6YqqOKoSsPSnqFQQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0161290322580645" data-s="300,640" data-type="png" data-w="620" type="block" data-imgfileid="100001701" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbF17R8iaM9UoXkwichd3ySUQOEGwx8ZI5CEAP5rpV6YqqOKoSsPSnqFQQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-富集条形图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 假设已经完成富集结果，这里直接读入结果</span></span></code><code><span leaf=""><span>data2_enrich</span> &lt;- read_excel(<span>"data2.xlsx"</span>, sheet = <span>"enrich"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 筛选数据并按Log10Pvalue排序</span></span></code><code><span leaf=""><span>data2_enrich_down</span> &lt;- data2_enrich[data2_enrich$Cluster == <span>"downregulated"</span>, ]</span></code><code><span leaf=""><span>data2_enrich_down</span> &lt;- data2_enrich_down[order(data2_enrich_down$Log10Pvalue, decreasing = FALSE), ]</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建因子水平以保持排序顺序</span></span></code><code><span leaf=""><span>data2_enrich_down</span>$Description &lt;- factor(data2_enrich_down$Description, </span></code><code><span leaf="">                                        <span>levels</span> = data2_enrich_down$Description)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>my_palette2</span> &lt;- colorRampPalette(c(alpha(<span>"#513965FF"</span>, <span>0</span>.<span>6</span>),alpha(<span>"#513965FF"</span>, <span>0</span>.<span>9</span>)), alpha=TRUE)(n=<span>128</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>p2</span> &lt;- ggplot() +</span></code><code><span leaf="">  <span>geom_bar</span>(data = data2_enrich_down,</span></code><code><span leaf="">           <span>aes</span>(x = Log10Pvalue, y = Description, fill = Log10Pvalue),</span></code><code><span leaf="">           <span>width</span> = <span>0</span>.<span>52</span>, stat = 'identity') +</span></code><code><span leaf="">  <span>geom_text</span>(data = data2_enrich_down,</span></code><code><span leaf="">            <span>aes</span>(x = <span>0</span>.<span>1</span>, y = Description, label = Description),</span></code><code><span leaf="">            <span>size</span> = <span>5</span>, hjust = <span>0</span>) +</span></code><code><span leaf="">  <span>geom_text</span>(data = data2_enrich_down,</span></code><code><span leaf="">            <span>aes</span>(x = <span>0</span>.<span>1</span>, y = Description, label = `Protein Hits`, color = Log10Pvalue),</span></code><code><span leaf="">            <span>size</span> = <span>5</span>, hjust = <span>0</span>, vjust = <span>2</span>.<span>7</span>) +</span></code><code><span leaf="">  <span>scale_fill_gradientn</span>(name = expression(paste(-log[<span>10</span>], <span>"("</span>, italic(p), <span>"-value)"</span>)), colors = my_palette2) + </span></code><code><span leaf="">  <span>scale_color_gradientn</span>(name = expression(paste(-log[<span>10</span>], <span>"("</span>, italic(p), <span>"-value)"</span>)), colors = my_palette2)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">下调基因的GO富集条形图：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbK36vnrX2NUsB0uClrOtaJ8mCXyysctqNwYpYbM7ib6mrWkKl87Saffw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9781591263650546" data-s="300,640" data-type="png" data-w="641" type="block" data-imgfileid="100001702" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbK36vnrX2NUsB0uClrOtaJ8mCXyysctqNwYpYbM7ib6mrWkKl87Saffw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf="">上调基因的GO富集条形图（代码同上）：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbfHy7MtgT5kwD6Sxke4ac1h9YST6oZqxiclwgWJ3zPmgbucYiaURopicibw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9704049844236761" data-s="300,640" data-type="png" data-w="642" type="block" data-imgfileid="100001703" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbfHy7MtgT5kwD6Sxke4ac1h9YST6oZqxiclwgWJ3zPmgbucYiaURopicibw/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">组合图形</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb7aOlQQia0eHfRRf7xUCWvLrlq0DkU8UZwdIO7bMwibKLDoLRMG0wxHNA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.31822222222222224" data-type="png" data-w="1125" data-imgfileid="100001700" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb7aOlQQia0eHfRRf7xUCWvLrlq0DkU8UZwdIO7bMwibKLDoLRMG0wxHNA/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现三</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第三篇是 </span><strong><span leaf="">Nature Communications</span></strong><span leaf=""> 文章中 (He, S., Hu, X., Zhu, J. et al. Integrated plasma and vegetation proteomic characterization of infective endocarditis for early diagnosis and treatment. Nat Commun 16, 5052 (2025). https://doi.org/10.1038/s41467-025-60184-8) 的 Fig. 1CD</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbYyCXBJa8ewy4GSoibdqW6LqqnIwQ6mCFiahicTro4cicic3EsjWuvcyHQKg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.35555555555555557" data-type="png" data-w="1080" data-imgfileid="100001705" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbYyCXBJa8ewy4GSoibdqW6LqqnIwQ6mCFiahicTro4cicic3EsjWuvcyHQKg/640?wx_fmt=png&amp;from=appmsg"></span></p><ul><li><section><strong><span leaf="">火山图</span></strong><span leaf="">：显示了感染性心内膜炎（IE）患者入院时失调的血浆蛋白。</span></section></li><li><section><strong><span leaf="">富集条形图</span></strong><span leaf="">：进一步揭示了这些蛋白所富集的显著失调信号通路。</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbaG8sWjAKWdsOeBDIDxKTYxjAic2qtMCcH2eibB9Bbic5zzT3ShJfPY0OQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.36018518518518516" data-type="png" data-w="1080" data-imgfileid="100001706" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbaG8sWjAKWdsOeBDIDxKTYxjAic2qtMCcH2eibB9Bbic5zzT3ShJfPY0OQ/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载R包，准备数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf="">library(ggplot2)</span></code><code><span leaf="">library(dplyr)</span></code><code><span leaf="">library(ggrepel)</span></code><code><span leaf="">library(readxl)</span></code><code><span leaf="">library(stringr)</span></code><code><span leaf="">library(patchwork)</span></code><code><span leaf=""><br></span></code><code><span leaf="">data3_volcano &lt;- read_excel(<span>"data3.xlsx"</span>, sheet = <span>"volcano"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 添加显著性分组</span></span></code><code><span leaf="">data3_volcano &lt;- data3_volcano %&gt;%</span></code><code><span leaf="">  mutate(</span></code><code><span leaf="">    <span>group</span> = case_when(</span></code><code><span leaf="">      log2<span>FC</span> &gt; <span>0.58</span> &amp; Pvalue &lt; <span>0.05</span> ~ <span>"Up"</span>,</span></code><code><span leaf="">      log2<span>FC</span> &lt; <span>-0</span>.<span>58</span> &amp; Pvalue &lt; <span>0.05</span> ~ <span>"Down"</span>,</span></code><code><span leaf="">      TRUE ~ <span>"Not Sig"</span></span></code><code><span leaf="">    )</span></code><code><span leaf="">  )</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，提取差异基因，并分为上下调两组。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-火山图</span></span></h2><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>p1</span> &lt;- ggplot(data3_volcano, aes(x = log2FC, y = -log10(Pvalue), color = group)) +</span></code><code><span leaf="">  <span>geom_point</span>(size = <span>0</span>.<span>5</span>, alpha = <span>1</span>) +</span></code><code><span leaf="">  <span>scale_color_manual</span>(values = c(<span>"Down"</span> = <span>"#66cc00"</span>, <span>"Not Sig"</span> = <span>"gray80"</span>, <span>"Up"</span> = <span>"#ffcc00"</span>),</span></code><code><span leaf="">                     <span>labels</span> = c(<span>"Down"</span> = <span>"downregulated in IE"</span>, <span>"Not Sig"</span> = <span>"not−significant"</span>, <span>"Up"</span> = <span>"upregulated in IE"</span>)) +</span></code><code><span leaf="">  <span>geom_vline</span>(xintercept = c(-<span>0</span>.<span>58</span>, <span>0</span>.<span>58</span>), linetype = <span>"dashed"</span>, linewidth = <span>0</span>.<span>3</span>) +</span></code><code><span leaf="">  <span>geom_hline</span>(yintercept = -log10(<span>0</span>.<span>05</span>), linetype = <span>"dashed"</span>, linewidth = <span>0</span>.<span>3</span>) +</span></code><code><span leaf="">  <span>geom_text_repel</span>(data = sig_genes, aes(label = Symbol),</span></code><code><span leaf="">                  <span>size</span> = <span>3</span>, max.overlaps = Inf, show.legend = FALSE)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbBib2gw1eCYcEpicCRxeo67fsnPRSQ11MlrF6PwFk1XFHx1icYftdmpzUQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8920676202860858" data-s="300,640" data-type="png" data-w="769" type="block" data-imgfileid="100001707" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbBib2gw1eCYcEpicCRxeo67fsnPRSQ11MlrF6PwFk1XFHx1icYftdmpzUQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">绘图-富集条形图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 假设已经完成富集结果，这里直接读入结果</span></span></code><code><span leaf="">data3_enrich &lt;- read_excel(<span>"data3.xlsx"</span>, sheet = <span>"enrich"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 数据预处理</span></span></code><code><span leaf="">data3_enrich &lt;- data3_enrich %&gt;%</span></code><code><span leaf="">  mutate(</span></code><code><span leaf="">    logFDR = -log10(FDR),</span></code><code><span leaf="">    logFDR = ifelse(Category == <span>"downregulated in IE"</span>, -logFDR, logFDR), <span># 不同类别的点会分布在零点的两侧</span></span></code><code><span leaf="">    Term = str_replace_all(Term, <span>" "</span>, <span>"_"</span>)</span></code><code><span leaf="">  ) %&gt;%</span></code><code><span leaf="">  group_by(Category) %&gt;%</span></code><code><span leaf="">  arrange(</span></code><code><span leaf="">    Category,</span></code><code><span leaf="">    ifelse(Category == <span>"upregulated in IE"</span>, logFDR, -logFDR)</span></code><code><span leaf="">  ) %&gt;%</span></code><code><span leaf="">  ungroup() %&gt;%</span></code><code><span leaf="">  mutate(Term = <span>factor</span>(Term, levels = Term))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">labels_df &lt;- data3_enrich %&gt;%</span></code><code><span leaf="">  mutate(</span></code><code><span leaf="">    x = ifelse(Category == <span>"upregulated in IE"</span>,</span></code><code><span leaf="">               min(data3_enrich<span>$logFDR</span>)*0.04,  <span># 左侧稍偏左</span></span></code><code><span leaf="">               max(data3_enrich<span>$logFDR</span>)*0.02), <span># 右侧稍偏右</span></span></code><code><span leaf="">    hjust = ifelse(Category == <span>"upregulated in IE"</span>, 1, 0)</span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 主体图形</span></span></code><code><span leaf="">p2 &lt;- ggplot(data3_enrich, aes(x = logFDR, y = Term, fill = Category)) +</span></code><code><span leaf="">  geom_bar(<span>stat</span> = <span>"identity"</span>, width = 0.67, color = <span>"black"</span>, linewidth = 0.3) +</span></code><code><span leaf="">  geom_vline(xintercept = 0, size=0.3) +</span></code><code><span leaf="">  scale_fill_manual(values = c(<span>"upregulated in IE"</span> = <span>"#ffcc00"</span>,</span></code><code><span leaf="">                               <span>"downregulated in IE"</span> = <span>"#66cc00"</span>),</span></code><code><span leaf="">                    breaks = c(<span>"upregulated in IE"</span>,<span>"downregulated in IE"</span>))</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb77PIXGkkDDPLSosAq7GUKwLmynKKqEfticPV3WNVw1QoSqo1IKtibIhw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6138888888888889" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001708" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGb77PIXGkkDDPLSosAq7GUKwLmynKKqEfticPV3WNVw1QoSqo1IKtibIhw/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">组合图形</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbaG8sWjAKWdsOeBDIDxKTYxjAic2qtMCcH2eibB9Bbic5zzT3ShJfPY0OQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3599274705349048" data-type="png" data-w="1103" data-imgfileid="100001706" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbaG8sWjAKWdsOeBDIDxKTYxjAic2qtMCcH2eibB9Bbic5zzT3ShJfPY0OQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf="">更多火山图可视化案例，可查看之前的文章：</span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247483859&amp;idx=1&amp;sn=28becdcb76096e1218715eeb75b43452&amp;scene=21#wechat_redirect" textvalue="如何把普通的火山图，做成顶刊里的样子？" data-itemshowtype="0" linktype="text" data-linktype="2">如何把普通的火山图，做成顶刊里的样子？</a></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbA1iaZ85nAn64iaZmt4Eju3tA6tUTKcdZV8ST3bibMUiaSTesmBBfTqbdyA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.42314814814814816" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001709" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbA1iaZ85nAn64iaZmt4Eju3tA6tUTKcdZV8ST3bibMUiaSTesmBBfTqbdyA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247485337&amp;idx=1&amp;sn=5c7d84d85bab5864f18cb013f13bc1fa&amp;scene=21#wechat_redirect" textvalue="顶刊复现 | 多分组火山图-3个案例" data-itemshowtype="0" linktype="text" data-linktype="2">顶刊复现 | 多分组火山图-3个案例</a></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbmW4Upia6IfB9M2IvFEjEnicia1khnic939pwewkAmarfmwz3DETQjlbAqQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.261111111111111" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001710" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKK2vyJHwBaHEBJ7dmHjrVGbmW4Upia6IfB9M2IvFEjEnicia1khnic939pwewkAmarfmwz3DETQjlbAqQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">获取以 RProject 形式保存的</span></span><strong><span leaf=""><span textstyle="">绘图代码+注释+数据模板</span></span></strong><span leaf=""><span textstyle="">，后台回复关键词: </span></span><strong><em><span leaf=""><span textstyle="">251030_volcano_enrich</span></span></em></strong></p></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v122" data-goodssouce="1" data-traceid="b5b36810-fa98-4513-b833-3d4f1ad1774f" data-pid="101_14835066"></mp-common-cpsad></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v122" data-goodssouce="1" data-traceid="b5b36810-fa98-4513-b833-3d4f1ad1774f" data-pid="101_14324026"></mp-common-cpsad></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9q-SMHq0RHzn81n4KYuhtw",target="_blank" rel="noopener noreferrer">原文链接</a>
