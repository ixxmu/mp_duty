---
title: "运行FigureYa，从火山图开始｜ggplot2｜FigureYa59volcano"
date: 2025-10-24T13:35:47Z
draft: ["false"]
tags: [
  "fetched",
  "小丫画图"
]
categories: ["Acdemic"]
---
运行FigureYa，从火山图开始｜ggplot2｜FigureYa59volcano by 小丫画图
------
<div><section><section powered-by="xiumi.us"><section><section><section><section><section><p><span><span leaf="">小丫碎碎念：</span></span></p><p><span><span leaf="">有小伙伴过来问：遇到问题可以问吗？</span></span></p><p><span><span leaf="">答：</span><span leaf="">可以呀，有问题说明我教程做得不到位，我需要<span textstyle="">反馈的声音</span>。</span></span></p><p><span><span leaf=""><br></span></span></p><p><span><span leaf="">对于习惯在Rstudio里运行R代码的小伙伴，需要<span textstyle="">一个瞬间的触动</span>带他/她走出舒适区：</span></span></p><section nodeleaf=""><mp-common-videosnap data-pluginname="mpvideosnap" data-url="https://findermp.video.qq.com/251/20304/stodownload?encfilekey=oibeqyX228riaCwo9STVsGLPj9UYCicgttvp2NPo3ib4dIgWnADcUiawjmTD3X7jfJJKu9uqa1Tsh6wBLicbV6LEKNX0Vib8rjEoQic3BleFJ6P3FLb5hKG7EbAgS4ictDVbSRoJqqmyLrkREGs0&amp;token=ic1n0xDG6aw8OF37eiayb5hD1BMLEdwmp64WKRQTFtCicMRRHEGAzF9uibMGh023Jasz7lZlX3UdCn556YDW0GMXianU2sZYdib1ur5BXwkYpFNxWBeTY9ye42icEf9jdg5vYAqOVrjwOEiczwibMY8EeEibJtYrcUqlX4k90cflB4Czzfzuc&amp;idx=1&amp;hy=SH&amp;m=39d69476ad9e9a6ac2928fa3c5f13c67&amp;uzid=1" data-headimgurl="http://wx.qlogo.cn/finderhead/7j1UQofaR9fQSIDBA9XH7RVph2W7IXVkIN7xH4ya6bzcLfoyaicCnww/0" data-username="v2_060000231003b20faec8c6e1811ac2d4c606ee35b07763d2a8afd7c4d1671f39ff10803e11f8@finder" data-nickname="FigureYa" data-desc="VS Code集成了GitHub Copilot聊天界面，点击它写的代码，瞬间插入你的R脚本" data-nonceid="15666374772089578094" data-width="1400" data-height="1050" data-type="video" data-id="export/UzFfAgtgekIEAQAAAAAABfA62k7ZpwAAAAstQy6ubaLX4KHWvLEZgBPEzYFoYzggQIuPzNPgMIvvyEECaXS6j7bZxsK7GJle"></mp-common-videosnap></section><p><span><span leaf=""><br></span></span></p><section><span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"font-family: mp-quote, \"PingFang SC\", system-ui, -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif;letter-spacing: 0.034em;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>配置VS Code的过程，遇到问题<span textstyle="">不用切换窗口</span>，直接就能问AI：</span></span></section><section nodeleaf=""><mp-common-videosnap data-pluginname="mpvideosnap" data-url="https://findermp.video.qq.com/251/20304/stodownload?encfilekey=oibeqyX228riaCwo9STVsGLPj9UYCicgttvDYHLKkyghBvSZJpicy5JIQ3B90kBAtc0AE6yNVALetNOo7Sz3Yxp8X6joVYLBBmHxhVibpMIbpBibBDbBXOuK2Lq3ibCWDr3fDACSzoXLy2qjmo&amp;token=2lt8WBSnjTmYj80gY55l7ibiapnl6Eia9hs0cKRfq099iaQWTCe8M6s87Zrh2sbIKxCqsGPyOwyQEJ31OwCToyT9xnaeicGG3ameYaKIMrGPhicicF0ZC8TpN7AicN8vJ31mgicUR1Z5rGJwvqtkIia19iaZj27CZTolQjfGf3qm5kSmgNaTw0&amp;idx=1&amp;hy=SH&amp;m=28459e9908698dd2ff3d66412442b1be&amp;uzid=1" data-headimgurl="http://wx.qlogo.cn/finderhead/7j1UQofaR9fQSIDBA9XH7RVph2W7IXVkIN7xH4ya6bzcLfoyaicCnww/0" data-username="v2_060000231003b20faec8c6e1811ac2d4c606ee35b07763d2a8afd7c4d1671f39ff10803e11f8@finder" data-nickname="FigureYa" data-desc="第四期：边跑代码边聊天VS Code安装、配置、克隆仓库、Copilot辅助debug#FigureYa @FigureYa" data-nonceid="5690633085498441693" data-width="1632" data-height="1224" data-type="video" data-id="export/UzFfAgtgekIEAQAAAAAAF4sSMFmCxQAAAAstQy6ubaLX4KHWvLEZgBPE9IEkQigeN4mPzNPgMItsiaPDE5av38mjklLImFRV"></mp-common-videosnap></section><p><span><span leaf=""><br></span></span></p><p><span leaf="">在VS Code里问问题、提要求，<span textstyle="">AI会检索当前目录中的文件</span>，比网页版AI工具方便得多：</span></p><section nodeleaf=""><mp-common-videosnap data-pluginname="mpvideosnap" data-url="https://findermp.video.qq.com/251/20304/stodownload?encfilekey=oibeqyX228riaCwo9STVsGLPj9UYCicgttvEILpLosUjTqztgGkMBL6wTGkOZtqTN2jyhSSNQMfYqh9E6THm8DkKhrb7T2a0WibqialvqRjf9wXwibXur6D4vpmRsNp6Sj8Kl3V2fZReLWBZ0&amp;token=2lt8WBSnjTmYj80gY55l7ibia3qOAdLFn68EGvrsJlGIemnueP8vVq6pVhSnMLop3I0VQ5cv6IUUEpf2gTatmDhgkUIAK9VTc83vo1iaYhUtxTuZl1ia2BDC1NrSs8doAzvzFo82zDtjuiaCLamMeboVA6k7CzhCZTibXIIG71Fx8nhgY&amp;idx=1&amp;hy=SH&amp;m=ee88c3e9abf68e0179c2718a189917d3&amp;uzid=1" data-headimgurl="http://wx.qlogo.cn/finderhead/7j1UQofaR9fQSIDBA9XH7RVph2W7IXVkIN7xH4ya6bzcLfoyaicCnww/0" data-username="v2_060000231003b20faec8c6e1811ac2d4c606ee35b07763d2a8afd7c4d1671f39ff10803e11f8@finder" data-nickname="FigureYa" data-desc="第六期：从下载到运行#FigureYa @FigureYa" data-nonceid="9217335954845782965" data-width="1662" data-height="1246.5" data-type="video" data-id="export/UzFfAgtgekIEAQAAAAAAIwsFB4Te0AAAAAstQy6ubaLX4KHWvLEZgBPE1YFoRUZNZeCOzNPgMIsT-ZXtdmYiq003HGcY4RmV"></mp-common-videosnap></section><p><span leaf=""><br></span></p><p><span leaf="">当你熟悉并爱上VS Code的便利之后，就会忍不住尝试<span textstyle="">更多AI开发工具</span>。从Copilot起步，传说中的Claude Code、Cline、Cursor会不断给你惊喜。</span></p><p><span leaf=""><br></span></p><p><span leaf="">FigureYa是你探索AI的入口。接下来，你将不再满足于公共数据、单细胞分析，<span textstyle="">你科室的资源才是真正有价值的宝藏</span>，让AI带你做更有意义的事。</span></p><p><span leaf=""><br></span></p><p data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">第一期——</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3NTA1MTM0NQ==&amp;mid=2247486685&amp;idx=1&amp;sn=b3ef52d73ace7c98b2e4c931ad8845fb&amp;scene=21#wechat_redirect" textvalue="圆圈图小结｜美图如云，理性选择" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">圆圈图小结｜美图如云，理性选择</span></a></span></p><p><span leaf=""><span textstyle="">第二期——</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3NTA1MTM0NQ==&amp;mid=2247487081&amp;idx=1&amp;sn=c7e3e0aea454bc7ef5107c2bb7b3ae27&amp;scene=21#wechat_redirect" textvalue="连线图小结｜千丝万缕，脉络自现" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">连线图小结｜千丝万缕，脉络自现</span></a></span></p><p><span leaf=""><span textstyle="">第三期——散点图</span><span textstyle="">。这个系列会有点长，从火山图开始，然后是PCA、相关性和其他。</span></span></p><p><span leaf=""><br></span></p></section></section></section><p><strong><span><span leaf="">需求描述</span></span></strong></p><p data-pm-slice="0 0 []"><span><span leaf="">画出像paper里这样美的火山图。</span></span></p><p><span leaf=""><img data-imgfileid="100003435" data-ratio="1.0153172866520788" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGboJkoKoIsicNaVa4YbyulQJPnh1Tog8UZd3yiaT55FVESAgpbUpV9gKtMg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="457" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGboJkoKoIsicNaVa4YbyulQJPnh1Tog8UZd3yiaT55FVESAgpbUpV9gKtMg/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-pm-slice="0 0 []"><span><span leaf="">出自</span></span><span><span leaf="">https://www.nature.com/articles/s41467-018-06944-1</span></span></p><p><span leaf=""><br></span></p><h2><strong><span><span leaf="">应用场景</span></span></strong></h2><p data-pm-slice="0 0 []"><span><span leaf="">展示两组之间总体的基因表达变化趋势。</span></span></p><p><span leaf=""><br></span></p></section></section></section></section><h2><strong><span><span leaf="">环境设置</span></span></strong></h2><section><ul><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span>source</span>(<span>"install_dependencies.R"</span>) <span>#自动识别缺哪些R包，自动安装</span></span></code><code><span leaf="">library(ggplot2)   <span># 加载绘图核心库 | Core plotting library</span></span></code><code><span leaf="">library(ggrepel)   <span># 防止标签重叠的智能标注 | Smart label repulsion to avoid overlaps</span></span></code><code><span leaf="">library(ggthemes)  <span># 提供额外主题与配色 | Additional themes and color palettes</span></span></code><code><span leaf="">library(gridExtra) <span># 多图排版与网格布局 | Arrange multiple plots and grid layout</span></span></code></pre></section><p><span leaf=""><br></span></p><h2 data-heading="true"><strong><span><span leaf="">输入文件</span></span></strong></h2><p data-pm-slice="0 0 []"><span><span leaf="">easy_input_limma.csv，此处用limma结果，还可以用EdgeR、DESeq2等工具获得的差异分析结果作为输入。</span></span></p><p data-pm-slice="0 0 []"><span><span leaf="">如果你要用芯片数据，上一步跟</span><span leaf="">FigureYa59Plus_GEO2DEG无缝对接。</span></span></p><p><span leaf="">至少包含三列：基因名、变化倍数（logFC）、P value(P.Value)或adjust Pvalue(adj.P.Val)。</span></p><p><span><span leaf="">easy_input_selected.csv，有时希望突出显示几个基因，例如后文进行功能验证的基因。会在突出显示的基因外面画黑色圆圈，并标出基因名。</span></span></p><p><span leaf="">至少包含第一列：基因名。第二列是该基因所在的pathway，为可选项。</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 全部基因差异表达分析结果</span></span></code><code><span leaf=""><span># differential Expression Analysis Results of All Genes</span></span></code><code><span leaf="">x &lt;- read.csv(<span>"easy_input_limma.csv"</span>)</span></code><code><span leaf="">x<span>$label</span>&lt;- x<span>$X</span></span></code><code><span leaf=""><span>head</span>(x)</span></code><code><span leaf=""><span># 突出展示感兴趣的基因</span></span></code><code><span leaf=""><span># highlight genes of interest</span></span></code><code><span leaf="">selectedGeneID &lt;- read.csv(<span>"easy_input_selected.csv"</span>)</span></code><code><span leaf=""><span>head</span>(selectedGeneID)</span></code><code><span leaf=""><span># 提取感兴趣的基因的差异分析结果</span></span></code><code><span leaf=""><span># extract the differential analysis results of the gene of interest</span></span></code><code><span leaf="">x<span>$gsym</span> &lt;- x<span>$label</span></span></code><code><span leaf="">selectgenes &lt;- merge(selectedGeneID, x, by = <span>"gsym"</span>)</span></code><code><span leaf=""><span>head</span>(selectgenes)</span></code></pre></section><section><span leaf=""><span textstyle="">参数设置</span></span></section><p data-pm-slice="0 0 []"><span><span leaf="">点的颜色和虚线的位置都由下面的阈值决定，</span></span><span><span leaf="">**根据具体需求调整**</span></span><span><span leaf="">。</span></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>#plot_mode &lt;- "classic" #经典版 classic version</span></span></code><code><span leaf=""><span>plot_mode</span> &lt;- <span>"advanced"</span> <a topic-id="mh4u236r-n6as7f" data-topic="1">#酷炫版</a> cool version</span></code><code><span leaf=""><span>logFCcut</span> &lt;- <span>1</span>.<span>5</span> <a topic-id="mh4u236r-zwazvk" data-topic="1">#log2</a>-foldchange</span></code><code><span leaf=""><span>pvalCut</span> &lt;- <span>0</span>.<span>05</span> <a topic-id="mh4u236r-3p28ya" data-topic="1">#P</a>.value</span></code><code><span leaf=""><span>adjPcut</span> &lt;- <span>0</span>.<span>05</span> <a topic-id="mh4u236r-hkztzh" data-topic="1">#adj</a>.P.value</span></code><code><span leaf=""><span>#用于高级模式</span></span></code><code><span leaf=""><span>#for advanced mode</span></span></code><code><span leaf=""><span>logFCcut2</span> &lt;- <span>2</span>.<span>5</span></span></code><code><span leaf=""><span>logFCcut3</span> &lt;- <span>5</span></span></code><code><span leaf=""><span>pvalCut2</span> &lt;- <span>0</span>.<span>0001</span></span></code><code><span leaf=""><span>pvalCut3</span> &lt;- <span>0</span>.<span>00001</span></span></code><code><span leaf=""><span>#置x，y軸的最大最小位置</span></span></code><code><span leaf=""><span>#set the maximum and minimum positions of the x and y axes</span></span></code><code><span leaf=""><span>xmin</span> &lt;- (range(x$logFC)[<span>1</span>]- (range(x$logFC)[<span>1</span>]+ <span>10</span>))</span></code><code><span leaf=""><span>xmax</span> &lt;- (range(x$logFC)[<span>1</span>]+ (<span>10</span>-range(x$logFC)[<span>1</span>]))</span></code><code><span leaf=""><span>ymin</span> &lt;- <span>0</span></span></code><code><span leaf=""><span>ymax</span> &lt;- max(-log10(x$P.Value)) * <span>1</span>.<span>1</span></span></code><code><span leaf=""><span># 基因名的颜色，需大于等于pathway的数量，这里自定义了足够多的颜色</span></span></code><code><span leaf=""><span># the color of the gene name needs to be greater than or equal to the number of pathway, and here a sufficient number of colors have been customized</span></span></code><code><span leaf=""><span>mycol</span> &lt;- c(<span>"darkgreen"</span>,<span>"chocolate4"</span>,<span>"blueviolet"</span>,<span>"#223D6C"</span>,<span>"#D20A13"</span>,<span>"#088247"</span>,<span>"#58CDD9"</span>,<span>"#7A142C"</span>,<span>"#5D90BA"</span>,<span>"#431A3D"</span>,<span>"#91612D"</span>,<span>"#6E568C"</span>,<span>"#E0367A"</span>,<span>"#D8D155"</span>,<span>"#64495D"</span>,<span>"#7CC767"</span>)</span></code></pre></section><h2 data-heading="true"><strong><span><span leaf="">开始画图</span></span></strong></h2><p data-pm-slice="0 0 []"><span><span leaf="">此处纵坐标用P.value，根据需要，可以把P.Value换成adj.P.Val</span></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span leaf=""><span>if</span> (plot_mode == <span>"classic"</span>){</span></code><code><span leaf="">  <span># 簡單的setting for color</span></span></code><code><span leaf="">  <span># simple setting for color</span></span></code><code><span leaf="">  <span>x</span>$color_transparent &lt;- ifelse((<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &gt; logFCcut), <span>"red"</span>, ifelse((<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &lt; -logFCcut), <span>"blue"</span>,<span>"grey"</span>))</span></code><code><span leaf="">  <span># 簡單的setting for size</span></span></code><code><span leaf="">  <span># simple setting for size</span></span></code><code><span leaf="">  size &lt;- ifelse((<span>x</span>$P.Value &lt; pvalCut &amp; <span>abs</span>(<span>x</span>$logFC) &gt; logFCcut), <span>4</span>, <span>2</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">} <span>else</span> <span>if</span> (plot_mode == <span>"advanced"</span>) {</span></code><code><span leaf="">  <span># 複雜的的setting for color</span></span></code><code><span leaf="">  <span># complex setting for Color</span></span></code><code><span leaf="">  n1 &lt;- <span>length</span>(<span>x</span>[, <span>1</span>])</span></code><code><span leaf="">  cols &lt;- rep(<span>"grey"</span>, n1)</span></code><code><span leaf="">  names(cols)&lt;- rownames(<span>x</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>#不同阈值的点的颜色</span></span></code><code><span leaf="">  <span>#color of points with different thresholds</span></span></code><code><span leaf="">  cols[<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &gt;logFCcut]&lt;- <span>"#FB9A99"</span></span></code><code><span leaf="">  cols[<span>x</span>$P.Value &lt; pvalCut2 &amp; <span>x</span>$logFC &gt; logFCcut2]&lt;- <span>"#ED4F4F"</span></span></code><code><span leaf="">  cols[<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &lt; -logFCcut]&lt;- <span>"#B2DF8A"</span></span></code><code><span leaf="">  cols[<span>x</span>$P.Value &lt; pvalCut2 &amp; <span>x</span>$logFC &lt; -logFCcut2]&lt;- <span>"#329E3F"</span></span></code><code><span leaf="">  color_transparent &lt;- adjustcolor(cols, alpha.f = <span>0</span>.<span>5</span>)</span></code><code><span leaf="">  <span>x</span>$color_transparent &lt;- color_transparent</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 複雜的的setting for size</span></span></code><code><span leaf="">  <span># complex setting for size</span></span></code><code><span leaf="">  n1 &lt;- <span>length</span>(<span>x</span>[, <span>1</span>])</span></code><code><span leaf="">  size &lt;- rep(<span>1</span>, n1)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>#不同阈值的点的大小</span></span></code><code><span leaf="">  <span>#size of points with different thresholds</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &gt; logFCcut]&lt;- <span>2</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut2 &amp; <span>x</span>$logFC &gt; logFCcut2]&lt;- <span>4</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut3 &amp; <span>x</span>$logFC &gt; logFCcut3]&lt;- <span>6</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut &amp; <span>x</span>$logFC &lt; -logFCcut]&lt;- <span>2</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut2 &amp; <span>x</span>$logFC &lt; -logFCcut2]&lt;- <span>4</span></span></code><code><span leaf="">  size[<span>x</span>$P.Value &lt; pvalCut3 &amp; <span>x</span>$logFC &lt; -logFCcut3]&lt;- <span>6</span></span></code><code><span leaf=""><br></span></code><code><span leaf="">} <span>else</span> {</span></code><code><span leaf="">  stop(<span>"Unsupport mode"</span>)</span></code><code><span leaf="">}</span></code><code><span leaf=""><span># 构建绘图对象</span></span></code><code><span leaf=""><span># Construct the plot object</span></span></code><code><span leaf="">p1 &lt;- ggplot(data=<span>x</span>, aes(logFC, -log1<span>0</span>(P.Value), label = label, color = pathway)) +</span></code><code><span leaf="">  geom_point(alpha = <span>0</span>.<span>6</span>, size = size, colour = <span>x</span>$color_transparent) +</span></code><code><span leaf="">  labs(<span>x</span>=bquote(~Log[<span>2</span>]~<span>"(fold change)"</span>), <span>y</span>=bquote(~-Log[<span>10</span>]~italic(<span>"P-value"</span>)), title=<span>""</span>) + </span></code><code><span leaf="">  ylim(c(ymin,ymax)) + </span></code><code><span leaf="">  scale_x_continuous(</span></code><code><span leaf="">    breaks = c(-<span>10</span>, -<span>5</span>, -logFCcut, <span>0</span>, logFCcut, <span>5</span>, <span>10</span>), <span>#刻度线的位置 position of the scale line</span></span></code><code><span leaf="">    labels = c(-<span>10</span>, -<span>5</span>, -logFCcut, <span>0</span>, logFCcut, <span>5</span>, <span>10</span>),</span></code><code><span leaf="">    limits = c(-<span>11</span>, <span>11</span>) <span>#x轴范围，两侧对称才好看 x-axis range, symmetry on both sides looks good</span></span></code><code><span leaf="">  ) +</span></code><code><span leaf="">  <span>#或用下面这行：</span></span></code><code><span leaf="">  <span>#or use the line below:</span></span></code><code><span leaf="">  <span>#xlim(c(xmin, xmax)) + </span></span></code><code><span leaf="">  <span>#画阈值分界线</span></span></code><code><span leaf="">  <span>#draw threshold boundary line</span></span></code><code><span leaf="">  geom_vline(xintercept = c(-logFCcut, logFCcut), color=<span>"grey40"</span>, </span></code><code><span leaf="">             linetype=<span>"longdash"</span>, lwd = <span>0</span>.<span>5</span>) + <span>#虚线的形状和粗细 shape and thickness of the dashed line</span></span></code><code><span leaf="">  geom_hline(yintercept = -log1<span>0</span>(pvalCut), color=<span>"grey40"</span>, </span></code><code><span leaf="">             linetype=<span>"longdash"</span>, lwd = <span>0</span>.<span>5</span>) +</span></code><code><span leaf=""><br></span></code><code><span leaf="">  theme_bw(base_size = <span>12</span><span>#, base_family = "Times" #修改字体 modify font</span></span></code><code><span leaf="">           ) +</span></code><code><span leaf="">  theme(panel.grid=element_blank())</span></code><code><span leaf=""><span>if</span> (plot_mode == <span>"advanced"</span>) {</span></code><code><span leaf="">  p1 &lt;- p1 + </span></code><code><span leaf="">  geom_vline(xintercept = c(-logFCcut2, logFCcut2), color=<span>"grey40"</span>, </span></code><code><span leaf="">             linetype=<span>"longdash"</span>, lwd = <span>0</span>.<span>5</span>) +</span></code><code><span leaf="">  geom_hline(yintercept = -log1<span>0</span>(pvalCut2), color=<span>"grey40"</span>, </span></code><code><span leaf="">             linetype=<span>"longdash"</span>, lwd = <span>0</span>.<span>5</span>)</span></code><code><span leaf="">}</span></code><code><span leaf="">p1</span></code><code><span leaf=""><span># 显示 logFC &gt; n 的基因的基因名</span></span></code><code><span leaf=""><span># show gene names for genes with logFC &gt; n</span></span></code><code><span leaf="">n = <span>9</span></span></code><code><span leaf="">p1 + geom_text_repel(aes(<span>x</span> = logFC, <span>y</span> = -log1<span>0</span>(P.Value), </span></code><code><span leaf="">                               label = ifelse(logFC &gt; n, rownames(<span>x</span>),<span>""</span>)),</span></code><code><span leaf="">        colour=<span>"darkred"</span>, size = <span>5</span>, box.padding = unit(<span>0</span>.<span>35</span>, <span>"lines"</span>), </span></code><code><span leaf="">        point.padding = unit(<span>0</span>.<span>3</span>, <span>"lines"</span>))</span></code><code><span leaf=""><span># 突出显示候选基因</span></span></code><code><span leaf=""><span># highlight candidate genes</span></span></code><code><span leaf="">p2 &lt;- p1 + </span></code><code><span leaf="">  <span># 在感兴趣的基因外面画个黑色圈</span></span></code><code><span leaf="">  <span># draw a black circle around the gene of interest</span></span></code><code><span leaf="">  geom_point(data = selectgenes, alpha = <span>1</span>, size = <span>4.6</span>, shape = <span>1</span>, </span></code><code><span leaf="">             stroke = <span>1</span>, <span>#圈粗细 thickness of circle</span></span></code><code><span leaf="">             color = <span>"black"</span>) +</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 显示感兴趣的基因的基因名</span></span></code><code><span leaf="">  <span># display the gene name of the gene of interest</span></span></code><code><span leaf="">  scale_color_manual(<span>values</span> = mycol) + </span></code><code><span leaf="">  geom_text_repel(data = selectgenes, </span></code><code><span leaf="">                  show.legend = FALSE, <span>#不显示图例 legend not displayed</span></span></code><code><span leaf="">                  size = <span>5</span>, box.padding = unit(<span>0</span>.<span>35</span>, <span>"lines"</span>), </span></code><code><span leaf="">        point.padding = unit(<span>0</span>.<span>3</span>, <span>"lines"</span>)) +</span></code><code><span leaf="">  guides(color=guide_legend(title = NULL)) </span></code><code><span leaf="">p2</span></code><code><span leaf=""><span># 显示pathway</span></span></code><code><span leaf=""><span># show pathway</span></span></code><code><span leaf="">np &lt;- <span>length</span>(unique(selectgenes$pathway))</span></code><code><span leaf="">(labelsInfo &lt;- data.frame(pathway = names(table(selectgenes$pathway)),</span></code><code><span leaf="">                         col = mycol[<span>1</span>:np]))</span></code><code><span leaf="">p2 + annotation_custom(tableGrob(labelsInfo$pathway, rows = c(rep(<span>""</span>, np)), cols = <span>""</span>,</span></code><code><span leaf="">                                 theme = ttheme_minimal(base_colour = labelsInfo$col)),</span></code><code><span leaf="">                       ymin = ymax - <span>2</span>, ymax = ymax, xmin = xmin - <span>1.5</span>, xmax = xmin)</span></code><code><span leaf=""><span># 保存到PDF文件</span></span></code><code><span leaf=""><span># save to PDF file</span></span></code><code><span leaf=""><span>if</span> (plot_mode == <span>"classic"</span>){</span></code><code><span leaf="">  ggsave(<span>"volcano_classic.pdf"</span>, width=<span>6</span>,height=<span>5</span>)</span></code><code><span leaf="">} <span>else</span> <span>if</span> (plot_mode == <span>"advanced"</span>) {</span></code><code><span leaf="">  ggsave(<span>"Volcano_advanced.pdf"</span>,width=<span>6</span>,height=<span>5</span>)</span></code><code><span leaf="">} <span>else</span> {</span></code><code><span leaf="">  stop(<span>"Unsupport mode"</span>)</span></code><code><span leaf="">}</span></code></pre></section><p><span leaf="">经典版</span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGbob10wRQBibtdEU6JCjibDhPL4bak99l7gvusN4rbTjUAsxMgVPicjicwJpg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7875598086124402" data-s="300,640" data-type="png" data-w="1045" type="block" data-imgfileid="100003437" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGbob10wRQBibtdEU6JCjibDhPL4bak99l7gvusN4rbTjUAsxMgVPicjicwJpg/640?wx_fmt=png&amp;from=appmsg"></span></p><p><span leaf=""><br></span></p><p><span leaf="">酷炫版</span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGboaNQ7z8jYuWEfSHjkNjKwqIGnKbGLhYkVfwt8FfHYHbicsicS1Zd8bFYg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100003436" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7Bwuzc7ay4tBK5QNAveriae7KGboaNQ7z8jYuWEfSHjkNjKwqIGnKbGLhYkVfwt8FfHYHbicsicS1Zd8bFYg/640?wx_fmt=png&amp;from=appmsg"></span></p><p><span leaf=""><br></span></p><section data-pm-slice="5 3 []"><section><span data-pm-slice="0 0 []"><h1 tabindex="-1" dir="auto" data-pm-slice="0 0 []"><span><strong><span><span leaf="">代码、输入、输出文件</span></span></strong></span></h1></span></section><p><span><span leaf="">https://github.com/ying-ge/FigureYa/tree/main/</span><span leaf="">FigureYa59volcanoV2</span></span></p><p><span leaf=""><br></span></p><p><span leaf="">下载某个FigureYa的压缩包</span></p><p><span leaf="">https://github.com/ying-ge/FigureYa-compressed</span></p><p><span leaf=""><br></span></p></section><h1 tabindex="-1" dir="auto" data-pm-slice="0 0 []"><span><strong><span><span leaf="">Citation</span></span></strong></span></h1><section><span><span leaf="">Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. https://doi.org/10.1002/imm3.70005</span></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/N4oKuJ1ahaBtcKoaHsJbcg",target="_blank" rel="noopener noreferrer">原文链接</a>
