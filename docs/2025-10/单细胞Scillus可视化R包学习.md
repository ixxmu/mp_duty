---
title: "单细胞Scillus可视化R包学习"
date: 2025-10-05T23:16:44Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
单细胞Scillus可视化R包学习 by 生信方舟
------
<div><section><span leaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="生信方舟" data-alias="shengxinfangzhou" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGfe15Xm0WHdoAMNGvE93bmxaF9iabfPiaO9ic6Tmd8XW1PMiaeuqicSFhCLQJibAUhHsamS1LbaJMFiaZXA/0?wx_fmt=png" data-signature="热爱医学和数据科学，站在巨人的肩膀上，学习和整理相关的知识。" data-id="MzkwMjYyMDA1OA==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></span></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005461" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKRMd5XkZ16JVBQicebiaK6c6s0E5RUwQiacCsYXWiafUx2OaibLjSTALZl6w/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKRMd5XkZ16JVBQicebiaK6c6s0E5RUwQiacCsYXWiafUx2OaibLjSTALZl6w/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">Scillus分析流程</span></span><span></span></h4><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.导入</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list = ls())</span><br><span><span leaf="">library</span></span><span leaf="">(Scillus)</span><br><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><br><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><br><span><span leaf="">library</span></span><span leaf="">(qs)</span><br><span leaf="">scRNA &lt;- qread(</span><span><span leaf="">"sc_dataset.qs"</span></span><span leaf="">)</span><br><br><span leaf="">DimPlot(scRNA,label = </span><span><span leaf="">T</span></span><span leaf="">)</span><br><span leaf="">colnames(scRNA@meta.data)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005463" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKSFvtsLzas076VfaMbicFSAsOg1PGhueSR7ibmBKwrflODB8iajT9b8zibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKSFvtsLzas076VfaMbicFSAsOg1PGhueSR7ibmBKwrflODB8iajT9b8zibg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.UMAP图展示</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">plot_scdata(scRNA, </span><br><span leaf="">            color_by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><br><span leaf="">            split_by = </span><span><span leaf="">NA</span></span><span leaf="">,</span><br><span leaf="">            pal_setup = </span><span><span leaf="">"Set1"</span></span><br><span leaf="">)</span><br><span leaf="">ggsave(</span><span><span leaf="">"celltype.pdf"</span></span><span leaf="">,width = </span><span><span leaf="">9</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><br><br><br><span leaf="">plot_scdata(scRNA, </span><br><span leaf="">            color_by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><br><span leaf="">            split_by = </span><span><span leaf="">"hpv"</span></span><span leaf="">,</span><br><span leaf="">            pal_setup = </span><span><span leaf="">"Set1"</span></span><span leaf=""> </span><span><span leaf=""># Dark2,也可以自定义颜色</span></span><br><span leaf="">)</span><br><span leaf="">ggsave(</span><span><span leaf="">"celltype.pdf"</span></span><span leaf="">,width = </span><span><span leaf="">18</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005460" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pK35qeywDhQyiaJtcpYlwzuiasH73bqBqCA37uibBdribmKt0F4btm13IdRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pK35qeywDhQyiaJtcpYlwzuiasH73bqBqCA37uibBdribmKt0F4btm13IdRQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.柱状图展示</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#"group_count", "prop_fill", and "prop_multi". 三种模式</span></span><br><span leaf="">plot_stat(scRNA, </span><br><span leaf="">          plot_type = </span><span><span leaf="">"group_count"</span></span><span leaf="">, </span><span><span leaf="">#"group_count", "prop_fill", and "prop_multi".</span></span><br><span leaf="">          group_by = </span><span><span leaf="">"hpv"</span></span><span leaf="">,</span><br><span leaf="">          pal_setup = </span><span><span leaf="">"Set2"</span></span><span leaf="">,</span><br><span leaf="">          plot_ratio = </span><span><span leaf="">1</span></span><span leaf="">,</span><br><span leaf="">          text_size = </span><span><span leaf="">10</span></span><span leaf="">,</span><br><span leaf="">          tilt_text = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br><br><span leaf="">plot_stat(scRNA, </span><br><span leaf="">          plot_type = </span><span><span leaf="">"prop_fill"</span></span><span leaf="">, </span><span><span leaf="">#"group_count", "prop_fill", and "prop_multi".</span></span><br><span leaf="">          group_by = </span><span><span leaf="">"hpv"</span></span><span leaf="">,</span><br><span leaf="">          pal_setup = </span><span><span leaf="">"Set2"</span></span><span leaf="">,</span><br><span leaf="">          plot_ratio = </span><span><span leaf="">1</span></span><span leaf="">,</span><br><span leaf="">          text_size = </span><span><span leaf="">10</span></span><span leaf="">,</span><br><span leaf="">          tilt_text = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br><br><span leaf="">plot_stat(scRNA, </span><br><span leaf="">          plot_type = </span><span><span leaf="">"prop_multi"</span></span><span leaf="">, </span><span><span leaf="">#"group_count", "prop_fill", and "prop_multi".</span></span><br><span leaf="">          group_by = </span><span><span leaf="">"hpv"</span></span><span leaf="">,</span><br><span leaf="">          pal_setup = </span><span><span leaf="">"Set2"</span></span><span leaf="">,</span><br><span leaf="">          plot_ratio = </span><span><span leaf="">1</span></span><span leaf="">,</span><br><span leaf="">          text_size = </span><span><span leaf="">10</span></span><span leaf="">,</span><br><span leaf="">          tilt_text = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005464" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKRFSadgksd6Hybvj3ia0YjKKRQl0RCyn7shSMF6yibu6qezId6nibocC7Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKRFSadgksd6Hybvj3ia0YjKKRQl0RCyn7shSMF6yibu6qezId6nibocC7Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.热图绘制</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 正式绘图</span></span><br><span leaf="">markers &lt;- FindAllMarkers(scRNA, logfc.threshold = </span><span><span leaf="">0.1</span></span><span leaf="">, min.pct = </span><span><span leaf="">0</span></span><span leaf="">, only.pos = </span><span><span leaf="">T</span></span><span leaf="">)</span><br><span leaf="">plot_heatmap(dataset = scRNA, </span><br><span leaf="">              markers = markers,</span><br><span leaf="">              sort_var = c(</span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span><span leaf="">"hpv"</span></span><span leaf="">),</span><br><span leaf="">              anno_var = c(</span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span><span leaf="">"hpv"</span></span><span leaf="">),</span><br><span leaf="">              anno_colors = list(</span><span><span leaf="">"Set2"</span></span><span leaf="">,</span><br><span leaf="">                                 c(</span><span><span leaf="">"tomato"</span></span><span leaf="">,</span><span><span leaf="">"<a topic-id="mgdvykbq-axj4ah" data-topic="1">#009CB8</a>"</span></span><span leaf="">)</span><br><span leaf="">                                 ))</span><br><br><br><span leaf="">plot_heatmap(dataset = scRNA,</span><br><span leaf="">             n = </span><span><span leaf="">6</span></span><span leaf="">,</span><span><span leaf=""># 每个聚类要绘制的基因数量。若指定标记基因，则此参数将不会被使用。</span></span><br><span leaf="">             markers = markers,</span><br><span leaf="">             sort_var = c(</span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span><span leaf="">"hpv"</span></span><span leaf="">),</span><br><span leaf="">             anno_var = c(</span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span><span leaf="">"hpv"</span></span><span leaf="">),</span><br><span leaf="">             anno_colors = list(</span><span><span leaf="">"Set2"</span></span><span leaf="">,</span><br><span leaf="">                                 c(</span><span><span leaf="">"tomato"</span></span><span leaf="">,</span><span><span leaf="">"<a topic-id="mgdvykbq-ysqpvh" data-topic="1">#009CB8</a>"</span></span><span leaf="">)</span><br><span leaf="">                                 ),</span><br><span leaf="">             hm_limit = c(-</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><br><span leaf="">             hm_colors = c(</span><span><span leaf="">"purple"</span></span><span leaf="">,</span><span><span leaf="">"black"</span></span><span leaf="">,</span><span><span leaf="">"yellow"</span></span><span leaf="">))</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005462" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKdYRDiaKYhHRiagKGIcdg38ibXnQRjP90FuAj2rwtqKZs0vflhvyzv7N2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKdYRDiaKYhHRiagKGIcdg38ibXnQRjP90FuAj2rwtqKZs0vflhvyzv7N2w/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100005468" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKPuy9oJyHw6qvH7DM1evOZ2WW59PvQqZBXibicGWHrLlZwBaZAdB0K11A/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKPuy9oJyHw6qvH7DM1evOZ2WW59PvQqZBXibicGWHrLlZwBaZAdB0K11A/640?wx_fmt=png&amp;from=appmsg"></span></p><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">5.GO富集分析</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 默认提取前100个基因</span></span><br><span><span leaf=""># 采用的是FinderMarker后的差异基因</span></span><br><span leaf="">plot_cluster_go(markers, </span><br><span leaf="">                cluster_name = </span><span><span leaf="">"myeloid cells"</span></span><span leaf="">, </span><br><span leaf="">                org = </span><span><span leaf="">"human"</span></span><span leaf="">, </span><span><span leaf=""># 物种</span></span><br><span leaf="">                ont = </span><span><span leaf="">"CC"</span></span><span leaf="">) </span><span><span leaf=""># Go分析的方法</span></span><br><br><span><span leaf=""># 全部细胞</span></span><br><span leaf="">plot_all_cluster_go(markers, org = </span><span><span leaf="">"human"</span></span><span leaf="">, ont = </span><span><span leaf="">"CC"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005467" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKibY9YGWCCu7GKiaveVqMdxSxOpNK0sz4Df3ETbzp5lBJQIee4jgpSiclQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKibY9YGWCCu7GKiaveVqMdxSxOpNK0sz4Df3ETbzp5lBJQIee4jgpSiclQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">6.“测量”数据绘制</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""><a topic-id="mgdvykbq-x7nrlj" data-topic="1">#在元数据中</a>，这些测量指标被定义为连续变量，与基因表达值类似。函数 plot_measure() 和 plot_measure_dim()分别用于以箱线图或小提琴图，以及降维可视化的方式对这些变量进行汇总展示。参数 group_by、split_by 和 pal_setup 的使用方式与前述部分一致。</span></span><br><span leaf="">plot_measure(dataset = scRNA, </span><br><span leaf="">             measures = c(</span><span><span leaf="">"KRT14"</span></span><span leaf="">,</span><span><span leaf="">"percent.mt"</span></span><span leaf="">), </span><br><span leaf="">             group_by = </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">, </span><br><span leaf="">             pal_setup = </span><span><span leaf="">"Set2"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005469" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKnsq2u8URonqwrIficPLgcFH2GlSsYrn5iaLh7fuL0E9Z9cIpTPp3bDeA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKnsq2u8URonqwrIficPLgcFH2GlSsYrn5iaLh7fuL0E9Z9cIpTPp3bDeA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">7.plot_measure_dim</span></span><span></span></h5><p data-tool="mdnice编辑器"><span leaf="">好像暂时不能用了</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">plot_measure_dim(dataset = scRNA, </span><br><span leaf="">                 measures = c(</span><span><span leaf="">"nFeature_RNA"</span></span><span leaf="">))</span><br><span leaf="">                </span><span><span leaf=""># split_by = "GSE_num")</span></span><br></code></pre><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">8.GSEA分析</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">de &lt;- find_diff_genes(dataset = scRNA, </span><br><span leaf="">                      clusters = </span><span><span leaf="">"fibroblasts"</span></span><span leaf="">,</span><br><span leaf="">                      comparison = c(</span><span><span leaf="">"hpv"</span></span><span leaf="">, </span><br><span leaf="">                                     </span><span><span leaf="">"HPV-"</span></span><span leaf="">,</span><span><span leaf="">"HPV+"</span></span><span leaf="">),</span><br><span leaf="">                      logfc.threshold = </span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf=""># threshold of 0 is used for GSEA</span></span><br><span leaf="">                      min.cells.group = </span><span><span leaf="">1</span></span><span leaf="">)  </span><span><span leaf=""># To include clusters with only 1 cell</span></span><br><br><span leaf="">gsea_res &lt;- test_GSEA(de, </span><br><span leaf="">                      pathway = pathways.hallmark)</span><br><br><span leaf="">plot_GSEA(gsea_res, p_cutoff = </span><span><span leaf="">0.1</span></span><span leaf="">, </span><br><span leaf="">          colors = c(</span><span><span leaf="">"<a topic-id="mgdvykbq-lb1vqc" data-topic="1">#0570b0</a>"</span></span><span leaf="">, </span><span><span leaf="">"grey"</span></span><span leaf="">, </span><span><span leaf="">"<a topic-id="mgdvykbq-ymv83b" data-topic="1">#d7301f</a>"</span></span><span leaf="">))</span><br><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100005466" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKDZOezJ6kaU5Eq2GAUvjr4gT0UFIcDxcfJEwVgwyhh1noEIhrEl81JA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEtWicNqRdPoaxPuWbt9z6pKDZOezJ6kaU5Eq2GAUvjr4gT0UFIcDxcfJEwVgwyhh1noEIhrEl81JA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">参考资料：</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">1.Scillus：https://scillus.netlify.app/</span></p></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><strong><span leaf="">注</span></strong><span leaf="">：若对内容有疑惑或者有发现明确错误的朋友，请联系后台。更多相关内容可关注公众号：</span><strong><span leaf="">生信方舟</span></strong><span leaf=""> 。</span></p><h2 data-tool="mdnice编辑器"><span></span><span></span><span><span leaf="">结尾</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">欢迎加入"</span><strong><span leaf="">生信&amp;临床</span></strong><span leaf="">“交流群，若有意向进群的小伙伴请加微信：</span><strong><span leaf="">couqiliugeziba321</span></strong><span leaf="">，请注明“</span><strong><span leaf="">单位或学校-专业或方向-姓名或昵称</span></strong><span leaf="">”。希望进群的你收获知识的同时也能够收获快乐~ 🤗<img data-imgfileid="100004857" data-ratio="0.5625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="720" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/0SOG4MpDAyGHBmXVUqkHD93kSXqreoiaJCE8Dqgoo5icEaOOkaoO6WBVHAibwCYWM1E6rodTMyJ76qc3ZibeakWg7g/640?wx_fmt=jpeg&amp;from=appmsg"></span></p></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p></section></section><section><span><span leaf="">- END -</span></span></section><p></p><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_U-grI8gjcAAUELt2he1wg",target="_blank" rel="noopener noreferrer">原文链接</a>
