---
title: "R语言绘图|二维数据密度图"
date: 2025-03-21T09:53:44Z
draft: ["false"]
tags: [
  "fetched",
  "日常分享的小懒猫"
]
categories: ["Acdemic"]
---
R语言绘图|二维数据密度图 by 日常分享的小懒猫
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com">点击关注了解更多哦</section><section><mpprofile data-pluginname="mpprofile" data-id="Mzg3NjcxNzA1OQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz1Aj6GghPUiaekGRqnMLKFXan3WGXu3lXKbr3XR5r8rdnuupYN3Oiad3WgI9qts6iciabavAHhKrVeCfw/0?wx_fmt=png" data-nickname="日常分享的小懒猫" data-alias="zhangtongxue_2021" data-signature="学习记录" data-from="0"></mpprofile></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">本文主要展示如何利用<strong>ggplot2</strong>绘制二维数据的密度图(Density Plot of Two-Dimensional)。绘制效果如下：<img data-ratio="0.7222222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQgzYkiciaicjAsSeuc7J2URUibGuerUTJQibYoaNrAVlPblzuiapzZUicicf5WA/640?wx_fmt=png" data-type="png" data-w="1800" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQgzYkiciaicjAsSeuc7J2URUibGuerUTJQibYoaNrAVlPblzuiapzZUicicf5WA/640?wx_fmt=png"></p><h2 data-tool="mdnice编辑器"><span></span>1、数据准备</h2><p data-tool="mdnice编辑器">使用<strong>gcookbook</strong>包中<strong>heightweight</strong>数据集，绘制变量<strong>ageYear</strong>与变量<strong>heightIn</strong>二者间的散点图，进行二维数据密度图刻画。</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggplot2) <br>library(gcookbook)<br>library(RColorBrewer)<br>head(heightweight)<br><span>#  sex ageYear ageMonth heightIn weightLb</span><br><span>#1   f   11.92      143     56.3     85.0</span><br><span>#2   f   12.92      155     62.3    105.0</span><br><span>#3   f   12.75      153     63.3    108.0</span><br><span>#4   f   13.42      161     59.0     92.0</span><br><span>#5   f   15.92      191     62.5    112.5</span><br><span>#6   f   14.25      171     62.5    112.0</span><br>str(heightweight)<br><span>#'data.frame': 236 obs. of  5 variables:</span><br><span># $ sex     : Factor w/ 2 levels "f","m": 1 1 1 1 1 1 1 1 1 1 ...</span><br><span># $ ageYear : num  11.9 12.9 12.8 13.4 15.9 ...</span><br><span># $ ageMonth: int  143 155 153 161 191 171 185 142 160 140 ...</span><br><span># $ heightIn: num  56.3 62.3 63.3 59 62.5 62.5 59 56.5 62 53.8 ...</span><br><span># $ weightLb: num  85 105 108 92 112 ...</span><br></code></pre><h2 data-tool="mdnice编辑器"><span></span>2、图形绘制</h2><blockquote data-tool="mdnice编辑器"><p>2.1 散点图</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  geom_point(colour = <span>"black"</span>) + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQPhNldYse8hWMNIdfun2eoDcicePCQ68iaAAHibRvUjkKCuWZZibLNPuC8Q/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQPhNldYse8hWMNIdfun2eoDcicePCQ68iaAAHibRvUjkKCuWZZibLNPuC8Q/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.2 等高线图</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(color = <span>"black"</span>, size = 1) + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQp7v8b6DQSXYPEwjFhGd2oletibZdQibkqxU2qofUE8FOThGmsmicjic77g/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQp7v8b6DQSXYPEwjFhGd2oletibZdQibkqxU2qofUE8FOThGmsmicjic77g/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.3 等高线图+散点图</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(color = <span>"black"</span>, size = 1) + <br>  geom_point(colour = <span>"black"</span>) + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQL79sDe739N1ia4IHlGHUMeYUfiax4bU6rvhflpsoHf0J6VVbxKv1uLTg/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQL79sDe739N1ia4IHlGHUMeYUfiax4bU6rvhflpsoHf0J6VVbxKv1uLTg/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.4 将密度映射到等高线</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(aes(color = ..level..), size = 1.5) + <br>  geom_point(colour = <span>"black"</span>) + <br>  scale_color_distiller(palette = <span>"RdYlGn"</span>) + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQM2WcDiaUNBqVvJsXBoqqgwm6o0z6lcLNvywJPm2X0MOp1gqbJBianYuQ/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQM2WcDiaUNBqVvJsXBoqqgwm6o0z6lcLNvywJPm2X0MOp1gqbJBianYuQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.5 geom = "tile"</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(geom = <span>"tile"</span>, aes(fill = ..density..), contour = FALSE) + <br>  scale_fill_distiller(palette = <span>"RdYlGn"</span>) + <br>  theme_bw()<br></code></pre><blockquote data-tool="mdnice编辑器"><p>2.6 geom = "raster"</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(geom = <span>"raster"</span>, aes(fill = ..density..), contour = FALSE) + <br>  scale_fill_distiller(palette = <span>"RdYlGn"</span>)  + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQvNw7DprOKyuS3Pz40TRLpPz7kn2IqQzA4nPOy75Wj22xuBIZqP4PXQ/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQvNw7DprOKyuS3Pz40TRLpPz7kn2IqQzA4nPOy75Wj22xuBIZqP4PXQ/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.7 对带宽进行调整</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(geom = <span>"raster"</span>, aes(fill = ..density..), contour = FALSE, h = c(1, 5)) +  <span># 修改带宽</span><br>  scale_fill_distiller(palette = <span>"RdYlGn"</span>)  + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQicspNDu6SiaHzbc5ZV3oHibmFuePO3xpibyxjnmdPKBd1fVmLbmEWrfFCw/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQicspNDu6SiaHzbc5ZV3oHibmFuePO3xpibyxjnmdPKBd1fVmLbmEWrfFCw/640?wx_fmt=png"></figure><blockquote data-tool="mdnice编辑器"><p>2.8 综合</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>ggplot(data = heightweight, aes(ageYear, heightIn)) + <br>  stat_density2d(geom = <span>"raster"</span>, aes(fill = ..density..), contour = FALSE) + <br>  stat_density2d(color = <span>"black"</span>, size = 1) + <br>  geom_point(colour = <span>"black"</span>) + <br>  scale_fill_distiller(palette = <span>"RdYlGn"</span>)  + <br>  theme_bw()<br></code></pre><figure data-tool="mdnice编辑器"><img data-ratio="1.0374753451676528" data-src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQCwosz56jqibFBUu1aGIiaGIswgriaDkhXIDZ5OqHYyKGsCEbL4FQdXa3A/640?wx_fmt=png" data-type="png" data-w="507" src="https://mmbiz.qpic.cn/mmbiz_png/icp3keOEXvz23PZK2EUNmVFiaCHFibhXXLQCwosz56jqibFBUu1aGIiaGIswgriaDkhXIDZ5OqHYyKGsCEbL4FQdXa3A/640?wx_fmt=png"></figure><h2 data-tool="mdnice编辑器"><span></span>3、其他</h2><p data-tool="mdnice编辑器">关于二维密度图的更多内容可参考<code>Winston Chang</code>的 <span>R Graphics Cookbook</span><sup>[1]</sup>一书。关于<strong>散点图</strong>绘制可参考<a href="https://mp.weixin.qq.com/s?__biz=Mzg3NjcxNzA1OQ==&amp;mid=2247484797&amp;idx=1&amp;sn=e326cd7be84581979de89cf11d9573e7&amp;chksm=cf2cb011f85b390775464717fd6f088d6fb1ea3c0b9ae0e24a7aebdbeb1f90ee6ee40768ca31&amp;token=596682512&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R语言绘图|散点图与回归拟合曲线</a>。</p><hr data-tool="mdnice编辑器"><h2 data-tool="mdnice编辑器"><span></span> 如有帮助请多多点赞哦！</h2><h3 data-tool="mdnice编辑器"><span>参考资料</span></h3><section data-tool="mdnice编辑器"><span><span>[1]</span><p>Making a Density Plot of Two-Dimensional Data: <em>https://r-graphics.org/recipe-distribution-density2d#RECIPE-DISTRIBUTION-DENSITY2D</em></p></span></section></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><br></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oimeuwjAaWbTCQhVcVSHpQ",target="_blank" rel="noopener noreferrer">原文链接</a>
