---
title: "差异基因展示再探"
date: 2025-03-29T09:20:20Z
draft: ["false"]
tags: [
  "fetched",
  "生信杂货铺"
]
categories: ["Acdemic"]
---
差异基因展示再探 by 生信杂货铺
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">前言</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">最近又尝试了其它几种差异基因展示，再次整理汇总一下绘制思路</span></p><p data-tool="mdnice编辑器"><span leaf="">先导入几个包</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#| message: false</span></span><br><br><span><span leaf="">library</span></span><span leaf="">(ggprism)</span><br><span><span leaf="">library</span></span><span leaf="">(ggrepel)</span><br><span><span leaf="">library</span></span><span leaf="">(GEOquery)</span><br><span><span leaf="">library</span></span><span leaf="">(tidyverse)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">定义颜色</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">pal &lt;- c(</span><span><span leaf="">'#fdfbe4'</span></span><span leaf="">, </span><span><span leaf="">'#a3ad62'</span></span><span leaf="">, </span><span><span leaf="">'#df91a3'</span></span><span leaf="">)</span><br><span leaf="">pal.grad &lt;- colorRampPalette(pal[c(</span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">3</span></span><span leaf="">)])(</span><span><span leaf="">50</span></span><span leaf="">)</span><br></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span><span leaf="">数据</span></span><span data-cacheurl="" data-remoteid=""></span></h3><p data-tool="mdnice编辑器"><span leaf="">这次的数据来自 </span><code><span leaf="">GSE213815</span></code><span leaf="">，检测了 </span><code><span leaf="">Yap1</span></code><span leaf=""> </span><code><span leaf="">KO</span></code><span leaf=""> 之后的表达。</span></p><p data-tool="mdnice编辑器"><span leaf="">首先，读取样本信息</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">sample_info &lt;- read_csv(</span><span><span leaf="">'data/SraRunTable.csv'</span></span><span leaf="">, show_col_types = </span><span><span leaf="">FALSE</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    dplyr::select(</span><span><span leaf="">'Sample Name'</span></span><span leaf="">, genotype)</span><br><br><span leaf="">sample_list &lt;- split(sample_info$`Sample Name`, sample_info$genotype)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">读取表达谱，用于计算基因在两组之中的表达均值</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">exp &lt;- read_tsv(</span><span><span leaf="">'data/expression.tsv'</span></span><span leaf="">, show_col_types = </span><span><span leaf="">FALSE</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    dplyr::select(gene_name, ends_with(</span><span><span leaf="">'TPM'</span></span><span leaf="">)) %&gt;%</span><br><span leaf="">    dplyr::rename_with(</span><span><span leaf="">function</span></span><span leaf="">(x) str_remove(x, </span><span><span leaf="">'_TPM'</span></span><span leaf="">)) %&gt;%</span><br><span leaf="">    rowwise(gene_name) %&gt;%</span><br><span leaf="">    reframe(</span><br><span leaf="">        KO = mean(c_across(sample_list$`YAP1 KO`)),</span><br><span leaf="">        WT = mean(c_across(sample_list$`Wild type`))</span><br><span leaf="">    )</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">读取差异表达基因列表</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DEGs &lt;- read_csv(</span><span><span leaf="">'data/DEGs.all.csv'</span></span><span leaf="">, </span><br><span leaf="">                 show_col_types = </span><span><span leaf="">FALSE</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    dplyr::filter(!is.na(pvalue) &amp; !is.na(qvalue)) %&gt;%</span><br><span leaf="">    mutate( </span><br><span leaf="">       group = case_when(</span><br><span leaf="">           qvalue &lt; </span><span><span leaf="">0.05</span></span><span leaf=""> &amp; log2FC &lt; -</span><span><span leaf="">1</span></span><span leaf=""> ~ </span><span><span leaf="">'Down'</span></span><span leaf="">,</span><br><span leaf="">           qvalue &lt; </span><span><span leaf="">0.05</span></span><span leaf=""> &amp; log2FC &gt; </span><span><span leaf="">1</span></span><span leaf=""> ~ </span><span><span leaf="">'Up'</span></span><span leaf="">,</span><br><span leaf="">           .default = </span><span><span leaf="">'None'</span></span><span leaf="">),</span><br><span leaf="">       group = factor(group, levels = c(</span><span><span leaf="">'None'</span></span><span leaf="">, </span><span><span leaf="">'Down'</span></span><span leaf="">, </span><span><span leaf="">'Up'</span></span><span leaf="">)),</span><br><span leaf="">       qvalue = ifelse(qvalue &lt; </span><span><span leaf="">1e-30</span></span><span leaf="">, </span><span><span leaf="">1e-30</span></span><span leaf="">, qvalue)</span><br><span leaf="">    ) %&gt;%</span><br><span leaf="">    arrange(log2FC) %&gt;%</span><br><span leaf="">    tibble::rowid_to_column(</span><span><span leaf="">'rank'</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    inner_join(exp, by = c(</span><span><span leaf="">'symbol'</span></span><span leaf=""> = </span><span><span leaf="">'gene_name'</span></span><span leaf="">)) %&gt;%</span><br><span leaf="">    arrange(group)</span><br><br><span leaf="">head(DEGs)</span><br><span><span leaf=""># # A tibble: 6 × 11</span></span><br><span><span leaf="">#    rank symbol  baseMean log2FC lfcSE  stat pvalue qvalue group    KO    WT</span></span><br><span><span leaf="">#   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span><span leaf=""># 1    35 Alpi        7.50  -6.52  3.91 -1.67 0.0958 0.239  None      0 1.82 </span></span><br><span><span leaf=""># 2    41 Capn11      5.65  -6.11  3.90 -1.57 0.117  0.276  None      0 1.22 </span></span><br><span><span leaf=""># 3    48 Krt20       4.18  -5.68  3.92 -1.45 0.148  0.325  None      0 1.22 </span></span><br><span><span leaf=""># 4    58 Muc3        2.92  -5.16  2.33 -2.22 0.0264 0.0912 None      0 0.277</span></span><br><span><span leaf=""># 5    65 Hrk         2.68  -5.04  2.05 -2.46 0.0138 0.0552 None      0 0.283</span></span><br><span><span leaf=""># 6    72 Rab26os     2.29  -4.82  2.01 -2.40 0.0164 0.0631 None      0 4.36 </span></span><br></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span><span leaf="">绘图</span></span><span data-cacheurl="" data-remoteid=""></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">渐变背景色</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">参数设置</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 上下、左右边距</span></span><br><span leaf="">width &lt;- c(</span><span><span leaf="">.5</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">)</span><br><span><span leaf=""># 长宽最大值</span></span><br><span leaf="">ymax &lt;- max(-log10(DEGs$qvalue))</span><br><span leaf="">xmax &lt;- max(abs(DEGs$log2FC))</span><br><span><span leaf=""># 背景渐变色插值，值越大渐变越平滑</span></span><br><span leaf="">number &lt;- </span><span><span leaf="">1000</span></span><br><span><span leaf=""># 渐变色数据</span></span><br><span leaf="">rect.data &lt;- expand.grid(</span><br><span leaf="">    x = seq(-xmax - width[</span><span><span leaf="">2</span></span><span leaf="">], xmax + width[</span><span><span leaf="">2</span></span><span leaf="">], </span><br><span leaf="">            length.out = number),</span><br><span leaf="">    y = seq(-width[</span><span><span leaf="">1</span></span><span leaf="">], ymax + width[</span><span><span leaf="">1</span></span><span leaf="">], </span><br><span leaf="">            length.out = number)</span><br><span leaf="">)</span><br><span><span leaf=""># 自定义 y 轴</span></span><br><span leaf="">y_breaks &lt;- scales::extended_breaks()(-log10(DEGs$qvalue))[-</span><span><span leaf="">1</span></span><span leaf="">]</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">需要展示的差异基因</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">top.data &lt;- dplyr::filter(DEGs, qvalue &lt; </span><span><span leaf="">0.05</span></span><span leaf="">) %&gt;% </span><br><span leaf="">    group_by(log2FC &lt; </span><span><span leaf="">0</span></span><span leaf="">) %&gt;% top_n(</span><span><span leaf="">10</span></span><span leaf="">, abs(log2FC))</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">绘图</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># pdf('degs_raster.pdf', width = 5, height = 4)</span></span><br><span leaf="">DEGs %&gt;%</span><br><span leaf="">    ggplot(aes(log2FC, -log10(qvalue), colour = group)) +</span><br><span leaf="">    geom_raster(</span><br><span leaf="">        aes(x = x, y = y, fill = x),</span><br><span leaf="">        data = rect.data,</span><br><span leaf="">        alpha = </span><span><span leaf="">0.3</span></span><span leaf="">,</span><br><span leaf="">        inherit.aes = </span><span><span leaf="">FALSE</span></span><span leaf="">,</span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    geom_point(</span><br><span leaf="">        aes(size = abs(log2FC)), alpha = </span><span><span leaf="">0.5</span></span><span leaf="">, </span><br><span leaf="">        stroke = </span><span><span leaf="">0</span></span><span leaf="">,</span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    geom_text_repel(</span><br><span leaf="">        aes(log2FC, -log10(qvalue), label = symbol),</span><br><span leaf="">        data = top.data,</span><br><span leaf="">        inherit.aes = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    geom_vline(xintercept = </span><span><span leaf="">0</span></span><span leaf="">, linewidth = </span><span><span leaf="">1</span></span><span leaf="">) +</span><br><span leaf="">    annotate(</span><br><span leaf="">        geom = </span><span><span leaf="">'segment'</span></span><span leaf="">,</span><br><span leaf="">        x = -</span><span><span leaf="">0.2</span></span><span leaf="">,</span><br><span leaf="">        y = y_breaks,</span><br><span leaf="">        xend = </span><span><span leaf="">0</span></span><span leaf="">,</span><br><span leaf="">        yend = y_breaks,</span><br><span leaf="">        linewidth = </span><span><span leaf="">1</span></span><br><span leaf="">    ) +</span><br><span leaf="">    annotate(</span><br><span leaf="">        </span><span><span leaf="">"text"</span></span><span leaf="">,</span><br><span leaf="">        x = -</span><span><span leaf="">0.3</span></span><span leaf="">, </span><br><span leaf="">        y = y_breaks,</span><br><span leaf="">        label = y_breaks,</span><br><span leaf="">        hjust = </span><span><span leaf="">1</span></span><span leaf="">,  </span><span><span leaf=""># 控制水平位置（负值向左，正值向右）</span></span><br><span leaf="">        color = </span><span><span leaf="">"black"</span></span><br><span leaf="">    ) +</span><br><span leaf="">    scale_color_manual(values = c(</span><span><span leaf="">'grey70'</span></span><span leaf="">, pal[</span><span><span leaf="">2</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">])) +</span><br><span leaf="">    scale_fill_gradientn(colours = pal.grad) +</span><br><span leaf="">    scale_size_continuous(range = c(</span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">4</span></span><span leaf="">)) +</span><br><span leaf="">    scale_x_continuous(expand = expansion(c(</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">0</span></span><span leaf="">))) +</span><br><span leaf="">    scale_y_continuous(expand = expansion(c(</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">0</span></span><span leaf="">))) +</span><br><span leaf="">    labs(y = </span><span><span leaf="">'-log10(p.adjust)'</span></span><span leaf="">, title = </span><span><span leaf="">'Yap1-KO'</span></span><span leaf="">) +</span><br><span leaf="">    theme_prism() +</span><br><span leaf="">    theme(</span><br><span leaf="">        axis.line.y = element_blank(),</span><br><span leaf="">        axis.ticks.y = element_blank(),</span><br><span leaf="">        axis.text.y = element_blank()</span><br><span leaf="">    )</span><br><span><span leaf=""># dev.off()</span></span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100018808" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqe3xsFXKObUicpOHibQ7Agficib0Xec6FfVVicMYJ9HvQjTOX2dibMicslWmJsQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqe3xsFXKObUicpOHibQ7Agficib0Xec6FfVVicMYJ9HvQjTOX2dibMicslWmJsQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">上下对称</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DEGs %&gt;% </span><br><span leaf="">    arrange(symbol) %&gt;%</span><br><span leaf="">    ggplot(aes(log10(baseMean), log2FC, colour = group)) +</span><br><span leaf="">    geom_point(aes(fill = group, shape = group), </span><br><span leaf="">               alpha = </span><span><span leaf="">0.7</span></span><span leaf="">, size = </span><span><span leaf="">3</span></span><span leaf="">,</span><br><span leaf="">               colour = </span><span><span leaf="">'grey50'</span></span><span leaf="">,</span><br><span leaf="">               stroke = </span><span><span leaf="">0.2</span></span><span leaf="">,</span><br><span leaf="">               show.legend = </span><span><span leaf="">FALSE</span></span><span leaf="">) +</span><br><span leaf="">    geom_point(</span><br><span leaf="">        data = top.data, size = </span><span><span leaf="">5</span></span><span leaf="">, fill = </span><span><span leaf="">NA</span></span><span leaf="">, </span><br><span leaf="">        shape = </span><span><span leaf="">21</span></span><span leaf="">, show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    ggrepel::geom_label_repel(</span><br><span leaf="">        aes(label = symbol),</span><br><span leaf="">        data = top.data, size = </span><span><span leaf="">4</span></span><span leaf="">,</span><br><span leaf="">        max.overlaps = </span><span><span leaf="">1000</span></span><span leaf="">,</span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    annotate(geom = </span><span><span leaf="">'label'</span></span><span leaf="">, x = </span><span><span leaf="">5</span></span><span leaf="">, y = </span><span><span leaf="">6</span></span><span leaf="">, label = </span><span><span leaf="">'Up'</span></span><span leaf="">,</span><br><span leaf="">             size = </span><span><span leaf="">6</span></span><span leaf="">, fill = </span><span><span leaf="">'#df91a3'</span></span><span leaf="">, colour = </span><span><span leaf="">'#525e61'</span></span><span leaf="">,</span><br><span leaf="">             alpha = </span><span><span leaf="">0.8</span></span><span leaf="">) +</span><br><span leaf="">    annotate(geom = </span><span><span leaf="">'label'</span></span><span leaf="">, x = </span><span><span leaf="">5</span></span><span leaf="">, y = -</span><span><span leaf="">6</span></span><span leaf="">, label = </span><span><span leaf="">'Down'</span></span><span leaf="">,</span><br><span leaf="">             size = </span><span><span leaf="">6</span></span><span leaf="">, fill = </span><span><span leaf="">'#a3ad62'</span></span><span leaf="">, colour = </span><span><span leaf="">'#525e61'</span></span><span leaf="">,</span><br><span leaf="">             alpha = </span><span><span leaf="">0.8</span></span><span leaf="">) +</span><br><span leaf="">    labs(title = </span><span><span leaf="">'Yap1-KO'</span></span><span leaf="">) +</span><br><span leaf="">    scale_colour_manual(values = pal[</span><span><span leaf="">2</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">]) +</span><br><span leaf="">    scale_fill_manual(values = pal) +</span><br><span leaf="">    scale_shape_manual(values = c(</span><span><span leaf="">'Up'</span></span><span leaf=""> = </span><span><span leaf="">24</span></span><span leaf="">, </span><span><span leaf="">'None'</span></span><span leaf=""> = </span><span><span leaf="">21</span></span><span leaf="">, </span><span><span leaf="">'Down'</span></span><span leaf=""> = </span><span><span leaf="">25</span></span><span leaf="">)) +</span><br><span leaf="">    ggprism::theme_prism()</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100018807" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqe46iazpVSn9ESqxqK0E74GhfKRAlPmibLibQONU1IcU07Ol7nqFL7698qQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqe46iazpVSn9ESqxqK0E74GhfKRAlPmibLibQONU1IcU07Ol7nqFL7698qQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">排序</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DEGs %&gt;%</span><br><span leaf="">    ggplot(aes(rank, log2FC, colour = log2FC)) +</span><br><span leaf="">    geom_point(</span><br><span leaf="">        aes(size = abs(log2FC)), </span><br><span leaf="">        alpha = </span><span><span leaf="">0.5</span></span><span leaf="">, </span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    geom_point(</span><br><span leaf="">        aes(size = abs(log2FC)),</span><br><span leaf="">        data = top.data,</span><br><span leaf="">        fill = </span><span><span leaf="">NA</span></span><span leaf="">, colour = </span><span><span leaf="">'grey60'</span></span><span leaf="">,</span><br><span leaf="">        shape = </span><span><span leaf="">21</span></span><span leaf="">,</span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    geom_label_repel(</span><br><span leaf="">        aes(label = symbol), </span><br><span leaf="">        data = top.data,</span><br><span leaf="">        max.overlaps = </span><span><span leaf="">2000</span></span><br><span leaf="">    ) +</span><br><span leaf="">    labs(title = </span><span><span leaf="">'Yap1-KO'</span></span><span leaf="">) +</span><br><span leaf="">    scale_colour_gradientn(colours = pal.grad) +</span><br><span leaf="">    ggprism::theme_prism() +</span><br><span leaf="">    theme(legend.title = element_text(size = </span><span><span leaf="">12</span></span><span leaf="">))</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100018806" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqeQ5RcmdPv1XFKaqBlzSXCHPxuXZykvh6BGic406XMjQ76pwFYUmBFUFA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqeQ5RcmdPv1XFKaqBlzSXCHPxuXZykvh6BGic406XMjQ76pwFYUmBFUFA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">对角线</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ggplot(DEGs, aes(log2(WT), log2(KO), colour = group)) +</span><br><span leaf="">    geom_point(</span><br><span leaf="">        size = </span><span><span leaf="">3</span></span><span leaf="">, </span><br><span leaf="">        alpha = </span><span><span leaf="">0.8</span></span><span leaf="">, </span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    ggrepel::geom_label_repel(</span><br><span leaf="">        aes(label = symbol),</span><br><span leaf="">        data = top.data, </span><br><span leaf="">        max.overlaps = </span><span><span leaf="">1000</span></span><span leaf="">,</span><br><span leaf="">        show.legend = </span><span><span leaf="">FALSE</span></span><br><span leaf="">    ) +</span><br><span leaf="">    annotate(geom = </span><span><span leaf="">'label'</span></span><span leaf="">, x = -</span><span><span leaf="">5</span></span><span leaf="">, y = </span><span><span leaf="">15</span></span><span leaf="">, label = </span><span><span leaf="">'Up'</span></span><span leaf="">,</span><br><span leaf="">             size = </span><span><span leaf="">6</span></span><span leaf="">, fill = </span><span><span leaf="">'#df91a3'</span></span><span leaf="">, colour = </span><span><span leaf="">'#525e61'</span></span><span leaf="">, </span><br><span leaf="">             alpha = </span><span><span leaf="">0.8</span></span><span leaf="">) +</span><br><span leaf="">    annotate(geom = </span><span><span leaf="">'label'</span></span><span leaf="">, x = </span><span><span leaf="">15</span></span><span leaf="">, y = -</span><span><span leaf="">5</span></span><span leaf="">, label = </span><span><span leaf="">'Down'</span></span><span leaf="">,</span><br><span leaf="">             size = </span><span><span leaf="">6</span></span><span leaf="">, fill = </span><span><span leaf="">'#a3ad62'</span></span><span leaf="">, colour = </span><span><span leaf="">'#525e61'</span></span><span leaf="">, </span><br><span leaf="">             alpha = </span><span><span leaf="">0.8</span></span><span leaf="">) +</span><br><span leaf="">    labs(x = </span><span><span leaf="">'WT'</span></span><span leaf="">, y = </span><span><span leaf="">'KO'</span></span><span leaf="">, title = </span><span><span leaf="">'Yap1-KO'</span></span><span leaf="">) +</span><br><span leaf="">    scale_colour_manual(values = pal) +</span><br><span leaf="">    ggprism::theme_prism()</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100018809" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqeKdDhBzyiaumWpLGPwRTL1mnOxGYzQ6l9Ebv0P2OG2qcricfr4NEIE9fw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJrfReUvPxng0zRsHPbpKqeKdDhBzyiaumWpLGPwRTL1mnOxGYzQ6l9Ebv0P2OG2qcricfr4NEIE9fw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">结尾</span></span><span></span></h2><hr><p data-tool="mdnice编辑器"><span leaf="">任何代码的问题都可以在知识星球中提问，自愿加入。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100018805" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/R14BjDEcNWJrfReUvPxng0zRsHPbpKqedEQN7r3ozyk6PdbXb9p7yEaFibCZxzM3FICxqV6A27qwOeQgRBg9UJA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/R14BjDEcNWJrfReUvPxng0zRsHPbpKqedEQN7r3ozyk6PdbXb9p7yEaFibCZxzM3FICxqV6A27qwOeQgRBg9UJA/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/HJinqxfkG1linwllTsj0DQ",target="_blank" rel="noopener noreferrer">原文链接</a>
