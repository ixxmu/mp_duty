---
title: "Umap图可视化细胞类型比例差异"
date: 2025-03-14T01:07:48Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
Umap图可视化细胞类型比例差异 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">前几篇推文基于</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527174&amp;idx=1&amp;sn=11c6f1e72232a33e883d9bb3ec4a8621&amp;scene=21#wechat_redirect"><span leaf="">胃癌单细胞图谱：探索肿瘤微环境与亚型特异性表达模式</span></a><span leaf="">完成了Figure1的大部分图表复现：</span></strong></p><ul><li><section><span leaf="">Fiugre1B——</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528101&amp;idx=1&amp;sn=51d148ddce142aef494be8f528595506&amp;scene=21#wechat_redirect"><span leaf="">UMAP图新解：首次分群后按大类分组加圈</span></a></section></li><li><section><span leaf="">Figure1C——</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528319&amp;idx=1&amp;sn=908f4e12fcbda8795a357a55cea84a96&amp;scene=21#wechat_redirect"><span leaf="">多维度细胞比例图揭示细胞构成差异</span></a></section></li><li><section><span leaf="">Figure1D——</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527174&amp;idx=1&amp;sn=11c6f1e72232a33e883d9bb3ec4a8621&amp;scene=21#wechat_redirect"><span leaf="">胃癌单细胞图谱：探索肿瘤微环境与亚型特异性表达模式</span></a></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">接下来就复现并尝试美化一下</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528360&amp;idx=1&amp;sn=b48abad2bb106d98103efd7dfb226e6c&amp;scene=21#wechat_redirect"><span leaf="">单细胞测序揭示EGFR突变如何改变肺腺癌的免疫微环境</span></a><span leaf="">的Figure1</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZqjkthXV7Cv1tWtPeTcAkEtskb3gCbC3ptE0uSbZdNQiaVZpzITv4jaQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8009259259259259" data-type="png" data-w="1080" data-imgfileid="100044858" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZqjkthXV7Cv1tWtPeTcAkEtskb3gCbC3ptE0uSbZdNQiaVZpzITv4jaQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">在直播分享</span><a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247492935&amp;idx=1&amp;sn=9de78126434c1c1f4b616320f141b19a&amp;scene=21#wechat_redirect"><span leaf="">GSE171145-EGFR突变与否肺腺癌数据集</span></a><span leaf="">的时候，已经复现了Figure1B</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZHU6DVRzNpNxdicC6fsQfI3KyZG7kkg4wO0Y7ZVrSgorv2FUrov3eauQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6731481481481482" data-type="png" data-w="1080" data-imgfileid="100044855" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZHU6DVRzNpNxdicC6fsQfI3KyZG7kkg4wO0Y7ZVrSgorv2FUrov3eauQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">所以这期就直接从Figure1C开始，尝试复现并基于自己的理解去尝试使用不同的方式去美化一下结果。</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZA754gJ3tlBjIcGjvTaQZVdb5qQA7j9Fz4gC98oibP2RhNb5hSuDvZtQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0415800415800416" data-type="png" data-w="481" data-imgfileid="100044856" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZA754gJ3tlBjIcGjvTaQZVdb5qQA7j9Fz4gC98oibP2RhNb5hSuDvZtQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">整理分组信息</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">样本分为了两类：EGFR突变型LUAD：5个样本；EGFR野生型LUAD：4个样本。</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">因为后续不管是图C还是图E都用到了分组展示，所以在复现之前要先整理分组信息。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">结合GEO网站sample信息+文献附件患者信息+Figure1E展示的EGFR分组信息，可以整理得到具体的分组信息</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZPkG1nficzwMpMkQ4duvwZBK0Rxmc5PofPEeicW4szLVegK9zmZGoqHWg/640?wx_fmt=png&amp;from=appmsg" alt="sample信息" data-ratio="0.7798165137614679" data-type="png" data-w="545" data-imgfileid="100044854" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZPkG1nficzwMpMkQ4duvwZBK0Rxmc5PofPEeicW4szLVegK9zmZGoqHWg/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">sample信息</span></figcaption></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZReLK2tP4AxdZ7kzb84a0wiaK9JajRFvJiboLZpo7WoMAXG3yeX8oPQNQ/640?wx_fmt=png&amp;from=appmsg" alt="患者信息" data-ratio="0.6583333333333333" data-type="png" data-w="1080" data-imgfileid="100044857" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZReLK2tP4AxdZ7kzb84a0wiaK9JajRFvJiboLZpo7WoMAXG3yeX8oPQNQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">患者信息</span></figcaption></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZP3nNDqUx8j04QPsjAMRUicp2OmCnZjk1tZ5RyaJRrvvuiabtob37Zd8A/640?wx_fmt=png&amp;from=appmsg" alt="EGFR分组信息" data-ratio="0.6442307692307693" data-type="png" data-w="936" data-imgfileid="100044860" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZP3nNDqUx8j04QPsjAMRUicp2OmCnZjk1tZ5RyaJRrvvuiabtob37Zd8A/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">EGFR分组信息</span></figcaption></figure><p data-tool="mdnice编辑器"><strong><span leaf="">具体的整理思路：基于orig.ident整理的样品信息，对应上患者的P1-P9，在结合Figure1E展示的分组，整理P1-P9对应的EGFR分组</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#整理分组信息----</span></span><span leaf=""><br></span><span><span leaf="">##加载R包和需要的数据</span></span><span leaf=""><br></span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">'scRNA_scripts/lib.R'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce.all.int = readRDS(</span><span><span leaf="">'2-harmony/sce.all_int.rds'</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 新的分组信息</span></span><span leaf=""><br></span><span leaf="">new_group_info &lt;- c(</span><span><span leaf="">"P1"</span></span><span leaf="">, </span><span><span leaf="">"P2"</span></span><span leaf="">, </span><span><span leaf="">"P3"</span></span><span leaf="">, </span><span><span leaf="">"P4"</span></span><span leaf="">, </span><span><span leaf="">"P5"</span></span><span leaf="">, </span><span><span leaf="">"P6"</span></span><span leaf="">, </span><span><span leaf="">"P7"</span></span><span leaf="">, </span><span><span leaf="">"P8"</span></span><span leaf="">, </span><span><span leaf="">"P9"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建一个向量，包含P1-P9对应的EGFR状态</span></span><span leaf=""><br></span><span leaf="">egfr_status &lt;- c(</span><span><span leaf="">"EGFR(+)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(-)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(+)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(+)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(-)"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                 </span><span><span leaf="">"EGFR(+)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(-)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(+)"</span></span><span leaf="">, </span><span><span leaf="">"EGFR(-)"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 原始的orig.ident信息</span></span><span leaf=""><br></span><span leaf="">orig_ident &lt;- c(</span><span><span leaf="">"LJQ-T"</span></span><span leaf="">, </span><span><span leaf="">"GBG-T"</span></span><span leaf="">, </span><span><span leaf="">"LYB-T1"</span></span><span leaf="">, </span><span><span leaf="">"LYB-T2"</span></span><span leaf="">, </span><span><span leaf="">"CYD-T"</span></span><span leaf="">, </span><span><span leaf="">"CYZ-T"</span></span><span leaf="">, </span><span><span leaf="">"XMS"</span></span><span leaf="">, </span><span><span leaf="">"ZYQ"</span></span><span leaf="">, </span><span><span leaf="">"TGS"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建一个映射，将orig.ident与新的分组标签关联起来</span></span><span leaf=""><br></span><span leaf="">group_mapping &lt;- setNames(new_group_info, orig_ident)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建一个映射，将orig.ident与EGFR状态关联起来</span></span><span leaf=""><br></span><span leaf="">egfr_mapping &lt;- setNames(egfr_status, orig_ident)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 从Seurat对象的元数据中提取orig.ident列</span></span><span leaf=""><br></span><span leaf="">seurat_obj_meta &lt;- sce.all.int@meta.data</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 使用映射将新的分组信息添加到元数据中</span></span><span leaf=""><br></span><span leaf="">seurat_obj_meta</span><span><span leaf="">$group</span></span><span leaf=""> &lt;- group_mapping[seurat_obj_meta</span><span><span leaf="">$orig</span></span><span leaf="">.ident]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 使用映射将EGFR状态添加到元数据中</span></span><span leaf=""><br></span><span leaf="">seurat_obj_meta</span><span><span leaf="">$EGFR_status</span></span><span leaf=""> &lt;- egfr_mapping[seurat_obj_meta</span><span><span leaf="">$orig</span></span><span leaf="">.ident]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 将修改后的元数据重新赋值给Seurat对象</span></span><span leaf=""><br></span><span leaf="">sce.all.int@meta.data &lt;- seurat_obj_meta</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZuDxECrPHjgVhtd9FezVbrf5iblib0oHMdicEtOS3Krh35XQN674MJzRSg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.262037037037037" data-type="png" data-w="1080" data-imgfileid="100044859" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZuDxECrPHjgVhtd9FezVbrf5iblib0oHMdicEtOS3Krh35XQN674MJzRSg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">Figure1C复现</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">整理好分组信息之后，</span><strong><span leaf="">复现Figure1C就很简单，基于EGFR状态使用Umap图可视化细胞类型比例差异</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">使用DimPlot可视化，然后使用group.by选择展示"EGFR_status"分群即可，cols配色使用snipaste截取文章相同的配色即可</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">##Figure1C----</span></span><span leaf=""><br></span><span leaf="">DimPlot(sce.all.int, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">,pt.size = 1,</span><span leaf=""><br></span><span leaf="">        cols = c(</span><span><span leaf="">"#de829e"</span></span><span leaf="">,</span><span><span leaf="">"#5a8baa"</span></span><span leaf="">),group.by = </span><span><span leaf="">"EGFR_status"</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  theme_dr(xlength = 0.22, ylength = 0.22, </span><span leaf=""><br></span><span leaf="">           arrow = grid::arrow(length = unit(0.15, </span><span><span leaf="">"inches"</span></span><span leaf="">), </span><span><span leaf="">type</span></span><span leaf=""> = </span><span><span leaf="">"closed"</span></span><span leaf="">))+</span><span leaf=""><br></span><span leaf="">  theme(panel.grid = element_blank())</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZviaVlbjduVgrAf224X4tToIzBar8XlxzqYlU4Xgg9Ma7n1pOOFuwPdA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8324074074074074" data-type="png" data-w="1080" data-imgfileid="100044862" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZviaVlbjduVgrAf224X4tToIzBar8XlxzqYlU4Xgg9Ma7n1pOOFuwPdA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">尝试美化</span></span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">1. 基于Dimplot参数split.by展示不同分组中细胞类型</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">在</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527550&amp;idx=1&amp;sn=d8b468ec359923629dfcbabd6a15037e&amp;scene=21#wechat_redirect"><span leaf="">Dimplot可视化常用参数</span></a><span leaf="">推文中，</span><strong><span leaf="">探索了Dimplot的几个常用参数：group.by选择展示不同的分群、split.by参数分组展示、调整label标签</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">那就实际使用一下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#split.by参数分组展示</span></span><span leaf=""><br></span><span leaf="">DimPlot(sce.all.int, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">,pt.size = 1,</span><span leaf=""><br></span><span leaf="">        cols = mycolors,group.by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,split.by =  </span><span><span leaf="">"EGFR_status"</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  theme_dr(xlength = 0.22, ylength = 0.22, </span><span leaf=""><br></span><span leaf="">           arrow = grid::arrow(length = unit(0.15, </span><span><span leaf="">"inches"</span></span><span leaf="">), </span><span><span leaf="">type</span></span><span leaf=""> = </span><span><span leaf="">"closed"</span></span><span leaf="">))+</span><span leaf=""><br></span><span leaf="">  theme(panel.grid = element_blank())</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Zibs3oiabxMkiaWOOicMoqkty8QMwMDviawNpJwRSeChvEAg4OTYqcrnicPVg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.812037037037037" data-type="png" data-w="1080" data-imgfileid="100044861" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Zibs3oiabxMkiaWOOicMoqkty8QMwMDviawNpJwRSeChvEAg4OTYqcrnicPVg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">调整label标签，但是label标签颜色没有和celltype颜色对应上，可能为了更加突出？</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DimPlot(sce.all.int, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">,pt.size = 1,</span><span leaf=""><br></span><span leaf="">        cols = mycolors,group.by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">        split.by =  </span><span><span leaf="">"EGFR_status"</span></span><span leaf="">,label = T,</span><span leaf=""><br></span><span leaf="">        label.size = 3,label.box = T,label.color = </span><span><span leaf="">'black'</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  theme_dr(xlength = 0.22, ylength = 0.22, </span><span leaf=""><br></span><span leaf="">           arrow = grid::arrow(length = unit(0.15, </span><span><span leaf="">"inches"</span></span><span leaf="">), </span><span><span leaf="">type</span></span><span leaf=""> = </span><span><span leaf="">"closed"</span></span><span leaf="">))+</span><span leaf=""><br></span><span leaf="">  theme(panel.grid = element_blank())</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZQLpNDMKT8oibKe6zRxnuNA9YpAIvAu9lnbTnlyStFrfL3D5ADcd84cA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8101851851851852" data-type="png" data-w="1080" data-imgfileid="100044863" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZQLpNDMKT8oibKe6zRxnuNA9YpAIvAu9lnbTnlyStFrfL3D5ADcd84cA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">2. 基于DimPlot_scCustom美化</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">还整理过</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527679&amp;idx=1&amp;sn=ebc548c20322d97d540d25cf2285353f&amp;scene=21#wechat_redirect"><span leaf="">DimPlot_scCustom是否优于Dimplot？</span></a><span leaf="">，所以也可以使用DimPlot_scCustom美化进行美化</span></p><p data-tool="mdnice编辑器"><span leaf="">2.1 DimPlot_scCustom() 默认将shuffle = TRUE，通过随机打乱点的顺序来提高可视化效果的清晰度。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DimPlot_scCustom(seurat_object = sce.all.int,</span><span leaf=""><br></span><span leaf="">                 colors_use =  c(</span><span><span leaf="">"#de829e"</span></span><span leaf="">,</span><span><span leaf="">"#5a8baa"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                 group.by = </span><span><span leaf="">"EGFR_status"</span></span><span leaf="">,figure_plot = T， </span><span leaf=""><br></span><span leaf="">                 repel = T, pt.size = 0.5)</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZovvpW5bkialIeNYBabsxJSIUfW5YficQ6RqBmHZfVicibtcicX0EbiaVRhkw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7851851851851852" data-type="png" data-w="1080" data-imgfileid="100044866" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33ZovvpW5bkialIeNYBabsxJSIUfW5YficQ6RqBmHZfVicibtcicX0EbiaVRhkw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">2.2 在 DimPlot_scCustom() 中，split_seurat 参数可以进一步控制拆分绘图的显示方式</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">DimPlot_scCustom(seurat_object = sce.all.int,</span><span leaf=""><br></span><span leaf="">                 group.by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                 label = T, repel = T, pt.size = 0.5,</span><span leaf=""><br></span><span leaf="">                 split.by = </span><span><span leaf="">"EGFR_status"</span></span><span leaf="">,split_seurat = TRUE,</span><span leaf=""><br></span><span leaf="">                 figure_plot = T)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Zibkn2E0BbkBWLlCDHWGiczyRAMOH0xhDNaab2MgzEULgicfLiabDuRa1ZA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7916666666666666" data-type="png" data-w="1080" data-imgfileid="100044867" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Zibkn2E0BbkBWLlCDHWGiczyRAMOH0xhDNaab2MgzEULgicfLiabDuRa1ZA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">选择自己喜欢的方式进行可视化即可！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Z8dzrKhhkMDfsn34icLnpjqmZTJuC9ib6qyuGibPqia2pEzvXIw9YXnMgpQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4074074074074074" data-type="png" data-w="1080" data-imgfileid="100044869" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjSBJUCeOAd2bvc3lbQzN33Z8dzrKhhkMDfsn34icLnpjqmZTJuC9ib6qyuGibPqia2pEzvXIw9YXnMgpQ/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><section><span leaf=""><br></span></section><h3><span><span leaf="">文末友情宣传</span></span></h3><p><strong><span leaf="">如果你也想做单细胞转录组数据分析，最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect"><span leaf="">满足你生信分析计算需求的低价解决方案</span></a><span leaf="">，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538207&amp;idx=1&amp;sn=92833750b121a0b45e31f82092b9ac1a&amp;scene=21#wechat_redirect"><span leaf="">生物信息学马拉松授课</span></a><span leaf="">，你的生物信息学入门课。</span></strong></p><p><strong><span leaf="">2025年也会继续学习分享单细胞内容，并且组建了交流群——</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247536175&amp;idx=1&amp;sn=7391227554e6aed88bfc0dbcd8546e78&amp;scene=21#wechat_redirect"><span leaf="">承包你2025全部的单细胞转录组降维聚类分群</span></a><span leaf="">，欢迎一起讨论交流学习！</span></strong></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/IvOfOhUK-vLzBKubtas-zA",target="_blank" rel="noopener noreferrer">原文链接</a>
