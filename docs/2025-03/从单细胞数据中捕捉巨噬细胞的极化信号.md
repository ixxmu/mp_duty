---
title: "从单细胞数据中捕捉巨噬细胞的极化信号"
date: 2025-03-05T05:07:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
从单细胞数据中捕捉巨噬细胞的极化信号 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">巨噬细胞极化（Macrophage Polarization）是指巨噬细胞在不同微环境信号刺激下，分化为不同功能表型的过程。通常，巨噬细胞可以分为两种主要的极化表型：</p><ol data-tool="mdnice编辑器"><li><section><strong>M1型巨噬细胞</strong>（经典激活型巨噬细胞）：由IFN-γ、LPS等信号诱导，具有促炎、抗微生物和抗肿瘤的功能。</section></li><li><section><strong>M2型巨噬细胞</strong>（替代激活型巨噬细胞）：由IL-4、IL-13、IL-10等信号诱导，具有抗炎、组织修复和促肿瘤的功能。</section></li></ol><p data-tool="mdnice编辑器">目前的单细胞测序背景下，特别是针对不同类型的TME，研究者更倾向于将巨噬细胞分类为更精细的亚群，这有利于后续的轨迹分析。</p><p data-tool="mdnice编辑器">但巨噬细胞极化是巨噬细胞共有的一个表型，我们如何对10多个macro亚型进行极化的评估呢？</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100048937" data-ratio="0.7277777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8emqgzy6giatoFUia2QNZphG29mSYCx9ibH5icbpNR8F0UC5pEMnwT4UMtyoPJgFBCico9fqfpqLecpMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8emqgzy6giatoFUia2QNZphG29mSYCx9ibH5icbpNR8F0UC5pEMnwT4UMtyoPJgFBCico9fqfpqLecpMA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">从这样的散点图，我们就更能更直观地观察到macro亚群向M1或M2极化的趋势。</p><p data-tool="mdnice编辑器">如何实现呢？首先需要一个做好细胞注释的seurat对象，然后：</p><h2 data-tool="mdnice编辑器"><span></span><span>定义基因模块</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># M1 巨噬细胞基因模块</span><br>m1_genes &lt;- c(<span>"CXCL9"</span>, <span>"CCL19"</span>, <span>"CXCL10"</span>, <span>"IDO1"</span>, <span>"EBI3"</span>, <span>"TNFAIP6"</span>, <span>"CCR7"</span>, <span>"LAMP3"</span>, <span>"CCL5"</span>, <span>"CD40"</span>, <span>"IRF8"</span>, <span>"CD38"</span>, <span>"CCL4"</span>, <span>"APOL3"</span>, <span>"CXCL11"</span>, <span>"ADAMDEC1"</span>, <span>"HCK"</span>, <span>"BCL2A1"</span>, <span>"RSAD2"</span>, <span>"CYP27B1"</span>, <span>"KYNU"</span>, <span>"SIGLEC1"</span>, <span>"SLAMF1"</span>, <span>"SLC2A6"</span>, <span>"IF144L"</span>, <span>"SAMSN1"</span>, <span>"LILRB2"</span>, <span>"TLR2"</span>, <span>"CCL8"</span>, <span>"APOBEC3A"</span>, <span>"AQP9"</span>, <span>"C3AR1"</span>, <span>"HLA-DQA1"</span>, <span>"MNDA"</span>, <span>"IL2RA"</span>, <span>"SLC15A3"</span>, <span>"CD80"</span>, <span>"ADGRE1"</span>, <span>"CHI3L1"</span>, <span>"RASSF4"</span>, <span>"IL4R"</span>, <span>"AIM2"</span>, <span>"PLA1A"</span>, <span>"MMP9"</span>, <span>"TLR8"</span>, <span>"HESX1"</span>, <span>"SOCS1"</span>, <span>"LST1"</span>, <span>"NOD2"</span>, <span>"IL7R"</span>, <span>"FLVCR2"</span>, <span>"BIRC3"</span>, <span>"PTGIR"</span>, <span>"CHI3L2"</span>, <span>"PLA2G7"</span>, <span>"GPR183"</span>, <span>"AIF1"</span>, <span>"CD4"</span>, <span>"HLA-DOB"</span>, <span>"MSC"</span>, <span>"ADGRE2"</span>, <span>"CCR5"</span>, <span>"CLEC2D"</span>, <span>"INFRSF4"</span>, <span>"CD86"</span>, <span>"SPIB"</span>, <span>"LAG3"</span>, <span>"DHX58"</span>, <span>"CLIC2"</span>, <span>"ACHE"</span>, <span>"CCL18"</span>, <span>"LY86"</span>, <span>"CCL14"</span>, <span>"TNIP3"</span>, <span>"Clorf54"</span>, <span>"MMP25"</span>, <span>"ACP5"</span>, <span>"APOBEC3G"</span>)<br><br><span># M2 巨噬细胞基因模块</span><br>m2_genes &lt;- c(<span>"MMP9"</span>, <span>"MS4A6A"</span>, <span>"CCL18"</span>, <span>"AIF1"</span>, <span>"NCF2"</span>, <span>"CD4"</span>, <span>"ACP5"</span>, <span>"CLEC4A"</span>, <span>"CCL13"</span>, <span>"LY86"</span>, <span>"SLC15A3"</span>, <span>"CLEC10A"</span>, <span>"CCL23"</span>, <span>"HLA-DQA1"</span>, <span>"RNASE6"</span>, <span>"ADAMDEC1"</span>, <span>"HCK"</span>, <span>"NPL"</span>, <span>"TREM2"</span>, <span>"IRF8"</span>, <span>"SIGLEC1"</span>, <span>"CCL4"</span>, <span>"SAMSN1"</span>, <span>"CLEC7A"</span>, <span>"TLR2"</span>, <span>"P2RY13"</span>, <span>"CCL8"</span>, <span>"CD86"</span>, <span>"CD180"</span>, <span>"CD68"</span>, <span>"CD209"</span>, <span>"C3AR1"</span>, <span>"GPR183"</span>, <span>"CCL14"</span>, <span>"DPEP2"</span>, <span>"FPR3"</span>, <span>"CD37"</span>, <span>"LST1"</span>, <span>"CLIC2"</span>, <span>"HRH1"</span>, <span>"EGR2"</span>, <span>"CHI3L1"</span>, <span>"Clorf54"</span>, <span>"CFP"</span>, <span>"C5AR1"</span>, <span>"MNDA"</span>, <span>"PTGER2"</span>, <span>"CD300A"</span>, <span>"PIK3IP1"</span>, <span>"IGSF6"</span>, <span>"RENBP"</span>, <span>"PLA2G7"</span>, <span>"FCGR2B"</span>, <span>"SLAMF8"</span>, <span>"RASGRP3"</span>, <span>"QPCT"</span>, <span>"LILRB2"</span>, <span>"ATP8B4"</span>, <span>"PTGIR"</span>, <span>"FRMD4A"</span>, <span>"TLR8"</span>, <span>"KYNU"</span>, <span>"CHST15"</span>)<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p>巨噬细胞的基因集来自：https://ars.els-cdn.com/content/image/1-s2.0-S0092867421000106-mmc5.xlsx</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>计算模块得分</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code>macro_cells &lt;- AddModuleScore(macro_cells, features = list(m1_genes), name = <span>"M1_score"</span>)<br>macro_cells &lt;- AddModuleScore(macro_cells, features = list(m2_genes), name = <span>"M2_score"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>可视化</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># 定义颜色映射</span><br><span>library</span>(paletteer)<br>paletteer_c(<span>"scico::berlin"</span>, <span>8</span>)<br><br>celltype_colors &lt;- c(<br>  <span>"Macro-CCL3L1"</span> = <span>"#9EB0FFFF"</span>,<br>  <span>"Macro-CXCL9"</span> = <span>"#4799C9FF"</span>,<br>  <span>"Macro-FTH1"</span> = <span>"#225771FF"</span>,<br>  <span>"Macro-IL1B"</span> = <span>"#00FF7FFF"</span>,<br>  <span>"Macro-ISG15"</span> = <span>"#FAEFD1FF"</span>,<br>  <span>"Macro-MT1X"</span> = <span>"#68240FFF"</span>,<br>  <span>"Macro-RNASE1"</span> = <span>"#B36556FF"</span>,<br>  <span>"Macro-SELENOP"</span> = <span>"#FFACACFF"</span><br>)<br><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 加载 ggplot2 包</span><br><span>library</span>(ggplot2)<br><br><span># 创建数据框</span><br>plot_data &lt;- data.frame(<br>  M1_score = macro_cells$M1_score1,<br>  M2_score = macro_cells$M2_score1,<br>  celltype = macro_cells$celltype<br>)<br><br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 使用 ggplot2 绘制散点图</span><br>p &lt;- ggplot(plot_data, aes(x = M1_score, y = M2_score, color = celltype)) +<br>  geom_point(size = <span>1.5</span>, alpha = <span>0.7</span>) +  <span># 设置点的大小和透明度</span><br>  scale_color_manual(values = celltype_colors) +  <span># 使用自定义颜色映射</span><br>  labs(<br>    x = <span>"M1 Score"</span>,  <span># x 轴标签</span><br>    y = <span>"M2 Score"</span>,  <span># y 轴标签</span><br>    title = <span>"M1 vs M2 Scores by Cell Type"</span>,  <span># 图表标题</span><br>    color = <span>"Cell Type"</span>  <span># 图例标题</span><br>  ) +<br>  theme_minimal() +  <span># 使用简洁的主题</span><br>  theme(<br>    plot.title = element_text(hjust = <span>0.5</span>, size = <span>14</span>, face = <span>"bold"</span>),  <span># 标题居中加粗</span><br>    legend.position = <span>"right"</span>,  <span># 图例放在右侧</span><br>    legend.text = element_text(size = <span>10</span>),  <span># 图例文字大小</span><br>    panel.grid.major = element_blank(),  <span># 删除主要网格线</span><br>    panel.grid.minor = element_blank(),  <span># 删除次要网格线</span><br>    panel.border = element_rect(color = <span>"black"</span>, fill = <span>NA</span>, size = <span>1</span>),  <span># 添加边框</span><br>    axis.line = element_line(color = <span>"black"</span>, size = <span>0.5</span>)  <span># 添加坐标轴线</span><br>  ) +<br>  guides(color = guide_legend(override.aes = list(size = <span>4</span>))) +  <span># 调整图例中点的大小</span><br>  geom_hline(yintercept = <span>0</span>, color = <span>"black"</span>, linetype = <span>"dashed"</span>, size = <span>0.5</span>) +  <span># 添加 y=0 的水平线</span><br>  geom_vline(xintercept = <span>0</span>, color = <span>"black"</span>, linetype = <span>"dashed"</span>, size = <span>0.5</span>) +  <span># 添加 x=0 的垂直线</span><br>  coord_cartesian(xlim = c(min(plot_data$M1_score), max(plot_data$M1_score)),  <span># 设置 x 轴范围</span><br>                  ylim = c(min(plot_data$M2_score), max(plot_data$M2_score)))  <span># 设置 y 轴范围</span><br>p<br>ggsave(p,filename = <span>"Outplot/Step3.1.macro_Polarization.pdf"</span>,<br>       width = <span>11</span>, height = <span>8</span>)<br><br></code></pre></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/AL2JZEcO31V0eDYXkiE4qA",target="_blank" rel="noopener noreferrer">原文链接</a>
