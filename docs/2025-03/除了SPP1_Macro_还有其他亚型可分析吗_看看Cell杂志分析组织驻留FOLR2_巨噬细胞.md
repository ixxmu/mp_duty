---
title: "除了SPP1+Macro，还有其他亚型可分析吗？看看Cell杂志分析组织驻留FOLR2+巨噬细胞"
date: 2025-03-28T00:13:45Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
除了SPP1+Macro，还有其他亚型可分析吗？看看Cell杂志分析组织驻留FOLR2+巨噬细胞 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><span></span><p><span leaf="">今天来学习一篇<span textstyle="">2022年3月31号发表在顶刊Cell</span>杂志上的文献，标题为<span textstyle="">《Tissue-resident FOLR2+ macrophages associate with CD8+ T cell infiltration in human breast cancer》</span>，这篇文献中的图也都很好看，今天来看看单细胞数据分析中最常见的特征基因气泡图吧，以此来了解文献背景~</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">这个气泡图展示了一些常见的细胞marker基因在四个亚群中的表达模式特征，也是单细胞数据分析中常用的图：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTo26Ys8m2wApN6EPjc5Za9qQBf9TJlibIQIetD1PnFEJCCm6Aiba0rtsw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7958904109589041" data-type="png" data-w="730" data-imgfileid="100056554" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTo26Ys8m2wApN6EPjc5Za9qQBf9TJlibIQIetD1PnFEJCCm6Aiba0rtsw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据背景</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">关于<span textstyle="">巨噬细胞的前世今生</span>，可看：</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528626&amp;idx=1&amp;sn=b1d89df7815070fea7bda6bc98eead88&amp;scene=21#wechat_redirect"><span leaf="">巨噬细胞异质性及肿瘤微环境（上）</span></a><span leaf="">，下篇在本周六发。</span></p><p data-tool="mdnice编辑器"><span leaf="">这篇文献作者需要研究了健康乳腺和乳腺癌原发肿瘤中的一个独立群体：</span><code><span leaf="">FOLR2+</span></code><span leaf="">组织驻留巨噬细胞，<span textstyle="">这群细胞的特点如下</span>：</span></p><ul><li><section><code><span leaf="">FOLR2+</span></code><span leaf="">巨噬细胞定位于肿瘤基质中的血管周围区域，在那里它们与</span><code><span leaf="">CD8+ T</span></code><span leaf="">细胞相互作用。</span></section></li><li><section><code><span leaf="">FOLR2+</span></code><span leaf="">噬巨细胞在体外有效地激活效应</span><code><span leaf="">CD8+ T</span></code><span leaf="">细胞。</span></section></li><li><section><span leaf="">肿瘤中</span><code><span leaf="">FOLR2+</span></code><span leaf="">巨噬细胞的密度与患者较好的生存率正相关。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">这项研究强调了肿瘤相关巨噬细胞亚群的特定作用，并为基于巨噬细胞的癌症治疗中针对亚群的治疗干预铺平了道路。作者的样本收集如下，最后得到18008个髓系细胞，数据上传到了GEO数据库：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE192935</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTTaO6aNaNNacNGGGpnKcr4InaZzSZibjgdRGHYjN7Q3TlDibur6ANhU7w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.36018518518518516" data-type="png" data-w="1080" data-imgfileid="100056555" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTTaO6aNaNNacNGGGpnKcr4InaZzSZibjgdRGHYjN7Q3TlDibur6ANhU7w/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">了解一下CD1c+和/或CD14+细胞的关系</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">CD1c+细胞</span></span><span></span></h3><ul><li><section><strong><span leaf="">分类与特征</span></strong><span leaf="">：</span><code><span leaf="">CD1c+</span></code><span leaf="">细胞通常指的是</span><code><span leaf="">CD1c</span></code><span leaf="">阳性的树突状细胞（DCs），属于髓系树突状细胞（mDCs）的一种。在人类血液中，</span><code><span leaf="">CD1c+ DCs</span></code><span leaf="">是最大的树突状细胞亚群。它们能够向CD4+和CD8+ T细胞呈递抗原。</span></section></li><li><section><strong><span leaf="">亚群差异</span></strong><span leaf="">：</span><code><span leaf="">CD1c+ DCs</span></code><span leaf="">可以进一步分为</span><code><span leaf="">CD14+</span></code><span leaf="">和</span><code><span leaf="">CD14−</span></code><span leaf="">两个亚群。</span><code><span leaf="">CD14+</span></code><span leaf="">亚群表达更高水平的单核细胞相关标志物，如CD64、CD115、CD163和S100A8/9。在功能上，</span><code><span leaf="">CD1c+CD14+</span></code><span leaf="">细胞在抗原呈递能力上较弱，但在细胞因子产生方面表现更强。例如，在LPS刺激下，</span><code><span leaf="">CD1c+CD14+</span></code><span leaf="">细胞倾向于产生更多TNF和IL-10，但诱导T细胞增殖的能力较弱。</span></section></li><li><section><strong><span leaf="">临床意义</span></strong><span leaf="">：在黑色素瘤患者中，</span><code><span leaf="">CD1c+CD14+</span></code><span leaf="">细胞的比例显著增加，并且这些细胞表现出抑制T细胞增殖和分化的特性。因此，在癌症疫苗研究中，有研究建议从</span><code><span leaf="">CD1c+ DCs</span></code><span leaf="">中去除</span><code><span leaf="">CD14+</span></code><span leaf="">亚群，以提高疫苗的免疫原性。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">CD14+细胞</span></span><span></span></h3><ul><li><section><strong><span leaf="">分类与特征</span></strong><span leaf="">：</span><code><span leaf="">CD14+</span></code><span leaf="">通常指的是</span><code><span leaf="">CD14</span></code><span leaf="">阳性的细胞，</span><code><span leaf="">CD14</span></code><span leaf="">是单核细胞和巨噬细胞的标志物。在树突状细胞中，</span><code><span leaf="">CD14</span></code><span leaf="">也可以作为某些特定亚群的标记，例如</span><code><span leaf="">CD1c+CD14+ DCs</span></code><span leaf="">。</span></section></li><li><section><strong><span leaf="">功能与作用</span></strong><span leaf="">：</span><code><span leaf="">CD14+</span></code><span leaf="">细胞（如单核细胞）在免疫系统中具有多种功能，包括吞噬作用、抗原呈递和细胞因子分泌。在树突状细胞中，</span><code><span leaf="">CD14+</span></code><span leaf="">亚群表现出与单核细胞相似的特征，例如在抗原呈递能力上相对较弱，但在细胞因子产生方面表现更强。</span></section></li><li><section><strong><span leaf="">临床意义</span></strong><span leaf="">：</span><code><span leaf="">CD14+</span></code><span leaf="">细胞在炎症和感染反应中发挥重要作用。此外，在某些疾病状态下，</span><code><span leaf="">CD14+</span></code><span leaf="">细胞的比例或功能可能会发生变化，例如在黑色素瘤患者中，</span><code><span leaf="">CD1c+CD14+ DCs</span></code><span leaf="">的比例增加，且表现出抑制T细胞反应的特性。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">CD1c+和/或CD14+细胞的关系</span></span><span></span></h3><ul><li><section><strong><span leaf="">共表达与功能差异</span></strong><span leaf="">：在树突状细胞中，</span><code><span leaf=""><span textstyle="">CD1c</span></span></code><span leaf=""><span textstyle="">和</span></span><code><span leaf=""><span textstyle="">CD14</span></span></code><span leaf=""><span textstyle="">可以共表达，形成</span></span><code><span leaf=""><span textstyle="">CD1c+CD14+</span></span></code><span leaf=""><span textstyle="">亚群。这些细胞在功能上与</span></span><code><span leaf=""><span textstyle="">CD1c+CD14−</span></span></code><span leaf=""><span textstyle="">亚群有显著差异</span>，例如在抗原呈递和T细胞激活方面表现较弱，但在细胞因子产生方面表现更强。</span></section></li><li><section><strong><span leaf="">临床应用</span></strong><span leaf="">：在疫苗研究中，</span><code><span leaf="">CD1c+CD14+</span></code><span leaf="">细胞的存在可能会影响疫苗的免疫效果。因此，有研究建议在制备树突状细胞疫苗时去除</span><code><span leaf="">CD14+</span></code><span leaf="">亚群，以提高疫苗的免疫原性。</span></section></li></ul><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据预处理</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE192935，下载其中的</span><code><span leaf="">GSE192935_Raw_Counts_Human_SC_RNAseq_Fig1_and_2.csv.gz</span></code></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">GSE192935_Metadata_Human_SC_RNAseq_Fig1_and_2.csv.gz 392.1 Kb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Metadata_SC_Mouse_Fcgr1pos_FigS3.csv.gz 94.0 Kb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Metadata_SC_Mouse_TAMs_Fig3.csv.gz 49.8 Kb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Raw_Counts_Bulk_Mouse_TAMs_Fig7.csv.gz 535.8 Kb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Raw_Counts_Human_Bulk_RNAseq_Fig2.csv.gz 1.1 Mb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Raw_Counts_Human_SC_RNAseq_Fig1_and_2.csv.gz 44.0 Mb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Raw_Counts_SC_Mouse_Fcgr1pos_FigS3.csv.gz 21.3 Mb (ftp)(http) CSV</span><span leaf=""><br></span><span leaf="">GSE192935_Raw_Counts_SC_Mouse_TAMs_Fig3.csv.gz 12.4 Mb (ftp)(http) CSV</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">读取一下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">###</span></span><span leaf=""><br></span><span><span leaf="">### Create: Jianming Zeng</span></span><span leaf=""><br></span><span><span leaf="">### Date:  2023-12-31  </span></span><span leaf=""><br></span><span><span leaf="">### Email: jmzeng1314@163.com</span></span><span leaf=""><br></span><span><span leaf="">### Blog: http://www.bio-info-trainee.com/</span></span><span leaf=""><br></span><span><span leaf="">### Forum:  http://www.biotrainee.com/thread-1376-1-1.html</span></span><span leaf=""><br></span><span><span leaf="">### CAFS/SUSTC/Eli Lilly/University of Macau</span></span><span leaf=""><br></span><span><span leaf="">### Update Log: 2023-12-31   First version </span></span><span leaf=""><br></span><span><span leaf="">### Update Log: 2024-12-09   by juan zhang (492482942@qq.com)</span></span><span leaf=""><br></span><span><span leaf="">### </span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">library(dplyr) </span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(clustree)</span><span leaf=""><br></span><span leaf="">library(data.table)</span><span leaf=""><br></span><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">library(patchwork)</span><span leaf=""><br></span><span leaf="">library(stringr)</span><span leaf=""><br></span><span leaf="">library(Matrix)</span><span leaf=""><br></span><span leaf="">getwd()</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建目录</span></span><span leaf=""><br></span><span leaf="">gse &lt;- </span><span><span leaf="">"GSE192935"</span></span><span leaf=""><br></span><span leaf="">dir.create(gse)</span><span leaf=""><br></span><span><span leaf="">###### step1: 导入数据 ######   </span></span><span leaf=""><br></span><span leaf="">ct &lt;- data.table::fread(</span><span><span leaf="">"GSE192935/GSE192935_Raw_Counts_Human_SC_RNAseq_Fig1_and_2.csv.gz"</span></span><span leaf="">,data.table = F)</span><span leaf=""><br></span><span leaf="">ct[1:5, 1:5]</span><span leaf=""><br></span><span leaf="">dim(ct)</span><span leaf=""><br></span><span leaf="">rownames(ct) &lt;- ct[,1]</span><span leaf=""><br></span><span leaf="">ct &lt;- ct[,-1]</span><span leaf=""><br></span><span leaf="">ct[1:5, 1:5]</span><span leaf=""><br></span><span leaf="">meta &lt;- data.frame(Sample=str_split(colnames(ct),pattern = </span><span><span leaf="">"_"</span></span><span leaf="">,n = 2,simplify = T)[,2])</span><span leaf=""><br></span><span leaf="">rownames(meta) &lt;- colnames(ct)</span><span leaf=""><br></span><span leaf="">head(meta)</span><span leaf=""><br></span><span leaf="">table(meta)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建对象</span></span><span leaf=""><br></span><span leaf="">sce.all &lt;- CreateSeuratObject(counts = ct, meta.data = meta, min.cells = 3)</span><span leaf=""><br></span><span leaf="">sce.all</span><span leaf=""><br></span><span><span leaf=""># 查看特征</span></span><span leaf=""><br></span><span leaf="">as.data.frame(sce.all@assays</span><span><span leaf="">$RNA</span></span><span><span leaf="">$counts</span></span><span leaf="">[1:10, 1:2])</span><span leaf=""><br></span><span leaf="">table(sce.all</span><span><span leaf="">$orig</span></span><span leaf="">.ident) </span><span leaf=""><br></span><span leaf="">sce.all</span><span><span leaf="">$orig</span></span><span leaf="">.ident &lt;- sce.all</span><span><span leaf="">$Sample</span></span><span leaf=""><br></span><span leaf="">head(sce.all@meta.data, 10)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">qsave(sce.all, file=</span><span><span leaf="">"GSE192935/sce.all.qs"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">细胞数正好是文章的数量，这里就不做细胞过滤了。</span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">Seurat的CCA整合</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">现在进行数据整合，来看看<span textstyle="">最新代码版本Seurat的CCA整合</span>： https://satijalab.org/seurat/articles/integration_introduction</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">library(harmony)</span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(clustree)</span><span leaf=""><br></span><span><span leaf="">###### step3: Seurat CCA整合多个单细胞样品 ######</span></span><span leaf=""><br></span><span leaf="">dir.create(</span><span><span leaf="">"2-CCA"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">getwd()</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 读取数据</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- qread(</span><span><span leaf="">"GSE192935/sce.all.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span></span><span leaf=""><br></span><span leaf="">sce.all.filt</span><span leaf=""><br></span><span><span leaf="">print</span></span><span leaf="">(dim(sce.all.filt))</span><span leaf=""><br></span><span leaf="">head(sce.all.filt@meta.data)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># split</span></span><span leaf=""><br></span><span leaf="">sce.all.filt[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]] &lt;- split(sce.all.filt[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]], f = sce.all.filt</span><span><span leaf="">$orig</span></span><span leaf="">.ident)</span><span leaf=""><br></span><span leaf="">sce.all.filt</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 走标准流程</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- NormalizeData(sce.all.filt, normalization.method = </span><span><span leaf="">"LogNormalize"</span></span><span leaf="">,scale.factor = 1e4) </span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindVariableFeatures(sce.all.filt, nfeatures = 2000)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- ScaleData(sce.all.filt)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- RunPCA(sce.all.filt, features = VariableFeatures(object = sce.all.filt))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 降维聚类，UMAP降维</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindNeighbors(sce.all.filt, dims = 1:20)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindClusters(sce.all.filt, resolution = 0.5,cluster.name = </span><span><span leaf="">"unintegrated_clusters"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(Idents(sce.all.filt), 5)</span><span leaf=""><br></span><span leaf="">head(sce.all.filt@meta.data)</span><span leaf=""><br></span><span leaf="">table(sce.all.filt</span><span><span leaf="">$seurat_clusters</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- RunUMAP(sce.all.filt,  dims = 1:20, reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">,reduction.name = </span><span><span leaf="">"umap.unintegrated"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p &lt;- DimPlot(sce.all.filt, label=T,reduction = </span><span><span leaf="">"umap.unintegrated"</span></span><span leaf="">, group.by = c(</span><span><span leaf="">"orig.ident"</span></span><span leaf="">, </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">)) </span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span><span leaf="">ggsave(filename=</span><span><span leaf="">'2-CCA/umap-by-orig.ident-before-cca.png'</span></span><span leaf="">,plot = p, width = 11,height = 5.5)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 运行CCA </span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- IntegrateLayers(object = sce.all.filt, </span><span leaf=""><br></span><span leaf="">                                method = CCAIntegration, </span><span leaf=""><br></span><span leaf="">                                orig.reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                new.reduction = </span><span><span leaf="">"integrated.cca"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                                verbose = FALSE)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># re-join layers after integration</span></span><span leaf=""><br></span><span leaf="">sce.all.filt[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]] &lt;- JoinLayers(sce.all.filt[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]])</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindNeighbors(sce.all.filt, reduction = </span><span><span leaf="">"integrated.cca"</span></span><span leaf="">, dims = 1:20)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindClusters(sce.all.filt, resolution = 0.5)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- RunUMAP(sce.all.filt, dims = 1:20, reduction = </span><span><span leaf="">"integrated.cca"</span></span><span leaf="">) </span><span><span leaf=""># UMAP &amp; TSNE 降维</span></span><span leaf=""><br></span><span><span leaf=""># Visualization</span></span><span leaf=""><br></span><span leaf="">p &lt;- DimPlot(sce.all.filt, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">, group.by = c(</span><span><span leaf="">"orig.ident"</span></span><span leaf="">, </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span><span leaf="">ggsave(filename=</span><span><span leaf="">'2-CCA/umap-by-orig.ident-after-cca.png'</span></span><span leaf="">,plot = p, width = 11,height = 5.5)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 聚类</span></span><span leaf=""><br></span><span><span leaf=""># 设置不同的分辨率，观察分群效果(选择哪一个？)</span></span><span leaf=""><br></span><span><span leaf="">for</span></span><span leaf=""> (res </span><span><span leaf="">in</span></span><span leaf=""> c(0.01, 0.05, 0.1, 0.2, 0.3, 0.5,0.8,1,1.2,1.5)) {</span><span leaf=""><br></span><span><span leaf=""># graph.name = "CCA_snn",</span></span><span leaf=""><br></span><span><span leaf=""># sce.all.filt &lt;- FindClusters(sce.all.filt, resolution = res, algorithm = 1) </span></span><span leaf=""><br></span><span leaf="">  sce.all.filt &lt;- FindClusters(sce.all.filt, resolution = res) </span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span><span><span leaf=""># save</span></span><span leaf=""><br></span><span leaf="">p_tree &lt;- clustree(sce.all.filt@meta.data, prefix = </span><span><span leaf="">"RNA_snn_res."</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ggsave(plot=p_tree, filename=</span><span><span leaf="">"2-CCA/Tree_diff_resolution.pdf"</span></span><span leaf="">, width = 7, height = 10)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p &lt;- DimPlot(sce.all.filt, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">, group.by = </span><span><span leaf="">"RNA_snn_res.0.3"</span></span><span leaf="">,label = T) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"louvain_0.3"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ggsave(plot=p, filename=</span><span><span leaf="">"2-CCA/Dimplot_resolution_0.3.pdf"</span></span><span leaf="">,width = 6, height = 6)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">table(sce.all.filt@active.ident) </span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">qsave(sce.all.filt, file=</span><span><span leaf="">"2-CCA/sce.all_int.qs"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">聚类结果如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTVEOLjjngMo9VqSlCIcicyvSTnKK4JDFjhXFx4IUMoRYseIfZIwehaWQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8057142857142857" data-type="png" data-w="700" data-imgfileid="100056553" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTVEOLjjngMo9VqSlCIcicyvSTnKK4JDFjhXFx4IUMoRYseIfZIwehaWQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">细胞注释</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">根据文章中的气泡图中的基因，看一下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 文献中的基因</span></span><span leaf=""><br></span><span leaf="">genes &lt;- c(</span><span><span leaf="">"S100A8"</span></span><span leaf="">, </span><span><span leaf="">"S100A9"</span></span><span leaf="">, </span><span><span leaf="">"S100A12"</span></span><span leaf="">, </span><span><span leaf="">"VCAN"</span></span><span leaf="">, </span><span><span leaf="">"FCN1"</span></span><span leaf="">, </span><span><span leaf="">"FCER1A"</span></span><span leaf="">, </span><span><span leaf="">"CD1C"</span></span><span leaf="">, </span><span><span leaf="">"CLEC10A"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">           </span><span><span leaf="">"CD1E"</span></span><span leaf="">, </span><span><span leaf="">"AREG"</span></span><span leaf="">, </span><span><span leaf="">"APOE"</span></span><span leaf="">, </span><span><span leaf="">"APOC1"</span></span><span leaf="">, </span><span><span leaf="">"C1QA"</span></span><span leaf="">, </span><span><span leaf="">"C1QB"</span></span><span leaf="">, </span><span><span leaf="">"C1QC"</span></span><span leaf="">, </span><span><span leaf="">"LST1"</span></span><span leaf="">, </span><span><span leaf="">"LINC01272"</span></span><span leaf="">, </span><span><span leaf="">"FCGR3A"</span></span><span leaf="">, </span><span><span leaf="">"IFITM2"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">DotPlot(sce.all.int, features = genes,cols = </span><span><span leaf="">"RdBu"</span></span><span leaf="">,col.min = 0, col.max = 1,cluster.idents = T,scale = T) + </span><span leaf=""><br></span><span leaf="">  RotatedAxis()  </span><span><span leaf=""># 旋转坐标轴</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">根据这个图，我们可以看到这里个亚群跟文献中的一致：cluster1,2,4,6</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTz00xib2TKRfAfnq1MA3rnbwgsgibGBlvtorZmVOjianG0Pee3FCDe8BrQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6470588235294118" data-type="png" data-w="765" data-imgfileid="100056551" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTz00xib2TKRfAfnq1MA3rnbwgsgibGBlvtorZmVOjianG0Pee3FCDe8BrQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">绘制气泡图</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">挑选出cluster1,2,4,6，并绘制美化版本的气泡图：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">sce.sub &lt;- subset(sce.all.int, idents = c(1,2,4,6) )</span><span leaf=""><br></span><span><span leaf=""># 简单注释一下</span></span><span leaf=""><br></span><span leaf="">levels(sce.sub)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">new.cluster.ids &lt;- c(</span><span><span leaf="">"c1: Macrophages"</span></span><span leaf="">, </span><span><span leaf="">"c2: CD1c+ DCs"</span></span><span leaf="">, </span><span><span leaf="">"c4: CD14+ Mono"</span></span><span leaf="">, </span><span><span leaf="">"c6: CD16+ Mono"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">names(new.cluster.ids) &lt;- levels(sce.sub)</span><span leaf=""><br></span><span leaf="">sce.sub &lt;- RenameIdents(sce.sub, new.cluster.ids)</span><span leaf=""><br></span><span leaf="">levels(sce.sub) &lt;- c(</span><span><span leaf="">"c4: CD14+ Mono"</span></span><span leaf="">, </span><span><span leaf="">"c2: CD1c+ DCs"</span></span><span leaf="">, </span><span><span leaf="">"c1: Macrophages"</span></span><span leaf="">, </span><span><span leaf="">"c6: CD16+ Mono"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p &lt;- DotPlot(sce.sub, features = genes,cols = c(</span><span><span leaf="">"lightblue"</span></span><span leaf="">,</span><span><span leaf="">"#e71d27"</span></span><span leaf="">), col.min = 0,col.max = 1,cluster.idents = F,scale = T) + </span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colors = c(</span><span><span leaf="">"lightblue"</span></span><span leaf="">,</span><span><span leaf="">"#e71d27"</span></span><span leaf="">), values = scales::rescale(c(0, 1)), </span><span leaf=""><br></span><span leaf="">                        breaks = c(0,  1), labels = c(0, 1))  + </span><span leaf=""><br></span><span leaf="">  xlab(label = </span><span><span leaf="">""</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  ylab(label = </span><span><span leaf="">""</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  theme(axis.text.x = element_text(angle = 90, hjust = 1),  </span><span><span leaf=""># 旋转x轴标签90度</span></span><span leaf=""><br></span><span leaf="">        axis.text.y = element_text(size = 16),</span><span leaf=""><br></span><span leaf="">        legend.position = </span><span><span leaf="">"top"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">        legend.text.position = </span><span><span leaf="">"top"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">        legend.title.position = </span><span><span leaf="">"bottom"</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">结果如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTiamhZtNnSZWrTqAnzFANMYjtJv73INt5qibmkPrQLwibxoPXPaVqyVjaw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7455089820359282" data-type="png" data-w="668" data-imgfileid="100056552" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wwLbIK1fz4lV0qJr6CccWOTiamhZtNnSZWrTqAnzFANMYjtJv73INt5qibmkPrQLwibxoPXPaVqyVjaw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">学废了吗~</span></span><span></span></h4><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">更多关于 Tissue-resident FOLR2+ macrophages 的分析，可以看看这篇Cell~</span></span><span></span></h4><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><strong><span leaf="">文末友情宣传</span></strong></span><span></span></h3><ul><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247539788&amp;idx=1&amp;sn=62a09c7af6373658bf81c149eb0b4026&amp;scene=21#wechat_redirect"><span leaf="">生信入门&amp;数据挖掘线上直播课4月班</span></a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect"><span leaf="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535760&amp;idx=2&amp;sn=1e02a2e982a046ecf6389231e6768d5b&amp;scene=21#wechat_redirect"><span leaf="">满足你生信分析计算需求的低价解决方案</span></a></section></li></ul></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/B9CT6YkXg_NNcUGtfeg6Og",target="_blank" rel="noopener noreferrer">原文链接</a>
