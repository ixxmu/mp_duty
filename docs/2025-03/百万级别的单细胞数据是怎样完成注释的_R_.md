---
title: "ç™¾ä¸‡çº§åˆ«çš„å•ç»†èƒæ•°æ®æ˜¯æ€æ ·å®Œæˆæ³¨é‡Šçš„(R)"
date: 2025-03-14T01:07:19Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ˜Ÿçƒ"
]
categories: ["Acdemic"]
---
ç™¾ä¸‡çº§åˆ«çš„å•ç»†èƒæ•°æ®æ˜¯æ€æ ·å®Œæˆæ³¨é‡Šçš„(R) by ç”Ÿä¿¡æ˜Ÿçƒ
------
<div><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com"><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com" data-pm-slice="3 5 []"><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013059" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013061" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"></span><span><span leaf="">Â ä»Šå¤©æ˜¯ç”Ÿä¿¡æ˜Ÿçƒé™ªä½ çš„</span><span><strong><span leaf="">ç¬¬1039å¤©</span></strong></span></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013060" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png">Â  Â </span></section><section><blockquote><section><span><span leaf="">å…¬ä¼—å·é‡Œçš„æ–‡ç« å¤§å¤šæ•°éœ€è¦ç¼–ç¨‹åŸºç¡€ï¼Œå¦‚æœå› ä¸ºä»£ç çœ‹ä¸æ‡‚ï¼Œè€Œè·Ÿä¸ä¸Šæ­£æ–‡çš„èŠ‚å¥ï¼Œå¯ä»¥æ¥æ‰¾æˆ‘å­¦ä¹ ï¼Œç›¸å½“äºç»™è‡ªå·±ä¸€ä¸ªæ–°æ‰‹ä¿æŠ¤æœŸã€‚</span></span><span><span leaf="">æˆ‘çš„è¯¾ç¨‹éƒ½æ˜¯å¾ªç¯å¼€è¯¾ï¼Œ</span></span><span><span leaf="">ç‚¹è¿›å»å’¨è¯¢å¾®ä¿¡ï¼Œéšæ—¶å¯ä»¥æŠ¥åâ†“</span></span><span leaf=""><br></span></section><section><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247496614&amp;idx=1&amp;sn=4177354e87d394a022c3d410f482546a&amp;scene=21#wechat_redirect" textvalue="ç”Ÿä¿¡åˆ†â€æç›´æ’­è¯¾ç¨‹" data-itemshowtype="11" target="_blank" linktype="text" data-linktype="2">ç”Ÿä¿¡åˆ†æç›´æ’­è¯¾ç¨‹</a>(æ¯æœˆåˆå¼€ä¸€æœŸ)</span></section><section><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494919&amp;idx=2&amp;sn=967d8dcf0f9a22047ae0bd442b9d4ee6&amp;scene=21#wechat_redirect" textvalue="ç”Ÿä¿¡æ–°æ‰‹ä¿æŠ¤å­¦â€ä¹ å°ç»„" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">ç”Ÿä¿¡æ–°æ‰‹ä¿æŠ¤å­¦ä¹ å°ç»„</a>ï¼ˆæ¯æœˆä¸¤æœŸï¼‰</span></section><section><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;chksm=fdfba53eca8c2c286522b2accc0d4cb9dda7cd9a5b36695e66d393abb5bff396d6bcaa4c9cb8&amp;scene=21#wechat_redirect" textvalue="å•ç»†èƒé™ªä¼´å­¦ä¹ å°ç»„å†…æµ‹å®Œæˆï¼Œé•¿æœŸæ‹›ç”Ÿä¸­" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">å•ç»†èƒé™ªä¼´å­¦ä¹ å°ç»„</a>ï¼ˆæ¯æœˆä¸¤æœŸï¼‰</span></section></blockquote><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com"><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">1.èƒŒæ™¯çŸ¥è¯†</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç»†èƒæ•°é‡å¤ªå¤§æ—¶ï¼Œå•çº¯çš„ä¸€æ¬¡é™ç»´èšç±»åˆ†ç¾¤æ˜¯æ— æ³•æå®šçš„ï¼Œæ‰€ä»¥éœ€è¦äºŒæ¬¡åˆ†ç¾¤ç„¶åæŠŠæ³¨é‡Šçš„ç»“æœé‡æ–°æ”¾å›åŸæ¥çš„å¯¹è±¡ä¸­ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">2.åŠ è½½æ•°æ®</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">sce.Rdata</span></code><span leaf="">æ˜¯é™ç»´èšç±»åˆ†ç¾¤+æ‰‹åŠ¨æ³¨é‡Šçš„ç»“æœ,å…¶ä¸­celltypeåˆ—æ˜¯ç»†èƒç±»å‹æ³¨é‡Šåˆ—ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">seurat_Fibro.obs.csvæ˜¯æˆçº¤ç»´ç»†èƒäºŒæ¬¡åˆ†ç¾¤+æ³¨é‡Šå¾—åˆ°çš„metaè¡¨æ ¼ã€‚åœ¨æœ¬å…¬ä¼—å·èŠå¤©æ¡†(æ³¨æ„ä¸æ˜¯è¯„è®ºåŒº)å›å¤ï¼š<span textstyle="">anno1039</span>å¯ä»¥è·å–æœ¬æ–‡çš„ç¤ºä¾‹æ•°æ®ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(dplyr)</span><span leaf=""><br></span><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">load(</span><span><span leaf="">"sce.Rdata"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">DimPlot(sce, reduction =Â </span><span><span leaf="">"umap"</span></span><span leaf="">,label=T)+NoLegend()+</span><span leaf=""><br></span><span leaf="">Â  scale_color_brewer(palette =Â </span><span><span leaf="">'Set1'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHoE6AKc6lCXQwHbC7B8sW9SsVg6Wckic4mVuwiaDiaI00gVJnhJricxWib0oEhIE8Fcx7NxUDMl1IPkiapA/640?wx_fmt=other&amp;from=appmsg" alt="image.png" data-ratio="0.7138888888888889" data-type="other" data-w="1080" data-imgfileid="100013238" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHoE6AKc6lCXQwHbC7B8sW9SsVg6Wckic4mVuwiaDiaI00gVJnhJricxWib0oEhIE8Fcx7NxUDMl1IPkiapA/640?wx_fmt=other&amp;from=appmsg"></span><figcaption><span leaf="">image.png</span></figcaption></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">subcell_annotator = read.csv(</span><span><span leaf="">'seurat_Fibro.obs.csv'</span></span><span leaf="">,row.names = 1)[</span><span><span leaf="">'celltype'</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">head(subcell_annotator)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## Â  Â  Â  Â  Â  Â  Â  Â  Â  Â celltype</span></span><span leaf=""><br></span><span><span leaf="">## AAAGGATGTAGAAACT-1 Â  Â  Â  M0</span></span><span leaf=""><br></span><span><span leaf="">## AACAAAGGTAAGGTCG-1 Â  Â  Â  M0</span></span><span leaf=""><br></span><span><span leaf="">## AACGGGACAACACAGG-1 Â  Â  Â  M1</span></span><span leaf=""><br></span><span><span leaf="">## AACTTCTTCCTACAAG-1 Â  Â  Â  M0</span></span><span leaf=""><br></span><span><span leaf="">## AAGATAGGTCGTTGGC-1 Â  Â  Â  M1</span></span><span leaf=""><br></span><span><span leaf="">## AAGCCATTCTAGACCA-1 Â  Â  Â  M1</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">unique(subcell_annotator</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## [1] "M0" "M1"</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">3.æ•´åˆ</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å°†äºŒæ¬¡åˆ†ç¾¤çš„ç»“æœæ•´åˆåˆ°åŸæ¥çš„seuratå¯¹è±¡çš„meta.dataä¸­å»</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">sce</span><span><span leaf="">$celltype</span></span><span leaf="">Â = as.character(Idents(sce))</span><span leaf=""><br></span><span leaf="">sce</span><span><span leaf="">$celltype</span></span><span leaf="">Â = ifelse(sce</span><span><span leaf="">$celltype</span></span><span leaf="">==</span><span><span leaf="">'Fibroblasts'</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â subcell_annotator</span><span><span leaf="">$celltype</span></span><span leaf="">[match(colnames(sce),rownames(subcell_annotator))],</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â sce</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><blockquote><p><span leaf="">è¿™å¥æ˜¯Rè¯­è¨€åŸºç¡€éƒ¨åˆ†çš„ä¸¤ä¸ªç²¾åçŸ¥è¯†ifelseå’Œmatchçš„åˆä½“ã€‚</span></p><p><span leaf="">çœŸç¾¡æ…•ä½ ä¸€æ­¥åˆ°ä½ä»æˆ‘è¿™é‡Œå­¦åˆ°äº†è¿™ä¹ˆå‰å®³çš„æŠ€èƒ½ğŸ‘†ï¼ä¸Šåˆ«å¤„æ‰¾çš„å®ç°è¿™ä¸ªç›®çš„çš„ä»£ç å¯èƒ½è¦å†™ä¸‰äº”å¥å‘¢ï¼Œæˆ‘çš„æœ€ç®€æ´ğŸ˜„ã€‚</span></p></blockquote><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">Â </span></span></span><span><span><span leaf="">Â </span></span><span leaf="">â˜è¡¥å……å­¦ä¹ match</span></span><span><span><span leaf="">Â </span></span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">matchå‡½æ•°æ—¶åŒ¹é…ï¼Œç”¨äºæ‰¾å‡ºä¸€ä¸ªå‘é‡ä¸­çš„å…ƒç´ åœ¨å¦ä¸€ä¸ªå‘é‡ä¸­çš„å¯¹åº”ä½ç½®ï¼Œéå¸¸å®ç”¨çš„Rè¯­è¨€ç¥æŠ€èƒ½ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">x &lt;- c(</span><span><span leaf="">"f"</span></span><span leaf="">,</span><span><span leaf="">"b"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">y &lt;- c(</span><span><span leaf="">"b"</span></span><span leaf="">,</span><span><span leaf="">"c"</span></span><span leaf="">,</span><span><span leaf="">"f"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">match(x, y)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## [1] 3 1</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ‰¾å‡ºxçš„å…ƒç´ åœ¨yä¸­çš„å¯¹åº”ä½ç½®ã€‚3 1å°±è¡¨ç¤º xé‡Œçš„ä¸¤ä¸ªå…ƒç´ få’Œbåˆ†åˆ«åœ¨yçš„ç¬¬3å’Œç¬¬1ä¸ªä½ç½®</span></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">Â </span></span></span><span><span><span leaf="">Â </span></span><span leaf="">â˜è¡¥å……å­¦ä¹ ifelse</span></span><span><span><span leaf="">Â </span></span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¶…çº§å®ç”¨çš„å‡½æ•°,å¯ä»¥</span><strong><span leaf="">æ ¹æ®é€»è¾‘å€¼æ˜¯Tè¿˜æ˜¯Fäº§ç”Ÿä¸åŒçš„å€¼</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">age &lt;- 0:28</span><span leaf=""><br></span><span leaf="">age</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## Â [1] Â 0 Â 1 Â 2 Â 3 Â 4 Â 5 Â 6 Â 7 Â 8 Â 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24</span></span><span leaf=""><br></span><span><span leaf="">## [26] 25 26 27 28</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">ifelse(age&gt;18,</span><span><span leaf="">'+'</span></span><span leaf="">,</span><span><span leaf="">'-'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## Â [1] "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"</span></span><span leaf=""><br></span><span><span leaf="">## [20] "+" "+" "+" "+" "+" "+" "+" "+" "+" "+"</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™å°±è¡¨ç¤ºå¦‚æœage&gt;18å°±äº§ç”Ÿ+ï¼Œå¦åˆ™å°±äº§ç”Ÿ-ã€‚åŠ å·å’Œå‡å·åªæ˜¯ä¾‹å­ï¼Œå¯ä»¥æŒ‰éœ€æ¢æˆåˆ«çš„å€¼ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">ifelse(age&gt;18,</span><span><span leaf="">"adult"</span></span><span leaf="">,</span><span><span leaf="">"child"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## Â [1] "child" "child" "child" "child" "child" "child" "child" "child" "child"</span></span><span leaf=""><br></span><span><span leaf="">## [10] "child" "child" "child" "child" "child" "child" "child" "child" "child"</span></span><span leaf=""><br></span><span><span leaf="">## [19] "child" "adult" "adult" "adult" "adult" "adult" "adult" "adult" "adult"</span></span><span leaf=""><br></span><span><span leaf="">## [28] "adult" "adult"</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä¹Ÿæ”¯æŒå¤šä¸ªæ¡ä»¶ï¼Œä»£ç å°±è¦åµŒå¥—èµ·æ¥äº†ã€‚</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">ifelse(age&gt;18,</span><span><span leaf="">"adult"</span></span><span leaf="">,ifelse(age&lt;=1,</span><span><span leaf="">"baby"</span></span><span leaf="">,</span><span><span leaf="">"child"</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## Â [1] "baby" Â "baby" Â "child" "child" "child" "child" "child" "child" "child"</span></span><span leaf=""><br></span><span><span leaf="">## [10] "child" "child" "child" "child" "child" "child" "child" "child" "child"</span></span><span leaf=""><br></span><span><span leaf="">## [19] "child" "adult" "adult" "adult" "adult" "adult" "adult" "adult" "adult"</span></span><span leaf=""><br></span><span><span leaf="">## [28] "adult" "adult"</span></span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™ä¸ªæ˜¯ï¼šå¤§äº18ï¼Œå°±äº§ç”Ÿâ€adultâ€ï¼Œå¦åˆ™å†æ¬¡ç”¨</span><code><span leaf="">ifesle</span></code><span leaf="">è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå°äº1ï¼Œå°±äº§ç”Ÿâ€babyâ€ï¼Œå¦åˆ™å°±äº§ç”Ÿâ€childâ€ã€‚</span></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">Â </span></span></span><span><span><span leaf="">Â </span></span><span leaf="">åŒå‰‘åˆç’§</span></span><span><span><span leaf="">Â </span></span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å› æ­¤ï¼Œåˆšæ‰çš„ä»£ç ä½¿ç”¨</span><code><span leaf="">ifelse</span></code><span leaf="">å‡½æ•°å®ç°äº†åˆ†æƒ…å†µè®¨è®ºï¼šåˆ¤æ–­sceçš„æ¯ä¸ªç»†èƒæ˜¯å¦æ˜¯my_sub(æœ¬ä¾‹æ˜¯Fibroblasts),å¦‚æœæ˜¯çš„è¯ï¼Œå°±æ›¿æ¢æˆsubcell_annotatoré‡Œé¢åŒ¹é…çš„æ¯ä¸ªç»†èƒå¯¹åº”çš„celltypeï¼Œä¹Ÿå°±æ˜¯M0å’ŒM1ï¼›å¦åˆ™å°±ä¸æ›¿æ¢ï¼Œè¿˜æ˜¯åŸæ¥çš„celltypeã€‚</span></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">Â </span></span></span><span><span><span leaf="">Â </span></span><span leaf="">ç”»ä¸ªå›¾çœ‹çœ‹å’¯</span></span><span><span><span leaf="">Â </span></span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">Idents(sce) = sce</span><span><span leaf="">$celltype</span></span><span leaf=""><br></span><span leaf="">DimPlot(sce,label = T)+NoLegend()+scale_color_brewer(palette =Â </span><span><span leaf="">'Set1'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHoE6AKc6lCXQwHbC7B8sW9S4dUoRqpic7BQjQRZRIhJwo3k1uNRQxBwPiaiblGImJicOGOUPf8KR87zHQ/640?wx_fmt=other&amp;from=appmsg" alt="image.png" data-ratio="0.4166666666666667" data-type="other" data-w="1080" data-imgfileid="100013237" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHoE6AKc6lCXQwHbC7B8sW9S4dUoRqpic7BQjQRZRIhJwo3k1uNRQxBwPiaiblGImJicOGOUPf8KR87zHQ/640?wx_fmt=other&amp;from=appmsg"></span></figure></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/rU_uBGW-yyfFyLA_7XsPyQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
