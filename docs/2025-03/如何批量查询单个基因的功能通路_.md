---
title: "如何批量查询单个基因的功能通路？"
date: 2025-03-05T02:00:22Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
如何批量查询单个基因的功能通路？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><p>我们的马拉松授课最后一周给大家讲解了<strong>KEGG和GO数据库的网页版本的单个基因与多个基因的功能注释，还讲解了功能注释与功能富集的区别。</strong><span>富集其实就是显著注释到的功能通路</span>。然后上课有个学员跟着实际操作演练，发现他的基因在KEGG数据库网页中没有找到通路：</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>KEGG 网页对某个基因的注释操作为：</span><span></span></h2><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054763" data-ratio="0.4388888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83BiadaH5WejMY1ID3pZjibj12S4KJ1OQAq019ceoia5c16UIMfshovO1cA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83BiadaH5WejMY1ID3pZjibj12S4KJ1OQAq019ceoia5c16UIMfshovO1cA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>学员的查询结果：</span><span></span></h2><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054761" data-ratio="0.3203463203463203" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83eH6LP2n8mXAUSPJ6ziaF3c5klbTAuQYrccGjngBuB6ZK22dkSPqmYicA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="693" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83eH6LP2n8mXAUSPJ6ziaF3c5klbTAuQYrccGjngBuB6ZK22dkSPqmYicA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">然后我验证了一下他的操作，真的没有找到！下面来看看其他的方法！</p><h2 data-tool="mdnice编辑器"><span></span><span>批量代码版本注释一个基因</span><span></span></h2><p data-tool="mdnice编辑器">学员的基因我们就不放了，我们随便找一个基因比如 <span>EPCAM</span>，一个上皮细胞的经典基因。我们上面讲了，<span>基因的注释与富集含义是一样的，只不过富集是显著注释的通路，通过卡一个pvalue或者其他的阈值挑选得到，那我们第一种方法就用功能富集的方式拿到这个基因注释到的通路</span>：</p><p data-tool="mdnice编辑器">这里<span>需要注意参数的设置</span>，我们的目的是拿到所有可能的通路，所以设置了：<code>pvalueCutoff= 1,qvalueCutoff= 1, minGSSize = 1, maxGSSize = 100000</code>，ont为ALL，包括了CC，MF，BP三个集合的：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br>library(clusterProfiler)<br>library(org.Hs.eg.db)<br>library(GSEABase)<br>library(ggplot2)<br>library(tidyverse)<br><br><span># 单个基因查询</span><br><span># GO通路</span><br>ego_ALL &lt;- enrichGO(gene=<span>"EPCAM"</span>, OrgDb= <span>'org.Hs.eg.db'</span>, keyType=<span>'SYMBOL'</span>, ont=<span>"ALL"</span>, <br>                   pvalueCutoff= 1,qvalueCutoff= 1, minGSSize = 1, maxGSSize = 100000)<br><br><br><span># KEGG通路</span><br><span># 拿到这个基因的ENTREZID</span><br>bitr(gene=<span>"EPCAM"</span>, fromType=<span>"SYMBOL"</span>, toType=<span>"ENTREZID"</span>, OrgDb=<span>'org.Hs.eg.db'</span>)<br>ekegg_ALL &lt;- enrichKEGG(gene = <span>"4072"</span>, organism = <span>'hsa'</span>, pvalueCutoff = 1, qvalueCutoff = 1,minGSSize = 1, maxGSSize = 100000)<br></code></pre><p data-tool="mdnice编辑器">以 GO数据 结果为例，我们拿到了 138条通路：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054760" data-ratio="0.43116883116883115" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83Se71ZX827UuFQHbGTnNkp5qPriaZpyzJlicHI2zOHswaDKiamrMU4Voicw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="770" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83Se71ZX827UuFQHbGTnNkp5qPriaZpyzJlicHI2zOHswaDKiamrMU4Voicw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">具体的result：</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054762" data-ratio="0.27977315689981097" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83UAzqx6wlHACKLdiaV0fh2jRTX4e25SQJecgc6KBoJC9FXcsF5aiavCtA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1058" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83UAzqx6wlHACKLdiaV0fh2jRTX4e25SQJecgc6KBoJC9FXcsF5aiavCtA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>还没有其他的方法？更全的通路：MsigDB</span><span></span></h2><p data-tool="mdnice编辑器"><span>我们也可以拿到 MsigDB 数据库中所有 含有EPCAM基因的通路！</span></p><p data-tool="mdnice编辑器">首先去 MsigDB 数据库下载所有通路的gmt文件：msigdb.v2024.1.Hs.symbols.gmt，只有20几M，很快就下载完了！</p><p data-tool="mdnice编辑器">https://www.gsea-msigdb.org/gsea/msigdb/collections.jsp</p><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054759" data-ratio="0.31966224366706875" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83YrIicKlAdvk50pWThc8PR97BmpCmw4KlXCvs3MULsyK1xKzX4MsFArg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="829" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83YrIicKlAdvk50pWThc8PR97BmpCmw4KlXCvs3MULsyK1xKzX4MsFArg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>## 所有通路</span><br>geneset &lt;- read.gmt(<span>"msigdb.v2024.1.Hs.symbols.gmt"</span>)<br>geneset_EPCAM &lt;- geneset[geneset<span>$gene</span> == <span>"EPCAM"</span>,]<br>head(geneset_EPCAM)<br>dim(geneset_EPCAM)<br>str(geneset_EPCAM)<br></code></pre><figure data-tool="mdnice编辑器"><img alt="" data-imgfileid="100054768" data-ratio="0.2855245683930943" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83HqBvAGtZgXplcf90UqkZxibCo4gzwdFTwqIWGppwRqOoC1dJjzwICZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="753" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxAPBiagRMX7Fm3icCHUtoj83HqBvAGtZgXplcf90UqkZxibCo4gzwdFTwqIWGppwRqOoC1dJjzwICZA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>总共有464条！功能数据库不止 KEGG 与 GO ~</span><span></span></h4><h3 data-tool="mdnice编辑器"><span></span><span></span><span><strong>友情宣传</strong></span><span></span></h3><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247527230&amp;idx=1&amp;sn=7156afcd5ab734c7d391b9048695747a&amp;scene=21#wechat_redirect" data-linktype="2">生信入门&amp;数据挖掘线上直播课2025年1月班</a></p><p data-tool="mdnice编辑器"><a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" data-linktype="2">时隔5年，我们的生信技能树VIP学徒继续招生啦</a></p><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535760&amp;idx=2&amp;sn=1e02a2e982a046ecf6389231e6768d5b&amp;scene=21#wechat_redirect" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vnhX_C0G7L6AoRK-Jkkv2Q",target="_blank" rel="noopener noreferrer">原文链接</a>
