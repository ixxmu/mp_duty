---
title: "单细胞实战之亚细胞分群之CD4+T细胞分群——从入门到进阶(中级篇2）"
date: 2025-03-23T16:42:27Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
单细胞实战之亚细胞分群之CD4+T细胞分群——从入门到进阶(中级篇2） by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">上一讲在完成了从T/NK至CD4+T细胞流程实践后，在这一讲内容中我们将对</span><strong><span leaf="">CD4+T细胞进行亚群的细分</span></strong><span leaf="">。</span></p><p data-tool="mdnice编辑器"><span leaf="">上期推文：<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528271&amp;idx=1&amp;sn=333686533ec8b7cadf913a3868c79dd2&amp;scene=21#wechat_redirect" textvalue="单细胞实战之亚细胞分群从T/NK至CD4+T细胞 (中级篇1）" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">单细胞实战之亚细胞分群从T/NK至CD4+T细胞 (中级篇1）</a></span></p><p data-tool="mdnice编辑器"><span leaf="">中级篇1最后的工程文件以及本次课程中会用到的一些文件：<span textstyle="">链接: https://pan.baidu.com/s/18_jO0y6_QyEtyzZJkmIp_Q 提取码: 27jw</span> 。此外，可以向“生信技能树”公众号发送关键词‘单细胞’，直接获取Seurat V5版本的完整代码。</span></p><p data-tool="mdnice编辑器"><span leaf="">需要提醒的是，</span><strong><span leaf="">本次细胞亚群注释较为复杂，笔者更多会从技术角度展示分析流程和结果，而非从生物学背景角度进行解读！</span></strong><span leaf=""> 具体的亚群细分命名笔者主要会从三大块进行考量：</span><strong><span leaf="">1. 先验知识证据；2. 转录因子结果；3. 差异基因结果；</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">首先需要对常规的CD4+T细胞亚群具有一定了解，这些细胞亚群包括了：幼稚性T细胞，辅助性T细胞(THs)，记忆性T细胞和调节性T细胞(Treg)等细胞。</span></p><ol><li><section><span leaf="">Naive CD4+T细胞：是一类尚未遇到抗原的 T 辅助细胞（T helper cells, Th）。它们在胸腺中发育成熟后进入外周免疫系统，处于静息状态，尚未被抗原刺激或激活。</span></section></li><li><section><span leaf="">辅助性T细胞：主要通过信号传导支持其他免疫细胞的功能。根据它们分泌的细胞因子不同，可以分为多个亚型(Th1，Th2，Th9，Th17，Th22，Tfh)，每种亚型在免疫应答中发挥不同的作用。</span></section></li><li><section><span leaf="">记忆性T细胞：是一类能够长期存活并在二次免疫应答中迅速反应的 T 细胞。这里仅考虑CD4+记忆性T细胞。</span></section></li><li><section><span leaf="">调节性T细胞：对维持自身免疫耐受和免疫稳态方面至关重要，同时在某些情况下也可能促进疾病进展。其中，Foxp3 是 Treg 细胞的重要标志物。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">分析步骤：</span></span><span></span></h4><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.导入</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">options(stringsAsFactors = </span><span><span leaf="">F</span></span><span leaf="">) </span><span leaf=""><br></span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">'scRNA_scripts/lib.R'</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">'scRNA_scripts/mycolors.R'</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(stringr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(clustree)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(cowplot)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(data.table)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(dplyr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(qs)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(BiocParallel)</span><span leaf=""><br></span><span leaf="">register(MulticoreParam(workers = </span><span><span leaf="">8</span></span><span leaf="">, progressbar = </span><span><span leaf="">TRUE</span></span><span leaf="">)) </span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">dir.create(</span><span><span leaf="">"./9-CD4+T/"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">setwd(</span><span><span leaf="">"./9-CD4+T"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce &lt;- qread(</span><span><span leaf="">"sub_data_cd4+T.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">DimPlot(sce)</span><span leaf=""><br></span><span leaf="">table(sce@meta.data$RNA_snn_res.2)</span><span leaf=""><br></span><span><span leaf="">#   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 </span></span><span leaf=""><br></span><span><span leaf=""># 421 410 408 390 379 373 349 333 328 328 313 293 285 280 248 204 196 189 185</span></span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.基于先验知识的经典细胞亚群分类及注释</span></span><span></span></h5><p data-tool="mdnice编辑器"><span leaf="">先按照生物学知识尝试分群，这就需要研究者有较强的生物学背景，通过人工阅读差异基因列表来判断，可以使用FindAllmarkers函数，也可以使用cosg做差异分析。（顺便提一下张泽明院士团队对差异基因的其中一个评价标准：每个簇的标志性基因是通过 Seurat软件包中的 FindAllMarkers 函数获得的，符合以下标准的基因被认为是特征基因：1. 经过 Bonferroni 校正后，所有特征基因的调整 P 值 &lt; 0.01；2. 平均表达量的对数倍数变化（log fold-change）&gt; 1；3. pct.1 &gt; 0.5（即该基因在该簇中表达的细胞比例大于 50%）；4. pct.2 &lt; 0.5（即该基因在其他簇中表达的细胞比例小于 50%），这个标准可以学习借鉴。）</span></p><p data-tool="mdnice编辑器"><span leaf="">此外，流式分选时采用的“层层递进”策略也是值得我们学习的，但由于流式检测的是细胞表面标志物，这些标志物不适用于单细胞数据分析，因此需要更换为适合单细胞数据的标志物。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyOOGd83bwnEAoGeJvGknIiah3H28cmrG5JUgozpiaNJEBpQU4KYBfIIew/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9663865546218487" data-type="png" data-w="476" data-imgfileid="100045212" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyOOGd83bwnEAoGeJvGknIiah3H28cmrG5JUgozpiaNJEBpQU4KYBfIIew/640?wx_fmt=png&amp;from=appmsg"></span></p><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.1  区分Treg/not Treg</span></span><span></span></h6><p data-tool="mdnice编辑器"><span leaf="">为什么选择Treg，因为笔者认为这个细胞亚群与其他的细胞亚群相比，存在较大的相对异质性。同时也符合流式分选的流程。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">CD4_markers_step1 =list(</span><span leaf=""><br></span><span leaf="">  T_check=c(</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">"CD3E"</span></span><span leaf="">,</span><span><span leaf="">"CD4"</span></span><span leaf="">,</span><span><span leaf="">'CD8A'</span></span><span leaf="">,</span><span><span leaf="">"PTPRC"</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">  Treg=c(</span><span><span leaf="">"TNFRSF4"</span></span><span leaf="">,</span><span><span leaf="">"BATF"</span></span><span leaf="">,</span><span><span leaf="">"TNFRSF18"</span></span><span leaf="">,</span><span><span leaf="">"FOXP3"</span></span><span leaf="">,</span><span><span leaf="">"IL2RA"</span></span><span leaf="">,</span><span><span leaf="">"IKZF2"</span></span><span leaf="">,</span><span><span leaf="">"IL7R"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">genes_to_check = lapply(CD4_markers_step1, </span><span><span leaf="">function</span></span><span leaf="">(x) str_to_upper(x))</span><span leaf=""><br></span><span leaf="">DotPlot(sce, features = genes_to_check ) + </span><span leaf=""><br></span><span leaf="">     </span><span><span leaf=""># coord_flip() + </span></span><span leaf=""><br></span><span leaf="">      theme(axis.text.x=element_text(angle=</span><span><span leaf="">45</span></span><span leaf="">,hjust = </span><span><span leaf="">1</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">w=length( unique(unlist(genes_to_check)) )/</span><span><span leaf="">5</span></span><span leaf="">+</span><span><span leaf="">12</span></span><span leaf="">;w</span><span leaf=""><br></span><span leaf="">ggsave(filename = </span><span><span leaf="">"CD4_T_markers_step1.pdf"</span></span><span leaf="">, width = w)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># featurePlot可视化</span></span><span leaf=""><br></span><span leaf="">marker &lt;- c(</span><span><span leaf="">"PTPRC"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p &lt;- FeaturePlot(sce,features = marker,cols = c(</span><span><span leaf="">"lightgrey"</span></span><span leaf=""> ,</span><span><span leaf="">"red"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">            combine = </span><span><span leaf="">TRUE</span></span><span leaf="">,raster=</span><span><span leaf="">FALSE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p|DimPlot(sce,label = </span><span><span leaf="">T</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ggsave(</span><span><span leaf="">"featurePlot_step1.pdf"</span></span><span leaf="">,width = </span><span><span leaf="">12</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># VlnPlot可视化</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(paletteer) </span><span leaf=""><br></span><span leaf="">VlnPlot(sce,features = marker,cols = c(paletteer_d(</span><span><span leaf="">"awtools::bpalette"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">           paletteer_d(</span><span><span leaf="">"awtools::a_palette"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">           paletteer_d(</span><span><span leaf="">"awtools::mpalette"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">           paletteer_d(</span><span><span leaf="">"awtools::spalette"</span></span><span leaf="">)),</span><span leaf=""><br></span><span leaf="">            combine = </span><span><span leaf="">TRUE</span></span><span leaf="">,raster=</span><span><span leaf="">FALSE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">ggsave(</span><span><span leaf="">"VlnPlot_step1.pdf"</span></span><span leaf="">,width = </span><span><span leaf="">9</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">根据第一步结果，第3,6,10,13,16,18簇可被认为是Treg细胞。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyK32jxQsIBDGdcSQGPMOPJUhKdF665l7eicoZbIcEIm3zlJvYsOeoytA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5111111111111111" data-type="png" data-w="1080" data-imgfileid="100045214" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyK32jxQsIBDGdcSQGPMOPJUhKdF665l7eicoZbIcEIm3zlJvYsOeoytA/640?wx_fmt=png&amp;from=appmsg">PTPRC又叫做CD45，从单细胞测序水平来看其几乎在所有细胞中都是表达的（RNA水平），而在进行流式的时候是可以用这个基因表达的阳/阴性去区分细胞亚群（蛋白质水平），因此不可完全采用流式分选中使用的标志物在单细胞数据中进行分群。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyvWHDFJpPva4ddoQ6mZZ2dyFAJnR2RmicmeTLHaqZ5Lvh41snVjyicg1w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3537037037037037" data-type="png" data-w="1080" data-imgfileid="100045215" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyvWHDFJpPva4ddoQ6mZZ2dyFAJnR2RmicmeTLHaqZ5Lvh41snVjyicg1w/640?wx_fmt=png&amp;from=appmsg"></span></p><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.2 区分其他T细胞亚群</span></span><span></span></h6><p data-tool="mdnice编辑器"><span leaf="">理论上也应该层层递进下去，但实操中发现还是有点难度,不同细胞亚群的标志物界限比较模糊</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 进一步区分其他亚群</span></span><span leaf=""><br></span><span leaf="">CD4_markers_step2 =list(</span><span leaf=""><br></span><span leaf="">  T_check=c(</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">"CD3E"</span></span><span leaf="">,</span><span><span leaf="">"CD4"</span></span><span leaf="">,</span><span><span leaf="">'CD8A'</span></span><span leaf="">,</span><span><span leaf="">"PTPRC"</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">  Naive=c(</span><span><span leaf="">"CCR7"</span></span><span leaf="">,</span><span><span leaf="">"SELL"</span></span><span leaf="">,</span><span><span leaf="">"CD5"</span></span><span leaf="">,</span><span><span leaf="">"LEF1"</span></span><span leaf="">,</span><span><span leaf="">"TCF7"</span></span><span leaf="">), </span><span><span leaf=""># CD197,CD62L</span></span><span leaf=""><br></span><span leaf="">  Memory=c(</span><span><span leaf="">"CXCR4"</span></span><span leaf="">,</span><span><span leaf="">"TNFRSF4"</span></span><span leaf="">,</span><span><span leaf="">"RORA"</span></span><span leaf="">,</span><span><span leaf="">"IL17RA"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Tfh=c(</span><span><span leaf="">"CXCR5"</span></span><span leaf="">,</span><span><span leaf="">"BCL6"</span></span><span leaf="">,</span><span><span leaf="">"ICA1"</span></span><span leaf="">,</span><span><span leaf="">"TOX"</span></span><span leaf="">,</span><span><span leaf="">"TOX2"</span></span><span leaf="">,</span><span><span leaf="">"IL6ST"</span></span><span leaf="">),</span><span><span leaf="">#滤泡辅助性T细胞;CD185=CXCR5</span></span><span leaf=""><br></span><span leaf="">  Ths=c(</span><span><span leaf="">"CCR10"</span></span><span leaf="">,</span><span><span leaf="">"CCR4"</span></span><span leaf="">,</span><span><span leaf="">"CCR6"</span></span><span leaf="">,</span><span><span leaf="">"CXCR3"</span></span><span leaf="">)</span><span><span leaf="">#"CCR10","CD194","CD196","CD183"</span></span><span leaf=""><br></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">genes_to_check = lapply(CD4_markers_step2, </span><span><span leaf="">function</span></span><span leaf="">(x) str_to_upper(x))</span><span leaf=""><br></span><span leaf="">DotPlot(sce, features = genes_to_check ) + </span><span leaf=""><br></span><span leaf="">     </span><span><span leaf=""># coord_flip() + </span></span><span leaf=""><br></span><span leaf="">      theme(axis.text.x=element_text(angle=</span><span><span leaf="">45</span></span><span leaf="">,hjust = </span><span><span leaf="">1</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">w=length( unique(unlist(genes_to_check)) )/</span><span><span leaf="">5</span></span><span leaf="">+</span><span><span leaf="">12</span></span><span leaf="">;w</span><span leaf=""><br></span><span leaf="">ggsave(filename = </span><span><span leaf="">"CD4_T_markers_step2.pdf"</span></span><span leaf="">, width = w)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyoL1SxpPtWUOor7ETickkpyrk8sB12P85libYTmGHDV5IzibPckTSjuHQw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4398148148148148" data-type="png" data-w="1080" data-imgfileid="100045213" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyoL1SxpPtWUOor7ETickkpyrk8sB12P85libYTmGHDV5IzibPckTSjuHQw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.3 张泽民院士团队，PMID: 30479382                                                                                                                                                                           名称和标志物如下：Naive CD4+ T 细胞(CCR7)；中央记忆T细胞，Tcm（ANXA1，TCF7）；效应记忆/效应T细胞，Temra/Teff（GNLY）；Treg细胞(FOXP3, CTLA4)；Th1细胞(IFNG，CXCL13)；Tem/Th1细胞（IFNG，GZMK，BHLHE40）；Th17细胞(IL23R)；Tfh细胞(CXCR5)；组织驻留记忆T细胞，Trm(CXCR6)；固有层Trm细胞,P.Trm(CD6)；</span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">CD4_markers_step3 =list(</span><span leaf=""><br></span><span leaf="">  T_check=c(</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">"CD3E"</span></span><span leaf="">,</span><span><span leaf="">"CD4"</span></span><span leaf="">,</span><span><span leaf="">'CD8A'</span></span><span leaf="">,</span><span><span leaf="">"PTPRC"</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">  Naive=c(</span><span><span leaf="">"CCR7"</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">  Tcm=c(</span><span><span leaf="">"ANXA1"</span></span><span leaf="">,</span><span><span leaf="">"TCF7"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  `Temra/Teff`=c(</span><span><span leaf="">"GNLY"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Treg=c(</span><span><span leaf="">"FOXP3"</span></span><span leaf="">,</span><span><span leaf="">"CTLA4"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Th1 = c(</span><span><span leaf="">"IFNG"</span></span><span leaf="">,</span><span><span leaf="">"CXCL13"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  `Th1/Th1`=c(</span><span><span leaf="">"GZMK"</span></span><span leaf="">,</span><span><span leaf="">"BHLHE40"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Th17=c(</span><span><span leaf="">"IL23R"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Tfh=c(</span><span><span leaf="">"CXCR5"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  Trm=c(</span><span><span leaf="">"CXCR6"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  P.Trm = c(</span><span><span leaf="">"CD6"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">genes_to_check = lapply(CD4_markers_step3, </span><span><span leaf="">function</span></span><span leaf="">(x) str_to_upper(x))</span><span leaf=""><br></span><span leaf="">DotPlot(sce, features = genes_to_check ) + </span><span leaf=""><br></span><span leaf="">     </span><span><span leaf=""># coord_flip() + </span></span><span leaf=""><br></span><span leaf="">      theme(axis.text.x=element_text(angle=</span><span><span leaf="">45</span></span><span leaf="">,hjust = </span><span><span leaf="">1</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">w=length( unique(unlist(genes_to_check)) )/</span><span><span leaf="">5</span></span><span leaf="">+</span><span><span leaf="">12</span></span><span leaf="">;w</span><span leaf=""><br></span><span leaf="">ggsave(filename = </span><span><span leaf="">"CD4_T_markers_step3.pdf"</span></span><span leaf="">, width = w)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyPf0lVNySaoe4yiawEC6SsVBp4HZG04gGDRC9tHUibucVEpsepPdqg2Zg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6157407407407407" data-type="png" data-w="1080" data-imgfileid="100045218" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyPf0lVNySaoe4yiawEC6SsVBp4HZG04gGDRC9tHUibucVEpsepPdqg2Zg/640?wx_fmt=png&amp;from=appmsg">结合上面的结果对剩下的第0,1,2,4,5,7,8,9,11,12,14,15,17簇进行注释，其中第7-9,12簇可能为Naive CD4+细胞,第0,1,2,4,5,11,14簇可能是记忆性T细胞(Tcm)，第5簇可能是Th1细胞。但是说实话，根据上面的结果笔者没有办法明确的认定这些细胞簇分别代表什么细胞。</span></p><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.基于转录因子分析结果注释</span></span><span></span></h5><p data-tool="mdnice编辑器"><span leaf="">TFs在单细胞数据中能够较有效地区分细胞亚群，主要因为它们决定细胞命运并调控基因表达，不同细胞类型往往具有特异性的 TFs 表达模式。此外，TFs 通过调控基因网络（GRN）影响细胞的分子特征，并在细胞分化轨迹中起关键作用，揭示不同阶段的细胞变化。因此，通过分析 TFs 的表达模式和调控关系，可以精准识别细胞亚群并解析其功能特性。</span></p><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.1 导入</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(qs)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span leaf="">sce &lt;- qread(</span><span><span leaf="">"./9-CD4+T/sub_data_cd4+T.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">dir.create(</span><span><span leaf="">"10-pyscenic"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">setwd(</span><span><span leaf="">"10-pyscenic"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.2 数据预处理</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(SCopeLoomR)</span><span leaf=""><br></span><span><span leaf=""># 将sce对象中的数据转置并保存为CSV</span></span><span leaf=""><br></span><span leaf="">counts &lt;- GetAssayData(sce, slot = </span><span><span leaf="">"counts"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 保存为loom文件</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(loomR)</span><span leaf=""><br></span><span leaf="">loom &lt;- create(filename = </span><span><span leaf="">"input.loom"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">               data = counts, overwrite = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">loom$close()</span><span leaf=""><br></span><span leaf="">rm(loom)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">setwd(</span><span><span leaf="">".."</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">后续都会用这个input.loom文件数据，如果loom经常出现被锁定的情况就用python语言去转换。</span></p><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.3 pyscenic分析</span></span><span></span></h6><p data-tool="mdnice编辑器"><span leaf="">pyscenic环境安装，在终端/linux中运行，适用于Mac。其中需要用到的文件都在网盘里面。详细内容可至参考资料中阅读既往推文。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">CONDA_SUBDIR=osx-</span><span><span leaf="">64</span></span><span leaf=""> conda create -n pyscenic_3.7 python=</span><span><span leaf="">3.7</span></span><span leaf=""><br></span><span leaf="">conda activate pyscenic_3.7</span><span leaf=""><br></span><span leaf="">pip install pyscenic    </span><span leaf=""><br></span><span leaf="">conda install numpy</span><span leaf=""><br></span><span leaf="">conda install pandas</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">conda activate pyscenic_3.7</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#GRN-step1</span></span><span leaf=""><br></span><span leaf="">pyscenic grn \</span><span leaf=""><br></span><span leaf="">--num_workers </span><span><span leaf="">10</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">--output step1out_grn.tsv \</span><span leaf=""><br></span><span leaf="">--method grnboost2 \</span><span leaf=""><br></span><span leaf="">input.loom \</span><span leaf=""><br></span><span leaf="">hsa_hgnc_tfs.motifs-v10.txt</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#GRN-step2</span></span><span leaf=""><br></span><span leaf="">pyscenic ctx \</span><span leaf=""><br></span><span leaf="">step1out_grn.tsv \</span><span leaf=""><br></span><span leaf="">hg38_500bp_up_100bp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather \</span><span leaf=""><br></span><span leaf="">hg38_10kbp_up_10kbp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather \</span><span leaf=""><br></span><span leaf="">--annotations_fname motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl \</span><span leaf=""><br></span><span leaf="">--expression_mtx_fname input.loom \</span><span leaf=""><br></span><span leaf="">--output step2out_ctx.tsv \</span><span leaf=""><br></span><span leaf="">--mode </span><span><span leaf="">"dask_multiprocessing"</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">--num_workers </span><span><span leaf="">10</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">--mask_dropouts</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#GRN-step3</span></span><span leaf=""><br></span><span leaf="">pyscenic aucell \</span><span leaf=""><br></span><span leaf="">input.loom \</span><span leaf=""><br></span><span leaf="">step2out_ctx.tsv \</span><span leaf=""><br></span><span leaf="">--output out_SCENIC.loom \</span><span leaf=""><br></span><span leaf="">--num_workers </span><span><span leaf="">10</span></span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.4 pyscenic下游分析</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(stringr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(SCopeLoomR)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(AUCell)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(SCENIC)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(dplyr)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(KernSmooth)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(RColorBrewer)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(plotly)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(BiocParallel)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(grid)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ComplexHeatmap)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(data.table)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(SCENIC)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(qs)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(BiocParallel)</span><span leaf=""><br></span><span leaf="">register(MulticoreParam(workers = </span><span><span leaf="">8</span></span><span leaf="">, progressbar = </span><span><span leaf="">TRUE</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">loom &lt;- open_loom(</span><span><span leaf="">"./10-pyscenic/out_SCENIC.loom"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce &lt;- qread(</span><span><span leaf="">"./9-CD4+T/sub_data_cd4+T.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">dir.create(</span><span><span leaf="">"./10-pyscenic"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">setwd(</span><span><span leaf="">"./10-pyscenic"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.5 数据预处理</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">regulons_incidMat &lt;- get_regulons(loom, column.attr.name=</span><span><span leaf="">"Regulons"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">regulons_incidMat[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">] </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 将regulons_incidMat转换成一个含有不同regulon的列表</span></span><span leaf=""><br></span><span leaf="">regulons &lt;- regulonsToGeneLists(regulons_incidMat) </span><span leaf=""><br></span><span leaf="">class(regulons)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 在loom文件中提取名称为RegulonsAUC的信息</span></span><span leaf=""><br></span><span leaf="">regulonAUC &lt;- get_regulons_AUC(loom,column.attr.name=</span><span><span leaf="">'RegulonsAUC'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(regulonAUC)[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 提取regulon的阈值</span></span><span leaf=""><br></span><span leaf="">regulonAucThresholds &lt;- get_regulon_thresholds(loom)</span><span leaf=""><br></span><span leaf="">tail(regulonAucThresholds[order(as.numeric(names(regulonAucThresholds)))])</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 提取loom文件的嵌入信息(事实上按照之前的pyscenic分析时没有坐标信息的)</span></span><span leaf=""><br></span><span leaf="">embeddings &lt;- get_embeddings(loom)</span><span leaf=""><br></span><span leaf="">embeddings</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">close_loom(loom)</span><span leaf=""><br></span><span leaf="">rownames(regulonAUC)</span><span leaf=""><br></span><span leaf="">names(regulons)</span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.6 导入seurat对象和加载的regulon信息进行匹配应对</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 取交集</span></span><span leaf=""><br></span><span leaf="">sub_regulonAUC &lt;- regulonAUC[,match(colnames(sce),colnames(regulonAUC))]</span><span leaf=""><br></span><span leaf="">dim(sub_regulonAUC)</span><span leaf=""><br></span><span leaf="">sce </span><span leaf=""><br></span><span><span leaf="">#确认是否一致</span></span><span leaf=""><br></span><span leaf="">identical(colnames(sub_regulonAUC), colnames(sce))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 构建细胞类型注释信息</span></span><span leaf=""><br></span><span leaf="">cellTypes &lt;- data.frame(row.names = colnames(sce), </span><span leaf=""><br></span><span leaf="">                        celltype = sce$RNA_snn_res.2)</span><span leaf=""><br></span><span leaf="">head(cellTypes)</span><span leaf=""><br></span><span leaf="">sub_regulonAUC[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">] </span><span leaf=""><br></span><span leaf="">save(sub_regulonAUC,</span><span leaf=""><br></span><span leaf="">     cellTypes,</span><span leaf=""><br></span><span leaf="">     sce,</span><span leaf=""><br></span><span leaf="">     file = </span><span><span leaf="">'for_rss_and_visual.Rdata'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">table(sce$RNA_snn_res.2)</span><span leaf=""><br></span><span><span leaf=""># 根据自己需要的信息进行划分</span></span><span leaf=""><br></span><span leaf="">selectedResolution &lt;- </span><span><span leaf="">"celltype"</span></span><span leaf=""><br></span><span leaf="">cellsPerGroup &lt;- split(rownames(cellTypes),cellTypes[,selectedResolution]) </span><span leaf=""><br></span><span><span leaf=""># 保留唯一/非重复的 regulon</span></span><span leaf=""><br></span><span leaf="">sub_regulonAUC &lt;- sub_regulonAUC[onlyNonDuplicatedExtended(rownames(sub_regulonAUC)),] </span><span leaf=""><br></span><span leaf="">dim(sub_regulonAUC)</span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.7 scenic自带的方式-计算regulon特异性分数(RSS)</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># regulon特异性分数(Regulon Specificity Score, RSS)</span></span><span leaf=""><br></span><span leaf="">selectedResolution &lt;- </span><span><span leaf="">"celltype"</span></span><span leaf=""><br></span><span leaf="">rss &lt;- calcRSS(AUC=getAUC(sub_regulonAUC), </span><span leaf=""><br></span><span leaf="">               cellAnnotation=cellTypes[colnames(sub_regulonAUC),selectedResolution]) </span><span leaf=""><br></span><span leaf="">rss=na.omit(rss) </span><span leaf=""><br></span><span><span leaf=""># 可以进行排序</span></span><span leaf=""><br></span><span leaf="">rss &lt;- rss[,c(</span><span><span leaf="">"0"</span></span><span leaf="">,</span><span><span leaf="">"1"</span></span><span leaf="">,</span><span><span leaf="">"2"</span></span><span leaf="">,</span><span><span leaf="">"3"</span></span><span leaf="">,</span><span><span leaf="">"4"</span></span><span leaf="">,</span><span><span leaf="">"5"</span></span><span leaf="">,</span><span><span leaf="">"6"</span></span><span leaf="">,</span><span><span leaf="">"7"</span></span><span leaf="">,</span><span><span leaf="">"8"</span></span><span leaf="">,</span><span><span leaf="">"9"</span></span><span leaf="">,</span><span><span leaf="">"10"</span></span><span leaf="">,</span><span><span leaf="">"11"</span></span><span leaf="">,</span><span><span leaf="">"12"</span></span><span leaf="">,</span><span><span leaf="">"13"</span></span><span leaf="">,</span><span><span leaf="">"14"</span></span><span leaf="">,</span><span><span leaf="">"15"</span></span><span leaf="">,</span><span><span leaf="">"16"</span></span><span leaf="">,</span><span><span leaf="">"17"</span></span><span leaf="">,</span><span><span leaf="">"18"</span></span><span leaf="">)]</span><span leaf=""><br></span><span leaf="">rssPlot &lt;- plotRSS(rss,</span><span leaf=""><br></span><span leaf="">  labelsToDiscard = </span><span><span leaf="">NULL</span></span><span leaf="">, </span><span><span leaf=""># 指定需要在热图中排除的行或列标签</span></span><span leaf=""><br></span><span leaf="">  zThreshold = </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf=""># 设定调控子的阈值，默认1</span></span><span leaf=""><br></span><span leaf="">  cluster_columns = </span><span><span leaf="">FALSE</span></span><span leaf="">, </span><span><span leaf=""># 是否对列进行聚类</span></span><span leaf=""><br></span><span leaf="">  order_rows = </span><span><span leaf="">T</span></span><span leaf="">, </span><span><span leaf=""># 是否对行进行排序</span></span><span leaf=""><br></span><span leaf="">  thr = </span><span><span leaf="">0.1</span></span><span leaf="">, </span><span><span leaf=""># 阈值参数，用于过滤 RSS 值。默认0.01</span></span><span leaf=""><br></span><span leaf="">  varName = </span><span><span leaf="">"cellType"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  col.low = </span><span><span leaf="">'#330066'</span></span><span leaf="">,  </span><span leaf=""><br></span><span leaf="">  col.mid = </span><span><span leaf="">'#66CC66'</span></span><span leaf="">,  </span><span leaf=""><br></span><span leaf="">  col.high= </span><span><span leaf="">'#FFCC33'</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  revCol = </span><span><span leaf="">F</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  verbose = </span><span><span leaf="">TRUE</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">rssPlot</span><span leaf=""><br></span><span leaf="">p &lt;- plotly::ggplotly(rssPlot$plot)</span><span leaf=""><br></span><span leaf="">p &lt;- p %&gt;%</span><span leaf=""><br></span><span leaf="">  layout(</span><span leaf=""><br></span><span leaf="">    title = </span><span><span leaf="">"RSS Plot"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    xaxis = list(title = </span><span><span leaf="">"Celltypes"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">    yaxis = list(title = </span><span><span leaf="">"Regulons"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">  )</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyicbRoiactosjibN7q6rJGMXB6698sxsSdW66iajOEk8cvSrFD8tzFTDHSA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0373692077727952" data-type="png" data-w="669" data-imgfileid="100045221" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyicbRoiactosjibN7q6rJGMXB6698sxsSdW66iajOEk8cvSrFD8tzFTDHSA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.8 计算TFs平均活性</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 计算每个细胞组中各调控子(regulon)的平均活性，并将这些平均活性值存储在一个矩阵中</span></span><span leaf=""><br></span><span><span leaf=""># cellsPerGroup这里得到是不同细胞群中的样本列表</span></span><span leaf=""><br></span><span><span leaf=""># function(x)rowMeans(getAUC(sub_regulonAUC)[,x])可以计算每个细胞群的regulon平均AUC值</span></span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup &lt;- sapply(cellsPerGroup,</span><span leaf=""><br></span><span leaf="">                                  </span><span><span leaf="">function</span></span><span leaf="">(x) </span><span leaf=""><br></span><span leaf="">                                  rowMeans(getAUC(sub_regulonAUC)[,x]))</span><span leaf=""><br></span><span leaf="">range(regulonActivity_byGroup)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 过滤</span></span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup_filtered &lt;- regulonActivity_byGroup[apply(regulonActivity_byGroup, </span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">function</span></span><span leaf="">(row) all(row &gt;= </span><span><span leaf="">0.05</span></span><span leaf="">)), ]</span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup &lt;- regulonActivity_byGroup_filtered</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 对结果进行归一化</span></span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup_Scaled &lt;- t(scale(t(regulonActivity_byGroup),</span><span leaf=""><br></span><span leaf="">                                          center = </span><span><span leaf="">T</span></span><span leaf="">, scale=</span><span><span leaf="">T</span></span><span leaf="">)) </span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 同一个regulon在不同cluster的scale处理</span></span><span leaf=""><br></span><span leaf="">dim(regulonActivity_byGroup_Scaled)</span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup_Scaled=regulonActivity_byGroup_Scaled[]</span><span leaf=""><br></span><span leaf="">regulonActivity_byGroup_Scaled=na.omit(regulonActivity_byGroup_Scaled)</span><span leaf=""><br></span></code></pre><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.9 可视化-展示转录因子平均活性(全部)</span></span><span></span></h6><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(ComplexHeatmap)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(circlize)</span><span leaf=""><br></span><span leaf="">Heatmap(</span><span leaf=""><br></span><span leaf="">  regulonActivity_byGroup_Scaled,</span><span leaf=""><br></span><span leaf="">  name                         = </span><span><span leaf="">"z-score"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  col                          = colorRamp2(seq(from=-</span><span><span leaf="">2</span></span><span leaf="">,to=</span><span><span leaf="">2</span></span><span leaf="">,length=</span><span><span leaf="">11</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                                            rev(brewer.pal(</span><span><span leaf="">11</span></span><span leaf="">, </span><span><span leaf="">"Spectral"</span></span><span leaf="">))),</span><span leaf=""><br></span><span leaf="">  show_row_names               = </span><span><span leaf="">TRUE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  show_column_names            = </span><span><span leaf="">TRUE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  row_names_gp                 = gpar(fontsize = </span><span><span leaf="">12</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  clustering_method_rows = </span><span><span leaf="">"ward.D2"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  clustering_method_columns = </span><span><span leaf="">"ward.D2"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  row_title_rot                = </span><span><span leaf="">0</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  cluster_rows                 = </span><span><span leaf="">TRUE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  cluster_row_slices           = </span><span><span leaf="">FALSE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  cluster_columns              = </span><span><span leaf="">FALSE</span></span><span leaf=""><br></span><span leaf="">  )</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyrHEZtkicmGqHN5CIz4w16gQibtzMy2ldvunzgTaPAxdPdOOrJibicibDyhA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1659192825112108" data-type="png" data-w="669" data-imgfileid="100045220" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyrHEZtkicmGqHN5CIz4w16gQibtzMy2ldvunzgTaPAxdPdOOrJibicibDyhA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.10 基于平均活性</span></span><span></span></h6><p data-tool="mdnice编辑器"><span leaf="">这种方式是采用了将得到的scaled Data进行不同组别的差异分析</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(dplyr) </span><span leaf=""><br></span><span leaf="">rss=regulonActivity_byGroup_Scaled</span><span leaf=""><br></span><span leaf="">head(rss)</span><span leaf=""><br></span><span leaf="">df = do.call(rbind,</span><span leaf=""><br></span><span leaf="">             lapply(</span><span><span leaf="">1</span></span><span leaf="">:ncol(rss), </span><span><span leaf="">function</span></span><span leaf="">(i){</span><span leaf=""><br></span><span leaf="">               dat= data.frame(</span><span leaf=""><br></span><span leaf="">                 path  = rownames(rss), </span><span><span leaf=""># 当前regulon的名称</span></span><span leaf=""><br></span><span leaf="">                 cluster = colnames(rss)[i], </span><span><span leaf=""># 当前cluster的名称</span></span><span leaf=""><br></span><span leaf="">                 sd.1 = rss[,i], </span><span><span leaf=""># 当前cluster中每个调控因子的值</span></span><span leaf=""><br></span><span leaf="">                 sd.2 = apply(rss[,-i, drop = </span><span><span leaf="">FALSE</span></span><span leaf="">], </span><span><span leaf="">1</span></span><span leaf="">, median) </span><span><span leaf="">#除了当前cluster之外的所有cluster 中该调控因子的中位值</span></span><span leaf=""><br></span><span leaf="">               )</span><span leaf=""><br></span><span leaf="">             }))</span><span leaf=""><br></span><span leaf="">df$fc = df$sd.1 - df$sd.2</span><span leaf=""><br></span><span leaf="">top5 &lt;- df %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(cluster) %&gt;% </span><span leaf=""><br></span><span leaf="">  top_n(</span><span><span leaf="">5</span></span><span leaf="">, fc)</span><span leaf=""><br></span><span leaf="">rowcn = data.frame(path = top5$cluster) </span><span leaf=""><br></span><span leaf="">n = rss[top5$path,] </span><span leaf=""><br></span><span leaf="">rownames(rowcn) = rownames(n)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">breaksList = seq(-</span><span><span leaf="">1.5</span></span><span leaf="">, </span><span><span leaf="">1.5</span></span><span leaf="">, by = </span><span><span leaf="">0.1</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colors &lt;- colorRampPalette(c(</span><span><span leaf="">"#336699"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"tomato"</span></span><span leaf="">))(length(breaksList))</span><span leaf=""><br></span><span leaf="">pdf(</span><span><span leaf="">"TFs_output.pdf"</span></span><span leaf="">, width = </span><span><span leaf="">6</span></span><span leaf="">, height = </span><span><span leaf="">30</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">pheatmap(n,</span><span leaf=""><br></span><span leaf="">         annotation_row = rowcn,</span><span leaf=""><br></span><span leaf="">         color = colors,</span><span leaf=""><br></span><span leaf="">         cluster_rows = </span><span><span leaf="">F</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         cluster_cols = </span><span><span leaf="">FALSE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         show_rownames = </span><span><span leaf="">T</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         </span><span><span leaf="">#gaps_col = cumsum(table(annCol$Type)),  # 使用排序后的列分割点</span></span><span leaf=""><br></span><span leaf="">         </span><span><span leaf="">#gaps_row = cumsum(table(annRow$Methods)), # 行分割</span></span><span leaf=""><br></span><span leaf="">         fontsize_row = </span><span><span leaf="">12</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         fontsize_col = </span><span><span leaf="">12</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         annotation_names_row = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">dev.off()</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyKoPybgT8hGVSU1iafwicQ6GrbqaxrAYES2kHw8OWv8NPiavNl6rkxg0CQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="5.063291139240507" data-type="png" data-w="316" data-imgfileid="100045219" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyKoPybgT8hGVSU1iafwicQ6GrbqaxrAYES2kHw8OWv8NPiavNl6rkxg0CQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">综合三次转录因子活性分析结果来对细胞簇进行分类判定（也可仅选定一种），首先需明确不同细胞亚群中已知的关键转录因子：</span></p><ol><li><section><span leaf="">Naive CD4+T 的特征性转录因子包括：Lck、ZAP70、LKLF(KLF2)等</span></section></li><li><section><span leaf="">Th1细胞的特征性转录因子包括：Tbet(TBX21)、STAT1、STAT4等</span></section></li><li><section><span leaf="">Th2细胞的特征性转录因子包括：GATA3、BATF、IRF4、STAT6等</span></section></li><li><section><span leaf="">Th17细胞的特征性转录因子包括：RORγt(RORC)、AHR、BATF、c-MAF(CMIP)、IκBζ、IRF4、RORα等</span></section></li><li><section><span leaf="">Tfh细胞的特征性转录因子包括：BATF、BCL6、c-MAF、IRF4、STAT3等</span></section></li><li><section><span leaf="">Treg细胞的特征性转录因子包括：FOXP3、STAT5、Helios(IKZF2)等</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">接下来用Treg细胞作为例子，既往在按照生物学背景分析时第3,6,10,13,16,18簇被认为可能为Treg细胞。Treg 细胞中最重要的转录因子是 Foxp3，此外，还有多个辅助和谱系特异性转录因子共同维持其调节性表型，包括 AHR、BACH2、BCL-11B、IKAROS、IRF4、BLIMP1、BATF、NFIL3、T-bet、GATA3、RORγt 和 BCL-6等 (PMID：37336954)。综合三次转录因子活性分析的结果其中第3、6、13、16是Treg细胞的可能性最大，均含有较高的FOXP3+。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyT3S40q9XoD7gEl3c5SCx6IKt9mk8h4PQS1a87oYQdNNcD1XjryjOaw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4940021810250818" data-type="png" data-w="917" data-imgfileid="100045217" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyT3S40q9XoD7gEl3c5SCx6IKt9mk8h4PQS1a87oYQdNNcD1XjryjOaw/640?wx_fmt=png&amp;from=appmsg"></span></p><h6 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.11基于特定转录因子绘图</span></span><span></span></h6><p data-tool="mdnice编辑器"><span leaf="">此外还可以针对FOXP3/STAT5A/IKZF2进行绘图</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(SummarizedExperiment)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(patchwork)</span><span leaf=""><br></span><span leaf="">seurat.data &lt;- sce</span><span leaf=""><br></span><span leaf="">sce$RNA_snn_res.2</span><span leaf=""><br></span><span leaf="">Idents(seurat.data) &lt;- </span><span><span leaf="">"RNA_snn_res.2"</span></span><span leaf=""><br></span><span leaf="">regulonsToPlot = c(</span><span><span leaf="">"FOXP3(+)"</span></span><span leaf="">,</span><span><span leaf="">"STAT5A(+)"</span></span><span leaf="">,</span><span><span leaf="">"IKZF2(+)"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">regulonsToPlot %</span><span><span leaf="">in</span></span><span leaf="">% row.names(sub_regulonAUC)</span><span leaf=""><br></span><span leaf="">seurat.data@meta.data = cbind(seurat.data@meta.data ,</span><span leaf=""><br></span><span leaf="">                              t(assay(sub_regulonAUC[regulonsToPlot,])))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># Vis</span></span><span leaf=""><br></span><span leaf="">p1 = DotPlot(seurat.data, features = unique(regulonsToPlot)) + RotatedAxis()</span><span leaf=""><br></span><span leaf="">p2 = RidgePlot(seurat.data, features = regulonsToPlot , ncol = </span><span><span leaf="">2</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">p3 = VlnPlot(seurat.data, features = regulonsToPlot,pt.size = </span><span><span leaf="">0</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p4 = FeaturePlot(seurat.data,features = regulonsToPlot)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">wrap_plots(p1,p2,p3,p4)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">从结果来看进一步证实了第3，6，13，16簇是Treg细胞的可能性最大（热图和特定转录因子绘图综合判断）。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyNNDSp0EC3SoYrzPPa1OlkatqAOeKTkK9b0iaWHric39bnic0vzG5fEqibQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.48518518518518516" data-type="png" data-w="1080" data-imgfileid="100045227" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyNNDSp0EC3SoYrzPPa1OlkatqAOeKTkK9b0iaWHric39bnic0vzG5fEqibQ/640?wx_fmt=png&amp;from=appmsg">接下来，按照同样的流程判断其他细胞簇的转录因子情况并同步比对cosg差异分析的结果（结果来源于上一篇推文内容）。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyHrVtfGE1coJGWlXDLYdwia0Hs46zFeuysP7OTQh2hjYbAYgQhYYcMicA/640?wx_fmt=png&amp;from=appmsg" data-ratio="2.2132867132867133" data-type="png" data-w="286" data-imgfileid="100045224" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyHrVtfGE1coJGWlXDLYdwia0Hs46zFeuysP7OTQh2hjYbAYgQhYYcMicA/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf="">综合以上所有结果：</span></p><ol><li><section><span leaf="">第0簇可能属于Th17细胞，因其高表达IL22和 IL17A。</span></section></li><li><section><span leaf="">第1、2 簇可能为Th1细胞，因其特征性标志物包括TBX21(+)。</span></section></li><li><section><span leaf="">第4、5、11簇可能为记忆性T细胞，因其表达ANXA1、GIMAP4、LEF1、TCF7。</span></section></li><li><section><span leaf="">第7-9、12、18簇可能为Naïve CD4⁺ T细胞，因其标志物为CCR7、SELL。</span></section></li><li><section><span leaf="">第10簇可归类为Treg细胞，因为其高表达FOXP3、CTLA4、IKZF2。</span></section></li><li><section><span leaf="">第14簇缺乏特异性转录因子和标志物，但ZSCAN12 表达较高，因此命名为ZSCAN12⁺T细胞。</span></section></li><li><section><span leaf="">第15簇也缺乏明显特异的转录因子和标志物，其中 ELK4 表达较高，因此命名为ELK4⁺T细胞。</span></section></li><li><section><span leaf="">第17簇同样没有显著特异的转录因子和标志物，但 ZNF793表达较高，因此命名为ZNF793⁺T细胞。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.细胞注释</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#####细胞生物学命名</span></span><span leaf=""><br></span><span leaf="">celltype &lt;- data.frame(</span><span leaf=""><br></span><span leaf="">  ClusterID = c(</span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">18</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  celltype = c(</span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">18</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 这里强烈依赖于生物学背景，看dotplot的基因表达量情况来人工审查单细胞亚群名字</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">7</span></span><span leaf="">:</span><span><span leaf="">9</span></span><span leaf="">,</span><span><span leaf="">12</span></span><span leaf="">,</span><span><span leaf="">18</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'Naive T'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">2</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'Th1'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">0</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'Th17'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">5</span></span><span leaf="">,</span><span><span leaf="">11</span></span><span leaf="">),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'Tm'</span></span><span><span leaf=""># 记忆性</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">3</span></span><span leaf="">,</span><span><span leaf="">6</span></span><span leaf="">,</span><span><span leaf="">10</span></span><span leaf="">,</span><span><span leaf="">13</span></span><span leaf="">,</span><span><span leaf="">16</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'Treg'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">14</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'ZSCAN12+T'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">15</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'ELK4+T'</span></span><span leaf=""><br></span><span leaf="">celltype[celltype$ClusterID %</span><span><span leaf="">in</span></span><span leaf="">% c(</span><span><span leaf="">17</span></span><span leaf=""> ),</span><span><span leaf="">2</span></span><span leaf="">]=</span><span><span leaf="">'ZNF793+T'</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sub_data &lt;- sce</span><span leaf=""><br></span><span leaf="">table(celltype$celltype)</span><span leaf=""><br></span><span leaf="">table(sub_data@meta.data$RNA_snn_res.2)</span><span leaf=""><br></span><span leaf="">table(celltype$celltype)</span><span leaf=""><br></span><span><span leaf=""># ELK4+T   Naive T       Th1      Th17        Tm      Treg  ZNF793+T ZSCAN12+T </span></span><span leaf=""><br></span><span><span leaf="">#    204      1459       818       421      1045      1528       189       248 </span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sub_data@meta.data$celltype = </span><span><span leaf="">"NA"</span></span><span leaf=""><br></span><span><span leaf=""># 记得修改RNA_snn_res.0.6</span></span><span leaf=""><br></span><span><span leaf="">for</span></span><span leaf="">(i </span><span><span leaf="">in</span></span><span><span leaf="">1</span></span><span leaf="">:nrow(celltype)){</span><span leaf=""><br></span><span leaf="">  sub_data@meta.data[which(sub_data@meta.data$RNA_snn_res.2 == celltype$ClusterID[i]),</span><span><span leaf="">'celltype'</span></span><span leaf="">] &lt;- celltype$celltype[i]}</span><span leaf=""><br></span><span leaf="">table(sub_data@meta.data$celltype)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># umap/tsne</span></span><span leaf=""><br></span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">'~/Desktop/practiceGSE188711/scRNA_scripts/Bottom_left_axis.R'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">result &lt;- left_axes(sub_data)</span><span leaf=""><br></span><span leaf="">axes &lt;- result$axes</span><span leaf=""><br></span><span leaf="">label &lt;- result$label</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">th=theme(axis.text.x = element_text(angle = </span><span><span leaf="">45</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                                    vjust = </span><span><span leaf="">0.5</span></span><span leaf="">, hjust=</span><span><span leaf="">0.5</span></span><span leaf="">))</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(patchwork)</span><span leaf=""><br></span><span leaf="">celltype =DimPlot(sub_data, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">,cols = my36colors,pt.size = </span><span><span leaf="">0.8</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                       group.by = </span><span><span leaf="">"celltype"</span></span><span leaf="">,label = </span><span><span leaf="">F</span></span><span leaf="">,label.box = </span><span><span leaf="">F</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  NoAxes() +</span><span leaf=""><br></span><span leaf="">  theme(aspect.ratio = </span><span><span leaf="">1</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  geom_line(data = axes,</span><span leaf=""><br></span><span leaf="">            aes(x = x,y = y,group = group),</span><span leaf=""><br></span><span leaf="">            arrow = arrow(length = unit(</span><span><span leaf="">0.1</span></span><span leaf="">, </span><span><span leaf="">"inches"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                          ends=</span><span><span leaf="">"last"</span></span><span leaf="">, type=</span><span><span leaf="">"closed"</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  geom_text(data = label,</span><span leaf=""><br></span><span leaf="">            aes(x = x,y = y,angle = angle,label = lab),fontface = </span><span><span leaf="">'italic'</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  theme(plot.title = element_blank())</span><span leaf=""><br></span><span leaf="">celltype</span><span leaf=""><br></span><span leaf="">ggsave(</span><span><span leaf="">'umap_sub.pdf'</span></span><span leaf="">,width = </span><span><span leaf="">9</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">以下就是最终以及原文中的分群结果(原文中把Treg细胞去除了)。<img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyUWjvKTHNTmkWxqwPrw6sDlq2KzPBZMMROk0HLufzic1PH3kdaxD4kcg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.26944444444444443" data-type="png" data-w="1080" data-imgfileid="100045226" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjS8lUaic6ia6umTibnJmfRUlpyUWjvKTHNTmkWxqwPrw6sDlq2KzPBZMMROk0HLufzic1PH3kdaxD4kcg/640?wx_fmt=png&amp;from=appmsg">本次分析完成了CD4⁺ T 细胞亚群注释的实践流程。事实上，在分析之前，笔者已预料到结果可能与最终结论存在较大差异，这种差异不仅源于分析技术上的细微差别，更与对CD4⁺ T 细胞的整体认知相关。尽管本次分群结果未必是最优方案，但笔者认为至少不能算是错误，整个流程仍具备实操学习的价值。此外，如果针对肿瘤细胞进行注释，可能还需要增加富集分析，以提高注释的准确性和生物学解释的深度。</span></p><p data-tool="mdnice编辑器"><span leaf="">参考资料</span></p><ol><li><section><span leaf="">CD4+ T cells in cancer; Nat Cancer. 2023 Mar;4(3):317-329</span></section></li><li><section><span leaf="">OMIP-030: Characterization of human T cell subsets via surface markers. Cytometry A. 2015 Dec;87(12):1067-9.</span></section></li><li><section><span leaf="">Tumour heterogeneity and intercellular networks of nasopharyngeal carcinoma at single cell resolution. Nat Commun. 2021 Feb 2;12(1):741.</span></section></li><li><section><span leaf="">Liver tumour immune microenvironment subtypes and neutrophil heterogeneity. Nature. 2022 Dec;612(7938):141-147.</span></section></li><li><section><span leaf="">Immune phenotypic linkage between colorectal cancer and liver metastasis. Cancer Cell. 2022 Apr 11;40(4):424-437.e5.</span></section></li><li><section><span leaf="">Transcriptional and epigenetic basis of Treg cell development and function: its genetic anomalies or variations in autoimmune diseases. Cell Res. 2020 Jun;30(6):465-474.</span></section></li><li><section><span leaf="">The role of transcription factors in shaping regulatory T cell identity. Nat Rev Immunol. 2023 Dec;23(12):842-856.</span></section></li><li><section><span leaf="">生信技能树：https://mp.weixin.qq.com/s/cehCf99Z4pA5n_o63NmXGg https://mp.weixin.qq.com/s/JU1g7VOHekzv7XmncCZ62g https://mp.weixin.qq.com/s/AehBIahuY9Fy_sQcShx-Eg</span></section></li><li><section><span leaf="">生信方舟：https://mp.weixin.qq.com/s/sL_8YFulHsZ42L8G5DyY8w https://mp.weixin.qq.com/s/Y6Z3tjGVj-7unTirRak5tA</span></section></li><li><section><span leaf="">芒果师兄：https://mp.weixin.qq.com/s/muXTFCp0oqSFDcuUc4mItA</span></section></li><li><section><span leaf="">生信人：https://mp.weixin.qq.com/s/kk1YkbdbPi8VGgYXGzPhUw</span></section></li><li><section><span leaf="">赛默飞-中国官网：免疫学工作资源中心界面</span></section></li><li><section><span leaf="">流式中文网：https://www.sohu.com/a/219918954_610701</span></section></li></ol><p data-tool="mdnice编辑器"><strong><span leaf="">致谢</span></strong><span leaf="">：感谢曾老师以及生信技能树团队全体成员。更多精彩内容可关注公众号：</span><strong><span leaf="">生信技能树，单细胞天地，生信菜鸟团</span></strong><span leaf="">等公众号。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">注</span></strong><span leaf="">：若对内容有疑惑或者有发现明确错误的朋友，请联系后台(欢迎交流)。</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/zv4zzFPwN9c3tWeNDgvIAw",target="_blank" rel="noopener noreferrer">原文链接</a>
