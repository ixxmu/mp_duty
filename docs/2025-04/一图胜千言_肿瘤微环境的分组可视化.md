---
title: "一图胜千言：肿瘤微环境的分组可视化"
date: 2025-04-02T02:17:48Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
一图胜千言：肿瘤微环境的分组可视化 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">最近在复现并尝试美化一下</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528360&amp;idx=1&amp;sn=b48abad2bb106d98103efd7dfb226e6c&amp;scene=21#wechat_redirect"><span leaf="">单细胞测序揭示EGFR突变如何改变肺腺癌的免疫微环境</span></a><span leaf="">的Figure1</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkniaoPQORFtotwoPN0OpQf7B12ZUWrf96NNicPcsibic1wKDLqXtULyicvfg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8009259259259259" data-type="png" data-w="1080" data-imgfileid="100045169" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkniaoPQORFtotwoPN0OpQf7B12ZUWrf96NNicPcsibic1wKDLqXtULyicvfg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">在直播分享</span><a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247492935&amp;idx=1&amp;sn=9de78126434c1c1f4b616320f141b19a&amp;scene=21#wechat_redirect"><span leaf="">GSE171145-EGFR突变与否肺腺癌数据集</span></a><span leaf="">的时候，已经复现了Figure1B</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045166" data-ratio="0.6731481481481482" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk7DW6bUA9csX4iaiaCgbQrfqRdKgTlTAOqnmnjq6A2LbbBSSwdI1JZI2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk7DW6bUA9csX4iaiaCgbQrfqRdKgTlTAOqnmnjq6A2LbbBSSwdI1JZI2w/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">也陆续从Figure1C开始——</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528528&amp;idx=1&amp;sn=b37ceade12284b35e01d8969a932fd60&amp;scene=21#wechat_redirect"><span leaf="">Umap图可视化细胞类型比例差异</span></a><span leaf="">，尝试复现并基于自己的理解去尝试使用不同的方式去美化一下结果。</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045165" data-ratio="1.0415800415800416" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFknly0MDp7J2ViasDvKVEu3N2pibmEbWnib6JmziaRTic9qG5PkPqB00x7rZA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="481" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFknly0MDp7J2ViasDvKVEu3N2pibmEbWnib6JmziaRTic9qG5PkPqB00x7rZA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">今天一起来看看Figure1的最后一张图，</span><strong><span leaf="">Figure1E——EGFR状态对细胞比例的影响，通过堆叠柱状图去可视化</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045167" data-ratio="0.6338672768878718" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk5sWWHrpKkpue4RkgZeZ2qL0Eo5eS91gIagbMTRUnDdyibBlkrlwCL6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="874" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk5sWWHrpKkpue4RkgZeZ2qL0Eo5eS91gIagbMTRUnDdyibBlkrlwCL6Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">通过可视化结果发现：</span></strong></p><ul><li><section><span leaf="">T/NK细胞在两种EGFR状态的TME中均占主导地位，且比例相似。</span></section></li><li><section><span leaf="">EGFR突变型TME：单核细胞（Monocytic cells）、肥大细胞（Mast cells）和内皮细胞（Endothelial cells）的比例更高。</span></section></li><li><section><span leaf="">EGFR野生型TME：中性粒细胞（Neutrophils）和成纤维细胞（Fibroblasts）的比例更高</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">EGFR突变型和野生型LUAD的肿瘤微环境在细胞组成上存在显著差异，这些差异可能反映了两种状态下免疫微环境的功能差异，进而影响免疫治疗的反应。</span></strong></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">复现思路</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">首先我们</span><strong><span leaf="">需要拆分一下Figure1E，从图上可以看到可以六个部分，依次是：EGFR(+)的不同样品免疫/基质细胞比例、全部细胞占比；EGFR(-)的不同样品免疫/基质细胞比例、全部细胞占比；以及EGFR(+)/EGFR(-)免疫/基质细胞比例、全部细胞占比</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045168" data-ratio="0.6338672768878718" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk5sWWHrpKkpue4RkgZeZ2qL0Eo5eS91gIagbMTRUnDdyibBlkrlwCL6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="874" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk5sWWHrpKkpue4RkgZeZ2qL0Eo5eS91gIagbMTRUnDdyibBlkrlwCL6Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">所以数据整理及可视化可以按照如下步骤：</span></p><ol><li><section><span leaf="">按照EGFR分组提取需要的数据</span></section></li><li><section><span leaf="">按照是否包含上皮细胞，区分全部细胞及免疫/基质细胞</span></section></li><li><section><span leaf="">再分别按照六个部分去分组计算细胞比例及可视化</span></section></li><li><section><span leaf="">将所有的结果拼到一起进行展示</span></section></li></ol><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">加载需要的数据及R包</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">这里用到的是保存了注释信息以及分组信息的结果数据，具体的整理方式可以看</span><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247528528&amp;idx=1&amp;sn=b37ceade12284b35e01d8969a932fd60&amp;scene=21#wechat_redirect"><span leaf="">Umap图可视化细胞类型比例差异</span></a></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">'scRNA_scripts/lib.R'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce.all.int = readRDS(</span><span><span leaf="">'sce.celltype.rds'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045173" data-ratio="0.24814814814814815" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkhwt2yE0WPHdgvLA4ZNxNqUJhQcYDWRphFeG8mUJK0qgGPlFaIpsoLw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkhwt2yE0WPHdgvLA4ZNxNqUJhQcYDWRphFeG8mUJK0qgGPlFaIpsoLw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">根据EGFR+分群取子集并可视化</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">我们先来</span><strong><span leaf="">复现第一部分，也就是EGFR(+)分组可视化</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045174" data-ratio="0.33055555555555555" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkWh3gAiadnnck57Zt37QhiaJtQfzXjBcSYzud5kOtM6YBvpicxobg3wpcA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkWh3gAiadnnck57Zt37QhiaJtQfzXjBcSYzud5kOtM6YBvpicxobg3wpcA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">从图中可以看到有些小细节需要注意：</span></strong></p><ol><li><section><span leaf="">有对应的标题——Immune/stromal cell proportion、Total cell proportion</span></section></li><li><section><span leaf="">没有X轴的标签信息</span></section></li><li><section><span leaf="">保留Total cell proportion的图例信息，但是要注意统一配色</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">##根据EGFR+分群取子集----</span></span><span leaf=""><br></span><span leaf="">sce_EGFR1 &lt;- sce.all.int[,sce.all.int</span><span><span leaf="">$EGFR_status</span></span><span leaf="">==</span><span><span leaf="">'EGFR(+)'</span></span><span leaf="">]</span><span leaf=""><br></span><span><span leaf=""># 去除'epi'细胞亚群</span></span><span leaf=""><br></span><span leaf="">sce_EGFR1.1 &lt;- sce_EGFR1[,sce_EGFR1</span><span><span leaf="">$celltype</span></span><span leaf=""> != </span><span><span leaf="">'epi'</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">table(sce_EGFR1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(sce_EGFR1.1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#immune/stromal cell</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">tb=table(sce_EGFR1.1</span><span><span leaf="">$group</span></span><span leaf="">,sce_EGFR1.1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 假设bar_per是您的数据框，并且已经定义了col（颜色向量）</span></span><span leaf=""><br></span><span><span leaf=""># 这里使用ggplot来创建堆叠柱状图</span></span><span leaf=""><br></span><span leaf="">p1 &lt;- ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    axis.text.x = element_blank(), </span><span><span leaf=""># 去除x轴文本</span></span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank(), </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">    legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    plot.title = element_text(hjust = 0.5) </span><span><span leaf=""># 设置标题居中</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(title = </span><span><span leaf="">"Immune/stromal cell proportion"</span></span><span leaf="">, </span><span><span leaf=""># 设置主标题</span></span><span leaf=""><br></span><span leaf="">       x = </span><span><span leaf="">'Relative proportion'</span></span><span leaf="">, </span><span><span leaf=""># 设置x轴标题</span></span><span leaf=""><br></span><span leaf="">       fill = NULL) + </span><span><span leaf=""># 移除图例标题</span></span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col) ;p1</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#total cell</span></span><span leaf=""><br></span><span leaf="">tb=table(sce_EGFR1</span><span><span leaf="">$group</span></span><span leaf="">,sce_EGFR1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#DD76C5"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p2 = ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    axis.text.x = element_blank(), </span><span><span leaf=""># 去除x轴文本</span></span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank(), </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">    plot.title = element_text(hjust = 0.5) </span><span><span leaf=""># 设置标题居中</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(title = </span><span><span leaf="">"Total cell proportion"</span></span><span leaf="">, </span><span><span leaf=""># 设置主标题</span></span><span leaf=""><br></span><span leaf="">       x = </span><span><span leaf="">'Relative proportion (%)'</span></span><span leaf="">, </span><span><span leaf=""># 设置x轴标题</span></span><span leaf=""><br></span><span leaf="">       fill = NULL) + </span><span><span leaf=""># 移除图例标题</span></span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col);p2</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p1+p2</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045171" data-ratio="0.8236808236808236" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkKPrHK7GRIgKmsmjuQicTDUaSaSsqg7FTbohUNXYna9p03SgIXCxds2g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="777" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkKPrHK7GRIgKmsmjuQicTDUaSaSsqg7FTbohUNXYna9p03SgIXCxds2g/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">根据EGFR-分群取子集</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">接着就是图表的第二部分，EGFR(-)分组可视化</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045172" data-ratio="0.27055150884495316" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk2jUqMiaYdV2edyib98TRR1QqubEdMmQzVhCotmarEA3IS57belC4l59A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="961" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFk2jUqMiaYdV2edyib98TRR1QqubEdMmQzVhCotmarEA3IS57belC4l59A/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">需要注意的是，第二部分X轴有显示</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">##根据EGFR-分群取子集----</span></span><span leaf=""><br></span><span leaf="">sce_EGFR2 &lt;- sce.all.int[,sce.all.int</span><span><span leaf="">$EGFR_status</span></span><span leaf="">==</span><span><span leaf="">'EGFR(-)'</span></span><span leaf="">]</span><span leaf=""><br></span><span><span leaf=""># 去除'epi'细胞亚群</span></span><span leaf=""><br></span><span leaf="">sce_EGFR2.1 &lt;- sce_EGFR2[,sce_EGFR2</span><span><span leaf="">$celltype</span></span><span leaf=""> != </span><span><span leaf="">'epi'</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">table(sce_EGFR2</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(sce_EGFR2.1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">#immune/stromal cell</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">tb=table(sce_EGFR2.1</span><span><span leaf="">$group</span></span><span leaf="">,sce_EGFR2.1</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 假设bar_per是您的数据框，并且已经定义了col（颜色向量）</span></span><span leaf=""><br></span><span><span leaf=""># 这里使用ggplot来创建堆叠柱状图</span></span><span leaf=""><br></span><span leaf="">p3 &lt;- ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank() </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(y = </span><span><span leaf="">""</span></span><span leaf="">, fill = NULL) + </span><span><span leaf=""># 去除y轴标签和图例标题</span></span><span leaf=""><br></span><span leaf="">  labs(x = </span><span><span leaf="">'Relative proportion(%)'</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col);p3 </span><span><span leaf=""># 使用自定义颜色</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#total cell</span></span><span leaf=""><br></span><span leaf="">tb=table(sce_EGFR2</span><span><span leaf="">$group</span></span><span leaf="">,sce_EGFR2</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#DD76C5"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p4 = ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank() </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(y = </span><span><span leaf="">""</span></span><span leaf="">, fill = NULL) + </span><span><span leaf=""># 去除y轴标签和图例标题</span></span><span leaf=""><br></span><span leaf="">  labs(x = </span><span><span leaf="">'Relative proportion(%)'</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col);p4</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p3+p4</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045170" data-ratio="0.8388746803069054" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkNLMw7RJQsKfts7kyHPK7HrfDWII6dULezmhZpdjMYXuYic4VvWh8Dyw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="782" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkNLMw7RJQsKfts7kyHPK7HrfDWII6dULezmhZpdjMYXuYic4VvWh8Dyw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">然后将这两个部分先拼接到一起，再与最后一部分内容合并</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">##全部拼图</span></span><span leaf=""><br></span><span leaf="">p &lt;- (p1+p2) / (p3+p4)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045177" data-ratio="0.8480204342273308" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkwBMicLCKj68icKCj4biacKrvGT7ELOEMaKDGNhDxPzO1yiaM9w4stWow2Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="783" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkwBMicLCKj68icKCj4biacKrvGT7ELOEMaKDGNhDxPzO1yiaM9w4stWow2Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">按照分组绘制堆叠柱状图</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">前两部分，是基于EGFR分组提取了需要的数据之后，按照样品信息进行的可视化，最后一部分内容就直接基于EGFR的分组，展示了免疫/基质以及全部细胞占比的情况</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045176" data-ratio="0.21773399014778325" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkqYsTEn5ydlecc3QaLuofQ7CMt1aeF5Rwjqd2dBfp85PmA9VibvYDrTQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1015" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkqYsTEn5ydlecc3QaLuofQ7CMt1aeF5Rwjqd2dBfp85PmA9VibvYDrTQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">##按照分组绘制堆叠柱状图----</span></span><span leaf=""><br></span><span><span leaf=""># 去除'epi'细胞亚群</span></span><span leaf=""><br></span><span leaf="">sce_EGFR &lt;- sce.all.int[,sce.all.int</span><span><span leaf="">$celltype</span></span><span leaf=""> != </span><span><span leaf="">'epi'</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">table(sce.all.int</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(sce_EGFR</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">#immune/stromal cell</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">tb=table(sce_EGFR</span><span><span leaf="">$EGFR_status</span></span><span leaf="">,sce_EGFR</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 假设bar_per是您的数据框，并且已经定义了col（颜色向量）</span></span><span leaf=""><br></span><span><span leaf=""># 这里使用ggplot来创建堆叠柱状图</span></span><span leaf=""><br></span><span leaf="">p5 &lt;- ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank() </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(y = </span><span><span leaf="">""</span></span><span leaf="">, fill = NULL) + </span><span><span leaf=""># 去除y轴标签和图例标题</span></span><span leaf=""><br></span><span leaf="">  labs(x = </span><span><span leaf="">'Relative proportion(%)'</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col);p5 </span><span><span leaf=""># 使用自定义颜色</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">#total cell</span></span><span leaf=""><br></span><span leaf="">tb=table(sce.all.int</span><span><span leaf="">$EGFR_status</span></span><span leaf="">,sce.all.int</span><span><span leaf="">$celltype</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_data &lt;- as.data.frame(tb)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">bar_per &lt;- bar_data %&gt;% </span><span leaf=""><br></span><span leaf="">  group_by(Var1) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(sum(Freq)) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(percent = Freq / `sum(Freq)`)</span><span leaf=""><br></span><span leaf="">head(bar_per) </span><span leaf=""><br></span><span><span leaf="">#write.csv(bar_per,file = "celltype_by_group_percent.csv")</span></span><span leaf=""><br></span><span leaf="">col =c(</span><span><span leaf="">"#3176B7"</span></span><span leaf="">,</span><span><span leaf="">"#d85f4e"</span></span><span leaf="">,</span><span><span leaf="">"#3FA116"</span></span><span leaf="">,</span><span><span leaf="">"#DD76C5"</span></span><span leaf="">,</span><span><span leaf="">"#d8869d"</span></span><span leaf="">,</span><span><span leaf="">"#9265C1"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">       </span><span><span leaf="">"#689e46"</span></span><span leaf="">,</span><span><span leaf="">"#5a8ba9"</span></span><span leaf="">,</span><span><span leaf="">"#93c1b6"</span></span><span leaf="">,</span><span><span leaf="">"#885649"</span></span><span leaf="">,</span><span><span leaf="">"#41BED1"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(bar_per)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p6 = ggplot(bar_per, aes(y = percent, x = Var1)) +</span><span leaf=""><br></span><span leaf="">  geom_bar(aes(fill = Var2), </span><span><span leaf="">stat</span></span><span leaf=""> = </span><span><span leaf="">"identity"</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  coord_flip() + </span><span><span leaf=""># 翻转坐标轴，使条形图横向展示</span></span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.ticks = element_blank(), </span><span><span leaf=""># 去除坐标轴刻度</span></span><span leaf=""><br></span><span leaf="">    axis.title = element_blank(), </span><span><span leaf=""># 去除坐标轴标题</span></span><span leaf=""><br></span><span leaf="">    legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    panel.grid.major = element_blank(), </span><span><span leaf=""># 去除主网格线</span></span><span leaf=""><br></span><span leaf="">    panel.grid.minor = element_blank(), </span><span><span leaf=""># 去除次网格线</span></span><span leaf=""><br></span><span leaf="">    panel.background = element_blank(), </span><span><span leaf=""># 去除面板背景</span></span><span leaf=""><br></span><span leaf="">    plot.background = element_blank() </span><span><span leaf=""># 去除绘图背景</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  labs(y = </span><span><span leaf="">""</span></span><span leaf="">, fill = NULL) + </span><span><span leaf=""># 去除y轴标签和图例标题</span></span><span leaf=""><br></span><span leaf="">  labs(x = </span><span><span leaf="">'Relative proportion(%)'</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = col);p6</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">p7 &lt;- p5+p6</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045178" data-ratio="0.8403990024937655" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkbtq07eobQVoOmktuKJhg1icKz3wZJhOqdJk7TGEeH6ZBh4ZSibd0Sxuw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="802" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkbtq07eobQVoOmktuKJhg1icKz3wZJhOqdJk7TGEeH6ZBh4ZSibd0Sxuw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">全部图片拼接到一起</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">因为刚刚已经将拼接的内容都分别赋值给p和p7了，所以接下来就直接将两个图拼接到一起即可</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">p+p7</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045175" data-ratio="0.8549222797927462" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkhrWEVBkmOqtWyqfuibyibGOgNSiagniaXM55ZH7j3EdjKmfqPqxZFQnQYQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="772" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkhrWEVBkmOqtWyqfuibyibGOgNSiagniaXM55ZH7j3EdjKmfqPqxZFQnQYQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">文章中想要可视化免疫及基质细胞在肿瘤微环境中的占比情况，所以将其单独提取出来进行展示，并且和全部细胞比例可视化的结果做了对比</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100045179" data-ratio="0.3925925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkXegRKH3lTlulYUSa6drrLK3qST3Q6AYLhPLe1ibZXO2lgX3bYZWH4uA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQDzKFl68SpYk0ibfakn6pFkXegRKH3lTlulYUSa6drrLK3qST3Q6AYLhPLe1ibZXO2lgX3bYZWH4uA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">文末友情宣传</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">如果你也想做单细胞转录组数据分析，最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect"><span leaf="">满足你生信分析计算需求的低价解决方案</span></a><span leaf="">，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247538685&amp;idx=1&amp;sn=00de34b1fe5811f22dd67cbc45ff1625&amp;scene=21#wechat_redirect"><span leaf="">生物信息学马拉松授课</span></a><span leaf="">，你的生物信息学入门课。</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">2025年也会继续学习分享单细胞内容，并且组建了交流群——</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247536175&amp;idx=1&amp;sn=7391227554e6aed88bfc0dbcd8546e78&amp;scene=21#wechat_redirect"><span leaf="">承包你2025全部的单细胞转录组降维聚类分群</span></a><span leaf="">，欢迎一起讨论交流学习！</span></strong></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/otuF087pLxhrj5g0UzcbNw",target="_blank" rel="noopener noreferrer">原文链接</a>
