---
title: "CellChat细胞通讯运行内存及时间压力测试"
date: 2025-04-17T03:39:26Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
CellChat细胞通讯运行内存及时间压力测试 by Biomamba 生信基地
------
<div><section data-support="96编辑器" data-style-id="39922" data-pm-slice="0 0 []"><section><section><section><section><p><strong><span leaf="">一、写在前面</span></strong></p></section></section></section></section><section data-support="96编辑器" data-style-id="40285"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.42857142857142855" data-w="49" data-imgfileid="100040545" src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><p><span></span></p><p><span leaf="">总有小伙伴购买服务器(<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247526504&amp;idx=2&amp;sn=417d07347cebe0a1bd403f6c3e7d9b29&amp;scene=21#wechat_redirect" textvalue="足够支持你完成硕博生涯的生信环境" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a>)时不知道哪个版本的配置适合自己，这里我们对CellChat细胞通讯运行进行了内存和时间占用的压力测试。往期测试可见：<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAwMzIzOTk5OQ==&amp;action=getalbum&amp;album_id=3771935244480249861#wechat_redirect" textvalue="服务器压力测试" data-itemshowtype="undefined" target="_blank" linktype="text" data-linktype="2"><span textstyle="">服务器压力测试</span></a></span></p><p><span><span><span leaf=""><span textstyle="">我们最多测试了</span><span textstyle="">30w</span><span textstyle="">个细胞，占用内存峰值接近</span><span textstyle="">60GB</span><span textstyle="">，显然比</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528216&amp;idx=1&amp;sn=a12e276a7dac4df56d24b5a92dd78a24&amp;scene=21#wechat_redirect" textvalue="monocle" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">monocle</span></a><span textstyle="">占据的内存小的多，考虑到系统本身以及环境中的其它变量，推荐大家至少准备128GB内存为宜。若采取并行计算等操作，占据的内存数量会更多！</span></span></span></span></p><p><span><span><span leaf=""><br></span></span></span></p><p><span><span><span leaf=""><span textstyle="">本教程基于Linux中的Rstudio环境（</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247526504&amp;idx=2&amp;sn=417d07347cebe0a1bd403f6c3e7d9b29&amp;scene=21#wechat_redirect" textvalue="足够支持你完成硕博生涯的生信环境" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a><span textstyle="">）</span><span textstyle="">演示，计算资源不足的同学可参考：</span></span></span><span leaf=""><br></span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491007&amp;idx=1&amp;sn=8619c2bad23791b3252a1c4cb1831931&amp;chksm=9b3f64efac48edf9c02f84959aeee9b12480736fce70c5ddb8b41d79cfc22ce590ea2cb60fba&amp;token=1760636281&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">生信分析为什么要使用服务器？</span></a></span><span leaf=""><br></span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247511780&amp;idx=1&amp;sn=3acc0874f7d2fa75f1abbe7a9a9b4069&amp;chksm=9b3cd7b4ac4b5ea27d4d53964e4a4a9fa8c806a19103729dd4ff0fa72e621411f46a251d269f&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a></span><span leaf=""><br></span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247519707&amp;idx=1&amp;sn=73dcab26f9b2ed75a954327317d07112&amp;chksm=9b3cf48bac4b7d9df5b5a432fbe70d4f9c13bc8d739aa401732614f022223d1912642a7e4bea&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">配置一个心仪的工作站(硬件+环境配置)</span></a></span><span leaf=""><br></span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247503618&amp;idx=1&amp;sn=ca47ca985aa8560f6b38f15f210519e2&amp;chksm=9b3cb652ac4b3f44292560071b7e98e2f6fa6ec03581cd882a4d59b9d7fa063a5b9ac1b923f3&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">独享服务器，生信分析不求人</span></a></span><span leaf=""><br></span><span leaf=""><br></span></span></p><p><span><span leaf="">访问链接：</span></span><span><span leaf="">https://biomamba.xiyoucloud.net/</span></span></p><p><span><span><span leaf="">更多内容可咨询客服微信[</span></span><strong><span><span leaf="">Biomamba_yunying</span></span></strong><span><span leaf="">]</span></span></span></p><p><span><span leaf=""><br></span></span></p></section></section></section><p><span leaf=""><br></span></p></section><section data-support="96编辑器" data-style-id="39922"><section><section><section><section><p><strong><span leaf="">二、准备工作</span></strong></p></section></section></section></section></section><section data-support="96编辑器" data-style-id="40285"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.42857142857142855" data-w="49" data-imgfileid="100040546" src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><section><span leaf="">数据来源于</span><span data-pm-slice="0 0 []"><span leaf="">GE</span><span leaf="">O数据</span><span leaf="">库中的</span></span><span leaf="">GSE131907</span><span leaf="">和</span><span leaf="">GSE222318</span><span leaf="">两个数据集。</span></section><section><span leaf="">此次教程整合了前面两个数据集，两个数据集整合后将矩阵重新划分为五个矩阵，分别对应了30万、20万、10万、5万和2.5万细胞数。</span></section><section><span data-pm-slice="0 0 []"><span leaf="">前期数据处理包括了数据整合、数据的下采样，具体的代码运行过程可以参考</span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247525849&amp;idx=1&amp;sn=aa48c5e9405afcf28ffccb7bb4312e70&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">30w单细胞数据会吃掉多少内存？</a></span></span></section><section><span data-pm-slice="0 0 []"><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247525849&amp;idx=1&amp;sn=aa48c5e9405afcf28ffccb7bb4312e70&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">因此本流程接下来可以直接读取之前保存好的rds文件，进行Cellchat的时间和内存测试。</a></span></span><span leaf=""><br></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="javascript"><code><span leaf=""><span>suppressMessages</span>({</span></code><code><span leaf="">  <span>library</span>(<span>Seurat</span>)</span></code><code><span leaf="">  <span>library</span>(<span>CellChat</span>)</span></code><code><span leaf="">  <span>library</span>(peakRAM)</span></code><code><span leaf="">  <span>library</span>(patchwork)</span></code><code><span leaf="">})</span></code><code><span leaf="">obj_30w &lt;- <span>readRDS</span>(<span>"../11_monocle//obj_30w.rds"</span>)</span></code><code><span leaf="">obj_2.5w &lt;- <span>subset</span>(obj_30w,downsample=<span>370</span>)</span></code><code><span leaf="">obj_5w &lt;- <span>subset</span>(obj_30w,downsample=<span>770</span>)</span></code><code><span leaf="">obj_10w &lt;- <span>subset</span>(obj_30w,downsample=<span>1900</span>)</span></code><code><span leaf="">obj_20w &lt;- <span>subset</span>(obj_30w,downsample=<span>5000</span>)</span></code></pre></section></section><p><span><span leaf=""><br></span></span></p></section></section><section data-support="96编辑器" data-style-id="39922"><section><section><section><section><p><strong><span leaf="">三、时间和内存测试</span></strong></p></section></section></section></section></section><section data-support="96编辑器" data-style-id="40285"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.42857142857142855" data-w="49" data-imgfileid="100040546" src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><p data-pm-slice="0 0 []"><span leaf="">Cellchat是一款常用于单细胞数据细胞通讯分析的软件，对于软件不熟悉的同学可以从</span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247501735&amp;idx=2&amp;sn=35fc792961507f4ae1cbae3a2882fba6&amp;chksm=9b3cbef7ac4b37e1417d4108c8bd378c68c3907431ddfc52ad37c916e85649bb450d761a8e19&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">《细胞通讯》CellChat学习手册</a></span><span leaf=""> 系统学起。</span><span leaf="">《单细胞转录组测序数据分析》——《细胞通讯》</span><span leaf="">视频学习教程在B站同步更新,涵盖细胞通讯绪论以及cellchat分析代码实操。</span><span leaf="">接下来我们就进入真正的时间和内存测试环节。</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="perl"><code><span leaf=""><span>for</span> (obj in c(obj_2.<span>5</span>w,obj_5w,obj_10w,obj_20w,obj_30w)){</span></code><code><span leaf="">  <span>print</span>(obj)</span></code><code><span leaf="">  <span>print</span>(</span></code><code><span leaf="">    <span>#用于统计内存和时间的函数</span></span></code><code><span leaf="">    peakRAM({ </span></code><code><span leaf="">      <span>#提取表达矩阵</span></span></code><code><span leaf="">      data.input &lt;- GetAssayData(obj, layer = <span>"data"</span>)</span></code><code><span leaf="">      <span>#提取meta.data</span></span></code><code><span leaf="">      meta &lt;- obj@meta.data </span></code><code><span leaf="">      meta$seurat_clusters &lt;- paste<span>0</span>(<span>"g"</span>,meta$seurat_clusters)</span></code><code><span leaf="">      <span>#构建cellchat对象</span></span></code><code><span leaf="">      cellchat &lt;- createCellChat(object = data.input, meta = meta,group.by = <span>"seurat_clusters"</span>)</span></code><code><span leaf="">      <span>#如果上述没有指定meta=meta，可以如下手动加入</span></span></code><code><span leaf="">      cellchat &lt;- addMeta(cellchat, meta = meta)</span></code><code><span leaf="">      cellchat &lt;- setIdent(cellchat, ident.use = <span>"seurat_clusters"</span>) </span></code><code><span leaf="">      levels(cellchat@idents) </span></code><code><span leaf="">      groupSize &lt;- as.numeric(table(cellchat@idents)) </span></code><code><span leaf="">      <span>#使用人类数据库，如果分析物种是小鼠可以设置为CellChatDB.mouse</span></span></code><code><span leaf="">      CellChatDB &lt;- CellChatDB.human </span></code><code><span leaf="">      <span>#取出相应分类用作分析数据库</span></span></code><code><span leaf="">      CellChatDB.use &lt;- subsetDB(CellChatDB, search = <span>"Secreted Signaling"</span>)</span></code><code><span leaf="">      <span>#将数据库内容载入cellchat对象中</span></span></code><code><span leaf="">      cellchat@DB &lt;- CellChatDB.use</span></code><code><span leaf="">      <span>#表达量预处理，取出表达数据</span></span></code><code><span leaf="">      cellchat &lt;- subsetData(cellchat,features = NULL)</span></code><code><span leaf="">      <span>#寻找高表达的基因</span></span></code><code><span leaf="">      cellchat &lt;- identifyOverExpressedGenes(cellchat)<span>#</span></span></code><code><span leaf="">      <span>#寻找高表达的通路</span></span></code><code><span leaf="">      cellchat &lt;- identifyOverExpressedInteractions(cellchat)</span></code><code><span leaf="">      <span>#注意projectData这个函数已经不能用了，投影到PPI请修改成下面函数，参考https://github.com/jinworks/CellChat/issues/185</span></span></code><code><span leaf="">      <span># cellchat &lt;- projectData(cellchat, PPI.human)</span></span></code><code><span leaf="">      cellchat &lt;- smoothData(cellchat, adj = PPI.human)</span></code><code><span leaf="">      <span>#默认计算方式为type = "truncatedMean",</span></span></code><code><span leaf="">      <span>#默认cutoff的值为20%，即表达比例在25%以下的基因会被认为是0， trim = 0.1可以调整比例阈值，较耗时，2.5w细胞约细胞约10min</span></span></code><code><span leaf="">      cellchat &lt;- computeCommunProb(cellchat, raw.use = T)</span></code><code><span leaf="">      <span>#去掉通讯数量很少的细胞</span></span></code><code><span leaf="">      cellchat &lt;- filterCommunication(cellchat, min.cells = <span>10</span>)</span></code><code><span leaf="">      cellchat &lt;- computeCommunProbPathway(cellchat)</span></code><code><span leaf="">      <span>#每对配受体的预测结果存在net中，每条通路的预测结果存在netp中</span></span></code><code><span leaf="">      cellchat &lt;- aggregateNet(cellchat)</span></code><code><span leaf="">    })</span></code><code><span leaf="">  )</span></code><code><span leaf="">  <span>print</span>(cellchat)</span></code><code><span leaf="">}</span></code></pre></section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRe5jw5bRC1adp0JDgolsItsicePf3WbAeSgyxEzmPXrLicGDDwQTzckMg/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.1657754010695187" data-type="png" data-w="561" data-imgfileid="100001565" src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRe5jw5bRC1adp0JDgolsItsicePf3WbAeSgyxEzmPXrLicGDDwQTzckMg/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRvOQM5jrUM1lTA38tibyy4HBQkHalDFIialk1GMdgUqOia4tvf3wUDwzHA/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.16843971631205673" data-type="png" data-w="564" data-imgfileid="100001566" src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRvOQM5jrUM1lTA38tibyy4HBQkHalDFIialk1GMdgUqOia4tvf3wUDwzHA/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR3sd7ckIQl90RD9v6JAyyPg5MIFBpSJOLsLoXGR6zwW4hjjryg9icQtg/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.16431095406360424" data-type="png" data-w="566" data-imgfileid="100001567" src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR3sd7ckIQl90RD9v6JAyyPg5MIFBpSJOLsLoXGR6zwW4hjjryg9icQtg/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRXo7NgkywZCsibdiclDguibtNS2gtpmKL9wQKecJeHPC7LDmfvaEvS8a0g/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.16842105263157894" data-type="png" data-w="570" data-imgfileid="100001564" src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRXo7NgkywZCsibdiclDguibtNS2gtpmKL9wQKecJeHPC7LDmfvaEvS8a0g/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR7PKOMptXJf08dPy2WXBLv6BcL9gjmAFtq5wH7C6GSZyq8hxjibQj5AA/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.15881326352530542" data-type="png" data-w="573" data-imgfileid="100001568" src="https://mmbiz.qpic.cn/mmbiz_jpg/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR7PKOMptXJf08dPy2WXBLv6BcL9gjmAFtq5wH7C6GSZyq8hxjibQj5AA/640?wx_fmt=jpeg&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></span></section></section></section><p><span><span leaf=""><br></span></span></p></section><section data-support="96编辑器" data-style-id="39922"><section><section><section><section><p><strong><span leaf="">四、总结</span></strong></p></section></section></section></section></section><section data-support="96编辑器" data-style-id="40285"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.42857142857142855" data-w="49" data-imgfileid="100040546" src="https://mmbiz.qpic.cn/mmbiz_png/bL2iaicTYdZn5RYeZyo5amnOAgOiaRia5pTmJkLwBXH0J3icajPObPVuj8C5TeYLc8fI9KZickXDnsa1EvhSibltJv7VQ/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>sum</span> &lt;- data.frame(matrix(NA, nrow = <span>5</span>, ncol = <span>2</span>))</span></code><code><span leaf=""><span>colnames</span>(sum) &lt;- c(<span>"time"</span>,<span>"peak_mem"</span>)</span></code><code><span leaf=""><span>row</span>.names(sum) &lt;- c(<span>"2.5w"</span>,<span>"5w"</span>,<span>"10w"</span>,<span>"20w"</span>,<span>"30w"</span>)</span></code><code><span leaf=""><span>sum</span>[<span>"2.5w"</span>,] &lt;- c(<span>13</span>,<span>7418</span>)</span></code><code><span leaf=""><span>sum</span>[<span>"5w"</span>,] &lt;- c(<span>16</span>,<span>13319</span>)</span></code><code><span leaf=""><span>sum</span>[<span>"10w"</span>,] &lt;- c(<span>22</span>,<span>26808</span>)</span></code><code><span leaf=""><span>sum</span>[<span>"20w"</span>,] &lt;- c(<span>34</span>,<span>40140</span>)</span></code><code><span leaf=""><span>sum</span>[<span>"30w"</span>,] &lt;- c(<span>49</span>,<span>59912</span>)</span></code><code><span leaf=""><span>sum</span>$Category &lt;- rownames(sum)</span></code><code><span leaf=""><span>sum</span>$Category &lt;- factor(sum$Category, levels=sum$Category)</span></code><code><span leaf=""><span>ggplot</span>(sum, aes(x = Category , y = time, fill= Category)) + geom_bar(stat = <span>"identity"</span>)+</span></code><code><span leaf=""><span>labs</span>(x = <span>"Category"</span>, y = <span>"Time(min)"</span>, title = <span>"Cellchat Time Compare"</span>) +</span></code><code><span leaf="">  <span>theme_minimal</span>() + </span></code><code><span leaf="">  <span>theme</span>(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>, size = <span>12</span>),</span></code><code><span leaf="">        <span>axis</span>.text.y = element_text(size = <span>12</span>), </span></code><code><span leaf="">        <span>axis</span>.title = element_text(size = <span>14</span>, face = <span>"bold"</span>), </span></code><code><span leaf="">        <span>plot</span>.title = element_text(size = <span>16</span>, face = <span>"bold"</span>, hjust = <span>0</span>.<span>5</span>),</span></code><code><span leaf="">        <span>legend</span>.title = element_text(size = <span>12</span>, face = <span>"bold"</span>),</span></code><code><span leaf="">        <span>legend</span>.text = element_text(size = <span>10</span>)) </span></code></pre></section><section data-pm-slice="0 0 []" nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR1MIGHoqEuUG2iawsjxbUJfLicyZrmCfvEmOia6R3fknvzcEmjqticJyGzQ/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100001570" src="https://mmbiz.qpic.cn/mmbiz_png/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDR1MIGHoqEuUG2iawsjxbUJfLicyZrmCfvEmOia6R3fknvzcEmjqticJyGzQ/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><p data-pm-slice="0 0 []"><span leaf="">从细胞数和计算时间统计结果的柱形图可以看出，随着细胞数目的增加，</span><span leaf="">计算时间呈现</span><span leaf="">逐渐递增的趋势。</span></p><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>ggplot</span>(sum, aes(x = Category, y = peak_mem, fill= Category)) + geom_bar(stat = <span>"identity"</span>)+</span></code><code><span leaf=""><span>labs</span>(x = <span>"Category"</span>, y = <span>"peak_mem(MB)"</span>, title = <span>"Cellchat Peak Mem Compare"</span>) +</span></code><code><span leaf="">  <span>theme_minimal</span>() + </span></code><code><span leaf="">  <span>theme</span>(axis.text.x = element_text(angle = <span>45</span>, hjust = <span>1</span>, size = <span>12</span>), </span></code><code><span leaf="">        <span>axis</span>.text.y = element_text(size = <span>12</span>), </span></code><code><span leaf="">        <span>axis</span>.title = element_text(size = <span>14</span>, face = <span>"bold"</span>),</span></code><code><span leaf="">        <span>plot</span>.title = element_text(size = <span>16</span>, face = <span>"bold"</span>, hjust = <span>0</span>.<span>5</span>),</span></code><code><span leaf="">        <span>legend</span>.title = element_text(size = <span>12</span>, face = <span>"bold"</span>),</span></code><code><span leaf="">        <span>legend</span>.text = element_text(size = <span>10</span>)</span></code></pre></section><section data-pm-slice="0 0 []" nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRkYdukprlaBDibtjo2TceukSMy6huOkGSBGv84fQ457G3lAOC2ib4He7g/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100001571" src="https://mmbiz.qpic.cn/mmbiz_png/GQbSTiaXLprPFsOm1OUb8CbdqRHcH6zDRkYdukprlaBDibtjo2TceukSMy6huOkGSBGv84fQ457G3lAOC2ib4He7g/640?wx_fmt=png&amp;from=appmsg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></section><p data-pm-slice="0 0 []"><span data-pm-slice="0 0 []"><span leaf="">从细胞数和峰值内存的统计结果的柱形图可以看出，随着细胞数目的增加，峰值内存也呈现逐渐递增的趋势。这个和细胞数与时间统计柱形图对比来看，二者趋势是一致的。对于后续想要自己进行cellchat分析的同学可以参考这里的时间和内存消耗。如果手头数据集细胞数目比较多的情况，还是推荐使用服务器进行分析，避免超过电脑负荷</span></span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491007&amp;idx=1&amp;sn=8619c2bad23791b3252a1c4cb1831931&amp;chksm=9b3f64efac48edf9c02f84959aeee9b12480736fce70c5ddb8b41d79cfc22ce590ea2cb60fba&amp;token=1760636281&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">生信分析为什么要使用服务器？</a></span><span leaf="">。</span></p></section><section><ul><li></ul><pre data-lang="apache"><code><span leaf=""><span>bj_20w</span> &lt;- subset(obj_30w,downsample=<span>5000</span>)</span></code></pre></section></section><p><span><span leaf=""><br></span></span></p></section><section data-support="96编辑器" data-style-id="39922"><section><section><section><section><p><strong><span leaf="">五、参考</span></strong></p></section></section></section></section></section><section data-support="96编辑器" data-style-id="40285"><section><p><span leaf="">https://www.nature.com/articles/s41467-021-21246-9.pdf</span></p><section data-pm-slice="0 0 []"><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.5106382978723404" data-w="47" data-width="100%" data-imgfileid="100042173" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><section data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5Ohviaxjsp3ZhRgjJ0mLNVEwpbT2fzdQMNt832icGGUt1ib9G2DMiazWDahA/640?wx_fmt=png" data-fail="0"><section><p><strong><span leaf="">如何联系我们</span></strong><span leaf=""><br></span></p></section></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="1.163265306122449" data-w="49" data-width="100%" data-imgfileid="100042169" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section></section></section><section data-support="96编辑器" data-style-id="34624"><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="图片" data-ratio="0.2463768115942029" data-w="138" data-imgfileid="100042172" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><section><span><span leaf="">留一个领取资料、</span></span><span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247527585&amp;idx=1&amp;sn=fa32112c11b215b33096cab43baf08ea&amp;scene=21#wechat_redirect" textvalue="久违的免费两周学习版上架啦~" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">免费两周学习版</span></a>服务器的</span></span><span><strong><span leaf="">微信号<span textstyle="">[Biomamba_yunying]</span></span></strong></span><span leaf="">，方便各位随时交流。同时我们也构建了<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528057&amp;idx=1&amp;sn=bb348c2a88c977c7cce67ee6731a3591&amp;scene=21#wechat_redirect" textvalue="Biomamba生信基地交流群矩阵" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">交流群矩阵</span></a>，欢迎大家入群讨论。</span></section><p><span><span leaf=""><br></span></span></p><section><span><span leaf="">大家可以阅读完这几篇之后添加</span></span></section><section><span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">给生信入门初学者的小贴士</a></span><span leaf=""><br></span></span></section><section><span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247506266&amp;idx=2&amp;sn=22b1164bc9602c25620d058847785422&amp;chksm=9b3ca00aac4b291c16d738271746ffb90149282a728f484e8a1952463c46a8e7dc4f883ab928&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容(内含集锦)" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">如何搜索公众号过往发布内容</a></span></span><span leaf=""><br></span></section><p><span><strong><span leaf="">已有生信基地联系方式的同学</span></strong></span><span><strong><span leaf="">无需重复添加</span></strong></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpyZBGOXDqRYHpgiczxr9PX8gliblp8giaPGsr7w6IeoU6lExTAeEjx48Ke4LEJQfbdiarzXwUGvoRFvyA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.46111111111111114" data-w="1080" data-imgfileid="100042171" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpyZBGOXDqRYHpgiczxr9PX8gliblp8giaPGsr7w6IeoU6lExTAeEjx48Ke4LEJQfbdiarzXwUGvoRFvyA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section></section></section></section></section><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="图片" data-ratio="0.7619047619047619" data-w="84" data-width="80%" data-imgfileid="100042174" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><span><span leaf="">您点的每个赞和在看，我都认真当成了喜欢</span></span></section></section></section><section><span leaf=""><br></span></section><section><span leaf=""><br></span></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ofMkThP1k-m9NywlfwG5Ug",target="_blank" rel="noopener noreferrer">原文链接</a>
