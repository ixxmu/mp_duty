---
title: "R语言画图 | CIBERSORT 相关性棒棒糖图-补"
date: 2025-04-19T00:23:43Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
R语言画图 | CIBERSORT 相关性棒棒糖图-补 by 被炸熟的虾
------
<div><ul></ul><section data-pm-slice="0 0 []"><section><p data-pm-slice='2 2 ["para",{"tagName":"section","attributes":{"data-pm-slice":"0 0 []","style":"-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;color: rgba(0, 0, 0, 0.9);font-family: \"PingFang SC\", system-ui, -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.544px;orphans: 2;text-align: justify;text-indent: 2em;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"list",{"type":"ul","style":"","class":"list-paddingleft-1"},"listitem",{"style":""},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span leaf="">之前我们记录了一期：<a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247490757&amp;idx=1&amp;sn=7c6df725749494ae86a407cc5ef53b78&amp;payreadticket=HKfqosnDQUfnwPVBO13qWSadUnopcu7L-y7n5H10cry_0zDs4g_B0tyYtSrK326A4yB_dq0&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">R语言画图 | CIBERSORT结果简单可视化 （二） 相关性条形图</span></a></span></p><p data-pm-slice="0 0 []"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LBia2lLr0bwRD8wrVEjQZglqmOTNbWGcXcU8XStibLnwUZsQnrU5N3Z3QvVjVO66ZDyWv8hAM3llNQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6666666666666666" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100007105" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3LBia2lLr0bwRD8wrVEjQZglqmOTNbWGcXcU8XStibLnwUZsQnrU5N3Z3QvVjVO66ZDyWv8hAM3llNQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p><span leaf="">这次补录一个新风格。</span><span leaf="">按照</span><strong><span leaf="">显著性分组填充颜色</span></strong><span leaf="">，将</span><strong><span leaf="">相关性绝对值映射到点的</span><span leaf="">size</span></strong><span leaf="">。最后在右侧拼上一列</span><span leaf="">P</span><span leaf="">值。</span></p><p><span leaf="">虽然我觉得还是前者好看<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/2_05.png" data-ratio="1" data-w="20" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/2_05.png">，就当是攒一波模板。</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7ee51ib5z2uytspc1KZoqtjXABCz330HUS8wc8GWbnbkc6saq9ibaU6icrqA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6666666666666666" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100007145" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7ee51ib5z2uytspc1KZoqtjXABCz330HUS8wc8GWbnbkc6saq9ibaU6icrqA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">首先重复一下数据准备：</span></p><pre><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">load(file = </span><span><span leaf="">"./res_cibersort.Rdata"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">res_cibersort &lt;- data.frame(res_cibersort[,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">22</span></span><span leaf="">])</span><span leaf=""><br></span><span leaf="">head(res_cibersort)</span><span leaf=""><br></span><span leaf="">load(</span><span><span leaf="">"D:/data/TCGA/TCGAbiolinks-EXP/TCGA-COAD-GeneSymbol.Rdata"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">res_cibersort$CD3D &lt;- as.numeric(exp_TPM[</span><span><span leaf="">"CD3D"</span></span><span leaf="">,rownames(res_cibersort)])</span><span leaf=""><br></span><span leaf="">res_cibersort$CD3E &lt;- as.numeric(exp_TPM[</span><span><span leaf="">"CD3E"</span></span><span leaf="">,rownames(res_cibersort)])</span><span leaf=""><br></span><span leaf="">res_cibersort$GZMB &lt;- as.numeric(exp_TPM[</span><span><span leaf="">"GZMB"</span></span><span leaf="">,rownames(res_cibersort)])</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(psych)</span><span leaf=""><br></span><span leaf="">cor_matrix &lt;- corr.test(res_cibersort, method = </span><span><span leaf="">"spearman"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Rvalue &lt;- cor_matrix$r </span><span><span leaf="">#提取相关性系数</span></span><span leaf=""><br></span><span leaf="">Pvalue &lt;- cor_matrix$p </span><span><span leaf="">#提取相关性系数的p值</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">Rvalue[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">]</span><span leaf=""><br></span><span><span leaf="">#               B.cells.naive B.cells.memory Plasma.cells T.cells.CD8</span></span><span leaf=""><br></span><span><span leaf="">#B.cells.naive     1.00000000   -0.238315544  0.229495428 -0.01467395</span></span><span leaf=""><br></span><span><span leaf="">#B.cells.memory   -0.23831554    1.000000000  0.003596668 -0.09922438</span></span><span leaf=""><br></span><span><span leaf="">#Plasma.cells      0.22949543    0.003596668  1.000000000  0.02304189</span></span><span leaf=""><br></span><span><span leaf="">#T.cells.CD8      -0.01467395   -0.099224380  0.023041892  1.00000000</span></span><span leaf=""><br></span><span leaf="">Pvalue[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">4</span></span><span leaf="">]</span><span leaf=""><br></span><span><span leaf="">#               B.cells.naive B.cells.memory Plasma.cells T.cells.CD8</span></span><span leaf=""><br></span><span><span leaf="">#B.cells.naive   0.000000e+00   4.735852e-05 0.0001341864           1</span></span><span leaf=""><br></span><span><span leaf="">#B.cells.memory  1.989854e-07   0.000000e+00 1.0000000000           1</span></span><span leaf=""><br></span><span><span leaf="">#Plasma.cells    5.661874e-07   9.383455e-01 0.0000000000           1</span></span><span leaf=""><br></span><span><span leaf="">#T.cells.CD8     7.523120e-01   3.242085e-02 0.6201762422           0</span></span></code></pre><pre><code><span leaf="">datCD3D &lt;- data.frame(Rvalue =  as.numeric(Rvalue[</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">22</span></span><span leaf="">]),</span><span leaf=""><br></span><span leaf="">                      Pvalue =  as.numeric(Pvalue[</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">22</span></span><span leaf="">]),</span><span leaf=""><br></span><span leaf="">                      Celltype = colnames(Pvalue)[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">22</span></span><span leaf="">])</span><span leaf=""><br></span><span leaf="">datCD3D &lt;- datCD3D[order(datCD3D$Rvalue),]</span><span leaf=""><br></span><span leaf="">datCD3D$Celltype &lt;- gsub(</span><span><span leaf="">".Tregs."</span></span><span leaf="">,</span><span><span leaf="">"(Tregs)"</span></span><span leaf="">,datCD3D$Celltype)</span><span leaf=""><br></span><span leaf="">datCD3D$Celltype &lt;- gsub(</span><span><span leaf="">"[.]"</span></span><span leaf="">,</span><span><span leaf="">" "</span></span><span leaf="">,datCD3D$Celltype)</span><span leaf=""><br></span><span leaf="">datCD3D$Celltype &lt;- factor(datCD3D$Celltype,levels = datCD3D$Celltype)</span><span leaf=""><br></span></code></pre><p data-pm-slice="0 0 []"><span leaf="">按照显著性阈值分成四组：</span></p><pre><code><span><span leaf="">library</span></span><span leaf="">(dplyr)</span><span leaf=""><br></span><span leaf="">tmp &lt;- case_when(as.vector(datCD3D$Pvalue) &lt; </span><span><span leaf="">0.001</span></span><span leaf="">~</span><span><span leaf="">"P &lt; 0.001"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                 as.vector(datCD3D$Pvalue) &lt; </span><span><span leaf="">0.01</span></span><span leaf="">~</span><span><span leaf="">"P &lt; 0.01"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                 as.vector(datCD3D$Pvalue) &lt; </span><span><span leaf="">0.05</span></span><span leaf="">~</span><span><span leaf="">"P &lt; 0.05"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                 </span><span><span leaf="">T</span></span><span leaf="">~ </span><span><span leaf="">"Not Sig"</span></span><span leaf="">)     </span><span leaf=""><br></span><span leaf="">datCD3D$Group &lt;- tmp</span><span leaf=""><br></span><span leaf="">datCD3D$Group &lt;- factor(datCD3D$Group,levels = c(</span><span><span leaf="">"Not Sig"</span></span><span leaf="">,</span><span><span leaf="">"P &lt; 0.05"</span></span><span leaf="">,</span><span><span leaf="">"P &lt; 0.01"</span></span><span leaf="">,</span><span><span leaf="">"P &lt; 0.001"</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><p><span leaf="">主图绘制：</span></p><p><span leaf="">和之前的模板类似，需要注意以下几点：</span></p><ul><li><section><span leaf="">虽然相关性横线（</span><code><span leaf=""><span textstyle="">geom_segment</span></span></code><span leaf="">）按照显著性分组，但为了美观，这一部分图例不展示（</span><code><span leaf=""><span textstyle="">show.legend = FALSE</span></span></code><span leaf="">）；</span></section></li><li><section><span leaf="">相关性</span><span leaf="">映射到</span><span leaf="">点</span><span leaf=""><span textstyle="">size</span></span><span leaf="">时</span><span leaf="">注意设置绝对值（</span><code><span leaf=""><span textstyle="">abs</span></span></code><span leaf="">）;</span></section></li><li><section><span leaf="">有的时候不一定所有分组都存在，因此颜色设置（</span><code><span leaf=""><span textstyle="">scale_color_manual</span></span></code><span leaf="">）注意一一对应。</span></section></li></ul><pre><code><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><span leaf=""><br></span><span leaf="">p3 &lt;- ggplot(datCD3D, aes(x = Celltype, y = Rvalue)) + </span><span leaf=""><br></span><span leaf="">      geom_segment(aes(x = Celltype, xend = Celltype,</span><span leaf=""><br></span><span leaf="">                       y = </span><span><span leaf="">0</span></span><span leaf="">, yend = Rvalue, </span><span leaf=""><br></span><span leaf="">                       color = Group),</span><span leaf=""><br></span><span leaf="">                       size = </span><span><span leaf="">2</span></span><span leaf="">,show.legend = </span><span><span leaf="">FALSE</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">      geom_point(aes(size = abs(Rvalue), color = Group)) + </span><span leaf=""><br></span><span leaf="">      coord_flip() +</span><span leaf=""><br></span><span leaf="">      scale_y_continuous(expand = c(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">0</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                         limits = c(-</span><span><span leaf="">0.48</span></span><span leaf="">,</span><span><span leaf="">0.48</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                         breaks = seq(-</span><span><span leaf="">0.4</span></span><span leaf="">,</span><span><span leaf="">0.4</span></span><span leaf="">,</span><span><span leaf="">0.2</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                         labels = seq(-</span><span><span leaf="">0.4</span></span><span leaf="">,</span><span><span leaf="">0.4</span></span><span leaf="">,</span><span><span leaf="">0.2</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">      scale_size_continuous(range = c(</span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf="">10</span></span><span leaf="">),limits = c(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">0.5</span></span><span leaf="">),breaks = seq(</span><span><span leaf="">0.1</span></span><span leaf="">,</span><span><span leaf="">0.5</span></span><span leaf="">,</span><span><span leaf="">0.1</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">      scale_color_manual(values = c(</span><span><span leaf="">"P &lt; 0.001"</span></span><span leaf=""> = </span><span><span leaf="">"#E41A1C"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                 </span><span><span leaf="">"P &lt; 0.01"</span></span><span leaf=""> = </span><span><span leaf="">"#377EB8"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                                    </span><span><span leaf="">"P &lt; 0.05"</span></span><span leaf=""> = </span><span><span leaf="">"#4DAF4A"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">         </span><span><span leaf="">"Not Sig"</span></span><span leaf=""> = </span><span><span leaf="">"#984EA3"</span></span><span leaf="">),drop = </span><span><span leaf="">FALSE</span></span><span leaf="">)  +</span><span leaf=""><br></span><span leaf="">      labs(x = </span><span><span leaf="">NULL</span></span><span leaf="">, y = </span><span><span leaf="">"Correlation Coefficient"</span></span><span leaf="">, title = </span><span><span leaf="">"CD3D"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">           color = </span><span><span leaf="">"pvalue"</span></span><span leaf="">, size = </span><span><span leaf="">"abs(cor)"</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">      theme_bw() + </span><span leaf=""><br></span><span leaf="">      theme(axis.text.x = element_text(hjust = </span><span><span leaf="">0.5</span></span><span leaf="">,size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 axis.ticks.y = element_blank(), </span><span><span leaf="">## 删去y轴刻度线</span></span><span leaf=""><br></span><span leaf="">                 axis.text.y = element_text(size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 axis.title.x = element_text(size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 axis.title.y = element_text(size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 axis.line = element_line(size = </span><span><span leaf="">1</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                 plot.margin = unit(c(</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">), </span><span><span leaf="">"cm"</span></span><span leaf="">),</span><span><span leaf="">#画布边缘距离上(top)、右(right)、下(bottom)、左(left) </span></span><span leaf=""><br></span><span leaf="">                 plot.title = element_text(hjust = </span><span><span leaf="">0.5</span></span><span leaf="">,size =  </span><span><span leaf="">22</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                 legend.title = element_text(size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 legend.text = element_text(size = </span><span><span leaf="">20</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                 legend.position = </span><span><span leaf="">"right"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                 legend.background = element_rect(fill = </span><span><span leaf="">'transparent'</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">                 axis.line.y = element_blank(),</span><span><span leaf="">##删除纵坐标轴</span></span><span leaf=""><br></span><span leaf="">                 panel.grid.major = element_blank(),</span><span><span leaf="">##删除网格线</span></span><span leaf=""><br></span><span leaf="">                 panel.grid.minor = element_blank(),</span><span leaf=""><br></span><span leaf="">                 panel.border = element_blank()) +</span><span leaf=""><br></span><span leaf="">      guides(colour = guide_legend(override.aes = list(size = </span><span><span leaf="">8</span></span><span leaf="">)))   </span><span leaf=""><br></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7eeaUdT3Ueic9mt2Im18LfD4zeWibCLll2zTaHLVIAvZDBdIc1ZdfCa2kicA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6666666666666666" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100007148" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7eeaUdT3Ueic9mt2Im18LfD4zeWibCLll2zTaHLVIAvZDBdIc1ZdfCa2kicA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">然后是右侧显著性数字，我们采用之前使用</span><code><span leaf=""><span textstyle="">ggplot2</span></span></code><span leaf="">绘制森林图的方法：<a href="https://mp.weixin.qq.com/s?__biz=MzkwNDQwMDI5NQ==&amp;mid=2247485128&amp;idx=1&amp;sn=47fa55bb56f418b230c1c86381b7aa73&amp;payreadticket=HIkcA6jkeALdA-JoxEb2UoOj0ecjCuc9gXpO0xezK_6LwQgZDOMRM8jYe-AHsNk1DGjsAtI&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">R语言画图 | 森林图 单基因泛癌Cox回归分析</span></a>，直接</span><code><span leaf=""><span textstyle="">geom_text</span></span></code><span leaf="">单独绘制然后拼起来。</span></p><pre><code><span leaf="">datCD3D$Pvalue2 &lt;- as.character(round(datCD3D$Pvalue,</span><span><span leaf="">3</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">datCD3D$Pvalue2[datCD3D$Pvalue &lt; </span><span><span leaf="">0.001</span></span><span leaf="">] &lt;- </span><span><span leaf="">"&lt;0.001"</span></span><span leaf="">   </span><span leaf=""><br></span><span leaf="">p4 &lt;-  ggplot(datCD3D,aes(x = </span><span><span leaf="">1</span></span><span leaf="">, y = Celltype))+</span><span leaf=""><br></span><span leaf="">       geom_text(aes(x = </span><span><span leaf="">1</span></span><span leaf="">,y = Celltype,color = Group),label = datCD3D$Pvalue2,</span><span leaf=""><br></span><span leaf="">                 hjust = </span><span><span leaf="">0.5</span></span><span leaf="">,inherit.aes = </span><span><span leaf="">FALSE</span></span><span leaf="">,size = </span><span><span leaf="">6</span></span><span leaf="">,show.legend = </span><span><span leaf="">FALSE</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">       labs(title = </span><span><span leaf="">"P value"</span></span><span leaf="">, x = </span><span><span leaf="">""</span></span><span leaf="">,y = </span><span><span leaf="">NULL</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">       scale_color_manual(values = c(</span><span><span leaf="">"P &lt; 0.001"</span></span><span leaf=""> = </span><span><span leaf="">"#E41A1C"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                     </span><span><span leaf="">"P &lt; 0.01"</span></span><span leaf=""> = </span><span><span leaf="">"#377EB8"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                                     </span><span><span leaf="">"P &lt; 0.05"</span></span><span leaf=""> = </span><span><span leaf="">"#4DAF4A"</span></span><span leaf="">, </span><span leaf=""><br></span><span leaf="">                                     </span><span><span leaf="">"Not Sig"</span></span><span leaf=""> = </span><span><span leaf="">"#984EA3"</span></span><span leaf="">),drop = </span><span><span leaf="">FALSE</span></span><span leaf="">)  +</span><span leaf=""><br></span><span leaf="">       theme_classic() +</span><span leaf=""><br></span><span leaf="">       theme(plot.title = element_text(hjust = </span><span><span leaf="">0.5</span></span><span leaf="">,face = </span><span><span leaf="">"bold"</span></span><span leaf="">,size = </span><span><span leaf="">20</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">             axis.text.x = element_blank(), </span><span leaf=""><br></span><span leaf="">             axis.text.y = element_blank(),</span><span leaf=""><br></span><span leaf="">             axis.title.x = element_blank(), </span><span leaf=""><br></span><span leaf="">             axis.title.y = element_blank(),</span><span leaf=""><br></span><span leaf="">             axis.ticks.x = element_blank(),    </span><span leaf=""><br></span><span leaf="">             axis.ticks.y = element_blank(),</span><span leaf=""><br></span><span leaf="">             axis.line.x = element_blank(),</span><span leaf=""><br></span><span leaf="">             axis.line.y = element_blank())</span><span leaf=""><br></span><span leaf="">p4</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(patchwork)</span><span leaf=""><br></span><span leaf="">p3 + p4 + plot_layout(widths = c(</span><span><span leaf="">0.8</span></span><span leaf="">,</span><span><span leaf="">0.2</span></span><span leaf="">),nrow = </span><span><span leaf="">1</span></span><span leaf="">,guides = </span><span><span leaf="">"collect"</span></span><span leaf="">)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7ee51ib5z2uytspc1KZoqtjXABCz330HUS8wc8GWbnbkc6saq9ibaU6icrqA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6666666666666666" data-s="300,640" data-w="2400" type="block" data-imgfileid="100007145" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3Iia6FORbnug7x7dS77JC7ee51ib5z2uytspc1KZoqtjXABCz330HUS8wc8GWbnbkc6saq9ibaU6icrqA/640?wx_fmt=png&amp;from=appmsg"></section><section><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.05278592375366569" data-type="png" data-w="341" src="https://mmbiz.qpic.cn/sz_mmbiz_png/1LTeQhNfr8sUH75oYsoDaqjPCTiaukEmS8tWricW7LnLKKfIE9jKBexibqamsrlibaaXmuc2nicaYibfDFBNCmqX5mBw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></p><p><span leaf=""><span textstyle="">绘图数据链接（下方二维码）</span></span></p><p><mp-pay-preview-filter data-offset="23"></mp-pay-preview-filter></p></section></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/u-QvgYfsFgZxqmYQmj_WSQ",target="_blank" rel="noopener noreferrer">原文链接</a>
