---
title: "玩转 ENSEMBL 数据库 （一）"
date: 2025-04-21T22:02:53Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
玩转 ENSEMBL 数据库 （一） by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">生物信息学离不开数据库的使用，一般情况下，我们似乎能难使用一个数据库的全部功能，但不可否认的是，一个数据库往往隐藏着我们不知道的使用技巧，也可能我们使用过这些功能，但不够完整。所以这里我们一起探索一下数据库的使用奥秘及深度解读信息。</span></p><p data-tool="mdnice编辑器"><span leaf="">Ensembl数据库是一个广泛使用的生物信息学资源，主要用于提供多种物种的基因组注释和比较基因组学数据。以下是Ensembl数据库的一些关键特点：</span></p><ol><li><section><strong><span leaf="">基因组注释</span></strong><span leaf="">：Ensembl提供了多种物种的详细基因组注释，包括基因、转录本、蛋白质序列及其功能描述。</span></section></li><li><section><strong><span leaf="">比较基因组学</span></strong><span leaf="">：Ensembl支持跨物种的基因组比较分析，帮助研究人员研究基因进化和功能保守性。</span></section></li><li><section><strong><span leaf="">多样性和变异数据</span></strong><span leaf="">：数据库包含丰富的人类和其他物种的遗传多样性和变异信息，如SNPs（单核苷酸多态性）和结构变异。</span></section></li><li><section><strong><span leaf="">浏览和访问工具</span></strong><span leaf="">：Ensembl提供了直观的浏览器界面和API，方便用户访问和分析数据。</span></section></li><li><section><strong><span leaf="">整合数据</span></strong><span leaf="">：Ensembl整合了来自多个公共项目的数据，如GENCODE、UniProt和NCBI，提供全面的基因组信息。</span></section></li><li><section><strong><span leaf="">定期更新</span></strong><span leaf="">：数据库定期更新，以确保提供最新的基因组和注释数据。</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">今天我们先不聊ENSEMBL官网界面，先聊一下怎么在R中访问ENSEMBL资源，这是一个R包：BiomaRt, Bioconductor R package</span><span leaf="">。BiomaRt是一个用于访问生物信息学数据库的R包，特别是 Ensembl 数据库。它提供了一个方便的接口来查询和检索基因组数据。这个 R 包可以在 Rstudio 中直接在线调用 Ensembl 数据库信息。</span></p><p data-tool="mdnice编辑器"><span leaf="">下载 </span><code><span leaf="">R</span></code><span leaf=""> 包</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">if</span></span><span leaf=""> (!requireNamespace(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">, quietly = TRUE))</span><br><span leaf="">    install.packages(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">)</span><br><span leaf="">BiocManager::install(</span><span><span leaf="">"biomaRt"</span></span><span leaf="">)</span><br></code></pre><blockquote><span></span><p><span leaf="">先解释一个词（后边会频繁用）</span></p><p><em><code><span leaf="">mart</span></code></em><span leaf=""> 指的是一个数据库连接对象，它代表你要查询的特定 BioMart 数据库。BioMart 是一个生物信息学数据库系统，提供了访问各种生物数据的接口。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">我们先举例再逐一解读参数。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">示例1</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">获取位于人类 1 号染色体上的所有 Ensembl 基因、转录本 ID、HGNC 符号及染色体位置信息。</span></p><p data-tool="mdnice编辑器"><span leaf="">这里使用两个函数，</span><code><span leaf="">useEnsembl </span></code><span leaf="">函数用来在线连接数据库和基因集，</span><code><span leaf="">getBM</span></code><span leaf="">函数用于从数据库中检索数据</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">library(biomaRt)</span><br><span leaf="">ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset=</span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br><span leaf="">chr1_genes &lt;- getBM(attributes=c(</span><span><span leaf="">'ensembl_gene_id'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'ensembl_transcript_id'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'hgnc_symbol'</span></span><span leaf="">,</span><span><span leaf="">'chromosome_name'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'start_position'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'end_position'</span></span><span leaf="">),</span><br><span leaf="">                    filters = </span><span><span leaf="">'chromosome_name'</span></span><span leaf="">, </span><br><span leaf="">                    values =</span><span><span leaf="">"1"</span></span><span leaf="">,</span><br><span leaf="">                    mart = ensembl</span><br><span leaf="">                    )</span><br></code></pre><ol><li><section><p><strong><span leaf="">加载biomaRt库</span></strong><span leaf="">：*</span><code><span leaf="">library(biomaRt)</span></code><span leaf="">*用于加载biomaRt包，确保可以使用其功能来访问生物数据库。</span></p></section></li><li><section><p><strong><span leaf="">连接到Ensembl数据库</span></strong><span leaf="">：*</span><code><span leaf="">useEnsembl(biomart="ensembl", dataset="hsapiens_gene_ensembl")</span></code><em><span leaf="">函数用于连接到Ensembl数据库，指定了使用人类基因数据集</span></em><code><span leaf="">hsapiens_gene_ensembl</span></code><span leaf="">*。</span></p></section></li><li><section><p><strong><span leaf="">检索数据</span></strong><span leaf="">：</span></p></section></li></ol><ul><li><section><span leaf="">*</span><code><span leaf="">'ensembl_gene_id'</span></code><span leaf="">*：Ensembl基因ID。</span></section></li><li><section><span leaf="">*</span><code><span leaf="">'ensembl_transcript_id'</span></code><span leaf="">*：Ensembl转录本ID。</span></section></li><li><section><span leaf="">*</span><code><span leaf="">'hgnc_symbol'</span></code><span leaf="">*：HGNC基因符号。</span></section></li><li><section><span leaf="">*</span><code><span leaf="">'chromosome_name'</span></code><span leaf="">*：染色体名称。</span></section></li><li><section><span leaf="">*</span><code><span leaf="">'start_position'</span></code><span leaf="">*：基因起始位置。</span></section></li><li><section><span leaf="">*</span><code><span leaf="">'end_position'</span></code><span leaf="">*：基因结束位置。</span></section></li></ul><ul><li><section><p><span leaf="">*</span><code><span leaf="">getBM()</span></code><span leaf="">*函数用于从Ensembl数据库检索数据。</span></p></section></li><li><section><p><code><span leaf="">attributes</span></code></p><p><span leaf="">参数指定了要检索的字段，包括：</span></p></section></li><li><section><p><span leaf="">*</span><code><span leaf="">filters</span></code><span leaf="">*参数用于指定过滤条件，这里是按染色体名称过滤。</span></p></section></li><li><section><p><span leaf="">*</span><code><span leaf="">values</span></code><span leaf="">*参数指定过滤值，这里是染色体1。</span></p></section></li><li><section><p><span leaf="">*</span><code><span leaf="">mart</span></code><em><span leaf="">参数指定使用的数据库连接对象，即之前创建的</span></em><code><span leaf="">ensembl</span></code><span leaf="">*。</span></p></section></li></ul><li><section><p><strong><span leaf="">存储结果</span></strong><span leaf="">：检索到的数据被存储在*</span><code><span leaf="">chr1_genes</span></code><span leaf="">*变量中，包含染色体1上的基因信息。</span></p></section></li><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">函数 1 : useEnsembl</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">"useEnsembl"函数允许通过指定 BioMart 和数据集参数连接到 Ensembl 网站的 mart。例如，要连接到 Ensembl 实时基因 mart 的人类数据集。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset=</span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">参数：biomart</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">其中</span><code><span leaf="">biomart</span></code><span leaf="">是想要连接的 BioMart 数据库名称。可以使用 </span><code><span leaf="">listEnsembl </span></code><span leaf="">函数检索可能的数据库名称。</span></p><p data-tool="mdnice编辑器"><span leaf="">也可以直接网页进入数据库 https://www.ensembl.org/biomart/martview ，这个网页版使用可以以后再聊。</span></p><p data-tool="mdnice编辑器"><span leaf="">运行"listEnsembl"函数</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; library(biomaRt)</span><br><span leaf="">&gt; listEnsembl()</span><br><span leaf="">        biomart                version</span><br><span leaf="">1         genes      Ensembl Genes 113</span><br><span leaf="">2 mouse_strains      Mouse strains 113</span><br><span leaf="">3          snps  Ensembl Variation 113</span><br><span leaf="">4    regulation Ensembl Regulation 113</span><br></code></pre><ol><li><section><span leaf="">**"genes"**：用于访问 Ensembl Genes 数据库，提供基因组注释信息。</span></section></li><li><section><span leaf="">**"snps"**：用于访问 Ensembl Variation 数据库，提供关于遗传变异的信息。</span></section></li><li><section><span leaf="">**"regulation"**：用于访问 Ensembl Regulation 数据库，提供基因调控相关的信息。</span></section></li><li><section><span leaf="">**"mouse_strains"**：用于访问小鼠品系的基因组信息。</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">可以看到有四个数据库，但是我们一般使用 </span><code><span leaf="">biomart="ensembl"</span></code><span leaf="">, 这个一种快捷方式，等价于 </span><code><span leaf="">biomart="genes"</span></code></p><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">参数：dataset</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">通过</span><code><span leaf="">dataset="hsapiens_gene_ensembl"</span></code><span leaf="">可以连接自己关注的物种。</span></p><p data-tool="mdnice编辑器"><span leaf="">"listDatasets"函数提供给定 mart 下所有可用物种（mart 数据集）的列表</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">)</span><br><span leaf="">&gt; head(listDatasets(ensembl))</span><br><span leaf="">                       dataset                           description     version</span><br><span leaf="">1 abrachyrhynchus_gene_ensembl Pink-footed goose genes (ASM259213v1) ASM259213v1</span><br><span leaf="">2     acalliptera_gene_ensembl      Eastern happy genes (fAstCal1.3)  fAstCal1.3</span><br><span leaf="">3   acarolinensis_gene_ensembl       Green anole genes (AnoCar2.0v2) AnoCar2.0v2</span><br><span leaf="">4    acchrysaetos_gene_ensembl       Golden eagle genes (bAquChr1.2)  bAquChr1.2</span><br><span leaf="">5    acitrinellus_gene_ensembl        Midas cichlid genes (Midas_v5)    Midas_v5</span><br><span leaf="">6    amelanoleuca_gene_ensembl       Giant panda genes (ASM200744v2) ASM200744v2</span><br><span leaf="">`````</span><br><span leaf="">`````</span><br><span leaf="">`````</span><br><span leaf="">77             hcomes_gene_ensembl                   Tiger tail seahorse genes (H_comes_QL1_v1)                    H_comes_QL1_v1</span><br><span leaf="">78           hgfemale_gene_ensembl        Naked mole-rat female genes (Naked_mole-rat_maternal)           Naked_mole-rat_maternal</span><br><span leaf="">79             hhucho_gene_ensembl                                   Huchen genes (ASM331708v1)                       ASM331708v1</span><br><span leaf="">80           hsapiens_gene_ensembl                                     Human genes (GRCh38.p14)                        GRCh38.p14</span><br><span leaf="">81         ipunctatus_gene_ensembl                          Channel catfish genes (ASM400665v3)                       ASM400665v3</span><br><span leaf="">82  itridecemlineatus_gene_ensembl                                   Squirrel genes (SpeTri2.0)                         SpeTri2.0</span><br><span leaf="">83           jjaculus_gene_ensembl                     Lesser Egyptian jerboa genes (JacJac1.0)                         JacJac1.0</span><br><span leaf="">`````</span><br><span leaf="">`````</span><br><span leaf="">`````</span><br><span leaf="">210          vursinus_gene_ensembl      Common wombat genes (bare-nosed_wombat_genome_assembly) bare-nosed_wombat_genome_assembly</span><br><span leaf="">211           vvulpes_gene_ensembl                                    Red fox genes (VulVul2.2)                         VulVul2.2</span><br><span leaf="">212       xcouchianus_gene_ensembl     Monterrey platyfish genes (Xiphophorus_couchianus-4.0.1)      Xiphophorus_couchianus-4.0.1</span><br><span leaf="">213        xmaculatus_gene_ensembl                       Platyfish genes (X_maculatus-5.0-male)              X_maculatus-5.0-male</span><br><span leaf="">214       xtropicalis_gene_ensembl                   Tropical clawed frog genes (UCB_Xtro_10.0)                     UCB_Xtro_10.0</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">可以看到截至目前 </span><code><span leaf="">genes</span></code><span leaf="">数据库中有214条信息。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">函数 2 ：getBM</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">"getBM"函数允许您通过一组 mart 过滤器和属性列表构建 BioMart 查询。说人话就是要根据什么信息（filters, values），然后提取 (attributes) 出什么信息</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">chr1_genes &lt;- getBM(attributes=c(</span><span><span leaf="">'ensembl_gene_id'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'ensembl_transcript_id'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'hgnc_symbol'</span></span><span leaf="">,</span><span><span leaf="">'chromosome_name'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'start_position'</span></span><span leaf="">,</span><br><span leaf="">                                 </span><span><span leaf="">'end_position'</span></span><span leaf="">),</span><br><span leaf="">                    filters = </span><span><span leaf="">'chromosome_name'</span></span><span leaf="">, </span><br><span leaf="">                    values =</span><span><span leaf="">"1"</span></span><span leaf="">,</span><br><span leaf="">                    mart = ensembl</span><br><span leaf="">                    )</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">参数：fillters</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">"listFilters"函数将为您提供给定 mart 和物种的可用过滤器列表</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset=</span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br><span leaf="">&gt; head(listFilters(ensembl))</span><br><span leaf="">             name              description</span><br><span leaf="">1 chromosome_name Chromosome/scaffold name</span><br><span leaf="">2           start                    Start</span><br><span leaf="">3             end                      End</span><br><span leaf="">4      band_start               Band Start</span><br><span leaf="">5        band_end                 Band End</span><br><span leaf="">6    marker_start             Marker Start</span><br></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 也可以表格形式直接查看</span></span><br><span leaf="">View(ensembl@filters)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">这个例子中我们使用的</span><code><span leaf="">filters</span></code><span leaf="">信息就是染色体号</span><code><span leaf="">chromosome_name</span></code><span leaf="">， 提取染色体1，就是`values ="1"</span></p><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">参数：attributes</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">"listAttributes"函数将提供给定 mart 和物种的可用属性列表</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset=</span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br><span leaf="">&gt; head(listAttributes(ensembl))</span><br><span leaf="">                           name                  description         page</span><br><span leaf="">1               ensembl_gene_id               Gene stable ID feature_page</span><br><span leaf="">2       ensembl_gene_id_version       Gene stable ID version feature_page</span><br><span leaf="">3         ensembl_transcript_id         Transcript stable ID feature_page</span><br><span leaf="">4 ensembl_transcript_id_version Transcript stable ID version feature_page</span><br><span leaf="">5            ensembl_peptide_id            Protein stable ID feature_page</span><br><span leaf="">6    ensembl_peptide_id_version    Protein stable ID version feature_page</span><br></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 也可以表格形式直接查看</span></span><br><span leaf="">View(ensembl@attributes)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">如果上面制定了染色体1，这个就是我们需要知道染色体上基因的哪些信息：</span></p><ul><li><section><span leaf="">***</span><code><span leaf="">ensembl_gene_id</span></code><span leaf="">***：Ensembl 基因 ID，是 Ensembl 数据库中用于唯一标识每个基因的标识符。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">ensembl_transcript_id</span></code><span leaf="">***：Ensembl 转录本 ID，用于唯一标识每个转录本。一个基因可以有多个转录本，这些转录本可能代表不同的剪接变体。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">hgnc_symbol</span></code><span leaf="">***：HGNC 基因符号，是由人类基因命名委员会（HGNC）指定的标准化基因符号。它通常是一个简短且易于记忆的名称，用于识别已知基因。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">chromosome_name</span></code><span leaf="">***：染色体名称，表示基因所在的染色体编号或字母（例如，"1" 表示染色体 1，"X" 表示 X 染色体）。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">start_position</span></code><span leaf="">***：基因在染色体上的起始位置，通常以碱基对（bp）为单位表示。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">end_position</span></code><span leaf="">***：基因在染色体上的结束位置，也以碱基对为单位表示。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">等等等等········</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">示例 2</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">获取映射到人类 Ensembl 基因 ID "ENSG00000139618" 的 Ensembl 基因、转录本 ID、HGNC 符号及 Uniprot Swissprot 登录号</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; library(biomaRt)</span><br><span leaf="">&gt; ensembl = useEnsembl(biomart=</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset=</span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br><span leaf="">&gt; hgnc_swissprot &lt;- getBM(attributes=c(</span><span><span leaf="">'ensembl_gene_id'</span></span><span leaf="">,</span><br><span leaf="">+                                      </span><span><span leaf="">'ensembl_transcript_id'</span></span><span leaf="">,</span><br><span leaf="">+                                      </span><span><span leaf="">'hgnc_symbol'</span></span><span leaf="">,</span><br><span leaf="">+                                      </span><span><span leaf="">'uniprotswissprot'</span></span><span leaf="">),</span><br><span leaf="">+                         filters = </span><span><span leaf="">'ensembl_gene_id'</span></span><span leaf="">, </span><br><span leaf="">+                         values = </span><span><span leaf="">'ENSG00000139618'</span></span><span leaf="">, </span><br><span leaf="">+                         mart = ensembl)</span><br><span leaf="">&gt; hgnc_swissprot</span><br><span leaf="">   ensembl_gene_id ensembl_transcript_id hgnc_symbol uniprotswissprot</span><br><span leaf="">1  ENSG00000139618       ENST00000544455       BRCA2           P51587</span><br><span leaf="">2  ENSG00000139618       ENST00000713677       BRCA2                 </span><br><span leaf="">3  ENSG00000139618       ENST00000713678       BRCA2                 </span><br><span leaf="">4  ENSG00000139618       ENST00000530893       BRCA2                 </span><br><span leaf="">5  ENSG00000139618       ENST00000666593       BRCA2                 </span><br><span leaf="">6  ENSG00000139618       ENST00000528762       BRCA2  </span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">上面解释很清楚了</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">拓展 1 : 网页版</span></span><span></span></h2><p data-tool="mdnice编辑器"><code><span leaf="">ensembl</span></code><span leaf="">也提供了网页工具https://www.ensembl.org/biomart/martview，使用原理和 R 包大概一致。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">步骤 1：选择数据库</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">和 R 包中选择 mart 对象一样</span></p><section nodeleaf=""><img data-imgfileid="100050165" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1ustV1VPEPGpaNfbvJ0HkykSIus3hx2neVcUA2vTldpD1N8vQwVxlJe4Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1ustV1VPEPGpaNfbvJ0HkykSIus3hx2neVcUA2vTldpD1N8vQwVxlJe4Q/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">步骤2: 选择查询信息</span></span><span></span></h3><section nodeleaf=""><img data-imgfileid="100050166" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usK6icAOXzicZUa5DTNicKtb8DafxbSGtlIkTQweyjKgSDFh0wJJgfJzLAw/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usK6icAOXzicZUa5DTNicKtb8DafxbSGtlIkTQweyjKgSDFh0wJJgfJzLAw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><p data-tool="mdnice编辑器"><span leaf="">比如我们想知道获取映射到人类 Ensembl 基因 ID "ENSG00000139618" 的 Ensembl 基因、转录本 ID、HGNC 符号及 Uniprot Swissprot 登录号</span></p><section nodeleaf=""><img data-imgfileid="100050170" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usvk8QR6OEETct4c1s6YuU0ASzNwyiazthzX8TbqL0P8LkWd41jypvCTA/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usvk8QR6OEETct4c1s6YuU0ASzNwyiazthzX8TbqL0P8LkWd41jypvCTA/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">步骤 3 ：选择输出信息</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这里和 R 包中attributes 参数功能一致，但名字可能不同。</span></p><section nodeleaf=""><img data-imgfileid="100050171" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1ushpeXfIwJRuvTyytdNGKM6Ep1tib2qdXibX4fHKEjQQW9x92yRoR4z2Mw/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1ushpeXfIwJRuvTyytdNGKM6Ep1tib2qdXibX4fHKEjQQW9x92yRoR4z2Mw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">步骤4: 输出结果</span></span><span></span></h3><section nodeleaf=""><img data-imgfileid="100050172" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usibZTcqzcq45RvdAmEPXJFMKPcjKfI5NxGRouMDPwEzIuU6QHYv4bIjA/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9F5vSCdZSI7rW9FMeAs1usibZTcqzcq45RvdAmEPXJFMKPcjKfI5NxGRouMDPwEzIuU6QHYv4bIjA/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">拓展 2 ：转换基因 ID</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">在 R 中，我们可能需要将 ENSEMBL GENE ID （例：ENSG00000139618）转换为 SYMBOL ID</span></p><p data-tool="mdnice编辑器"><span leaf="">（例：BRCA2）或者ENTREZ ID。那我们是不是可以生成一个的对照表，一列是 ENSEMBL ID，一列是 SYMBOL ID，一列是ENTREZ ID，或者其他。可以根据上述</span><code><span leaf="">attributes参数</span></code><span leaf=""> 看能提取哪些信息。然后我们再去查询转换。</span></p><p data-tool="mdnice编辑器"><span leaf="">这里举例是替换一个counts 数据的 ENSEMBL ID 信息，列明为“name”，具体替换根据需求具体使用。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 获得数据库中关注的 ID 信息</span></span><br><span leaf="">ensembl &lt;- useMart(</span><span><span leaf="">"ensembl"</span></span><span leaf="">, dataset = </span><span><span leaf="">"hsapiens_gene_ensembl"</span></span><span leaf="">)</span><br><span leaf="">ids &lt;- getBM(attributes = c(</span><span><span leaf="">"ensembl_gene_id"</span></span><span leaf="">,</span><br><span leaf="">                            </span><span><span leaf="">"hgnc_symbol"</span></span><span leaf="">,</span><br><span leaf="">                            </span><span><span leaf="">"entrezgene_id"</span></span><span leaf="">),</span><br><span leaf="">             mart = ensembl)</span><br><span><span leaf=""># 修改列名</span></span><br><span leaf="">colnames(ids) &lt;- c(</span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">, </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">, </span><span><span leaf="">"ENTREZ"</span></span><span leaf="">)</span><br><br><span><span leaf=""># 去除重复 ID</span></span><br><span leaf="">ids=ids[!duplicated(ids$ENSEMBL),]</span><br><br><span><span leaf=""># 连接基因 counts 矩阵和 ID 信息 （根据需求使用我们构建的 ids 基因信息查询表）</span></span><br><span leaf="">All_gene_counts &lt;- merge(ensembl_matrix, ids, by.x = </span><span><span leaf="">"name"</span></span><span leaf="">, by.y = </span><span><span leaf="">"ENSEMBL"</span></span><span leaf="">, all.x = </span><span><span leaf="">TRUE</span></span><span leaf="">) %&gt;%</span><br><span leaf="">  dplyr::select(name, SYMBOL, ENTREZ, everything())</span><br></code></pre></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/2iq5t_w6tjOTAMyBzOLR0A",target="_blank" rel="noopener noreferrer">原文链接</a>
