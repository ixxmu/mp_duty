---
title: "玩转参考基因组"
date: 2025-04-14T12:57:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
玩转参考基因组 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">在研究基因序列层面变化的时候，对基因组序列有一个全面的认知及学会怎么对序列基本操作十分重要。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">参考基因组简介</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.1 参考基因组基本格式</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">参考基因组是以 </span><strong><span leaf="">.fa</span></strong><span leaf=""> 结尾的 FASTA 格式文件。以 </span><span leaf="">human</span><span leaf=""> 基因组为例。</span></p><span leaf=""><br></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL10W4Nb3Tvs7alpl4YcYibl170icHARgEqhXnI3I3nwfZTH0iad7WhDe50Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7293333333333333" data-s="300,640" data-type="png" data-w="750" type="block" data-imgfileid="100050039" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL10W4Nb3Tvs7alpl4YcYibl170icHARgEqhXnI3I3nwfZTH0iad7WhDe50Q/640?wx_fmt=png&amp;from=appmsg"></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><span leaf=""><br></span><p data-tool="mdnice编辑器"><span leaf="">在参考基因组中，每一个染色体第一行都是以 “&gt;” 开头的描述序列的头部行（header line），数据库的不同，这里的信息可能略有不同。</span></p><ul><li><section><span leaf="">***</span><code><span leaf="">&gt;</span></code><span leaf="">***：表示这是FASTA格式的头部行。每个序列在FASTA文件中都以这种符号开头的行来描述其信息。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">1</span></code><span leaf="">***：通常表示序列的标识符（ID）。在这种情况下，可能指的是染色体1。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">dna:chromosome</span></code><span leaf="">***：指示序列的类型，这里表示该序列是一个染色体的DNA序列。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">chromosome:GRCh38:1:1:248956422:1</span></code><span leaf="">***：这是一个详细的描述，包含多个信息：</span></section></li><ul><li><section><span leaf="">***</span><code><span leaf="">chromosome</span></code><span leaf="">***：指示这是一个染色体。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">GRCh38</span></code><span leaf="">***：表示使用的是人类基因组的GRCh38版本（Genome Reference Consortium Human Build 38）。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">1</span></code><span leaf="">***：指染色体1。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">1:248956422</span></code><span leaf="">***：表示序列的范围，从位置1到248,956,422，这是染色体1的全长。</span></section></li><li><section><span leaf="">***</span><code><span leaf="">1</span></code><span leaf="">***：可能是指序列的方向或版本信息。</span></section></li></ul><li><section><span leaf="">***</span><code><span leaf="">REF</span></code><span leaf="">***：通常表示这是参考序列（Reference Sequence），用于参考基因组的标准序列。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">第一行以后就是这个染色体的序列了，每行有固定的字符数。可以从头部行看到这个染色体有</span><code><span leaf="">248956422</span></code><span leaf=""> 个碱基。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.2 为什么有那么多的 </span><strong><span leaf="">N</span></strong><span leaf="">，而不是常见的 A T C G 呢？</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">在参考基因组序列中，除了常见的碱基符号A、T、C、G（分别代表腺嘌呤、胸腺嘧啶、胞嘧啶和鸟嘌呤）之外，还可能出现其他符号。这些符号用于表示不确定性或变异。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">N</span></strong><span leaf="">：表示未知碱基。通常用于未测序或不确定的区域。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ grep -v </span><span><span leaf="">"^&gt;"</span></span><span leaf=""> Homo_sapiens.GRCh38.dna.chromosome.1.fa | tr -d </span><span><span leaf="">'\n'</span></span><span leaf=""> | fold -w1 | sort | uniq -c</span><span leaf=""><br></span><span leaf="">67070277 A</span><span leaf=""><br></span><span leaf="">48055043 C</span><span leaf=""><br></span><span leaf="">48111528 G</span><span leaf=""><br></span><span leaf="">18475410 N</span><span leaf=""><br></span><span leaf="">67244164 T</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">可以看到有 </span><code><span leaf="">18475410</span></code><span leaf=""> 个碱基都是没有被测定的， 在1号染色体中占比 7.4% 左右。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.3 染色体 1 序列最后一行是什么样的？</span></span><span></span></h3><span leaf=""><br></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL1ooRNrBheeuGvwiaiaMtqbahy4jicztqoxA6UPImFia3OxicHuaBcOokRrfA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6771653543307087" data-s="300,640" data-type="png" data-w="762" type="block" data-imgfileid="100050040" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL1ooRNrBheeuGvwiaiaMtqbahy4jicztqoxA6UPImFia3OxicHuaBcOokRrfA/640?wx_fmt=png&amp;from=appmsg"></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><span leaf=""><br></span><p data-tool="mdnice编辑器"><span leaf="">可以看到 1 号染色体序列的最后一行是两个 </span><code><span leaf="">N</span></code><span leaf="">字符，接着就是 10 号染色体。</span></p><p data-tool="mdnice编辑器"><span leaf="">因为是按照字符排序的，"1"、"10"、"11"、"2"这样的顺序，所以1 号染色体后就是10 号染色体。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">参考基因组注释文件</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.1 注释文件基本格式</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">参考基因组注释文件提供了关于基因组序列的详细信息，包括基因的位置、功能、转录本、外显子、内含子等。常见的基因组注释文件格式包括GFF（General Feature Format）、GTF（Gene Transfer Format）和BED（Browser Extensible Data）格式。</span></p><p data-tool="mdnice编辑器"><span leaf="">这里以</span><span leaf="">human gtf</span><span leaf="">文件为例。</span></p><span leaf=""><br></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL13FpPumr0iaVNCppxdbFNml6ticBUVJZjWzONBOImqdZgEh39gKQ2gLGQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.32407407407407407" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100050041" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicFOhZVeFyQdzz1yN54kgL13FpPumr0iaVNCppxdbFNml6ticBUVJZjWzONBOImqdZgEh39gKQ2gLGQ/640?wx_fmt=png&amp;from=appmsg"></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><span leaf=""><br></span><p data-tool="mdnice编辑器"><span leaf="">GTF文件由9个字段组成，每个字段用制表符分隔：</span></p><ol><li><section><p><strong><span leaf="">seqname</span></strong><span leaf="">：序列名称，通常是染色体编号（如*</span><code><span leaf="">chr1</span></code><em><span leaf="">、</span></em><code><span leaf="">chrX</span></code><span leaf="">*）或其他序列标识符。</span></p></section></li><li><section><p><strong><span leaf="">source</span></strong><span leaf="">：注释的来源或生成数据的程序（如*</span><code><span leaf="">HAVANA</span></code><em><span leaf="">、</span></em><code><span leaf="">ENSEMBL</span></code><span leaf="">*）。</span></p></section></li><li><section><p><strong><span leaf="">feature</span></strong><span leaf="">：特征类型（如*</span><code><span leaf="">gene</span></code><em><span leaf="">、</span></em><code><span leaf="">transcript</span></code><em><span leaf="">、</span></em><code><span leaf="">exon</span></code><em><span leaf="">、</span></em><code><span leaf="">CDS</span></code><span leaf="">*）。</span></p></section></li><li><section><p><strong><span leaf="">start</span></strong><span leaf="">：特征的起始位置。</span></p></section></li><li><section><p><strong><span leaf="">end</span></strong><span leaf="">：特征的结束位置。</span></p></section></li><li><section><p><strong><span leaf="">score</span></strong><span leaf="">：特征的分数或评价值，通常是*</span><code><span leaf="">.</span></code><span leaf="">*表示无评分。</span></p></section></li><li><section><p><strong><span leaf="">strand</span></strong><span leaf="">：链信息，*</span><code><span leaf="">+</span></code><em><span leaf="">表示正链，</span></em><code><span leaf="">-</span></code><span leaf="">*表示负链。</span></p></section></li><li><section><p><strong><span leaf="">frame</span></strong><span leaf="">：阅读框信息，对于编码序列（CDS）有用，可能为*</span><code><span leaf="">0</span></code><em><span leaf="">、</span></em><code><span leaf="">1</span></code><em><span leaf="">、</span></em><code><span leaf="">2</span></code><em><span leaf="">或</span></em><code><span leaf="">.</span></code><span leaf="">*表示不适用。</span></p></section></li></ol><ul><li><section><strong><span leaf="">0</span></strong><span leaf="">：表示CDS的起始位置正好在密码子边界上。</span></section></li><li><section><strong><span leaf="">1</span></strong><span leaf="">：表示CDS的起始位置在密码子第一个碱基之后。</span></section></li><li><section><strong><span leaf="">2</span></strong><span leaf="">：表示CDS的起始位置在密码子第二个碱基之后。</span></section></li><li><section><span leaf="">**.**：对于非编码特征（如基因、转录本、外显子）或不适用的情况下使用。</span></section></li></ul><li><section><p><strong><span leaf="">attribute</span></strong><span leaf="">：包含键值对的附加信息，通常以分号分隔，例如*</span><code><span leaf="">gene_id "GENE_ID"; transcript_id "TRANSCRIPT_ID";</span></code><span leaf="">*。</span></p></section></li><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.2 注释文件中有哪些特征</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">可以看到第三列为基因组特征。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ awk </span><span><span leaf="">'{print $3}'</span></span><span leaf=""> *gtf | sort | uniq</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">CDS</span><span leaf=""><br></span><span leaf="">Selenocysteine</span><span leaf=""><br></span><span leaf="">exon</span><span leaf=""><br></span><span leaf="">five_prime_utr</span><span leaf=""><br></span><span leaf="">gene</span><span leaf=""><br></span><span leaf="">start_codon</span><span leaf=""><br></span><span leaf="">stop_codon</span><span leaf=""><br></span><span leaf="">three_prime_utr</span><span leaf=""><br></span><span leaf="">transcript</span><span leaf=""><br></span></code></pre><ol><li><section><span leaf="">**CDS (Coding Sequence)**：</span></section></li></ol><ul><li><section><span leaf="">表示编码序列，是基因的一部分，包含从起始密码子到终止密码子的核苷酸序列，翻译成蛋白质。</span></section></li></ul><li><section><strong><span leaf="">Selenocysteine</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">是一种特殊的氨基酸，由UGA密码子编码，通常作为终止密码子，但在特定情况下编码硒半胱氨酸。</span></section></li></ul><li><section><strong><span leaf="">Exon</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">外显子是基因的一部分，在转录后保留在成熟的mRNA中。外显子可能包含编码序列和非编码序列。</span></section></li></ul><li><section><span leaf="">**Five_prime_utr (5' UTR)**：</span></section></li><ul><li><section><span leaf="">5'非翻译区是mRNA的起始部分，在编码序列之前。它不编码蛋白质，但在调节翻译中发挥重要作用。</span></section></li></ul><li><section><strong><span leaf="">Gene</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">是遗传信息的基本单位，包含编码序列和调控序列，负责控制特定性状或功能。</span></section></li></ul><li><section><strong><span leaf="">Start_codon</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">起始密码子是mRNA翻译起始的信号，通常是AUG，编码氨基酸甲硫氨酸。</span></section></li></ul><li><section><strong><span leaf="">Stop_codon</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">终止密码子是翻译终止的信号，通常为UAA、UAG或UGA，不编码任何氨基酸。</span></section></li></ul><li><section><span leaf="">**Three_prime_utr (3' UTR)**：</span></section></li><ul><li><section><span leaf="">3'非翻译区是mRNA的末端部分，在编码序列之后。它在调节mRNA的稳定性和翻译效率中起作用。</span></section></li></ul><li><section><strong><span leaf="">Transcript</span></strong><span leaf="">：</span></section></li><ul><li><section><span leaf="">转录本是基因转录的产物，包括所有外显子和内含子，在剪接后形成成熟mRNA。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.3 一个基因的完整信息应该怎么解读？</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">举例</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">chr1  example  gene          1000  5000  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  transcript    1000  5000  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  exon          1000  1200  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  exon          1500  1700  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  exon          2000  2400  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  five_prime_utr 1000 1099  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  CDS           1100  1200  .  +  0  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  CDS           1500  1700  .  +  2  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  CDS           2000  2300  .  +  0  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span><span leaf="">chr1  example  three_prime_utr 2301 2400  .  +  .  gene_id </span><span><span leaf="">"gene1"</span></span><span leaf="">; transcript_id </span><span><span leaf="">"transcript1"</span></span><span leaf="">;</span><span leaf=""><br></span></code></pre><ul><li><section><strong><span leaf="">Gene</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">chr1 example gene 1000 5000 . + . gene_id "gene1";</span></code></em></section></li><li><section><span leaf="">表示基因的范围，从位置1000到5000。</span></section></li></ul><li><section><strong><span leaf="">Transcript</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">chr1 example transcript 1000 5000 . + . gene_id "gene1"; transcript_id "transcript1";</span></code></em></section></li><li><section><span leaf="">表示转录本的范围，与基因范围相同。</span></section></li></ul><li><section><strong><span leaf="">Exon</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">1000-1200</span></code></em></section></li><li><section><em><code><span leaf="">1500-1700</span></code></em></section></li><li><section><em><code><span leaf="">2000-2400</span></code></em></section></li></ul><ul><li><section><span leaf="">三个外显子分别位于：</span></section></li></ul><li><section><strong><span leaf="">5' UTR</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">chr1 example five_prime_utr 1000 1099 . + . gene_id "gene1"; transcript_id "transcript1";</span></code></em></section></li><li><section><span leaf="">在转录本的起始部分，不被翻译。</span></section></li></ul><li><section><strong><span leaf="">CDS</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">1100-1200</span></code></em></section></li><li><section><em><code><span leaf="">1500-1700</span></code></em></section></li><li><section><em><code><span leaf="">2000-2300</span></code></em></section></li></ul><ul><li><section><span leaf="">编码序列分布在：</span></section></li><li><section><span leaf="">这些区域将被翻译成蛋白质。</span></section></li></ul><li><section><strong><span leaf="">3' UTR</span></strong><span leaf="">:</span></section></li><ul><li><section><em><code><span leaf="">chr1 example three_prime_utr 2301 2400 . + . gene_id "gene1"; transcript_id "transcript1";</span></code></em></section></li><li><section><span leaf="">在转录本的末端部分，不被翻译。</span></section></li></ul></ul><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.4 如何在不同参考基因组版本之间转换注释坐标</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">可以明白，这种基于起始位置和终止位置的注释文件，如果参考基因组的版本更迭，将不再准确，最方便的方法是下载最新的版本，但如果你有特殊的需求，也可以进行“坐标转换”，有网页和工具能实现这个功能。</span></p><ul><li><section><span leaf="">liftOver</span></section></li><li><section><span leaf="">CrossMap</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">参考基因组索引</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">3.1 参考基因组索引简介</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">参考基因组索引被称为基因组目录，为 FAI 格式文件，通常由 </span><em><code><span leaf="">samtools faidx</span></code></em><span leaf=""> 命令生成。FAI 文件用于快速访问大型 FASTA 文件中的特定序列。它的每一行对应于 FASTA 文件中的一个序列，包含以下列信息：</span></p><ol><li><section><strong><span leaf="">序列名称</span></strong><span leaf="">：对应于 FASTA 文件中序列的名称（即 </span><em><code><span leaf="">&gt;</span></code></em><span leaf=""> 后的部分）。</span></section></li><li><section><strong><span leaf="">序列长度</span></strong><span leaf="">：该序列的碱基总数。</span></section></li><li><section><strong><span leaf="">偏移量</span></strong><span leaf="">：该序列在 FASTA 文件中的起始字节位置。这是该序列在文件中的起始位置，以字节为单位。</span></section></li><li><section><strong><span leaf="">行长度</span></strong><span leaf="">：FASTA 文件中每一行的字符数（不包括换行符）。</span></section></li><li><section><strong><span leaf="">行总长度</span></strong><span leaf="">：FASTA 文件中每一行的字符总数（包括换行符）。</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">对于</span><strong><span leaf="">偏移量</span></strong><span leaf="">，这里举例说明：</span></p><p data-tool="mdnice编辑器"><span leaf="">假设有一个 FASTA 文件 *</span><code><span leaf="">example.fasta</span></code><span leaf="">*，内容如下：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt;chr1</span><span leaf=""><br></span><span leaf="">AGCTTAGCTA</span><span leaf=""><br></span><span leaf="">GCTAGCTAGC</span><span leaf=""><br></span><span leaf="">&gt;chr2</span><span leaf=""><br></span><span leaf="">CGTAGCTAGC</span><span leaf=""><br></span><span leaf="">TAGCTAGCTA</span><span leaf=""><br></span><span leaf="">CCT</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">使用 </span><em><code><span leaf="">samtools faidx</span></code></em><span leaf=""> 创建的索引文件 </span><em><code><span leaf="">fasta.fai</span></code></em><span leaf=""> 可能会是这样的：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">chr1    20      6       10      11</span><span leaf=""><br></span><span leaf="">chr2    23      34      10      11</span><span leaf=""><br></span></code></pre><ul><li><section><strong><span leaf="">chr1 的偏移量（6）</span></strong><span leaf="">：</span></section></li><ul><li><section><em><code><span leaf="">&gt;</span></code></em><span leaf=""> 和 </span><em><code><span leaf="">chr1</span></code></em><span leaf=""> 占用 5 个字节。</span></section></li><li><section><span leaf="">第一个换行符占用 1 个字节。</span></section></li><li><section><span leaf="">因此，*</span><code><span leaf="">chr1</span></code><span leaf="">* 的序列数据开始于第 6 个字节。</span></section></li></ul><li><section><strong><span leaf="">chr2 的偏移量（34）</span></strong><span leaf="">：</span></section></li><ul><li><section><em><code><span leaf="">chr1</span></code></em><span leaf=""> 的序列数据占用 20 个字节（两行，每行 10 个字符）。</span></section></li><li><section><span leaf="">两个换行符（每行末尾一个）占用 2 个字节。</span></section></li><li><section><em><code><span leaf="">&gt;chr2</span></code></em><span leaf=""> 占用 5 个字节。</span></section></li><li><section><span leaf="">换行符占用 1 个字节。</span></section></li><li><section><span leaf="">因此，*</span><code><span leaf="">chr2</span></code><span leaf="">* 的序列数据开始于第 34 个字节（6 + 20 + 2 + 6 = 34）。</span></section></li></ul></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">快速了解自己的参考基因组</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.1 查看参考基因组大小</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这里强烈推荐</span><span leaf="">SeqKit</span><span leaf="">工具。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ seqkit </span><span><span leaf="">stat</span></span><span leaf=""> Homo_sapiens.GRCh38.dna.primary_assembly.fa</span><span leaf=""><br></span><span leaf="">file                                         format  </span><span><span leaf="">type</span></span><span leaf="">  num_seqs        sum_len  min_len       avg_len      max_len</span><span leaf=""><br></span><span leaf="">Homo_sapiens.GRCh38.dna.primary_assembly.fa  FASTA   DNA        194  3,099,750,718      970  15,978,096.5  248,956,422</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.2 有多少个染色体</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># Ensemble GRCh38 为例，统计染色体数。（结果为22+X+Y+MT=25</span></span><span leaf=""><br></span><span leaf="">$ cat *.fa | grep </span><span><span leaf="">"&gt;*chromosome*"</span></span><span leaf=""> | wc -l</span><span leaf=""><br></span><span leaf="">25</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.3 每个染色体的长度</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">可通过samtools faidx命令获取每个染色体的长度。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">samtools faidx *.fa</span><span leaf=""><br></span><span leaf="">cat *.fa.fai</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">4.4 参考基因组注释类型查看</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ cat *.gtf | grep -v </span><span><span leaf="">"#"</span></span><span leaf=""> | cut -f3 | sort | uniq -c</span><span leaf=""><br></span><span leaf=""> 899302 CDS</span><span leaf=""><br></span><span leaf="">    130 Selenocysteine</span><span leaf=""><br></span><span leaf="">1668828 exon</span><span leaf=""><br></span><span leaf=""> 175449 five_prime_utr</span><span leaf=""><br></span><span leaf="">  63140 gene</span><span leaf=""><br></span><span leaf="">  98967 start_codon</span><span leaf=""><br></span><span leaf="">  92935 stop_codon</span><span leaf=""><br></span><span leaf=""> 211674 three_prime_utr</span><span leaf=""><br></span><span leaf=""> 254129 transcript</span><span leaf=""><br></span></code></pre><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">从参考基因组中提取关注序列</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">5.1 使用samtools 工具</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 提取整个染色体序列</span></span><span leaf=""><br></span><span leaf="">samtools faidx Homo_sapiens.GRCh38.dna.primary_assembly.fa 1 &gt; chr1.fa</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 提取染色体1上1000-2000的位置</span></span><span leaf=""><br></span><span leaf="">samtools faidx Homo_sapiens.GRCh38.dna.primary_assembly.fa 1:1000-2000 &gt; sequence.fa</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">5.2 使用 bedtools 工具</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这里我们先有一个</span><code><span leaf="">bed</span></code><span leaf=""> 格式文件命名为 </span><code><span leaf="">foo.bed</span></code></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">1       2581559 2584533 gene</span><span leaf=""><br></span><span leaf="">1       2581559 2584533 transcript</span><span leaf=""><br></span><span leaf="">1       2581559 2581650 exon</span><span leaf=""><br></span><span leaf="">1       2583369 2583495 exon</span><span leaf=""><br></span><span leaf="">1       2584124 2584533 exon</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">bedtools getfasta -</span><span><span leaf="">fi</span></span><span leaf=""> Homo_sapiens.GRCh38.dna.primary_assembly.fa -bed foo.bed -fo output.fa</span><span leaf=""><br></span></code></pre><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">拓展 ：bio</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">bio </span><span leaf="">是一个非常优秀的软件，在获取基因的序列等方面极大的简化了步骤，这里演示一下获取fa数据的能力。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">6.1 从 GeneBank 获取 fa 数据</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ bio fetch NC_045512 --format fasta  | head -3</span><span leaf=""><br></span><span leaf="">&gt;NC_045512.2 Severe acute respiratory syndrome coronavirus 2 isolate Wuhan-Hu-1, complete genome</span><span leaf=""><br></span><span leaf="">ATTAAAGGTTTATACCTTCCCAGGTAACAAACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCTAAA</span><span leaf=""><br></span><span leaf="">CGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATAAC</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">6.2 从GeneBank 获取 gtf 数据</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">$ bio fetch NC_045512 --format gff  | head -7</span><span leaf=""><br></span><span><span leaf="">##gff-version 3</span></span><span leaf=""><br></span><span><span leaf="">#!gff-spec-version 1.21</span></span><span leaf=""><br></span><span><span leaf="">#!processor NCBI annotwriter</span></span><span leaf=""><br></span><span><span leaf="">##sequence-region NC_045512.2 1 29903</span></span><span leaf=""><br></span><span><span leaf="">##species https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=2697049</span></span><span leaf=""><br></span><span leaf="">NC_045512.2     RefSeq  region  1       29903   .       +       .       ID=NC_045512.2:1..29903;Dbxref=taxon:2697049;collection-date=Dec-2019;country=China;gb-acronym=SARS-CoV-2;gbkey=Src;genome=genomic;isolate=Wuhan-Hu-1;mol_type=genomic RNA;nat-host=Homo sapiens;old-name=Wuhan seafood market pneumonia virus</span><span leaf=""><br></span><span leaf="">NC_045512.2     RefSeq  five_prime_UTR  1       265     .       +       .       ID=id-NC_045512.2:1..265;gbkey=5</span><span><span leaf="">'UTR</span><span leaf=""><br></span></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">6.3 从 Ensembl 获取数据</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 获取cdna数据</span></span><span leaf=""><br></span><span leaf="">bio fetch ENST00000288602 --</span><span><span leaf="">type</span></span><span leaf=""> cdna</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 获取cds数据</span></span><span leaf=""><br></span><span leaf="">bio fetch ENST00000288602 --</span><span><span leaf="">type</span></span><span leaf=""> cds</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 获取蛋白数据</span></span><span leaf=""><br></span><span leaf="">bio fetch ENST00000288602 --</span><span><span leaf="">type</span></span><span leaf=""> protein</span><span leaf=""><br></span></code></pre></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/oagZqvCDqAe8h10EXn6W6Q",target="_blank" rel="noopener noreferrer">原文链接</a>
