---
title: "æ–¯å¦ç¦å¤§å­¦Nature ï½œå•ç»†èƒæµ‹åº ç¥ç»é¢†åŸŸç±»å™¨å®˜"
date: 2025-04-10T01:24:29Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡é’±åŒå­¦"
]
categories: ["Acdemic"]
---
æ–¯å¦ç¦å¤§å­¦Nature ï½œå•ç»†èƒæµ‹åº ç¥ç»é¢†åŸŸç±»å™¨å®˜ by ç”Ÿä¿¡é’±åŒå­¦
------
<div><p data-pm-slice="0 0 []"><span data-token-index="0"><span data-token-index="0" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">æ„å»ºäººç±»ä¸Šå‡ç¥ç»æ„Ÿè§‰é€šè·¯ç±»ç»„è£…ä½“æ¨¡å‹ï¼Œä¸ºç¥ç»ç³»ç»Ÿç ”ç©¶å¸¦æ¥æ–°çªç ´</span></span></span></span></p><section nodeleaf=""><img data-imgfileid="100009328" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgapAYLF44N3xrGrIS8yuNrV0CSm8Akk1lcWL8QiacCWzekpLjTvsg7Jg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgapAYLF44N3xrGrIS8yuNrV0CSm8Akk1lcWL8QiacCWzekpLjTvsg7Jg/640?wx_fmt=jpeg&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">è¿‘æ—¥ï¼Œä¸€é¡¹æ¥è‡ªæ–¯å¦ç¦å¤§å­¦å‘è¡¨äºã€ŠNatureã€‹æ‚å¿—çš„ç ”ç©¶æˆåŠŸæ„å»ºäº†äººç±»ä¸Šå‡ä½“æ„Ÿç±»ç»„è£…ä½“ï¼ˆhASAï¼‰ï¼Œ</span></span></span><span leaf=""><span textstyle="">è¿™ä¸€åˆ›æ–°æ¨¡å‹ä¸ºç ”ç©¶äººç±»æ„Ÿè§‰é€šè·¯çš„ç»„è£…æœºåˆ¶ä»¥åŠå¼€å‘ç–¼ç—›æ²»ç–—æ–¹æ³•æä¾›äº†å…¨æ–°çš„è§†è§’å’Œæœ‰åŠ›å·¥å…·ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100009322" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBg9IfJ2qmFdjlzAZ0QBZW19u7L38E9AwIseuWlVEOP0RJKE1YK5FRf8w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBg9IfJ2qmFdjlzAZ0QBZW19u7L38E9AwIseuWlVEOP0RJKE1YK5FRf8w/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">äººä½“çš„ä½“æ„Ÿé€šè·¯è´Ÿè´£å°†ç–¼ç—›ã€è§¦è§‰ã€ç˜™ç—’å’Œèº«ä½“éƒ¨ä½è¿åŠ¨ç­‰å…³é”®ä¿¡æ¯ä»å¤–å‘¨å™¨å®˜ä¼ é€’åˆ°ä¸­æ¢ç¥ç»ç³»ç»Ÿã€‚è¿™ä¸€é€šè·¯çš„æ­£å¸¸è¿ä½œå¯¹äºäººä½“æ„ŸçŸ¥å¤–ç•Œç¯å¢ƒå’Œç»´æŒç”Ÿç†å¹³è¡¡è‡³å…³é‡è¦ã€‚</span></span><span data-token-index="1"><span leaf=""><span textstyle="">ç„¶è€Œï¼Œç›®å‰æˆ‘ä»¬å¯¹è¿™äº›é€šè·¯åœ¨äººç±»å‘è‚²è¿‡ç¨‹ä¸­çš„å½¢æˆæœºåˆ¶ï¼Œä»¥åŠåœ¨ç—…ç†æ¡ä»¶ä¸‹åŠŸèƒ½ç¼ºé™·çš„äº§ç”ŸåŸå› ä»çŸ¥ä¹‹ç”šå°‘ã€‚</span></span></span><span leaf=""><span textstyle="">åŒæ—¶ï¼Œç”±äºç‰©ç§ç‰¹å¼‚æ€§ç‰¹å¾ä»¥åŠç¼ºä¹ä½“å¤–å¤šçªè§¦é€šè·¯æ¨¡å‹ï¼Œç–¼ç—›å’Œæ„Ÿè§‰ç ”ç©¶çš„ä¸´åºŠè½¬åŒ–é¢ä¸´ç€é‡é‡æŒ‘æˆ˜ã€‚æ­¤å‰ï¼Œè™½ç„¶åœ¨ç±»å™¨å®˜å’Œç±»ç»„è£…ä½“æŠ€æœ¯æ–¹é¢å–å¾—äº†ä¸€äº›è¿›å±•ï¼Œä½†èƒ½å¤Ÿæ¨¡æ‹Ÿäººç±»ä½“æ„Ÿä¸Šå‡é€šè·¯çš„å¤šåŒºåŸŸç±»ç»„è£…ä½“æ¨¡å‹å°šæœªæˆåŠŸæ„å»ºã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100009323" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgwy9NqyGu8fvrTWL8wauv0jiauRcgFGmqVM3JGDL5voxB6TPdaicpNa9g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgwy9NqyGu8fvrTWL8wauv0jiauRcgFGmqVM3JGDL5voxB6TPdaicpNa9g/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009318" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgkVxAOltLoDwiapLCjAI9IRK26jU57TJ0mcdd80jXiax4Eu5HypNyHoPg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgkVxAOltLoDwiapLCjAI9IRK26jU57TJ0mcdd80jXiax4Eu5HypNyHoPg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009324" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgQLribC7Vq7PZLLp4VYyofUrAmNCRhabnxzzA6umMQvSJhtWmnrW132Q/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgQLribC7Vq7PZLLp4VYyofUrAmNCRhabnxzzA6umMQvSJhtWmnrW132Q/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009319" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgCKhqPJL6AtseTvsgEndS7xlWjribjyWzmFIzMOrOlLe41RibRe2pib0Hg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgCKhqPJL6AtseTvsgEndS7xlWjribjyWzmFIzMOrOlLe41RibRe2pib0Hg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009325" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgIvKo0x6jcKv5WrakqxnFQ7h6xH3JsYH41YRrmaL6nbYOibCZUJYtD1Q/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgIvKo0x6jcKv5WrakqxnFQ7h6xH3JsYH41YRrmaL6nbYOibCZUJYtD1Q/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009320" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgdl0wDCg957dOteLUwy2REcfAQz2oicrLib9IXKkgdwS2n1uY6FcHTVHg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgdl0wDCg957dOteLUwy2REcfAQz2oicrLib9IXKkgdwS2n1uY6FcHTVHg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009326" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgxpu2Yqolrw1t7O6icA3VInl3TmuDjzaeAQbiakfetFTnV3gds04tHgHw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgxpu2Yqolrw1t7O6icA3VInl3TmuDjzaeAQbiakfetFTnV3gds04tHgHw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009321" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgqIacrRBV3TLuQiaYjaeIW62vLDT1TzNz9S1Z6GZft344uxES0Pu2v6w/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgqIacrRBV3TLuQiaYjaeIW62vLDT1TzNz9S1Z6GZft344uxES0Pu2v6w/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009327" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgZznuQFkXgdIbJNBA19l3KcILwkVydZL7rcYwELibyXLae7ZRIXHQ4Hg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvrqpHdfguWbGJnWrmPPWBgZznuQFkXgdIbJNBA19l3KcILwkVydZL7rcYwELibyXLae7ZRIXHQ4Hg/640?wx_fmt=jpeg&amp;from=appmsg"></section><section data-role="outer" label="Powered by 135editor.com onekey" data-pm-slice="0 0 []"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p data-brushtype="text"><strong><strong><strong><span data-pm-slice="0 0 []"><span leaf="">Kim, Ji., Imaizumi, K., JurjuÈ›, O.Â </span><i><span leaf="">et al.</span></i><span><span leaf="">Â Human assembloid model of the ascending neural sensory pathway.Â </span></span><i><span leaf="">Nature</span></i><span><span leaf="">Â (2025)</span></span></span></strong></strong></strong></p><p data-brushtype="text"><strong><strong><strong><span leaf="">åè‹”â†©ï¸ä¹‹å‰è´´å­çš„å²¸å·å³å¯éœå¾—ä¹‹å‰çš„</span></strong></strong></strong></p><p data-brushtype="text"><strong><strong><strong><strong data-pm-slice="0 0 []"><span leaf="">ä»£ç ï¼Œä»Šæ—¥å…³é”®è¯ï¼š250410</span></strong></strong></strong></strong></p></section></section></section></section></section></section></section><section data-pm-slice="0 0 []"><strong><strong><strong><span leaf=""><span textstyle="">åŸºç¡€ã€å•ç»†èƒã€ç©ºé—´å„ä¸“é¢˜ç­ï¼Œæƒ³ç³»ç»Ÿæ€§å­¦ä¹ å¯ä»¥çœ‹ä¸‹è¿™ä¸ªğŸ‘‡</span></span></strong></strong></strong><span><span leaf=""><br></span></span><section><span leaf=""><br></span></section><span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" textvalue="ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·</span></a></span><strong><span><span leaf=""><br></span><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img alt="å›¾ç‰‡" data-ratio="0.5990740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></a></span></strong></span></section><p><span><strong><span><span leaf="">æœ‰å•ç»†èƒæ•°æ®åˆ†æéœ€æ±‚çš„å¯ä»¥çœ‹</span><strong><strong><span leaf="">ğŸ‘‡è¿™ä¸ªæ–‡ç« </span></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span><strong><strong></strong></strong></span></strong><strong><strong><strong><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247490275&amp;idx=1&amp;sn=200ccc0a415860f9d73b9068657096ff&amp;scene=21#wechat_redirect" textvalue="æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš</a>ï¼ˆè¿‘æœŸåˆæ·»åŠ äº†21 å¹´å‘è¡¨åœ¨äº† Cellä¸Šé¢çš„å•ç»†èƒè½¬å½•ç»„åˆ†æä»£è°¢çš„åˆ†æâ€”â€”compassï¼‰</span></strong></strong></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf=""><br></span></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf="">æˆ‘ä»¬ç›®å‰ä¸»è¦çš„åˆ†æå†…å®¹çœ‹ğŸ‘‡ï¼ˆè¿™æ¬¡çš„æ˜¯å¯¹ä¸Šæ¬¡å†…å®¹çš„è¡¥å…… scBCRå’Œ sc-TCRäº†ï¼‰<a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247492253&amp;idx=1&amp;sn=da8477aa80c485e7cfd12862047cd30b&amp;scene=21#wechat_redirect" textvalue="é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš</a></span></strong></strong></strong></span></strong></span></p><section data-pm-slice="0 0 []"><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247492768&amp;idx=1&amp;sn=f2b180496f982a5f912df2b66c5229a3&amp;scene=21#wechat_redirect" textvalue="æ¯å¤©å¥½æ–‡ç« å¤ªå¤šäº†ï¼Œå…¬ä¼—å·åˆ†äº«ä¸å®Œï¼Œæ‰“ç®—å»ºä¸ªå­¦ä¹ ç¾¤ï¼Œç›¸äº’äº¤æµç”Ÿä¿¡" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">æ¯å¤©å¥½æ–‡ç« å¤ªå¤šäº†ï¼Œå…¬ä¼—å·åˆ†äº«ä¸å®Œï¼Œæ‰“ç®—å»ºä¸ªå­¦ä¹ ç¾¤ï¼Œç›¸äº’äº¤æµç”Ÿä¿¡</span></a><span textstyle="">ï¼ˆåœ¨è¿™ä½ èƒ½æ¯å¤©å­¦åˆ°æœ‰å…³ç”Ÿä¿¡çš„å‰æ²¿æ–‡çŒ®ï¼Œæˆ‘ä»¬ä¼šæŠŠæœ€å¥½çš„æ–‡çŒ®å®æ—¶åˆ†äº«ç»™å¤§å®¶ï¼Œä»¥åŠç¾¤å†…å°ä¼™ä¼´ä»¬èƒ½å¤Ÿç›¸äº’åä½œï¼Œå…±åŒè§£å†³ä¸€äº›ç”Ÿä¿¡ä¸Šçš„é—®é¢˜ï¼‰</span></span></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009235" data-ratio="0.7675925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFsibBaljqp0Dsw1tuk0Ruqt9sUhyQv0ah7cUU5IoQ54b6Sfxiag6uTcdLicRicicoFSz8JpEfxtVaBHHSg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFsibBaljqp0Dsw1tuk0Ruqt9sUhyQv0ah7cUU5IoQ54b6Sfxiag6uTcdLicRicicoFSz8JpEfxtVaBHHSg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009257" data-ratio="1.3796296296296295" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFszqd8cpAAQELtsicOAkDzFGKkdR7FwS0Ons1vnuibw3dyLtcMqbtL1MnwpPd1qdfuqb7yWXsic7jicIw/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFszqd8cpAAQELtsicOAkDzFGKkdR7FwS0Ons1vnuibw3dyLtcMqbtL1MnwpPd1qdfuqb7yWXsic7jicIw/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span leaf=""><span>import</span>Â pandasÂ <span>as</span>Â pd</span></code><code><span leaf=""><span>import</span>Â numpyÂ <span>as</span>Â np</span></code><code><span leaf=""><span>import</span>Â matplotlib.pyplotÂ <span>as</span>Â plt</span></code><code><span leaf=""><span>import</span>Â matplotlibÂ <span>as</span>Â mpl</span></code><code><span leaf=""><span>from</span>Â matplotlib.patchesÂ <span>import</span>Â Arc</span></code><code><span leaf=""><span>import</span>Â networkxÂ <span>as</span>Â nx</span></code><code><span leaf=""><span># å¼€å¯äº¤äº’æ¨¡å¼ï¼Œå…è®¸åœ¨ç»˜å›¾åç»§ç»­æ‰§è¡Œä»£ç </span></span></code><code><span leaf="">plt.ion()</span></code><code><span leaf=""><span>def</span>Â <span>draw_semicircle</span>(<span>x1, y1, x2, y2, color=</span><span><span>'black'</span></span><span>, lw=</span><span><span>1</span></span><span>, ax=</span><span><span>None</span></span>):</span></code><code><span leaf="">Â  Â Â <span>'''</span></span></code><code><span leaf="">Â  Â  ç»˜åˆ¶ä»ç‚¹ (x1, y1) åˆ°ç‚¹ (x2, y2) çš„åœ†å¼§</span></code><code><span leaf="">Â  Â  è¯¥åœ†å¼§ç»˜åˆ¶åœ¨ä»¥ (0, 0) ä¸ºåœ†å¿ƒçš„åœ†ä¸Šï¼Œä½äºçº¿æ®µ ((x1, y1), (x2, y2)) çš„å³ä¾§</span></code><code><span leaf="">Â  Â  '''</span></code><code><span leaf="">Â  Â Â <span># å¦‚æœæ²¡æœ‰ä¼ å…¥åæ ‡è½´å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨å½“å‰æ´»åŠ¨çš„åæ ‡è½´</span></span></code><code><span leaf="">Â  Â  ax = axÂ <span>or</span>Â plt.gca()</span></code><code><span leaf="">Â  Â Â <span># è®¡ç®—ç›´å¾„ï¼Œä½¿ç”¨æ¬§å‡ é‡Œå¾—è·ç¦»</span></span></code><code><span leaf="">Â  Â  diameter =Â <span>2</span>Â * np.sqrt(x1 **Â <span>2</span>Â + y1 **Â <span>2</span>)</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ åœ†å¼§åˆ°åæ ‡è½´</span></span></code><code><span leaf="">Â  Â  ax.add_patch(Arc((<span>0</span>,Â <span>0</span>), diameter, diameter, theta1=np.degrees(np.arctan2(y1,x1)), theta2=np.degrees(np.arctan2(y2,x2)),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â edgecolor=color, facecolor=<span>'none'</span>, lw=lw, zorder=<span>0</span>, capstyle=<span>'round'</span>))</span></code><code><span leaf=""><span># è®¾ç½®æ–‡ä»¶è·¯å¾„</span></span></code><code><span leaf="">basic_analysis_file =Â <span>r'path'</span></span></code><code><span leaf="">sca_analysis_file =Â <span>r'path'</span></span></code><code><span leaf="">save_fig_path =Â <span>r'path'</span></span></code><code><span leaf=""><span># è®¾ç½®ä¸€äº›å‚æ•°</span></span></code><code><span leaf=""><span># ç”¨äºç¼©æ”¾çš„å›ºå®šæœ€å¤§ç›¸å…³å€¼</span></span></code><code><span leaf="">fixed_max_correlation_for_scale =Â <span>1</span></span></code><code><span leaf=""><span># çº¿æ¡çš„æœ€å¤§å®½åº¦</span></span></code><code><span leaf="">max_line_width =Â <span>24</span></span></code><code><span leaf=""><span># å›¾ä¾‹ä¸­æ˜¾ç¤ºçš„ firing rate å€¼ï¼ˆå•ä½ï¼šHzï¼‰</span></span></code><code><span leaf="">firing_rates_for_legend = np.array([<span>1.5</span>,Â <span>0.5</span>])</span></code><code><span leaf=""><span># ç»˜å›¾çš„ç¼©æ”¾å› å­</span></span></code><code><span leaf="">plot_scale_factor =Â <span>1.8</span></span></code><code><span leaf=""><span># ç»˜å›¾çš„æ–¹å‘ï¼Œå¯é€‰ 'diagonal' æˆ– 'cardinal'</span></span></code><code><span leaf="">plot_orientation =Â <span>'diagonal'</span>Â Â <span># ['diagonal','cardinal']</span></span></code><code><span leaf=""><span># ç”¨äºåˆ†ç»„çš„åˆ—å</span></span></code><code><span leaf="">grouping_column =Â <span>'Genotype'</span></span></code><code><span leaf=""><span># è®¾ç½®åŒºåŸŸçš„é¡ºåºå’Œé¢œè‰²</span></span></code><code><span leaf=""><span># å”¯ä¸€çš„åŒºåŸŸåˆ—è¡¨</span></span></code><code><span leaf="">uniq_regions = [<span>'hCO'</span>,Â <span>'hStrO'</span>,Â <span>'hMeO'</span>,Â <span>'hDiO'</span>]</span></code><code><span leaf=""><span># åŒºåŸŸå¯¹åˆ—è¡¨ï¼Œå°†æ¯ä¸ªåŒºåŸŸä¸ä¸‹ä¸€ä¸ªåŒºåŸŸé…å¯¹ï¼Œæœ€åä¸€ä¸ªåŒºåŸŸä¸ç¬¬ä¸€ä¸ªåŒºåŸŸé…å¯¹</span></span></code><code><span leaf="">region_pairs =Â <span>list</span>(<span>zip</span>(uniq_regions, uniq_regions[<span>1</span>:] + [uniq_regions[<span>0</span>]]))</span></code><code><span leaf=""><span>if</span>Â plot_orientation ==Â <span>'diagonal'</span>:</span></code><code><span leaf="">Â  Â Â <span># å¯¹è§’çº¿æ–¹å‘çš„èŠ‚ç‚¹ä½ç½®</span></span></code><code><span leaf="">Â  Â  node_pos = {<span>'hCO'</span>: np.array([-<span>0.7</span>,Â <span>0.7</span>]),Â <span>'hStrO'</span>: np.array([-<span>0.7</span>, -<span>0.7</span>]),Â <span>'hMeO'</span>: np.array([<span>0.7</span>, -<span>0.7</span>]),Â <span>'hDiO'</span>: np.array([<span>0.7</span>,Â <span>0.7</span>])}</span></code><code><span leaf=""><span>elif</span>Â plot_orientation ==Â <span>'cardinal'</span>:</span></code><code><span leaf="">Â  Â Â <span># åŸºæœ¬æ–¹å‘ï¼ˆä¸Šä¸‹å·¦å³ï¼‰çš„èŠ‚ç‚¹ä½ç½®</span></span></code><code><span leaf="">Â  Â  node_pos = {<span>'hCO'</span>: np.array([<span>0</span>,Â <span>1</span>]),Â <span>'hStrO'</span>: np.array([-<span>1</span>,Â <span>0</span>]),Â <span>'hMeO'</span>: np.array([<span>0</span>, -<span>1</span>]),Â <span>'hDiO'</span>: np.array([<span>1</span>,Â <span>0</span>])}</span></code><code><span leaf=""><span># è·å–é¢œè‰²æ˜ å°„</span></span></code><code><span leaf="">cmap = mpl.colormaps[<span>'tab10'</span>]</span></code><code><span leaf=""><span># ä¸ºæ¯ä¸ªåŒºåŸŸè®¾ç½®é¢œè‰²</span></span></code><code><span leaf="">node_colors = {<span>'hCO'</span>: cmap(<span>1</span>),Â <span>'hStrO'</span>: cmap(<span>0</span>),Â <span>'hMeO'</span>: cmap(<span>2</span>),Â <span>'hDiO'</span>: cmap(<span>3</span>)}</span></code><code><span leaf=""><span># è·å–ç°åº¦é¢œè‰²æ˜ å°„</span></span></code><code><span leaf="">grey_cmap = mpl.colormaps[<span>'Greys'</span>]</span></code><code><span leaf=""><span># æ˜¯å¦ä¿å­˜å›¾å½¢</span></span></code><code><span leaf="">save_figures =Â <span>True</span></span></code><code><span leaf=""><span># ä¸ºæ¯ä¸ªåˆ†ç»„ï¼ˆè¿™é‡Œæ˜¯å¹´é¾„ç»„ï¼‰ç»˜åˆ¶å›¾å½¢</span></span></code><code><span leaf=""><span># è¯»å–åŸºæœ¬åˆ†ææ–‡ä»¶</span></span></code><code><span leaf="">xls_basics = pd.ExcelFile(basic_analysis_file)</span></code><code><span leaf=""><span># è¯»å– SCA åˆ†ææ–‡ä»¶</span></span></code><code><span leaf="">xls_cch = pd.ExcelFile(sca_analysis_file)</span></code><code><span leaf=""><span># è·å–åˆ†ç»„çš„å”¯ä¸€å€¼</span></span></code><code><span leaf="">groups = pd.read_excel(xls_basics)[grouping_column].unique()</span></code><code><span leaf=""><span>for</span>Â groupÂ <span>in</span>Â groups:</span></code><code><span leaf="">Â  Â Â <span>if</span>Â grouping_column ==Â <span>'RHD filename'</span>:</span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â <span>'_A-'</span>Â <span>in</span>Â group:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># æå–åˆ†ç»„åç§°</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  group_str = group.split(<span>'_A-'</span>)[<span>0</span>]</span></code><code><span leaf="">Â  Â  Â  Â Â <span>elif</span>Â <span>'_ChA-'</span>Â <span>in</span>Â group:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># æå–åˆ†ç»„åç§°</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  group_str = group.split(<span>'_ChA-'</span>)[<span>0</span>]</span></code><code><span leaf="">Â  Â  Â  Â Â <span>else</span>:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  group_str =Â <span>'Unclear'</span></span></code><code><span leaf="">Â  Â Â <span>if</span>Â grouping_column ==Â <span>'Genotype'</span>:</span></code><code><span leaf="">Â  Â  Â  Â  group_str = group</span></code><code><span leaf="">Â  Â Â <span># åˆ›å»ºæœ‰å‘å›¾ï¼Œç”¨äºç»˜å›¾</span></span></code><code><span leaf="">Â  Â  G = nx.DiGraph()</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ åŒºåŸŸä½œä¸ºèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å¤§å°ä¸ºå…¶ firing rate</span></span></code><code><span leaf="">Â  Â Â <span>for</span>Â i_r, regÂ <span>in</span>Â <span>enumerate</span>(uniq_regions):</span></code><code><span leaf="">Â  Â  Â  Â Â <span># è¯»å–å¯¹åº”åŒºåŸŸçš„ DataFrame</span></span></code><code><span leaf="">Â  Â  Â  Â  reg_df = pd.read_excel(xls_basics, sheet_name=reg)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># è®¡ç®—è¯¥åˆ†ç»„ä¸‹è¯¥åŒºåŸŸçš„å¹³å‡ firing rate</span></span></code><code><span leaf="">Â  Â  Â  Â  reg_firing_rate = np.mean(reg_df[reg_df[grouping_column] == group][<span>'Firing rate'</span>].values)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># æ·»åŠ èŠ‚ç‚¹åˆ°å›¾ä¸­</span></span></code><code><span leaf="">Â  Â  Â  Â  G.add_node(reg, size=reg_firing_rate, pos=np.unravel_index(i_r, [<span>2</span>,Â <span>2</span>]))</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ é€‰å®šçš„åŒºåŸŸé—´è¾¹ï¼Œè¾¹çš„æƒé‡ä¸ºå…¶ç›¸å…³æ€§å€¼</span></span></code><code><span leaf="">Â  Â Â <span>for</span>Â reg1, reg2Â <span>in</span>Â region_pairs:</span></code><code><span leaf="">Â  Â  Â  Â  reg_pair_str =Â <span>None</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â <span>'{}-{}'</span>.<span>format</span>(reg1, reg2)Â <span>in</span>Â xls_cch.sheet_names:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_str =Â <span>'{}-{}'</span>.<span>format</span>(reg1, reg2)</span></code><code><span leaf="">Â  Â  Â  Â Â <span>elif</span>Â <span>'{}-{}'</span>.<span>format</span>(reg2, reg1)Â <span>in</span>Â xls_cch.sheet_names:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_str =Â <span>'{}-{}'</span>.<span>format</span>(reg2, reg1)</span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â reg_pair_strÂ <span>is</span>Â <span>not</span>Â <span>None</span>:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è¯»å–å¯¹åº”åŒºåŸŸå¯¹çš„ DataFrame</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_df = pd.read_excel(xls_cch, sheet_name=reg_pair_str)</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è®¡ç®—è¯¥åˆ†ç»„ä¸‹è¯¥åŒºåŸŸå¯¹çš„å¹³å‡æœ€å¤§ç›¸å…³æ€§</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_correlation = np.mean(reg_pair_df[reg_pair_df[grouping_column] == group][<span>'Max_correlation'</span>].values)</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># æ·»åŠ è¾¹åˆ°å›¾ä¸­</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  G.add_edge(reg1, reg2, weight=reg_pair_correlation)</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ åŒºåŸŸå†…è¾¹ï¼Œè¾¹çš„æƒé‡ä¸ºå…¶ç›¸å…³æ€§å€¼</span></span></code><code><span leaf="">Â  Â Â <span>for</span>Â reg1Â <span>in</span>Â uniq_regions:</span></code><code><span leaf="">Â  Â  Â  Â  reg_pair_str =Â <span>'{}-{}'</span>.<span>format</span>(reg1, reg1)</span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â reg_pair_strÂ <span>in</span>Â xls_cch.sheet_names:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è¯»å–å¯¹åº”åŒºåŸŸå†…çš„ DataFrame</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_df = pd.read_excel(xls_cch, sheet_name=reg_pair_str)</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è®¡ç®—è¯¥åˆ†ç»„ä¸‹è¯¥åŒºåŸŸå†…çš„å¹³å‡æœ€å¤§ç›¸å…³æ€§</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  reg_pair_correlation = np.mean(reg_pair_df[reg_pair_df[grouping_column] == group][<span>'Max_correlation'</span>].values)</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># æ·»åŠ è¾¹åˆ°å›¾ä¸­</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  G.add_edge(reg1, reg1, weight=reg_pair_correlation)</span></code><code><span leaf="">Â  Â Â <span># åˆ›å»ºå›¾å½¢å’Œåæ ‡è½´</span></span></code><code><span leaf="">Â  Â  f, ax = plt.subplots(figsize=[<span>5</span>,Â <span>4</span>])</span></code><code><span leaf="">Â  Â Â <span># è·å–èŠ‚ç‚¹çš„å¤§å°å±æ€§</span></span></code><code><span leaf="">Â  Â  nodes = nx.get_node_attributes(G,Â <span>'size'</span>)</span></code><code><span leaf="">Â  Â Â <span># è·å–è¾¹çš„æƒé‡å±æ€§</span></span></code><code><span leaf="">Â  Â  edges = nx.get_edge_attributes(G,Â <span>'weight'</span>)</span></code><code><span leaf="">Â  Â Â <span># è·å–æœ€å¤§èŠ‚ç‚¹å¤§å°</span></span></code><code><span leaf="">Â  Â  max_node_size = np.<span>max</span>(<span>list</span>(nodes.values()))</span></code><code><span leaf="">Â  Â Â <span># è·å–æœ€å¤§è¾¹çš„æƒé‡</span></span></code><code><span leaf="">Â  Â  max_edge_size = np.<span>max</span>(<span>list</span>(edges.values()))</span></code><code><span leaf="">Â  Â Â <span># å®šä¹‰ä¸€ä¸ªä» 0 åˆ° 10 çš„åˆ»åº¦ï¼Œæ­¥é•¿ä¸º 0.2</span></span></code><code><span leaf="">Â  Â  scale = np.linspace(<span>0</span>,Â <span>10</span>, retstep=<span>0.2</span>)[<span>0</span>]</span></code><code><span leaf="">Â  Â Â <span># è·å–æœ€æ¥è¿‘æœ€å¤§è¾¹æƒé‡çš„åˆ»åº¦å€¼</span></span></code><code><span leaf="">Â  Â  max_edge_scale = np.floor(scale[np.argmin(np.<span>abs</span>(scale - max_edge_size))] *Â <span>10</span>) /Â <span>10</span></span></code><code><span leaf="">Â  Â Â <span># å¦‚æœå®šä¹‰äº†å›ºå®šçš„åˆ»åº¦ï¼Œåˆ™è¦†ç›–è¯¥å€¼</span></span></code><code><span leaf="">Â  Â  max_edge_scale = np.<span>max</span>([max_edge_scale, fixed_max_correlation_for_scale])</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ ä¸€ä¸ªå¤§çš„ç°è‰²åœ†åœˆ</span></span></code><code><span leaf="">Â  Â  great_circle_gray = plt.Circle([<span>0</span>,Â <span>0</span>],Â <span>2.5</span>Â * plot_scale_factor, color=<span>'white'</span>, lw=<span>0</span>, fill=<span>False</span>, zorder=-<span>3</span>)</span></code><code><span leaf="">Â  Â  ax.add_patch(great_circle_gray)</span></code><code><span leaf="">Â  Â Â <span># ç»˜åˆ¶èŠ‚ç‚¹å’Œè¾¹</span></span></code><code><span leaf="">Â  Â Â <span>for</span>Â n, nvÂ <span>in</span>Â nodes.items():</span></code><code><span leaf="">Â  Â  Â  Â Â <span># å®šä¹‰æ°”æ³¡å’Œè‡ªç¯çš„åŠå¾„</span></span></code><code><span leaf="">Â  Â  Â  Â  bubble_radius = np.<span>max</span>([np.sqrt(nv / np.pi),Â <span>0</span>])</span></code><code><span leaf="">Â  Â  Â  Â  loop_radius = np.<span>max</span>([bubble_radius,Â <span>0.5</span>])</span></code><code><span leaf="">Â  Â  Â  Â Â <span># å®šä¹‰è‡ªç¯çš„åç§»é‡</span></span></code><code><span leaf="">Â  Â  Â  Â  loop_offset = np.array([loop_radius *Â <span>0.75</span>Â * np.sign(node_pos[n][<span>0</span>]), loop_radius *Â <span>0.75</span>Â * np.sign(node_pos[n][<span>1</span>])])</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶è‡ªç¯</span></span></code><code><span leaf="">Â  Â  Â  Â  loop_color =Â <span>'silver'</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â ~np.isnan(edges[(n, n)]):</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è®¡ç®—è‡ªç¯çš„çº¿å®½</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  loop_line_width = np.<span>max</span>([<span>int</span>((max_line_width * edges[(n, n)]) / max_edge_scale),Â <span>2</span>])</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># æ·»åŠ è‡ªç¯åˆ°åæ ‡è½´</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  loop_circle_gray = plt.Circle(node_pos[n] * plot_scale_factor + loop_offset, loop_radius, color=loop_color, lw=loop_line_width, fill=<span>False</span>, zorder=-<span>1</span>)</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  ax.add_patch(loop_circle_gray)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶èŠ‚ç‚¹</span></span></code><code><span leaf="">Â  Â  Â  Â  node_circle = plt.Circle(node_pos[n] * plot_scale_factor, bubble_radius, facecolor=node_colors[n], fill=<span>True</span>, label=n, linewidth=<span>1</span>, edgecolor=<span>'k'</span>)</span></code><code><span leaf="">Â  Â  Â  Â  ax.add_patch(node_circle)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶èŠ‚ç‚¹åç§°</span></span></code><code><span leaf="">Â  Â  Â  Â  text_x, text_y = node_pos[n] * plot_scale_factor *Â <span>2.3</span></span></code><code><span leaf="">Â  Â  Â  Â  ax.text(text_x, text_y, n, fontsize=<span>12</span>, horizontalalignment=<span>'center'</span>, verticalalignment=<span>'center'</span>, color=<span>'k'</span>)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶é€‰å®šçš„åŒºåŸŸé—´è¾¹</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span>for</span>Â e, evÂ <span>in</span>Â edges.items():</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>if</span>Â e[<span>0</span>] == nÂ <span>and</span>Â e[<span>0</span>] != e[<span>1</span>]Â <span>and</span>Â ~np.isnan(ev):</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  line_color =Â <span>'silver'</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â Â <span># è®¡ç®—è¾¹çš„çº¿å®½</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  line_width = np.<span>max</span>([<span>int</span>((max_line_width * ev) / max_edge_scale),Â <span>2</span>])</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â Â <span># ç»˜åˆ¶åŠåœ†å¼§è¾¹</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  draw_semicircle(node_pos[e[<span>0</span>]][<span>0</span>] * plot_scale_factor, node_pos[e[<span>0</span>]][<span>1</span>] * plot_scale_factor,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  node_pos[e[<span>1</span>]][<span>0</span>] * plot_scale_factor, node_pos[e[<span>1</span>]][<span>1</span>] * plot_scale_factor, color=line_color, lw=line_width, ax=ax)</span></code><code><span leaf="">Â  Â Â <span># è®¾ç½®åæ ‡è½´ä¸ºç©ºï¼Œå¹¶è®¾ç½®æ ‡é¢˜</span></span></code><code><span leaf="">Â  Â  ax.set_title(group_str)</span></code><code><span leaf="">Â  Â  ax.set_xticks([])</span></code><code><span leaf="">Â  Â  ax.set_yticks([])</span></code><code><span leaf="">Â  Â Â <span># æ°”æ³¡å¤§å°å›¾ä¾‹</span></span></code><code><span leaf="">Â  Â Â <span># è®¡ç®—å›¾ä¾‹ä¸­æ°”æ³¡çš„åŠå¾„</span></span></code><code><span leaf="">Â  Â  legend_bubble_radius = np.sqrt(firing_rates_for_legend / np.pi)</span></code><code><span leaf="">Â  Â  y_offset =Â <span>0</span></span></code><code><span leaf="">Â  Â Â <span>for</span>Â i_bubbleÂ <span>in</span>Â <span>range</span>(<span>len</span>(legend_bubble_radius)):</span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â i_bubble &gt;Â <span>0</span>:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># è®¡ç®— y æ–¹å‘çš„åç§»é‡</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  y_offset = y_offset + legend_bubble_radius[i_bubble] + legend_bubble_radius[i_bubble -Â <span>1</span>] +Â <span>0.3</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span>if</span>Â plot_orientation ==Â <span>'diagonal'</span>:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># å¯¹è§’çº¿æ–¹å‘çš„åœ†å¿ƒä½ç½®</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  center = (<span>0</span>, -<span>1.8</span>Â * plot_scale_factor - y_offset)</span></code><code><span leaf="">Â  Â  Â  Â Â <span>elif</span>Â plot_orientation ==Â <span>'cardinal'</span>:</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span># åŸºæœ¬æ–¹å‘çš„åœ†å¿ƒä½ç½®</span></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  center = (plot_scale_factor +Â <span>1</span>, -plot_scale_factor -Â <span>1</span>Â - y_offset)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶å›¾ä¾‹ä¸­çš„æ°”æ³¡</span></span></code><code><span leaf="">Â  Â  Â  Â  bubble = plt.Circle(center, legend_bubble_radius[i_bubble], fill=<span>False</span>, label=n, linewidth=<span>1</span>, edgecolor=<span>'k'</span>)</span></code><code><span leaf="">Â  Â  Â  Â  ax.add_patch(bubble)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ç»˜åˆ¶å›¾ä¾‹ä¸­çš„æ–‡æœ¬</span></span></code><code><span leaf="">Â  Â  Â  Â  text_x = center[<span>0</span>] + legend_bubble_radius[<span>0</span>] *Â <span>1.2</span></span></code><code><span leaf="">Â  Â  Â  Â  text_y = center[<span>1</span>]</span></code><code><span leaf="">Â  Â  Â  Â  ax.text(text_x, text_y,Â <span>'{} Hz'</span>.<span>format</span>(firing_rates_for_legend[i_bubble]), fontsize=<span>10</span>, horizontalalignment=<span>'left'</span>, verticalalignment=<span>'center'</span>, color=<span>'k'</span>)</span></code><code><span leaf="">Â  Â Â <span># è®¾ç½®åæ ‡è½´æ¯”ä¾‹ç›¸ç­‰</span></span></code><code><span leaf="">Â  Â  ax.axis(<span>'equal'</span>)</span></code><code><span leaf="">Â  Â Â <span># çº¿å®½å›¾ä¾‹</span></span></code><code><span leaf="">Â  Â Â <span># è®¡ç®—å›¾ä¾‹ä¸­çš„æ ‡ç­¾æ•°é‡</span></span></code><code><span leaf="">Â  Â  n_labels =Â <span>int</span>(max_edge_scale *Â <span>10</span>Â /Â <span>2</span>Â +Â <span>1</span>)</span></code><code><span leaf="">Â  Â Â <span># ç”Ÿæˆå›¾ä¾‹ä¸­çš„æ ‡ç­¾</span></span></code><code><span leaf="">Â  Â  line_labels = np.linspace(<span>0</span>, max_edge_scale, n_labels)</span></code><code><span leaf="">Â  Â Â <span># è®¡ç®—å›¾ä¾‹ä¸­çš„çº¿å®½</span></span></code><code><span leaf="">Â  Â  line_widths = [np.<span>max</span>([<span>int</span>(max_line_width * label / max_edge_scale),Â <span>1</span>])Â <span>for</span>Â labelÂ <span>in</span>Â line_labels]</span></code><code><span leaf="">Â  Â Â <span># åˆ›å»ºå›¾ä¾‹ä¸­çš„æ ‡è®°</span></span></code><code><span leaf="">Â  Â  markers = [plt.Line2D([<span>0</span>,Â <span>0</span>], [<span>0</span>,Â <span>0</span>], color=<span>'gray'</span>, lw=lw, solid_capstyle=<span>'butt'</span>)Â <span>for</span>Â lwÂ <span>in</span>Â line_widths]</span></code><code><span leaf="">Â  Â Â <span># æ·»åŠ å›¾ä¾‹</span></span></code><code><span leaf="">Â  Â  ax.legend(markers, [<span>'{:.1f}'</span>.<span>format</span>(l)Â <span>for</span>Â lÂ <span>in</span>Â line_labels], numpoints=<span>1</span>, title=<span>'Peak corr.'</span>, loc=<span>'center right'</span>)</span></code><code><span leaf="">Â  Â Â <span># è‡ªåŠ¨è°ƒæ•´å¸ƒå±€</span></span></code><code><span leaf="">Â  Â  f.tight_layout()</span></code><code><span leaf="">Â  Â Â <span>if</span>Â save_figures:</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ä¿å­˜å›¾å½¢ä¸º SVG æ ¼å¼</span></span></code><code><span leaf="">Â  Â  Â  Â  f.savefig(save_fig_path +Â <span>'\\'</span>Â +Â <span>'bubble_plot_{}'</span>.<span>format</span>(group_str) +Â <span>'.svg'</span>)</span></code><code><span leaf="">Â  Â  Â  Â Â <span># ä¿å­˜å›¾å½¢ä¸º PNG æ ¼å¼</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span># f.savefig(save_fig_path + '\\' + 'bubble_plot_{}'.format(group_str) + '.png')</span></span></code><code><span leaf="">break_point =Â <span>1</span></span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_nGulOmLlJD8xaA4CPnOZA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
