---
title: "一文了解Python中的单细胞通货：AnnData"
date: 2025-04-23T01:08:20Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
一文了解Python中的单细胞通货：AnnData by Biomamba 生信基地
------
<div><section><span leaf=""><br></span></section><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="Biomamba 生信基地" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpy4cR31GnTmYFdCZKZDcuCbwdtp2iaibCI3DvtRibLgnUDVB3NC0IVfiaQlVww9b7BdXQpicY7m4iaoXqibg/0?wx_fmt=png" data-signature="本人为在读博士研究生，此公众号旨在分享生信知识及科研经验与体会，欢迎各位同学、老师与专家的批评指正，也欢迎各界人士的合作与交流。" data-id="MzAwMzIzOTk5OQ==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section><section data-pm-slice="0 0 []"><section data-support="96编辑器" data-style-id="39305"><section data-align="title"><section><section><strong><span leaf="">一、写在前面</span></strong></section></section></section></section></section><section data-support="96编辑器" data-style-id="35163"><section><section><section><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">1、是时候用Python分析单细胞了</span></span></p><p data-pm-slice="0 0 []"><span leaf="">此前我们的单细胞分析教程大都是基于R中的<span textstyle="">神包Seurat</span>(<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528199&amp;idx=1&amp;sn=ab75e7d7987ab233c675455188f10f33&amp;scene=21#wechat_redirect" textvalue="scRNA-seq数据基础分析手册(2025最新修订)" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">scRNA-seq数据基础分析手册(2025最新修订)</span></a>)，现如今面对<span textstyle="">指数级增长</span>的单细胞数据，基于Python的Scanpy(<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247504877&amp;idx=2&amp;sn=2b56a9cfa19fcc918ee6c2ed88fed017&amp;scene=21#wechat_redirect" textvalue="scRNA-Seq学习手册Python版" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">scRNA-Seq学习手册Python版</span></a>)其实是一个更好的选择。目前Python具有丰富的科学计算库和活跃的社区支持，在数据处理、可视化和与其他机器学习或生物信息学工具的集成方面展现出巨大的灵活性。</span></p><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">2、Scanpy</span></span></p><p data-pm-slice="0 0 []"><span leaf="">Scanpy就是Python环境中对标Seurat的单细胞分析神器，即使是R语言一直引以为傲的可视化能力，也被<span textstyle="">Scanpy迎头赶上</span>：其内置了多种可视化方法，从而利用<span textstyle="">matplotlib</span>和<span textstyle="">seaborn</span>等Python可视化库，可以创建高质量的图形，并且能够方便地进行定制和扩展，以满足不同的可视化需求。由于Python在机器学习(<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247510121&amp;idx=1&amp;sn=87b53d350d9aedd5b3205d59e51356a0&amp;scene=21#wechat_redirect" textvalue="机器学习基础手册" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">机器学习基础手册</span></a>)领域的广泛应用，Scanpy可以轻松与其他Python库和工具集成，如用于深度学习的PyTorch和TensorFlow，以及用于数据处理和分析的 Pandas 和 NumPy 等，便于进行更复杂的多模态数据分析和机器学习任务。不得不提的是，在处理大规模单细胞数据集时，Scanpy通常具有较好计算效率，无论是<span textstyle="">计算速度</span>还是<span textstyle="">内存</span>占用上都比基于R的Seurat要好得多，这使得它在处理海量单细胞数据时表现出色。所以，不得不拥抱未来，让我们把Python中的单细胞内容学起来吧~</span></p><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">3、AnnData</span></span></p><p><code data-pm-slice="0 0 []"><span leaf=""><span textstyle="">AnnData</span></span></code><span><span leaf=""><span textstyle="">被设计用于矩阵样数据的处理，可以方便的获得矩阵行与列的索引。例如在scRNA-seq的数据中，每一行的数据对应为一个细胞表达的所有基因数据，每一列的数据对应为一个基因在所有细胞中的表达数据(这点与R中不同，</span></span></span><code><span leaf=""><span textstyle="">Seurat</span></span></code><span><span leaf=""><span textstyle="">对象的矩阵正好是</span></span></span><code><span leaf=""><span textstyle="">AnnData</span></span></code><span><span leaf=""><span textstyle="">的转置版)。不仅是表达矩阵，每个细胞（如样本来源、细胞类型等）及每个基因（如别名、基因ID等）还会有自己的注释信息。另外，考虑到单细胞矩阵的稀疏性、以及数据结构需要有用户友好型的特性，</span></span></span><code><span leaf=""><span textstyle="">AnnData</span></span></code><span><span leaf=""><span textstyle="">显得再合适不过。因此</span></span><span leaf="" data-pm-slice="0 0 []"><span textstyle="">AnnData</span></span><span leaf=""><span textstyle="">在Python中被广泛应用于scVelo、scvi等单细胞分析工具中，甚至空间转录组也都沿用这一数据格式对象：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247505686&amp;idx=2&amp;sn=925ce770136ec3e964b954c639eed29e&amp;scene=21#wechat_redirect" textvalue="Stereopy空间转录组学习手册" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">Stereopy空间转录组学习手册</span></a>、<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247505844&amp;idx=2&amp;sn=5756c0702d080d6e602c504e7d461013&amp;scene=21#wechat_redirect" textvalue="Squidpy空间转录组学习手册" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">Squidpy空间转录组学习手册</span></a>。</span></span></p><p><span leaf=""><br></span></p><p data-pm-slice="0 0 []"><span><span><span leaf=""><span textstyle="">本教程基于Linux中的Rstudio环境（</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247526504&amp;idx=2&amp;sn=417d07347cebe0a1bd403f6c3e7d9b29&amp;scene=21#wechat_redirect" textvalue="足够支持你完成硕博生涯的生信环境" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a>）<span textstyle="">演示，计算资源不足的同学可参考：</span></span></span><span leaf=""><br></span><span leaf="">    <a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247491007&amp;idx=1&amp;sn=8619c2bad23791b3252a1c4cb1831931&amp;chksm=9b3f64efac48edf9c02f84959aeee9b12480736fce70c5ddb8b41d79cfc22ce590ea2cb60fba&amp;token=1760636281&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">生信分析为什么要使用服务器？</span></a></span><span leaf=""><br></span><span leaf=""> <span textstyle="">   </span><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247511780&amp;idx=1&amp;sn=3acc0874f7d2fa75f1abbe7a9a9b4069&amp;chksm=9b3cd7b4ac4b5ea27d4d53964e4a4a9fa8c806a19103729dd4ff0fa72e621411f46a251d269f&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a></span><span leaf=""><br></span><span leaf=""><span textstyle="">    </span><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247503618&amp;idx=1&amp;sn=ca47ca985aa8560f6b38f15f210519e2&amp;chksm=9b3cb652ac4b3f44292560071b7e98e2f6fa6ec03581cd882a4d59b9d7fa063a5b9ac1b923f3&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2"><span textstyle="">独享服务器，生信分析不求人</span></a></span><span leaf=""><br></span><span leaf=""><br></span></span></p><p><span><span leaf="">访问链接：</span></span><span><span leaf="">https://biomamba.xiyoucloud.net/</span></span></p><p><span><span><span leaf="">更多内容可咨询客服微信[</span></span><strong><span><span leaf="">Biomamba_yunying</span></span></strong><span><span leaf="">]</span></span></span></p><p><span><span leaf=""><br></span></span></p></section></section></section></section><section><span leaf=""><br></span></section><section><strong><span leaf="">二、实操</span></strong></section><section data-support="96编辑器" data-style-id="35163"><section><section><section><p><span leaf="" data-pm-slice="0 0 []"><span textstyle="">本教程需要熟练掌握Python，大家可以先行学习：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247499921&amp;idx=1&amp;sn=dcd6f95596e3de9bf378d850c217fe78&amp;scene=21#wechat_redirect" textvalue="生信Python速查手册" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">生信Python速查手册</span></a><span textstyle="">。</span></span><span leaf=""><span textstyle="">更多Python单细胞教程与测试数据可见：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247504877&amp;idx=2&amp;sn=2b56a9cfa19fcc918ee6c2ed88fed017&amp;scene=21#wechat_redirect" textvalue="scRNA-Seq学习手册Python版" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">scRNA-Seq学习手册Python版</span></a><span textstyle="">。</span></span></p><p><span leaf="">1、<span textstyle="">构建模拟</span></span><code><span leaf=""><span textstyle="">Anndata</span></span></code><span leaf=""><span textstyle="">对象并查看</span></span></p><p><span><code data-pm-slice="0 0 []"><span leaf="">AnnData</span></code><span><span leaf="">的基本结构可以看这个示意图：</span></span></span></p><p><span><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzlCHzM8BicyYndroTyAQWjd0pwfsF6iaUrWx7AWX6bSEoFJjoQQic6CWNhnDMwDU9RicsjfvjNpuahww/640?wx_fmt=png&amp;from=appmsg" alt="image-2.png" data-ratio="0.8395573997233748" data-type="jpeg" data-w="723" data-imgfileid="100044850" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpzlCHzM8BicyYndroTyAQWjd0pwfsF6iaUrWx7AWX6bSEoFJjoQQic6CWNhnDMwDU9RicsjfvjNpuahww/640?wx_fmt=png&amp;from=appmsg"></span></span></span></p><p><span><span><span leaf=""><br></span></span></span></p><p><span><span><span leaf=""><span textstyle="">环境布置可见此前教程：</span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528493&amp;idx=2&amp;sn=b8add6f0303ec6032ecc2242f59d8289&amp;scene=21#wechat_redirect" textvalue="布置Python单细胞分析环境" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">布置Python单细胞分析环境</span></a></span></span></span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 导包</span></span></span><span leaf=""><br></span><span><span><span leaf="">import</span></span><span leaf=""> numpy </span><span><span leaf="">as</span></span><span leaf=""> np</span></span><span leaf=""><br></span><span><span><span leaf="">import</span></span><span leaf=""> pandas </span><span><span leaf="">as</span></span><span leaf=""> pd</span></span><span leaf=""><br></span><span><span><span leaf="">import</span></span><span leaf=""> anndata </span><span><span leaf="">as</span></span><span leaf=""> ad</span></span><span leaf=""><br></span><span><span><span leaf="">from</span></span><span leaf=""> scipy.sparse </span><span><span leaf="">import</span></span><span leaf=""> csr_matrix</span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(ad.__version__)</span></span></code></pre><pre><code><span leaf="">## 0.9.1</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 模拟一个矩阵构建AnnData对象</span></span></span><span leaf=""><br></span><span><span leaf="">counts </span><span><span leaf="">=</span></span><span leaf=""> csr_matrix(np.random.poisson(</span><span><span leaf="">1</span></span><span leaf="">, size</span><span><span leaf="">=</span></span><span leaf="">(</span><span><span leaf="">100</span></span><span leaf="">, </span><span><span leaf="">2000</span></span><span leaf="">)), dtype</span><span><span leaf="">=</span></span><span leaf="">np.float32)</span></span><span leaf=""><br></span><span><span leaf="">temp_adata </span><span><span leaf="">=</span></span><span leaf=""> ad.AnnData(counts)</span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">f"这个AnnData对象包括</span></span><span><span leaf="">{</span></span><span leaf="">temp_adata</span><span><span leaf="">.</span></span><span leaf="">shape[</span><span><span leaf="">0</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">行，与</span></span><span><span leaf="">{</span></span><span leaf="">temp_adata</span><span><span leaf="">.</span></span><span leaf="">shape[</span><span><span leaf="">1</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">列"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf=""># 稀疏矩阵存放在temp_adata.X中：</span></span></span></code></pre><pre><code><span leaf="">## 这个AnnData对象包括100行，与2000列</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.X</span></span></code></pre><pre><code><span leaf="">## &lt;100x2000 sparse matrix of type '&lt;class 'numpy.float32'&gt;'</span><span leaf=""><br></span><span leaf="">##  with 126600 stored elements in Compressed Sparse Row format&gt;</span></code></pre><p><code data-pm-slice="0 0 []"><span leaf="">AnnData</span></code><span><span leaf="">索引操作可以帮助我们取得对应的</span></span><code><span leaf="">AnnData</span></code><span><span leaf="">子集，这样我们就可以选取感兴趣的细胞或基因参与下游的计算，简化流程并节省计算资源。类似于</span></span><code><span leaf="">pandas</span></code><span><span leaf="">的</span></span><code><span leaf="">DataFrame</span></code><span><span leaf="">通过</span></span><code><span leaf="">obs_names</span></code><span><span leaf="">和</span></span><code><span leaf="">var_names</span></code><span><span leaf="">、布尔值、索引整数数字均可以完成对</span></span><code><span leaf="">AnnData</span></code><span><span leaf="">的取子集操作。</span></span><span leaf=""><br></span><span><span leaf="">我们的矩阵是刚才模拟出来的，可以用这样的方式添加上细胞名称与基因名称：</span></span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 生成细胞名称并传递给obs_names</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata.obs_names </span><span><span leaf="">=</span></span><span leaf=""> [</span><span><span leaf="">f"Cell_</span></span><span><span leaf="">{</span></span><span leaf="">i</span><span><span leaf="">:d}</span></span><span><span leaf="">"</span></span><span><span leaf="">for</span></span><span leaf=""> i </span><span><span leaf="">in</span></span><span><span leaf="">range</span></span><span leaf="">(temp_adata.n_obs)]</span></span><span leaf=""><br></span><span><span><span leaf=""># 生成基因名称并传递给var_names</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata.var_names </span><span><span leaf="">=</span></span><span leaf=""> [</span><span><span leaf="">f"Gene_</span></span><span><span leaf="">{</span></span><span leaf="">i</span><span><span leaf="">:d}</span></span><span><span leaf="">"</span></span><span><span leaf="">for</span></span><span leaf=""> i </span><span><span leaf="">in</span></span><span><span leaf="">range</span></span><span leaf="">(temp_adata.n_vars)]</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">f"前五个细胞名称为:</span></span><span><span leaf="">\n</span></span><span><span leaf="">{</span></span><span leaf="">temp_adata</span><span><span leaf="">.</span></span><span leaf="">obs_names[:</span><span><span leaf="">5</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">"</span></span><span leaf="">)</span></span></code></pre><pre data-pm-slice="0 0 []"><code><span leaf="">## 前五个细胞名称为:</span><span leaf=""><br></span><span leaf="">## Index(['Cell_0', 'Cell_1', 'Cell_2', 'Cell_3', 'Cell_4'], dtype='object')</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">f"前五个基因名称为:</span></span><span><span leaf="">\n</span></span><span><span leaf="">{</span></span><span leaf="">temp_adata</span><span><span leaf="">.</span></span><span leaf="">var_names[:</span><span><span leaf="">5</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">"</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## 前五个基因名称为:</span><span leaf=""><br></span><span leaf="">## Index(['Gene_0', 'Gene_1', 'Gene_2', 'Gene_3', 'Gene_4'], dtype='object')</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 那么子集就可以这么取:</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata[[</span><span><span leaf="">"Cell_1"</span></span><span leaf="">, </span><span><span leaf="">"Cell_10"</span></span><span leaf="">], [</span><span><span leaf="">"Gene_5"</span></span><span leaf="">, </span><span><span leaf="">"Gene_1900"</span></span><span leaf="">]]</span></span><span leaf=""><br></span><span><span><span leaf=""># 这样就得到了一个包含"两个细胞"、"两个基因"的表达矩阵</span></span></span></code></pre><pre><code><span leaf="">## View of AnnData object with n_obs × n_vars = 2 × 2</span></code></pre><h2 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">2、添加注释信息</span></span></h2><p><code data-pm-slice="0 0 []"><span leaf="">adata.obs</span></code><span><span leaf="">与</span></span><code><span leaf="">adata.var</span></code><span><span leaf="">均是</span></span><code><span leaf="">DataFrame</span></code><span><span leaf="">，那么就可以很容易的加上对应的注释，例如加上细胞类型的注释:</span></span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 例如这里随机生成"B", "T", "Monocyte"三种细胞类型作为注释</span></span></span><span leaf=""><br></span><span><span leaf="">ct </span><span><span leaf="">=</span></span><span leaf=""> np.random.choice([</span><span><span leaf="">"B"</span></span><span leaf="">, </span><span><span leaf="">"T"</span></span><span leaf="">, </span><span><span leaf="">"Monocyte"</span></span><span leaf="">], size</span><span><span leaf="">=</span></span><span leaf="">(temp_adata.n_obs,))</span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">f"ct的前10个元素为</span></span><span><span leaf="">{</span></span><span leaf="">ct[</span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">10</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 加入adata.obs中</span></span></span></code></pre><pre><code><span leaf="">## ct的前10个元素为['T' 'Monocyte' 'T' 'Monocyte' 'Monocyte' 'B' 'Monocyte' 'Monocyte'</span><span leaf=""><br></span><span leaf="">##  'Monocyte' 'T']</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.obs[</span><span><span leaf="">"cell_type"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> pd.Categorical(ct)  </span><span><span leaf=""># Categorical的执行效率较高</span></span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 可以看到adata.obs已经包含了我们刚刚添加的注释</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata.obs</span></span></code></pre><pre><code><span leaf="">##         cell_type</span><span leaf=""><br></span><span leaf="">## Cell_0          T</span><span leaf=""><br></span><span leaf="">## Cell_1   Monocyte</span><span leaf=""><br></span><span leaf="">## Cell_2          T</span><span leaf=""><br></span><span leaf="">## Cell_3   Monocyte</span><span leaf=""><br></span><span leaf="">## Cell_4   Monocyte</span><span leaf=""><br></span><span leaf="">## ...           ...</span><span leaf=""><br></span><span leaf="">## Cell_95  Monocyte</span><span leaf=""><br></span><span leaf="">## Cell_96  Monocyte</span><span leaf=""><br></span><span leaf="">## Cell_97         T</span><span leaf=""><br></span><span leaf="">## Cell_98         B</span><span leaf=""><br></span><span leaf="">## Cell_99         T</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [100 rows x 1 columns]</span></code></pre><p><span data-pm-slice="0 0 []"><span leaf="">同理，我们也可以对基因添加相应的注释：</span></span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 例如这里随机生成"Pathway_A", "Pathway_B", "Pathway_C"三种通路名作为细胞的注释</span></span></span><span leaf=""><br></span><span><span leaf="">my_path </span><span><span leaf="">=</span></span><span leaf=""> np.random.choice([</span><span><span leaf="">"Pathway_A"</span></span><span leaf="">, </span><span><span leaf="">"Pathway_B"</span></span><span leaf="">, </span><span><span leaf="">"Pathway_C"</span></span><span leaf="">],</span></span><span leaf=""><br></span><span><span leaf="">                      size</span><span><span leaf="">=</span></span><span leaf="">(temp_adata.n_vars,))</span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(</span><span><span leaf="">f"ct的前10个元素为</span></span><span><span leaf="">{</span></span><span leaf="">my_path[</span><span><span leaf="">0</span></span><span leaf="">:</span><span><span leaf="">10</span></span><span leaf="">]</span><span><span leaf="">}</span></span><span><span leaf="">"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 加入adata.obs中</span></span></span></code></pre><pre><code><span leaf="">## ct的前10个元素为['Pathway_C' 'Pathway_A' 'Pathway_B' 'Pathway_B' 'Pathway_A' 'Pathway_B'</span><span leaf=""><br></span><span leaf="">##  'Pathway_C' 'Pathway_A' 'Pathway_C' 'Pathway_C']</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.var[</span><span><span leaf="">"my_pathway"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> pd.Categorical(my_path)  </span><span><span leaf=""># Categorical的执行效率较高</span></span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 可以看到adata.var已经包含了我们刚刚添加的注释</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata.var</span></span></code></pre><pre><code><span leaf="">##           my_pathway</span><span leaf=""><br></span><span leaf="">## Gene_0     Pathway_C</span><span leaf=""><br></span><span leaf="">## Gene_1     Pathway_A</span><span leaf=""><br></span><span leaf="">## Gene_2     Pathway_B</span><span leaf=""><br></span><span leaf="">## Gene_3     Pathway_B</span><span leaf=""><br></span><span leaf="">## Gene_4     Pathway_A</span><span leaf=""><br></span><span leaf="">## ...              ...</span><span leaf=""><br></span><span leaf="">## Gene_1995  Pathway_C</span><span leaf=""><br></span><span leaf="">## Gene_1996  Pathway_C</span><span leaf=""><br></span><span leaf="">## Gene_1997  Pathway_A</span><span leaf=""><br></span><span leaf="">## Gene_1998  Pathway_C</span><span leaf=""><br></span><span leaf="">## Gene_1999  Pathway_B</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [2000 rows x 1 columns]</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 这时这个AnnData对象就包含了我们所添加的cell_type以及my_pathway注释：</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata</span></span></code></pre><pre><code><span leaf="">## AnnData object with n_obs × n_vars = 100 × 2000</span><span leaf=""><br></span><span leaf="">##     obs: 'cell_type'</span><span leaf=""><br></span><span leaf="">##     var: 'my_pathway'</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 这时可以通过注释来选取数据的子集：</span></span></span><span leaf=""><br></span><span><span><span leaf=""># 取出B cell的细胞数据</span></span></span><span leaf=""><br></span><span><span leaf="">bcell_adata </span><span><span leaf="">=</span></span><span leaf=""> temp_adata[temp_adata.obs.cell_type </span><span><span leaf="">==</span></span><span><span leaf="">"B"</span></span><span leaf="">,:]</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 取出仅包含Pathway_A的基因数据：</span></span></span><span leaf=""><br></span><span><span leaf="">PA_adata </span><span><span leaf="">=</span></span><span leaf=""> temp_adata[:,temp_adata.var.my_pathway </span><span><span leaf="">==</span></span><span><span leaf="">"Pathway_A"</span></span><span leaf="">]</span></span></code></pre><p><span leaf="">在实际分析过程中，往往有大量的注释内容，例如:</span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 构建一个略显"复杂"的注释DataFrame</span></span></span><span leaf=""><br></span><span><span leaf="">obs_meta </span><span><span leaf="">=</span></span><span leaf=""> pd.DataFrame({</span></span><span leaf=""><br></span><span><span><span leaf="">'time_yr'</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">4</span></span><span leaf="">, </span><span><span leaf="">8</span></span><span leaf="">], temp_adata.n_obs),</span></span><span leaf=""><br></span><span><span><span leaf="">'subject_id'</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">'subject 1'</span></span><span leaf="">, </span><span><span leaf="">'subject 2'</span></span><span leaf="">, </span><span><span leaf="">'subject 4'</span></span><span leaf="">, </span><span><span leaf="">'subject 8'</span></span><span leaf="">], temp_adata.n_obs),</span></span><span leaf=""><br></span><span><span><span leaf="">'instrument_type'</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">'type a'</span></span><span leaf="">, </span><span><span leaf="">'type b'</span></span><span leaf="">], temp_adata.n_obs),</span></span><span leaf=""><br></span><span><span><span leaf="">'site'</span></span><span leaf="">: np.random.choice([</span><span><span leaf="">'site x'</span></span><span leaf="">, </span><span><span leaf="">'site y'</span></span><span leaf="">], temp_adata.n_obs),</span></span><span leaf=""><br></span><span><span leaf="">    },</span></span><span leaf=""><br></span><span><span leaf="">    index</span><span><span leaf="">=</span></span><span leaf="">temp_adata.obs.index,   </span><span><span leaf=""># 需要与AnnData的observations相一致</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">obs_meta.head()</span></span></code></pre><pre><code><span leaf="">##         time_yr subject_id instrument_type    site</span><span leaf=""><br></span><span leaf="">## Cell_0        4  subject 1          type a  site y</span><span leaf=""><br></span><span leaf="">## Cell_1        2  subject 4          type a  site y</span><span leaf=""><br></span><span leaf="">## Cell_2        8  subject 8          type b  site x</span><span leaf=""><br></span><span leaf="">## Cell_3        4  subject 4          type b  site x</span><span leaf=""><br></span><span leaf="">## Cell_4        4  subject 2          type a  site y</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 将注释添加到AnnData对象中:</span></span></span><span leaf=""><br></span><span><span leaf="">new_adata </span><span><span leaf="">=</span></span><span leaf=""> ad.AnnData(temp_adata.X, obs</span><span><span leaf="">=</span></span><span leaf="">obs_meta, var</span><span><span leaf="">=</span></span><span leaf="">temp_adata.var)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span leaf="">new_adata</span></span><span leaf=""><br></span><span><span><span leaf=""># 可以看到多出很多注释内容</span></span></span></code></pre><pre><code><span leaf="">## AnnData object with n_obs × n_vars = 100 × 2000</span><span leaf=""><br></span><span leaf="">##     obs: 'time_yr', 'subject_id', 'instrument_type', 'site'</span><span leaf=""><br></span><span leaf="">##     var: 'my_pathway'</span></code></pre><h2 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">3、 注释矩阵管理</span></span></h2><p data-pm-slice="0 0 []"><span leaf="">刚才我们添加的</span><code><span leaf="">cell_type</span></code><span leaf="">以及</span><code><span leaf="">my_pathway</span></code><span leaf="">包含的均是单个围堵的注释信息，而有些数据是以多维度的形式参与单细胞的数据处理。例如</span><code><span leaf="">UMAP</span></code><span leaf="">与</span><code><span leaf="">tsne</span></code><span leaf="">的降维矩阵，这些多维度的信息可以添加至</span><code><span leaf="">.obsm</span></code><span leaf="">或</span><code><span leaf="">.varm</span></code><span leaf="">中。需要注意的是，矩阵的长度需要与</span><code><span leaf="">.n_obs</span></code><span leaf="">和</span><code><span leaf="">.n_vars</span></code><span leaf="">相对应。</span><span leaf=""><br></span><span leaf="">例如这里我们模拟一个</span><code><span leaf="">UMAP</span></code><span leaf="">和</span><code><span leaf="">gene_stuff</span></code><span leaf="">的结果进行添加：</span></p><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.obsm[</span><span><span leaf="">"X_umap"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> np.random.normal(</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">, size</span><span><span leaf="">=</span></span><span leaf="">(temp_adata.n_obs, </span><span><span leaf="">2</span></span><span leaf="">))</span></span><span leaf=""><br></span><span><span leaf="">temp_adata.varm[</span><span><span leaf="">"gene_stuff"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> np.random.normal(</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">, size</span><span><span leaf="">=</span></span><span leaf="">(temp_adata.n_vars, </span><span><span leaf="">5</span></span><span leaf="">))</span></span><span leaf=""><br></span><span><span leaf="">temp_adata</span></span><span leaf=""><br></span><span><span><span leaf=""># 可以看到X_umap与gene_stuff数据被添加</span></span></span></code></pre><pre><code><span leaf="">## AnnData object with n_obs × n_vars = 100 × 2000</span><span leaf=""><br></span><span leaf="">##     obs: 'cell_type'</span><span leaf=""><br></span><span leaf="">##     var: 'my_pathway'</span><span leaf=""><br></span><span leaf="">##     obsm: 'X_umap'</span><span leaf=""><br></span><span leaf="">##     varm: 'gene_stuff'</span></code></pre><h2 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">4、非结构性的注释信息</span></span></h2><p data-pm-slice="0 0 []"><span leaf="">这部分</span><code><span leaf="">Unstructure metaData</span></code><span leaf="">可以存放在</span><code><span leaf="">.uns</span></code><span leaf="">中，并且对数据格式、内容均无任何要求，可以存放一些提示信息：</span></p><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.uns[</span><span><span leaf="">"random"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> [</span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">3</span></span><span leaf="">]</span></span><span leaf=""><br></span><span><span leaf="">temp_adata.uns</span></span></code></pre><pre><code><span leaf="">## OrderedDict([('random', [1, 2, 3])])</span></code></pre><h2 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">5、Layers</span></span></h2><p data-pm-slice="0 0 []"><span data-pm-slice="0 0 []"><span leaf="">原始的矩阵数据可能会经计算生成一些新的数据，这时我们就可以将这些过程或结果数据存放在不同的</span></span><code><span leaf="">Layers</span></code><span><span leaf="">中，例如数据处理过程中产生的标准化数据</span></span><code><span leaf="">log_transformed</span></code><span><span leaf="">:</span></span></p><pre data-pm-slice="0 0 []"><code><span><span leaf="">temp_adata.layers[</span><span><span leaf="">"log_transformed"</span></span><span leaf="">] </span><span><span leaf="">=</span></span><span leaf=""> np.log1p(temp_adata.X)</span></span><span leaf=""><br></span><span><span leaf="">temp_adata</span></span><span leaf=""><br></span><span><span><span leaf=""># 可以看到新生成的layer</span></span></span></code></pre><pre><code><span leaf="">## AnnData object with n_obs × n_vars = 100 × 2000</span><span leaf=""><br></span><span leaf="">##     obs: 'cell_type'</span><span leaf=""><br></span><span leaf="">##     var: 'my_pathway'</span><span leaf=""><br></span><span leaf="">##     uns: 'random'</span><span leaf=""><br></span><span leaf="">##     obsm: 'X_umap'</span><span leaf=""><br></span><span leaf="">##     varm: 'gene_stuff'</span><span leaf=""><br></span><span leaf="">##     layers: 'log_transformed'</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># Layer也可以直接转换为矩阵</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata.to_df(layer</span><span><span leaf="">=</span></span><span><span leaf="">"log_transformed"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 也可以输出为csb文件：adata.to_df(layer="log_transformed").to_csv("log_transformed.csv")</span></span></span></code></pre><pre><code><span leaf="">##            Gene_0    Gene_1    Gene_2  ...  Gene_1997  Gene_1998  Gene_1999</span><span leaf=""><br></span><span leaf="">## Cell_0   0.693147  0.693147  0.000000  ...   0.693147   0.000000   0.693147</span><span leaf=""><br></span><span leaf="">## Cell_1   0.693147  1.098612  1.098612  ...   0.693147   1.386294   0.693147</span><span leaf=""><br></span><span leaf="">## Cell_2   0.000000  1.098612  0.000000  ...   0.693147   0.693147   0.000000</span><span leaf=""><br></span><span leaf="">## Cell_3   0.000000  0.693147  0.000000  ...   1.098612   0.693147   0.693147</span><span leaf=""><br></span><span leaf="">## Cell_4   0.693147  1.098612  0.000000  ...   1.386294   0.693147   0.000000</span><span leaf=""><br></span><span leaf="">## ...           ...       ...       ...  ...        ...        ...        ...</span><span leaf=""><br></span><span leaf="">## Cell_95  1.098612  0.693147  0.000000  ...   0.693147   0.693147   0.000000</span><span leaf=""><br></span><span leaf="">## Cell_96  0.693147  0.000000  0.693147  ...   0.000000   0.693147   1.609438</span><span leaf=""><br></span><span leaf="">## Cell_97  1.098612  0.693147  0.693147  ...   0.693147   0.693147   0.000000</span><span leaf=""><br></span><span leaf="">## Cell_98  1.386294  0.693147  0.000000  ...   1.386294   0.000000   0.693147</span><span leaf=""><br></span><span leaf="">## Cell_99  0.693147  0.693147  0.693147  ...   1.098612   0.693147   1.386294</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [100 rows x 2000 columns]</span></code></pre><span leaf=""><span textstyle="">6、</span></span><code><span leaf=""><span textstyle="">AnnData</span></span></code><span leaf=""><span textstyle="">存储与读取</span></span></section><code data-pm-slice="0 0 []"><span leaf="">AnnData</span></code><span><span leaf="">可以很方便的以</span></span><code><span leaf="">h5ad</span></code><span><span leaf="">的形式保存在本地，这种格式的读写速度实际体验起来均比</span></span><code><span leaf="">rds</span></code><span><span leaf="">文件要快。如果需要将</span></span><code><span leaf="">AnnData</span></code><span><span leaf="">或</span></span><code><span leaf="">h5ad</span></code><span><span leaf="">格式的对象转换为R语言中</span></span><code><span leaf="">Seurat</span></code><span><span leaf="">可分析的对象，可参考：</span></span><span leaf=""><br></span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247485925&amp;idx=1&amp;sn=14e08440200f0f5cb4dcc2dc615efeb8&amp;chksm=9b3f70b5ac48f9a37a43cc2a8b2a5e485a3f84b4ef87949dfe99056bc6301b110e80800f6bb1&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">各类单细胞对象（数据格式）转换大全（一）</a></span><span leaf=""><br></span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247496786&amp;idx=1&amp;sn=408a81e4824c33eaefe6e9e7f0143c7e&amp;chksm=9b3c8d02ac4b0414bc1d11762b870248743bd9aaaef9d15480fd99a36322d47b448b229345be&amp;token=767842863&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">单细胞对象(数据格式)转换大全|2. h5ad转Seuratobj</a></span><section><pre data-pm-slice="0 0 []"><code><span><span leaf="">adata </span><span><span leaf="">=</span></span><span leaf=""> ad.read(</span><span><span leaf="">'my_results.h5ad'</span></span><span leaf="">, backed</span><span><span leaf="">=</span></span><span><span leaf="">'r'</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">adata.isbacked </span><span><span leaf="">#此时my_results.h5ad处于open状态，即被占用的状态</span></span></span></code></pre><pre><code><span leaf="">## True</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 此时adata可以被正常使用，且多出路径变量</span></span></span><span leaf=""><br></span><span><span leaf="">adata.filename</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 当完成分析时可以解除占用：</span></span></span></code></pre><pre><code><span leaf="">## PosixPath('my_results.h5ad')</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span leaf="">adata.</span><span><span leaf="">file</span></span><span leaf="">.close() </span></span><span leaf=""><br></span><span><span><span leaf=""># 这其实就是scanpy在分析相同的数据比Seurat占用更少内存的秘诀</span></span></span></code></pre><h2 data-pm-slice="0 0 []"><span leaf=""><br></span></h2><h2 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">7、</span></span><code><span leaf=""><span textstyle="">AnnData</span></span></code><span leaf=""><span textstyle="">的</span></span><code><span leaf=""><span textstyle="">Views</span></span></code><span leaf=""><span textstyle="">与</span></span><code><span leaf=""><span textstyle="">copie s</span></span></code></h2><p><span leaf="">与</span><code><span leaf="">pandas</span></code><span leaf="">的</span><code><span leaf="">DataFrame</span></code><span leaf="">一样，</span><code><span leaf="">AnnData</span></code><span leaf="">也可以通过</span><code><span leaf="">Views</span></code><span leaf="">来创建一个对象的”影子”，这样既可以避免占据新的内存，又可以修改原有的对象。</span></p><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 在做View时候也可以使用切片：</span></span></span><span leaf=""><br></span><span><span leaf="">temp_adata[:</span><span><span leaf="">5</span></span><span leaf="">, [</span><span><span leaf="">'Gene_1'</span></span><span leaf="">, </span><span><span leaf="">'Gene_3'</span></span><span leaf="">]]</span></span></code></pre><pre data-pm-slice="0 0 []"><code><span leaf="">## View of AnnData object with n_obs × n_vars = 5 × 2</span><span leaf=""><br></span><span leaf="">##     obs: 'cell_type'</span><span leaf=""><br></span><span leaf="">##     var: 'my_pathway'</span><span leaf=""><br></span><span leaf="">##     uns: 'random'</span><span leaf=""><br></span><span leaf="">##     obsm: 'X_umap'</span><span leaf=""><br></span><span leaf="">##     varm: 'gene_stuff'</span><span leaf=""><br></span><span leaf="">##     layers: 'log_transformed'</span></code></pre><pre data-pm-slice="0 0 []"><code><span><span><span leaf=""># 而copy的方式会占据额外的内存</span></span></span><span leaf=""><br></span><span><span leaf="">adata_subset </span><span><span leaf="">=</span></span><span leaf=""> temp_adata[:</span><span><span leaf="">5</span></span><span leaf="">, [</span><span><span leaf="">'Gene_1'</span></span><span leaf="">, </span><span><span leaf="">'Gene_3'</span></span><span leaf="">]].copy()</span></span></code></pre></section></section></section></section><section><span leaf="">参考：</span><span leaf=""><span textstyle="">https://scanpy.readthedocs.io/en/stable/</span></span></section><section data-pm-slice="0 0 []"><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.5106382978723404" data-w="47" data-width="100%" data-imgfileid="100042173" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><section data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5Ohviaxjsp3ZhRgjJ0mLNVEwpbT2fzdQMNt832icGGUt1ib9G2DMiazWDahA/640?wx_fmt=png" data-fail="0"><section><p><strong><span leaf="">如何联系我们</span></strong><span leaf=""><br></span></p></section></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="1.163265306122449" data-w="49" data-width="100%" data-imgfileid="100042169" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section></section></section><section data-support="96编辑器" data-style-id="34624"><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="图片" data-ratio="0.2463768115942029" data-w="138" data-imgfileid="100042172" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><section><span><span leaf="">留一个领取资料、</span></span><span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247527585&amp;idx=1&amp;sn=fa32112c11b215b33096cab43baf08ea&amp;scene=21#wechat_redirect" textvalue="久违的免费两周学习版上架啦~" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">免费两周学习版</span></a>服务器的</span></span><span><strong><span leaf="">微信号<span textstyle="">[Biomamba_yunying]</span></span></strong></span><span leaf="">，方便各位随时交流。同时我们也构建了<a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528057&amp;idx=1&amp;sn=bb348c2a88c977c7cce67ee6731a3591&amp;scene=21#wechat_redirect" textvalue="Biomamba生信基地交流群矩阵" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">交流群矩阵</span></a>，欢迎大家入群讨论。</span></section><p><span><span leaf=""><br></span></span></p><section><span><span leaf="">大家可以阅读完这几篇之后添加</span></span></section><section><span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">给生信入门初学者的小贴士</a></span><span leaf=""><br></span></span></section><section><span><span leaf=""><a href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247506266&amp;idx=2&amp;sn=22b1164bc9602c25620d058847785422&amp;chksm=9b3ca00aac4b291c16d738271746ffb90149282a728f484e8a1952463c46a8e7dc4f883ab928&amp;scene=21#wechat_redirect" textvalue="如何搜索公众号过往发布内容(内含集锦)" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">如何搜索公众号过往发布内容</a></span></span><span leaf=""><br></span></section><p><span><strong><span leaf="">已有生信基地联系方式的同学</span></strong></span><span><strong><span leaf="">无需重复添加</span></strong></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpyZBGOXDqRYHpgiczxr9PX8gliblp8giaPGsr7w6IeoU6lExTAeEjx48Ke4LEJQfbdiarzXwUGvoRFvyA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="0.46111111111111114" data-w="1080" data-imgfileid="100042171" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpyZBGOXDqRYHpgiczxr9PX8gliblp8giaPGsr7w6IeoU6lExTAeEjx48Ke4LEJQfbdiarzXwUGvoRFvyA/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section></section></section></section></section></section></section><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="图片" data-ratio="0.7619047619047619" data-w="84" data-width="80%" data-imgfileid="100042174" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section><span><span leaf="">您点的每个赞和在看，我都认真当成了喜欢</span></span></section></section></section><section><span leaf=""><br></span></section><section><strong><span leaf=""><br></span></strong></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jSFWQ53bgLawxaxsZdOERQ",target="_blank" rel="noopener noreferrer">原文链接</a>
