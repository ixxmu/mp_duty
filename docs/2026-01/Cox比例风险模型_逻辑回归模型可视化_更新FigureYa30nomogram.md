---
title: "Cox比例风险模型、逻辑回归模型可视化｜更新FigureYa30nomogram"
date: 2026-01-16T11:43:51Z
draft: ["false"]
tags: [
  "fetched",
  "小丫画图"
]
categories: ["Acdemic"]
---
Cox比例风险模型、逻辑回归模型可视化｜更新FigureYa30nomogram by 小丫画图
------
<div><section><section powered-by="xiumi.us"><section><section><section><section><section><p><span><span leaf="">小丫碎碎念：</span></span></p><p><span><span leaf="">交互式有时是优点，有时是缺点。</span></span></p><p data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"color: #800000;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>regplot这个R包能在弹出的窗口里点鼠标修改参数<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3NTA1MTM0NQ==&amp;mid=2247484525&amp;idx=1&amp;sn=7511f2193159e6ce701b56073c2a6d10&amp;scene=21#wechat_redirect" textvalue="鼠标点点点，就能画出酷炫的nomogram" data-itemshowtype="0" linktype="text" data-linktype="2">鼠标点点点，就能画出酷炫的nomogram</a></span></p><ul><li><p data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"color: #800000;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>优点：边改边看效果，</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []","style":"margin-bottom: 24px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":null},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>很灵活。</span></p></li><li><p data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []","style":"margin-bottom: 24px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":null},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>缺点：必须额外记录点了哪个选项，后面重新画图时才能重复出同样的效果。</span></p></li></ul><p data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []","style":"margin-bottom: 24px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":null},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>针对这一缺点，拆开R包</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []","style":null},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":null},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>regplot，</span><span leaf="">修改regplot函数，使其能够在 R Markdown 渲染时自动生成 PDF 文件。</span><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"p","attributes":{"data-pm-slice":"0 0 []","style":"margin-bottom: 24px;margin-top: 24px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'>参数写好，</span><span leaf="">无需每次点鼠标调整，即可重复出同样效果。</span></p></section></section></section></section></section></section></section><section data-pm-slice='3 4 ["para",{"tagName":"section","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"powered-by":"xiumi.us"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><section data-pm-slice="10 10 []"><section><section><p><span leaf="">我们拆过的R包：</span></p><ul><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3NTA1MTM0NQ==&amp;mid=2247487915&amp;idx=1&amp;sn=e848392b67a665c86b39de0953d3d2a5&amp;scene=21#wechat_redirect" textvalue="预后分析第二关——精选独立预后因子｜FigureYa31lasso" data-itemshowtype="0" linktype="text" data-linktype="2">预后分析第二关——精选独立预后因子｜FigureYa31lasso</a></span></p></li><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3NTA1MTM0NQ==&amp;mid=2247486410&amp;idx=1&amp;sn=944c559ac835d52020f0edc78c3ba73d&amp;scene=21#wechat_redirect" textvalue="没见过写R包，还么见过拆R包吗｜FigureYa74OmicCircos" data-itemshowtype="0" linktype="text" data-linktype="2">没见过写R包，还么见过拆R包吗｜FigureYa74OmicCircos</a></span></p></li></ul><p><span leaf=""><br></span></p><h1><span leaf="">下载代码文档、输入和输出文件，</span><span leaf="">分类检索、看缩略图，</span><span><span leaf="">请访问</span></span></h1><p><span leaf="">https://ying-ge.github.io/FigureYa/</span></p><p><span leaf=""><span textstyle="">或https://figureya.online/，国内访问更顺畅</span></span></p></section></section></section><section><section><section><h1 tabindex="-1" dir="auto" data-pm-slice="0 0 []"><strong><span leaf=""><span textstyle="">1 Citation</span></span></strong></h1><section><span><span leaf="">Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization Framework for Enhancing Biomedical Data Interpretation and Research Efficiency. iMetaMed. </span><span><span leaf=""> 1: e70005.</span></span><span leaf=""> https://doi.org/10.1002/imm3.70005</span></span></section></section></section></section></section><section data-pm-slice="5 3 []"><span></span></section><h2 data-pm-slice="0 0 []"><span><span leaf="">2</span></span><span leaf=""> 需求描述</span></h2><p><span leaf="">画出新型nomogram图（d）和对比曲线（f、g）</span></p><p data-pm-slice="0 0 []"><span><span leaf="">c森林图的画法可参考FigureYa90subgroup来画，h和i图可参考FigureYa33DCA_update。</span></span></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004349" data-ratio="0.6712962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiarP42Mtar7Wdu13TfYvGduVfJuDyTNXuHHDmSQy3Q3yW75E71MuvkMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiarP42Mtar7Wdu13TfYvGduVfJuDyTNXuHHDmSQy3Q3yW75E71MuvkMA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">From https://linkinghub.elsevier.com/retrieve/pii/S2352396419301884</span></span></p><p><span leaf=""><span textstyle="">Fig. 3. (d–e) Nomograms for predicting the probability of patient mortality based on TMRS-RFS (d), TMRS-OS (e) and clinical variables; (f–g) Plots depict the calibration of nomograms based on TMRS-RFS (f) and TMRS-OS (g) in terms of agreement between predicted and observed 2-year, 3-year, and 5-year outcomes. Nomogram performance is shown by the plot, relative to the 45-degree line, which represents the ideal prediction; (h–i) Decision curve analyses of the nomograms based on TMRS-RFS (h) and TMRS-OS (i) for 2-year, 3-year, and 5-year risk. ADJC, adjuvant chemotherapy; TMRS, tumour microenvironment risk score; RFS, relapse-free survival; OS, overall survival; Pr, probability; Nomo, nomogram.</span></span></p><h2><span><span leaf="">3</span></span><span leaf=""> 应用场景</span></h2><p><span leaf="">列线图（nomogram，诺莫图）是在平面直角坐标系中用一簇互不相交的线段表示多个独立变量之间函数关系的图。</span></p><p><span leaf="">将Logistic回归或Cox回归的结果进行可视化呈现，给出其发病风险或比例风险。</span></p><h2><span><span leaf="">4</span></span><span leaf=""> 环境设置</span></h2><pre><code><span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">"install_dependencies.R"</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## Starting R package installation...</span><span leaf=""><br></span><span leaf="">## ===========================================</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## Installing CRAN packages...</span><span leaf=""><br></span><span leaf="">## Package already installed: nomogramEx </span><span leaf=""><br></span><span leaf="">## Package already installed: regplot </span><span leaf=""><br></span><span leaf="">## Package already installed: rms </span><span leaf=""><br></span><span leaf="">## Package already installed: survival </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## ===========================================</span><span leaf=""><br></span><span leaf="">## Package installation completed!</span><span leaf=""><br></span><span leaf="">## You can now run your R scripts in this directory.</span></code></pre><pre><code><span><span><span leaf="">library</span></span><span leaf="">(survival) </span><span><span leaf=""># 生存分析 survival analysis</span></span></span><span leaf=""><br></span><span><span><span leaf="">library</span></span><span leaf="">(regplot) </span><span><span leaf=""># 新型nomogram new nomogram</span></span></span><span leaf=""><br></span><span><span><span leaf="">library</span></span><span leaf="">(rms) </span><span><span leaf=""># 经典nomogram classic nomogram</span></span></span><span leaf=""><br></span><span><span><span leaf="">library</span></span><span leaf="">(nomogramEx) </span><span><span leaf=""># 输出nomogram公式 output nomogram formula</span></span></span><span leaf=""><br></span><span><span><span leaf="">Sys.setenv</span></span><span leaf="">(</span><span><span leaf="">LANGUAGE =</span></span><span><span leaf="">"en"</span></span><span leaf="">) </span><span><span leaf=""><a topic-id="mkdr3hjz-30sn3v" data-topic="1">#显示英文报错信息</a> display English error messages</span></span></span><span leaf=""><br></span><span><span><span leaf="">options</span></span><span leaf="">(</span><span><span leaf="">stringsAsFactors =</span></span><span><span leaf="">FALSE</span></span><span leaf="">) </span><span><span leaf=""><a topic-id="mkdr3hjz-qqwnl8" data-topic="1">#禁止chr转成factor</a> prohibit the conversion of chr to factor</span></span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 加载修改后的 regplot 函数，使其支持非交互式环境生成 PDF</span></span></span><span leaf=""><br></span><span><span><span leaf=""># Load modified regplot function to support non-interactive PDF generation</span></span></span><span leaf=""><br></span><span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">"regplot_functions_modified.R"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">source</span></span><span leaf="">(</span><span><span leaf="">"regplot_modified.R"</span></span><span leaf="">)</span></span></code></pre><h2><span><span leaf="">5</span></span><span leaf=""> 输入文件</span></h2><p><span leaf="">至少要有临床信息</span><code><span leaf="">easy_input.csv</span></code><span leaf="">，还可以把</span><code><span leaf="">FigureYa31lasso</span></code><span leaf="">输出的</span><code><span leaf="">lasso_output.txt</span></code><span leaf="">作为一列添加进来。</span></p><pre><code><span><span leaf="">pbc </span><span><span leaf="">&lt;-</span></span><span><span leaf="">read.table</span></span><span leaf="">(</span><span><span leaf="">"easy_input.txt"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span leaf="">pbc</span><span><span leaf="">$</span></span><span leaf="">catbili </span><span><span leaf="">&lt;-</span></span><span><span leaf="">cut</span></span><span leaf="">(pbc</span><span><span leaf="">$</span></span><span leaf="">bili, </span><span><span leaf="">breaks =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">-</span></span><span><span leaf="">Inf</span></span><span leaf="">, </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">4</span></span><span leaf="">, </span><span><span leaf="">Inf</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">labels=</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"low"</span></span><span leaf="">, </span><span><span leaf="">"medium"</span></span><span leaf="">, </span><span><span leaf="">"high"</span></span><span leaf="">))</span></span><span leaf=""><br></span><span><span leaf="">pbc</span><span><span leaf="">$</span></span><span leaf="">died </span><span><span leaf="">&lt;-</span></span><span leaf=""> pbc</span><span><span leaf="">$</span></span><span leaf="">status </span><span><span leaf="">==</span></span><span><span leaf="">2</span></span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">head</span></span><span leaf="">(pbc)</span></span></code></pre><pre><code><span leaf="">##          time status trt      age sex ascites hepato spiders edema bili chol</span><span leaf=""><br></span><span leaf="">## patient1  400      2   1 58.76523   f       1      1       1   1.0 14.5  261</span><span leaf=""><br></span><span leaf="">## patient2 4500      0   1 56.44627   f       0      1       1   0.0  1.1  302</span><span leaf=""><br></span><span leaf="">## patient3 1012      2   1 70.07255   m       0      0       0   0.5  1.4  176</span><span leaf=""><br></span><span leaf="">## patient4 1925      2   1 54.74059   f       0      1       1   0.5  1.8  244</span><span leaf=""><br></span><span leaf="">## patient5 1504      1   2 38.10541   f       0      1       1   0.0  3.4  279</span><span leaf=""><br></span><span leaf="">## patient6 2503      2   2 66.25873   f       0      1       0   0.0  0.8  248</span><span leaf=""><br></span><span leaf="">##          albumin copper alk.phos    ast trig platelet protime stage catbili</span><span leaf=""><br></span><span leaf="">## patient1    2.60    156   1718.0 137.95  172      190    12.2     4    high</span><span leaf=""><br></span><span leaf="">## patient2    4.14     54   7394.8 113.52   88      221    10.6     3     low</span><span leaf=""><br></span><span leaf="">## patient3    3.48    210    516.0  96.10   55      151    12.0     4     low</span><span leaf=""><br></span><span leaf="">## patient4    2.54     64   6121.8  60.63   92      183    10.3     4     low</span><span leaf=""><br></span><span leaf="">## patient5    3.53    143    671.0 113.15   72      136    10.9     3  medium</span><span leaf=""><br></span><span leaf="">## patient6    3.98     50    944.0  93.00   63       NA    11.0     3     low</span><span leaf=""><br></span><span leaf="">##           died</span><span leaf=""><br></span><span leaf="">## patient1  TRUE</span><span leaf=""><br></span><span leaf="">## patient2 FALSE</span><span leaf=""><br></span><span leaf="">## patient3  TRUE</span><span leaf=""><br></span><span leaf="">## patient4  TRUE</span><span leaf=""><br></span><span leaf="">## patient5 FALSE</span><span leaf=""><br></span><span leaf="">## patient6  TRUE</span></code></pre><h2><span><span leaf="">6</span></span><span leaf=""> 画nomogram</span></h2><p><span leaf="">这里提供两种风格的nomogram画法，用到不同的包</span></p><h3><span><span leaf="">6.1</span></span><span leaf=""> 经典版</span></h3><pre><code><span><span leaf="">dd </span><span><span leaf="">&lt;-</span></span><span><span leaf="">datadist</span></span><span leaf="">(pbc)</span></span><span leaf=""><br></span><span><span><span leaf="">options</span></span><span leaf="">(</span><span><span leaf="">datadist=</span></span><span><span leaf="">"dd"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">options</span></span><span leaf="">(</span><span><span leaf="">na.action=</span></span><span><span leaf="">"na.delete"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">summary</span></span><span leaf="">(pbc</span><span><span leaf="">$</span></span><span leaf="">time)</span></span></code></pre><pre><code><span leaf="">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span><span leaf=""><br></span><span leaf="">##      41    1093    1730    1918    2614    4795</span></code></pre><pre><code><span><span leaf="">coxpbc </span><span><span leaf="">&lt;-</span></span><span><span leaf="">cph</span></span><span leaf="">(</span><span><span leaf="">formula =</span></span><span><span leaf="">Surv</span></span><span leaf="">(time,died) </span><span><span leaf="">~</span></span><span leaf="">  age </span><span><span leaf="">+</span></span><span leaf=""> catbili </span><span><span leaf="">+</span></span><span leaf=""> sex </span><span><span leaf="">+</span></span><span leaf=""> copper </span><span><span leaf="">+</span></span><span leaf=""> stage </span><span><span leaf="">+</span></span><span leaf=""> trt ,</span><span><span leaf="">data=</span></span><span leaf="">pbc,</span><span><span leaf="">x=</span></span><span leaf="">T,</span><span><span leaf="">y=</span></span><span leaf="">T,</span><span><span leaf="">surv =</span></span><span leaf=""> T,</span><span><span leaf="">na.action=</span></span><span leaf="">na.delete)  </span><span><span leaf="">#,time.inc =2920</span></span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(coxpbc)</span></span></code></pre><pre><code><span leaf="">## Frequencies of Missing Values Due to Each Variable</span><span leaf=""><br></span><span leaf="">## Surv(time, died)              age          catbili              sex </span><span leaf=""><br></span><span leaf="">##                0                0                0                0 </span><span leaf=""><br></span><span leaf="">##           copper            stage              trt </span><span leaf=""><br></span><span leaf="">##              108                6              106 </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## Cox Proportional Hazards Model</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## cph(formula = Surv(time, died) ~ age + catbili + sex + copper + </span><span leaf=""><br></span><span leaf="">##     stage + trt, data = pbc, na.action = na.delete, x = T, y = T, </span><span leaf=""><br></span><span leaf="">##     surv = T)</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">##                        Model Tests    Discrimination    </span><span leaf=""><br></span><span leaf="">##                                              Indexes    </span><span leaf=""><br></span><span leaf="">## Obs       310    LR chi2    161.30    R2       0.413    </span><span leaf=""><br></span><span leaf="">## Events    124    d.f.            7    R2(7,310)0.392    </span><span leaf=""><br></span><span leaf="">## Center 4.3475    Pr(&gt; chi2) 0.0000    R2(7,124)0.712    </span><span leaf=""><br></span><span leaf="">##                  Score chi2 199.30    Dxy      0.672    </span><span leaf=""><br></span><span leaf="">##                  Pr(&gt; chi2) 0.0000                      </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">##                Coef    S.E.   Wald Z Pr(&gt;|Z|)</span><span leaf=""><br></span><span leaf="">## age             0.0322 0.0091  3.53  0.0004  </span><span leaf=""><br></span><span leaf="">## catbili=medium  1.4084 0.2489  5.66  &lt;0.0001 </span><span leaf=""><br></span><span leaf="">## catbili=high    1.8117 0.2493  7.27  &lt;0.0001 </span><span leaf=""><br></span><span leaf="">## sex=m          -0.2581 0.2818 -0.92  0.3596  </span><span leaf=""><br></span><span leaf="">## copper          0.0031 0.0011  2.91  0.0036  </span><span leaf=""><br></span><span leaf="">## stage           0.5431 0.1325  4.10  &lt;0.0001 </span><span leaf=""><br></span><span leaf="">## trt             0.1106 0.1902  0.58  0.5608</span></code></pre><pre><code><span><span leaf="">surv </span><span><span leaf="">&lt;-</span></span><span><span leaf="">Survival</span></span><span leaf="">(coxpbc) </span></span><span leaf=""><br></span><span><span leaf="">surv3 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">function</span></span><span leaf="">(x) </span><span><span leaf="">surv</span></span><span leaf="">(</span><span><span leaf="">1825</span></span><span leaf="">,x)</span></span><span leaf=""><br></span><span><span leaf="">surv4 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">function</span></span><span leaf="">(x) </span><span><span leaf="">surv</span></span><span leaf="">(</span><span><span leaf="">2920</span></span><span leaf="">,x)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">x </span><span><span leaf="">&lt;-</span></span><span><span leaf="">nomogram</span></span><span leaf="">(coxpbc,</span><span><span leaf="">fun =</span></span><span><span leaf="">list</span></span><span leaf="">(surv3,surv4),</span><span><span leaf="">lp=</span></span><span leaf="">T,</span></span><span leaf=""><br></span><span><span><span leaf="">funlabel =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">'5-year survival Probability'</span></span><span leaf="">,</span><span><span leaf="">'8-year survival Probability'</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">maxscale =</span></span><span><span leaf="">100</span></span><span leaf="">,</span><span><span leaf="">fun.at =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0.95</span></span><span leaf="">,</span><span><span leaf="">0.9</span></span><span leaf="">,</span><span><span leaf="">0.8</span></span><span leaf="">,</span><span><span leaf="">0.7</span></span><span leaf="">,</span><span><span leaf="">0.6</span></span><span leaf="">,</span><span><span leaf="">0.5</span></span><span leaf="">,</span><span><span leaf="">0.4</span></span><span leaf="">,</span><span><span leaf="">0.3</span></span><span leaf="">,</span><span><span leaf="">0.2</span></span><span leaf="">,</span><span><span leaf="">0.1</span></span><span leaf="">))</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span><span leaf="">pdf</span></span><span leaf="">(</span><span><span leaf="">"nomogram_classical.pdf"</span></span><span leaf="">,</span><span><span leaf="">width =</span></span><span><span leaf="">12</span></span><span leaf="">,</span><span><span leaf="">height =</span></span><span><span leaf="">10</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">plot</span></span><span leaf="">(x, </span><span><span leaf="">lplabel=</span></span><span><span leaf="">"Linear Predictor"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">xfrac=</span></span><span leaf="">.</span><span><span leaf="">35</span></span><span leaf="">,</span><span><span leaf="">varname.label=</span></span><span><span leaf="">TRUE</span></span><span leaf="">, </span><span><span leaf="">varname.label.sep=</span></span><span><span leaf="">"="</span></span><span leaf="">, </span><span><span leaf="">ia.space=</span></span><span leaf="">.</span><span><span leaf="">2</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">tck=</span></span><span><span leaf="">NA</span></span><span leaf="">, </span><span><span leaf="">tcl=</span></span><span><span leaf="">-</span></span><span><span leaf="">0.20</span></span><span leaf="">, </span><span><span leaf="">lmgp=</span></span><span><span leaf="">0.3</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">points.label=</span></span><span><span leaf="">'Points'</span></span><span leaf="">, </span><span><span leaf="">total.points.label=</span></span><span><span leaf="">'Total Points'</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">total.sep.page=</span></span><span><span leaf="">FALSE</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">cap.labels=</span></span><span><span leaf="">FALSE</span></span><span leaf="">,</span><span><span leaf="">cex.var =</span></span><span><span leaf="">1.6</span></span><span leaf="">,</span><span><span leaf="">cex.axis =</span></span><span><span leaf="">1.05</span></span><span leaf="">,</span><span><span leaf="">lwd=</span></span><span><span leaf="">5</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">label.every =</span></span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">col.grid =</span></span><span><span leaf="">gray</span></span><span leaf="">(</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0.8</span></span><span leaf="">, </span><span><span leaf="">0.95</span></span><span leaf="">)))</span></span><span leaf=""><br></span><span><span><span leaf="">dev.off</span></span><span leaf="">()</span></span></code></pre><pre><code><span leaf="">## pdf </span><span leaf=""><br></span><span leaf="">##   2</span></code></pre><p><embed role="img"></embed></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004351" data-ratio="0.7888888888888889" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiarfcIWia4MqUvooVhLKRhzibuRgHwIf0ys4icesxfyaWNFOWEGx8aLkvnA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiarfcIWia4MqUvooVhLKRhzibuRgHwIf0ys4icesxfyaWNFOWEGx8aLkvnA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">输出公式</span></p><pre><code><span><span><span leaf=""><a topic-id="mkdr3hjz-bzuyro" data-topic="1">#print</a>(x)</span></span></span><span leaf=""><br></span><span><span><span leaf="">nomogramEx</span></span><span leaf="">(</span><span><span leaf="">nomo=</span></span><span leaf="">x,</span><span><span leaf="">np=</span></span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf="">digit =</span></span><span><span leaf="">9</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## $RESULT</span><span leaf=""><br></span><span leaf="">## [1] "The equation of each variable as follows:"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[2]]</span><span leaf=""><br></span><span leaf="">## [1] "points = 1.720070183 * age + -43.001754587"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[3]]</span><span leaf=""><br></span><span leaf="">##     catbili</span><span leaf=""><br></span><span leaf="">## 13  0.00000</span><span leaf=""><br></span><span leaf="">## 14 75.29340</span><span leaf=""><br></span><span leaf="">## 15 96.85421</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[4]]</span><span leaf=""><br></span><span leaf="">##         sex</span><span leaf=""><br></span><span leaf="">## 16 13.79964</span><span leaf=""><br></span><span leaf="">## 17  0.00000</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[5]]</span><span leaf=""><br></span><span leaf="">## [1] "points = 0 * copper ^3 + 0 * copper ^2 + 0.166666667 * copper + 0"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[6]]</span><span leaf=""><br></span><span leaf="">##       stage</span><span leaf=""><br></span><span leaf="">## 31  0.00000</span><span leaf=""><br></span><span leaf="">## 32 29.03326</span><span leaf=""><br></span><span leaf="">## 33 58.06653</span><span leaf=""><br></span><span leaf="">## 34 87.09979</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[7]]</span><span leaf=""><br></span><span leaf="">##         trt</span><span leaf=""><br></span><span leaf="">## 35 0.000000</span><span leaf=""><br></span><span leaf="">## 36 5.914188</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[8]]</span><span leaf=""><br></span><span leaf="">## [1] "5-year survival Probability = 5.9e-08 * points ^3 + -5.1054e-05 * points ^2 + 0.008126192 * points + 0.583874866"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[9]]</span><span leaf=""><br></span><span leaf="">## [1] "8-year survival Probability = 5.9e-08 * points ^3 + -4.3812e-05 * points ^2 + 0.004242289 * points + 0.835039968"</span></code></pre><h2><span><span leaf="">7</span></span><span leaf=""> 画新型nomogram</span></h2><p><code><span leaf="">regplot</span></code><span leaf="">可以交互式调整nomogram，代码更简单，输出的图形更漂亮。</span></p><p><span leaf="">本模块已加载修改后的 </span><code><span leaf="">regplot</span></code><span leaf=""> 函数，使其能够在渲染过程中自动生成 PDF 文件。</span></p><h3><span><span leaf="">7.1</span></span><span leaf=""> Cox 回归 nomogram </span></h3><pre><code><span><span leaf="">pbccox </span><span><span leaf="">&lt;-</span></span><span><span leaf="">coxph</span></span><span leaf="">(</span><span><span leaf="">formula =</span></span><span><span leaf="">Surv</span></span><span leaf="">(time,died) </span><span><span leaf="">~</span></span><span leaf="">  age </span><span><span leaf="">+</span></span><span leaf=""> catbili </span><span><span leaf="">+</span></span><span leaf=""> sex </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span leaf="">                   copper </span><span><span leaf="">+</span></span><span leaf=""> stage </span><span><span leaf="">+</span></span><span leaf=""> trt , </span><span><span leaf="">data =</span></span><span leaf=""> pbc)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span><span leaf=""># 生成 Cox 回归 nomogram PDF</span></span></span><span leaf=""><br></span><span><span><span leaf=""># Generate Cox regression nomogram PDF</span></span></span><span leaf=""><br></span><span><span><span leaf="">pdf</span></span><span leaf="">(</span><span><span leaf="">"nomogram_regplot_cox.pdf"</span></span><span leaf="">, </span><span><span leaf="">width =</span></span><span><span leaf="">12</span></span><span leaf="">, </span><span><span leaf="">height =</span></span><span><span leaf="">8</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">regplot</span></span><span leaf="">(pbccox,</span></span><span leaf=""><br></span><span><span><span leaf="">observation=</span></span><span leaf="">pbc[</span><span><span leaf="">2</span></span><span leaf="">,], </span><span><span leaf=""><a topic-id="mkdr3hjz-37emov" data-topic="1">#对观测2的六个指标在列线图上进行计分展示</a>，也可以不展示 the six indicators for Observation 2 can be scored and displayed on the nomogram, or they may not be displayed.</span></span></span><span leaf=""><br></span><span><span><span leaf="">points =</span></span><span><span leaf="">TRUE</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-vdigd2" data-topic="1">#如果为FALSE</a>，则显示每个βx贡献的回归分数。否则，贡献将以 0-100 的"点数"刻度表示 If FALSE the regression scores of each βx contribution are shown. Otherwise contributions are represented by a 0-100 "points" scale.</span></span></span><span leaf=""><br></span><span><span><span leaf="">plots =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"density"</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-k0jh3a" data-topic="1">#可选</a>"no plot" "density" "boxes" "ecdf" "bars" "boxplot" "violin" "bean" "spikes" optional "no plot" "density" "boxes" "ecdf" "bars" "boxplot" "violin" "bean" "spikes"</span></span></span><span leaf=""><br></span><span><span><span leaf="">"boxes"</span></span><span leaf="">), </span><span><span leaf=""><a topic-id="mkdr3hk0-a4e1gg" data-topic="1">#可选</a>"no plot" "boxes" "bars" "spikes" optional "no plot" "boxes" "bars" "spikes"</span></span></span><span leaf=""><br></span><span><span><span leaf="">failtime =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">1095</span></span><span leaf="">,</span><span><span leaf="">1825</span></span><span leaf="">), </span><span><span leaf=""><a topic-id="mkdr3hk0-olni2b" data-topic="1">#预测3年和5年的死亡风险</a>，此处单位是day predict the risk of death over 3 and 5 years, with the unit being days.</span></span></span><span leaf=""><br></span><span><span><span leaf="">subticks =</span></span><span><span leaf="">TRUE</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">clickable =</span></span><span><span leaf="">FALSE</span></span><span leaf="">, </span><span><span leaf=""># 非交互式环境必须设置为 FALSE / Must be FALSE in non-interactive environment</span></span></span><span leaf=""><br></span><span><span><span leaf="">prfail =</span></span><span><span leaf="">TRUE</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-1vi41s" data-topic="1">#cox回归中需要TRUE</a> TRUE is required in cox regression</span></span></span><span leaf=""><br></span><span><span><span leaf="">showP =</span></span><span leaf=""> T, </span><span><span leaf=""><a topic-id="mkdr3hk0-dvilb3" data-topic="1">#是否展示统计学差异</a> whether to demonstrate statistical differences</span></span></span><span leaf=""><br></span><span><span><span leaf="">droplines =</span></span><span leaf=""> F,</span><span><span leaf=""><a topic-id="mkdr3hk0-jkb2oo" data-topic="1">#观测2示例计分是否画线</a> Observation 2 example scoring whether or not to draw a line</span></span></span><span leaf=""><br></span><span><span><span leaf="">rank=</span></span><span><span leaf="">"range"</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-y1av2v" data-topic="1">#rank</a>="range "表示βx的范围，rank="sd "表示βx的标准差 rank="range" is by the range of the βx's, and rank="sd" is by the standard deviation of the βx's.</span></span></span><span leaf=""><br></span><span><span><span leaf="">interval=</span></span><span><span leaf="">"confidence"</span></span><span leaf="">) </span><span><span leaf=""><a topic-id="mkdr3hk0-kbxf9g" data-topic="1">#展示观测的可信区间</a> demonstrate confidence intervals for observations</span></span></span></code></pre><pre><code><span leaf="">## [[1]]</span><span leaf=""><br></span><span leaf="">##   trt Points</span><span leaf=""><br></span><span leaf="">## 1   1     36</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[2]]</span><span leaf=""><br></span><span leaf="">##   stage Points</span><span leaf=""><br></span><span leaf="">## 1     1      0</span><span leaf=""><br></span><span leaf="">## 2     2     19</span><span leaf=""><br></span><span leaf="">## 3     3     37</span><span leaf=""><br></span><span leaf="">## 4     4     56</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[3]]</span><span leaf=""><br></span><span leaf="">##   copper Points</span><span leaf=""><br></span><span leaf="">## 1      0     27</span><span leaf=""><br></span><span leaf="">## 2    100     38</span><span leaf=""><br></span><span leaf="">## 3    200     49</span><span leaf=""><br></span><span leaf="">## 4    300     59</span><span leaf=""><br></span><span leaf="">## 5    400     70</span><span leaf=""><br></span><span leaf="">## 6    500     81</span><span leaf=""><br></span><span leaf="">## 7    600     92</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[4]]</span><span leaf=""><br></span><span leaf="">##      sex Points</span><span leaf=""><br></span><span leaf="">## sex2   m     29</span><span leaf=""><br></span><span leaf="">## sex1   f     38</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[5]]</span><span leaf=""><br></span><span leaf="">##          catbili Points</span><span leaf=""><br></span><span leaf="">## catbili1     low     38</span><span leaf=""><br></span><span leaf="">## catbili2  medium     86</span><span leaf=""><br></span><span leaf="">## catbili3    high    100</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[6]]</span><span leaf=""><br></span><span leaf="">##   age Points</span><span leaf=""><br></span><span leaf="">## 1  25     10</span><span leaf=""><br></span><span leaf="">## 2  35     21</span><span leaf=""><br></span><span leaf="">## 3  45     32</span><span leaf=""><br></span><span leaf="">## 4  55     43</span><span leaf=""><br></span><span leaf="">## 5  65     54</span><span leaf=""><br></span><span leaf="">## 6  75     65</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[7]]</span><span leaf=""><br></span><span leaf="">##   Total Points Pr( time &lt; 1095 )</span><span leaf=""><br></span><span leaf="">## 1          150            0.0069</span><span leaf=""><br></span><span leaf="">## 2          200            0.0292</span><span leaf=""><br></span><span leaf="">## 3          250            0.1196</span><span leaf=""><br></span><span leaf="">## 4          300            0.4215</span><span leaf=""><br></span><span leaf="">## 5          350            0.9047</span><span leaf=""><br></span><span leaf="">## 6          400            1.0000</span></code></pre><pre><code><span><span><span leaf="">dev.off</span></span><span leaf="">()</span></span></code></pre><pre><code><span leaf="">## pdf </span><span leaf=""><br></span><span leaf="">##   2</span></code></pre><p><embed role="img"></embed></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004352" data-ratio="0.7027777777777777" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiae2SpSxAj8vBMqtImcPBgNSdheq09zS4S7lTBtX5ib1oMlO5FHEcFp6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiae2SpSxAj8vBMqtImcPBgNSdheq09zS4S7lTBtX5ib1oMlO5FHEcFp6Q/640?wx_fmt=png&amp;from=appmsg"></section><h3><span><span leaf="">7.2</span></span><span leaf=""> 逻辑回归 nomogram </span></h3><pre><code><span><span><span leaf="">## 绘制逻辑回归图，显示几率表和置信区间</span></span></span><span leaf=""><br></span><span><span><span leaf="">## Plot a logistic regression, showing odds scale and confidence interval</span></span></span><span leaf=""><br></span><span><span leaf="">pbcglm </span><span><span leaf="">&lt;-</span></span><span><span leaf="">glm</span></span><span leaf="">(died </span><span><span leaf="">~</span></span><span leaf="">  age </span><span><span leaf="">+</span></span><span leaf=""> catbili </span><span><span leaf="">+</span></span><span leaf=""> sex </span><span><span leaf="">+</span></span><span leaf=""> copper, </span><span><span leaf="">family =</span></span><span><span leaf="">"binomial"</span></span><span leaf="">, </span><span><span leaf="">data=</span></span><span leaf="">pbc )</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""># 生成逻辑回归 nomogram PDF</span></span></span><span leaf=""><br></span><span><span><span leaf=""># Generate logistic regression nomogram PDF</span></span></span><span leaf=""><br></span><span><span><span leaf="">pdf</span></span><span leaf="">(</span><span><span leaf="">"nomogram_regplot_glm.pdf"</span></span><span leaf="">, </span><span><span leaf="">width =</span></span><span><span leaf="">10</span></span><span leaf="">, </span><span><span leaf="">height =</span></span><span><span leaf="">8</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">regplot</span></span><span leaf="">(pbcglm,</span></span><span leaf=""><br></span><span><span><span leaf="">observation=</span></span><span leaf="">pbc[</span><span><span leaf="">1</span></span><span leaf="">,],</span></span><span leaf=""><br></span><span><span><span leaf="">points =</span></span><span><span leaf="">TRUE</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">subticks =</span></span><span><span leaf="">TRUE</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">clickable =</span></span><span><span leaf="">FALSE</span></span><span leaf="">, </span><span><span leaf=""># 非交互式环境必须设置为 FALSE / Must be FALSE in non-interactive environment</span></span></span><span leaf=""><br></span><span><span><span leaf="">odds =</span></span><span><span leaf="">TRUE</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">interval =</span></span><span><span leaf="">"confidence"</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## [[1]]</span><span leaf=""><br></span><span leaf="">##   copper Points</span><span leaf=""><br></span><span leaf="">## 1      0     26</span><span leaf=""><br></span><span leaf="">## 2    100     39</span><span leaf=""><br></span><span leaf="">## 3    200     51</span><span leaf=""><br></span><span leaf="">## 4    300     64</span><span leaf=""><br></span><span leaf="">## 5    400     76</span><span leaf=""><br></span><span leaf="">## 6    500     89</span><span leaf=""><br></span><span leaf="">## 7    600    102</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[2]]</span><span leaf=""><br></span><span leaf="">##      sex Points</span><span leaf=""><br></span><span leaf="">## sex1   f     38</span><span leaf=""><br></span><span leaf="">## sex2   m     47</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[3]]</span><span leaf=""><br></span><span leaf="">##          catbili Points</span><span leaf=""><br></span><span leaf="">## catbili1     low     38</span><span leaf=""><br></span><span leaf="">## catbili2  medium     77</span><span leaf=""><br></span><span leaf="">## catbili3    high     93</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[4]]</span><span leaf=""><br></span><span leaf="">##    age Points</span><span leaf=""><br></span><span leaf="">## 1   25     -2</span><span leaf=""><br></span><span leaf="">## 2   30      6</span><span leaf=""><br></span><span leaf="">## 3   35     14</span><span leaf=""><br></span><span leaf="">## 4   40     22</span><span leaf=""><br></span><span leaf="">## 5   45     30</span><span leaf=""><br></span><span leaf="">## 6   50     38</span><span leaf=""><br></span><span leaf="">## 7   55     46</span><span leaf=""><br></span><span leaf="">## 8   60     55</span><span leaf=""><br></span><span leaf="">## 9   65     63</span><span leaf=""><br></span><span leaf="">## 10  70     71</span><span leaf=""><br></span><span leaf="">## 11  75     79</span><span leaf=""><br></span><span leaf="">## 12  80     87</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[5]]</span><span leaf=""><br></span><span leaf="">##    Total Points Pr( died )</span><span leaf=""><br></span><span leaf="">## 1           100    0.03034</span><span leaf=""><br></span><span leaf="">## 2           120    0.06589</span><span leaf=""><br></span><span leaf="">## 3           140    0.13720</span><span leaf=""><br></span><span leaf="">## 4           160    0.26390</span><span leaf=""><br></span><span leaf="">## 5           180    0.44700</span><span leaf=""><br></span><span leaf="">## 6           200    0.64570</span><span leaf=""><br></span><span leaf="">## 7           220    0.80420</span><span leaf=""><br></span><span leaf="">## 8           240    0.90250</span><span leaf=""><br></span><span leaf="">## 9           260    0.95430</span><span leaf=""><br></span><span leaf="">## 10          280    0.97920</span><span leaf=""><br></span><span leaf="">## 11          300    0.99070</span><span leaf=""><br></span><span leaf="">## 12          320    0.99580</span></code></pre><pre><code><span><span><span leaf="">dev.off</span></span><span leaf="">()</span></span></code></pre><pre><code><span leaf="">## pdf </span><span leaf=""><br></span><span leaf="">##   2</span></code></pre><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004353" data-ratio="0.7592592592592593" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiaCavEe0Xvbeb0doLOBibgpnI32fklOmMDUTocGibgndnGuT79ePKtVGfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzdrBMiaa87VXRKuQhEic92uxiaCavEe0Xvbeb0doLOBibgpnI32fklOmMDUTocGibgndnGuT79ePKtVGfg/640?wx_fmt=png&amp;from=appmsg"></section><h2><span><span leaf="">8</span></span><span leaf=""> 绘制calibration curve进行验证</span></h2><p><span leaf="">采用和nomogram一样的变量进行多因素cox回归</span></p><h3><span><span leaf="">8.1</span></span><span leaf=""> 5年 </span></h3><pre><code><span><span leaf="">f5 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">cph</span></span><span leaf="">(</span><span><span leaf="">formula =</span></span><span><span leaf="">Surv</span></span><span leaf="">(time,died) </span><span><span leaf="">~</span></span><span leaf="">  age </span><span><span leaf="">+</span></span><span leaf=""> catbili </span><span><span leaf="">+</span></span><span leaf=""> sex </span><span><span leaf="">+</span></span><span leaf=""> copper </span><span><span leaf="">+</span></span><span leaf="">stage </span><span><span leaf="">+</span></span><span leaf=""> trt,</span><span><span leaf="">data=</span></span><span leaf="">pbc,</span><span><span leaf="">x=</span></span><span leaf="">T,</span><span><span leaf="">y=</span></span><span leaf="">T,</span><span><span leaf="">surv =</span></span><span leaf=""> T,</span><span><span leaf="">na.action=</span></span><span leaf="">na.delete,</span><span><span leaf="">time.inc =</span></span><span><span leaf="">1825</span></span><span leaf="">) </span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf=""><a topic-id="mkdr3hk0-p036ul" data-topic="1">#参数m</a>=50表示每组50个样本进行重复计算</span></span></span><span leaf=""><br></span><span><span><span leaf=""><a topic-id="mkdr3hk0-8c5v6d" data-topic="1">#the</a> parameter m=50 means 50 samples in each group for repeated calculations</span></span></span><span leaf=""><br></span><span><span leaf="">cal5 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">calibrate</span></span><span leaf="">(f5, </span><span><span leaf="">cmethod=</span></span><span><span leaf="">"KM"</span></span><span leaf="">, </span><span><span leaf="">method=</span></span><span><span leaf="">"boot"</span></span><span leaf="">,</span><span><span leaf="">u=</span></span><span><span leaf="">1825</span></span><span leaf="">,</span><span><span leaf="">m=</span></span><span><span leaf="">50</span></span><span leaf="">,</span><span><span leaf="">B=</span></span><span><span leaf="">1000</span></span><span leaf="">) </span></span></code></pre><pre><code><span leaf="">## Using Cox survival estimates at 1825 Days</span></code></pre><pre><code><span><span><span leaf="">pdf</span></span><span leaf="">(</span><span><span leaf="">"calibration_5y.pdf"</span></span><span leaf="">,</span><span><span leaf="">width =</span></span><span><span leaf="">8</span></span><span leaf="">,</span><span><span leaf="">height =</span></span><span><span leaf="">8</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">plot</span></span><span leaf="">(cal5,</span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf=""><a topic-id="mkdr3hk0-aslr6s" data-topic="1">#error</a> bar的粗细 thickness of the error bar</span></span></span><span leaf=""><br></span><span><span><span leaf="">lty =</span></span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf=""><a topic-id="mkdr3hk0-0ueu55" data-topic="1">#error</a> bar的类型，可以是0-6 type of the error bar, which can be 0-6.</span></span></span><span leaf=""><br></span><span><span><span leaf="">errbar.col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk0-d7l1zs" data-topic="1">#2166AC</a>"</span></span><span leaf="">),</span><span><span leaf=""><a topic-id="mkdr3hk0-l5wknp" data-topic="1">#error</a> bar的颜色 color of the error bar</span></span></span><span leaf=""><br></span><span><span><span leaf="">xlim =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><span><span leaf="">ylim=</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">xlab =</span></span><span><span leaf="">"Nomogram-prediced OS (%)"</span></span><span leaf="">,</span><span><span leaf="">ylab =</span></span><span><span leaf="">"Observed OS (%)"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">cex.lab=</span></span><span><span leaf="">1.2</span></span><span leaf="">, </span><span><span leaf="">cex.axis=</span></span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">cex.main=</span></span><span><span leaf="">1.2</span></span><span leaf="">, </span><span><span leaf="">cex.sub=</span></span><span><span leaf="">0.6</span></span><span leaf="">) </span><span><span leaf=""><a topic-id="mkdr3hk0-ioly8g" data-topic="1">#字的大小</a> font size</span></span></span><span leaf=""><br></span><span><span><span leaf="">lines</span></span><span leaf="">(cal5[,</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">'mean.predicted'</span></span><span leaf="">,</span><span><span leaf="">"KM"</span></span><span leaf="">)], </span></span><span leaf=""><br></span><span><span><span leaf="">type =</span></span><span><span leaf="">'b'</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-tg1cn1" data-topic="1">#连线的类型</a>，可以是"p","b","o" type of line, which can be “p”, “b”, “o”.</span></span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-mcpb0k" data-topic="1">#连线的粗细</a> thickness of the line</span></span></span><span leaf=""><br></span><span><span><span leaf="">pch =</span></span><span><span leaf="">16</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk0-x5soqg" data-topic="1">#点的形状</a>，可以是0-20 shape of the point, which can be 0-20</span></span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk0-tjjtjw" data-topic="1">#2166AC</a>"</span></span><span leaf="">)) </span><span><span leaf=""><a topic-id="mkdr3hk0-64y3dn" data-topic="1">#连线的颜色</a> color of the line</span></span></span><span leaf=""><br></span><span><span><span leaf="">mtext</span></span><span leaf="">(</span><span><span leaf="">""</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">box</span></span><span leaf="">(</span><span><span leaf="">lwd =</span></span><span><span leaf="">1</span></span><span leaf="">) </span><span><span leaf=""><a topic-id="mkdr3hk1-lopi27" data-topic="1">#边框粗细</a> border thickness</span></span></span><span leaf=""><br></span><span><span><span leaf="">abline</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">lty =</span></span><span><span leaf="">3</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk1-g2sn70" data-topic="1">#对角线为虚线</a> diagonal lines are dashed</span></span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk1-716u9k" data-topic="1">#对角线的粗细</a> diagonal thickness</span></span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-xvd0po" data-topic="1">#224444</a>"</span></span><span leaf="">)</span><span><span leaf=""><a topic-id="mkdr3hk1-wl6o3v" data-topic="1">#对角线的颜色</a> diagonal color</span></span></span><span leaf=""><br></span><span><span leaf="">       ) </span></span><span leaf=""><br></span><span><span><span leaf="">dev.off</span></span><span leaf="">()</span></span></code></pre><pre><code><span leaf="">## pdf </span><span leaf=""><br></span><span leaf="">##   2</span></code></pre><p><embed role="img"></embed></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004357" data-ratio="0.9472222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfHRSObddtIPBnUpsGAuD4M6KAywsSLH68ib3XEAn87EY0QibNolIqRsezA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfHRSObddtIPBnUpsGAuD4M6KAywsSLH68ib3XEAn87EY0QibNolIqRsezA/640?wx_fmt=png&amp;from=appmsg"></section><h3><span><span leaf="">8.2</span></span><span leaf=""> 8年 </span></h3><pre><code><span><span leaf="">f8 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">cph</span></span><span leaf="">(</span><span><span leaf="">formula =</span></span><span><span leaf="">Surv</span></span><span leaf="">(time,died) </span><span><span leaf="">~</span></span><span leaf="">  age </span><span><span leaf="">+</span></span><span leaf=""> catbili </span><span><span leaf="">+</span></span><span leaf=""> sex </span><span><span leaf="">+</span></span><span leaf=""> copper </span><span><span leaf="">+</span></span><span leaf="">stage </span><span><span leaf="">+</span></span><span leaf=""> trt,</span><span><span leaf="">data=</span></span><span leaf="">pbc,</span><span><span leaf="">x=</span></span><span leaf="">T,</span><span><span leaf="">y=</span></span><span leaf="">T,</span><span><span leaf="">surv =</span></span><span leaf=""> T,</span><span><span leaf="">na.action=</span></span><span leaf="">na.delete,</span><span><span leaf="">time.inc =</span></span><span><span leaf="">2920</span></span><span leaf="">) </span></span><span leaf=""><br></span><span><span leaf="">cal8 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">calibrate</span></span><span leaf="">(f8, </span><span><span leaf="">cmethod=</span></span><span><span leaf="">"KM"</span></span><span leaf="">, </span><span><span leaf="">method=</span></span><span><span leaf="">"boot"</span></span><span leaf="">,</span><span><span leaf="">u=</span></span><span><span leaf="">2920</span></span><span leaf="">,</span><span><span leaf="">m=</span></span><span><span leaf="">50</span></span><span leaf="">,</span><span><span leaf="">B=</span></span><span><span leaf="">1000</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## Using Cox survival estimates at 2920 Days</span></code></pre><pre><code><span><span><span leaf="">plot</span></span><span leaf="">(cal8,</span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">lty =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">errbar.col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-1dix0l" data-topic="1">#B2182B</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">xlim =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><span><span leaf="">ylim=</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">xlab =</span></span><span><span leaf="">"Nomogram-prediced OS (%)"</span></span><span leaf="">,</span><span><span leaf="">ylab =</span></span><span><span leaf="">"Observed OS (%)"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-eetthq" data-topic="1">#B2182B</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">cex.lab=</span></span><span><span leaf="">1.2</span></span><span leaf="">,</span><span><span leaf="">cex.axis=</span></span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">cex.main=</span></span><span><span leaf="">1.2</span></span><span leaf="">, </span><span><span leaf="">cex.sub=</span></span><span><span leaf="">0.6</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">lines</span></span><span leaf="">(cal8[,</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">'mean.predicted'</span></span><span leaf="">,</span><span><span leaf="">"KM"</span></span><span leaf="">)],</span></span><span leaf=""><br></span><span><span><span leaf="">type=</span></span><span><span leaf="">'b'</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-cbefdi" data-topic="1">#B2182B</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">pch =</span></span><span><span leaf="">16</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">mtext</span></span><span leaf="">(</span><span><span leaf="">""</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">box</span></span><span leaf="">(</span><span><span leaf="">lwd =</span></span><span><span leaf="">1</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">abline</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">lty=</span></span><span><span leaf="">3</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-8jwvp2" data-topic="1">#224444</a>"</span></span><span leaf="">))</span></span></code></pre><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004359" data-ratio="0.9611111111111111" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfH8y4bk49tjb3oN63aH479GEjExo4ds5YKY4jJY0ZGnM4dyAuvYle15A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfH8y4bk49tjb3oN63aH479GEjExo4ds5YKY4jJY0ZGnM4dyAuvYle15A/640?wx_fmt=png&amp;from=appmsg"></section><h3><span><span leaf="">8.3</span></span><span leaf=""> 同时展示两条curve </span></h3><pre><code><span><span><span leaf="">pdf</span></span><span leaf="">(</span><span><span leaf="">"calibration_compare.pdf"</span></span><span leaf="">,</span><span><span leaf="">width =</span></span><span><span leaf="">8</span></span><span leaf="">,</span><span><span leaf="">height =</span></span><span><span leaf="">8</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">plot</span></span><span leaf="">(cal5,</span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf="">lty =</span></span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">errbar.col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-d30wyb" data-topic="1">#2166AC</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">bty =</span></span><span><span leaf="">"l"</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk1-sm2g7o" data-topic="1">#只画左边和下边框</a> draw only the left and lower borders</span></span></span><span leaf=""><br></span><span><span><span leaf="">xlim =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><span><span leaf="">ylim=</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">xlab =</span></span><span><span leaf="">"Nomogram-prediced OS (%)"</span></span><span leaf="">,</span><span><span leaf="">ylab =</span></span><span><span leaf="">"Observed OS (%)"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-xcomkj" data-topic="1">#2166AC</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">cex.lab=</span></span><span><span leaf="">1.2</span></span><span leaf="">,</span><span><span leaf="">cex.axis=</span></span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">cex.main=</span></span><span><span leaf="">1.2</span></span><span leaf="">, </span><span><span leaf="">cex.sub=</span></span><span><span leaf="">0.6</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">lines</span></span><span leaf="">(cal5[,</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">'mean.predicted'</span></span><span leaf="">,</span><span><span leaf="">"KM"</span></span><span leaf="">)],</span></span><span leaf=""><br></span><span><span><span leaf="">type =</span></span><span><span leaf="">'b'</span></span><span leaf="">, </span><span><span leaf="">lwd =</span></span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-k21prp" data-topic="1">#2166AC</a>"</span></span><span leaf="">), </span><span><span leaf="">pch =</span></span><span><span leaf="">16</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">mtext</span></span><span leaf="">(</span><span><span leaf="">""</span></span><span leaf="">)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span><span leaf="">plot</span></span><span leaf="">(cal8,</span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf="">lty =</span></span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">errbar.col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-hwln95" data-topic="1">#B2182B</a>"</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">xlim =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><span><span leaf="">ylim=</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">),</span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-ey1q01" data-topic="1">#B2182B</a>"</span></span><span leaf="">),</span><span><span leaf="">add =</span></span><span leaf=""> T)</span></span><span leaf=""><br></span><span><span><span leaf="">lines</span></span><span leaf="">(cal8[,</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">'mean.predicted'</span></span><span leaf="">,</span><span><span leaf="">"KM"</span></span><span leaf="">)],</span></span><span leaf=""><br></span><span><span><span leaf="">type =</span></span><span><span leaf="">'b'</span></span><span leaf="">, </span><span><span leaf="">lwd =</span></span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-8l5tqp" data-topic="1">#B2182B</a>"</span></span><span leaf="">), </span><span><span leaf="">pch =</span></span><span><span leaf="">16</span></span><span leaf="">)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span><span leaf="">abline</span></span><span leaf="">(</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">lty =</span></span><span><span leaf="">3</span></span><span leaf="">, </span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-and5zy" data-topic="1">#224444</a>"</span></span><span leaf="">))</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span><span leaf="">legend</span></span><span leaf="">(</span><span><span leaf="">"topleft"</span></span><span leaf="">, </span><span><span leaf=""><a topic-id="mkdr3hk1-ng4h8r" data-topic="1">#图例的位置</a> location of the legend</span></span></span><span leaf=""><br></span><span><span><span leaf="">legend =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"5-year"</span></span><span leaf="">,</span><span><span leaf="">"8-year"</span></span><span leaf="">), </span><span><span leaf=""><a topic-id="mkdr3hk1-moufv6" data-topic="1">#图例文字</a> legend text</span></span></span><span leaf=""><br></span><span><span><span leaf="">col =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"<a topic-id="mkdr3hk1-6hr040" data-topic="1">#2166AC</a>"</span></span><span leaf="">,</span><span><span leaf="">"<a topic-id="mkdr3hk1-sqq1xq" data-topic="1">#B2182B</a>"</span></span><span leaf="">), </span><span><span leaf=""><a topic-id="mkdr3hk1-ejkqmo" data-topic="1">#图例线的颜色</a>，与文字对应 color of the legend line, corresponding to the text</span></span></span><span leaf=""><br></span><span><span><span leaf="">lwd =</span></span><span><span leaf="">2</span></span><span leaf="">,</span><span><span leaf=""><a topic-id="mkdr3hk1-56f206" data-topic="1">#图例中线的粗细</a> thickness of lines in the legend</span></span></span><span leaf=""><br></span><span><span><span leaf="">cex =</span></span><span><span leaf="">1.2</span></span><span leaf="">,</span><span><span leaf=""><a topic-id="mkdr3hk1-9u5c2n" data-topic="1">#图例字体大小</a> legend font size</span></span></span><span leaf=""><br></span><span><span><span leaf="">bty =</span></span><span><span leaf="">"n"</span></span><span leaf="">)</span><span><span leaf=""><a topic-id="mkdr3hk1-eb3qjm" data-topic="1">#不显示图例边框</a> legend border not displayed</span></span></span><span leaf=""><br></span><span><span><span leaf="">dev.off</span></span><span leaf="">()</span></span></code></pre><pre><code><span leaf="">## pdf </span><span leaf=""><br></span><span leaf="">##   2</span></code></pre><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100004358" data-ratio="0.9472222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfHbYchOqjIwLYpEYZXMEBA0KehQ0uxa0Px4MbpwGBQia3TPXfhgh8zwFg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/fTGTY7BwuzfhVmEh32fibnaxzT0mSABfHbYchOqjIwLYpEYZXMEBA0KehQ0uxa0Px4MbpwGBQia3TPXfhgh8zwFg/640?wx_fmt=png&amp;from=appmsg"></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/plvXIDil5YcZGyt2nSbp4w",target="_blank" rel="noopener noreferrer">原文链接</a>
