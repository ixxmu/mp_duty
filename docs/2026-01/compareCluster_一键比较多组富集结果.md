---
title: "compareClusterï¼šä¸€é”®æ¯”è¾ƒå¤šç»„å¯Œé›†ç»“æœ"
date: 2026-01-14T14:31:17Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡èœé¸Ÿå›¢"
]
categories: ["Acdemic"]
---
compareClusterï¼šä¸€é”®æ¯”è¾ƒå¤šç»„å¯Œé›†ç»“æœ by ç”Ÿä¿¡èœé¸Ÿå›¢
------
<div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://wechat.jeffjade.com/" data-pm-slice="0 0 []"><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æœ€è¿‘åœ¨åˆ†æè‚¿ç˜¤è½¬ç§»è¿‡ç¨‹æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä¸€ä¸ªå€¼å¾—å…³æ³¨çš„ç°è±¡ï¼šå½“æˆ‘åˆ†åˆ«å¯¹â€œè½¬ç§»æ€§è‚¿ç˜¤ç»„ç»‡ä¸åŸå‘è‚¿ç˜¤ç»„ç»‡â€ä»¥åŠâ€œåŸå‘è‚¿ç˜¤ç»„ç»‡ä¸è½¬ç§»ç¶â€è¿›è¡Œå·®å¼‚åˆ†æåï¼Œå‘ç°è¿™ä¸¤ä¸ªé˜¶æ®µâ€”â€”ä½œä¸ºè‚¿ç˜¤è¿›å±•ä¸­çš„ä¸åŒæ­¥éª¤â€”â€”æ‰€å¾—åˆ°çš„å·®å¼‚åŸºå› é›†åˆå…³è”æ€§å¹¶ä¸å¼ºã€‚åç»­çš„è›‹ç™½è´¨äº’ä½œç½‘ç»œï¼ˆPPIï¼‰åˆ†æä¹Ÿæœªèƒ½æ„å»ºå‡ºé¢„æœŸçš„ç›¸äº’ä½œç”¨ç½‘ç»œã€‚è¿™ä¿ƒä½¿æˆ‘è¿›ä¸€æ­¥æ€è€ƒï¼šæ˜¯å¦å¯ä»¥é€šè¿‡GOã€KEGGæˆ–Reactomeç­‰åŠŸèƒ½å¯Œé›†åˆ†æï¼Œä»é€šè·¯æˆ–åŠŸèƒ½å±‚é¢æ­ç¤ºè¿™ä¸¤ä¸ªæ­¥éª¤èƒŒåæ½œåœ¨çš„ç”Ÿç‰©å­¦è”ç³»ä¸æœºåˆ¶ï¼Ÿ</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">äºæ˜¯å‘ç°äº†è¿™ä¸ªå¾ˆå¥½ç”¨çš„å‡½æ•°ï¼Œæ¥è‡ªå¤§åé¼é¼çš„clusterProfilerï¼</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">1</span></span></span><span><span leaf="">ğŸ“Œ ä»€ä¹ˆæ˜¯ compareClusterï¼Ÿ</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">compareCluster</span></code><span leaf="">Â æ˜¯Â </span><strong><span leaf="">clusterProfiler</span></strong><span leaf="">Â åŒ…ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œä¸»è¦ç”¨äº</span><strong><span leaf="">æ¯”è¾ƒä¸åŒåŸºå› é›†ï¼ˆåˆ†ç»„ï¼‰çš„å¯Œé›†åˆ†æç»“æœ</span></strong><span leaf="">ã€‚å®ƒå¯ä»¥å°†å¤šä¸ªåˆ†ç»„ï¼ˆå¦‚ä¸åŒå®éªŒæ¡ä»¶ã€ä¸åŒç»„ç»‡ã€ä¸åŒç‰©ç§ï¼‰çš„å¯Œé›†ç»“æœè¿›è¡Œå¯è§†åŒ–æ¯”è¾ƒã€‚</span></p><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100055398" data-ratio="0.8757861635220126" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibcXG1uH9LjQle2qpE5KR9j54CAyQ8CICMxhaO6QBjuibdmFarnG7uRiaK0ykapsrpsxvaDK0lXMpJQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="636" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibcXG1uH9LjQle2qpE5KR9j54CAyQ8CICMxhaO6QBjuibdmFarnG7uRiaK0ykapsrpsxvaDK0lXMpJQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">2</span></span></span><span><span leaf="">ğŸ”¬ compareClusterå‚æ•°</span></span></h2><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">compareCluster(</span><span leaf=""><br></span><span leaf="">Â  geneClusters,Â </span><span><span leaf="">## a list of entrez gene id.</span></span><span leaf=""><br></span><span leaf="">Â  fun =Â </span><span><span leaf="">"enrichGO"</span></span><span leaf="">,Â </span><span><span leaf="">## One of "groupGO", "enrichGO", "enrichKEGG", "enrichDO" or"enrichPathway"</span></span><span leaf=""><br></span><span leaf="">Â  data =Â </span><span><span leaf="">""</span></span><span leaf="">,Â </span><span><span leaf="">## if geneClusters is a formula, the data from which the clusters must be extracted</span></span><span leaf=""><br></span><span leaf="">Â  source_from =Â </span><span><span leaf="">NULL</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â Â </span><span><span leaf="">...</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¯”å¦‚ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">## formula interface</span></span><span leaf=""><br></span><span leaf="">mydf &lt;- data.frame(Entrez=c(</span><span><span leaf="">'1'</span></span><span leaf="">,Â </span><span><span leaf="">'100'</span></span><span leaf="">,Â </span><span><span leaf="">'1000'</span></span><span leaf="">,Â </span><span><span leaf="">'100101467'</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â </span><span><span leaf="">'100127206'</span></span><span leaf="">,Â </span><span><span leaf="">'100128071'</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logFC = c(</span><span><span leaf="">1.1</span></span><span leaf="">, -</span><span><span leaf="">0.5</span></span><span leaf="">,Â </span><span><span leaf="">5</span></span><span leaf="">,Â </span><span><span leaf="">2.5</span></span><span leaf="">, -</span><span><span leaf="">3</span></span><span leaf="">,Â </span><span><span leaf="">3</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â group = c(</span><span><span leaf="">'A'</span></span><span leaf="">,Â </span><span><span leaf="">'A'</span></span><span leaf="">,Â </span><span><span leaf="">'A'</span></span><span leaf="">,Â </span><span><span leaf="">'B'</span></span><span leaf="">,Â </span><span><span leaf="">'B'</span></span><span leaf="">,Â </span><span><span leaf="">'B'</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â othergroup = c(</span><span><span leaf="">'good'</span></span><span leaf="">,Â </span><span><span leaf="">'good'</span></span><span leaf="">,Â </span><span><span leaf="">'bad'</span></span><span leaf="">,Â </span><span><span leaf="">'bad'</span></span><span leaf="">,Â </span><span><span leaf="">'good'</span></span><span leaf="">,Â </span><span><span leaf="">'bad'</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">xx.formula &lt;- compareCluster(Entrez~group, data=mydf,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â fun=</span><span><span leaf="">'groupGO'</span></span><span leaf="">, OrgDb=</span><span><span leaf="">'org.Hs.eg.db'</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">3</span></span></span><span><span leaf="">ä¸»è¦ç”¨é€”</span></span></h2><ol><li><section><strong><span leaf="">è·¨ç»„æ¯”è¾ƒ</span></strong><span leaf="">ï¼šæ¯”è¾ƒä¸åŒæ¡ä»¶ä¸‹çš„é€šè·¯/åŠŸèƒ½å¯Œé›†å·®å¼‚</span></section></li><li><section><strong><span leaf="">å¤šç»„å­¦æ•´åˆ</span></strong><span leaf="">ï¼šæ•´åˆå¤šä¸ªomicsæ•°æ®çš„å¯Œé›†ç»“æœ</span></section></li><li><section><strong><span leaf="">æ—¶é—´åºåˆ—åˆ†æ</span></strong><span leaf="">ï¼šæ¯”è¾ƒä¸åŒæ—¶é—´ç‚¹çš„å¯Œé›†å˜åŒ–</span></section></li><li><section><strong><span leaf="">ç‰©ç§æ¯”è¾ƒ</span></strong><span leaf="">ï¼šæ¯”è¾ƒä¸åŒç‰©ç§é—´çš„åŠŸèƒ½ä¿å®ˆæ€§</span></section></li></ol><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">4</span></span></span><span><span leaf="">å®æ“ä¸€ä¸‹</span></span></h2><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span><span leaf="">library</span></span><span leaf="">(clusterProfiler)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(org.Hs.eg.db)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 1. å‡†å¤‡åˆ†ç»„åŸºå› åˆ—è¡¨</span></span><span leaf=""><br></span><span leaf="">geneList &lt;- list(</span><span leaf=""><br></span><span leaf="">Â  Group1 = c(</span><span><span leaf="">"gene1"</span></span><span leaf="">,Â </span><span><span leaf="">"gene2"</span></span><span leaf="">,Â </span><span><span leaf="">"gene3"</span></span><span leaf="">), Â </span><span><span leaf=""># ç¬¬ä¸€ç»„å·®å¼‚åŸºå› </span></span><span leaf=""><br></span><span leaf="">Â  Group2 = c(</span><span><span leaf="">"gene4"</span></span><span leaf="">,Â </span><span><span leaf="">"gene5"</span></span><span leaf="">,Â </span><span><span leaf="">"gene6"</span></span><span leaf="">), Â </span><span><span leaf=""># ç¬¬äºŒç»„å·®å¼‚åŸºå› </span></span><span leaf=""><br></span><span leaf="">Â  Group3 = c(</span><span><span leaf="">"gene7"</span></span><span leaf="">,Â </span><span><span leaf="">"gene8"</span></span><span leaf="">,Â </span><span><span leaf="">"gene9"</span></span><span leaf="">) Â Â </span><span><span leaf=""># ç¬¬ä¸‰ç»„å·®å¼‚åŸºå› </span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 2. è¿›è¡Œå¯Œé›†åˆ†ææ¯”è¾ƒ</span></span><span leaf=""><br></span><span leaf="">ck &lt;- compareCluster(</span><span leaf=""><br></span><span leaf="">Â  geneCluster = geneList,</span><span leaf=""><br></span><span leaf="">Â  fun =Â </span><span><span leaf="">"enrichGO"</span></span><span leaf="">, Â  Â  Â  Â </span><span><span leaf=""># ä½¿ç”¨GOå¯Œé›†</span></span><span leaf=""><br></span><span leaf="">Â  OrgDb = org.Hs.eg.db,</span><span leaf=""><br></span><span leaf="">Â  keyType =Â </span><span><span leaf="">"SYMBOL"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  pvalueCutoff =Â </span><span><span leaf="">0.05</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  qvalueCutoff =Â </span><span><span leaf="">0.05</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span><span><span leaf="">5</span></span></span><span><span leaf="">å¯è§†åŒ–</span></span></h2><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">1.Â </span><strong><span leaf="">dotplot</span></strong><span leaf="">Â - ç‚¹å›¾ï¼ˆæœ€å¸¸ç”¨ï¼‰</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">dotplot(ck,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  showCategory =Â </span><span><span leaf="">5</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  title =Â </span><span><span leaf="">"GO Enrichment Comparison"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  font.size =Â </span><span><span leaf="">10</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™é‡Œä¹Ÿæ”¯æŒå†ç”¨ggplotç¾åŒ–~</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">p &lt;- dotplot(</span><span leaf=""><br></span><span leaf="">Â  cc_go,</span><span leaf=""><br></span><span leaf="">Â  showCategory =Â </span><span><span leaf="">8</span></span><span leaf="">, Â  Â  Â  Â </span><span><span leaf=""># æ§åˆ¶ GO term æ•°é‡</span></span><span leaf=""><br></span><span leaf="">Â  font.size =Â </span><span><span leaf="">12</span></span><span leaf=""><br></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">Â  scale_color_gradient(</span><span leaf=""><br></span><span leaf="">Â  Â  low =Â </span><span><span leaf="">"<a topic-id="mke1s8tl-iw20ue" data-topic="1">#2166AC</a>"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  high =Â </span><span><span leaf="">"<a topic-id="mke1s8tl-cmdxk3" data-topic="1">#B2182B</a>"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  name =Â </span><span><span leaf="">"Adjusted P value"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  trans =Â </span><span><span leaf="">"reverse"</span></span><span leaf=""><br></span><span leaf="">Â  ) +</span><span leaf=""><br></span><span leaf="">Â  scale_size_continuous(</span><span leaf=""><br></span><span leaf="">Â  Â  range = c(</span><span><span leaf="">4</span></span><span leaf="">,Â </span><span><span leaf="">10</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  name =Â </span><span><span leaf="">"Gene Ratio"</span></span><span leaf=""><br></span><span leaf="">Â  ) +</span><span leaf=""><br></span><span leaf="">Â  theme_bw(base_size =Â </span><span><span leaf="">13</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">Â  theme(</span><span leaf=""><br></span><span leaf="">Â  Â  panel.grid.major.x = element_blank(),</span><span leaf=""><br></span><span leaf="">Â  Â  panel.grid.minor = element_blank(),</span><span leaf=""><br></span><span leaf="">Â  Â  axis.text.y = element_text(size =Â </span><span><span leaf="">10</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  axis.text.x = element_text(size =Â </span><span><span leaf="">12</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">Â  Â  axis.title = element_blank(),</span><span leaf=""><br></span><span leaf="">Â  Â  legend.position =Â </span><span><span leaf="">"right"</span></span><span leaf=""><br></span><span leaf="">Â  ) +</span><span leaf=""><br></span><span leaf="">Â  ggtitle(</span><span><span leaf="">"BP enrichment"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">2.Â </span><strong><span leaf="">cnetplot</span></strong><span leaf="">Â - ç½‘ç»œå›¾</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span leaf="">cnetplot(ck,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â categorySize =Â </span><span><span leaf="">"pvalue"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â showCategory =Â </span><span><span leaf="">3</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><section nodeleaf=""><img data-aistatus="1" data-imgfileid="100055399" data-ratio="0.7774390243902439" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibcXG1uH9LjQle2qpE5KR9jp2AdMicEDHHgJOxZK2Nyeq9zgicKUzI4SsVciciaFIPAnbG551dqvKsRng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="656" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibcXG1uH9LjQle2qpE5KR9jp2AdMicEDHHgJOxZK2Nyeq9zgicKUzI4SsVciciaFIPAnbG551dqvKsRng/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><br></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å‚è€ƒï¼š</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">Yu G, Wang LG, Han Y, He QY. clusterProfiler: an R package for comparing biological themes among gene clusters.Â </span><em><span leaf="">OMICS</span></em><span leaf="">. 2012;16(5):284-287. doi:10.1089/omi.2011.0118</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">https://yulab-smu.top/biomedical-knowledge-mining-book/029-compareCluster.html</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wsq0LTzPZB914hP3U_qdNg",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
