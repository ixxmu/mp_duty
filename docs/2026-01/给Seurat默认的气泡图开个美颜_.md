---
title: "给Seurat默认的气泡图开个美颜！"
date: 2026-01-31T13:17:13Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
给Seurat默认的气泡图开个美颜！ by 生信星球
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="3 5 [&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;data-tool&quot;:&quot;markdown2wechat编辑器&quot;,&quot;data-website&quot;:&quot;https://aizhuanqian.com&quot;,&quot;style&quot;:&quot;font-size: 16px;color: black;padding: 0 10px;line-height: 1.6;word-spacing: 0px;letter-spacing: 0px;word-break: break-word;word-wrap: break-word;text-align: left;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;},&quot;para&quot;,{&quot;tagName&quot;:&quot;section&quot;,&quot;attributes&quot;:{&quot;data-tool&quot;:&quot;mdnice编辑器&quot;,&quot;data-website&quot;:&quot;https://www.mdnice.com&quot;,&quot;style&quot;:&quot;margin-top: 0px;margin-bottom: 0px;margin-left: 0px;margin-right: 0px;padding-top: 0px;padding-bottom: 0px;padding-left: 10px;padding-right: 10px;background-attachment: scroll;background-clip: border-box;background-color: rgba(0, 0, 0, 0);background-image: none;background-origin: padding-box;background-position-x: 0%;background-position-y: 0%;background-repeat: no-repeat;background-size: auto;width: auto;font-family: Optima, 'Microsoft YaHei', PingFangSC-regular, serif;font-size: 16px;color: rgb(0, 0, 0);line-height: 1.5em;word-spacing: 0em;letter-spacing: 0em;word-break: break-word;overflow-wrap: break-word;text-align: left;&quot;,&quot;data-pm-slice&quot;:&quot;0 0 []&quot;},&quot;namespaceURI&quot;:&quot;http://www.w3.org/1999/xhtml&quot;}]"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013059" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013061" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"></span><span><span leaf=""><span textstyle=""> 今天是生信星球陪你的</span></span><span><strong><span leaf=""><span textstyle="">第1067天</span></span></strong></span></span><span leaf=""><br></span></section></section></section></section><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。 我的课程都是循环开课， 点进去咨询微信，随时可以报名↓</span></p></blockquote></section><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497289&amp;idx=1&amp;sn=e87f24c3b353034b5719294cca0eb166&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课12月班" data-itemshowtype="11" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497024&amp;idx=2&amp;sn=8c8b240b5df1d3b2c2e29b17f407ee75&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组长期报名中" data-itemshowtype="0" linktype="text" data-linktype="2">生信新手保护学习小组</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497395&amp;idx=1&amp;sn=9cac5ae851a792fa0b0ef0626dbe5d93&amp;scene=21#wechat_redirect" textvalue="单细胞数据分析不求人，从零开始系统学" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞数据分析不求人，从零开始系统学</a></span></p><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">画图课程如火如荼的内测ing~~~大家的学习热情高涨，我们也在随时收集大家喜欢的图。今天的图是直播课学生许愿的:</span></p><p data-tool="mdnice编辑器"><span leaf=""><img data-aistatus="1" data-imgfileid="100013777" data-ratio="0.9089108910891089" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhhrderQZqJSoNqjhLpp61xU1iaWFKhEB5MeSt0vTs6GQYXndTEd0sT7A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="505" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhhrderQZqJSoNqjhLpp61xU1iaWFKhEB5MeSt0vTs6GQYXndTEd0sT7A/640?wx_fmt=png&amp;from=appmsg"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhefcicIdc6CFSCic2tTCJPK22M5bqEQ7Z7hLGSMyjhPN5IJDSxTExbbRQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.863481228668942" data-type="png" data-w="586" data-imgfileid="100013776" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhefcicIdc6CFSCic2tTCJPK22M5bqEQ7Z7hLGSMyjhPN5IJDSxTExbbRQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf="">在单细胞数据分析的江湖里，Seurat无疑是绝对的王者。但是呢，标准流程只是起点，美丽的图表任重道远~默认的dotplot图长这样：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-aistatus="1" data-imgfileid="100013778" data-ratio="0.5797819623389494" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhESlennfbbQxdAoVAt7QIu5W4cgyGMrCEFLTlia3r50ibXc4MRMU6jllA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1009" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhESlennfbbQxdAoVAt7QIu5W4cgyGMrCEFLTlia3r50ibXc4MRMU6jllA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">默认的蓝紫色渐变、灰色的背景、还有那挤作一团的X轴标签，太基础啦。ps:加一个函数RotatedAxis()可以旋转45°，避免重叠。</span></p><p data-tool="mdnice编辑器"><span leaf="">在这张图的基础上，基于</span><code><span leaf="">ggplot2</span></code><span leaf="">和</span><code><span leaf="">paletteer</span></code><span leaf="">做一些个性化调整，给他变个身！</span></p><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">先上我们调试好的代码和效果预览：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(paletteer)</span><span leaf=""><br></span><span><span leaf=""># 加载已经注释好的Seurat对象</span></span><span leaf=""><br></span><span leaf="">load(</span><span><span leaf="">"seu.obj.Rdata"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 查看细胞类型，如果没有注释这里会显示样本名称或者是0、1、2...这样的编号</span></span><span leaf=""><br></span><span leaf="">levels(seu.obj)</span><span leaf=""><br></span><span><span leaf=""># 设置随机种子以保证结果可复现</span></span><span leaf=""><br></span><span leaf="">set.seed(</span><span><span leaf="">12281</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 从Seurat对象中随机抽取10个基因用于演示</span></span><span leaf=""><br></span><span leaf="">genes = rownames(seu.obj)[sample(seq_len(nrow(seu.obj)),</span><span><span leaf="">10</span></span><span leaf="">)]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 画图</span></span><span leaf=""><br></span><span leaf="">DotPlot(seu.obj, features = genes) +</span><span leaf=""><br></span><span leaf="">  theme_bw() + </span><span leaf=""><br></span><span leaf="">  theme(</span><span leaf=""><br></span><span leaf="">    axis.text.x = element_text(angle = </span><span><span leaf="">90</span></span><span leaf="">, hjust = </span><span><span leaf="">1</span></span><span leaf="">), </span><span><span leaf=""># X轴标签旋转90度并对齐</span></span><span leaf=""><br></span><span leaf="">    plot.title = element_text(hjust = </span><span><span leaf="">0.5</span></span><span leaf="">) </span><span><span leaf=""># 标题居中</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  scale_color_paletteer_c(</span><span leaf=""><br></span><span leaf="">    </span><span><span leaf="">"ggthemes::Red-Blue-White Diverging"</span></span><span leaf="">, </span><span><span leaf=""># paletteer包中的配色</span></span><span leaf=""><br></span><span leaf="">    direction = -</span><span><span leaf="">1</span></span><span><span leaf=""># 反转颜色方向</span></span><span leaf=""><br></span><span leaf="">  ) +</span><span leaf=""><br></span><span leaf="">  ggtitle(paste0(</span><span><span leaf="">"All cells(n="</span></span><span leaf="">, ncol(seu.obj), </span><span><span leaf="">")"</span></span><span leaf="">)) </span><span><span leaf=""># 居中标题</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnh6qOHN8t0MwzGpINvH6OAjg39RhgIichgOyxibpty3EGjM9dftu3EOr1A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8094575799721836" data-type="png" data-w="719" data-imgfileid="100013780" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnh6qOHN8t0MwzGpINvH6OAjg39RhgIichgOyxibpty3EGjM9dftu3EOr1A/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">因为对ggplot2比较熟悉，这些代码是我手搓的。不过时代在进步，用ai写代码的能力也在突飞猛进啊。我们的画图课程也渗透了AI的戏份，降低些许学习成本。</span></p></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhhmuYK56lnlnh6zLiaZrsGnrPiagQVUblXHRcGrJuBAQVHQchM25Wqaibg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.33425925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100013781" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrdoUXjeARH6cpticLVFpWnhhmuYK56lnlnh6zLiaZrsGnrPiagQVUblXHRcGrJuBAQVHQchM25Wqaibg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ccEvSX72jD9lrXbzAmUcmw",target="_blank" rel="noopener noreferrer">原文链接</a>
