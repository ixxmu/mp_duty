---
title: "xenium数据分析：探索一下基本数据分析流程"
date: 2026-01-23T04:22:22Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
xenium数据分析：探索一下基本数据分析流程 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><span></span><p><span leaf="">最近在学习 空间高精度的数据分析，然后搜了一下网上的各种资料，发现10x官网 搞了一个github来存放他们给的所有教程，让大家去学习！今天先来学习一下下游的基础分析~</span></p><p><span leaf="">10x给的教程地址：https://github.com/10XGenomics/analysis_guides</span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">Xenium的数据分析流程</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">总的来说，Xenium的数据分析流程如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRt9XWmlLjktob8FrWa4ibFiaRHibDEk6b7fnUjH7azQlJ3D59jGCCVevhg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.16944444444444445" data-type="png" data-w="1080" data-imgfileid="100055520" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRt9XWmlLjktob8FrWa4ibFiaRHibDEk6b7fnUjH7azQlJ3D59jGCCVevhg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">今天学习教程中的这个笔记：Xenium_5k_data_analysis_journey.ipynb</span></p><blockquote><span></span><p><span leaf="">Xenium data visualization and analysis (for one sample)</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">数据下载和导入见：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247539120&amp;idx=1&amp;sn=12ab6af8509e46a041221c218f0feeaa&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">xenium数据分析：一波三折的数据读取，劝退90%的人！</a></span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">xenium对象结构如下</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">还是seurat对象：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">xenium.obj</span><span leaf=""><br></span><span leaf="">An object of class Seurat </span><span leaf=""><br></span><span><span leaf="">6181</span></span><span leaf=""> features across </span><span><span leaf="">699110</span></span><span leaf=""> samples within </span><span><span leaf="">5</span></span><span leaf=""> assays </span><span leaf=""><br></span><span leaf="">Active assay: Xenium (</span><span><span leaf="">5101</span></span><span leaf=""> features, </span><span><span leaf="">0</span></span><span leaf=""> variable features)</span><span leaf=""><br></span><span leaf=""> </span><span><span leaf="">1</span></span><span leaf=""> layer present: counts</span><span leaf=""><br></span><span leaf=""> </span><span><span leaf="">4</span></span><span leaf=""> other assays present: BlankCodeword, ControlCodeword, ControlProbe, GenomicControl</span><span leaf=""><br></span><span leaf=""> </span><span><span leaf="">1</span></span><span leaf=""> spatial field of view present: fov</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRdnv5NptMR9eVtuDHTXguRJkjSJFRBaPzvFwWR0h9gpYCJKCDvMUBVQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7599118942731278" data-type="png" data-w="908" data-imgfileid="100055521" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRdnv5NptMR9eVtuDHTXguRJkjSJFRBaPzvFwWR0h9gpYCJKCDvMUBVQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">Image source: https://sib-swiss.github.io/single-cell-training/day1/day1-2_analysis_tools_qc.html</span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">绘制每个细胞的空间总转录本分布图</span></span><span></span></h2><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">metadata &lt;- xenium.obj@meta.data</span><span leaf=""><br></span><span leaf="">head(metadata, n=3)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># Plot total transcript per cell spatially</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># You can change "repr.plot.width" below to change plot width</span></span><span leaf=""><br></span><span><span leaf=""># You can change "repr.plot.height" below to change plot height</span></span><span leaf=""><br></span><span leaf="">options(repr.plot.width=10, repr.plot.height=16)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># max.cutoff="q95" - Color is capped at 95th percentile</span></span><span leaf=""><br></span><span leaf="">p &lt;- ImageFeaturePlot(xenium.obj, fov = </span><span><span leaf="">"fov"</span></span><span leaf="">, features = c(</span><span><span leaf="">"nCount_Xenium"</span></span><span leaf="">), max.cutoff=</span><span><span leaf="">"q95"</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_y_reverse()</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qR4GJxyNqWUTMfTUTsx1GSk4ACmnxfEwwwX0HA1hIw8iao0CNgYx6CgNw/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1245235069885642" data-type="png" data-w="787" data-imgfileid="100055524" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qR4GJxyNqWUTMfTUTsx1GSk4ACmnxfEwwwX0HA1hIw8iao0CNgYx6CgNw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这个数值范围算低还是不低？</span></p><blockquote><span></span><p><span leaf="">6181个基因，细胞水平，每个细胞中的总转录本数。</span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">绘制部分目标基因的空间表达图</span></span><span></span></h2><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qR9pwT8IkNibYtr6P7nVBULoQgRod1sjZdHzibVak0T0NwR3483P7N6icnQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1895803183791607" data-type="png" data-w="691" data-imgfileid="100055522" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qR9pwT8IkNibYtr6P7nVBULoQgRod1sjZdHzibVak0T0NwR3483P7N6icnQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRzDVZWY27wZ4kUpFS4UtNNlYzf19Z8gfFsRVjdz4LZQicwPkiaySE81vg/640?wx_fmt=png&amp;from=appmsg" alt="image-20260119200913586" data-ratio="1.272594752186589" data-type="png" data-w="686" data-imgfileid="100055523" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRzDVZWY27wZ4kUpFS4UtNNlYzf19Z8gfFsRVjdz4LZQicwPkiaySE81vg/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">image-20260119200913586</span></figcaption></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">选择感兴趣的子区域</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">选择感兴趣的子区域有两种方式：</span></p><ol><li><section><span leaf="">通过坐标选择</span></section></li><li><section><span leaf="">通过细胞ID选择</span></section></li></ol><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">通过坐标选择</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">首先，选择您感兴趣的子区域并下载其坐标。</span></p><p data-tool="mdnice编辑器"><span leaf="">这个需要使用 Xenium Explorer 3.2.0 软件进行选择，教程这里提供了一个选择好的坐标：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""><a topic-id="mkqc2wzk-qujnbz" data-topic="1">#Selection</a> name: Selection 1</span></span><span leaf=""><br></span><span><span leaf=""><a topic-id="mkqc2wzl-3ktds8" data-topic="1">#Area</a> (µm^2): 6238188.5</span></span><span leaf=""><br></span><span leaf="">X,Y</span><span leaf=""><br></span><span leaf="">2082.2669778917857,2883.948207577963</span><span leaf=""><br></span><span leaf="">4605.827306527083,2883.948207577963</span><span leaf=""><br></span><span leaf="">4605.827306527083,5355.927347229994</span><span leaf=""><br></span><span leaf="">2082.2669778917857,5355.927347229994</span><span leaf=""><br></span><span leaf="">2082.2669778917857,2883.948207577963</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRc3AYXL3qra8RQGh57ZiaKEAMjibv9N3tQ8MkoicOwYD6PjiaoicicQWBG3rw/640?wx_fmt=jpeg&amp;from=appmsg" alt="image-20260119205432865" data-ratio="0.4981481481481482" data-type="jpeg" data-w="1080" data-imgfileid="100055526" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRc3AYXL3qra8RQGh57ZiaKEAMjibv9N3tQ8MkoicOwYD6PjiaoicicQWBG3rw/640?wx_fmt=jpeg&amp;from=appmsg"></span><figcaption><span leaf="">image-20260119205432865</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">在R里面设定crop范围：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">min_x = 2082.2669778917857</span><span leaf=""><br></span><span leaf="">min_y = 2883.948207577963</span><span leaf=""><br></span><span leaf="">max_x = 4605.827306527083</span><span leaf=""><br></span><span leaf="">max_y = 5355.927347229994</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">options(future.globals.maxSize = 1e10)</span><span leaf=""><br></span><span leaf="">crop &lt;- Crop(xenium.obj[[</span><span><span leaf="">"fov"</span></span><span leaf="">]],</span><span leaf=""><br></span><span leaf="">             x = c(min_x, max_x),</span><span leaf=""><br></span><span leaf="">             y = c(min_y, max_y))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># copy a new Xenium object so the rest part of this tutorial will not be affected by this change</span></span><span leaf=""><br></span><span leaf="">xenium.obj.new &lt;- xenium.obj</span><span leaf=""><br></span><span leaf="">xenium.obj.new[[</span><span><span leaf="">"myarea"</span></span><span leaf="">]] &lt;- crop</span><span leaf=""><br></span><span leaf="">xenium.obj.new</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">options(repr.plot.width=8, repr.plot.height=8)</span><span leaf=""><br></span><span leaf="">p &lt;- ImageFeaturePlot(xenium.obj.new, fov = </span><span><span leaf="">"myarea"</span></span><span leaf="">,  features = c(</span><span><span leaf="">"nCount_Xenium"</span></span><span leaf="">), max.cutoff=</span><span><span leaf="">"q95"</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  scale_y_reverse()</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRbG7KiarP4YEiccXSuBxPe9iaVaXQImicWicnNMxyicO3A0mwp1qyMbqgnELg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7947845804988662" data-type="png" data-w="882" data-imgfileid="100055529" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRbG7KiarP4YEiccXSuBxPe9iaVaXQImicWicnNMxyicO3A0mwp1qyMbqgnELg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">裁剪出来的部分如上。</span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">使用细胞id选择</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">也是上面那个Xenium explore软件选择：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRezTo17YM3Oncqib06tRQmxlib35Msqec1HbxmIXnZriaQlJjx9lIj3Lbw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5648148148148148" data-type="jpeg" data-w="1080" data-imgfileid="100055527" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRezTo17YM3Oncqib06tRQmxlib35Msqec1HbxmIXnZriaQlJjx9lIj3Lbw/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">教程提供了一个选好的：one-sample-analysis/Selection_1_cells_stats.csv</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 使用细胞id选择</span></span><span leaf=""><br></span><span><span leaf=""># We have prepared "Selection_1_cells_stats.csv" for practice purpose here</span></span><span leaf=""><br></span><span><span leaf=""># in your real analysis, please provide your own csv file.</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># read csv</span></span><span leaf=""><br></span><span leaf="">select_cells &lt;- read.csv(</span><span><span leaf="">"./one-sample-analysis/Selection_1_cells_stats.csv"</span></span><span leaf="">, skip = 2, header = TRUE)</span><span leaf=""><br></span><span leaf="">head(select_cells, n=3)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># Get a separate Xenium seurat object for the selected cells</span></span><span leaf=""><br></span><span leaf="">xenium.obj.sub &lt;- subset(xenium.obj, cells = select_cells</span><span><span leaf="">$Cell</span></span><span leaf="">.ID)</span><span leaf=""><br></span><span leaf="">xenium.obj.sub </span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">options(repr.plot.width=8, repr.plot.height=8)</span><span leaf=""><br></span><span leaf="">p &lt;- ImageFeaturePlot(xenium.obj.sub, fov = </span><span><span leaf="">"fov"</span></span><span leaf="">, features = c(</span><span><span leaf="">"nCount_Xenium"</span></span><span leaf="">), max.cutoff=</span><span><span leaf="">"q95"</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  scale_y_reverse()</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRaqLKtVFv9QesA0V4Ckib6Nr5yHCnBI02jPuUIFVKqhiczxJ1QnOnLic6A/640?wx_fmt=png&amp;from=appmsg" alt="image-20260119215101131" data-ratio="0.7396514161220044" data-type="png" data-w="918" data-imgfileid="100055528" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRaqLKtVFv9QesA0V4Ckib6Nr5yHCnBI02jPuUIFVKqhiczxJ1QnOnLic6A/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf=""><br></span></figcaption></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">下游分析</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">1 数据预处理</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">第一步是质量控制。需要去除转录本计数较低的细胞。</span></p><p data-tool="mdnice编辑器"><span leaf="">可以通过绘制每个细胞转录本计数的直方图分布，来确定用于去除低转录本计数细胞的阈值。确定下限阈值具有一定的主观性，目前尚无公认的金标准规则。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 1 QC</span></span><span leaf=""><br></span><span><span leaf=""># based on the histogram plot, here we choose 20 transcript counts as lower cutoff</span></span><span leaf=""><br></span><span leaf="">hist(xenium.obj</span><span><span leaf="">$nCount_Xenium</span></span><span leaf="">, xlim=c(0,200), breaks = 5000)</span><span leaf=""><br></span><span leaf="">abline(v = 20, col=</span><span><span leaf="">"red"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 基于每个细胞检测到的转录本数量进行细胞筛选</span></span><span leaf=""><br></span><span><span leaf=""># 上限截断值 - 第98百分位数</span></span><span leaf=""><br></span><span><span leaf=""># 下限截断值 - 20（根据之前的图表确定）</span></span><span leaf=""><br></span><span leaf="">thres &lt;- quantile(xenium.obj</span><span><span leaf="">$nCount_Xenium</span></span><span leaf="">, c(0.98))</span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- subset(xenium.obj, subset = nCount_Xenium &gt;= 20 &amp; nCount_Xenium &lt;= thres[1])</span><span leaf=""><br></span><span leaf="">xenium.obj</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRSmmfZWGgMrZdNsb90jG0o5qXka2Oorf9ejv86As7Zx0dQOv9ZY4WXQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.16097560975609757" data-type="png" data-w="820" data-imgfileid="100055525" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRSmmfZWGgMrZdNsb90jG0o5qXka2Oorf9ejv86As7Zx0dQOv9ZY4WXQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">过滤前的细胞数：699110</span></p><p data-tool="mdnice编辑器"><span leaf="">过滤后：490610</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">nCount_Xenium &gt;= 20 这个确实会比较主观，多看点文献收集一下别人的标准。</span></span></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">2 数据标准化</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">## Normalization</span></span><span leaf=""><br></span><span><span leaf="">## 总counts标准化，这里的标化因子跟以前不一样：以前10^4，为什么用这个？scale factor - median transcript count</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- NormalizeData(xenium.obj, scale.factor=median(xenium.obj</span><span><span leaf="">$nCount_Xenium</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">3 高变基因</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">如果是  Xenium v1 产品，基因数应该很少，这个时候用全部分基因就好了。</span></p><p data-tool="mdnice编辑器"><span leaf="">查了一下，Xenium v1 50-480个基因，Xenium 5k约5k个基因。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRNn51Ydmh57srjh2iaWGmvOQfBDpiawRZMdroJDTO5MplQtGwuiajhAQsw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5472222222222223" data-type="png" data-w="1080" data-imgfileid="100055532" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRNn51Ydmh57srjh2iaWGmvOQfBDpiawRZMdroJDTO5MplQtGwuiajhAQsw/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 高变基因</span></span><span leaf=""><br></span><span><span leaf=""># xenium.obj &lt;- FindVariableFeatures(xenium.obj, nfeatures=nrow(xenium.obj))</span></span><span leaf=""><br></span><span><span leaf="">## Find top 2k variable genes</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- FindVariableFeatures(xenium.obj)</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">4 scale</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">## data scaling</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- ScaleData(xenium.obj)</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">5 PCA，降维聚类UMAP分析</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这里的分析流程与单细胞转录组，空间转录组是一样的：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">## PCA for dimensionality reduction</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- RunPCA(xenium.obj, verbose = FALSE)</span><span leaf=""><br></span><span><span leaf="">## 2D projection by UMAP</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- RunUMAP(xenium.obj, dims = 1:30, verbose = FALSE)</span><span leaf=""><br></span><span><span leaf="">## clustering</span></span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- FindNeighbors(xenium.obj, dims = 1:30)</span><span leaf=""><br></span><span leaf="">xenium.obj &lt;- FindClusters(xenium.obj, resolution = .5)</span><span leaf=""><br></span><span><span leaf="">## plot clustering results in UMAP</span></span><span leaf=""><br></span><span leaf="">options(repr.plot.width=8, repr.plot.height=8)</span><span leaf=""><br></span><span leaf="">p &lt;- DimPlot(xenium.obj)</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">umap结果：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRfMZMayWkgbktxsQKULgJSGbMX4piaib4CibBSmYicWAynxvU6IglXfKbEg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8561827956989247" data-type="png" data-w="744" data-imgfileid="100055533" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRfMZMayWkgbktxsQKULgJSGbMX4piaib4CibBSmYicWAynxvU6IglXfKbEg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">在图片上展示聚类结果：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">## plot clustering results spatially in slide</span></span><span leaf=""><br></span><span leaf="">options(repr.plot.width=10, repr.plot.height=14)</span><span leaf=""><br></span><span leaf="">p &lt;- ImageDimPlot(xenium.obj)+scale_y_reverse()</span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRCtIpPsBBlCjyr1xBom351TITiaHY23ic8IhdkYx75YTMRDkPWJr7ulibQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.183431952662722" data-type="png" data-w="676" data-imgfileid="100055534" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losib3SBXwUfOs0VshzJnR15qRCtIpPsBBlCjyr1xBom351TITiaHY23ic8IhdkYx75YTMRDkPWJr7ulibQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">最后保存一下结果：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 保存一下结果</span></span><span leaf=""><br></span><span leaf="">saveRDS(xenium.obj, file = </span><span><span leaf="">"xenium.obj.Rds"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">总体上来说，Xenium的下游基本分析与单细胞转录组流程基本一致，难得地方应该在那个QC的过滤上。还有：单个样本的细胞数直接变成50w+，这样的数据量，就是考量计算力的时候了。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">转发：</span></span></p></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247547917&amp;idx=1&amp;sn=76afb50b6e9e433e3f2b3d039f72dac4&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课2026年1月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课2026年1月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/soYf8RrklkBGRTdOLabxcA",target="_blank" rel="noopener noreferrer">原文链接</a>
