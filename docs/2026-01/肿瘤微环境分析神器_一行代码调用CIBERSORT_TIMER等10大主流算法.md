---
title: "肿瘤微环境分析神器：一行代码调用CIBERSORT、TIMER等10大主流算法"
date: 2026-01-21T01:07:28Z
draft: ["false"]
tags: [
  "fetched",
  "YuLabSMU"
]
categories: ["Acdemic"]
---
肿瘤微环境分析神器：一行代码调用CIBERSORT、TIMER等10大主流算法 by YuLabSMU
------
<div><section data-plugin="note-to-mp"><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRXEicuglYYhhgSxyicPxCIxaHZpFYBHx97fkeRicOjtp0wIJurCJI3ibiaiaopjKV9C4TK9fpXlcMiaxdQ/640?from=appmsg" alt="Cover Image" data-ratio="0.5712962962962963" data-w="1080" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4mRXEicuglYYhhgSxyicPxCIxaHZpFYBHx97fkeRicOjtp0wIJurCJI3ibiaiaopjKV9C4TK9fpXlcMiaxdQ/640?from=appmsg"></section><h2><span leaf="">🕵️‍♂️ 揭开肿瘤"黑箱"的秘密</span></h2><p><span leaf="">肿瘤不仅仅是一团癌细胞，它是一个复杂的生态系统——</span><strong><span leaf="">肿瘤微环境（TME）</span></strong><span leaf="">。这里面混杂着T细胞、B细胞、巨噬细胞、成纤维细胞……它们有的在杀伤肿瘤，有的却在帮肿瘤"打掩护"。</span></p><p><span leaf="">要搞清楚这个微环境，我们通常使用"去卷积"（Deconvolution）算法，从Bulk RNA-seq数据中推断各种细胞的比例。</span></p><p><span leaf="">但是，市面上的算法太多了：CIBERSORT, TIMER, xCell, MCPCounter... 每个软件的安装方法不一样，输入数据格式不一样，输出结果也不一样。光是把环境配好，可能就得花上一周。</span></p><p><span leaf="">"要是能把它们都装进一个盒子里就好了。"</span></p><p><span leaf="">tigeR：好的，我来了。</span></p><h2><span leaf="">🧰 10种算法，一个接口</span></h2><p><span leaf="">tigeR包堪称TME分析的"瑞士军刀"。它集成了目前最主流的</span><strong><span leaf="">10种</span></strong><span leaf="">去卷积算法，并且统一了调用接口。</span></p><p><span leaf="">你没看错，是10种：</span></p><ol><li><section><strong><span leaf="">TIMER</span></strong></section></li><li><section><strong><span leaf="">CIBERSORT</span></strong><span leaf=""> (经典中的经典)</span></section></li><li><section><strong><span leaf="">MCPCounter</span></strong></section></li><li><section><strong><span leaf="">xCell</span></strong></section></li><li><section><strong><span leaf="">IPS</span></strong></section></li><li><section><strong><span leaf="">EPIC</span></strong></section></li><li><section><strong><span leaf="">ESTIMATE</span></strong><span leaf=""> (评估免疫/基质评分)</span></section></li><li><section><strong><span leaf="">ABIS</span></strong></section></li><li><section><strong><span leaf="">ConsensusTME</span></strong></section></li><li><section><strong><span leaf="">quanTIseq</span></strong></section></li></ol><h3><span leaf="">极简操作：deconv_TME</span></h3><p><span leaf="">不管你想用哪种算法，只需要记住这一个函数：</span><code><span leaf="">deconv_TME</span></code><span leaf="">。</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li><li><section><span leaf="">4</span></section></li><li><section><span leaf="">5</span></section></li><li><section><span leaf="">6</span></section></li><li><section><span leaf="">7</span></section></li><li><section><span leaf="">8</span></section></li><li><section><span leaf="">9</span></section></li><li><section><span leaf="">10</span></section></li></ul><pre><code><span leaf="">library</span><span leaf="">(</span><span leaf="">tigeR</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 使用 TIMER 算法</span></span></code><code><span leaf="">frac_timer </span><span leaf="">&lt;-</span><span leaf=""> deconv_TME</span><span leaf="">(</span><span leaf="">MEL_GSE78220</span><span leaf="">,</span><span leaf=""> method </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">"TIMER"</span></span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 使用 CIBERSORT 算法</span></span></code><code><span leaf="">frac_ciber </span><span leaf="">&lt;-</span><span leaf=""> deconv_TME</span><span leaf="">(</span><span leaf="">MEL_GSE78220</span><span leaf="">,</span><span leaf=""> method </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">"CIBERSORT"</span></span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 使用 xCell 算法</span></span></code><code><span leaf="">frac_xcell </span><span leaf="">&lt;-</span><span leaf=""> deconv_TME</span><span leaf="">(</span><span leaf="">MEL_GSE78220</span><span leaf="">,</span><span leaf=""> method </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">"xCell"</span></span><span leaf="">)</span></code></pre></section><p><span leaf="">只需修改</span><code><span leaf="">method</span></code><span leaf="">参数，就能无缝切换算法。这对于比较不同算法的结果，或者寻找最适合你数据的算法来说，简直太方便了！</span></p><h3><span leaf="">可视化：一目了然</span></h3><p><span leaf="">算出了比例，怎么展示？tigeR提供了精美的饼图和堆叠柱状图功能。</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li><li><section><span leaf="">4</span></section></li></ul><pre><code><span><span leaf=""># 可视化细胞比例</span></span></code><code><span leaf="">pie1 </span><span leaf="">&lt;-</span><span leaf=""> fraction_pie</span><span leaf="">(</span><span leaf="">cell_name_filter</span><span leaf="">(</span><span leaf="">frac_timer</span><span leaf="">)</span><span leaf="">,</span><span leaf=""> </span></code><code><span leaf="">   feature</span><span leaf="">=</span><span leaf="">factor</span><span leaf="">(</span><span leaf="">rownames</span><span leaf="">(</span><span leaf="">frac_timer</span><span leaf="">)</span><span leaf="">)</span><span leaf="">)</span></code><code><span leaf="">pie1</span></code></pre></section><h2><span leaf="">🧬 进阶玩法：单细胞数据赋能</span></h2><p><span leaf="">这是tigeR的一个</span><strong><span leaf="">杀手级功能</span></strong><span leaf="">。</span></p><p><span leaf="">通用的去卷积算法使用的是公共的Reference矩阵，可能并不完全适合你研究的特定癌种。</span></p><p><span leaf="">如果你手头有单细胞测序数据（scRNA-seq），tigeR允许你利用这些数据构建</span><strong><span leaf="">自定义的Reference矩阵</span></strong><span leaf="">，然后用于Bulk RNA-seq的去卷积！</span></p><p><span leaf="">这意味着，你可以获得极其精准、特异性极高的细胞比例估算。</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li><li><section><span leaf="">4</span></section></li><li><section><span leaf="">5</span></section></li><li><section><span leaf="">6</span></section></li><li><section><span leaf="">7</span></section></li><li><section><span leaf="">8</span></section></li><li><section><span leaf="">9</span></section></li><li><section><span leaf="">10</span></section></li><li><section><span leaf="">11</span></section></li><li><section><span leaf="">12</span></section></li><li><section><span leaf="">13</span></section></li></ul><pre><code><span leaf="">library</span><span leaf="">(</span><span leaf="">Seurat</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 1. 处理单细胞数据 (Seurat流程)</span></span></code><code><span><span leaf=""># ... (标准Seurat处理) ...</span></span></code><code><span leaf="">pbmc</span><span leaf="">$</span><span leaf="">celltype </span><span leaf="">&lt;-</span><span leaf=""> Idents</span><span leaf="">(</span><span leaf="">pbmc</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 2. 构建自定义Reference矩阵</span></span></code><code><span leaf="">ref_sig_mtr </span><span leaf="">&lt;-</span><span leaf=""> build_CellType_Ref</span><span leaf="">(</span><span leaf="">pbmc</span><span leaf="">,</span><span leaf=""> logfc.threshold </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">1.5</span></span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 3. 使用自定义Reference进行去卷积 (以CIBERSORT为例)</span></span></code><code><span leaf="">Ciber_SE </span><span leaf="">&lt;-</span><span leaf=""> deconv_TME</span><span leaf="">(</span><span leaf="">MEL_GSE91061</span><span leaf="">,</span></code><code><span leaf="">   method</span><span leaf="">=</span><span><span leaf="">"CIBERSORT"</span></span><span leaf="">,</span></code><code><span leaf="">   sig_matrix</span><span leaf="">=</span><span leaf="">ref_sig_mtr</span><span leaf="">)</span></code></pre></section><p><span leaf="">打通单细胞与Bulk数据，让你的分析深度瞬间提升一个档次。</span></p><h2><span leaf="">💡 总结</span></h2><p><span leaf="">tigeR在TME分析模块展现了强大的整合能力和灵活性：</span></p><ul><li><section><strong><span leaf="">集大成</span></strong><span leaf="">：10种主流算法，一网打尽。</span></section></li><li><section><strong><span leaf="">统一化</span></strong><span leaf="">：一个函数，统一接口，降低学习成本。</span></section></li><li><section><strong><span leaf="">定制化</span></strong><span leaf="">：支持从单细胞数据构建Reference，实现精准分析。</span></section></li></ul><p><span leaf="">无论你是想快速看一眼免疫浸润情况，还是想深入挖掘特定细胞亚群，tigeR都能陪你到底。</span></p><p><span leaf="">下一期，我们将挑战最高难度的任务：</span><strong><span leaf="">构建机器学习模型，预测免疫治疗响应</span></strong><span leaf="">！</span></p><hr><p><strong><span leaf="">参考资料</span></strong><span leaf="">：</span></p><ol><li><section><span leaf="">tigeR Github: https://github.com/YuLab-SMU/tigeR</span></section></li><li><section><span leaf="">iMeta Paper: http://doi.org/10.1002/imt2.229</span></section></li></ol></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Zy3N9fjc9SZilfhA4RI8cA",target="_blank" rel="noopener noreferrer">原文链接</a>
