---
title: "细胞注释，T 细胞的Marker基因"
date: 2026-01-27T02:48:19Z
draft: ["false"]
tags: [
  "fetched",
  "芒果师兄"
]
categories: ["Acdemic"]
---
细胞注释，T 细胞的Marker基因 by 芒果师兄
------
<div><section data-recommend-type="list-normal" data-recommend-tid="2" data-mpa-template="t" data-mid="" data-from="yb-recommend" data-mpa-powered-by="yiban.io"><section data-mid=""><section data-mpa-template="t" data-recommend-article-type="list-normal" data-recomment-template-id="2" data-recommend-article-id="2247548207_1" data-recommend-article-time="1714925160" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpp9ZapsmLFxPwDjWbzq7yyiaO6zV7H7ic4Gz3XQ5d0TojepEgCOdvZo711vlodCO85u6lfOtzlzRkg/0?wx_fmt=jpeg" data-recommend-article-title="细胞注释，B 细胞的Marker基因" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247548207&amp;idx=1&amp;sn=63de4bd280f9ae498aa91ed53c056cd9&amp;chksm=ce1e7e40f969f756daed667a9531ba3cc8abb3f2800fe3ce86cd2351846362049c3244ea0c99#rd"><a href="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247548207&amp;idx=1&amp;sn=63de4bd280f9ae498aa91ed53c056cd9&amp;chksm=ce1e7e40f969f756daed667a9531ba3cc8abb3f2800fe3ce86cd2351846362049c3244ea0c99&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-content="t" data-mid=""><section data-mid=""><p data-recommend-title="t" data-mid="">细胞注释，B 细胞的Marker基因</p><p data-recommend-date="t" data-mid="">2024-05-06</p></section><span><img data-imgfileid="100066387" data-ratio="0.9984076433121019" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpp9ZapsmLFxPwDjWbzq7yyiaO6zV7H7ic4Gz3XQ5d0TojepEgCOdvZo711vlodCO85u6lfOtzlzRkg/640?wx_fmt=jpeg" data-w="628" src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpp9ZapsmLFxPwDjWbzq7yyiaO6zV7H7ic4Gz3XQ5d0TojepEgCOdvZo711vlodCO85u6lfOtzlzRkg/640?wx_fmt=jpeg"></span> </section></a></section><section data-mpa-template="t" data-recommend-article-type="list-normal" data-recomment-template-id="2" data-recommend-article-id="2247522705_2" data-recommend-article-time="1685117880" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibq01fdiaia0ibuibT3Qmic13TbmScSnDfsKQMuXeer5VlmyHiaCS3NBTIqWy3fxiczFL2IUY4JUdYpsPbU4Q/0?wx_fmt=jpeg" data-recommend-article-title="细胞注释，NK细胞的Marker基因" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247522705&amp;idx=2&amp;sn=c865a67f1a469be55072f0dd050c1cec&amp;chksm=ce1edafef96953e89efe55adf0ecaa651e09f610a5a80865c3335059480113d4c53c042dfa6e#rd"><a href="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247522705&amp;idx=2&amp;sn=c865a67f1a469be55072f0dd050c1cec&amp;chksm=ce1edafef96953e89efe55adf0ecaa651e09f610a5a80865c3335059480113d4c53c042dfa6e&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-content="t" data-mid=""><section data-mid=""><p data-recommend-title="t" data-mid="">细胞注释，NK细胞的Marker基因</p><p data-recommend-date="t" data-mid="">2023-05-27</p></section><span><img data-imgfileid="100066389" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibq01fdiaia0ibuibT3Qmic13TbmScSnDfsKQMuXeer5VlmyHiaCS3NBTIqWy3fxiczFL2IUY4JUdYpsPbU4Q/640?wx_fmt=jpeg" data-w="954" src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibq01fdiaia0ibuibT3Qmic13TbmScSnDfsKQMuXeer5VlmyHiaCS3NBTIqWy3fxiczFL2IUY4JUdYpsPbU4Q/640?wx_fmt=jpeg"></span> </section></a></section><section data-mpa-template="t" data-recommend-article-type="list-normal" data-recomment-template-id="2" data-recommend-article-id="2247532420_2" data-recommend-article-time="1694966760" data-recommend-article-cover="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpibxZsm1ElwzT3n5yI0QYc4jE3hibKmEnQAiaNBUFqvnVITqEfcbvnQamJF00iamT3nQFdcbwXQybc9w/0?wx_fmt=jpeg" data-recommend-article-title="细胞注释，巨噬细胞的Marker基因" data-recommend-article-content-url="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247532420&amp;idx=2&amp;sn=70db31d1b632160270069be03ea7a548&amp;chksm=ce1e3cebf969b5fddf2e9d27ece7efa920fb2b5e56d8061ca1a32328af213a39b05b29c8ebae#rd"><a href="https://mp.weixin.qq.com/s?__biz=Mzg2MTExNTkwNA==&amp;mid=2247532420&amp;idx=2&amp;sn=70db31d1b632160270069be03ea7a548&amp;chksm=ce1e3cebf969b5fddf2e9d27ece7efa920fb2b5e56d8061ca1a32328af213a39b05b29c8ebae&amp;scene=21#wechat_redirect" data-linktype="1"><section data-recommend-content="t" data-mid=""><section data-mid=""><p data-recommend-title="t" data-mid="">细胞注释，巨噬细胞的Marker基因</p><p data-recommend-date="t" data-mid="">2023-09-18</p></section><span><img data-imgfileid="100066388" data-ratio="1.0021321961620469" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpibxZsm1ElwzT3n5yI0QYc4jE3hibKmEnQAiaNBUFqvnVITqEfcbvnQamJF00iamT3nQFdcbwXQybc9w/640?wx_fmt=jpeg" data-w="469" src="https://mmbiz.qpic.cn/mmbiz_jpg/2sn6vnlXuibpibxZsm1ElwzT3n5yI0QYc4jE3hibKmEnQAiaNBUFqvnVITqEfcbvnQamJF00iamT3nQFdcbwXQybc9w/640?wx_fmt=jpeg"></span> </section></a></section></section></section><p><img data-backh="229" data-backw="578" data-galleryid="" data-imgfileid="100066394" data-ratio="0.3962962962962963" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuibrxdfHT0Y0rYLIm6kV0QvbG7pr3F9NGOgUUeDGlejGFNW252GafobiawZfvk7WarhH9II2RZQvSAgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuibrxdfHT0Y0rYLIm6kV0QvbG7pr3F9NGOgUUeDGlejGFNW252GafobiawZfvk7WarhH9II2RZQvSAgw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-backh="459" data-backw="578" data-galleryid="" data-imgfileid="100066379" data-ratio="0.7944444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuibrxdfHT0Y0rYLIm6kV0QvbGgLntgvpab9MDAQa9wB6JbBHkB49Ajmh6HSAUjo0iakiballcAzvLbJKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuibrxdfHT0Y0rYLIm6kV0QvbGgLntgvpab9MDAQa9wB6JbBHkB49Ajmh6HSAUjo0iakiballcAzvLbJKQ/640?wx_fmt=png&amp;from=appmsg"></p><p><span>2018年12月，<span>张泽民教授团队</span>在Nature杂志发表题为Lineage tracking reveals dynamic relationships of T cells in colorectal cancer的研究论文，从单细胞层面上把 T 细胞分得明明白白，清清楚楚。首先是流式筛选<span>CD4或者CD8 T 细胞</span>，然后再在血液、正常组织和肿瘤组织中进行细分。有了这个表，T 细胞的单细胞注释就不难了。</span></p><pre><code><span>##提取T细胞，进行亚群</span><br>sce &lt;- subset(x = scobj, idents = c(<span>"CD8 T"</span>), invert = <span>F</span>)<br><br><span>## 重新走流程</span><br>sce &lt;- NormalizeData(sce, normalization.method = <span>"LogNormalize"</span>, scale.factor = <span>1e4</span>) </code></pre><pre><code>## Normalizing layer: counts</code></pre><pre><code>sce &lt;- FindVariableFeatures(sce, selection.method = <span>'vst'</span>, nfeatures = <span>2000</span>)</code></pre><pre><code>## Finding variable features for layer counts</code></pre><pre><code>sce &lt;- ScaleData(sce, vars.to.regress = <span>"percent.mt"</span>)</code></pre><pre><code>## Regressing out percent.mt<br>## Centering and scaling data matrix</code></pre><pre><code>## Warning: Different features in new layer data than already exists for<br>## scale.data</code></pre><pre><code>sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce)) </code></pre><pre><code>## PC_ 1 <br>## Positive:  NKG7, CCL5, GZMA, CST7, GZMH, S100A4, PRF1, SH3BGRL3, FGFBP2, EFHD2 <br>##     GZMB, ZEB2, PLEK, CLIC1, ANXA1, CD99, KLRD1, LGALS1, MYO1F, AHNAK <br>##     C12orf75, SRGN, S100A6, GNLY, FLNA, PYHIN1, HLA-DRB1, ITGB1, CX3CR1, ITGB2 <br>## Negative:  RPL32, RPL13, RPS12, RPS13, RPS3A, RPS23, RPS6, RPS8, RPL9, RPL34 <br>##     RPL11, TPT1, RPS28, RPLP1, RPS14, RPL22, EEF1A1, RPS18, CCR7, RPL10 <br>##     RPL39, RPS5, RPL35A, RPL5, RPL18A, EEF1B2, RPS16, RPL12, RPS2, RPL37 <br>## PC_ 2 <br>## Positive:  KLRB1, GZMK, SLC4A10, IL7R, NCR3, CEBPD, PHACTR2, LTB, LTK, ZBTB16 <br>##     DUSP1, LST1, AQP3, CCR6, DPP4, CXXC5, JAML, ERN1, GPR65, KIF5C <br>##     CXCR6, RORC, SCART1, ADAM12, GPR171, TNFRSF25, FOS, ODF2L, LGALS3, CD69 <br>## Negative:  TMSB10, CD8B, GZMH, FGFBP2, GZMB, FYB1, ADGRG1, ZEB2, CD8A, FCGR3A <br>##     CX3CR1, PRSS23, LEF1, HLA-DPB1, FCRL6, KLRD1, CCR7, AIF1, LGALS1, LAIR2 <br>##     HLA-DRB1, APBA2, LINC02446, SELL, ACTN1, ITGB1, SPON2, C1orf21, GNLY, MAL <br>## PC_ 3 <br>## Positive:  RPS21, FGFBP2, RPS4X, RPL36A, RPL35A, RPS14, RPL10, RPL34, GZMB, RPS10 <br>##     RPL37, GNLY, KLRB1, GZMH, PRSS23, RPS2, RPL18A, RPL39, SPON2, S100A6 <br>##     RPS3A, ACTB, S100A4, PRF1, LAIR2, ASCL2, ADGRG1, RPL36, PRR5, NKG7 <br>## Negative:  ITGA4, KIAA1551, CD84, SLFN5, PIK3R1, GZMK, FYB1, NIN, SYNE2, LYST <br>##     TCF7, CYLD, TIGIT, HIST1H1E, GCC2, MT-ND4L, MACF1, UTRN, INPP4B, GOLGB1 <br>##     CD27, COTL1, DGKA, GPR183, ANK3, SYNE1, RPS26, CLDND1, ARAP2, TRAT1 <br>## PC_ 4 <br>## Positive:  GZMB, BCL2, FGFBP2, FCGR3A, ASCL2, PRSS23, TOB1, ZNF683, SPON2, MT-ND4L <br>##     NRIP1, TRABD2A, ADGRG1, LRRN3, CX3CR1, ACTN1, VCL, IL6ST, SLC4A10, LINC02446 <br>##     PLAC8, TMIGD2, PRF1, S100A6, CD52, RORA, AQP3, DSTN, VIM, PRKCA <br>## Negative:  GZMK, CMC1, DUSP2, CD74, CCL5, RPS29, HLA-DRB1, TIGIT, CD160, HLA-DRA <br>##     TRDC, XCL2, COTL1, LYAR, HLA-DQB1, HLA-DPA1, HLA-DPB1, FCRL3, RPL39, CD27 <br>##     RPS10, HLA-DQA1, HLA-DMA, LYST, CST7, MS4A1, DTHD1, CCL3L3, CD84, ITM2A <br>## PC_ 5 <br>## Positive:  RPS4Y1, MT-ND4L, MT-ND3, KLRD1, HIST1H1E, DDX3Y, TRDC, RPS29, CTSW, UTY <br>##     TRDV2, TTTY15, PYHIN1, EIF1AY, TYROBP, CMC1, RPL37, RPS21, HIST1H1D, SYNE1 <br>##     LCP1, PLEK, KIAA1551, AOAH, TRGC1, SYTL2, C1orf21, RPL21, RPL39, CST7 <br>## Negative:  IFI44L, XIST, TMSB10, CD4, TYMP, COTL1, ACTB, LTB, JUNB, MX1 <br>##     ISG15, STAT1, XAF1, VIM, TRAC, S100A11, IFI6, EPSTI1, IFI44, IRF9 <br>##     C1orf56, RPS4X, CXCR3, LGALS3, GPR183, GBP1, PARP9, PDCD1, S100A10, SERINC5</code></pre><pre><code>sce &lt;- FindNeighbors(sce, dims = <span>1</span>:<span>10</span>)          <span>## 是否需要重新聚类，以确定分多少群？</span></code></pre><pre><code>## Computing nearest neighbor graph<br>## Computing SNN</code></pre><pre><code>sce &lt;- FindClusters(sce, resolution = <span>1.1</span>)      <span>## 时而有用，0.8；再细分</span></code></pre><pre><code>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck<br>## <br>## Number of nodes: 15604<br>## Number of edges: 477074<br>## <br>## Running Louvain algorithm...<br>## Maximum modularity in 10 random starts: 0.7954<br>## Number of communities: 15<br>## Elapsed time: 1 seconds</code></pre><pre><code>sce &lt;- RunUMAP(sce, dims = <span>1</span>:<span>10</span>)</code></pre><pre><code>## 06:45:27 UMAP embedding parameters a = 0.9922 b = 1.112<br>## 06:45:27 Read 15604 rows and found 10 numeric columns<br>## 06:45:27 Using Annoy for neighbor search, n_neighbors = 30<br>## 06:45:27 Building Annoy index with metric = cosine, n_trees = 50<br>## 0%   10   20   30   40   50   60   70   80   90   100%<br>## [----|----|----|----|----|----|----|----|----|----|<br>## **************************************************|<br>## 06:45:28 Writing NN index file to temp file C:\Users\ADMINI~1\AppData\Local\Temp\RtmpsTHcLv\file295c623527ad<br>## 06:45:28 Searching Annoy index using 1 thread, search_k = 3000<br>## 06:45:31 Annoy recall = 100%<br>## 06:45:31 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30<br>## 06:45:32 Initializing from normalized Laplacian + noise (using RSpectra)<br>## 06:45:32 Commencing optimization for 200 epochs, with 645072 positive edges<br>## 06:45:42 Optimization finished</code></pre><pre><code><span>##散点图</span><br>DimPlot(sce, reduction = <span>"umap"</span>, label = <span>T</span>,pt.size = <span>1.5</span>) <span># + NoLegend()</span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066362" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRnTndydSNed7ibCuFSvtXfy5vKJrnJUEreQTXVuib6AIEMpQVco2ZIAPg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRnTndydSNed7ibCuFSvtXfy5vKJrnJUEreQTXVuib6AIEMpQVco2ZIAPg/640?wx_fmt=png&amp;from=appmsg"></p><pre><code><span>##使用VlnPlot画marker小提琴图</span><br>VlnPlot(sce, features = c(<span>"CD8A"</span>, <span>"LEF1"</span>,<span>"TCF7"</span>,<span>"KLF2"</span>,<span>"TXK"</span>,<span>"BACH2"</span>,<span>"CD8B"</span>)) <span>## NAIVE </span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066365" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRibLDNcnc90hk7FcLStcz1YVK1fOGcJnOBvCKkWjqRWjCB50oJCBoTicw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRibLDNcnc90hk7FcLStcz1YVK1fOGcJnOBvCKkWjqRWjCB50oJCBoTicw/640?wx_fmt=png&amp;from=appmsg"></p><pre><code>VlnPlot(sce, features = c(<span>"CD8A"</span>, <span>"SLC4A10"</span>,<span>"ZBTB16"</span>,<span>"NCR3"</span>)) <span>## MAIT</span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066363" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRUs2KuL03ncyE0YwjicFiaB77fY7fFSqzb0cKKYYupVTMqkS4E5fnej6A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRUs2KuL03ncyE0YwjicFiaB77fY7fFSqzb0cKKYYupVTMqkS4E5fnej6A/640?wx_fmt=png&amp;from=appmsg"></p><pre><code>VlnPlot(sce, features = c(<span>"CD8A"</span>,<span>"CD3D"</span>,<span>"GNLY"</span>,<span>"NKG7"</span>,<span>"GZMB"</span>,<span>"GZMA"</span>,<span>"GZMM"</span>))     <span>## Effector </span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066364" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRoicJ0XtNd0g2u6MzH78AuFFicmdMJ99pgBKMVWhlfiaDE11SvghErfruA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRoicJ0XtNd0g2u6MzH78AuFFicmdMJ99pgBKMVWhlfiaDE11SvghErfruA/640?wx_fmt=png&amp;from=appmsg"></p><pre><code>VlnPlot(sce, features = c(<span>"CD8A"</span>,<span>"CD3D"</span>,<span>"GPR183"</span>,<span>"S100A4"</span>,<span>"GZMA"</span>,<span>"GZMK"</span>))     <span>## Memory </span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066366" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRZswm2GkYp4o1JaK2oEW6ac4s7bMNrFHzQJgz8hLrwZg5VxH2xKBZ6g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRZswm2GkYp4o1JaK2oEW6ac4s7bMNrFHzQJgz8hLrwZg5VxH2xKBZ6g/640?wx_fmt=png&amp;from=appmsg"></p><pre><code>VlnPlot(sce, features = c(<span>"TRDC"</span>, <span>"TRGC1"</span>,<span>"TRGC2"</span>,<span>"CD8A"</span>,<span>"CD4"</span>))   <span>## GAMMADELTA</span></code></pre><p><img data-backh="412" data-backw="578" data-imgfileid="100066367" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRIyEdNRDnMEf3O0zyptnwLB8Oicics75j6m3SZB6lZSYeKUjPxxIBuibdQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672" src="https://mmbiz.qpic.cn/mmbiz_png/2sn6vnlXuiboNurdtEveOxzc0w1GkB5rRIyEdNRDnMEf3O0zyptnwLB8Oicics75j6m3SZB6lZSYeKUjPxxIBuibdQ/640?wx_fmt=png&amp;from=appmsg"></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vUBWxwfdHEPqbM_5buQCGg",target="_blank" rel="noopener noreferrer">原文链接</a>
