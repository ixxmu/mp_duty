---
title: "单细胞数据怎么做基因相关性分析"
date: 2026-01-28T13:39:25Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
单细胞数据怎么做基因相关性分析 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://wechat.jeffjade.com/" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">做单细胞数据时，我遇到了一个看起来很自然的问题：</span></p><blockquote><span><span leaf="">“</span></span><p><strong><span leaf="">在某个细胞类型里，基因A和哪些基因相关？</span></strong><span leaf=""><br></span><span leaf="">它们可能参与什么通路？与增殖/EMT/免疫状态是否有关？</span></p><span><span leaf="">”</span></span></blockquote><p data-tool="mdnice编辑器"><span leaf="">于是打开 Seurat，写下那句经典代码：</span></p><blockquote><span><span leaf="">“</span></span><p><span leaf="">“在这个细胞类型里，算基因A和目标基因的相关系数。”</span></p><span><span leaf="">”</span></span></blockquote><p data-tool="mdnice编辑器"><span leaf="">然后得到结果——看起来非常顺。</span></p><p data-tool="mdnice编辑器"><span leaf="">但是一看图，大事不妙！</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9zqeEjWqNh3MmzIjOuBp4s5gbib6cwP8d9BLIOHZwqBoaZzJyYOiaw0IoNOibKPxKyHfUqJsFozn8gg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.687037037037037" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100055611" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9zqeEjWqNh3MmzIjOuBp4s5gbib6cwP8d9BLIOHZwqBoaZzJyYOiaw0IoNOibKPxKyHfUqJsFozn8gg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf="">如果把这套结果写进论文，可能会被reviewer 追问：</span></p><blockquote><span><span leaf="">“</span></span><p><strong><span leaf="">“单细胞这么稀疏（dropout），你这个相关性靠谱吗？”</span></strong><span leaf=""><br></span><strong><span leaf="">“你是不是把细胞当成独立重复了？”</span></strong></p><span><span leaf="">”</span></span></blockquote><p data-tool="mdnice编辑器"><strong><span leaf="">那么同一细胞类型内做基因相关性分析，到底怎么做才稳？什么时候必须用 pseudobulk？</span></strong></p><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">1. 单细胞里做基因相关性，为什么坑特别多？</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">在 bulk RNA-seq 里做相关性非常直接：样本是独立重复。</span></p><p data-tool="mdnice编辑器"><span leaf="">但在 scRNA-seq 里，“直接算相关”会遇到三个经典陷阱：</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">（1）Dropout 导致假相关</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">可能基因A在很多细胞里是 0，另一个基因也很多 0。</span><span leaf=""><br></span><span leaf="">你会得到：</span></p><ul><li><section><span leaf="">假正相关（两个基因一起“掉”）</span></section></li><li><section><span leaf="">假负相关（表达稀疏把相关压低）</span></section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">（2）测序深度/UMI 总量效应</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">UMI 高的细胞，几乎所有基因都更高。</span><span leaf=""><br></span><span leaf="">如果不处理，总量会制造“全基因都相关”的错觉。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">（3）最致命：伪重复（pseudo-replication）</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">如果你有 3 只小鼠，每只 2000 个肿瘤细胞：</span></p><ul><li><section><span leaf="">代码里 n = 6000</span></section></li><li><section><span leaf="">统计学意义上真正的 n = 3</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">👉 这会导致 p 值严重虚高，“显著”看起来特别漂亮，但最容易被审稿人抓。</span></p><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">2. 到底在回答哪类“相关性问题”？</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">同样是“基因A vs 其他基因相关性”，其实分两类科学问题：</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">A 类问题：细胞状态共现（cell-level）</span></span><span></span></h3><blockquote><span><span leaf="">“</span></span><p><span leaf="">在同一细胞类型里，基因A高的细胞，是否也基因B也更高？或者是EMT相关的基因更高/低？</span></p><span><span leaf="">”</span></span></blockquote><p data-tool="mdnice编辑器"><span leaf="">关键词：</span><strong><span leaf="">单细胞异质性 / 状态共现</span></strong></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">B 类问题：样本层面共变（sample-level）</span></span><span></span></h3><blockquote><span><span leaf="">“</span></span><p><span leaf="">在不同样本中（小鼠/患者），该细胞类型里基因A高的样本，同时哪些基因也高？</span></p><span><span leaf="">”</span></span></blockquote><p data-tool="mdnice编辑器"><span leaf="">关键词：</span><strong><span leaf="">可重复 / 跨样本一致</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">⚠️ 这两类问题，对应的正确方法完全不同。</span><span leaf=""><br></span><span leaf="">也直接决定是否需要 pseudobulk。</span></p><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">3. 单细胞相关性分析的 3 条路线（从“快”到“稳”）</span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">路线 1：直接在细胞层面算相关（快，但风险最高）</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">做法：选定细胞类型 → 相关系数（Pearson/Spearman）→ top genes → 富集/网络</span></p><p data-tool="mdnice编辑器"><span leaf="">优点：</span></p><ul><li><section><span leaf="">简单、快、适合探索</span></section></li><li><section><span leaf="">图好画</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">缺点：</span></p><ul><li><section><span leaf="">dropout / depth / 伪重复</span></section></li><li><section><span leaf="">容易被 reviewer 质疑</span></section></li></ul><hr><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">路线 2：Meta-cell / smoothing 后再算相关（折中）</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">核心思路：把相似细胞合并（meta-cell）降低稀疏性，再算相关。</span></p><p data-tool="mdnice编辑器"><span leaf="">优点：</span></p><ul><li><section><span leaf="">更稳一点</span></section></li><li><section><span leaf="">网络更清晰</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">缺点：</span></p><ul><li><section><span leaf="">参数多</span></section></li><li><section><span leaf="">reviewer 可能问：meta-cell 怎么构建？会不会引入偏差？</span></section></li></ul><hr><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">路线 3：统计模型推断 cell-type co-expression）</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这类方法专门为单细胞共表达设计，考虑深度差异与噪声，给出更可靠的相关性估计。</span></p><p data-tool="mdnice编辑器"><span leaf="">📌 推荐：</span><strong><span leaf="">CS-CORE（Nature Communications 2023）</span></strong><span leaf=""><br></span><em><span leaf="">Cell-type-specific co-expression inference from single cell RNA-sequencing data</span></em></p><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">4. 什么时候必须用 pseudobulk？（核心！）</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">一句话原则：</span></p><blockquote><span><span leaf="">“</span></span><p><strong><span leaf="">当你的生物学重复单位是“样本/个体”，而不是“细胞”时，就该用 pseudobulk。</span></strong></p><span><span leaf="">”</span></span></blockquote><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">pseudobulk 是什么？</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">把 scRNA-seq 在 </span><strong><span leaf="">sample × celltype</span></strong><span leaf=""> 维度聚合：</span></p><ul><li><section><span leaf="">每个样本</span></section></li><li><section><span leaf="">每个细胞类型</span></section></li><li><section><span leaf="">得到一个“伪 bulk”表达向量</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">然后你就可以在样本层面：</span></p><ul><li><section><span leaf="">做相关性</span></section></li><li><section><span leaf="">做差异分析</span></section></li><li><section><span leaf="">做回归（加 batch/sex 等协变量）</span></section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">强烈建议用 pseudobulk 的 5 种情况</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">只要中了 2 条以上，就适用：</span></p><ol><li><section><span leaf="">有多个样本（患者/小鼠）</span></section></li><li><section><span leaf="">样本数少但细胞数很多（典型：n=3，每个几千细胞）</span></section></li><li><section><span leaf="">想做统计检验、写进论文主线</span></section></li><li><section><span leaf="">担心个体差异/批次效应</span></section></li><li><section><span leaf="">想让 reviewer 最难挑刺</span></section></li></ol><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">5. 回到 基因A：最稳的分析策略</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">如果你的目标是“既要探索，又要可发表”，最稳是两层证据：</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">第一层（探索）：细胞层面相关</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">在同一细胞类型内：</span></p><ul><li><section><span leaf="">基因A vs 其他基因（Spearman）</span></section></li><li><section><span leaf="">看趋势、画散点/热图</span></section></li><li><section><span leaf="">用于发现候选通路</span></section></li></ul><hr><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">第二层（主结论）：pseudobulk 样本层面相关</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">按 sample × celltype 聚合后：</span></p><ul><li><section><span leaf="">在样本层面算相关性（基因Avs gene_i）</span></section></li><li><section><span leaf="">输出 top correlated genes</span></section></li><li><section><span leaf="">富集分析</span></section></li></ul><hr><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">6. 总结</span></span></h2><blockquote><span><span leaf="">“</span></span><p><strong><span leaf="">单细胞相关性回答“谁和谁在同一个细胞状态里相关”；</span></strong><span leaf=""><br></span><strong><span leaf="">pseudobulk 相关性回答“这种共“变”在样本层面是否可重复”。</span></strong></p><span><span leaf="">”</span></span></blockquote></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7lCtfUkbhJ9lJ9psFBlT9A",target="_blank" rel="noopener noreferrer">原文链接</a>
