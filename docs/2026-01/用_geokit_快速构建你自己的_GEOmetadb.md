---
title: "用 geokit 快速构建你自己的 GEOmetadb"
date: 2026-01-14T09:13:30Z
draft: ["false"]
tags: [
  "fetched",
  "生信协作组"
]
categories: ["Acdemic"]
---
用 geokit 快速构建你自己的 GEOmetadb by 生信协作组
------
<div><h1 data-tool="mdnice编辑器" data-pm-slice="0 0 []"><span></span></h1><p data-tool="mdnice编辑器"><span leaf="">如果你在做生物信息学研究，特别是在处理 GEO（Gene Expression Omnibus） 数据时，可能已经使用过 GEOmetadb 包。这个包虽然曾经是一个很好的工具，但遗憾的是它已经多年没有更新；并且</span><code><span leaf="">GEOmetadb</span></code><span leaf=""> 包是静态的，依赖于开发者手动更新，导致很多情况下，数据并不完全或不及时。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">为什么要构建自己的 GEOmetadb？</span></strong></p><ul><li><section><span leaf="">专注自我关注领域：例如糖尿病、肝癌、泌尿上皮癌等，把所有相关的 Series 聚合并注释，方便后续批量下载、筛选和复现分析。</span></section></li><li><section><span leaf="">灵活的离线查询：GEO 的网页搜索不够灵活，使用 geokit 构建自己的数据库后，可以用你熟悉的正则表达式或数据库查询（如 grep、SQLite 等）自由检索，满足不同需求。</span></section></li><li><section><span leaf="">动态更新和增量同步：通过自动化脚本定期更新数据库，确保数据时刻保持最新，避免了手动更新的繁琐。</span></section></li><li><section><span leaf="">高效数据访问：离线存储后，查询速度大幅提升，尤其适用于处理大量 GEO Series 数据时，节省时间和带宽。</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">geokit 提供了一个高效且简便的方法，其核心操作全使用 </span><code><span leaf="">rust</span></code><span leaf=""> 实现，让你在数分钟内（如果数据已经下载完毕，以</span><strong><span leaf="">654</span></strong><span leaf="">条记录为例，解析时间约</span><strong><span leaf="">30.5</span></strong><span leaf="">秒)，构建好自己的 metadata数据库。</span></p><ul><li><section><span leaf="">基于</span><strong><span leaf="">NCBI Eutils</span></strong><span leaf="">搜索 GEO 数据库，并提取相关的元数据。</span></section></li><li><section><span leaf="">从GEO数据库抓取相关</span><strong><span leaf="">metadata</span></strong><span leaf="">数据，将其保存到本地，构建属于自己的 </span><code><span leaf="">GEOmetadb</span></code><span leaf="">。</span></section></li><li><section><span leaf="">使用 R 的正则表达式、筛选功能，或者 Excel、SQLite 等工具，快速检索与分析感兴趣的 Series（GSE） 和 样本信息。</span></section></li><li><section><span leaf="">同时支持所有</span><code><span leaf="">GEOquery</span></code><span leaf="">R包操作</span></section></li></ul><h4 data-tool="mdnice编辑器"><span><span leaf="">安装 geokit：</span></span></h4><ol><li><section><span leaf="">从 </span><strong><span leaf="">R-universe</span></strong><span leaf=""> 安装（推荐）：</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">install.packages(</span><span><span leaf="">'geokit'</span></span><span leaf="">, repos = c(</span><span><span leaf="">'https://wanglabcsu.r-universe.dev'</span></span><span leaf="">, </span><span><span leaf="">'https://cloud.r-project.org'</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><ol start="2"><li><section><span leaf="">从 </span><strong><span leaf="">GitHub</span></strong><span leaf=""> 安装（需要 Rust 编译链）：</span></section></li></ol><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">pak::pak(</span><span><span leaf="">"WangLabCSU/geokit"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h4 data-tool="mdnice编辑器"><span><span leaf="">使用示例：基于正则表达式检索并筛选单细胞数据</span></span></h4><h5 data-tool="mdnice编辑器"><span><span leaf="">1. 按关键词检索相关 Series（示例：膀胱/尿路上皮癌）</span></span></h5><p data-tool="mdnice编辑器"><span leaf="">基于 </span><strong><span leaf="">Eutils</span></strong><span leaf=""> 查询，更多细节请查看https://www.ncbi.nlm.nih.gov/geo/info/qqtutorial.html</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">uc_gse &lt;- list(</span><span leaf=""><br></span><span leaf="">    geokit::geo_search(</span><span leaf=""><br></span><span leaf="">        </span><span><span leaf="">"bladder cancer[ALL] AND Homo sapiens[ORGN] AND GSE[ETYP]"</span></span><span leaf=""><br></span><span leaf="">    ),</span><span leaf=""><br></span><span leaf="">    geokit::geo_search(</span><span leaf=""><br></span><span leaf="">        </span><span><span leaf="">"urothelial cancer[ALL] AND Homo sapiens[ORGN] AND GSE[ETYP]"</span></span><span leaf=""><br></span><span leaf="">    )</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">uc_gse &lt;- unique(dplyr::bind_rows(uc_gse))</span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span><span leaf="">2. 从 Contains 字段提取样本数量</span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">uc_gse$number_of_samples &lt;- stringr::str_match(</span><span leaf=""><br></span><span leaf="">    uc_gse$Contains, </span><span><span leaf="">"(\\d+) Samples?"</span></span><span leaf=""><br></span><span leaf="">)[, </span><span><span leaf="">2L</span></span><span leaf="">, drop = </span><span><span leaf="">TRUE</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 快速统计</span></span><span leaf=""><br></span><span leaf="">max_samples &lt;- max(as.numeric(uc_gse$number_of_samples), na.rm = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">median_samples &lt;- median(as.numeric(uc_gse$number_of_samples), na.rm = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">top_series &lt;- slice_max(uc_gse, as.numeric(number_of_samples))</span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span><span leaf="">3. 抓取 Series 的元数据（可并行/批量保存到本地目录）</span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">uc_gse_meta &lt;- geokit::geo_meta(</span><span leaf=""><br></span><span leaf="">  uc_gse[[</span><span><span leaf="">"Series Accession"</span></span><span leaf="">]],</span><span leaf=""><br></span><span leaf="">  odir = </span><span><span leaf="">"gse_urothelial_cancer"</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h5 data-tool="mdnice编辑器"><span><span leaf="">4. 筛选可能的单细胞研究（在 summary/title/design 中筛查关键字）</span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">uc_gse_sc &lt;- dplyr::filter(</span><span leaf=""><br></span><span leaf="">    uc_gse_meta,</span><span leaf=""><br></span><span leaf="">    dplyr::if_any(</span><span leaf=""><br></span><span leaf="">        c(Series_summary, Series_title, Series_overall_design),</span><span leaf=""><br></span><span leaf="">        grepl,</span><span leaf=""><br></span><span leaf="">        pattern = </span><span><span leaf="">"single[- ]cell|scRNA"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">        ignore.case = </span><span><span leaf="">TRUE</span></span><span leaf=""><br></span><span leaf="">    )</span><span leaf=""><br></span><span leaf="">) |&gt;</span><span leaf=""><br></span><span leaf="">    dplyr::mutate(</span><span leaf=""><br></span><span leaf="">        number_of_samples = lengths(</span><span leaf=""><br></span><span leaf="">            strsplit(Series_sample_id, </span><span><span leaf="">"; "</span></span><span leaf="">, fixed = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">        )</span><span leaf=""><br></span><span leaf="">    )</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 输出结果与统计</span></span><span leaf=""><br></span><span leaf="">dplyr::slice_max(uc_gse_sc, number_of_samples)$Series_geo_accession</span><span leaf=""><br></span><span leaf="">max(uc_gse_sc$number_of_samples, na.rm = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">median(uc_gse_sc$number_of_samples, na.rm = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">writexl::write_xlsx(uc_gse_sc, </span><span><span leaf="">"uc_gse_sc.xlsx"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">通过上述步骤，你已经成功创建了自己的 </span><code><span leaf="">GEOmetadb</span></code></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/69D9wmiH4F3nJcriW-wnCA",target="_blank" rel="noopener noreferrer">原文链接</a>
