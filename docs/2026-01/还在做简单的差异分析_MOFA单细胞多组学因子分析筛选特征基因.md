---
title: "还在做简单的差异分析？MOFA单细胞多组学因子分析筛选特征基因"
date: 2026-01-24T01:21:07Z
draft: ["false"]
tags: [
  "fetched",
  "Biomamba 生信基地"
]
categories: ["Acdemic"]
---
还在做简单的差异分析？MOFA单细胞多组学因子分析筛选特征基因 by Biomamba 生信基地
------
<div><section nodeleaf="" data-mp-plugin="96weixin"><mp-common-profile data-pluginname="mpprofile" data-nickname="Biomamba 生信基地" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpy4cR31GnTmYFdCZKZDcuCbwdtp2iaibCI3DvtRibLgnUDVB3NC0IVfiaQlVww9b7BdXQpicY7m4iaoXqibg/0?wx_fmt=png" data-signature="Biomamba，副研究员，博士，生物信息学爱好者。此公众号旨在分享生信知识及科研经验与体会，欢迎各位同学、老师与专家的批评指正、合作与交流！" data-id="MzAwMzIzOTk5OQ==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section><section data-support="96编辑器" data-style-id="28997" data-mp-plugin="96weixin"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhDSJwguTPZKnDmXzotiadIYqa0JG9aAMR6XEu3iaIgb7KReWjicJqK4ugoKzZ20YudMoSCvTXedNe8g/640?wx_fmt=gif" data-ratio="0.0033333333333333335" data-w="600" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhDSJwguTPZKnDmXzotiadIYqa0JG9aAMR6XEu3iaIgb7KReWjicJqK4ugoKzZ20YudMoSCvTXedNe8g/640?wx_fmt=gif"></section></section></section><section data-support="96编辑器" data-style-id="28345" data-mp-plugin="96weixin"><section data-align="title"><section><section><p><strong><span leaf="">一、写在前面</span></strong></p></section></section></section></section><section data-support="96编辑器" data-style-id="40098" data-mp-plugin="96weixin"><section><section><section><h2 data-pm-slice="0 0 []"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"40098","style":"margin-bottom: unset;letter-spacing: 0.578px;text-wrap: wrap;","data-mp-plugin":"96weixin"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"margin: 10px 8px;text-align: center;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"padding: 8px;box-shadow: #bcd1a9 0px 0px 8px;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"padding: 15px;border-radius: 10px;border-width: 1px;border-style: dashed;border-color: #accc96;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"white-space-collapse: collapse;background-color: #fefefe;margin-bottom: 10px;text-align: justify;text-indent: 2em;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"font-size: 14px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">MOFA</span></span><strong><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"40098","style":"margin-bottom: unset;letter-spacing: 0.578px;text-wrap: wrap;","data-mp-plugin":"96weixin"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"margin: 10px 8px;text-align: center;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"padding: 8px;box-shadow: #bcd1a9 0px 0px 8px;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"padding: 15px;border-radius: 10px;border-width: 1px;border-style: dashed;border-color: #accc96;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"white-space-collapse: collapse;background-color: #fefefe;margin-bottom: 10px;text-align: justify;text-indent: 2em;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"style":"font-size: 14px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">是一种因子分析模型，它为</span><span textstyle="">无监督方式</span><span textstyle="">整合多组学数据集提供了一个通用框架。直观地说，MOFA可以被视为一种适用于多组学数据的灵活且统计上严谨的主成分分析的延伸。给定几个数据矩阵，这些矩阵包含对相同或重叠样本集的多种组学数据类型的测量值，MOFA 推断出一个可解释的低维表示形式，以少量潜在因子的形式呈现。这些学习到的因子代表了跨数据模式的驱动变异源，从而有助于识别细胞状态或疾病亚组。MOFA最早被发布在《Molecular Systems Biology》上[1]，并为大家提供了</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247530924&amp;idx=2&amp;sn=ba3b03a998e48de5cec08933b734d905&amp;scene=21#wechat_redirect" textvalue="R语言" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">R语言</span></a><span textstyle="">和</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247520999&amp;idx=2&amp;sn=7f6aa90c2ffa786bd660aa40b109de49&amp;scene=21#wechat_redirect" textvalue="Python" data-itemshowtype="11" linktype="text" data-linktype="2"><span textstyle="">Python</span></a><span textstyle="">两个版本，目前已经更新到MOFA2。</span></span></strong></h2><h2 data-pm-slice="0 0 []"><strong><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"40098","style":"margin-bottom: unset;","data-mp-plugin":"96weixin"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"text-align: center;margin: 10px 8px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"box-shadow: #bcd1a9 0px 0px 8px;background: #fefefe;padding: 8px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"border-radius: 10px;border-width: 1px;border-style: dashed;border-color: #accc96;padding: 15px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"heading",{"tagName":"h2","attributes":{"style":"text-align: justify;text-indent: 2em;","data-pm-slice":"0 0 []"},"namespaceURI":"http://www.w3.org/1999/xhtml","level":2},"node",{"tagName":"strong","attributes":{},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">本教程我们来演示一下MOFA在时间</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247531092&amp;idx=1&amp;sn=9968319b84186bb9b717b7b409132d8b&amp;scene=21#wechat_redirect" textvalue="scRNA-seq" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">scRNA-seq</span></a><span textstyle="">数据集整合流程，并且展示了MOFA+在单一数据模态上的多组集成框架。我们将考察一组scRNA-seq实验数据，包含共8个发育阶段（E6.5、E6.75、E7.0和E7.25）的小鼠胚胎中的16,152个细胞（每阶段两个胚胎），涵盖着床后至早期胃胚形成。尽管发育时间不同，胚胎仍预计包含相似的细胞亚群。因此，MOFA+应检测到群体间共享的生物学变异。作者演示的是原始数据集的简化子集版本(</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247530367&amp;idx=1&amp;sn=f7452a93145295bd6dfc4a7e571413d6&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">人生苦短，我downsample</span></a><span textstyle="">)，可以点击下载[3]。MOFA允许跨多个群体进行推断，其中组是预定义的样本集合（即不同的条件、批次、队列等）。重要的是，该模型并不专注于捕捉组间的差异变化（例如在进行</span><span textstyle="">差异表达</span><span textstyle="">时）。多组框架的目标是找出每个组内的变异来源，并区分哪些变异在不同组间是共享的，哪些是单一组的。简单来说</span><span textstyle="">MOFA的核心任务就是在多组学数据中找到真正的生物学差异。</span></span></strong></h2><p><span leaf=""><br></span></p><p><span leaf=""><span textstyle="">更多单细胞空转教程可见：</span></span></p><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247531447&amp;idx=1&amp;sn=242b49b5e2f5496efbd4484bf2e81604&amp;scene=21#wechat_redirect" textvalue="保姆级单细胞&amp;空转教学| 生信全程班一览" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">保姆级单细胞&amp;空转教学| 生信全程班一览</span></a></span></p><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpy502RvEG9SaCFlS2I3lAXs5bAmnDdccOO6w4sMYscuUUw265f7RemapKciaibAzCHpZpglqOLvsA8Q/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.4148148148148147" data-type="jpeg" data-w="1080" data-imgfileid="100050461" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpy502RvEG9SaCFlS2I3lAXs5bAmnDdccOO6w4sMYscuUUw265f7RemapKciaibAzCHpZpglqOLvsA8Q/640?wx_fmt=jpeg&amp;from=appmsg"></span></section><section><span leaf=""><br></span><section><section data-pm-slice='5 4 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"40226","data-pm-slice":"6 2 []","style":"-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;color: rgba(0, 0, 0, 0.9);font-family: \"PingFang SC\", system-ui, -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif;font-size: 17px;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.544px;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;background-color: rgb(255, 255, 255);visibility: visible;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><section><span leaf=""><span textstyle="">如果需要</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247531160&amp;idx=2&amp;sn=04d3798dc60958af2c9020fe7c4bd9b8&amp;scene=21#wechat_redirect" textvalue="单细胞数据分析" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">单细胞数据分析</span></a></span><span leaf=""><span textstyle="">教学</span><span textstyle="">、生信热点</span><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAwMzIzOTk5OQ==&amp;action=getalbum&amp;album_id=2981710763847614469#wechat_redirect" textvalue="全文复现" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">全文复现</span></a></span><span leaf=""><span textstyle="">、自测数据</span><span textstyle="">个性化分析</span><span textstyle="">辅导、</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247530174&amp;idx=1&amp;sn=c3b0499adcc9093546e4ba1cfffba7bd&amp;scene=21#wechat_redirect" textvalue="常态化实验学习" data-itemshowtype="11" linktype="text" data-linktype="2"><span textstyle="">常态化实验学习</span></a></span><span leaf=""><span textstyle="">，欢迎联系客服微信[</span><span textstyle="">Biomamba_zhushou</span></span><span leaf=""><span textstyle="">]。</span></span></section></section></section></section></section></section></section></section><section data-support="96编辑器" data-style-id="28345" data-mp-plugin="96weixin"><section data-align="title"><section><section><p><span leaf=""><br></span></p><section data-pm-slice="0 0 []" data-mp-plugin="96weixin"><section data-pm-slice="0 0 []"><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section data-align="title"><section><section><p><strong><span leaf="">二、测试数据</span></strong></p></section></section></section></section></section></section></section></section></section></section></section></section><section data-support="96编辑器" data-style-id="40098" data-mp-plugin="96weixin"><section><section><section><section><span leaf=""><span textstyle="">学习手册下载见文末：</span></span></section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWiccX4aUnqZDYC1GFBcXrVMPsXA6Eka9v8wY1mFOfxIicB2CWUjnyCze0w/640?wx_fmt=gif&amp;from=appmsg" data-ratio="0.4166666666666667" data-s="300,640" data-type="gif" data-w="600" type="block" data-imgfileid="100050870" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWiccX4aUnqZDYC1GFBcXrVMPsXA6Eka9v8wY1mFOfxIicB2CWUjnyCze0w/640?wx_fmt=gif&amp;from=appmsg"></span></section><section><span leaf=""><br></span></section><section><span leaf=""><span textstyle="">学前tips:</span></span></section><section><span leaf=""><span textstyle="">本教程基于Linux环境的</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247524106&amp;idx=1&amp;sn=f23405302a3705007d33b688870196e0&amp;scene=21#wechat_redirect" textvalue="Rstudio-server的安装、配置、维护" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">Rstudio-server</span></a><span textstyle="">演示，计算资源不足的同学可参考：</span></span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247511780&amp;idx=1&amp;sn=3acc0874f7d2fa75f1abbe7a9a9b4069&amp;chksm=9b3cd7b4ac4b5ea27d4d53964e4a4a9fa8c806a19103729dd4ff0fa72e621411f46a251d269f&amp;scene=21&amp;token=1904068475&amp;lang=zh_CN#wechat_redirect" textvalue="足够支持你完成硕博生涯的生信环境" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">足够支持你完成硕博生涯的生信环境</span></a></span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247529475&amp;idx=1&amp;sn=10827e982a637e0fc36e4b6e857736c8&amp;scene=21&amp;token=1904068475&amp;lang=zh_CN&amp;poc_token=HF-eN2mj01zsfxe_I4r8D5pfZx80xO2AVYSB6qtT#wechat_redirect" textvalue="忘记宣传了，独享用户连技术支持都是独享的" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">忘记宣传了，独享用户连技术支持都是独享的</span></a></span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247529840&amp;idx=1&amp;sn=704b0a3d60a17c5bc2445d54c97b834f&amp;scene=21&amp;token=1904068475&amp;lang=zh_CN&amp;poc_token=HHWeN2mjUe1w7qMDvfaBNJZRTCq3qpve8MrnSv_z#wechat_redirect" textvalue="RTX5090、4080S、5070显卡上机" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">RTX5090、4080S、5070显卡上机</span></a></span></section><section><span leaf=""><span textstyle="">访问链接：</span><span textstyle="">https://biomamba.xiyoucloud.net/</span></span></section><section><span leaf=""><span textstyle="">欢迎联系客服微信[</span><span textstyle="">Biomamba_zhushou</span><span textstyle="">]获取帮助</span></span></section><section><span leaf=""><br></span></section><h2><strong><span><span leaf="">1. 加载包与数据</span></span></strong><strong><span><span leaf=""><br></span></span></strong></h2><pre><code><span><span leaf=""># 加载包</span></span><span leaf=""><br></span><span><span><span leaf="">library</span></span><span leaf="">(Seurat)</span></span></code></pre><pre><code><span leaf="">## Loading required package: SeuratObject</span></code></pre><pre><code><span leaf="">## Loading required package: sp</span></code></pre><pre><code><span leaf="">## 'SeuratObject' was built with package 'Matrix' 1.7.1 but the current</span><span leaf=""><br></span><span leaf="">## version is 1.7.2; it is recomended that you reinstall 'SeuratObject' as</span><span leaf=""><br></span><span leaf="">## the ABI for 'Matrix' may have changed</span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">## Attaching package: 'SeuratObject'</span></code></pre><pre><code><span leaf="">## The following objects are masked from 'package:base':</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">##     intersect, t</span></code></pre><pre><code><span><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span></span><span leaf=""><br></span><span><span><span leaf="">if</span></span><span leaf="">(</span><span><span leaf="">!</span></span><span><span leaf="">require</span></span><span leaf="">(MOFA2))BiocManager</span><span><span leaf="">::</span></span><span><span leaf="">install</span></span><span leaf="">(</span><span><span leaf="">'MOFA2'</span></span><span leaf="">)</span><span><span leaf=""># MOFA是可以通过bioconda下载安装的</span></span></span></code></pre><pre><code><span leaf="">## Loading required package: MOFA2</span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">## Attaching package: 'MOFA2'</span></code></pre><pre><code><span leaf="">## The following object is masked from 'package:stats':</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">##     predict</span></code></pre><pre><code><span><span leaf=""># 通过R调用的话还是需要配置一下python环境：</span></span><span leaf=""><br></span><span><span leaf=""># 终端中运行：</span></span><span leaf=""><br></span><span><span leaf="">sudo apt</span><span><span leaf="">-</span></span><span leaf="">get install </span><span><span leaf="">-</span></span><span leaf="">y python3</span><span><span leaf="">-</span></span><span leaf="">venv python3</span><span><span leaf="">-</span></span><span leaf="">pip python3</span><span><span leaf="">-</span></span><span leaf="">dev</span></span><span leaf=""><br></span><span><span leaf="">pip install scikit</span><span><span leaf="">-</span></span><span leaf="">learn</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 回到R:</span></span><span leaf=""><br></span><span><span><span leaf="">if</span></span><span leaf="">(</span><span><span leaf="">!</span></span><span><span leaf="">require</span></span><span leaf="">(reticulate))</span><span><span leaf="">install.packages</span></span><span leaf="">(</span><span><span leaf="">'reticulate'</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">reticulate</span><span><span leaf="">::</span></span><span><span leaf="">py_install</span></span><span leaf="">(</span><span><span leaf="">'scikit-learn'</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf=""># 需要安装2.7.0的稳定版，否则可能会遇到pands的数据转换报错</span></span><span leaf=""><br></span><span><span><span leaf="">py_run_string</span></span><span leaf="">(</span><span><span leaf="">"pip.main(['install', 'mofapy2==0.7.0'])"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf=""># 如果你需要调用GPU，则需要cupy-cuda</span></span><span leaf=""><br></span><span><span><span leaf="">py_install</span></span><span leaf="">(</span><span><span leaf="">"cupy-cuda12x"</span></span><span leaf="">, </span><span><span leaf="">pip =</span></span><span><span leaf="">TRUE</span></span></span></code></pre><p><span leaf="">作者提供的是一个矩阵已经经过</span><code><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247519711&amp;idx=1&amp;sn=d25d4f5daf609bda8367f16db676ecf3&amp;payreadticket=HNruwbUd7-KXQlKcd3fDsqEm6Ytgtkv2n567ad2lmBMQC3gRuheqtwbXfRX6tlMbyNeI64w&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">Seurat</span></a></span></code><span leaf="">标准化后的对象</span></p><pre><code><span><span leaf=""># 直接在线读取</span></span><span leaf=""><br></span><span><span><span leaf="">load</span></span><span leaf="">(</span><span><span leaf="">url</span></span><span leaf="">(</span><span><span leaf="">"ftp://ftp.ebi.ac.uk/pub/databases/mofa/scrna_gastrulation/gastrulation10x_seurat.RData"</span></span><span leaf="">))</span></span></code></pre><pre><code><span><span leaf=""># 如果你读取失败了，我们也给你准备好了本地文件：</span></span><span leaf=""><br></span><span><span><span leaf="">load</span></span><span leaf="">(</span><span><span leaf="">'./gastrulation10x_seurat.RData'</span></span><span leaf="">)</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># MOFA2的演示数据还停留在V3版本：</span></span><span leaf=""><br></span><span><span leaf="">seurat</span><span><span leaf="">@</span></span><span leaf="">version</span></span></code></pre><pre><code><span leaf="">## [1] '3.0.1'</span></code></pre><pre><code><span><span leaf=""># 可以更新一下看看数据结构：</span></span><span leaf=""><br></span><span><span leaf="">seurat </span><span><span leaf="">&lt;-</span></span><span><span leaf="">UpdateSeuratObject</span></span><span leaf="">(seurat)</span></span></code></pre><pre><code><span leaf="">## Validating object structure</span></code></pre><pre><code><span leaf="">## Updating object slots</span></code></pre><pre><code><span leaf="">## Ensuring keys are in the proper structure</span></code></pre><pre><code><span leaf="">## Warning: Assay RNA changing from Assay to Assay</span></code></pre><pre><code><span leaf="">## Ensuring keys are in the proper structure</span></code></pre><pre><code><span leaf="">## Ensuring feature names don't have underscores or pipes</span></code></pre><pre><code><span leaf="">## Updating slots in RNA</span></code></pre><pre><code><span leaf="">## Setting assay used for NormalizeData.RNA to RNA</span></code></pre><pre><code><span leaf="">## Setting assay used for FindVariableFeatures.RNA to RNA</span></code></pre><pre><code><span leaf="">## Validating object structure for Assay 'RNA'</span></code></pre><pre><code><span leaf="">## Object representation is consistent with the most current Seurat version</span></code></pre><pre><code><span><span leaf="">seurat</span><span><span leaf=""># MOFA2是支持Seurat V5的</span></span></span></code></pre><pre><section><code><span leaf="">## An object of class Seurat </span><span leaf=""><br></span><span leaf="">## 5000 features across 16152 samples within 1 assay </span><span leaf=""><br></span><span leaf="">## Active assay: RNA (5000 features, 5000 variable features)</span><span leaf=""><br></span><span leaf="">##  2 layers present: counts, data</span></code></section></pre><section><span leaf="">定义各细胞颜色类型</span></section><pre><section><code><span><span leaf="">colors </span><span><span leaf="">&lt;-</span></span><span><span leaf="">c</span></span><span leaf="">(</span></span><span leaf=""><br></span><span><span><span leaf="">"Epiblast"</span></span><span><span leaf="">=</span></span><span><span leaf="">"grey70"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">"Primitive Streak"</span></span><span><span leaf="">=</span></span><span><span leaf="">"sandybrown"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">"Mesoderm"</span></span><span><span leaf="">=</span></span><span><span leaf="">"violetred"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">"ExE endoderm"</span></span><span><span leaf="">=</span></span><span><span leaf="">"#548B54"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">"ExE ectoderm"</span></span><span><span leaf="">=</span></span><span><span leaf="">"black"</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></section></pre><section><span><span leaf=""><br></span></span></section><p><span><strong><span leaf="">2. 创建MOFA对象</span></strong></span></p><section><span><span leaf="">根据胚胎和来源阶段对细胞进行分组</span></span></section><pre><code><span><span leaf="">seurat</span><span><span leaf="">@</span></span><span leaf="">meta.data</span><span><span leaf="">$</span></span><span leaf="">stage_sample </span><span><span leaf="">&lt;-</span></span><span><span leaf="">paste</span></span><span leaf="">(seurat</span><span><span leaf="">@</span></span><span leaf="">meta.data</span><span><span leaf="">$</span></span><span leaf="">stage,seurat</span><span><span leaf="">@</span></span><span leaf="">meta.data</span><span><span leaf="">$</span></span><span leaf="">sample, </span><span><span leaf="">sep=</span></span><span><span leaf="">"_"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">unique</span></span><span leaf="">(seurat</span><span><span leaf="">@</span></span><span leaf="">meta.data</span><span><span leaf="">$</span></span><span leaf="">stage_sample)</span></span></code></pre><pre><code><span leaf="">## [1] "E6.5_1"   "E6.5_5"   "E7.0_10"  "E7.0_14"  "E7.25_26" "E7.25_27"</span></code></pre><pre><code><span><span leaf=""># seurat V3对象可以一键生成MOFA2对象</span></span><span leaf=""><br></span><span><span leaf="">MOFAobject </span><span><span leaf="">&lt;-</span></span><span><span leaf="">create_mofa</span></span><span leaf="">(seurat, </span><span><span leaf="">groups =</span></span><span><span leaf="">"stage_sample"</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## Creating MOFA object from a Seurat object...</span></code></pre><pre><code><span leaf="">## No assays specified, using all assays by default: RNA</span></code></pre><pre><code><span leaf="">## No features specified, using variable features from the Seurat object...</span></code></pre><p><span><span leaf="">按照默认分组信息，MOFA可以提供一些基本数据概况，例如RNA变量数、每个分组下的细胞数：</span></span></p><pre><code><span><span><span leaf="">plot_data_overview</span></span><span leaf="">(MOFAobject)</span></span></code></pre><pre><code><span leaf="">## Warning in plot_data_overview(MOFAobject): This function is inefficient with</span><span leaf=""><br></span><span leaf="">## large number of cells...</span></code></pre><section><span><strong><span leaf=""><img data-aistatus="1" data-imgfileid="100050845" data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicTkUiaLB14LPlpSkPNb1MwN2pdKwxpQDhDKfOtNFwPHLKOPQk61vSoSw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicTkUiaLB14LPlpSkPNb1MwN2pdKwxpQDhDKfOtNFwPHLKOPQk61vSoSw/640?wx_fmt=png&amp;from=appmsg"></span></strong></span></section><h2><strong><span><span leaf="">3. MOFA的选项参数</span></span></strong></h2><pre><code><span><span leaf=""># 默认数据选项参数：</span></span><span leaf=""><br></span><span><span leaf="">data_opts </span><span><span leaf="">&lt;-</span></span><span><span leaf="">get_default_data_options</span></span><span leaf="">(MOFAobject)</span></span><span leaf=""><br></span><span><span leaf="">data_opts</span></span></code></pre><pre><code><span leaf="">## $scale_views</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $scale_groups</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $center_groups</span><span leaf=""><br></span><span leaf="">## [1] TRUE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $use_float32</span><span leaf=""><br></span><span leaf="">## [1] TRUE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $groups</span><span leaf=""><br></span><span leaf="">## [1] "E6.5_1"   "E6.5_5"   "E7.0_10"  "E7.0_14"  "E7.25_26" "E7.25_27"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $views</span><span leaf=""><br></span><span leaf="">## [1] "RNA"</span></code></pre><p><span leaf="">scale_views: 逻辑值，是否对同一个变量进行scale</span></p><p><span leaf="">scale_groups: 逻辑值，是否对各组进行scale，确保各组的方差处于同一水平。</span></p><p><span leaf="">use_float32: 逻辑值，规定浮点数True以</span><code><span leaf="">float32</span></code><span leaf="">参与计算，选择</span><code><span leaf="">FALSE</span></code><span leaf="">则是用</span><code><span leaf="">float64</span></code></p><p><span><span leaf="">重点检查groups中是否包含你的分组信息，views中是否包含你的矩阵。</span></span></p><pre><code><span><span leaf=""># 默认模型选项参数</span></span><span leaf=""><br></span><span><span leaf="">model_opts </span><span><span leaf="">&lt;-</span></span><span><span leaf="">get_default_model_options</span></span><span leaf="">(MOFAobject)</span></span><span leaf=""><br></span><span><span leaf="">model_opts</span></span></code></pre><pre><code><span leaf="">## $likelihoods</span><span leaf=""><br></span><span leaf="">##        RNA </span><span leaf=""><br></span><span leaf="">## "gaussian" </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $num_factors</span><span leaf=""><br></span><span leaf="">## [1] 25</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $spikeslab_factors</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $spikeslab_weights</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $ard_factors</span><span leaf=""><br></span><span leaf="">## [1] TRUE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $ard_weights</span><span leaf=""><br></span><span leaf="">## [1] TRUE</span></code></pre><p><span leaf="">每个值的意义：</span><span leaf=""><br></span><span leaf="">likelihoods：规定似然性特征类型得字符串：连续性数值选择</span><code><span leaf="">gaussian</span></code><span leaf="">，二分类数值选择</span><code><span leaf="">bernoulli</span></code><span leaf="">、原始</span><code><span leaf="">count</span></code><span leaf="">数据选择</span><code><span leaf="">poisson</span></code><span leaf=""><br></span><span leaf="">num_factors：因子的默认数量</span><span leaf=""><br></span><span leaf="">spikeslab_factors：输入一个布尔值，是否采用</span><code><span leaf="">spike and slab sparsity</span></code><span leaf="">法处理因子 spikeslab_weights：输入一个布尔值，是否采用</span><code><span leaf="">spike and slab sparsity</span></code><span leaf="">法处理权重 ard_factors：输入一个布尔值，是否采用</span><code><span leaf="">ARD sparsity</span></code><span leaf="">处理因子</span><span leaf=""><br></span><span leaf="">ard_weights: 输入一个布尔值，是否采用</span><code><span leaf="">ARD sparsity</span></code><span leaf="">处理权重</span></p><pre><code><span><span leaf=""># 训练选项参数</span></span><span leaf=""><br></span><span><span leaf="">train_opts </span><span><span leaf="">&lt;-</span></span><span><span leaf="">get_default_training_options</span></span><span leaf="">(MOFAobject)</span></span><span leaf=""><br></span><span><span leaf="">train_opts</span></span></code></pre><pre><code><span leaf="">## $maxiter</span><span leaf=""><br></span><span leaf="">## [1] 1000</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $convergence_mode</span><span leaf=""><br></span><span leaf="">## [1] "fast"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $drop_factor_threshold</span><span leaf=""><br></span><span leaf="">## [1] -1</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $verbose</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $startELBO</span><span leaf=""><br></span><span leaf="">## [1] 1</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $freqELBO</span><span leaf=""><br></span><span leaf="">## [1] 5</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $stochastic</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $gpu_mode</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $gpu_device</span><span leaf=""><br></span><span leaf="">## NULL</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $seed</span><span leaf=""><br></span><span leaf="">## [1] 42</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $outfile</span><span leaf=""><br></span><span leaf="">## NULL</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $weight_views</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $save_interrupted</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span></code></pre><section><span leaf="">maxiter: 表示最大迭代次数的数值。默认值为 1000。收敛性通过 ELBO 统计量进行评估。</span></section><section><span leaf="">drop_factor_threshold: 该数值表示在解释方差的比例达到该值时，应将某个因素视为不活跃因素并从模型中剔除。例如，值为 0.01 表示在每个视图中解释方差少于 1% 的因素将被剔除。默认值为 -1（不剔除因素），自定义时在(0,1)定义域里选择即可，理论上数值越大，丢弃的因素越多，计算速度越快。</span></section><section><span leaf="">convergence_mode: 表示收敛标准的特征值，分为”fast”,“medium”,“slow”,分别为“快速”、“中等”或“缓慢”，分别对应于 0.0005%、0.00005%或0.000005%的deltaELBO变化量。</span></section><section><span leaf="">verbose: 逻辑值，是否提供进度条</span></section><section><span leaf="">startELBO: 表示计算ELBO的首个迭代次数的整数（默认值为 1）</span></section><section><span leaf="">freqELBO: 表示计算ELBO的首个迭代次数的整数（默认值为 1）</span></section><section><span leaf="">stochastic: 逻辑性地指示是否使用随机变分推理（仅适用于非常大的数据集，默认值为“FALSE”）</span></section><section><span leaf="">gpu_mode: 逻辑值，是否使用GPU加速</span></section><section><span leaf="">gpu_device: 整数，指定使用的GPU编号</span></section><section><span leaf="">seed: 随机数，默认是42.</span></section><section><span leaf="">以上各类型选项的默认值都可以通过</span><code><span leaf="">对象$选项名称</span></code><span leaf="">的形式来修改，例如：</span></section><pre><code><span><span leaf="">train_opts</span><span><span leaf="">$</span></span><span leaf="">convergence_mode </span><span><span leaf="">&lt;-</span></span><span><span leaf="">"fast"</span></span><span><span leaf=""># 收敛模型</span></span></span><span leaf=""><br></span><span><span leaf="">train_opts</span><span><span leaf="">$</span></span><span leaf="">seed </span><span><span leaf="">&lt;-</span></span><span><span leaf="">42</span></span><span><span leaf=""># 随机数</span></span></span></code></pre><section><span leaf=""><br></span></section><section><span><strong><span leaf="">4. 模型训练</span><span leaf=""><br></span></strong></span></section><section><span><strong><span leaf="">4.1 预处理</span></strong></span></section><pre><code><span><span leaf=""># 查看当前训练选项的参数值：</span></span><span leaf=""><br></span><span><span leaf="">train_opts</span></span></code></pre><pre><code><span leaf="">## $maxiter</span><span leaf=""><br></span><span leaf="">## [1] 1000</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $convergence_mode</span><span leaf=""><br></span><span leaf="">## [1] "fast"</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $drop_factor_threshold</span><span leaf=""><br></span><span leaf="">## [1] -1</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $verbose</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $startELBO</span><span leaf=""><br></span><span leaf="">## [1] 1</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $freqELBO</span><span leaf=""><br></span><span leaf="">## [1] 5</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $stochastic</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $gpu_mode</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $gpu_device</span><span leaf=""><br></span><span leaf="">## NULL</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $seed</span><span leaf=""><br></span><span leaf="">## [1] 42</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $outfile</span><span leaf=""><br></span><span leaf="">## NULL</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $weight_views</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $save_interrupted</span><span leaf=""><br></span><span leaf="">## [1] FALSE</span></code></pre><pre><code><span><span leaf=""># 预处理：</span></span><span leaf=""><br></span><span><span leaf="">MOFAobject </span><span><span leaf="">&lt;-</span></span><span><span leaf="">prepare_mofa</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">data_options =</span></span><span leaf=""> data_opts,</span></span><span leaf=""><br></span><span><span><span leaf="">model_options =</span></span><span leaf=""> model_opts,</span></span><span leaf=""><br></span><span><span><span leaf="">training_options =</span></span><span leaf=""> train_opts</span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">## # Multi-group mode requested.</span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">## This is an advanced option, if this is the first time that you are running MOFA, we suggest that you try do some exploration first without specifying groups. Two important remarks:</span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">##  - The aim of the multi-group framework is to identify the sources of variability *within* the groups. If your aim is to find a factor that 'separates' the groups, you DO NOT want to use the multi-group framework. Please see the FAQ on the MOFA2 webpage.</span></code></pre><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">##  - It is important to account for the group effect before selecting highly variable features (HVFs). We suggest that either you calculate HVFs per group and then take the union, or regress out the group effect before HVF selection</span></code></pre><pre><code><span leaf="">## Checking data options...</span></code></pre><pre><code><span leaf="">## Checking training options...</span></code></pre><pre><code><span leaf="">## Checking model options...</span></code></pre><section><strong><span><span leaf="">4.2 </span><span><span leaf="">训练MOFA模型</span></span></span></strong></section><pre><code><span><span><span leaf="">library</span></span><span leaf="">(reticulate)</span></span><span leaf=""><br></span><span><span leaf="">mofapy2 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">import</span></span><span leaf="">(</span><span><span leaf="">"mofapy2"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">MOFAobject</span><span><span leaf="">@</span></span><span leaf="">data_options</span><span><span leaf="">$</span></span><span leaf="">use_float32 </span><span><span leaf="">&lt;-</span></span><span><span leaf="">TRUE</span></span></span><span leaf=""><br></span><span><span leaf="">MOFAobject</span><span><span leaf="">@</span></span><span leaf="">training_options</span><span><span leaf="">$</span></span><span leaf="">gpu_mode </span><span><span leaf="">&lt;-</span></span><span><span leaf="">TRUE</span></span></span><span leaf=""><br></span><span><span leaf="">MOFAobject</span><span><span leaf="">@</span></span><span leaf="">model_options</span><span><span leaf="">$</span></span><span leaf="">num_factors </span><span><span leaf="">&lt;-</span></span><span><span leaf="">5</span></span></span><span leaf=""><br></span><span><span><span leaf=""># 实际上一行就可以搞定：  </span></span></span><span leaf=""><br></span><span><span leaf="">MOFAobject </span><span><span leaf="">&lt;-</span></span><span><span leaf="">run_mofa</span></span><span leaf="">(MOFAobject, </span><span><span leaf="">outfile =</span></span><span><span leaf="">'./mofa_model.hdf5'</span></span><span leaf="">,</span><span><span leaf="">use_basilisk =</span></span><span><span leaf="">FALSE</span></span><span leaf="">)</span></span></code></pre><p><span leaf="">你的训练结果未必与作者相同，那么你可以选择读取作者训练好的：</span></p><pre><code><span><span leaf=""># 从网络读取：</span></span><span leaf=""><br></span><span><span><span leaf=""># load(url("ftp://ftp.ebi.ac.uk/pub/databases/mofa/scrna_gastrulation/gastrulation10x_mofa.RData"))</span></span></span><span leaf=""><br></span><span><span><span leaf=""># 本地读取</span></span></span><span leaf=""><br></span><span><span><span leaf="">load</span></span><span leaf="">(</span><span><span leaf="">'gastrulation10x_mofa.RData'</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">MOFAobject </span><span><span leaf="">&lt;-</span></span><span leaf=""> model</span></span></code></pre><p><span leaf="">训练后的对象包含以下信息：</span></p><pre><code><span><span><span leaf="">slotNames</span></span><span leaf="">(MOFAobject)</span></span></code></pre><pre><code><span leaf="">##  [1] "data"               "covariates"         "covariates_warped" </span><span leaf=""><br></span><span leaf="">##  [4] "intercepts"         "imputed_data"       "interpolated_Z"    </span><span leaf=""><br></span><span leaf="">##  [7] "samples_metadata"   "features_metadata"  "expectations"      </span><span leaf=""><br></span><span leaf="">## [10] "training_stats"     "data_options"       "model_options"     </span><span leaf=""><br></span><span leaf="">## [13] "training_options"   "stochastic_options" "mefisto_options"   </span><span leaf=""><br></span><span leaf="">## [16] "dimensions"         "on_disk"            "dim_red"           </span><span leaf=""><br></span><span leaf="">## [19] "cache"              "status"</span></code></pre><p><span leaf="">dimensions包含模型的维度（K 代表因子，M 代表视图，G 代表组，N 代表样本（每组），D 表示特征（每个视图））：</span></p><pre><code><span><span leaf="">MOFAobject</span><span><span leaf="">@</span></span><span leaf="">dimensions</span></span></code></pre><pre><code><span leaf="">## $M</span><span leaf=""><br></span><span leaf="">## [1] 1</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $G</span><span leaf=""><br></span><span leaf="">## [1] 6</span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $N</span><span leaf=""><br></span><span leaf="">##  E6.5 (1)  E6.5 (2)  E7.0 (1)  E7.0 (2) E7.25 (1) E7.25 (2) </span><span leaf=""><br></span><span leaf="">##       337      1106      2152      1135      5537      5885 </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $D</span><span leaf=""><br></span><span leaf="">##  RNA </span><span leaf=""><br></span><span leaf="">## 5000 </span><span leaf=""><br></span><span leaf="">## </span><span leaf=""><br></span><span leaf="">## $K</span><span leaf=""><br></span><span leaf="">## [1] 10</span></code></pre><p><span leaf="">data包含居中（并可选缩放）的输入数据矩阵。它是一个嵌套矩阵列表，第一个索引指向视图，第二个索引指向群。在这种情况下，我们有一个视角（RNA）和六个基团</span></p><pre><code><span><span><span leaf="">names</span></span><span leaf="">(MOFAobject</span><span><span leaf="">@</span></span><span leaf="">data)</span></span></code></pre><pre><code><span leaf="">## [1] "RNA"</span></code></pre><p><span leaf="">samples_metadata包含我之前添加到MOFA对象中的单元元数据。列队如下：</span></p><p><span leaf="">阶段：发育阶段。 谱系：单元类型注释。 组：用于MOFA的分组。在这种情况下，每个胚胎对应一个独立的群体。</span></p><pre><code><span><span><span leaf="">head</span></span><span leaf="">(MOFAobject</span><span><span leaf="">@</span></span><span leaf="">samples_metadata)</span></span></code></pre><pre><code><span leaf="">##    sample  stage          lineage    group</span><span leaf=""><br></span><span leaf="">##    &lt;char&gt; &lt;char&gt;           &lt;char&gt;   &lt;fctr&gt;</span><span leaf=""><br></span><span leaf="">## 1: cell_1   E6.5         Epiblast E6.5 (1)</span><span leaf=""><br></span><span leaf="">## 2: cell_2   E6.5 Primitive Streak E6.5 (1)</span><span leaf=""><br></span><span leaf="">## 3: cell_5   E6.5     ExE ectoderm E6.5 (1)</span><span leaf=""><br></span><span leaf="">## 4: cell_6   E6.5         Epiblast E6.5 (1)</span><span leaf=""><br></span><span leaf="">## 5: cell_8   E6.5         Epiblast E6.5 (1)</span><span leaf=""><br></span><span leaf="">## 6: cell_9   E6.5         Epiblast E6.5 (1)</span></code></pre><p><strong><span><span leaf="">5. 因子差异解释</span></span></strong></p><h3><strong><span><span leaf="">5.1 各组各因素解释的图方差</span></span></strong></h3><section><span><span leaf="">量化各因子在不同群体和视图间解释的方差，可能是MOFA+生成的最重要图表。它将复杂异构数据集的（潜在）信号汇总为单一图。</span></span></section><pre><code><span><span><span leaf="">plot_variance_explained</span></span><span leaf="">(MOFAobject, </span><span><span leaf="">x=</span></span><span><span leaf="">"group"</span></span><span leaf="">, </span><span><span leaf="">y=</span></span><span><span leaf="">"factor"</span></span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicNfccZm5fa7mhwfNUxyhDiacjg9ibdQhaibzbr1ubSZ1cicnI40zpbjvT3w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050846" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicNfccZm5fa7mhwfNUxyhDiacjg9ibdQhaibzbr1ubSZ1cicnI40zpbjvT3w/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">可以看出因子1和因子2解释了多组间的大量差异。相比之下，因子4的活性从E6.5提升到E7.5，表明它捕捉了E6.5出现的变异源。</span></p><p><span leaf="">我们也可以通过加入参数 绘制每组（包含所有因素）解释的总方差。值得注意的是，默认因子数是15个，但只有10个因子足以捕捉每个胚胎35%至55%的转录方差</span></p><p><span leaf="">plot_total = TRUE可以展示各组解释的总方差：</span></p><pre><code><span><span><span leaf="">plot_variance_explained</span></span><span leaf="">(MOFAobject, </span><span><span leaf="">x=</span></span><span><span leaf="">"group"</span></span><span leaf="">, </span><span><span leaf="">y=</span></span><span><span leaf="">"factor"</span></span><span leaf="">,</span><span><span leaf="">plot_total =</span></span><span><span leaf="">TRUE</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## [[1]]</span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicNfccZm5fa7mhwfNUxyhDiacjg9ibdQhaibzbr1ubSZ1cicnI40zpbjvT3w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050847" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicNfccZm5fa7mhwfNUxyhDiacjg9ibdQhaibzbr1ubSZ1cicnI40zpbjvT3w/640?wx_fmt=png&amp;from=appmsg"></section><pre><code><span leaf="">## </span><span leaf=""><br></span><span leaf="">## [[2]]</span></code></pre><h3><strong><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicCY7a8QYLn4nTytL0NvQNibcLOkpiaCC2TicGdIReiapb6gKkogNhqAhbWA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050848" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicCY7a8QYLn4nTytL0NvQNibcLOkpiaCC2TicGdIReiapb6gKkogNhqAhbWA/640?wx_fmt=png&amp;from=appmsg"></span></span></strong></h3><h3><strong><span><span leaf="">5.2 针对各个基因的差异解释</span></span></strong></h3><p><span leaf="">我们还可以通过MOFA因子解释单个特征的方差进行检验。高R2 这意味着MOFA因子捕捉了该特征的大部分变异，而值较小则表示模型无法解释该特征的变异（即视为噪声）：</span></p><p><span leaf="">各组中所有因子解释的方差：</span></p><pre><code><span><span leaf="">features </span><span><span leaf="">&lt;-</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"Rbp4"</span></span><span leaf="">,</span><span><span leaf="">"Ttr"</span></span><span leaf="">,</span><span><span leaf="">"Spink1"</span></span><span leaf="">,</span><span><span leaf="">"Mesp1"</span></span><span leaf="">,</span><span><span leaf="">"E130311K13Rik"</span></span><span leaf="">,</span><span><span leaf="">"Hey1"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">plot_variance_explained_per_feature</span></span><span leaf="">(</span></span><span leaf=""><br></span><span><span leaf="">  MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">features =</span></span><span leaf=""> features</span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><h3><strong><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicxROVd2e0WXaoXdDgH3YvY9Yg0G3Z6gXz99USlzzAXscWZiajNiaEPEyw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050849" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicxROVd2e0WXaoXdDgH3YvY9Yg0G3Z6gXz99USlzzAXscWZiajNiaEPEyw/640?wx_fmt=png&amp;from=appmsg"></span></span></strong></h3><h3><strong><span></span></strong><span><span leaf="">显然</span></span><code><span leaf="">Hey1</span></code><span><span leaf="">与</span></span><code><span leaf="">E130311K13Rik</span></code><span><span leaf="">基因就没有展现出各个发育时期中的方差贡献度</span></span><strong><span><span leaf=""><br></span></span></strong></h3><h3><strong><span><span leaf="">6. 让因子特征回归基因</span></span></strong></h3><section><span><span><span leaf="">说白了，花里胡哨的因子分析没用，还是需要回归到基因层面，找到每个因子、每个时期的特征基因,这个过程中，也可以生产出一些有意思的图。</span></span></span></section><h3><strong><span><span leaf="">6.1 因子值的可视化</span></span></strong></h3><p><span leaf="">每个因子将单元格定位于一维轴上，该轴中心为零。符号不同样本表示表现型相反，绝对值越高表示表型越强。例如，如果k第因子反映了与细胞周期相关的变异性，我们可以预期有丝分裂中的细胞位于因子的一端（无论符号如何，只有相对位置才重要）。相比之下，处于G1期的细胞通常处于因子的另一端。具有中间表型或无明确表型（即无细胞周期基因谱）的细胞，通常位于零附近。我们绘制因子1的数值，并按谱系分配给单元格颜色。显然，这一因素反映了ExE内胚层的出现。</span></p><pre><code><span><span><span leaf="">plot_factor</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span><span><span leaf=""># lineage is a column in MOFAobject@samples.metadata</span></span></span><span leaf=""><br></span><span><span leaf="">) </span><span><span leaf="">+</span></span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWic0m5nCYxuibalKtZTGFveqZTSYvbF127reiaibTibgraODyW2yeYdyvAH5w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050850" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWic0m5nCYxuibalKtZTGFveqZTSYvbF127reiaibTibgraODyW2yeYdyvAH5w/640?wx_fmt=png&amp;from=appmsg"></section><p><strong><span><span leaf=""><br></span></span></strong></p><p><span><span leaf="">另一种可视化方式：</span></span></p><pre><code><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span><span leaf="">plot_factor</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">dodge =</span></span><span leaf=""> T,           </span><span><span leaf=""># dodge points with different colors</span></span></span><span leaf=""><br></span><span><span><span leaf="">legend =</span></span><span leaf=""> F,          </span><span><span leaf=""># remove legend</span></span></span><span leaf=""><br></span><span><span><span leaf="">add_violin =</span></span><span leaf=""> T      </span><span><span leaf=""># add violin plots</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span leaf=""> p </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors) </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span leaf="">p</span></span></code></pre><p><span leaf="">你也可以通过某种手动定义的分组结构来更改x轴上的默认分组。例如，样本元数据中的一列</span></p><pre><code><span><span><span leaf="">plot_factor</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">group_by =</span></span><span><span leaf="">"stage"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">legend =</span></span><span leaf=""> F</span></span><span leaf=""><br></span><span><span leaf="">) </span><span><span leaf="">+</span></span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors)</span></span></code></pre><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicypTQVYx8OB2aNIa2cndSISsW81ichgWzFdAQenW2QOZsib8a3x3UIcxQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050852" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicypTQVYx8OB2aNIa2cndSISsW81ichgWzFdAQenW2QOZsib8a3x3UIcxQ/640?wx_fmt=png&amp;from=appmsg"></span><strong><span></span></strong></p><p><span><span><span leaf="">因子组合可绘制为：plot_factors</span></span></span></p><pre><code><span><span><span leaf="">plot_factors</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">factors =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">4</span></span><span leaf="">),</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span></span><span leaf=""><br></span><span><span leaf="">) </span><span><span leaf="">+</span></span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicExVOaO2k0HVRmE4OibXiaTFn1ib8H0FvwWRfFZGfiaJo2LRwlqD53AibSlA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050853" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicExVOaO2k0HVRmE4OibXiaTFn1ib8H0FvwWRfFZGfiaJo2LRwlqD53AibSlA/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span><span leaf="">总之，这些图无非是ggplot2产生的，感兴趣的同学可以参考我们的教程：</span></span><span leaf="">R语言入门课</span></span></p><h3><span><strong><span leaf="">6.2 权重的可视化</span></strong></span></h3><p><span><span leaf="">权重为每个基因在每个因子上的评分提供了支持。与该因子无关联的基因通常值接近零，而与该因子强烈关联的基因则期望拥有较大的绝对值。权重符号表示效应方向：正权重表示该特征在因子为正的单元格中更活跃，反之亦然。让我们绘制因子1的权重分布图。</span></span></p><pre><code><span><span><span leaf="">plot_weights</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">nfeatures =</span></span><span><span leaf="">10</span></span><span leaf="">,     </span><span><span leaf=""># 标记权重最高的10个基因</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale =</span></span><span leaf=""> T           </span><span><span leaf=""># 将权重缩放到-1至1</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWichkMXroUurVqeKSP8eucXhus8vLm1Q28K3xiaibcy5QzDnX5yTDAtYXSQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050854" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWichkMXroUurVqeKSP8eucXhus8vLm1Q28K3xiaibcy5QzDnX5yTDAtYXSQ/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span leaf="">如果你不关心效应的方向性，可以取权重的绝对值abs=TRUE。</span></span></p><pre><code><span><span><span leaf="">plot_weights</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">nfeatures =</span></span><span><span leaf="">10</span></span><span leaf="">,     </span><span><span leaf=""># 标记权重最高的10个基因</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale =</span></span><span leaf=""> T    ,       </span><span><span leaf=""># 将权重缩放到-1至1</span></span></span><span leaf=""><br></span><span><span><span leaf="">abs =</span></span><span leaf=""> T</span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicr0Cic0FlfD3L4HUlSbb0P8ibfbvLdHw4joflavbJeRSPgWJW3ySZ7gyw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050855" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicr0Cic0FlfD3L4HUlSbb0P8ibfbvLdHw4joflavbJeRSPgWJW3ySZ7gyw/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span leaf="">你也可以用</span></span><code><span leaf="">manul</span></code><span><span leaf="">认为指定一些感兴趣的基因进行可视化：</span></span></p><pre><code><span><span><span leaf="">plot_weights</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">nfeatures =</span></span><span><span leaf="">5</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">manual =</span></span><span><span leaf="">list</span></span><span leaf="">(</span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"Snai1"</span></span><span leaf="">,</span><span><span leaf="">"Mesp1"</span></span><span leaf="">,</span><span><span leaf="">"Phlda2"</span></span><span leaf="">), </span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"Rhox5"</span></span><span leaf="">,</span><span><span leaf="">"Elf5"</span></span><span leaf="">)),</span><span><span leaf=""># 这里的list对应下一个选项的颜色</span></span></span><span leaf=""><br></span><span><span><span leaf="">color_manual =</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"darkgreen"</span></span><span leaf="">,</span><span><span leaf="">"red"</span></span><span leaf="">),</span><span><span leaf=""># 这里的颜色对应上面的gene list</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale =</span></span><span leaf=""> T,</span></span><span leaf=""><br></span><span><span><span leaf="">abs =</span></span><span leaf=""> T</span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicficVmsL79m4tjibEYNlhxYchsnzJjbbMAmbptd7kcYHOZIoxN6ghkTlQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050856" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicficVmsL79m4tjibEYNlhxYchsnzJjbbMAmbptd7kcYHOZIoxN6ghkTlQ/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span leaf="">如果你不想要完整分布，只想看最高层权重，可以这样做：</span></span></p><pre><code><span><span><span leaf="">plot_top_weights</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">nfeatures =</span></span><span><span leaf="">10</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">scale =</span></span><span leaf=""> T, </span></span><span leaf=""><br></span><span><span><span leaf="">abs =</span></span><span leaf=""> T</span></span><span leaf=""><br></span><span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWickPNN5SCSZXdP7vh3VBCE2TLUIG6UBQjYnGQichRzeRkz0YbeFL0lC9Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050857" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWickPNN5SCSZXdP7vh3VBCE2TLUIG6UBQjYnGQichRzeRkz0YbeFL0lC9Q/640?wx_fmt=png&amp;from=appmsg"></section><h3><strong><span><span leaf="">6.3 由因子提供的基因表达模式可视化</span></span></strong></h3><p><span leaf="">按照上文的结果，因子1的负权重是ExE内胚层的标记基因。如果我们按mRNA对权重最大基因（Ttr、Apom）的分布绘制因子1的着色细胞：</span></p><pre><code><span><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span></span><span leaf=""><br></span><span><span leaf="">genes </span><span><span leaf="">&lt;-</span></span><span><span leaf="">c</span></span><span leaf="">(</span><span><span leaf="">"Ttr"</span></span><span leaf="">,</span><span><span leaf="">"Apom"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">for</span></span><span leaf=""> (i </span><span><span leaf="">in</span></span><span leaf=""> genes) {</span></span><span leaf=""><br></span><span><span leaf="">  p </span><span><span leaf="">&lt;-</span></span><span><span leaf="">plot_factor</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span leaf=""> i</span></span><span leaf=""><br></span><span><span leaf="">  ) </span><span><span leaf="">+</span></span><span><span leaf="">scale_colour_gradientn</span></span><span leaf="">(</span><span><span leaf="">colours =</span></span><span><span leaf="">terrain.colors</span></span><span leaf="">(</span><span><span leaf="">10</span></span><span leaf="">))</span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(p)</span></span><span leaf=""><br></span><span><span leaf="">}</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicZHSB95Bvcjd9CUx2DW5451YM3BM4PXrtkbzLHicmkry20xOvLanuF2A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050858" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicZHSB95Bvcjd9CUx2DW5451YM3BM4PXrtkbzLHicmkry20xOvLanuF2A/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicib17uT9AJPcdyaLCEmiarqeB6w9j2lzHSMJG8HQaIKhw6tdoRLnBHCkA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050859" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicib17uT9AJPcdyaLCEmiarqeB6w9j2lzHSMJG8HQaIKhw6tdoRLnBHCkA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">权重有助于了解哪些基因是驱动这些因素的主要基因。然而，为了了解因子与基因组特征的关联程度，我们可以生成因子值与mRNA表达的散点图，针对权重最高的基因：</span></p><p><span leaf="">正向权重的top基因：</span></p><pre><code><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span><span leaf="">plot_data_scatter</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">features =</span></span><span><span leaf="">6</span></span><span leaf="">,         </span><span><span leaf=""># 展示的基因数</span></span></span><span leaf=""><br></span><span><span><span leaf="">sign =</span></span><span><span leaf="">"positive"</span></span><span leaf="">,     </span><span><span leaf=""># top基因对应正向权重</span></span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span><span leaf="">,  </span><span><span leaf=""># 按照谱系来着色</span></span></span><span leaf=""><br></span><span><span><span leaf="">add_lm =</span></span><span leaf=""> T,          </span><span><span leaf=""># 添加线性回归</span></span></span><span leaf=""><br></span><span><span><span leaf="">lm_per_group =</span></span><span leaf=""> F, </span><span><span leaf=""># 是否对每个分组进行线性回归</span></span></span><span leaf=""><br></span><span><span><span leaf="">dot_size =</span></span><span><span leaf="">2</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span leaf=""> p </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors) </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span><span leaf="">theme</span></span><span leaf="">(</span><span><span leaf="">legend.position =</span></span><span><span leaf="">"none"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(p)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicov3f5wknSMlMYIsq3ZbZfxqxGDBGqwHFWkgNVq8ibQsGYicj3BzBldFw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050860" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicov3f5wknSMlMYIsq3ZbZfxqxGDBGqwHFWkgNVq8ibQsGYicj3BzBldFw/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span leaf="">负权重的top基因：</span></span></p><pre><code><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span><span leaf="">plot_data_scatter</span></span><span leaf="">(MOFAobject, </span></span><span leaf=""><br></span><span><span><span leaf="">view =</span></span><span><span leaf="">"RNA"</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">factor =</span></span><span><span leaf="">1</span></span><span leaf="">, </span></span><span leaf=""><br></span><span><span><span leaf="">features =</span></span><span><span leaf="">6</span></span><span leaf="">,         </span><span><span leaf=""># 展示的基因数</span></span></span><span leaf=""><br></span><span><span><span leaf="">sign =</span></span><span><span leaf="">"negative"</span></span><span leaf="">,     </span><span><span leaf=""># top基因对应负权重</span></span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span><span leaf="">,  </span><span><span leaf=""># 按照谱系来着色</span></span></span><span leaf=""><br></span><span><span><span leaf="">add_lm =</span></span><span leaf=""> T,          </span><span><span leaf=""># 是否对每个分组进行线性回归</span></span></span><span leaf=""><br></span><span><span><span leaf="">lm_per_group =</span></span><span leaf=""> F, </span></span><span leaf=""><br></span><span><span><span leaf="">dot_size =</span></span><span><span leaf="">2</span></span></span><span leaf=""><br></span><span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">p </span><span><span leaf="">&lt;-</span></span><span leaf=""> p </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors) </span><span><span leaf="">+</span></span></span><span leaf=""><br></span><span><span><span leaf="">theme</span></span><span leaf="">(</span><span><span leaf="">legend.position =</span></span><span><span leaf="">"none"</span></span><span leaf="">)</span></span><span leaf=""><br></span><span></span><span leaf=""><br></span><span><span><span leaf="">print</span></span><span leaf="">(p)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicVEezrWkkzcLzXshfwl7QhibuKBzicx6S2RshxnFYjp15AsgaXQmJ5Pdw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050861" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicVEezrWkkzcLzXshfwl7QhibuKBzicx6S2RshxnFYjp15AsgaXQmJ5Pdw/640?wx_fmt=png&amp;from=appmsg"></section><h3><strong><span><span leaf="">7. 基于MOFA因子的非线性降维</span></span></strong></h3><p><span><span leaf="">MOFA推断的潜空间可用作其他单胞算法的输入（相当于替代Seurat当中PCA的过程），用于学习非线性流形，如UMAP或t-SNE。这对于识别细胞群体和重建复杂的伪时间轨迹非常有用。</span></span></p><pre><code><span><span><span leaf="">set.seed</span></span><span leaf="">(</span><span><span leaf="">42</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span leaf="">MOFAobject </span><span><span leaf="">&lt;-</span></span><span><span leaf="">run_tsne</span></span><span leaf="">(MOFAobject)</span></span></code></pre><p><span leaf="">在该数据集中，我们看到MOFA因子的组合具有足够的信息来区分所有细胞类型：</span></p><pre><code><span><span><span leaf="">plot_dimred</span></span><span leaf="">(MOFAobject,</span></span><span leaf=""><br></span><span><span><span leaf="">method =</span></span><span><span leaf="">"TSNE"</span></span><span leaf="">,</span></span><span leaf=""><br></span><span><span><span leaf="">color_by =</span></span><span><span leaf="">"lineage"</span></span></span><span leaf=""><br></span><span><span leaf="">) </span><span><span leaf="">+</span></span><span><span leaf="">scale_fill_manual</span></span><span leaf="">(</span><span><span leaf="">values=</span></span><span leaf="">colors)</span></span></code></pre><pre><code><span leaf="">## Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as</span><span leaf=""><br></span><span leaf="">## of ggplot2 3.3.4.</span><span leaf=""><br></span><span leaf="">## ℹ The deprecated feature was likely used in the MOFA2 package.</span><span leaf=""><br></span><span leaf="">##   Please report the issue at &lt;https://github.com/bioFAM/MOFA2&gt;.</span><span leaf=""><br></span><span leaf="">## This warning is displayed once every 8 hours.</span><span leaf=""><br></span><span leaf="">## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span><span leaf=""><br></span><span leaf="">## generated.</span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicTNKuYhTowk9306OsPKFJxQy2YTu0iaUASMMBCI0OQvJ4yB8f8UTfV6g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100050862" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicTNKuYhTowk9306OsPKFJxQy2YTu0iaUASMMBCI0OQvJ4yB8f8UTfV6g/640?wx_fmt=png&amp;from=appmsg"></section><p><span><span leaf="">我们也可以通过Seurat中基于PCA的差异看看</span></span><code><span leaf="">MOFA</span></code><span><span leaf="">的效果有什么不同：</span></span></p><pre><code><span><span leaf="">scRNA </span><span><span leaf="">&lt;-</span></span><span><span leaf="">FindVariableFeatures</span></span><span leaf="">(</span><span><span leaf="">UpdateSeuratObject</span></span><span leaf="">(seurat), </span><span><span leaf="">selection.method =</span></span><span><span leaf="">"vst"</span></span><span leaf="">, </span><span><span leaf="">nfeatures =</span></span><span><span leaf="">2000</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## Validating object structure</span></code></pre><pre><code><span leaf="">## Updating object slots</span></code></pre><pre><code><span leaf="">## Ensuring keys are in the proper structure</span><span leaf=""><br></span><span leaf="">## Ensuring keys are in the proper structure</span></code></pre><pre><code><span leaf="">## Ensuring feature names don't have underscores or pipes</span></code></pre><pre><code><span leaf="">## Updating slots in RNA</span></code></pre><pre><code><span leaf="">## Setting assay used for NormalizeData.RNA to RNA</span></code></pre><pre><code><span leaf="">## Setting assay used for FindVariableFeatures.RNA to RNA</span></code></pre><pre><code><span leaf="">## Validating object structure for Assay 'RNA'</span></code></pre><pre><code><span leaf="">## Object representation is consistent with the most current Seurat version</span></code></pre><pre><code><span><span leaf="">scRNA </span><span><span leaf="">&lt;-</span></span><span><span leaf="">ScaleData</span></span><span leaf="">(scRNA, </span><span><span leaf="">features =</span></span><span><span leaf="">VariableFeatures</span></span><span leaf="">(scRNA))</span></span></code></pre><pre><code><span leaf="">## Centering and scaling data matrix</span></code></pre><pre><code><span><span leaf="">scRNA </span><span><span leaf="">&lt;-</span></span><span><span leaf="">RunPCA</span></span><span leaf="">(scRNA, </span><span><span leaf="">features =</span></span><span><span leaf="">VariableFeatures</span></span><span leaf="">(</span><span><span leaf="">object =</span></span><span leaf=""> scRNA))</span></span></code></pre><pre><code><span leaf="">## PC_ 1 </span><span leaf=""><br></span><span leaf="">## Positive:  Apoe, Cited1, Fth1, Ttr, Apom, Apoa1, Cotl1, Slc2a3, H19, Amn </span><span leaf=""><br></span><span leaf="">##     Ctsh, Rbp4, Folr1, Mt1, Ctsl, Ctsb, Lgmn, Gpx3, Ctsz, Atp6v0b </span><span leaf=""><br></span><span leaf="">##     Dab2, Cd63, Vamp8, Ftl1, Pla2g12b, 2610528J11Rik, Gpx4, Cyba, Npl, Spink1 </span><span leaf=""><br></span><span leaf="">## Negative:  Npm1, Ptma, Pkm, Tubb5, Snrpn, Pou5f1, Ldha, Ifitm2, Tuba1a, Pclaf </span><span leaf=""><br></span><span leaf="">##     Fabp5, Tuba1b, Ldhb, Hsp90ab1, Stmn1, Eno1, Pgk1, Eif4a1, Ccnd1, Pim2 </span><span leaf=""><br></span><span leaf="">##     Dnmt3b, Gapdh, Wfdc2, Igfbp2, Tdgf1, Sox4, Npm3, Socs2, Gsta4, Gng3 </span><span leaf=""><br></span><span leaf="">## PC_ 2 </span><span leaf=""><br></span><span leaf="">## Positive:  Gsto1, Elf5, Gm1673, Ddah1, Perp, Fabp3, Gjb3, Cldn3, Tex19.1, S100a6 </span><span leaf=""><br></span><span leaf="">##     Nup62cl, Htra1, Dppa4, Anxa5, Sfn, Arpc1b, Zfp42, Lgals1, Id2, Wnt6 </span><span leaf=""><br></span><span leaf="">##     Tfap2c, Bex3, Gm9, Nr0b1, Wnt7b, Rnf128, Gjb5, Upp1, Cdx2, Prss50 </span><span leaf=""><br></span><span leaf="">## Negative:  Bex4, Stmn1, Emb, Id3, Tceal8, Car4, Ddt, Pou5f1, Pclaf, Igfbp2 </span><span leaf=""><br></span><span leaf="">##     Ptma, Oat, Cd24a, Gpc3, Ifitm2, Ttr, Apoa1, Apom, Rasgrp2, Ctsh </span><span leaf=""><br></span><span leaf="">##     Rbp4, Ctsl, Dab2, Pcbd1, Tuba1a, Sgk1, Tdh, Tspan13, Amn, Sox4 </span><span leaf=""><br></span><span leaf="">## PC_ 3 </span><span leaf=""><br></span><span leaf="">## Positive:  Ifitm1, Mesp1, Fgf3, Phlda2, Rbms1, Ccnd2, Fn1, S100a10, Snai1, Ppic </span><span leaf=""><br></span><span leaf="">##     Lmo1, Bambi, Dll3, Hmga2, Tdgf1, Lhx1, Wnt2, Fam212a, Foxf1, Lefty2 </span><span leaf=""><br></span><span leaf="">##     Hand1, Gata6, Myl7, Pmp22, Msx2, Rspo3, Aplnr, Frzb, Cyp26a1, Mixl1 </span><span leaf=""><br></span><span leaf="">## Negative:  Dnmt3b, Utf1, Epcam, Pim2, Slc7a3, Wfdc2, Rbpms2, Rasgrp2, Bex1, Pou3f1 </span><span leaf=""><br></span><span leaf="">##     Mkrn1, Bex4, Pou5f1, Uchl1, Cldn6, Tuba1a, Fdps, Cldn7, Crip2, Trh </span><span leaf=""><br></span><span leaf="">##     Gng3, Igfbp2, Gsta4, Ldhb, Meg3, Fabp5, Tubb4b, Slc2a1, Cthrc1, Snrpn </span><span leaf=""><br></span><span leaf="">## PC_ 4 </span><span leaf=""><br></span><span leaf="">## Positive:  Phlda2, Lgals2, Car7, S100a1, Msx1, Fabp1, Aldob, Ddt, Igfbp4, Cyba </span><span leaf=""><br></span><span leaf="">##     Mesp1, Ifitm1, Apoa2, Gstm1, Tspan13, Aqp3, Fn1, Ccnd2, Fxyd2, Mpc2 </span><span leaf=""><br></span><span leaf="">##     2210011C24Rik, Apoc3, Psph, Apoc2, Tdh, Aprt, Tmem37, Slc2a2, Rbp4, AI413582 </span><span leaf=""><br></span><span leaf="">## Negative:  Sfrp1, Gpc4, Pga5, Sfrp5, Krt8, Srgn, Cer1, Ctsc, Akr1c13, Sox17 </span><span leaf=""><br></span><span leaf="">##     Prss12, Foxq1, Amot, Car2, Dapk2, Hhex, Cd59a, Dkk1, Cd24a, Shisa2 </span><span leaf=""><br></span><span leaf="">##     Fgf5, Hkdc1, Lrpap1, Cd8a, Hesx1, Igfbp2, Krt18, Cd55, Fam89a, Smim14 </span><span leaf=""><br></span><span leaf="">## PC_ 5 </span><span leaf=""><br></span><span leaf="">## Positive:  Car2, Sfrp1, Gpc4, Cd59a, Ctsc, Amot, Emb, Prss12, Rbp1, Car4 </span><span leaf=""><br></span><span leaf="">##     Sfrp5, Cer1, Dapk2, Akr1c13, Spink1, Hhex, Cfc1, Gsc, Cd24a, Laptm4b </span><span leaf=""><br></span><span leaf="">##     Afp, Lhx1, Gpc3, Mest, Cldn6, Krt18, S100a10, Cyp26a1, Npm3, Lhx1os </span><span leaf=""><br></span><span leaf="">## Negative:  Sparc, Hs3st1, Kdelr3, Serpinh1, Lamc1, Pth1r, Lama1, P4ha2, Srgn, Cryab </span><span leaf=""><br></span><span leaf="">##     Col4a2, Plod2, Lamb1, Col4a1, Aqp8, Nid1, Fxyd3, Serping1, Fst, Cd9 </span><span leaf=""><br></span><span leaf="">##     Nog, Eva1a, Epas1, Plat, Klf4, F3, Thbd, Ptger3, Serpinb6c, Cmtm7</span></code></pre><pre><code><span><span leaf="">scRNA </span><span><span leaf="">&lt;-</span></span><span><span leaf="">FindNeighbors</span></span><span leaf="">(scRNA, </span><span><span leaf="">dims =</span></span><span><span leaf="">1</span></span><span><span leaf="">:</span></span><span><span leaf="">30</span></span><span leaf="">)</span></span></code></pre><pre><code><span leaf="">## Computing nearest neighbor graph</span></code></pre><pre><code><span leaf="">## Computing SNN</span></code></pre><pre><code><span><span leaf="">scRNA </span><span><span leaf="">&lt;-</span></span><span><span leaf="">RunTSNE</span></span><span leaf="">(scRNA, </span><span><span leaf="">dims =</span></span><span><span leaf="">1</span></span><span><span leaf="">:</span></span><span><span leaf="">30</span></span><span leaf="">)</span></span><span leaf=""><br></span><span><span><span leaf="">DimPlot</span></span><span leaf="">(scRNA, </span><span><span leaf="">reduction =</span></span><span><span leaf="">"tsne"</span></span><span leaf="">)</span></span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicrjW8OfiaRauYnJjiaZ8JyzE8Q73GoqAqLoTJyPolDwxT0TufNfqb9YJA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7138888888888889" data-type="png" data-w="1080" data-imgfileid="100050864" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicrjW8OfiaRauYnJjiaZ8JyzE8Q73GoqAqLoTJyPolDwxT0TufNfqb9YJA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf=""><br></span></p></section></section></section></section><section data-pm-slice="0 0 []" data-mp-plugin="96weixin"><section><section data-pm-slice="0 0 []"><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section data-support="96编辑器" data-style-id="28345" data-mp-plugin="96weixin"><section data-align="title"><section><section><p><strong><span leaf="">三、参考</span></strong></p></section></section></section></section><section data-support="96编辑器" data-style-id="40098" data-mp-plugin="96weixin"><section><section><section><section><span><span leaf=""><span textstyle="">[1]Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767.</span></span></span><span leaf=""><br></span><span><span leaf=""><span textstyle="">[2]</span></span></span><section><span><span leaf=""><span textstyle="">https://biofam.github.io/MOFA2/</span></span></span></section><span leaf=""><br></span><span><span leaf=""><span textstyle="">[3]</span></span></span><section><span><span leaf=""><span textstyle="">https://marionilab.cruk.cam.ac.uk/MouseGastrulation2018/</span></span></span></section></section></section></section></section></section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section data-support="96编辑器" data-style-id="28345" data-mp-plugin="96weixin" data-pm-slice="7 9 []"><section data-align="title"><section><section><p><strong><span leaf="">四、资料领取</span></strong></p></section></section></section></section><section data-support="96编辑器" data-style-id="40098" data-mp-plugin="96weixin"><section><section><section><section data-width="100%" data-pm-slice='3 5 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"40226","data-pm-slice":"6 2 []","style":"-webkit-tap-highlight-color: transparent; margin: 0px; padding: 0px; outline: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; color: rgba(0, 0, 0, 0.9); font-family: \"PingFang SC\", system-ui, -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; background-color: rgb(255, 255, 255); visibility: visible;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"para",{"tagName":"section","attributes":{"style":"-webkit-tap-highlight-color: transparent; margin: 10px 0px; padding: 0px; outline: 0px; max-width: 100%; box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible;"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span data-pm-slice="0 0 []"><span leaf=""><span textstyle="">一切不给测试文件和分析环境版本的教程都是耍流氓，本推送的代码和测试文件可以在以下链接中下载：</span></span></span></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicibFEBBCdibmRTiappvwflAcK9PrjGgrmI0B6ccayDoQcHibehxNSaZPSIQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2321867321867322" data-s="300,640" data-type="png" data-w="814" type="block" data-imgfileid="100050867" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicibFEBBCdibmRTiappvwflAcK9PrjGgrmI0B6ccayDoQcHibehxNSaZPSIQ/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">文件大小约631.49MB</span></span></section><p><span leaf=""><span textstyle="">链接:</span><span textstyle=""> </span></span><span leaf=""><span textstyle="">https://pan.baidu.com/s/1KxyF6cjTOnGkJxG3aiJYgw</span></span></p><p><span leaf=""><span textstyle="">提取码：</span><span textstyle="">se7k</span></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicS5QicCZzRplJJiaspFeibNJ3PDSXC7ymshcut7ut7Hab8BItIkR577TnQ/640?wx_fmt=jpeg" data-ratio="1.0114942528735633" data-s="300,640" data-type="png" data-w="783" type="block" data-croporisrc="https://mmbiz.qpic.cn/mmbiz_png/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicG77q5icE9II6UKWcnyDK9zsGwopkSwibKtRvcctBCLSc5AKGibvsC9DJg/0?wx_fmt=png&amp;from=appmsg" data-cropx1="175.21400778210116" data-cropx2="958.1322957198444" data-cropy1="172.99610894941634" data-cropy2="964.7859922178989" data-imgfileid="100050868" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpz9xSRUibIibPcs7bHf9DDSWicS5QicCZzRplJJiaspFeibNJ3PDSXC7ymshcut7ut7Hab8BItIkR577TnQ/640?wx_fmt=jpeg"></section><p><span leaf=""><br></span></p></section></section></section></section><section><span leaf=""><br></span></section><section data-pm-slice="0 0 []" data-mp-plugin="96weixin"><section><section data-pm-slice="0 0 []"><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section><span leaf=""><br></span><section data-support="96编辑器" data-style-id="37305" data-pm-slice='38 10 ["para",{"tagName":"section","attributes":{"data-support":"96编辑器","data-style-id":"37305","style":"-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;font-family: \"PingFang SC\", system-ui, -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Hiragino Sans GB\", \"Microsoft YaHei UI\", \"Microsoft YaHei\", Arial, sans-serif;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;letter-spacing: 0.544px;orphans: 2;text-align: justify;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;background-color: rgb(255, 255, 255);visibility: visible;box-sizing: border-box !important;overflow-wrap: break-word !important;","data-mp-plugin":"96weixin"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><section><section><section><section><section data-support="96编辑器" data-style-id="36531"><section><section data-align="title"><section data-align="title"><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgDzj66ZOwl0njbJ30HMFyLcZsxrqT3UCOtf50I0DiaBmLhnRTDiayCiaYq073krS7LYKf3pdaISNvMg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=qywuinol&amp;tp=wxpic#imgIndex=77" alt="图片" data-ratio="0.8831168831168831" data-w="77" data-imgfileid="100038786" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgDzj66ZOwl0njbJ30HMFyLcZsxrqT3UCOtf50I0DiaBmLhnRTDiayCiaYq073krS7LYKf3pdaISNvMg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=qywuinol&amp;tp=wxpic#imgIndex=77"></section><section><section><p><span><strong><span leaf=""><span textstyle="">欢迎致谢</span></span></strong></span></p></section><section><section data-width="100%"><span leaf=""><br></span></section></section></section></section></section></section></section><section><section><section><span><span leaf=""><span textstyle="">如果以上内容对你有帮助，欢迎在文章的Acknowledgement中加上这一段，联系客服微信可以发放奖励：</span></span></span></section><pre><code><span><span leaf="">Since Biomamba and his wechat public account team produce bioinformatics tutorials and share code with annotation, we thank Biomamba </span><span><span leaf="">for</span></span><span leaf=""> their guidance </span><span><span leaf="">in</span></span><span leaf=""> bioinformatics and data analysis </span><span><span leaf="">for</span></span><span leaf=""> the current study.</span></span></code></pre><p><span leaf=""><br></span></p><p><span><strong><span><span leaf=""><span textstyle="">欢迎在发文/毕业时向我们分享你的喜悦~</span></span></span></strong></span></p><p><span><strong><span><span leaf="">已致谢文章</span></span></strong></span></p><section data-support="96编辑器" data-style-id="30363" data-mp-plugin="96weixin"><section><section><section><section data-width="100%"><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247510548&amp;idx=1&amp;sn=58048c46e837b1d56dffa282272c6d96&amp;chksm=9b3cd344ac4b5a52369e91b4e61fa0a2c951b82cc21165b99f42ba2c2191d4add803bd73c928&amp;scene=21&amp;cur_album_id=3425248581018714114#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">鼻咽癌的Bulk RNA-Seq与scRNA-Seq联合分析</span></a></span></p><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247511886&amp;idx=1&amp;sn=31c712d00377b0f0ed33703b5b4fbfd8&amp;chksm=9b3cd61eac4b5f084fde14a2eb50356f2f40a66c608d38909f12a3d81f48cff029a09ce2ee8c&amp;token=1453608870&amp;lang=zh_CN&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">13分+文章利用scRNA-Seq揭示地铁细颗粒物引起肺部炎症的分子机制</span></a></span></section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247518144&amp;idx=1&amp;sn=d036f1bb04b09eb73f53e2104d69404c&amp;chksm=9b3cfe90ac4b77862f2f463b42132c7bfdb687a1b61d350dcf656117b1331271e179710fd4fa&amp;scene=21&amp;cur_album_id=3425248581018714114#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">除了铁死亡，还有铜死亡？！</span></a></span></p><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247520900&amp;idx=1&amp;sn=157134292ffc2e5df730c5ba8a357b61&amp;chksm=9b3cebd4ac4b62c286543c30381e9b4fdb8b44b28d4fa902fb963bbd45b28e1d3f1bc98eb148&amp;scene=21&amp;cur_album_id=3425248581018714114#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">IF14.3| scRNA-seq+脂质组多组学分析揭示宫内生长受限导致肝损伤的性别差异</span></a></span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247521069&amp;idx=1&amp;sn=4ef441a885cb2525ee3b5c81001feddf&amp;chksm=9b3cea7dac4b636be9f10ffdf75e13531fccae62129944b21a457db2e08c3f2db1e1b553ac34&amp;scene=21&amp;cur_album_id=3425248581018714114#wechat_redirect" textvalue="" linktype="text" data-linktype="2"><span textstyle="">银屑病和脂肪肝病中共同病理和免疫特征</span></a><span textstyle=""> </span></span></section><section><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247522233&amp;idx=1&amp;sn=287a380de741ff55f0ce78dc9c727985&amp;chksm=9b3ceee9ac4b67ffd925abafeba2cb215a5984e6dc85f0d8607340a07ec9208f1d19eae0e04b&amp;scene=21#wechat_redirect" textvalue="《Advanced Science》新型Arf1抑制剂促进癌症干细胞衰老并增强抗肿瘤免疫" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">《Advanced Science》新型Arf1抑制剂促进癌症干细胞衰老并增强抗肿瘤免疫</span></a></span></section><p><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247522281&amp;idx=1&amp;sn=f95eb12fdc340b8da1123ec6253e6fac&amp;chksm=9b3ceeb9ac4b67afa587e5fa3a2a8960e9bb28a1ad6dc48e49120a76154417a4c8be95af90b0&amp;scene=21#wechat_redirect" textvalue="scRNA-seq揭示脓毒症预后水平预测的关键靶点！" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">scRNA-seq揭示脓毒症预后水平预测的关键靶点！</span></a></span></p><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247527168&amp;idx=1&amp;sn=0791d2bf53a9a60015577f892b10d370&amp;scene=21#wechat_redirect" textvalue='机器学习+生信多组学联合构建牙周炎"线粒体功能障碍与免疫微环境"关联网络' data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">机器学习+生信多组学联合构建牙周炎"线粒体功能障碍与免疫微环境"关联网络</span></a></span></p><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528014&amp;idx=1&amp;sn=d285c9ebd415be328fc682d00e6182c0&amp;scene=21#wechat_redirect" textvalue="KIF18A在肝细胞癌转移中的双重角色" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">KIF18A在肝细胞癌转移中的双重角色</span></a></span></p><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247530000&amp;idx=1&amp;sn=e8ddca4e1b2e60839cdf2a7fe87b3dfe&amp;chksm=9b3c0f40ac4b86562e0e307b9dbb8688159e72b3c19d9ceebf8a4bb2e21638896f005b497b11&amp;scene=21&amp;cur_album_id=3425248581018714114&amp;search_click_id=#wechat_redirect" textvalue="bulk+scRNA-seq挖掘BCL2-MAPK14-TXN氧化应激诊断模型，鉴定脓毒症中氧化应激关键基因" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">bulk+scRNA-seq挖掘BCL2-MAPK14-TXN氧化应激诊断模型，鉴定脓毒症中氧化应激关键基因</span></a></span></p></section></section></section></section><section><p><span leaf=""><span textstyle="">向下滑动查看更多</span></span></p></section></section></section></section><p><span><span leaf="">欢迎大家致谢~</span></span></p><p><span leaf=""><br></span></p></section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/ImlBFVOwwpx2dVa7tC0UYQRDUr6TnenA8vsST0iaFjDqdO9ecITMbpF2CD5mWr6Z30yXOIcj45qtdIpia3zh8POQ/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=7lj2ti0t&amp;tp=wxpic#imgIndex=78" alt="图片" data-ratio="0.9333333333333333" data-type="gif" data-w="75" data-imgfileid="100038785" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/ImlBFVOwwpx2dVa7tC0UYQRDUr6TnenA8vsST0iaFjDqdO9ecITMbpF2CD5mWr6Z30yXOIcj45qtdIpia3zh8POQ/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=7lj2ti0t&amp;tp=wxpic#imgIndex=78"></section></section></section><p><span leaf=""><br></span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section><section data-pm-slice="0 0 []"><section><section data-pm-slice="0 0 []"><section><section data-support="96编辑器" data-style-id="36531"><section data-align="title"><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;randomid=6yqn0s1k&amp;tp=webp#imgIndex=8" alt="图片" data-ratio="0.5106382978723404" data-w="47" data-width="100%" data-imgfileid="100042173" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5O8mjlC4kPOluxibs4oDot7AXe0RgoXgMeiaB3KYViadIQqXRoRicyian7KUg/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;randomid=6yqn0s1k&amp;tp=webp#imgIndex=8"></section><section><section data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5Ohviaxjsp3ZhRgjJ0mLNVEwpbT2fzdQMNt832icGGUt1ib9G2DMiazWDahA/640?wx_fmt=png" data-fail="0"><section><p><strong><span leaf="">如何联系我们</span></strong><span leaf=""><br></span></p></section></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;randomid=5w77y1os&amp;tp=webp#imgIndex=9" alt="图片" data-ratio="1.163265306122449" data-w="49" data-width="100%" data-imgfileid="100042169" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWiaFyWDMZJ2713X3DwiaQicG5OSxqKNRib39TuLic5NT2iaJaI0mIicuvjMZlRPvlqPfgjzg001qlRJTBDRA/640?wx_fmt=other&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;randomid=5w77y1os&amp;tp=webp#imgIndex=9"></section></section></section></section></section><section data-support="96编辑器" data-style-id="34624"><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=5ixl8h41&amp;tp=webp#imgIndex=10" alt="图片" data-ratio="0.2463768115942029" data-w="138" data-imgfileid="100042172" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaC0oer2QpXIolHVU3Xibtm9BNWiav660mHaB5qEd1dibMibUicNYmAzBBiadQP2s7HArdUxoWL5cDkTEbQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=5ixl8h41&amp;tp=webp#imgIndex=10"></section><section><section data-pm-slice="0 0 []"><span><span leaf=""><span textstyle="">留一个领取</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247532585&amp;idx=1&amp;sn=e265d2846ec66e5faaaf21403d274d2f&amp;scene=21#wechat_redirect" textvalue="资料" data-itemshowtype="0" linktype="text" data-linktype="2">资料</a>、</span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528410&amp;idx=2&amp;sn=0f2bac25479cf8d20dab5d82ae986f2e&amp;scene=21#wechat_redirect" textvalue="开箱即用的单细胞分析镜像" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">开箱即用的单细胞分析镜像</span></a>的</span></span><span><strong><span leaf="">微信号<span textstyle="">[Biomamba_yunying]</span></span></strong></span><span leaf=""><span textstyle="">，方便各位随时交流。同时我们也构建了</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247528057&amp;idx=1&amp;sn=bb348c2a88c977c7cce67ee6731a3591&amp;scene=21#wechat_redirect" textvalue="Biomamba生信基地交流群矩阵" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">交流群矩阵</span></a>，<span textstyle="">欢迎大家入群讨论。</span></span></section><section data-pm-slice="0 0 []"><span leaf=""><br></span></section><section><span><span leaf=""><span textstyle="">大家可以阅读完这几篇之后添加</span></span></span></section><section><span><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247493329&amp;idx=1&amp;sn=597870b7f7ce10346da3561e7c281627&amp;chksm=9b3c9f81ac4b169794088ce9abbcacb5f18e9fd174fc0d7e28da62d78facadf3100ef38aaf22&amp;scene=21#wechat_redirect" textvalue="给生信入门初学者的小贴士" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">给生信入门初学者的小贴士</span></a></span><span leaf=""><br></span></span></section><section><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247529398&amp;idx=2&amp;sn=5a429852d61721916a405712677d5905&amp;scene=21#wechat_redirect" textvalue="没有检索，就没有发言权" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">没有检索，就没有发言权</span></a></span></span><span leaf=""><br></span></section><p><span><strong><span leaf="">已有生信基地联系方式的同学</span></strong></span><span><strong><span leaf="">无需重复添加</span></strong></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyQnz4vf7GibVdoavE7dBqK3fMn0I2ONlp8LNpd3Pp9sGmfg4SegHNqkP7ZwUKwWP9licLaB3RiabA0Q/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5005291005291005" data-s="300,640" data-type="jpeg" data-w="945" type="block" data-imgfileid="100050447" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/ImlBFVOwwpyQnz4vf7GibVdoavE7dBqK3fMn0I2ONlp8LNpd3Pp9sGmfg4SegHNqkP7ZwUKwWP9licLaB3RiabA0Q/640?wx_fmt=jpeg&amp;from=appmsg"></section></section></section></section></section></section></section><section><section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=3hy3u99m&amp;tp=webp#imgIndex=12" alt="图片" data-ratio="0.7619047619047619" data-w="84" data-width="80%" data-imgfileid="100042174" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhFTIP7DCMLPwWh8Yhjs079f1vMqlYdExqbWaZVJyiawKkr21EDSNW740b4yMzkeHxFJULTpZGzYwQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;randomid=3hy3u99m&amp;tp=webp#imgIndex=12"></section><section><span><span leaf="">您点的每个赞和在看，我都认真当成了喜欢</span></span></section></section></section></section><section><span leaf=""><br></span></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jjQf07_m7eHxDrv1kTU5AA",target="_blank" rel="noopener noreferrer">原文链接</a>
