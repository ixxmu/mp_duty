---
title: "不懂环状图绘制？OmicCircos包，让你轻松实现基因组数据可视化，快速掌握环状图绘制技巧！"
date: 2025-12-19T12:21:44Z
draft: ["false"]
tags: [
  "fetched",
  "云生信"
]
categories: ["Acdemic"]
---
不懂环状图绘制？OmicCircos包，让你轻松实现基因组数据可视化，快速掌握环状图绘制技巧！ by 云生信
------
<div><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUhaBVsyTuCMezNVDsHC9Jx6s9ia4Em4TzyCzA9jbV1Dp6bA4AiaoUwF42rljSqhS6KHxs2PoBzYDGg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.2222222222222222" data-s="300,640" data-type="jpeg" data-w="900" type="block" data-imgfileid="100015061" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUhaBVsyTuCMezNVDsHC9Jx6s9ia4Em4TzyCzA9jbV1Dp6bA4AiaoUwF42rljSqhS6KHxs2PoBzYDGg/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span><span leaf=""><img data-backh="115" data-backw="576" data-ratio="0.2" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LJ6MWvQzSzZUAL6Ll12TWPiaVsJI3r0g1LgzqR6aINXZzm9MwHyYdVVQ/640?wx_fmt=png" data-w="4650" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LJ6MWvQzSzZUAL6Ll12TWPiaVsJI3r0g1LgzqR6aINXZzm9MwHyYdVVQ/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">同学们，今天小师妹要为大家介绍一个在基因组数据可视化中非常重要的工具——OmicCircos包！作为一个专为环状图绘制设计的强大R包，OmicCircos提供了丰富的功能，帮助我们轻松将基因组数据以环状图的形式直观展示。无论是基因表达数据、突变信息、还是基因组结构变异，OmicCircos都能通过美观的环状图帮助我们更好地理解数据。</span></span></span><span><span leaf=""><span textstyle="">基因组数据可视化对小师妹来说简直是轻轻松松，如果同学们在分析过程中遇到任何困难，随时来找我一起讨论哦！</span></span></span></p><p><span><span leaf=""><span textstyle="">在本次学习中，我们将从OmicCircos包的安装和加载开始，逐步掌握如何用它绘制各种类型的环状图。通过实际案例，同学们将学习如何设置染色体轨道、添加数据轨道、绘制热图、折线图、散点图等多种图形元素。相信通过今天的学习，同学们一定能够在基因组数据可视化方面取得重要进展！接下来，让我们一起开启OmicCircos包的学习之旅吧！</span></span></span><page></page></p><p><span><span leaf=""><span textstyle="">本次介绍的R包在服务器上能更加流畅地运行，如果没有服务器，欢迎联系我们进行服务器租赁~需要相关示例数据代码也可以找师妹哦~~</span></span></span></p><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="194" data-imgfileid="100011261" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><section><p><span><strong><span leaf="">定制生信分析</span></strong></span></p><p><span><strong><span leaf="">生信云服务器</span></strong></span></p></section></section></section></section></section></section></section><p><span><span leaf=""><span textstyle="">OmicCircos包介绍</span></span></span></p><p><span><span leaf=""><span textstyle="">OmicCircos是一个功能强大的R包，专门用于绘制基因组数据的环状图。它基于Circos软件的设计理念，提供了丰富的可视化功能，包括染色体轨道绘制、热图、折线图、散点图、链接线等多种图形元素的展示。OmicCircos包支持多种基因组数据类型的可视化，如基因表达数据、拷贝数变异、突变信息、表观遗传标记等。通过直观的环状图展示，研究者能够更好地理解基因组数据的分布规律和相互关系，是生物信息学研究中重要的可视化工具。</span></span></span></p><p><span><span leaf=""><span textstyle="">OmicCircos包安装</span></span></span></p><p><span><span leaf=""><span textstyle="">首先，我们需要安装OmicCircos包。由于OmicCircos是一个Bioconductor包，我们需要通过BiocManager进行安装：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>if</span><span> </span>(!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))          </span></code><code><span leaf="">    install.<span>packages</span>(<span>"BiocManager"</span>)          </span></code><code><span leaf=""><span>BiocManager</span>::<span>install</span>(<span>"OmicCircos"</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">安装完成后，加载OmicCircos包：</span></span></span><page></page></p><section><ul><li></ul><pre data-lang=""><code><span leaf="">library(OmicCircos)</span></code></pre></section><p><span><span leaf=""><span textstyle="">查看OmicCircos包的版本，确保安装成功：</span></span></span></p><section><ul><li></ul><pre data-lang="javascript"><code><span leaf=""><span>packageVersion</span>(<span>"OmicCircos"</span>)</span></code></pre></section><p><span><span leaf=""><img data-ratio="0.15794481446241673" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3L5amNmQ8dk1Je3suRndISqDaJYYLQI3KCh8YxVT85PiayIV65ana1HpA/640?wx_fmt=png" data-w="1051" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3L5amNmQ8dk1Je3suRndISqDaJYYLQI3KCh8YxVT85PiayIV65ana1HpA/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">如果显示版本号为1.40.0或更高，说明成功安装了OmicCircos包！</span></span></span></p><p><span><span leaf=""><span textstyle="">使用OmicCircos包绘制基因组环状图</span></span></span></p><p><span><span leaf=""><span textstyle="">准备示例数据：</span></span></span><span><span leaf=""><span textstyle="">首先，我们需要准备一些示例数据来演示OmicCircos的功能。我们将使用包自带的示例数据：</span></span></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 加载示例数据          </span></span></code><code><span leaf="">data(<span>"UCSC.hg19.chr"</span>, package=<span>"OmicCircos"</span>)          </span></code><code><span leaf="">data(<span>"TCGA.BC.fus"</span>, package=<span>"OmicCircos"</span>)          </span></code><code><span leaf="">data(<span>"TCGA.BC.cnv.2k.60"</span>, package=<span>"OmicCircos"</span>)          </span></code><code><span leaf="">data(<span>"TCGA.BC.gene.exp.2k.60"</span>, package=<span>"OmicCircos"</span>)</span></code><code><span leaf=""><span>df</span> &lt;- TCGA.BC.gene.exp.2k.60</span></code><code><span leaf=""><span># 1. 位置列改名</span></span></code><code><span leaf=""><span>df</span><span>$start</span> &lt;- <span>df</span><span>$po</span></span></code><code><span leaf=""><span>df</span><span>$end</span> &lt;- <span>df</span><span>$po</span></span></code><code><span leaf=""><span># 2. 删除无关列</span></span></code><code><span leaf=""><span>df</span><span>$po</span> &lt;- NULL</span></code><code><span leaf=""><span>df</span><span>$NAME</span> &lt;- NULL</span></code><code><span leaf=""><span># 3. 确保 chr 是字符类型</span></span></code><code><span leaf=""><span>df</span><span>$chr</span> &lt;- as.character(<span>df</span><span>$chr</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">查看数据的基本信息，了解数据结构：</span></span></span></p><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 查看染色体数据          </span></span></code><code><span leaf=""><span>head</span>(UCSC.hg19.chr)          </span></code><code><span leaf=""><span># 查看基因融合数据          </span></span></code><code><span leaf=""><span>head</span>(TCGA.BC.fus)          </span></code><code><span leaf=""><span># 查看拷贝数变异数据          </span></span></code><code><span leaf=""><span>head</span>(TCGA.BC.cnv.<span>2</span>k.<span>60</span>)          </span></code><code><span leaf=""><span># 查看基因表达数据          </span></span></code><code><span leaf=""><span>head</span>(TCGA.BC.gene.exp.<span>2</span>k.<span>60</span>)</span></code></pre></section><p><span><span leaf=""><img data-ratio="0.2835723598435463" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LJoS6lmoERVwI9PuIaUzaN8zQJIu9TtxSyrn3dSiaibNpqIS3gyrxQSibw/640?wx_fmt=png" data-w="1534" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LJoS6lmoERVwI9PuIaUzaN8zQJIu9TtxSyrn3dSiaibNpqIS3gyrxQSibw/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">绘制环状图</span></span></span></p><p><span><span leaf=""><span textstyle="">初始化环状图：在开始绘制之前，我们需要初始化环状图的参数设置：</span></span></span><page></page></p><section><ul><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 设置绘图参数</span></span></code><code><span leaf=""><span>pdf</span>(<span>"circos_plot.pdf"</span>, width=<span>10</span>, height=<span>10</span>)          </span></code><code><span leaf=""><span>par</span>(mar=c(<span>2</span>, <span>2</span>, <span>2</span>, <span>2</span>))          </span></code><code><span leaf=""><span>plot</span>(c(<span>1</span>,<span>800</span>), c(<span>1</span>,<span>800</span>), type=<span>"n"</span>, axes=FALSE, xlab=<span>""</span>, ylab=<span>""</span>, main=<span>""</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">绘制染色体轨道：染色体轨道是环状图的基础，显示基因组的基本结构：</span></span></span></p><section><ul><li><li></ul><pre data-lang="php"><code><span leaf=""><span># 绘制染色体轨道          </span></span></code><code><span leaf=""><span>circos</span>(R=<span>400</span>, type=<span>"chr"</span>, cir=<span>"hg19"</span>, W=<span>4</span>, <span>print</span>.chr.lab=<span>TRUE</span>, scale=<span>TRUE</span>)</span></code></pre></section><p><span><span leaf=""><img data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVBVWUrE64B5uUIs65OfH3L6Kr9tdD0zmAkibSgD3r6a54oTQkRt58oOjPCxwXyorHdj5gBmtTnV0A/640?wx_fmt=jpeg" data-w="867" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVBVWUrE64B5uUIs65OfH3L6Kr9tdD0zmAkibSgD3r6a54oTQkRt58oOjPCxwXyorHdj5gBmtTnV0A/640?wx_fmt=jpeg"></span></span><page></page></p><p><span><span leaf=""><span textstyle="">添加拷贝数变异热图：在染色体轨道的基础上，我们可以添加拷贝数变异的热图展示：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 添加拷贝数变异热图          </span></span></code><code><span leaf=""><span>circos</span>(R=<span>300</span>, cir=<span>"hg19"</span>, W=<span>100</span>, mapping=TCGA.BC.cnv.<span>2</span>k.<span>60</span>, type=<span>"heatmap2"</span>, col.v=<span>4</span>, col.bar=TRUE, lwd=<span>0</span>.<span>01</span>, cluster=TRUE)</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVBVWUrE64B5uUIs65OfH3Lh9RFickrJvW2iay9IfE77jI7RQwgNgZDCc5hibf9O69ZdpHsuZQ5m8SBw/640?wx_fmt=jpeg" data-ratio="1" data-w="866" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVBVWUrE64B5uUIs65OfH3Lh9RFickrJvW2iay9IfE77jI7RQwgNgZDCc5hibf9O69ZdpHsuZQ5m8SBw/640?wx_fmt=jpeg"></span></span></p><p><span><span leaf=""><span textstyle="">添加基因表达折线图：在另一个轨道上添加基因表达的折线图：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 添加基因表达折线图</span></span></code><code><span leaf=""><span>circos</span>(R=<span>200</span>, cir=<span>"hg19"</span>, W=<span>100</span>, mapping=df, type=<span>"ml3"</span>, lwd=<span>1</span>, col=colors()[<span>20</span>:<span>30</span>], scale=TRUE)</span></code></pre></section><p><page></page></p><p><span><span leaf=""><img data-ratio="0.9808853118712274" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LicpmCobV1XfYaxvTOXEvkpB9SzJ3Xst5tObfpL0dX20j01663zbMnnw/640?wx_fmt=png" data-w="994" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LicpmCobV1XfYaxvTOXEvkpB9SzJ3Xst5tObfpL0dX20j01663zbMnnw/640?wx_fmt=png"></span></span><span></span></p><p><span><span leaf=""><span textstyle="">添加基因融合链接线：基因融合事件可以通过链接线来展示：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 添加基因融合链接线          </span></span></code><code><span leaf=""><span>circos</span>(R=<span>150</span>, cir=<span>"hg19"</span>, W=<span>50</span>, mapping=TCGA.BC.fus, type=<span>"link"</span>, lwd=<span>2</span>, col=colors()[<span>121</span>:<span>124</span>])</span></code></pre></section><p><span></span></p><p><span><span leaf=""><span textstyle="">添加图例和标题：为了让图形更加完整，我们添加图例和标题：</span></span></span></p><section><ul><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 添加图例          </span></span></code><code><span leaf=""><span>legend</span>(<span>"topright"</span>, legend=c(<span>"CNV Heatmap"</span>, <span>"Gene Expression"</span>, <span>"Gene Fusion"</span>),           </span></code><code><span leaf="">       <span>fill</span>=c(<span>"red"</span>, <span>"blue"</span>, <span>"green"</span>), bty=<span>"n"</span>, cex=<span>0</span>.<span>8</span>)          </span></code><code><span leaf=""><span># 添加标题          </span></span></code><code><span leaf=""><span>title</span>(<span>"Genomic Circos Plot - Breast Cancer Data"</span>)</span></code></pre></section><p><page></page></p><p><span><span leaf=""><span textstyle="">自定义颜色方案：我们可以自定义颜色方案来美化图形：</span></span></span></p><section><ul><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 创建自定义颜色          </span></span></code><code><span leaf=""><span>my_colors</span> &lt;- colorRampPalette(c(<span>"blue"</span>, <span>"white"</span>, <span>"red"</span>))(<span>100</span>)          </span></code><code><span leaf=""><span># 重新绘制热图使用自定义颜色          </span></span></code><code><span leaf=""><span>circos</span>(R=<span>300</span>, cir=<span>"hg19"</span>, W=<span>100</span>, mapping=TCGA.BC.cnv.<span>2</span>k.<span>60</span>, type=<span>"heatmap2"</span>, col.v=<span>4</span>, col=my_colors, col.bar=TRUE)</span></code></pre></section><p><span><span leaf=""><span textstyle="">添加文本标签：在特定位置添加文本标签，标注重要基因或区域：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 添加文本标签          </span></span></code><code><span leaf=""><span>circos</span>(R=<span>350</span>, cir=<span>"hg19"</span>, W=<span>50</span>, mapping=data.frame(chr=<span>"chr1"</span>, pos=<span>1000000</span>, label=<span>"Important Gene"</span>), type=<span>"label"</span>, side=<span>"out"</span>, col=<span>"black"</span>, cex=<span>0</span>.<span>8</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">保存图形：最后，我们将绘制好的环状图保存为图片文件：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 保存为PDF          </span></span></code><code><span leaf=""><span>dev</span>.<span>off</span>()</span></code></pre></section><p><span><span leaf=""><br></span></span><page></page></p><p><span><span leaf=""><img data-ratio="1.0133333333333334" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LUEVdNqdAdK7Zf3BIm4a0miasibQlL7x9Aia3HUHrDqolib0TnHN4oicDUgA/640?wx_fmt=png" data-w="1125" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVBVWUrE64B5uUIs65OfH3LUEVdNqdAdK7Zf3BIm4a0miasibQlL7x9Aia3HUHrDqolib0TnHN4oicDUgA/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">通过以上步骤，我们成功绘制了一个包含染色体轨道、拷贝数变异热图、基因表达折线图和基因融合链接线的完整环状图。这个图形清晰地展示了基因组数据的多层次信息，帮助我们更好地理解数据的分布规律和相互关系。环状图的中心是染色体轨道，向外依次是拷贝数变异的热图轨道、基因表达的折线图轨道，以及最外层的基因融合链接线。这种多层次的可视化方式使得复杂的基因组数据变得直观易懂。</span></span></span></p><p><span><span leaf=""><span textstyle="">总结</span></span></span></p><p><span><span leaf=""><span textstyle="">通过今天的学习，我们掌握了如何使用OmicCircos包进行基因组数据的环状图可视化。从数据准备到图形绘制，再到最终的图形美化，OmicCircos包为我们提供了全面的支持。通过实践，大家可以利用该包有效地展示基因组数据的多层次信息，包括染色体结构、拷贝数变异、基因表达和基因融合等。希望大家能够在今后的研究中充分应用OmicCircos包，提升基因组数据可视化的效果和效率。如果你在使用过程中遇到任何问题，或者对生物信息学分析有疑问，随时欢迎来找我讨论！</span></span></span></p><p><span><span leaf=""><span textstyle="">同学们如果觉得自己写代码麻烦，可以体验一下我们的云生信小工具，只需输入数据，即可轻松生成所需图表。立即访问云生信</span></span></span><span><span><span leaf=""><span textstyle="">（</span></span></span></span><span><span><span leaf=""><span textstyle="">http://www.biocloudservice.com/home.html</span></span></span></span><span><span><span leaf=""><span textstyle="">）</span></span></span></span><span></span><span><span leaf=""><span textstyle="">，开启便捷的生信之旅！</span></span></span></p><p><span leaf=""><br></span></p><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="219" data-cropsely1="0" data-cropsely2="219" data-imgfileid="100013742" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><p><span leaf="">定制生信分析</span></p><p><span leaf="">课题思路设计</span></p><p><span leaf="">生信云服务器</span></p></section></section></section></section></section></section><section powered-by="xiumi.us"><section><section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3073838745411518465#wechat_redirect" textvalue="生信实操" linktype="text" data-linktype="2">生信实操</a></span></p></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section><section><section><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5MDk3Mzg4OA==&amp;action=getalbum&amp;album_id=3113598048028459016#wechat_redirect" textvalue="生信文章思路" linktype="text" data-linktype="2">生信思路</a></span></p></section></section><section><section><section><section><section><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section></section></section></section></section></section></section><p><span leaf=""><br></span><page></page></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/35PDs2ZiPv0BDihSNjV89w",target="_blank" rel="noopener noreferrer">原文链接</a>
