---
title: "å¤©å‘ï¼Œè¿™ç¯‡æ­¦æ±‰å¤§å­¦çš„NCç”Ÿä¿¡ä»£ç æ•™å’±ä»¬æ•™çš„ä¹Ÿå¤ªè´´å¿ƒäº†å§ï¼Œçœ‹çœ‹è¿™ç›®å½•çœŸæ˜¯æƒŠè®¶ï¼Œä»”ç»†ç ”ç©¶ä¸‹ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ªå›¾ä½ ä¹Ÿéƒ½èƒ½è·Ÿç€åšå‡ºæ¥"
date: 2025-05-08T00:08:43Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡é’±åŒå­¦"
]
categories: ["Acdemic"]
---
å¤©å‘ï¼Œè¿™ç¯‡æ­¦æ±‰å¤§å­¦çš„NCç”Ÿä¿¡ä»£ç æ•™å’±ä»¬æ•™çš„ä¹Ÿå¤ªè´´å¿ƒäº†å§ï¼Œçœ‹çœ‹è¿™ç›®å½•çœŸæ˜¯æƒŠè®¶ï¼Œä»”ç»†ç ”ç©¶ä¸‹ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ªå›¾ä½ ä¹Ÿéƒ½èƒ½è·Ÿç€åšå‡ºæ¥ by ç”Ÿä¿¡é’±åŒå­¦
------
<div><section><span leaf=""><span textstyle="">è¿™ç¯‡ç®€ç›´å¤ªç»å…¸äº†ï¼Œå¾ˆä¹…æ²¡æœ‰ç¢°åˆ°è¿™ä¹ˆå¥½çš„ç”Ÿä¿¡å­¦ä¹ çš„ç´ æå‘¢ï¼Œä½ ç…ç…è¿™äº›ä»£ç æ•´ç†ï¼Œå†™çš„æ¸…æ¸…æ¥šæ¥šï¼Œä¸ä¼šå•¥ï¼Œç¿»ç¿»çœ‹å°±è¡Œäº†ã€‚</span></span></section><section nodeleaf=""><img data-imgfileid="100009716" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctehUWe8ym2EaSrEHw9ndsMocvfG705xTHxdfo3GFf1mXOWQO5Oy8Mrg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctehUWe8ym2EaSrEHw9ndsMocvfG705xTHxdfo3GFf1mXOWQO5Oy8Mrg/640?wx_fmt=jpeg&amp;from=appmsg"></section><h2 spellcheck="true" placeholder="æ ‡é¢˜ 1" data-content-editable-leaf="true" data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">ç ”ç©¶æ­ç¤ºæˆç†Ÿä¸‰çº§æ·‹å·´æ ·ç»“æ„åœ¨å¤´é¢ˆç™Œå…ç–«ååº”ä¸­çš„å…³é”®ä½œç”¨</span></span></span></h2><p><span leaf=""><span textstyle="">è¿‘æ—¥ï¼Œä¸€é¡¹ç ”ç©¶å¤´é¢ˆç™Œå…ç–«æ²»ç–—çš„æ–‡ç« å‘è¡¨åœ¨äº†</span></span><span data-token-index="1"><span leaf=""><span textstyle="">Nature Communications</span></span></span><span leaf=""><span textstyle="">ã€‚</span></span><span data-token-index="3"><span leaf=""><span textstyle="">æ¥è‡ªæ­¦æ±‰å¤§å­¦çš„éƒä¸½ã€å­Ÿæ°å¼ ç­‰ç ”ç©¶äººå‘˜ï¼Œ</span></span></span><span data-token-index="4"><span leaf=""><span textstyle="">æ·±å…¥æ¢ç©¶äº†è‚¿ç˜¤ä¸‰çº§æ·‹å·´æ ·ç»“æ„ï¼ˆTLSï¼‰åœ¨å¤´é¢ˆç™Œä¸­çš„ä½œç”¨æœºåˆ¶ï¼Œå‘ç°æˆç†Ÿä¸‰çº§æ·‹å·´æ ·ç»“æ„ï¼ˆmTLSï¼‰å¯é€šè¿‡ç¥–ç»†èƒè€—ç«­çš„ CD4+ T ç»†èƒå¼•å‘è‚¿ç˜¤å†… T ç»†èƒå’Œ B ç»†èƒååº”</span></span></span><span data-token-index="5"><span leaf=""><span textstyle="">ï¼Œ</span></span></span><span leaf=""><span textstyle="">ä¸ºæ”¹å–„å¤´é¢ˆç™Œæ²»ç–—æ•ˆæœæä¾›äº†é‡è¦ç†è®ºä¾æ®ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100009714" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctBZia9QTtY3yMSC1BDedanIFl5CmRfLd3eHfV6M2rRRjgu4rpqTIGDOw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctBZia9QTtY3yMSC1BDedanIFl5CmRfLd3eHfV6M2rRRjgu4rpqTIGDOw/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">å…ç–«æ£€æŸ¥ç‚¹é˜»æ–­ï¼ˆICBï¼‰ç–—æ³•åœ¨å¤šç§ç™Œç—‡æ²»ç–—ä¸­å–å¾—äº†æ˜¾è‘—æˆæ•ˆï¼Œ</span></span><span data-token-index="1"><span leaf=""><span textstyle="">ç„¶è€Œï¼Œåœ¨å¤´é¢ˆç™Œæ²»ç–—ä¸­ï¼Œä»…æœ‰çº¦ 20% çš„æ‚£è€…èƒ½ä» ICB æ²»ç–—ä¸­è·å¾—æŒä¹…ä¸´åºŠç›Šå¤„ã€‚</span></span></span><span leaf=""><span textstyle="">è‚¿ç˜¤å†…ä¸‰çº§æ·‹å·´æ ·ç»“æ„ï¼ˆTLSï¼‰å·²è¢«è¯å®ä¸ç™Œç—‡æ‚£è€…çš„é¢„åæ”¹å–„å’Œ ICB æ²»ç–—ååº”ç›¸å…³ï¼Œå…¶ä¸­æˆç†Ÿ TLSï¼ˆmTLSï¼‰çš„ä½œç”¨å°¤ä¸ºå…³é”®ï¼Œä½†å…·ä½“æœºåˆ¶å°šä¸å®Œå…¨æ¸…æ¥šã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100009717" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctQSkgaYrx36icEVHbb55dcZeb2iaORosAYsj4prTO7UDBoKrozjOutLwA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctQSkgaYrx36icEVHbb55dcZeb2iaORosAYsj4prTO7UDBoKrozjOutLwA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">åœ¨æ­¤æ¬¡ç ”ç©¶ä¸­ï¼Œ</span></span><span data-token-index="1"><span leaf=""><span textstyle="">ç ”ç©¶äººå‘˜æ”¶é›†äº† 14 ä¾‹æ–°é²œå’Œ 422 ä¾‹ç¦å°”é©¬æ—å›ºå®šçŸ³èœ¡åŒ…åŸ‹ï¼ˆFFPEï¼‰çš„å¤´é¢ˆé³çŠ¶ç»†èƒç™Œï¼ˆHNSCCï¼‰æ‚£è€…çš„åŸå‘æ€§è‚¿ç˜¤æ ·æœ¬ã€‚</span></span></span><span data-token-index="2"><span leaf=""><span textstyle="">é€šè¿‡è‹æœ¨ç²¾ - ä¼Šçº¢ï¼ˆH&amp;Eï¼‰æŸ“è‰²ã€å…ç–«ç»„ç»‡åŒ–å­¦ï¼ˆIHCï¼‰æŸ“è‰²å’Œå¤šé‡å…ç–«ç»„ç»‡åŒ–å­¦ï¼ˆmIHCï¼‰æŸ“è‰²ï¼Œå‡†ç¡®æ£€æµ‹å’Œè¯„ä¼° TLS çš„çŠ¶æ€ã€‚éšåï¼Œ</span></span></span><span data-token-index="3"><span leaf=""><span textstyle="">å¯¹æ ·æœ¬è¿›è¡Œå•ç»†èƒ RNA æµ‹åºã€æŠ—åŸå—ä½“æµ‹åºå’Œç©ºé—´è½¬å½•ç»„å­¦åˆ†æ</span></span></span><span data-token-index="4"><span leaf=""><span textstyle="">ï¼Œå…¨é¢æ¢ç©¶ TLS åœ¨è‚¿ç˜¤å¾®ç¯å¢ƒï¼ˆTMEï¼‰ä¸­çš„ä½œç”¨æœºåˆ¶ã€‚</span></span></span></p><section nodeleaf=""><img data-imgfileid="100009718" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctib8TlHpcjl7x8how8D5L4PYSuWNuFIwDmT5MlmBibhO4HtCp8PoU0gfw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctib8TlHpcjl7x8how8D5L4PYSuWNuFIwDmT5MlmBibhO4HtCp8PoU0gfw/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">ç ”ç©¶å‘ç°ï¼Œ</span></span><span data-token-index="1"><span leaf=""><span textstyle="">mTLS ä¸­å¯Œå«å¹²ç»†èƒæ · T ç»†èƒå’Œå¤„äºä¸åŒæˆç†Ÿé˜¶æ®µçš„ B ç»†èƒï¼Œè¿™ä¸º B ç»†èƒå’Œ T ç»†èƒååº”çš„äº§ç”Ÿæä¾›äº†æœ‰åŠ›æ”¯æŒã€‚</span></span></span><span leaf=""><span textstyle="">åœ¨ T ç»†èƒæ–¹é¢ï¼Œ</span></span><span data-token-index="3"><span leaf=""><span textstyle="">mTLS ä¸­å¹¼ç¨š / ä¸­å¤®è®°å¿†å’Œæ•ˆåº”è®°å¿†è¡¨å‹çš„ CD8+ T ç»†èƒé«˜åº¦å¯Œé›†ï¼Œè¿™äº›ç»†èƒé«˜è¡¨è¾¾è®°å¿† / å¹²ç»†èƒæ ·æ ‡è®°ï¼Œå…·æœ‰æ›´å¼ºçš„å…ç–«æ´»æ€§ï¼›</span></span></span><span leaf=""><span textstyle="">è€Œåœ¨é mTLS è‚¿ç˜¤ä¸­ï¼ŒCD8+ T ç»†èƒå¤šä¸ºè€—ç«­è¡¨å‹ï¼Œå…ç–«åŠŸèƒ½å—é™ã€‚åŒæ—¶ï¼ŒmTLS ä¸­çš„ CD4+ T ç»†èƒå€¾å‘äºå‘è€—ç«­è¡¨å‹åˆ†åŒ–ï¼Œå°¤å…¶æ˜¯ç¥–ç»†èƒè€—ç«­çš„ CD4+ T ç»†èƒï¼ˆTexprog/Tfhï¼‰ï¼Œå…¶å…·æœ‰ç±»ä¼¼æ»¤æ³¡è¾…åŠ©æ€§ T ç»†èƒçš„ç‰¹å¾ï¼Œåœ¨ mTLS ä»‹å¯¼çš„å…ç–«ååº”ä¸­å‘æŒ¥å…³é”®ä½œç”¨ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100009719" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctsM8zAAkvE7uFk4fuk8yGYAEIhMqNoUjZGUZZZ1v9JRNVDsm9tTlmqw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctsM8zAAkvE7uFk4fuk8yGYAEIhMqNoUjZGUZZZ1v9JRNVDsm9tTlmqw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009710" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctx1Y04Xby9CztpAib9YKmWomSFgdHaREm0sSPgRsl4rgvpTxbbbTfKicw/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctx1Y04Xby9CztpAib9YKmWomSFgdHaREm0sSPgRsl4rgvpTxbbbTfKicw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009720" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctSM9mIT4z5G9K3RibzLibmNzXP3LsanE0J3Wic1fGlSibjosrRG0hEBiccCw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctSM9mIT4z5G9K3RibzLibmNzXP3LsanE0J3Wic1fGlSibjosrRG0hEBiccCw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009711" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctpHDibBuFxvTI25xbV0tMLOwN0HX9tTCYD4CXcOLnrt7VSeEJQ0byWrg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctpHDibBuFxvTI25xbV0tMLOwN0HX9tTCYD4CXcOLnrt7VSeEJQ0byWrg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009721" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctTw6H9dcCPCjFyiarzELrJzLabaRW0Lf7CaGiaUeiawZ3IyOdgdNPgBLibQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctTw6H9dcCPCjFyiarzELrJzLabaRW0Lf7CaGiaUeiawZ3IyOdgdNPgBLibQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009712" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctKbg3dczJzcsltCgYMSjoCNBibqYOeciaDbUT1kPavlxvrAfdiayvDVt0A/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctKbg3dczJzcsltCgYMSjoCNBibqYOeciaDbUT1kPavlxvrAfdiayvDVt0A/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009722" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctfwdib4RPAouMW2CqiaoS6HFCeq0Bp3AJVFb7lwVHR9RicsnibY7oumWXDA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctfwdib4RPAouMW2CqiaoS6HFCeq0Bp3AJVFb7lwVHR9RicsnibY7oumWXDA/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009713" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctVDFTy0mKLkib5dQUZoJEBpVuEKjYzxEWSQaEuOU9BR0ickhjtAWAMXCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctVDFTy0mKLkib5dQUZoJEBpVuEKjYzxEWSQaEuOU9BR0ickhjtAWAMXCg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100009723" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctRCDIx1WSqUq5Lia8soVVfxfYeiaNz2eibCX0pUVyfp7ibfYUiaaKH82w2kQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctRCDIx1WSqUq5Lia8soVVfxfYeiaNz2eibCX0pUVyfp7ibfYUiaaKH82w2kQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><section data-role="outer" label="Powered by 135editor.com onekey" data-pm-slice="0 0 []"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p data-brushtype="text"><strong><strong><span data-pm-slice="0 0 []"><span><span leaf="">Li, H., Zhang, MJ., Zhang, B. et al. Mature tertiary lymphoid structures evoke intra-tumoral T and B cell responses via progenitor exhausted CD4+ T cells in head and neck cancer. Nat Commun 16, 4228 (2025).Â </span></span></span></strong></strong></p><p data-brushtype="text" data-pm-slice="0 0 []"><strong><strong><strong><span leaf="">åè‹”â†©ï¸ä¹‹å‰è´´å­çš„å²¸å·å³å¯éœå¾—ä¹‹å‰çš„</span></strong></strong></strong></p><p data-brushtype="text"><strong><strong><strong><strong data-pm-slice="0 0 []"><span leaf="">ä»£ç ï¼Œä»Šæ—¥å…³é”®è¯ï¼š250508</span></strong></strong></strong></strong></p></section></section></section></section></section></section></section><section data-pm-slice="0 0 []"><strong><strong><strong><span leaf=""><span textstyle="">åŸºç¡€ã€å•ç»†èƒã€ç©ºé—´å„ä¸“é¢˜ç­ï¼Œæƒ³ç³»ç»Ÿæ€§å­¦ä¹ å¯ä»¥çœ‹ä¸‹è¿™ä¸ªğŸ‘‡</span></span></strong></strong></strong><span><span leaf=""><br></span></span><section><span leaf=""><br></span></section><span><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" textvalue="ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·</span></a></span><strong><span><span leaf=""><br></span><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img alt="å›¾ç‰‡" data-ratio="0.5990740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></a></span></strong></span></section><p><span><strong><span><span leaf="">æœ‰å•ç»†èƒæ•°æ®åˆ†æéœ€æ±‚çš„å¯ä»¥çœ‹</span><strong><strong><span leaf="">ğŸ‘‡è¿™ä¸ªæ–‡ç« </span></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span><strong><strong></strong></strong></span></strong><strong><strong><strong><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247490275&amp;idx=1&amp;sn=200ccc0a415860f9d73b9068657096ff&amp;scene=21#wechat_redirect" textvalue="æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš</a>ï¼ˆè¿‘æœŸåˆæ·»åŠ äº†21 å¹´å‘è¡¨åœ¨äº† Cellä¸Šé¢çš„å•ç»†èƒè½¬å½•ç»„åˆ†æä»£è°¢çš„åˆ†æâ€”â€”compassï¼‰</span></strong></strong></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf=""><br></span></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf="">æˆ‘ä»¬ç›®å‰ä¸»è¦çš„åˆ†æå†…å®¹çœ‹ğŸ‘‡ï¼ˆè¿™æ¬¡çš„æ˜¯å¯¹ä¸Šæ¬¡å†…å®¹çš„è¡¥å…… scBCRå’Œ sc-TCRäº†ï¼‰<a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247492253&amp;idx=1&amp;sn=da8477aa80c485e7cfd12862047cd30b&amp;scene=21#wechat_redirect" textvalue="é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2">é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš</a></span></strong></strong></strong></span></strong></span></p><section data-pm-slice="0 0 []"><span leaf=""><a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247492768&amp;idx=1&amp;sn=f2b180496f982a5f912df2b66c5229a3&amp;scene=21#wechat_redirect" textvalue="æ¯å¤©å¥½æ–‡ç« å¤ªå¤šäº†ï¼Œå…¬ä¼—å·åˆ†äº«ä¸å®Œï¼Œæ‰“ç®—å»ºä¸ªå­¦ä¹ ç¾¤ï¼Œç›¸äº’äº¤æµç”Ÿä¿¡" data-itemshowtype="0" target="_blank" linktype="text" data-linktype="2"><span textstyle="">æ¯å¤©å¥½æ–‡ç« å¤ªå¤šäº†ï¼Œå…¬ä¼—å·åˆ†äº«ä¸å®Œï¼Œæ‰“ç®—å»ºä¸ªå­¦ä¹ ç¾¤ï¼Œç›¸äº’äº¤æµç”Ÿä¿¡</span></a><span textstyle="">ï¼ˆåœ¨è¿™ä½ èƒ½æ¯å¤©å­¦åˆ°æœ‰å…³ç”Ÿä¿¡çš„å‰æ²¿æ–‡çŒ®ï¼Œæˆ‘ä»¬ä¼šæŠŠæœ€å¥½çš„æ–‡çŒ®å®æ—¶åˆ†äº«ç»™å¤§å®¶ï¼Œä»¥åŠç¾¤å†…å°ä¼™ä¼´ä»¬èƒ½å¤Ÿç›¸äº’åä½œï¼Œå…±åŒè§£å†³ä¸€äº›ç”Ÿä¿¡ä¸Šçš„é—®é¢˜ï¼‰</span></span></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009235" data-ratio="0.7675925925925926" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFsibBaljqp0Dsw1tuk0Ruqt9sUhyQv0ah7cUU5IoQ54b6Sfxiag6uTcdLicRicicoFSz8JpEfxtVaBHHSg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFsibBaljqp0Dsw1tuk0Ruqt9sUhyQv0ah7cUU5IoQ54b6Sfxiag6uTcdLicRicicoFSz8JpEfxtVaBHHSg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section><span leaf=""><span textstyle="">ç”±äºæ¯å¤©æ·»åŠ äººæ•°è¿‡å¤šï¼Œè¯·ä¸»åŠ¨å¤‡æ³¨å•ä½ï¼Œå¦åˆ™ä¸äºˆé€šè¿‡</span></span></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009257" data-ratio="1.3796296296296295" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFszqd8cpAAQELtsicOAkDzFGKkdR7FwS0Ons1vnuibw3dyLtcMqbtL1MnwpPd1qdfuqb7yWXsic7jicIw/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-type="jpeg" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFszqd8cpAAQELtsicOAkDzFGKkdR7FwS0Ons1vnuibw3dyLtcMqbtL1MnwpPd1qdfuqb7yWXsic7jicIw/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></section><section nodeleaf=""><img data-imgfileid="100009724" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctRniax3duorzXkrXgF0q24khicvb91YFvTNicIZeA0cDNFPbOlE6jIxOfw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvoNzOFvIYn4S1PgtUHRLctRniax3duorzXkrXgF0q24khicvb91YFvTNicIZeA0cDNFPbOlE6jIxOfw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åº“</span></span></code><code><span leaf=""><span># dplyr ç”¨äºæ•°æ®æ“ä½œï¼Œä¾‹å¦‚ç­›é€‰ã€åˆ†ç»„ã€æ±‡æ€»ç­‰</span></span></code><code><span leaf="">library(dplyr) Â  Â  Â Â </span></code><code><span leaf=""><span># ggplot2 ç”¨äºæ•°æ®å¯è§†åŒ–ï¼Œåˆ›å»ºå„ç§å›¾è¡¨</span></span></code><code><span leaf="">library(ggplot2) Â  Â Â </span></code><code><span leaf=""><span># forcats ç”¨äºå¤„ç†å› å­å˜é‡ï¼Œä¾‹å¦‚é‡æ–°æ’åºã€åˆå¹¶ç­‰</span></span></code><code><span leaf="">library(forcats) Â  Â Â </span></code><code><span leaf=""><span># RColorBrewer ç”¨äºæä¾›é¢œè‰²è°ƒè‰²æ¿ï¼Œæ–¹ä¾¿åœ¨å›¾è¡¨ä¸­ä½¿ç”¨ä¸åŒé¢œè‰²</span></span></code><code><span leaf="">library(RColorBrewer)Â </span></code><code><span leaf=""><span># emmeans ç”¨äºè®¡ç®—ä¼°è®¡è¾¹é™…å‡å€¼ï¼Œè¿›è¡Œç»Ÿè®¡åˆ†æ</span></span></code><code><span leaf="">library(emmeans) Â  Â Â </span></code><code><span leaf=""><span># cowplot ç”¨äºç»„åˆå¤šä¸ª ggplot å›¾è¡¨</span></span></code><code><span leaf="">library(cowplot) Â  Â Â </span></code><code><span leaf=""><span>## åŠ è½½æ•°æ® --------------------------------------</span></span></code><code><span leaf=""><span># å®šä¹‰ç»†èƒç±»å‹</span></span></code><code><span leaf="">cell_type =Â <span>'T_NK'</span></span></code><code><span leaf=""><span># æ„å»ºæ•°æ®æ–‡ä»¶è·¯å¾„</span></span></code><code><span leaf="">data_file = paste0(<span>'path/'</span>,cell_type,<span>'/'</span>,cell_type,<span>'_for_seurat_metadata.csv'</span>)</span></code><code><span leaf=""><span># è¯»å– CSV æ–‡ä»¶ï¼Œå°†ç¬¬ä¸€è¡Œä½œä¸ºåˆ—å</span></span></code><code><span leaf="">cell_data_tbl &lt;- read.csv(data_file, header = TRUE)</span></code><code><span leaf=""><span># å°†æ•°æ®æ¡†çš„ç¬¬ä¸€åˆ—è®¾ç½®ä¸ºè¡Œå</span></span></code><code><span leaf="">rownames(cell_data_tbl) &lt;- as.vector(as.matrix(cell_data_tbl[,Â <span>1</span>]))</span></code><code><span leaf=""><span># å‡†å¤‡ barcode åˆ—å¹¶ç§»é™¤ç¬¬ä¸€åˆ—ï¼ˆID åˆ—ï¼‰</span></span></code><code><span leaf="">cell_data_tbl<span>$barcode</span>Â &lt;- cell_data_tbl[,Â <span>1</span>]</span></code><code><span leaf="">cell_data_tbl &lt;- cell_data_tbl[, -<span>1</span>]</span></code><code><span leaf=""><span>## åˆå¹¶å’Œç­›é€‰æ•°æ®</span></span></code><code><span leaf="">cell_data_tbl &lt;- cell_data_tbl %&gt;%Â </span></code><code><span leaf="">Â Â <span># åˆ›å»ºæ–°åˆ— cell_typeï¼Œå…¶å€¼ä¸ cluster_2 åˆ—ç›¸åŒ</span></span></code><code><span leaf="">Â  mutate(cell_type = cluster_2) %&gt;%Â </span></code><code><span leaf="">Â Â <span># åˆ›å»ºæ–°åˆ— patient_idï¼Œå…¶å€¼ä¸ sample_CD45 åˆ—ç›¸åŒ</span></span></code><code><span leaf="">Â  mutate(</span></code><code><span leaf="">Â  Â  patient_id = sample_CD45, Â  Â  Â  Â  Â <span># æ˜ å°„ sample_CD45 åˆ° patient_id</span></span></code><code><span leaf="">Â  Â  tumor_category =Â <span>group</span>, Â  Â  Â  Â  Â  Â <span># å°† group é‡å‘½åä¸º tumor_category</span></span></code><code><span leaf="">Â  Â  cell_identifier = barcode Â  Â  Â  Â  Â <span># å°† barcode é‡å‘½åä¸º cell_identifier</span></span></code><code><span leaf="">Â  )</span></code><code><span leaf=""><span># å†æ¬¡åˆ›å»ºæ–°åˆ—ï¼Œè¿™é‡Œéƒ¨åˆ†ä»£ç é‡å¤ï¼Œå¯èƒ½æ˜¯ä¸ºäº†åç»­ä¿®æ”¹æ–¹ä¾¿</span></span></code><code><span leaf="">cell_data_tbl &lt;- cell_data_tbl %&gt;%Â </span></code><code><span leaf="">Â  mutate(cell_type = cluster_2) %&gt;%Â </span></code><code><span leaf="">Â  mutate(patient_id = sample_CD45) %&gt;%Â </span></code><code><span leaf="">Â Â <span># Â mutate(patient_id = sample) %&gt;%Â </span></span></code><code><span leaf="">Â  mutate(tumor_type =Â <span>group</span>) %&gt;%Â </span></code><code><span leaf="">Â  mutate(cell_id = barcode)Â </span></code><code><span leaf=""><span># æŒ‰æ‚£è€…ã€è‚¿ç˜¤ç±»å‹å’Œç»†èƒç±»å‹æ±‡æ€»æ•°æ®</span></span></code><code><span leaf="">cell_summary_tbl &lt;- cell_data_tbl %&gt;%</span></code><code><span leaf="">Â  mutate(cell_type = cluster_2) %&gt;%</span></code><code><span leaf="">Â Â <span># æŒ‰ patient_idã€tumor_category å’Œ cell_type åˆ†ç»„</span></span></code><code><span leaf="">Â  group_by(patient_id, tumor_category, cell_type) %&gt;%</span></code><code><span leaf="">Â Â <span># è®¡ç®—æ¯ä¸ªç»„ä¸­å”¯ä¸€ cell_identifier çš„æ•°é‡</span></span></code><code><span leaf="">Â  summarize(cell_type_count = n_distinct(cell_identifier)) %&gt;%Â </span></code><code><span leaf="">Â Â <span># è®¡ç®—å…¶ä»–ç»†èƒç±»å‹çš„æ•°é‡</span></span></code><code><span leaf="">Â  mutate(</span></code><code><span leaf="">Â  Â  other_cell_count = sum(cell_type_count) - cell_type_count, Â <span># è®¡ç®—å…¶ä»–ç»†èƒç±»å‹çš„æ•°é‡</span></span></code><code><span leaf="">Â  Â  total_cell_count = sum(cell_type_count), Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># è®¡ç®—æ€»ç»†èƒæ•°é‡</span></span></code><code><span leaf="">Â  Â  cell_type_fraction = cell_type_count / total_cell_count *Â <span>100</span>Â <span># è®¡ç®—æ¯ç§ç»†èƒç±»å‹çš„æ¯”ä¾‹</span></span></code><code><span leaf="">Â  ) %&gt;%</span></code><code><span leaf="">Â Â <span># å–æ¶ˆåˆ†ç»„</span></span></code><code><span leaf="">Â  ungroup()</span></code><code><span leaf=""><span># å®šä¹‰çƒ­åŠ›å›¾çš„å›¾å±‚æ ·å¼ï¼Œç”¨äºç»Ÿä¸€é£æ ¼</span></span></code><code><span leaf="">heatmap_elements &lt;- list(</span></code><code><span leaf="">Â Â <span># è®¾ç½®å¡«å……é¢œè‰²çš„æ‰‹åŠ¨æ˜ å°„</span></span></code><code><span leaf="">Â  scale_fill_manual(values = c(scales::muted(<span>"blue"</span>), scales::muted(<span>"red"</span>),Â <span>"grey10"</span>)),</span></code><code><span leaf="">Â Â <span># è®¾ç½®åæ ‡è½´æ–‡æœ¬ã€åˆ»åº¦ã€çº¿æ¡å’Œæ ‡é¢˜çš„æ ·å¼</span></span></code><code><span leaf="">Â  theme(axis.text.x = element_text(angle =Â <span>90</span>, hjust =Â <span>1</span>, vjust =Â <span>0.5</span>),</span></code><code><span leaf="">Â  Â  Â  Â  axis.ticks = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  axis.line = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  axis.title = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  plot.margin = margin(<span>0</span>,Â <span>0</span>,Â <span>0</span>,Â <span>0</span>),</span></code><code><span leaf="">Â  Â  Â  Â  strip.text = element_blank())</span></code><code><span leaf="">)</span></code><code><span leaf=""><span>## ç»†èƒç±»å‹å¹¿ä¹‰çº¿æ€§æ¨¡å‹ {.tabset}</span></span></code><code><span leaf=""><span># åˆ›å»ºç©ºåˆ—è¡¨ç”¨äºå­˜å‚¨æ•°æ®ã€æ¨¡å‹å…¬å¼ã€æ¨¡å‹å’Œä¼°è®¡è¾¹é™…å‡å€¼ç»“æœ</span></span></code><code><span leaf="">data_storage &lt;- list()</span></code><code><span leaf="">model_formulas &lt;- list()</span></code><code><span leaf="">model_list &lt;- list()</span></code><code><span leaf="">emmeans_results &lt;- list()</span></code><code><span leaf=""><span># å‡†å¤‡å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGLMï¼‰çš„æ•°æ®å’Œæ¨¡å‹</span></span></code><code><span leaf="">data_storage[[<span>"cellData"</span>]] &lt;- cell_summary_tbl</span></code><code><span leaf=""><span># å®šä¹‰æ¨¡å‹å…¬å¼ï¼Œä»¥ cell_type_count å’Œ other_cell_count ä¸ºå“åº”å˜é‡ï¼Œcell_type å’Œ tumor_category ä¸ºè§£é‡Šå˜é‡</span></span></code><code><span leaf="">model_formulas[[<span>"cellData"</span>]] &lt;- cbind(cell_type_count, other_cell_count) ~ cell_type * tumor_category</span></code><code><span leaf=""><span># æ‹Ÿåˆå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œä½¿ç”¨äºŒé¡¹åˆ†å¸ƒå’Œå¯¹æ•°é“¾æ¥å‡½æ•°</span></span></code><code><span leaf="">model_list[[<span>"cellData"</span>]] &lt;- glm(formula = model_formulas[[<span>"cellData"</span>]], family = binomial(link =Â <span>'logit'</span>),Â <span>data</span>Â = data_storage[[<span>"cellData"</span>]])</span></code><code><span leaf=""><span># è®¡ç®—ä¼°è®¡è¾¹é™…å‡å€¼å¹¶è¿›è¡Œæˆå¯¹æ¯”è¾ƒ</span></span></code><code><span leaf="">emmeans_results[[<span>"cellData"</span>]] &lt;- emmeans(model_list[[<span>"cellData"</span>]], specs = pairwise ~ tumor_category | cell_type,Â <span>type</span>Â =Â <span>"response"</span>, tran =Â <span>"logit"</span>, adjust =Â <span>"bonferroni"</span>)</span></code><code><span leaf=""><span># å°†å¯¹æ¯”ç»“æœè½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf="">odds_ratios &lt;- as.data.frame(summary(emmeans_results[[<span>"cellData"</span>]])<span>$contrasts</span>)</span></code><code><span leaf=""><span># é‡æ–°å®šä¹‰æ•°æ®ç”¨äºè¿›ä¸€æ­¥åˆ†æ</span></span></code><code><span leaf="">data_storage[[<span>"cellData"</span>]] &lt;- cell_summary_tbl</span></code><code><span leaf="">model_formulas[[<span>"cellData"</span>]] &lt;- cbind(cell_type_count, other_cell_count) ~ cell_type * tumor_category</span></code><code><span leaf="">model_list[[<span>"cellData"</span>]] &lt;- glm(formula = model_formulas[[<span>"cellData"</span>]], family = binomial(link =Â <span>'logit'</span>),Â <span>data</span>Â = data_storage[[<span>"cellData"</span>]])</span></code><code><span leaf=""><span># ä»¥ä¸åŒçš„è§„æ ¼ä¼°è®¡è¾¹é™…å‡å€¼</span></span></code><code><span leaf="">emmeans_results[[<span>"cellData"</span>]] &lt;- emmeans(model_list[[<span>"cellData"</span>]], specs = eff ~ tumor_category | cell_type * tumor_category,Â <span>type</span>Â =Â <span>"response"</span>, tran =Â <span>"logit"</span>, adjust =Â <span>"bonferroni"</span>)</span></code><code><span leaf=""><span># å°†å¯¹æ¯”ç»“æœè½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf="">odds_ratios &lt;- emmeans_results[[<span>"cellData"</span>]]<span>$contrasts</span>Â %&gt;%</span></code><code><span leaf="">Â  rbind() %&gt;%</span></code><code><span leaf="">Â  as.data.frame()</span></code><code><span leaf=""><span># å‡†å¤‡ç»˜å›¾æ•°æ®</span></span></code><code><span leaf="">plot_data &lt;- bind_rows(odds_ratios %&gt;% add_column(contrast_variable =Â <span>"Signature"</span>)) %&gt;%</span></code><code><span leaf="">Â Â <span># å¤„ç† p å€¼ï¼Œé˜²æ­¢è¿‡å°çš„å€¼</span></span></code><code><span leaf="">Â  mutate(p.value = ifelse(p.value &lt;Â <span>1</span>E<span>-50</span>,Â <span>1</span>E<span>-50</span>, p.value)) %&gt;%</span></code><code><span leaf="">Â Â <span># ç§»é™¤å¯¹æ¯”åç§°ä¸­çš„ " effect"</span></span></code><code><span leaf="">Â  mutate(contrast = str_remove(contrast,Â <span>" effect"</span>)) %&gt;%</span></code><code><span leaf="">Â Â <span># è®¡ç®—å¯¹æ•°ä¼˜åŠ¿æ¯”</span></span></code><code><span leaf="">Â  mutate(log2.odds.ratio = log2(odds.ratio)) %&gt;%</span></code><code><span leaf="">Â Â <span># é™åˆ¶å¯¹æ•°ä¼˜åŠ¿æ¯”çš„èŒƒå›´</span></span></code><code><span leaf="">Â  mutate(log2.odds.ratio = ifelse(log2.odds.ratio &gt;Â <span>0.5</span>,Â <span>0.5</span>, log2.odds.ratio),</span></code><code><span leaf="">Â  Â  Â  Â  Â log2.odds.ratio = ifelse(log2.odds.ratio &lt;Â <span>-0</span>.<span>5</span>,Â <span>-0</span>.<span>5</span>, log2.odds.ratio))</span></code><code><span leaf=""><span>## è‡ªå®šä¹‰å› å­çš„æ’åº</span></span></code><code><span leaf=""><span># å®šä¹‰ç»†èƒç±»å‹çš„æ’åºé¡ºåº</span></span></code><code><span leaf="">cell_type_order &lt;- c(<span>"CD8_T_effector_memory_01"</span>,Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD8_T_naive_01"</span>,Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD8_T_cytotoxic_02"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD8_T_late_exhausted_01"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD8_T_ISG"</span>,</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Cycling_CD4_T"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Cycling_CD8_T"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Cycling_NK"</span>,</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_fh_01_00"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_naive_1_01"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_naive_2_03"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_early_exhausted_06"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_late_exhausted_08"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_ISG"</span>,</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_naive_07"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_1_04"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_2_05"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_3_10"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_exhausted_01_02"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_exhausted_02_09"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"CD4_T_reg_ISG"</span>,</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"NKT_1_00"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"NKT_2_02"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"NK_cytotoxic_04"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"NK_reg_CRTAM_03"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"NK_reg_KRT86_01"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"dg_T_05"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"ILC_06"</span>)</span></code><code><span leaf=""><span># å°† plot_data ä¸­çš„ cell_type åˆ—è½¬æ¢ä¸ºå› å­ï¼Œå¹¶æŒ‰ç…§å®šä¹‰çš„é¡ºåºæ’åº</span></span></code><code><span leaf="">plot_data<span>$cell_type</span>Â &lt;- factor(plot_data<span>$cell_type</span>, levels = cell_type_order)</span></code><code><span leaf=""><span># æŒ‰ cell_type åˆ—æ’åº plot_data</span></span></code><code><span leaf="">plot_data &lt;- plot_data[<span>order</span>(<span>plot_data</span><span>$cell_type</span>),]</span></code><code><span leaf=""><span># å®šä¹‰å¯¹æ¯”çš„æ’åºé¡ºåº</span></span></code><code><span leaf="">contrast_order &lt;- c(<span>"mature"</span>,Â <span>"immature"</span>,Â <span>"none"</span>)</span></code><code><span leaf=""><span># å°† plot_data ä¸­çš„ contrast åˆ—è½¬æ¢ä¸ºå› å­ï¼Œå¹¶æŒ‰ç…§å®šä¹‰çš„é¡ºåºæ’åº</span></span></code><code><span leaf="">plot_data<span>$contrast</span>Â &lt;- factor(plot_data<span>$contrast</span>, levels = contrast_order)</span></code><code><span leaf=""><span># æŒ‰ contrast åˆ—æ’åº plot_data</span></span></code><code><span leaf="">plot_data &lt;- plot_data[<span>order</span>(<span>plot_data</span><span>$contrast</span>),]</span></code><code><span leaf=""><span># åˆ›å»ºå¯¹æ•°ä¼˜åŠ¿æ¯”çš„ä¸»å›¾</span></span></code><code><span leaf="">p_odds_ratio &lt;- ggplot(plot_data, aes(x = cell_type, y = forcats::fct_rev(contrast), color = log2.odds.ratio, size =Â <span>-log10</span>(p.value))) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ æ•£ç‚¹å›¾å±‚</span></span></code><code><span leaf="">Â  geom_point() +</span></code><code><span leaf="">Â Â <span># è®¾ç½®é¢œè‰²æ¸å˜</span></span></code><code><span leaf="">Â  scale_color_gradientn(</span></code><code><span leaf="">Â  Â  colors = rev(brewer.pal(<span>9</span>,Â <span>"RdBu"</span>)),</span></code><code><span leaf="">Â  Â  limits = c(<span>-0</span>.<span>5</span>,Â <span>0.5</span>),</span></code><code><span leaf="">Â  Â  labels = c(<span>"â‰¤-0.5"</span>,Â <span>0</span>,Â <span>"â‰¥0.5"</span>),</span></code><code><span leaf="">Â  Â  breaks = c(<span>-0</span>.<span>5</span>,Â <span>0</span>,Â <span>0.5</span>)</span></code><code><span leaf="">Â  ) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å¤§å°æ¯”ä¾‹</span></span></code><code><span leaf="">Â  scale_size_continuous(</span></code><code><span leaf="">Â  Â  limits = c(<span>0</span>,Â <span>50</span>),</span></code><code><span leaf="">Â  Â  breaks = c(<span>0</span>,Â <span>25</span>,Â <span>50</span>),</span></code><code><span leaf="">Â  Â  labels = c(<span>0</span>,Â <span>25</span>,Â <span>50</span>)</span></code><code><span leaf="">Â  ) +</span></code><code><span leaf="">Â Â <span># è®¾ç½® x è½´ç¦»æ•£å˜é‡ä¸ä¸¢å¼ƒç¼ºå¤±å€¼</span></span></code><code><span leaf="">Â  scale_x_discrete(drop = FALSE) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®ä¸»é¢˜æ ·å¼</span></span></code><code><span leaf="">Â  theme(</span></code><code><span leaf="">Â  Â  axis.line = element_blank(),</span></code><code><span leaf="">Â  Â  axis.text.x = element_blank(),</span></code><code><span leaf="">Â  Â  axis.text.y = element_blank(),</span></code><code><span leaf="">Â  Â  axis.ticks = element_blank(),</span></code><code><span leaf="">Â  Â  legend.title = element_text(size =Â <span>14</span>),</span></code><code><span leaf="">Â  Â  legend.direction =Â <span>"vertical"</span>,</span></code><code><span leaf="">Â  Â  legend.position =Â <span>"top"</span>,</span></code><code><span leaf="">Â  Â  legend.box =Â <span>"vertical"</span>,</span></code><code><span leaf="">Â  Â  legend.box.just =Â <span>"left"</span>,</span></code><code><span leaf="">Â  Â  panel.background = element_blank(),</span></code><code><span leaf="">Â  Â  panel.border = element_blank(),</span></code><code><span leaf="">Â  Â  panel.grid.major = element_blank(),</span></code><code><span leaf="">Â  Â  panel.grid.minor = element_blank(),</span></code><code><span leaf="">Â  Â  plot.title = element_text(face =Â <span>"plain"</span>, size =Â <span>14</span>),</span></code><code><span leaf="">Â  Â  strip.background = element_blank(),</span></code><code><span leaf="">Â  Â  strip.text.x = element_blank()</span></code><code><span leaf="">Â  ) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å›¾ä¾‹æ ·å¼</span></span></code><code><span leaf="">Â  guides(color = guide_colourbar(title.position=<span>"top"</span>, title.hjust =Â <span>0.5</span>, title.vjust =Â <span>0</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â size = guide_legend(title.position=<span>"top"</span>, title.hjust =Â <span>0.5</span>, title.vjust =Â <span>0</span>)) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å›¾è¡¨æ ‡é¢˜å’Œåæ ‡è½´æ ‡ç­¾</span></span></code><code><span leaf="">Â  labs(title = NULL, x = NULL, y = NULL, color =Â <span>'log2(odds ratio)'</span>, size =Â <span>"\n-log10(p value)"</span>) +</span></code><code><span leaf="">Â Â <span># æŒ‰ cell_type è¿›è¡Œåˆ†é¢</span></span></code><code><span leaf="">Â  facet_grid(. ~ cell_type, scales =Â <span>"free_x"</span>, space =Â <span>"free"</span>)</span></code><code><span leaf=""><span># åˆ›å»ºç­¾åçš„æ³¨é‡Šå›¾</span></span></code><code><span leaf="">p_signature_site_anno &lt;- ggplot(plot_data %&gt;% distinct(contrast, .keep_all = TRUE)) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ çŸ©å½¢å›¾å±‚</span></span></code><code><span leaf="">Â  geom_tile(aes(x =Â <span>0</span>, y = forcats::fct_rev(contrast), fill = contrast)) +</span></code><code><span leaf="">Â Â <span># åº”ç”¨çƒ­åŠ›å›¾æ ·å¼</span></span></code><code><span leaf="">Â  heatmap_elements +</span></code><code><span leaf="">Â Â <span># è®¾ç½®åæ ‡è½´æ–‡æœ¬å’Œæ ‡é¢˜æ ·å¼</span></span></code><code><span leaf="">Â  theme(axis.text.x = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  axis.title.x = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  axis.title.y = element_blank(),</span></code><code><span leaf="">Â  Â  Â  Â  strip.text = element_blank()) +</span></code><code><span leaf="">Â Â <span># ä¸æ˜¾ç¤ºå¡«å……å›¾ä¾‹</span></span></code><code><span leaf="">Â  guides(fill =Â <span>"none"</span>)</span></code><code><span leaf=""><span># åˆ›å»ºç»†èƒç±»å‹çš„é¢œè‰²è°ƒè‰²æ¿</span></span></code><code><span leaf="">color_palette &lt;- brewer.pal(<span>11</span>,Â <span>"Spectral"</span>)Â <span># è·å–ä¸€ä¸ªåŒ…å« 11 ç§é¢œè‰²çš„è°ƒè‰²æ¿</span></span></code><code><span leaf="">color_palette &lt;- rep(color_palette, each =Â <span>3</span>)</span></code><code><span leaf=""><span># åˆ›å»ºç»†èƒç±»å‹çš„æ³¨é‡Šå›¾</span></span></code><code><span leaf="">p_cluster_anno &lt;- ggplot(plot_data %&gt;% distinct(cell_type, .keep_all = TRUE) %&gt;% mutate(facet_helper =Â <span>""</span>)) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ çŸ©å½¢å›¾å±‚</span></span></code><code><span leaf="">Â  geom_tile(aes(cell_type, facet_helper, fill = cell_type)) +</span></code><code><span leaf="">Â Â <span># åº”ç”¨çƒ­åŠ›å›¾æ ·å¼</span></span></code><code><span leaf="">Â  heatmap_elements +</span></code><code><span leaf="">Â Â <span># è®¾ç½® x è½´ç¦»æ•£å˜é‡ä¸ä¸¢å¼ƒç¼ºå¤±å€¼</span></span></code><code><span leaf="">Â  scale_x_discrete(drop = FALSE) +</span></code><code><span leaf="">Â Â <span># æŒ‰ facet_helper è¿›è¡Œåˆ†é¢</span></span></code><code><span leaf="">Â  facet_grid(~facet_helper, scales =Â <span>"free"</span>, space =Â <span>"free"</span>) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®åæ ‡è½´æ–‡æœ¬å’Œæ ‡é¢˜æ ·å¼</span></span></code><code><span leaf="">Â  theme(axis.text.y = element_blank(), strip.text = element_blank()) +</span></code><code><span leaf="">Â Â <span># ä¸æ˜¾ç¤ºå¡«å……å›¾ä¾‹</span></span></code><code><span leaf="">Â  guides(fill =Â <span>"none"</span>) +Â </span></code><code><span leaf="">Â Â <span># è®¾ç½®å¡«å……é¢œè‰²çš„æ‰‹åŠ¨æ˜ å°„</span></span></code><code><span leaf="">Â  scale_fill_manual(values = color_palette)</span></code><code><span leaf=""><span># ç»„åˆå›¾è¡¨</span></span></code><code><span leaf="">p_left &lt;- plot_grid(</span></code><code><span leaf="">Â  p_signature_site_anno + theme(plot.margin = margin(t =Â <span>6</span>,Â <span>r</span>Â =Â <span>0</span>, b =Â <span>0</span>, l =Â <span>6</span>)),</span></code><code><span leaf="">Â  ggdraw(),</span></code><code><span leaf="">Â  nrow =Â <span>2</span>,</span></code><code><span leaf="">Â  align =Â <span>"hv"</span>,</span></code><code><span leaf="">Â  axis =Â <span>"tbr"</span>,</span></code><code><span leaf="">Â  rel_heights = c(<span>1</span>,Â <span>0.7</span>),</span></code><code><span leaf="">Â  rel_widths = c(<span>0.75</span>,Â <span>1</span>)</span></code><code><span leaf="">)</span></code><code><span leaf="">p_right &lt;- plot_grid(</span></code><code><span leaf="">Â  p_odds_ratio + theme(legend.position =Â <span>"none"</span>, plot.margin = margin(t =Â <span>0</span>,Â <span>r</span>Â =Â <span>6</span>, b =Â <span>0</span>, l =Â <span>0</span>)),</span></code><code><span leaf="">Â  p_cluster_anno + theme(plot.margin = margin(t =Â <span>0</span>,Â <span>r</span>Â =Â <span>6</span>, b =Â <span>6</span>, l =Â <span>6</span>)),</span></code><code><span leaf="">Â  nrow =Â <span>2</span>,</span></code><code><span leaf="">Â  align =Â <span>"v"</span>,</span></code><code><span leaf="">Â  axis =Â <span>"lr"</span>,</span></code><code><span leaf="">Â  rel_heights = c(<span>1</span>,Â <span>0.7</span>),</span></code><code><span leaf="">Â  rel_widths = c(<span>0.75</span>,Â <span>1</span>)</span></code><code><span leaf="">)</span></code><code><span leaf="">p_cell_glm_result &lt;- plot_grid(</span></code><code><span leaf="">Â  plot_grid(</span></code><code><span leaf="">Â  Â  p_left,</span></code><code><span leaf="">Â  Â  p_right,</span></code><code><span leaf="">Â  Â  nrow =Â <span>1</span>,</span></code><code><span leaf="">Â  Â  align =Â <span>"hv"</span>,</span></code><code><span leaf="">Â  Â  axis =Â <span>"tblr"</span>,</span></code><code><span leaf="">Â  Â  rel_widths = c(<span>0.5</span>,Â <span>1</span>)</span></code><code><span leaf="">Â  ),</span></code><code><span leaf="">Â  get_legend(p_odds_ratio),</span></code><code><span leaf="">Â  ncol =Â <span>1</span>,</span></code><code><span leaf="">Â  rel_heights = c(<span>1</span>,Â <span>0.15</span>)</span></code><code><span leaf="">)</span></code><code><span leaf=""><span># æ˜¾ç¤ºæœ€ç»ˆç»„åˆçš„å›¾è¡¨</span></span></code><code><span leaf="">p_cell_glm_result</span></code><code><span leaf=""><span># ä¿å­˜æœ€ç»ˆç»„åˆçš„å›¾è¡¨ä¸º PDF æ–‡ä»¶</span></span></code><code><span leaf="">ggsave(<span>"path/to/figures/cluster_dot_plot.pdf"</span>, plot = p_cell_glm_result)</span></code><code><span leaf=""><span># å°†æ•°æ®è½¬æ¢ä¸º data.table æ ¼å¼ï¼Œä»¥å¤‡åç»­ä½¿ç”¨</span></span></code><code><span leaf="">data.table(plot_data)</span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/v_zsGcA2bFerpEGHQXwOhw",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
