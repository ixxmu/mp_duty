---
title: "绘图技巧 | ggview包预览不同尺寸下ggplot2输出效果"
date: 2025-05-14T07:34:55Z
draft: ["false"]
tags: [
  "fetched",
  "被炸熟的虾"
]
categories: ["Acdemic"]
---
绘图技巧 | ggview包预览不同尺寸下ggplot2输出效果 by 被炸熟的虾
------
<div><p data-pm-slice="0 0 []"><span leaf="">经常使用</span><span leaf="">R</span><span leaf="">语言绘图的大家一定都会碰到一个烦恼——保存图片时，经常需要反复调整输出图片的尺寸（长宽比）才能满足我们的要求。输出，打开文件，查看图片，再重新改代码，再输出，再打开文件</span><span leaf="">......</span><span leaf="">工作的耐心与出图的喜悦往往就在这一次次调整中湮灭<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/Expression/Expression_26@2x.png" data-ratio="1" data-w="20" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/Expression/Expression_26@2x.png">。</span></p><p><span leaf="">这里我们分享一个很有意思的</span><span leaf="">R</span><span leaf="">包</span><code><span leaf=""><span textstyle="">ggview</span></span><span leaf="">，它可以在</span></code><span leaf="">RStudio</span><span leaf="">的界面中准确预览</span><span leaf="">不同尺寸下</span><code><span leaf=""><span textstyle="">ggplot2</span></span></code><span leaf="">生成图片的效果，等到其完全符合我们的预期再将图片导出，避免了重复的试错过程。作者</span><span leaf="">github</span><span leaf="">网站上有一个很生动的动图示例——</span></p><section nodeleaf=""><img data-imgfileid="100007300" data-ratio="0.44375" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchcTM8kUjsAOlsibPKJ92FWVGb31husAUcIgsXNwEKUfqsSFfyWW1wiavA/640?wx_fmt=gif&amp;from=appmsg" data-w="800" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchcTM8kUjsAOlsibPKJ92FWVGb31husAUcIgsXNwEKUfqsSFfyWW1wiavA/640?wx_fmt=gif&amp;from=appmsg"></section><pre><code><span leaf="">install.packages(</span><span><span leaf="">"ggview"</span></span><span leaf="">)  </span><span leaf=""><br></span><span><span leaf="">#remotes::install_github("idmn/ggview")</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggview)</span><span leaf=""><br></span></code></pre><p><span leaf="">使用一个富集分析条形图作为示例：</span></p><p><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchVP3gzegngjZSXiabmqVQGskXctyac3fvJ91BEibnKQfN5tlh9Cl5FCgQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.661697247706422" data-s="300,640" data-type="png" data-w="872" type="block" data-imgfileid="100007296" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchVP3gzegngjZSXiabmqVQGskXctyac3fvJ91BEibnKQfN5tlh9Cl5FCgQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p><span leaf="">使用</span><code><span leaf=""><span textstyle="">canvas</span></span></code><span leaf="">函数设置画布大小并预览：</span></p><pre><code><span leaf="">canvas(</span><span leaf=""><br></span><span leaf="">  width,</span><span leaf=""><br></span><span leaf="">  height,</span><span leaf=""><br></span><span leaf="">  units = c(</span><span><span leaf="">"in"</span></span><span leaf="">, </span><span><span leaf="">"cm"</span></span><span leaf="">, </span><span><span leaf="">"mm"</span></span><span leaf="">, </span><span><span leaf="">"px"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">  dpi = </span><span><span leaf="">300</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  scale = </span><span><span leaf="">1</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  bg = </span><span><span leaf="">"white"</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p><span leaf=""><span textstyle="">主要参数：</span></span><code><span leaf=""><br></span></code></p><ul><li><p><code><span leaf=""><span textstyle="">width</span></span></code><span leaf="">：用于指定图形输出时的宽度。</span></p></li></ul><ul><li><p><code><span leaf=""><span textstyle="">height</span></span></code><span leaf="">：用于指定图形输出时的高度。</span><code><span leaf=""><br></span></code></p></li><li><p><code><span leaf=""><span textstyle="">units</span></span></code><span leaf="">：设置画布尺寸的单位。常见的单位有</span><span leaf=""><span textstyle="">"px"</span></span><span leaf="">（像素）、</span><span leaf=""><span textstyle="">"cm"</span></span><span leaf="">（厘米）、</span><span leaf=""><span textstyle="">"in"</span></span><span leaf="">（英寸）等。例如，如果你想设置画布宽度为</span><span leaf="">8</span><span leaf="">厘米、高度为</span><span leaf="">6</span><span leaf="">厘米，可以写成</span><code><span leaf=""><span textstyle="">canvas(width = 8, height = 6, units = "cm")</span></span></code><span leaf="">。</span><strong><code><span leaf=""><br></span></code></strong></p></li><li><p><strong><code><span leaf=""><span textstyle="">dpi</span></span></code><span leaf="">（可选）</span></strong><span leaf="">：设置图形的分辨率，即每英寸的像素数。较高的</span><span leaf="">dpi</span><span leaf="">值可以使图形在高分辨率设备上显示更清晰，或者在打印时质量更高。例如，</span><code><span leaf=""><span textstyle="">canvas(width = 8, height = 6, units = "in", dpi = 300)</span></span></code><span leaf="">表示以</span><span leaf="">300dpi</span><span leaf="">的分辨率创建一个</span><span leaf="">8×6</span><span leaf="">英寸的画布。</span><strong><code><span leaf=""><br></span></code></strong></p></li><li><p><strong><code><span leaf=""><span textstyle="">scale</span></span></code><span leaf="">（可选）</span></strong><span leaf="">：设置图形的缩放因子。用于调整图形的整体比例。例如，</span><span leaf=""><span textstyle="">scale = 2</span></span><span leaf="">表示图形在画布上按两倍大小显示，这可能会影响字体大小、线条粗细等元素的视觉效果。</span><strong><code><span leaf=""><br></span></code></strong></p></li><li><p><strong><code><span leaf=""><span textstyle="">bg</span></span></code><span leaf="">（可选）</span></strong><span leaf="">：设置画布的背景颜色。例如</span><code><span leaf=""><span textstyle="">canvas(bg = "lightgray")</span></span></code><span leaf="">会创建一个浅灰色背景的画布。</span></p></li></ul><pre><code><span><span leaf="">##默认尺寸</span></span><span leaf=""><br></span><span leaf="">p2 + canvas(width = </span><span><span leaf="">7</span></span><span leaf="">, height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">##调整尺寸</span></span><span leaf=""><br></span><span leaf="">p2 + canvas(width = </span><span><span leaf="">7</span></span><span leaf="">, height = </span><span><span leaf="">5</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p2 + canvas(width = </span><span><span leaf="">10</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p2 + canvas(width = </span><span><span leaf="">8</span></span><span leaf="">,height = </span><span><span leaf="">6</span></span><span leaf="">)</span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchUbLib8xaGGnDGdsib0zrqHL109niaD7BvWZVPyDIgzYOslvyHvb94xk0g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5925925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100007295" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchUbLib8xaGGnDGdsib0zrqHL109niaD7BvWZVPyDIgzYOslvyHvb94xk0g/640?wx_fmt=png&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span leaf="">可以看到</span><span leaf="">10X7</span><span leaf="">的效果不错，那直接保存就好。</span></p><pre><code><span leaf="">pdf(</span><span><span leaf="">"p2.pdf"</span></span><span leaf="">,width = </span><span><span leaf="">10</span></span><span leaf="">,height = </span><span><span leaf="">7</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p2</span><span leaf=""><br></span><span leaf="">dev.off()</span><span leaf=""><br></span></code></pre><p><span leaf="">如果涉及到拼图后输出，那更加建议预先测试调整一下<img data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/2_04.png" data-ratio="1" data-w="20" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/2_04.png">：</span></p><pre><code><span><span leaf="">library</span></span><span leaf="">(patchwork)</span><span leaf=""><br></span><span leaf="">p1 + p2</span><span leaf=""><br></span><span leaf="">p1 + p2 + canvas(width = </span><span><span leaf="">12</span></span><span leaf="">, height = </span><span><span leaf="">7</span></span><span leaf="">)</span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchdPgNU3K0W5qPjwiaNLKWdxJIwKiaUiab1Dwib3ibdXMvqJ82qeTYicdOmUFw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6466512702078522" data-s="300,640" data-type="png" data-w="866" type="block" data-imgfileid="100007298" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAchdPgNU3K0W5qPjwiaNLKWdxJIwKiaUiab1Dwib3ibdXMvqJ82qeTYicdOmUFw/640?wx_fmt=png&amp;from=appmsg"></section><pre><code><span leaf="">p1 + p2 + canvas(width = </span><span><span leaf="">18</span></span><span leaf="">, height = </span><span><span leaf="">7</span></span><span leaf="">)</span></code></pre><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAch0WEW3AOBe6w9UcDmM6icjuwNBScAAurx66YcTt39HfIMIibbdJ5m3m7A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6658986175115207" data-s="300,640" data-type="png" data-w="868" type="block" data-imgfileid="100007299" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dRYYdqiaan3K1HciaEgiazjicI3jz6P4JAch0WEW3AOBe6w9UcDmM6icjuwNBScAAurx66YcTt39HfIMIibbdJ5m3m7A/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-pm-slice="0 0 []"><span leaf=""><br></span></h3><h3 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">参考文章：</span></span></h3><p><strong><span leaf="">1、https://github.com/idmn/ggview</span></strong></p><p><strong><span leaf="">2、生信小鸽：<a href="https://mp.weixin.qq.com/s?__biz=Mzg5MDg5NDg4NA==&amp;mid=2247483919&amp;idx=1&amp;sn=9f3c5ab834a267fba9db586fcf967a14&amp;scene=21#wechat_redirect" textvalue="" target="_blank" linktype="text" data-linktype="2">ggview—减少 R 语言图片输出时尺寸设置的试错</a></span></strong></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TdH44v2cGZxillNRMF-0fg",target="_blank" rel="noopener noreferrer">原文链接</a>
