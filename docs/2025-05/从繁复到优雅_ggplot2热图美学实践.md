---
title: "从繁复到优雅-ggplot2热图美学实践"
date: 2025-05-12T09:42:30Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
从繁复到优雅-ggplot2热图美学实践 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">欢迎关注R语言数据分析指南</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">本节来优化一张3年前分享过的组间相关性图，此次对之前代码进行全面的修改与优化，更加的有逻辑图形也更加的清爽。个人观点仅供参考。</span><strong><span leaf="">有需要学习R语言绘图的朋友可关注文末介绍购买小编的R绘图文档。购买前请咨询，零基础不要买。</span></strong></p></blockquote><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">结果图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6IXCDoqklruLOr8Re1ePibUX11wUEj7AJ8Uw0bgfrcibsoIz4wIh3p0qQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.8561797752808988" data-type="png" data-w="890" data-imgfileid="100046170" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6IXCDoqklruLOr8Re1ePibUX11wUEj7AJ8Uw0bgfrcibsoIz4wIh3p0qQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">图形解读</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">作为科研图表中最常见的类型之一，相关性热图广泛应用于展示变量间的相互关系，图意直观明了，信息传达高效。在本次示例中，基于 ggplot2 3.5 版本对绘图代码进行了全面优化，精简了冗余参数，使整体代码结构更为简洁，输出图形也更具美感与实用性。</span><span leaf=""><br></span><span leaf="">优化的重点不仅体现在代码层面，更体现在图形细节的把控——如文本标签的排布、坐标轴的呈现样式、色阶映射的平滑过渡等方面，这些因素共同决定了一张热图的专业程度与可读性。</span></p></blockquote><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">代码展示部分</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(tidyverse)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggh4x)</span><span leaf=""><br></span></code></pre><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据整合</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">r &lt;- read_tsv(</span><span><span leaf="">"Rvalue.tsv"</span></span><span leaf="">) %&gt;%</span><span leaf=""><br></span><span leaf="">  pivot_longer(-ID) %&gt;% dplyr::rename(Rvalue=value)</span><span leaf=""><br></span><span leaf="">p &lt;- read_tsv(</span><span><span leaf="">"Pvalue.tsv"</span></span><span leaf="">) %&gt;% </span><span leaf=""><br></span><span leaf="">  pivot_longer(-ID) %&gt;% dplyr::rename(Pvalue=value)</span><span leaf=""><br></span><span leaf="">g1 &lt;- read_tsv(</span><span><span leaf="">"group.tsv"</span></span><span leaf="">) %&gt;% </span><span leaf=""><br></span><span leaf="">  mutate(group = str_replace(group, </span><span><span leaf="">"\\s"</span></span><span leaf="">, </span><span><span leaf="">"\n"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">g2 &lt;- read_tsv(</span><span><span leaf="">"group2.tsv"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">df &lt;- r %&gt;% left_join(.,p,by=c(</span><span><span leaf="">"ID"</span></span><span leaf="">,</span><span><span leaf="">"name"</span></span><span leaf="">)) %&gt;% </span><span leaf=""><br></span><span leaf="">  mutate(p_signif=symnum(Pvalue,corr = </span><span><span leaf="">FALSE</span></span><span leaf="">, na = </span><span><span leaf="">FALSE</span></span><span leaf="">,  </span><span leaf=""><br></span><span leaf="">                         cutpoints = c(</span><span><span leaf="">0</span></span><span leaf="">, </span><span><span leaf="">0.001</span></span><span leaf="">, </span><span><span leaf="">0.01</span></span><span leaf="">, </span><span><span leaf="">0.05</span></span><span leaf="">, </span><span><span leaf="">0.1</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">), </span><span leaf=""><br></span><span leaf="">                         symbols = c(</span><span><span leaf="">"***"</span></span><span leaf="">, </span><span><span leaf="">"**"</span></span><span leaf="">, </span><span><span leaf="">"*"</span></span><span leaf="">, </span><span><span leaf="">"."</span></span><span leaf="">, </span><span><span leaf="">" "</span></span><span leaf="">))) %&gt;% </span><span leaf=""><br></span><span leaf="">  left_join(.,g1,by=</span><span><span leaf="">"ID"</span></span><span leaf="">) %&gt;% </span><span leaf=""><br></span><span leaf="">  left_join(.,g2,by=</span><span><span leaf="">"name"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">df$group &lt;- factor(df$group,levels = rev(unique(df$group)))</span><span leaf=""><br></span></code></pre><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据可视化</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">df %&gt;% ggplot(.,aes(x=name,y=ID,</span><span leaf=""><br></span><span leaf="">                    col=Rvalue,fill=Rvalue))+</span><span leaf=""><br></span><span leaf="">  geom_tile(color=</span><span><span leaf="">"black"</span></span><span leaf="">,fill=</span><span><span leaf="">"white"</span></span><span leaf="">,size=</span><span><span leaf="">0.3</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  geom_point(aes(size =abs(Rvalue)),shape=</span><span><span leaf="">22</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  geom_text(aes(label=p_signif),size=</span><span><span leaf="">4</span></span><span leaf="">,color=</span><span><span leaf="">"white"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  hjust=</span><span><span leaf="">0.5</span></span><span leaf="">,vjust=</span><span><span leaf="">0.7</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  labs(x = </span><span><span leaf="">NULL</span></span><span leaf="">,y = </span><span><span leaf="">NULL</span></span><span leaf="">)+</span><span leaf=""><br></span><span leaf="">  scale_color_gradientn(colours = (RColorBrewer::brewer.pal(</span><span><span leaf="">11</span></span><span leaf="">,</span><span><span leaf="">"RdBu"</span></span><span leaf="">)))+</span><span leaf=""><br></span><span leaf="">  scale_fill_gradientn(colours = (RColorBrewer::brewer.pal(</span><span><span leaf="">11</span></span><span leaf="">,</span><span><span leaf="">"RdBu"</span></span><span leaf="">))) +</span><span leaf=""><br></span><span leaf="">  theme_test() +</span><span leaf=""><br></span><span leaf="">  themeaxis.text.y=element_text(size = </span><span><span leaf="">8</span></span><span leaf="">,color=ycols),</span><span leaf=""><br></span><span leaf="">        axis.ticks= element_blank(),</span><span leaf=""><br></span><span leaf="">        legend.title = element_blank(),</span><span leaf=""><br></span><span leaf="">        legend.key.height = unit(</span><span><span leaf="">1</span></span><span leaf="">,</span><span><span leaf="">"null"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">        plot.margin = margin(</span><span><span leaf="">0.5</span></span><span leaf="">,</span><span><span leaf="">0.5</span></span><span leaf="">,</span><span><span leaf="">0.5</span></span><span leaf="">,</span><span><span leaf="">0.8</span></span><span leaf="">,unit=</span><span><span leaf="">"cm"</span></span><span leaf="">))+</span><span leaf=""><br></span><span leaf="">  scale_size(guide=</span><span><span leaf="">NULL</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">关注下方公众号下回更新不迷路</span></span><span></span></h3><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-id="Mzg3MzQzNTYzMw==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">购买介绍</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">本节介绍到此结束，有需要学习R数据可视化的朋友欢迎到</span><strong><span leaf="">淘宝店铺：R语言数据分析指南</span></strong><span leaf="">，购买小编的R语言可视化文档，</span><strong><span leaf="">2025年购买将获取2025年更新的内容，同时将赠送2024年的绘图文档内容</span></strong><span leaf="">。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">更新的绘图内容包含数据+代码+注释文档+文档清单，</span><strong><span leaf="">小编只分享案例文档，不额外回答问题，无答疑服务</span></strong><span leaf="">，更新截止2025年12月31日结束，零基础不推荐买。</span></p><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例特点</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">所选案例图绝大部份属于个性化分析图表，数据案例多来自已经发表的高分论文，并会汇总整理分享一些论文中公开的分析代码。</span><span leaf=""><br></span><span leaf="">2025年起提供更加专业的html文档，更加的直观易学。文档累计上千人次购买拥有良好的社群交流体验，R代码结构清晰易懂.</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6Xub6mopSSSqF78t1v0xaGzQdBOdSBHuk69cF7BeauCl7KB1uOGzFibQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9481481481481482" data-type="png" data-w="1080" data-imgfileid="100046173" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6Xub6mopSSSqF78t1v0xaGzQdBOdSBHuk69cF7BeauCl7KB1uOGzFibQ/640?wx_fmt=png&amp;from=appmsg"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6lbK2VwvQKGcIqrpiaA8czUB87F8hChiakPaCC5iaicLykTXrtEYWX5mCQw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8712962962962963" data-type="png" data-w="1080" data-imgfileid="100046172" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6lbK2VwvQKGcIqrpiaA8czUB87F8hChiakPaCC5iaicLykTXrtEYWX5mCQw/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">目录大纲展示</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6sZiaJibFv5N7hvBSbK5mtiarlaluAcca1G5ia5tMOgLhKTrlFHAqiaAggVQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.44351851851851853" data-type="png" data-w="1080" data-imgfileid="100046171" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6sZiaJibFv5N7hvBSbK5mtiarlaluAcca1G5ia5tMOgLhKTrlFHAqiaAggVQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">群友精彩评论</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wibmP4UAiabdbib62zPFQgk86BIZPP72ro1W0FQSTB1TUUp0DLgaia3eZA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4546296296296296" data-type="png" data-w="1080" data-imgfileid="100046169" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wibmP4UAiabdbib62zPFQgk86BIZPP72ro1W0FQSTB1TUUp0DLgaia3eZA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">淘宝店铺</span></span><span></span></h3><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg" data-ratio="1.0210420841683367" data-s="300,640" data-type="jpeg" data-w="998" type="block" data-imgfileid="100019415" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAbvhPDLGT8NaialEsht92PTYNJWpmVLfoYGic1uha5FyBrDCibibZCLjiazgvpT1XcdwibfVywD2el0VAgg/640?wx_fmt=jpeg"></section><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">2025年更新案例图展示</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wPRwm3DFylZ1LHTb41oywtXZEQsb6F3VXTkXEkIvKIVkzfhYicWdS3A/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.475" data-type="jpeg" data-w="1080" data-imgfileid="100046178" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wPRwm3DFylZ1LHTb41oywtXZEQsb6F3VXTkXEkIvKIVkzfhYicWdS3A/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB65hKEiccWEkMLolGDMG0ibqicgq50icia4FpXJjfAgo1e3iaC5YRiad8sNVzLA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.42777777777777776" data-type="jpeg" data-w="1080" data-imgfileid="100046174" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB65hKEiccWEkMLolGDMG0ibqicgq50icia4FpXJjfAgo1e3iaC5YRiad8sNVzLA/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6j3bSbiav3M66hma9icTicsJT2JibCkbkBSGDbKdoo0uGmP4jGyiar0DE3fA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.41944444444444445" data-type="jpeg" data-w="1080" data-imgfileid="100046175" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6j3bSbiav3M66hma9icTicsJT2JibCkbkBSGDbKdoo0uGmP4jGyiar0DE3fA/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6KC94LltqDUiaDzyHJJTg86E7yTNqwvX171VDibDZvDF3LKIIZnPdNnxQ/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.4287037037037037" data-type="jpeg" data-w="1080" data-imgfileid="100046177" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6KC94LltqDUiaDzyHJJTg86E7yTNqwvX171VDibDZvDF3LKIIZnPdNnxQ/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6Bpbyn0EenxVbicFfbzWcToFoRGVFnxic0n9icic1ibhcJPGcqfapMibPkULw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.42592592592592593" data-type="jpeg" data-w="1080" data-imgfileid="100046176" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6Bpbyn0EenxVbicFfbzWcToFoRGVFnxic0n9icic1ibhcJPGcqfapMibPkULw/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wZ8yw11iaibqGtjecqpkdUf1kj1AicQVLKXO5e6qUIiaPzTMe58eqWMshg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.4212962962962963" data-type="jpeg" data-w="1080" data-imgfileid="100046183" src="https://mmbiz.qpic.cn/mmbiz_jpg/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6wZ8yw11iaibqGtjecqpkdUf1kj1AicQVLKXO5e6qUIiaPzTMe58eqWMshg/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6cxCJrM1MaIjAMT1icic1uaCorPe0t9a7wIKwEWTg3v2oBB0JUW2Y5SSw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4255555555555556" data-type="png" data-w="900" data-imgfileid="100046181" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6cxCJrM1MaIjAMT1icic1uaCorPe0t9a7wIKwEWTg3v2oBB0JUW2Y5SSw/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6ibE4pouerTBkXfksmDdWx3icQkWhMWic6jX7MW7UfnxErGaKh1qz9qG9g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4255555555555556" data-type="png" data-w="900" data-imgfileid="100046182" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB6ibE4pouerTBkXfksmDdWx3icQkWhMWic6jX7MW7UfnxErGaKh1qz9qG9g/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB61eLZINoBGfWjcve4seZt7ibyRKdjP8WiawNHz5n8OAyquSQnWmoNRdsQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4255555555555556" data-type="png" data-w="900" data-imgfileid="100046180" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZSchN5ZRvtdyZm0I3dQhB61eLZINoBGfWjcve4seZt7ibyRKdjP8WiawNHz5n8OAyquSQnWmoNRdsQ/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/AZeCRGtyavvSoNKxaDWEZw",target="_blank" rel="noopener noreferrer">原文链接</a>
