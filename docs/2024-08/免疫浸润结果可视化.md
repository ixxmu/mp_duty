---
title: "å…ç–«æµ¸æ¶¦ç»“æœå¯è§†åŒ–"
date: 2024-08-02T07:33:53Z
draft: ["false"]
tags: [
  "fetched",
  "åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°"
]
categories: ["Acdemic"]
---
å…ç–«æµ¸æ¶¦ç»“æœå¯è§†åŒ– by åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°
------
<div><section><span>å…³æ³¨å…¬ä¼—å·ï¼Œå‘é€</span><strong>Rè¯­è¨€</strong><span>æˆ–</span><strong>python</strong><span>ï¼Œå¯è·å–èµ„æ–™</span><span></span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzUzOTQzNzU0NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YDc8IDhqWAHTrZsMuhDpFlw4scqOl1ZVWpeY77cdibaSzPeGALfkEhdVpwHzVibHCRSYZg4csB43g/0?wx_fmt=png" data-nickname="åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°" data-alias="yxhsxbj" data-signature="å¤–ç§‘åŒ»ç”ŸğŸ‘¨â€âš•ï¸çš„Rè¯­è¨€å’Œç”Ÿä¿¡å­¦ä¹ ğŸ”–" data-from="2" data-is_biz_ban="0" data-weui-theme="light"></mp-common-profile></section><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer"><section data-role="outer" label="edit by 135editor"><section data-tools="135ç¼–è¾‘å™¨" data-id="28"><p data-brushtype="text" hm_fix="440:185"><span>ğŸ’¡ä¸“æ³¨Rè¯­è¨€åœ¨ğŸ©ºç”Ÿç‰©åŒ»å­¦ä¸­çš„ä½¿ç”¨</span></p></section></section></section></section></section><hr><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><span>å…è´¹åƒäºº</span><span>ğŸ§</span><span><strong>QQäº¤æµç¾¤ï¼š613637742</strong></span></p><hr><p data-tool="mdniceç¼–è¾‘å™¨"><span><strong></strong></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å…ç–«æµ¸æ¶¦ç»“æœå¯è§†åŒ–</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨ä¹‹å‰çš„æ¨æ–‡ä¸­æˆ‘ä»¬ä»‹ç»äº†2è¡Œä»£ç å®ç°9ç§å…ç–«æµ¸æ¶¦æ–¹æ³•ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»ä¸‹å¸¸è§çš„å…ç–«æµ¸æ¶¦ç»“æœçš„å¯è§†åŒ–ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å°±ä»¥å¤§å®¶æœ€å¸¸è§çš„<code>cibersort</code>ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">é¦–å…ˆå¤§å®¶è¦å¯¹æ¯ç§å…ç–«æµ¸æ¶¦æ–¹æ³•çš„ç»“æœæœ‰ä¸€ä¸ªå¤§ä½“çš„è®¤çŸ¥ï¼Œæ¯”å¦‚<code>cibersort</code>çš„ç»“æœæ˜¯å„ç§å…ç–«ç»†èƒåœ¨æ ·æœ¬ä¸­çš„æ¯”ä¾‹ï¼Œæ‰€ä»¥ä¸€ä¸ªæ ·æœ¬ä¸­æ‰€æœ‰çš„å…ç–«ç»†èƒæ¯”ä¾‹åŠ èµ·æ¥æ€»å’Œæ˜¯1ï¼</p><p data-tool="mdniceç¼–è¾‘å™¨">ä½†æ˜¯<code>ssGSEA</code>å°±ä¸æ˜¯è¿™æ ·äº†ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">åªæœ‰ç†è§£äº†ç»“æœæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä½ æ‰èƒ½é€‰æ‹©åˆé€‚çš„å¯è§†åŒ–æ–¹æ³•ã€‚<strong>æ•°å°±æ˜¯å›¾ï¼Œå›¾å°±æ˜¯æ•°</strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(tidyHeatmap)<br><span>library</span>(tidyverse)<br><span>library</span>(RColorBrewer)<br><br><span>#Â é¦–å…ˆå˜ä¸ºé•¿æ•°æ®</span><br>cibersort_longÂ &lt;-Â im_cibersortÂ %&gt;%Â <br>Â Â select(`P-value_CIBERSORT`,Correlation_CIBERSORT,Â RMSE_CIBERSORT,ID,everything())Â %&gt;%Â <br>Â Â pivot_longer(-Â c(<span>1</span>:<span>4</span>),names_toÂ =Â <span>"cell_type"</span>,values_toÂ =Â <span>"fraction"</span>)Â %&gt;%Â <br>Â Â dplyr::mutate(cell_typeÂ =Â gsub(<span>"_CIBERSORT"</span>,<span>""</span>,cell_type),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cell_typeÂ =Â gsub(<span>"_"</span>,<span>"Â "</span>,cell_type))<br><br>head(cibersort_long[,<span>4</span>:<span>6</span>])<br><span>##Â #Â AÂ tibble:Â 6Â Ã—Â 3</span><br><span>##Â Â Â IDÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cell_typeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fraction</span><br><span>##Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;</span><br><span>##Â 1Â TCGA-D5-6540-01A-11R-1723-07Â BÂ cellsÂ naiveÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0.0504</span><br><span>##Â 2Â TCGA-D5-6540-01A-11R-1723-07Â BÂ cellsÂ memoryÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0Â Â Â Â Â </span><br><span>##Â 3Â TCGA-D5-6540-01A-11R-1723-07Â PlasmaÂ cellsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0Â Â Â Â Â </span><br><span>##Â 4Â TCGA-D5-6540-01A-11R-1723-07Â TÂ cellsÂ CD8Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0.119Â </span><br><span>##Â 5Â TCGA-D5-6540-01A-11R-1723-07Â TÂ cellsÂ CD4Â naiveÂ Â Â Â Â Â Â Â Â Â Â Â 0Â Â Â Â Â </span><br><span>##Â 6Â TCGA-D5-6540-01A-11R-1723-07Â TÂ cellsÂ CD4Â memoryÂ restingÂ Â Â 0.0951</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨<code>IOBR</code>ä¸ºå¤§å®¶æä¾›çš„<code>cell_bar_plot()</code>å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥å¸®ä½ è½¬æ¢ä¸ºé•¿æ•°æ®ï¼Œå¹¶ä¸”è¿˜å¯ä»¥æŠŠå›¾ç”»å‡ºæ¥ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>res_cibersortÂ &lt;-Â cell_bar_plot(im_cibersort)<br><span>##Â ThereÂ areÂ sevenÂ categoriesÂ youÂ canÂ choose:Â box,Â continue2,Â continue,Â random,Â heatmap,Â heatmap3,Â tidyheatmap</span><br><span>##Â &gt;&gt;&gt;&gt;===Â PaletteÂ optionÂ forÂ random:Â 1:Â palette1;Â 2:Â palette2;Â 3:Â palette3;Â Â 4:Â palette4</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo120RkFW79FibQ72YPbD5XR99J1raM3U29hhtwFzeCw4gd0j5WLumTLtQ/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo120RkFW79FibQ72YPbD5XR99J1raM3U29hhtwFzeCw4gd0j5WLumTLtQ/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-17</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">ä½†æ˜¯è¿™ä¸ªå›¾ä½ å¯èƒ½ä¸èƒ½æ¥å—ï¼Œæ²¡å…³ç³»ï¼Œè½¬æ¢å¥½çš„é•¿æ•°æ®å·²ç»åœ¨<code>res_cibersort</code>è¿™ä¸ªå¯¹è±¡é‡Œäº†ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>head(res_cibersort$data)<br><span>##Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â IDÂ Â Â Â Â cell_typeÂ Â Â fraction</span><br><span>##Â 1Â TCGA-D5-6540-01A-11R-1723-07Â BÂ cellsÂ naiveÂ 0.05044811</span><br><span>##Â 2Â TCGA-AA-3525-11A-01R-A32Z-07Â BÂ cellsÂ naiveÂ 0.11573408</span><br><span>##Â 3Â TCGA-AA-3525-01A-02R-0826-07Â BÂ cellsÂ naiveÂ 0.06545120</span><br><span>##Â 4Â TCGA-AA-3815-01A-01R-1022-07Â BÂ cellsÂ naiveÂ 0.03903166</span><br><span>##Â 5Â TCGA-D5-6923-01A-11R-A32Z-07Â BÂ cellsÂ naiveÂ 0.02560987</span><br><span>##Â 6Â TCGA-G4-6322-01A-11R-1723-07Â BÂ cellsÂ naiveÂ 0.08727238</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å’Œæˆ‘ä»¬è‡ªå·±è½¬æ¢çš„æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™ä¸ªæ•°æ®å°±å¯ä»¥ç›´æ¥ä½¿ç”¨<code>ggplot2</code>è‡ªå·±ç”»å›¾äº†ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>p1Â &lt;-Â cibersort_longÂ %&gt;%Â <br>Â Â ggplot(aes(ID,fraction))+<br>Â Â geom_bar(statÂ =Â <span>"identity"</span>,positionÂ =Â <span>"stack"</span>,aes(fill=cell_type))+<br>Â Â labs(x=<span>NULL</span>)+<br>Â Â scale_y_continuous(expandÂ =Â c(<span>0</span>,<span>0</span>))+<br>Â Â scale_fill_manual(valuesÂ =Â palette4,name=<span>NULL</span>)+Â <span># iobrè¿˜ç»™å¤§å®¶å‡†å¤‡äº†å‡ ä¸ªè‰²ç›˜ï¼Œè´´å¿ƒï¼</span><br>Â Â theme_bw()+<br>Â Â theme(axis.text.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â axis.ticks.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"bottom"</span><br>Â Â Â Â Â Â Â Â )<br>p1<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1IEAwCW11w7KKNGuRAv5N2CFTgkQRSTLQqxpsznEa9HibaF0jNqBtfxw/640?wx_fmt=png" data-type="png" data-w="720" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1IEAwCW11w7KKNGuRAv5N2CFTgkQRSTLQqxpsznEa9HibaF0jNqBtfxw/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-19</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">é™¤äº†è¿™ä¸ªæœ€å¸¸è§çš„å †å æ¡å½¢å›¾ï¼Œè¿˜å¯ä»¥ç”»ç®±çº¿å›¾ï¼Œçƒ­å›¾ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â æœ‰é¡ºåºçš„ç®±çº¿å›¾</span><br><span>library</span>(forcats)<br><br>p2Â &lt;-Â ggplot(cibersort_long,aes(fct_reorder(cell_type,Â fraction),fraction,fillÂ =Â cell_type))Â +Â <br>Â Â geom_boxplot()Â +Â <br>Â Â <span>#geom_jitter(widthÂ =Â 0.2,aes(color=cell_type))+</span><br>Â Â theme_bw()Â +Â <br>Â Â labs(xÂ =Â <span>"CellÂ Type"</span>,Â yÂ =Â <span>"EstimatedÂ Proportion"</span>)Â +<br>Â Â theme(axis.text.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â axis.ticks.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"bottom"</span>)Â +Â <br>Â Â scale_fill_manual(valuesÂ =Â palette4)<br>p2<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo12dACIDmXfdFCu266OrUGkWpZhRc4icVLYJicsRmViaHWtAukctG4RbU0g/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo12dACIDmXfdFCu266OrUGkWpZhRc4icVLYJicsRmViaHWtAukctG4RbU0g/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-20</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœä½ çš„æ ·æœ¬æœ‰ä¸åŒåˆ†ç»„ï¼Œå°±å¯ä»¥æ ¹æ®ç”»å‡ºåˆ†ç»„ç®±çº¿å›¾ã€‚æ¯”å¦‚æˆ‘è¿™é‡Œå°±æ ¹æ®<code>tumor/normal</code>æŠŠæ ·æœ¬åˆ†ç»„ï¼Œç„¶åå†ç»„é—´è¿›è¡Œéå‚æ•°æ£€éªŒï¼Œå¹¶æ·»åŠ På€¼ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">è¿™äº›éƒ½æ˜¯Rè¯­è¨€åŸºç¡€æ“ä½œï¼Œæœ¬å·çš„<strong>å¯è§†åŒ–</strong>åˆé›†ä¸­ä»‹ç»äº†å¤ªå¤šè¿™äº›åŸºæœ¬ç»˜å›¾çŸ¥è¯†äº†ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(ggpubr)<br><span>library</span>(stringr)<br><br><span>#Â åˆ†ç»„</span><br>cibersort_long$GroupÂ =Â ifelse(as.numeric(str_sub(cibersort_long$ID,<span>14</span>,<span>15</span>))&lt;<span>10</span>,<span>"tumor"</span>,<span>"normal"</span>)<br><br>p3Â &lt;-Â ggplot(cibersort_long,aes(fct_reorder(cell_type,fraction),fraction,fillÂ =Â Group))Â +Â <br>Â Â geom_boxplot(outlier.shapeÂ =Â <span>21</span>,colorÂ =Â <span>"black"</span>)Â +Â <br>Â Â scale_fill_manual(valuesÂ =Â palette1[c(<span>2</span>,<span>4</span>)])+Â <br>Â Â theme_bw()Â +Â <br>Â Â labs(xÂ =Â <span>NULL</span>,Â yÂ =Â <span>"EstimatedÂ Proportion"</span>)Â +<br>Â Â theme(legend.positionÂ =Â <span>"top"</span>)Â +Â <br>Â Â theme(axis.text.xÂ =Â element_text(angle=<span>45</span>,hjustÂ =Â <span>1</span>),<br>Â Â Â Â Â Â Â Â axis.textÂ =Â element_text(colorÂ =Â <span>"black"</span>,sizeÂ =Â <span>12</span>))+<br>Â Â stat_compare_means(aes(groupÂ =Â Group,labelÂ =Â ..p.signif..),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodÂ =Â <span>"kruskal.test"</span>,label.yÂ =Â <span>0.4</span>)<br>p3<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1fSXGoYCTMmKiamRn1Oa2VJPJbEL7TpaDnJjou819LeUYicKR4btKicwQw/640?wx_fmt=png" data-type="png" data-w="720" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1fSXGoYCTMmKiamRn1Oa2VJPJbEL7TpaDnJjou819LeUYicKR4btKicwQw/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-21</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">çƒ­å›¾ä¹Ÿæ˜¯ä¸€æ ·çš„easyï¼Œè€Œä¸”æœ‰äº†<code>tidyHeatmap</code>çš„åŠ æŒï¼Œç›´æ¥ä½¿ç”¨é•¿æ•°æ®å³å¯ï¼Œä¸ç”¨åœ¨å˜ä¸ºå®½æ•°æ®äº†ï¼</p><p data-tool="mdniceç¼–è¾‘å™¨">å¯ä»¥å‚è€ƒæ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247497593&amp;idx=1&amp;sn=12b343f5bff869c7abdd8a2b2b373cf6&amp;scene=21#wechat_redirect" data-linktype="2">tidyHeatmapå®Œç¾ä½¿ç”¨é•¿æ•°æ®çš„çƒ­å›¾å¯è§†åŒ–</a></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(tidyHeatmap)<br><br>p4Â &lt;-Â heatmap(.dataÂ =Â cibersort_long<br>Â Â Â Â Â Â Â Â ,.rowÂ =Â cell_type<br>Â Â Â Â Â Â Â Â ,.columnÂ =Â ID<br>Â Â Â Â Â Â Â Â ,.valueÂ =Â fraction<br>Â Â Â Â Â Â Â Â ,scaleÂ =Â <span>"column"</span><br>Â Â Â Â Â Â Â Â ,palette_valueÂ =Â circlize::colorRamp2(<br>Â Â Â Â Â Â Â Â Â Â Â Â seq(-<span>2</span>,Â <span>2</span>,Â length.outÂ =Â <span>11</span>),Â <br>Â Â Â Â Â Â Â Â Â Â Â Â RColorBrewer::brewer.pal(<span>11</span>,Â <span>"RdBu"</span>)<br>Â Â Â Â Â Â Â Â )<br>Â Â Â Â Â Â Â Â ,show_column_names=<span>F</span><br>Â Â Â Â Â Â Â Â ,row_names_gpÂ =Â gpar(fontsizeÂ =Â <span>10</span>),<br>Â Â Â Â Â Â Â Â column_names_gpÂ =Â gpar(fontsizeÂ =Â <span>7</span>),<br>Â Â Â Â Â Â Â Â column_title_gpÂ =Â gpar(fontsizeÂ =Â <span>7</span>),<br>Â Â Â Â Â Â Â Â row_title_gpÂ =Â gpar(fontsizeÂ =Â <span>7</span>)<br>Â Â Â Â Â Â Â Â )Â %&gt;%Â <br>Â Â add_tile(Group)Â <span>#Â æ–°ç‰ˆæœ¬å·²ç»æ”¹äº†ï¼Œæ³¨æ„</span><br>p4<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo179482YO20m2xVgQOVG4yzibHicYIic2d7g6kRFSR4qSbaXIxANudHPvtQ/640?wx_fmt=png" data-type="png" data-w="864" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo179482YO20m2xVgQOVG4yzibHicYIic2d7g6kRFSR4qSbaXIxANudHPvtQ/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-22</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨"><code>ssGSEA</code>çš„å¯è§†åŒ–æ–¹æ³•ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä¸è¿‡å°±æ²¡æœ‰å †å æ¡å½¢å›¾äº†ï¼Œå› ä¸ºåŠ å’Œä¸æ˜¯1ï¼Œå †å èµ·æ¥å°±ä¼šå‚å·®ä¸é½ï¼Œæ¯«æ— ç¾æ„Ÿã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å¸¸ç”¨çš„è¿˜æ˜¯ç®±çº¿å›¾è¿™ç§æ ·å¼çš„ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ssgsea_longÂ &lt;-Â im_ssgseaÂ %&gt;%Â <br>Â Â pivot_longer(-Â ID,names_toÂ =Â <span>"cell_type"</span>,values_toÂ =Â <span>"Score"</span>)<br>head(ssgsea_long)<br><span>##Â #Â AÂ tibble:Â 6Â Ã—Â 3</span><br><span>##Â Â Â IDÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cell_typeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Score</span><br><span>##Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;</span><br><span>##Â 1Â TCGA-3L-AA1B-01A-11R-A37K-07Â ActivatedÂ BÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â -0.192Â Â </span><br><span>##Â 2Â TCGA-3L-AA1B-01A-11R-A37K-07Â ActivatedÂ CD4Â TÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â 0.0120Â </span><br><span>##Â 3Â TCGA-3L-AA1B-01A-11R-A37K-07Â ActivatedÂ CD8Â TÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â 0.170Â Â </span><br><span>##Â 4Â TCGA-3L-AA1B-01A-11R-A37K-07Â ActivatedÂ dendriticÂ cellÂ Â Â Â Â Â Â Â 0.00545</span><br><span>##Â 5Â TCGA-3L-AA1B-01A-11R-A37K-07Â CD56brightÂ naturalÂ killerÂ cellÂ Â 0.199Â Â </span><br><span>##Â 6Â TCGA-3L-AA1B-01A-11R-A37K-07Â CD56dimÂ naturalÂ killerÂ cellÂ Â Â Â Â 0.351</span><br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggplot(ssgsea_long,Â aes(cell_type,Â Score))+<br>Â Â geom_violin(width=<span>2.0</span>,aes(color=cell_type))+<br>Â Â geom_boxplot(width=<span>0.2</span>,fill=<span>"black"</span>)Â +Â <br>Â Â theme_bw()Â +Â <br>Â Â labs(xÂ =Â <span>NULL</span>)Â +<br>Â Â theme(axis.text.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â axis.ticks.xÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â legend.positionÂ =Â <span>"bottom"</span>)Â +Â <br>Â Â <span>#scale_fill_manual(valuesÂ =Â palette4)+</span><br>Â Â scale_color_manual(valuesÂ =Â palette4,name=<span>NULL</span>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1onkuC6mo87c3sM6NApLOKUWDibu9aaK6SjP1U1ck5kQD29HlcUiamvhg/640?wx_fmt=png" data-type="png" data-w="720" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1onkuC6mo87c3sM6NApLOKUWDibu9aaK6SjP1U1ck5kQD29HlcUiamvhg/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-24</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">é™¤æ­¤ä¹‹å¤–ä¹Ÿæ˜¯å¯ä»¥æ·»åŠ åˆ†ç»„ï¼Œç”»çƒ­å›¾ç­‰ï¼Œå…¶ä»–çš„å…ç–«æµ¸æ¶¦ç»“æœä¹Ÿæ˜¯åŒæ ·çš„å¯è§†åŒ–æ€è·¯ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†ï¼Œå¤§å®¶è‡ªå·±å°è¯•ä¸‹å³å¯ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å’Œåˆ†å­è”ç³»èµ·æ¥</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœå’ŒæŸä¸ªåˆ†å­è”ç³»èµ·æ¥ï¼Œåˆå¯ä»¥ç”»å‡ºå„ç§èŠ±é‡Œèƒ¡å“¨çš„å›¾ï¼Œæ¯”å¦‚æ£’æ£’ç³–å›¾ï¼Œçƒ­å›¾ï¼Œæ•£ç‚¹å›¾ç­‰ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æˆ‘è¿™é‡Œæ˜¯ä»¥<code>ssGSEA</code>çš„ç»“æœä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºçš„ï¼Œå…¶ä»–çš„éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æˆ‘ä»¬å°±ä»¥<code>CTLA4</code> <code>EGFR</code> <code>PDL1</code> Â <code>BRAF</code> Â "VEGFB" "VEGFA" "VEGFC" "VEGFD" "NTRK2" "NTRK1" "NTRK3"è¿™å‡ ä¸ªåˆ†å­ä¸ºä¾‹å§ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>genesÂ &lt;-Â c(<span>"CTLA4"</span>,<span>"EGFR"</span>,<span>"PDL1"</span>,<span>"BRAF"</span>,<span>"KRAS"</span>,<span>"VEGFA"</span>,<span>"VEGFB"</span>,<span>"VEGFC"</span>,<span>"VEGFD"</span>,<span>"NTRK1"</span>,<span>"NTRK2"</span>,<span>"NTRK3"</span>)<br><br>genes_exprÂ &lt;-Â as.data.frame(t(expr_coad[rownames(expr_coad)Â %<span>in</span>%Â genes,]))<br>genes_exprÂ &lt;-Â genes_expr[match(im_ssgsea$ID,rownames(genes_expr)),]<br>identical(im_ssgsea$ID,rownames(genes_expr))<br><span>##Â [1]Â TRUE</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æ¥ä¸‹æ¥å°±æ˜¯æ‰¹é‡è®¡ç®—æ¯ä¸€ä¸ªåŸºå› å’Œ28ç§ç»†èƒä¹‹é—´çš„ç›¸å…³ç³»æ•°å’ŒPå€¼ï¼Œè¿™ä¸ªéœ€æ±‚ä½ å¯ä»¥å†™å¾ªç¯å®ç°ï¼Œæˆ–è€…applyç³»åˆ—ï¼Œpurrrç³»åˆ—ç­‰ï¼Œä½†æ˜¯æˆ‘è¯•è¿‡ï¼Œéƒ½å¤ªæ…¢äº†ï¼Œå°¤å…¶æ˜¯æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æ‰€ä»¥æˆ‘è¿™é‡Œç»™å¤§å®¶ä»‹ç»ä¸€ç§æ›´å¿«çš„æ–¹æ³•ï¼Œå€ŸåŠ©<code>linkET</code>åŒ…å®ç°ï¼Œè¿™ä¸ªåŒ…åœ¨ä¹‹å‰ä¹Ÿä»‹ç»è¿‡äº†ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247491924&amp;idx=1&amp;sn=6f6fa87e0691adddef011aeef1d68c97&amp;scene=21#wechat_redirect" data-linktype="2">mantel-testå¯è§†åŒ–ï¼Œåˆ«å†åªçŸ¥é“ggcorï¼</a></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(linkET)<br><span>##Â </span><br><span>##Â AttachingÂ package:Â 'linkET'</span><br><span>##Â TheÂ followingÂ objectÂ isÂ maskedÂ fromÂ 'package:purrr':</span><br><span>##Â </span><br><span>##Â Â Â Â Â simplify</span><br><span>##Â TheÂ followingÂ objectÂ isÂ maskedÂ fromÂ 'package:ComplexHeatmap':</span><br><span>##Â </span><br><span>##Â Â Â Â Â anno_link</span><br><br>cor_resÂ &lt;-Â correlate(genes_expr,Â im_ssgsea[,-<span>1</span>],methodÂ =Â <span>"spearman"</span>)<br>Â Â <br>qcorrplot(cor_res)Â +<br>Â Â geom_square()Â +<br>Â Â scale_fill_gradientn(coloursÂ =Â RColorBrewer::brewer.pal(<span>11</span>,Â <span>"RdBu"</span>))<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1tRh8Rb7wYJbdp5aen1m1etheEGCTLDHWzmTWyEFgCR57Uh0hEEeYlw/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1tRh8Rb7wYJbdp5aen1m1etheEGCTLDHWzmTWyEFgCR57Uh0hEEeYlw/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-26</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">ä½†æ˜¯è¿™ä¸ªå›¾å¹¶æ²¡æœ‰æ˜æ˜¾çš„è¡¨ç¤ºå‡ºPå€¼ï¼Œæ‰€ä»¥æˆ‘çŸ¥é“å¤§å®¶æƒ³è‡ªå·±ç”»çš„æ›´åŠ èŠ±é‡Œèƒ¡å“¨ä¸€ç‚¹ï¼Œåœ¨å¾ˆä¹…ä¹‹å‰æˆ‘å°±ä»‹ç»è¿‡äº†è¿™ä¸ªæ–¹æ³•äº†ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247484314&amp;idx=1&amp;sn=27ac2927c002e2cda87af6d4431633f8&amp;scene=21#wechat_redirect" data-linktype="2">Rè¯­è¨€ggplot2ç”»ç›¸å…³æ€§çƒ­å›¾</a></p><p data-tool="mdniceç¼–è¾‘å™¨">ç”»å›¾å‰å…ˆå‡†å¤‡ä¸‹æ•°æ®ï¼ŒæŠŠPå€¼æ•°æ®å’Œç›¸å…³ç³»æ•°æ•°æ®æ•´åˆåˆ°ä¸€èµ·ï¼Œæ‰€ä»¥å€ŸåŠ©<code>linkET</code>åŒ…ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œå¦‚æœè‡ªå·±å†™å‡½æ•°è‚¯å®šæ˜¯ç›´æ¥å¼„å¥½çš„ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â å…ˆæ•´ç†ä¸‹æ•°æ®</span><br>df_rÂ &lt;-Â cor_res$rÂ %&gt;%Â <br>Â Â as.data.frame()Â %&gt;%Â <br>Â Â rownames_to_column(varÂ =Â <span>"gene"</span>)Â %&gt;%Â <br>Â Â pivot_longer(-<span>1</span>,names_toÂ =Â <span>"cell_type"</span>,values_toÂ =Â <span>"correlation"</span>)<br><br>df_pÂ &lt;-Â cor_res$pÂ %&gt;%Â <br>Â Â as.data.frame()Â %&gt;%Â <br>Â Â rownames_to_column(varÂ =Â <span>"gene"</span>)Â %&gt;%Â <br>Â Â pivot_longer(-<span>1</span>,names_toÂ =Â <span>"cell_type"</span>,values_toÂ =Â <span>"pvalue"</span>)<br><br>df_corÂ &lt;-Â df_rÂ %&gt;%Â <br>Â Â left_join(df_p)Â %&gt;%Â <br>Â Â mutate(starsÂ =Â cut(pvalue,breaksÂ =Â c(-<span>Inf</span>,<span>0.05</span>,<span>0.01</span>,<span>0.001</span>,<span>Inf</span>),rightÂ =Â <span>F</span>,labelsÂ =Â c(<span>"***"</span>,<span>"**"</span>,<span>"*"</span>,<span>"Â "</span>)))<br><span>##Â JoiningÂ withÂ `byÂ =Â join_by(gene,Â cell_type)`</span><br><br>head(df_cor)<br><span>##Â #Â AÂ tibble:Â 6Â Ã—Â 5</span><br><span>##Â Â Â geneÂ Â cell_typeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â correlationÂ Â Â pvalueÂ stars</span><br><span>##Â Â Â &lt;chr&gt;Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;Â Â Â Â &lt;dbl&gt;Â &lt;fct&gt;</span><br><span>##Â 1Â VEGFBÂ ActivatedÂ BÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0.0837Â 5.55e-Â 2Â "Â "Â Â </span><br><span>##Â 2Â VEGFBÂ ActivatedÂ CD4Â TÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â -0.338Â Â 2.35e-15Â "***"</span><br><span>##Â 3Â VEGFBÂ ActivatedÂ CD8Â TÂ cellÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 0.0417Â 3.41e-Â 1Â "Â "Â Â </span><br><span>##Â 4Â VEGFBÂ ActivatedÂ dendriticÂ cellÂ Â Â Â Â Â Â Â Â Â Â -0.0181Â 6.79e-Â 1Â "Â "Â Â </span><br><span>##Â 5Â VEGFBÂ CD56brightÂ naturalÂ killerÂ cellÂ Â Â Â Â Â 0.287Â Â 2.48e-11Â "***"</span><br><span>##Â 6Â VEGFBÂ CD56dimÂ naturalÂ killerÂ cellÂ Â Â Â Â Â Â Â Â 0.289Â Â 1.82e-11Â "***"</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æ•°æ®éƒ½æœ‰äº†ï¼Œç”»å›¾å°±è¡Œäº†ã€‚<code>ggplot2</code>æå®šä¸€åˆ‡ï¼Œæ±‚æ±‚å¤§å®¶èµ¶ç´§å­¦å­¦<code>ggplot2</code>å§ï¼Œåˆ«å†å¤©å¤©é—®å›¾æ€ä¹ˆç”»äº†ã€‚ä¸¤æœ¬è¯´æ˜ä¹¦ï¼Œéšä¾¿ä¹°ä¸€æœ¬è®¤çœŸçœ‹çœ‹å°±æå®šäº†ï¼šã€ŠRæ•°æ®å¯è§†åŒ–æ‰‹å†Œã€‹æˆ–è€…ã€Šggplot2ï¼šæ•°æ®åˆ†æä¸å›¾å½¢è‰ºæœ¯ã€‹</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(ggplot2)<br><br>ggplot(df_cor,Â aes(cell_type,gene))+<br>Â Â geom_tile(aes(fill=correlation))+<br>Â Â geom_text(aes(label=stars),Â color=<span>"black"</span>,Â size=<span>4</span>)+<br>Â Â scale_fill_gradient2(low=<span>'#67B26F'</span>,Â high=<span>'#F2AA9D'</span>,midÂ =Â <span>'white'</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â limit=c(-<span>1</span>,<span>1</span>),name=paste0(<span>"*Â Â Â Â pÂ &lt;Â 0.05"</span>,<span>"\n\n"</span>,<span>"**Â Â pÂ &lt;Â 0.01"</span>,<span>"\n\n"</span>,<span>"***Â pÂ &lt;Â 0.001"</span>,<span>"\n\n"</span>,<span>"Correlation"</span>))+<br>Â Â labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>Â Â theme(axis.text.xÂ =Â element_text(size=<span>8</span>,angleÂ =Â <span>45</span>,hjustÂ =Â <span>1</span>,colorÂ =Â <span>"black"</span>),<br>Â Â Â Â Â Â Â Â axis.text.yÂ =Â element_text(size=<span>8</span>,colorÂ =Â <span>"black"</span>),<br>Â Â Â Â Â Â Â Â axis.ticks.yÂ =Â element_blank(),<br>Â Â Â Â Â Â Â Â panel.background=element_blank())<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.4444444444444444" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1JUHJXibApU7kaUhGNUrkN7RSeFUdjsaYqOKlCBnxaVA7icow3LC7zYOw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1JUHJXibApU7kaUhGNUrkN7RSeFUdjsaYqOKlCBnxaVA7icow3LC7zYOw/640?wx_fmt=png"></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggsave(<span>"df_cor.png"</span>,heightÂ =Â <span>4</span>,widthÂ =Â <span>9</span>)Â <span>#Â ä¿å­˜æ—¶ä¸æ–­è°ƒæ•´é•¿å®½æ¯”å³å¯å¾—åˆ°æ»¡æ„çš„å›¾å½¢</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æ£’æ£’ç³–å›¾ä¹Ÿæ˜¯ä¸€æ ·çš„ç®€å•ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿä»‹ç»è¿‡äº†ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247489587&amp;idx=1&amp;sn=c9aecbca2ff424a2b737ebbc46fafdfb&amp;scene=21#wechat_redirect" data-linktype="2">ä½ è¿˜ä¸ä¼šç”»æ£’æ£’ç³–å›¾ï¼Ÿ</a></p><p data-tool="mdniceç¼–è¾‘å™¨">ä¸è¿‡è¿™ç§å±•ç¤ºçš„æ˜¯1ä¸ªåŸºå› å’Œå…¶ä»–ç»†èƒçš„å…³ç³»ï¼Œå°±æ˜¯1å¯¹å¤šçš„å…³ç³»å±•ç¤ºï¼Œä¸Šé¢çš„çƒ­å›¾æ˜¯å¤šå¯¹å¤šçš„å…³ç³»å±•ç¤ºã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â ä»¥EGFRä¸ºä¾‹</span><br>df_egfrÂ &lt;-Â df_corÂ %&gt;%Â <br>Â Â filter(gene==<span>"EGFR"</span>)<br><br>text_colorÂ &lt;-Â c(rep(<span>"red"</span>,<span>4</span>),rep(<span>"#FDD819"</span>,<span>1</span>),rep(<span>"#67B26F"</span>,<span>1</span>),rep(<span>"#C4E0E5"</span>,<span>12</span>),rep(<span>"#67B26F"</span>,<span>2</span>),rep(<span>"#FDD819"</span>,<span>3</span>),rep(<span>"red"</span>,<span>5</span>))<br><br>ggplot(df_egfr,Â aes(correlation,Â fct_reorder(cell_type,correlation)))+<br>Â Â geom_segment(aes(xendÂ =Â <span>0</span>,yendÂ =Â cell_type),color=<span>"grey70"</span>,size=<span>1.2</span>)+Â <br>Â Â geom_point(aes(sizeÂ =Â abs(correlation),Â color=factor(stars)))+Â <br>Â Â scale_color_manual(valuesÂ =Â c(<span>"red"</span>,<span>"#FDD819"</span>,<span>"#67B26F"</span>,<span>"#C4E0E5"</span>),name=<span>"P-value"</span>)+<br>Â Â scale_size_continuous(rangeÂ =Â c(<span>3</span>,<span>8</span>),name=<span>"Correlation"</span>)+Â <br>Â Â labs(x=<span>NULL</span>,y=<span>NULL</span>)+<br>Â Â theme_bw()+<br>Â Â theme(axis.text.xÂ =Â element_text(color=<span>"black"</span>,sizeÂ =Â <span>14</span>),<br>Â Â Â Â Â Â Â Â axis.text.yÂ =Â element_text(colorÂ =Â text_color,sizeÂ =Â <span>14</span>)<span>#ç»™æ ‡ç­¾ä¸Šè‰²æ²¡æƒ³åˆ°ç‰¹åˆ«å¥½çš„æ–¹æ³•</span><br>Â Â Â Â Â Â Â Â )<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1m8ibPU3PtbCmY9VM6okqT66Pq3w6tTHG4Ku72nUKBPxicYiaOIBt0DzaQ/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1m8ibPU3PtbCmY9VM6okqT66Pq3w6tTHG4Ku72nUKBPxicYiaOIBt0DzaQ/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-29</figcaption></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggsave(<span>"df_egfr.png"</span>,widthÂ =Â <span>8</span>,heightÂ =Â <span>8</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥å¯è§†åŒ–1ä¸ªåŸºå› å’Œ1ä¸ªç»†èƒä¹‹é—´çš„å…³ç³»ï¼Œç”¨æ•£ç‚¹å›¾æˆ–è€…æ•£ç‚¹å›¾çŸ©é˜µçš„å½¢å¼ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>ggplot2</code>é‡Œé¢çš„åˆ†é¢ï¼Œç”»ä¸€å¼ å›¾ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â è¿˜æ˜¯ä»¥EGFRä¸ºä¾‹</span><br>df_egfr_scatterÂ &lt;-Â im_ssgseaÂ %&gt;%Â <br>Â Â mutate(EGFRÂ =Â genes_expr[,<span>"EGFR"</span>],.beforeÂ =Â <span>1</span>)Â %&gt;%Â <br>Â Â pivot_longer(-c(<span>1</span>,<span>2</span>),names_toÂ =Â <span>"cell_type"</span>,values_toÂ =Â <span>"score"</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç”»å›¾å³å¯ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggplot(df_egfr_scatter,Â aes(EGFR,score))+<br>Â Â geom_point()+<br>Â Â geom_smooth(methodÂ =Â <span>"lm"</span>,color=<span>"blue"</span>)+<br>Â Â stat_cor(methodÂ =Â <span>"spearman"</span>,color=<span>"red"</span>)+<br>Â Â facet_wrap(~cell_type,scalesÂ =Â <span>"free_y"</span>,ncolÂ =Â <span>5</span>)<br><span>##Â `geom_smooth()`Â usingÂ formulaÂ =Â 'yÂ ~Â x'</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.5" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1ohdVneRdTpdoh2joUL10ibScfcqcyNP6216lcYy4ia2Onlia3Yyia0OBMw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1ohdVneRdTpdoh2joUL10ibScfcqcyNP6216lcYy4ia2Onlia3Yyia0OBMw/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-31</figcaption></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggsave(<span>"df_facet.png"</span>,widthÂ =Â <span>14</span>,heightÂ =Â <span>8</span>)<br><span>##Â `geom_smooth()`Â usingÂ formulaÂ =Â 'yÂ ~Â x'</span><br></code></pre><blockquote data-tool="mdniceç¼–è¾‘å™¨"><p>æ³¨æ„ï¼šåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ç”¨çš„éƒ½æ˜¯æ‰€æœ‰æ ·æœ¬ï¼Œtumorå’Œnormaléƒ½æœ‰ï¼</p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨">æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ç…§tumorå’Œnormalåˆ†ä¸ªç»„ï¼Œå†ç”»å›¾ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>df_egfr_scatter$sample_typeÂ &lt;-Â ifelse(as.numeric(substr(df_egfr_scatter$ID,<span>14</span>,<span>15</span>))&lt;<span>10</span>,<span>"tumor"</span>,<span>"normal"</span>)<br><br>ggplot(df_egfr_scatter,Â aes(EGFR,score,color=sample_type))+<br>Â Â geom_point()+<br>Â Â geom_smooth(methodÂ =Â <span>"lm"</span>)+<br>Â Â stat_cor(methodÂ =Â <span>"spearman"</span>)+<br>Â Â scale_color_manual(valuesÂ =Â c(<span>'#FDD819'</span>,<span>'#028EA1'</span>))+<br>Â Â facet_wrap(~cell_type,scalesÂ =Â <span>"free_y"</span>,ncolÂ =Â <span>5</span>)<br><span>##Â `geom_smooth()`Â usingÂ formulaÂ =Â 'yÂ ~Â x'</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.5712962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1n0RkgqObCMB65VAicAH664TibUAcpZyQI59QVhak99A43NOUNvj1Rosw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1n0RkgqObCMB65VAicAH664TibUAcpZyQI59QVhak99A43NOUNvj1Rosw/640?wx_fmt=png"></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggsave(<span>"df_facet_two.png"</span>,widthÂ =Â <span>14</span>,heightÂ =Â <span>8</span>)<br><span>##Â `geom_smooth()`Â usingÂ formulaÂ =Â 'yÂ ~Â x'</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å¦‚æœä½ éœ€è¦å•ç‹¬ç”»å›¾ï¼Œå¹¶ä¿å­˜ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œéƒ½æ²¡æœ‰é—®é¢˜ï¼Œåªè¦ä½ åŸºç¡€å¤Ÿæ‰å®ï¼Œæƒ³åšä»€ä¹ˆéƒ½å¯ä»¥ï¼Œä½ Rè¯­è¨€åŸºç¡€ä¸è¡Œï¼Œå•¥éƒ½åšä¸å‡ºæ¥ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>#Â è¿˜æ˜¯ä»¥EGFRä¸ºä¾‹</span><br>df_egfr_scatterÂ %&gt;%Â <br>Â Â filter(cell_typeÂ ==Â <span>"ActivatedÂ BÂ cell"</span>)Â %&gt;%Â <br>Â Â ggplot(aes(EGFR,Â score,color=sample_type))+<br>Â Â geom_point()+<br>Â Â geom_rug(aes(color=sample_type))+<br>Â Â geom_smooth(methodÂ =Â <span>"lm"</span>)+<br>Â Â stat_cor(methodÂ =Â <span>"spearman"</span>)+<br>Â Â scale_color_manual(valuesÂ =Â c(<span>'#FDD819'</span>,<span>'#028EA1'</span>))+<br>Â Â theme_bw()<br><span>##Â `geom_smooth()`Â usingÂ formulaÂ =Â 'yÂ ~Â x'</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1MNdL8J3hWNY5jQuToy3XPvkNyCJmCmYgo7RtfH6HvPL8LDVuhY2VNA/640?wx_fmt=png" data-type="png" data-w="504" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1MNdL8J3hWNY5jQuToy3XPvkNyCJmCmYgo7RtfH6HvPL8LDVuhY2VNA/640?wx_fmt=png"><figcaption>plot of chunk unnamed-chunk-33</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ</p><p data-tool="mdniceç¼–è¾‘å™¨">ç„¶åä½ å¯ä»¥å¾ªç¯å‡ºå›¾å¹¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œä¸è¿‡æˆ‘å¹¶æ²¡æœ‰ä½¿ç”¨ä¸Šé¢è¿™ç§èŠ±é‡Œèƒ¡å“¨çš„å›¾ï¼Œä½ å¯ä»¥è‡ªå·±ä¿®æ”¹ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>library</span>(purrr)<br><br>plot_listÂ &lt;-Â df_egfr_scatterÂ %&gt;%Â <br>Â Â split(.$cell_type)Â %&gt;%Â <span>#Â group_splitæ²¡æœ‰åå­—</span><br>Â Â map(~Â ggplot(.,Â aes(EGFR,score,color=sample_type))+<br>Â Â Â Â Â Â Â Â geom_point()+<br>Â Â Â Â Â Â Â Â geom_smooth(methodÂ =Â <span>"lm"</span>)+<br>Â Â Â Â Â Â Â Â stat_cor(methodÂ =Â <span>"spearman"</span>)+<br>Â Â Â Â Â Â Â Â scale_color_manual(valuesÂ =Â c(<span>'#FDD819'</span>,<span>'#028EA1'</span>))<br>Â Â Â Â Â Â )<br>pathsÂ &lt;-Â paste0(names(plot_list),<span>".png"</span>)<br><br>pwalk(list(paths,Â plot_list),ggsave,width=<span>6</span>,height=<span>3</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">28å¼ å›¾ç‰‡å·²ä¿å­˜åˆ°æœ¬åœ°ï¼š</p><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="2.6666666666666665" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1CMw5vUX1NaVrKos3psWLu2fb6wJxqhYKMa2YLz1bdZ1AaXcegib6s8A/640?wx_fmt=png" data-type="png" data-w="255" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1CMw5vUX1NaVrKos3psWLu2fb6wJxqhYKMa2YLz1bdZ1AaXcegib6s8A/640?wx_fmt=png"></figure><p data-tool="mdniceç¼–è¾‘å™¨">æ¯ä¸€å¼ éƒ½é•¿è¿™æ ·ï¼š</p><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.5018518518518519" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1M8dSUcI0w1icFibXibNLQaPTzr0KmuE5iaFyiazE6vr24WgtmmyE8QDVXpg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84RicYDkjNTbQxB04GqD4DODo1M8dSUcI0w1icFibXibNLQaPTzr0KmuE5iaFyiazE6vr24WgtmmyE8QDVXpg/640?wx_fmt=png"></figure><p data-tool="mdniceç¼–è¾‘å™¨">OKï¼Œå°±å…ˆä»‹ç»åˆ°è¿™é‡Œï¼Œå…³äºç»“æœçš„å¯è§†åŒ–ï¼Œæˆ‘è¿™é‡Œä»‹ç»çš„åªæ˜¯æœ€å¸¸è§çš„ï¼Œå†°å±±ä¸€è§’è€Œå·²ï¼Œæ¯•ç«Ÿå¯è§†åŒ–æ–¹æ³•å¤ªå¤šäº†ï¼Œä¸å¯èƒ½å…¨éƒ½ä»‹ç»åˆ°ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">å¤§å®¶å¦‚æœæœ‰å–œæ¬¢çš„å›¾å½¢ï¼Œå¯é€šè¿‡è¯„è®ºåŒºï¼Œç²‰ä¸QQç¾¤ç­‰æ–¹å¼å‘ç»™æˆ‘~</p></section><p data-tool="mdniceç¼–è¾‘å™¨"><br></p><hr><p>è§†é¢‘æ•™ç¨‹å¯å…³æ³¨<strong>æˆ‘çš„bç«™ï¼š</strong><span><strong>é˜¿è¶Šå°±æ˜¯æˆ‘<br></strong></span></p><hr><p><span>ğŸ”–ç²¾é€‰åˆé›†</span></p><hr><p><br></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2267367379124928515#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="128" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWnmVicKzO3qE6sRViarmG8ibJGRnCAI2eBuuzQ3dp4tx9K5gFfTdHA7Wpw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWnmVicKzO3qE6sRViarmG8ibJGRnCAI2eBuuzQ3dp4tx9K5gFfTdHA7Wpw/640?wx_fmt=png"></span></a></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2231476971388059661#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="556" data-cropsely1="0" data-cropsely2="124" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWibUpA8O16AzEGWhOwNKiciczAnjY9ySoq73UaJSAwaictMVUfMiab0W8bsQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWibUpA8O16AzEGWhOwNKiciczAnjY9ySoq73UaJSAwaictMVUfMiab0W8bsQ/640?wx_fmt=png"></span></a></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2255945345983627264#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWmN6Vhuk1PGPibib90QHGGMia2ecUAOPGabsJUFk3KoAw6vIdEu12F7ldw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWmN6Vhuk1PGPibib90QHGGMia2ecUAOPGabsJUFk3KoAw6vIdEu12F7ldw/640?wx_fmt=png"></span></a></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2393825487539191816#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWPFVPnORLaoL3szpia9vMic2ujGboXia3kZnhYASe5GhLeHVVrPmhmNojw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWPFVPnORLaoL3szpia9vMic2ujGboXia3kZnhYASe5GhLeHVVrPmhmNojw/640?wx_fmt=png"></span></a></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2232796937446014976#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWODjpibyGdCvjCnmVHGECMI9YEkrtN6rtVEHytkOVc8bMZyo2hrOLxRA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWODjpibyGdCvjCnmVHGECMI9YEkrtN6rtVEHytkOVc8bMZyo2hrOLxRA/640?wx_fmt=png"></span></a></p><p><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzOTQzNzU0NA==&amp;action=getalbum&amp;album_id=2216854859432116225#wechat_redirect" textvalue="ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="1"><span data-positionback="static"><img data-cropselx1="0" data-cropselx2="575" data-cropsely1="0" data-cropsely2="128" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWghjc1Vmgkic98WEnqEggHhfY9lDTyjU9TwXia1WQTmmx3tpPY7aTgE3Q/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R8LRib58e6MtiaIhf9gXpPUTWghjc1Vmgkic98WEnqEggHhfY9lDTyjU9TwXia1WQTmmx3tpPY7aTgE3Q/640?wx_fmt=png"></span></a></p></section></section></section></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YcUVElp0BEj5TxEqfSEkIQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
