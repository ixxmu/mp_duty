---
title: "正常组织与癌旁组织可以一视同仁吗？"
date: 2024-12-18T09:09:13Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
正常组织与癌旁组织可以一视同仁吗？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>书接上回，上一个被老板火眼金睛挑出来的数据集，详见：《</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535787&amp;idx=1&amp;sn=e53c68f76fe89c9ab47a2aeb9745ee40&amp;scene=21#wechat_redirect" data-linktype="2">2万个基因少一半也不影响最后的差异分析富集结果啊？</a><span>》</span><span></span></h3><p data-tool="mdnice编辑器">这次来看看 数据集：<span>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE161533</span>，共有84个 ESCC 样本：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052202" data-ratio="0.7045454545454546" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CjPxKavuOW560rtjCBwSkIy6OpnN2pMgRFXykYgFfUME67iajwueh8Rg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="880" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CjPxKavuOW560rtjCBwSkIy6OpnN2pMgRFXykYgFfUME67iajwueh8Rg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">吭哧吭哧一顿做完后，老板一看结果，<span><strong>有一半的case混入control，这肯定不对。</strong></span>老板解释道：癌症样本与癌旁样本肯定是可以分开的，你再回去看看。</p><p data-tool="mdnice编辑器">前面的分析结果如下：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052203" data-ratio="0.22037037037037038" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CX9d8feAbAeNAQzsE6kWFrAlm7eY3QEdLEnWxTJCfLvfw0MeZqlNKeg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CX9d8feAbAeNAQzsE6kWFrAlm7eY3QEdLEnWxTJCfLvfw0MeZqlNKeg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">回去后我就自己看了下我的分组，<span><strong>原来是因为样本中有三种组织类型，我只是将样本分成了两个组别：Normal一组，剩余的都是肿瘤组</strong></span><strong>：</strong></p><pre data-tool="mdnice编辑器"><code>gse_number &lt;- <span>"GSE161533"</span><br>dir.create(gse_number)<br>setwd(gse_number)<br>getwd()<br>list.files() <br><br><span>#gset &lt;- geoChina(gse_number)</span><br>gset &lt;- getGEO(gse_number, destdir = <span>'.'</span>, getGPL = T)<br>gset[[1]]<br>a &lt;- gset[[1]]<br><br><span>## 挑选一些感兴趣的临床表型。</span><br>pd &lt;- pData(a)<br>colnames(pd)<br>pd<span>$title</span><br>pd<span>$characteristics_ch1</span><br>table(pd<span>$characteristics_ch1</span>)<br><br><span>## ～～～分组信息编号需修改～～～</span><br><span>#group_list &lt;- ifelse(grepl('Normal',pd$title ,ignore.case = T ), "control","case")</span><br>group_list &lt;- ifelse(grepl(<span>'Normal'</span>,pd<span>$title</span> ,ignore.case = T ), <span>"control"</span>,<span>"case"</span>)<br>group_list &lt;- factor(group_list, levels = c(<span>"control"</span>,<span>"case"</span>))<br>table(group_list)<br></code></pre><p data-tool="mdnice编辑器">而数据中的分组为三分组：</p><pre data-tool="mdnice编辑器"><code>In total, there were 84 paired normal tissues, paratumor tissues, and tumor tissues from 28 ESCC patients were chosen to perform microarray analysis<br></code></pre><p data-tool="mdnice编辑器">三个组别，kimi解读：</p><blockquote data-tool="mdnice编辑器"><p>这句话描述的是在一个研究中，研究者从28位食管鳞状细胞癌（ESCC）患者那里收集了总共84对组织样本，这些样本包括正常组织、癌旁组织和肿瘤组织。这些样本被用来进行微阵列分析，这是一种基因表达分析技术。下面是这三个组织类型的简要区别：</p><ol><li><section><p><strong>正常组织（Normal Tissues）</strong>：</p></section></li></ol><ul><li><section>指的是没有癌症的健康组织。这些组织样本通常用来作为对照组，以比较和识别在癌症发生过程中基因表达的变化。</section></li><li><section>在食管鳞状细胞癌（ESCC）的研究中，正常组织可能是食管的非癌化部分，或者是远离肿瘤区域的健康食管组织。</section></li></ul><li><section><p><strong>癌旁组织（Para-tumoral Tissues）</strong>：</p></section></li><ul><li><section>癌旁组织是指紧挨着肿瘤的组织，但本身不是肿瘤的一部分。这些组织可能受到肿瘤微环境的影响，例如炎症、血管生成等。</section></li><li><section>在ESCC中，癌旁组织可能是食管组织，它们与肿瘤组织相邻，但尚未被癌细胞侵袭。</section></li></ul><li><section><p><strong>肿瘤组织（Tumor Tissues）</strong>：</p></section></li><ul><li><section>肿瘤组织是指已经发生癌变的组织，包含癌细胞。</section></li><li><section>在食管鳞状细胞癌（ESCC）中，肿瘤组织是食管中已经癌变的部分，这些组织样本包含了食管鳞状细胞癌的癌细胞。</section></li></ul><p>通过比较这三种不同类型的组织样本，研究者可以识别出哪些基因在癌症发展过程中发生了变化，这对于理解癌症的分子机制、发现新的生物标志物以及开发治疗策略都是非常重要的。微阵列分析可以提供关于成千上万个基因表达水平的数据，帮助研究者发现在正常、癌旁和肿瘤组织中表达差异的基因。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100052205" data-ratio="0.21666666666666667" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CXR7touicVCQ4YRumcibcddLy2QfCtzZp5mUialjk5Yj697mIwFRhul0Ww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CXR7touicVCQ4YRumcibcddLy2QfCtzZp5mUialjk5Yj697mIwFRhul0Ww/640?wx_fmt=png&amp;from=appmsg"><figcaption><br></figcaption></figure><p data-tool="mdnice编辑器">这样就可以解释通了。</p><p data-tool="mdnice编辑器"><span><strong>这里你可以看到 癌旁组织与正常健康对照组完全分在了一起，那么：实际中我们能 将 癌旁组织与正常健康对照 都看做正常样本吗？</strong></span></p><h4 data-tool="mdnice编辑器"><span></span>接下来简单看一下 两次差异，癌症和癌旁，癌症和正常，对比结果：<span></span></h4><h4 data-tool="mdnice编辑器"><span></span>首先是 癌症和癌旁 差异分析：<span></span></h4><pre data-tool="mdnice编辑器"><code><span>source</span>(<span>'../scripts/run_DEG.R'</span>)<br>kp &lt;- group_list %<span>in</span>% c(<span>'tumor'</span>,<span>'paratumor'</span>);table(kp)<br>group_list1 &lt;- group_list[kp]<br>group_list1 &lt;- factor(group_list1, levels = c(<span>'paratumor'</span>,<span>'tumor'</span>))<br>group_list1<br>dat1 &lt;- dat[,kp]<br>dim(dat1)<br>deg &lt;- run_DEG(dat1, group_list1, target_gene=c(<span>'ESR1'</span>),pro=gse_number,path=<span>'./DEG1'</span>)<br>head(deg)<br>table(deg<span>$g</span>)<br></code></pre><p data-tool="mdnice编辑器">差异结果如下：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052206" data-ratio="0.39351851851851855" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2ChP1Y4nEPYg0ydAQRicBCL1oLzT1K8WyoB7Qyau9rvNCySibGlUaEhlbg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2ChP1Y4nEPYg0ydAQRicBCL1oLzT1K8WyoB7Qyau9rvNCySibGlUaEhlbg/640?wx_fmt=png&amp;from=appmsg"><figcaption>癌症和癌旁 差异分析</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span>然后是 癌症和正常 差异分析：<span></span></h4><pre data-tool="mdnice编辑器"><code><span>source</span>(<span>'../scripts/run_DEG.R'</span>)<br>group_list<br>kp &lt;- group_list %<span>in</span>% c(<span>'tumor'</span>,<span>'normal'</span>);table(kp)<br>group_list1 &lt;- group_list[kp]<br>group_list1 &lt;- factor(group_list1, levels = c(<span>'normal'</span>,<span>'tumor'</span>))<br>group_list1<br>dat1 &lt;- dat[,kp]<br>dim(dat1)<br>deg &lt;- run_DEG(dat1, group_list1, target_gene=c(<span>'ESR1'</span>),pro=gse_number,path=<span>'./DEG2'</span>)<br>head(deg)<br>table(deg<span>$g</span>)<br></code></pre><p data-tool="mdnice编辑器">差异结果如下：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052204" data-ratio="0.3861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2C6ia56xSjS9hyibuKt5MiaGgia9SeE17IdEk982UhPNtia5qyaHj1JgVWbRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2C6ia56xSjS9hyibuKt5MiaGgia9SeE17IdEk982UhPNtia5qyaHj1JgVWbRQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>癌症和正常 差异分析</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span>两次差异结果比较：<span></span></h4><pre data-tool="mdnice编辑器"><code>library(data.table)<br>deg1 = fread(file = <span>'./DEG1/DEG.csv'</span>,data.table = F)<br>deg2 = fread(file = <span>'./DEG2/DEG.csv'</span>,data.table = F)<br><br>colnames(deg1)<br>colnames(deg2)<br>head(deg1)<br>head(deg2)<br><br>rownames(deg1)=deg1<span>$name</span> <br>rownames(deg2)=deg2<span>$name</span><br><br>ids=intersect(rownames(deg1),<br>              rownames(deg2))<br>df= data.frame(<br>  deg1 = deg1[ids,<span>'logFC'</span>],<br>  deg2 = deg2[ids,<span>'logFC'</span>]<br>)<br>rownames(df)=ids<br>head(df)<br><br>library(ggpubr)<br>p=ggscatter(df, x = <span>"deg1"</span>, y = <span>"deg2"</span>,<br>            color = <span>"black"</span>, shape = 21, size = 3, <span># Points color, shape and size</span><br>            add = <span>"reg.line"</span>,  <span># Add regressin line</span><br>            add.params = list(color = <span>"blue"</span>, fill = <span>"lightgray"</span>), <span># Customize reg. line</span><br>            conf.int = TRUE, <span># Add confidence interval</span><br>            cor.coef = TRUE, <span># Add correlation coefficient. see ?stat_cor</span><br>            cor.coeff.args = list(method = <span>"pearson"</span>,  label.sep = <span>"\n"</span>)<br>) <br>p=p+geom_hline(yintercept = -1, linetype = <span>"dashed"</span>, color = <span>"blue"</span>) +<br>  geom_hline(yintercept = 0, linetype = <span>"dotted"</span>, color = <span>"red"</span>) +<br>  geom_hline(yintercept = 1, linetype = <span>"longdash"</span>, color = <span>"green"</span>) +<br>  geom_vline(xintercept = -1, linetype = <span>"dashed"</span>, color = <span>"blue"</span>) +<br>  geom_vline(xintercept = 0, linetype = <span>"dotted"</span>, color = <span>"red"</span>) +<br>  geom_vline(xintercept = 1, linetype = <span>"longdash"</span>, color = <span>"green"</span>)<br>p<br>ggsave(<span>'cor-of-two-logFC.pdf'</span>, width = 6, height = 5)<br></code></pre><p data-tool="mdnice编辑器">这两次差异分析结果的每个基因的FC值相关性非常高：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052208" data-ratio="0.8207282913165266" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CC5cxvC5qIlEgJPMwHSKia4HgxUY2SdEuDgyaTEGHWn8bmbB23730FibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="714" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CC5cxvC5qIlEgJPMwHSKia4HgxUY2SdEuDgyaTEGHWn8bmbB23730FibQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>i </figcaption></figure><p data-tool="mdnice编辑器">再看一下各自的上下调基因交集：</p><pre data-tool="mdnice编辑器"><code>df= data.frame(<br>  deg1 = deg1[ids,<span>'g'</span>],<br>  deg2 = deg2[ids,<span>'g'</span>]<br>)<br>table(df)<br>gplots::balloonplot(table(df))<br></code></pre><p data-tool="mdnice编辑器">这两次差异分析结果是高度一致的，只不过因为阈值原因可能有一些显著变为不显著：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100052207" data-ratio="0.723196881091618" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CgURday43v5X3Oyms7h2MF0ZsrXmEvxLcYpicvNYLr9DBE4I7JzpktIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1026" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CgURday43v5X3Oyms7h2MF0ZsrXmEvxLcYpicvNYLr9DBE4I7JzpktIg/640?wx_fmt=png&amp;from=appmsg"></figure><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>居然<span>正常组织与癌旁组织在差异分析时可以一视同仁？</span></span><span><span><br></span></span><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">起初看到这个结果我是一脸懵逼的， 因为看起来这个数据集里面的肿瘤样品的表达量相当于癌旁或者正常这两个不同的分组做差异，居然两次独立的差异分析结果完美的重叠！也就是说，我们无论是取<span>癌旁或者正常组织，作为肿瘤样品的对照都是ok的。</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">但是我之前看到了加州大学旧金山分校的研究团队在2017的发表在《Nature Communications》期刊上的文章，标题是“Comprehensive analysis of normal adjacent to tumor transcriptomes”，提出来了一个不太一样的观点，因为研究者做了泛癌的研究，发现在每个癌症里面，<span>通过t-SNE（t-distributed Stochastic Neighbor Embedding）技术展示了不同组织类型的转录组数据的降维结果。<strong>肿瘤旁边组织（即癌旁组织，Normal Adjacent to Tumor, NAT）在健康样本和肿瘤样本之间形成了一个独特的中间状态。</strong></span></p><p><img data-galleryid="" data-imgfileid="100052212" data-ratio="0.5851851851851851" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CJZLMJk9WC7Tk05qL4zUicIV3nSGrJnh5MGoVYYBpMFDK5oGEO0VrC2Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CJZLMJk9WC7Tk05qL4zUicIV3nSGrJnh5MGoVYYBpMFDK5oGEO0VrC2Q/640?wx_fmt=png&amp;from=appmsg"></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>学徒作业：</span><span></span></h3><p data-tool="mdnice编辑器">到底是泾渭分明呢，还是混淆在一起呢， 这个癌旁组织和正常组织，它们肯定是与癌症样品完全不一样。但是癌旁组织和正常组织的差异到底有多大呢？<strong>这次需要大家去找到其它癌症的类似的数据集，需要里面同时包含了癌旁组织和正常组织以及肿瘤组织，无论是表达量芯片还是转录组测序，都可以。</strong><span><strong>比如GSE44076这个数据集，就是<strong><span>paired normal adjacent mucosa and tumor samples from 98 individuals and 50 healthy colon mucosae</span></strong></strong></span></p><p data-tool="mdnice编辑器"><strong>因为是同一个数据集因为这样的话没有批次效应。</strong><span><strong>（尤其需要注意两次独立的差异分析的相关性到底是多大？）</strong></span></p></section><p><img data-galleryid="" data-imgfileid="100052217" data-ratio="0.43425925925925923" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CBibZGGCmhWauCPBRbxXvLG9rKB1XPSNoqYXu73MpH5toBJu3JP0Mftg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzwiceJMYSX8k7qrx8ORZJ2CBibZGGCmhWauCPBRbxXvLG9rKB1XPSNoqYXu73MpH5toBJu3JP0Mftg/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p></section></section><span><span></span></span></h3></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/gppvOcgaeLddAYfpvmx7lQ",target="_blank" rel="noopener noreferrer">原文链接</a>
