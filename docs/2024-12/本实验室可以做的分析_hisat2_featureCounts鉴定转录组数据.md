---
title: "本实验室可以做的分析：hisat2+featureCounts鉴定转录组数据"
date: 2024-12-12T23:31:23Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
本实验室可以做的分析：hisat2+featureCounts鉴定转录组数据 by 东林的扯淡小屋
------
<div><section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span>ls</span><span> *_R1.fq.gz | </span><span>cut</span><span> -d </span><span>"_"</span><span> -f 1,2 | </span><span>sort</span><span> -u | sed </span><span>'s/_R1.fq.gz//g'</span><span> | </span><span>tr</span><span> </span><span>'\n'</span><span> </span><span>','</span><span> | sed </span><span>'s/,$//'</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>for</span><span> i </span><span>in</span><span> {};</span></span></code><code><span leaf=""><span>do</span><span> </span></span></code><code><span leaf=""><span>cutadapt --pair-filter=any --minimum-length 15 --max-n 8 -a AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -A AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -o ./clean/</span><span>${i}</span><span>_rmadp_1.fq.gz -p ./clean/</span><span>${i}</span><span>_rmadp_2.fq.gz </span><span>${i}</span><span>_R1.fq.gz </span><span>${i}</span><span>_R2.fq.gz &gt;&gt;filter.txt 2&gt;&amp;1</span></span></code><code><span leaf=""><span>trimmomatic PE -threads 40 -phred33 ./clean/</span><span>${i}</span><span>_rmadp_1.fq.gz ./clean/</span><span>${i}</span><span>_rmadp_2.fq.gz -baseout ./clean/</span><span>${i}</span><span>_fliter.fq.gz  AVGQUAL:20 SLIDINGWINDOW:4:15 MINLEN:15 1&gt;&gt;filter.txt 2&gt;&amp;1;</span></span></code><code><span leaf=""><span>hisat2 --threads 35 -x /data/yudonglin/reference/mouse/mm10/hisat2/mm10 -1 ./clean/</span><span>${i}</span><span>_fliter_1P.fq.gz -2 ./clean/</span><span>${i}</span><span>_fliter_2P.fq.gz -S ./hisat/</span><span>${i}</span><span>.sam;</span></span></code><code><span leaf=""><span>samtools view -S ./hisat/</span><span>${i}</span><span>.sam -b &gt; ./hisat/</span><span>${i}</span><span>.bam;</span></span></code><code><span leaf=""><span>rm</span><span> ./hisat/</span><span>${i}</span><span>.sam;</span></span></code><code><span leaf=""><span>samtools </span><span>sort</span><span> ./hisat/</span><span>${i}</span><span>.bam -o ./hisat/</span><span>${i}</span><span>_sorted.bam;</span></span></code><code><span leaf=""><span>samtools index ./hisat/</span><span>${i}</span><span>_sorted.bam;</span></span></code><code><span leaf=""><span>featureCounts -T 30 -t exon -g gene_id -a /data/yudonglin/reference/mouse/mm10/Mus_musculus.GRCm38.102.gtf -o ./count/</span><span>${i}</span><span>.count ./hisat/</span><span>${i}</span><span>_sorted.bam &gt;&gt;~/count.txt 2&gt;&amp;1</span></span></code><code><span leaf=""><span>bamCoverage --bam ./hisat/</span><span>${i}</span><span>_sorted.bam -o ./hisat/</span><span>${i}</span><span>_sorted.bam.bw  --binSize 10 -p 40</span></span></code><code><span leaf=""><span>#rm ./hisat/${i}.bam;</span></span></code><code><span leaf=""><span>done</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>for i in {};</span></span></code><code><span leaf=""><span>do </span></span></code><code><span leaf=""><span>#cutadapt --pair-filter=any --minimum-length 15 --max-n 8 -a AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC -A AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT -o ./clean/${i}_rmadp_1.fq.gz -p ./clean/${i}_rmadp_2.fq.gz ${i}_R1.fq.gz ${i}_R2.fq.gz &gt;&gt;filter.txt 2&gt;&amp;1</span></span></code><code><span leaf=""><span>#trimmomatic PE -threads 40 -phred33 ./clean/${i}_rmadp_1.fq.gz ./clean/${i}_rmadp_2.fq.gz -baseout ./clean/${i}_fliter.fq.gz  AVGQUAL:20 SLIDINGWINDOW:4:15 MINLEN:15 1&gt;&gt;filter.txt 2&gt;&amp;1;</span></span></code><code><span leaf=""><span>hisat2 --threads 35 -x /data/yudonglin/reference/human/hg19/hisat2/hg19 -1 ./clean/${i}_fliter_1P.fq.gz -2 ./clean/${i}_fliter_2P.fq.gz -S ./hisat/${i}.sam;</span></span></code><code><span leaf=""><span>samtools view -S ./hisat/${i}.sam -b &gt; ./hisat/${i}.bam;</span></span></code><code><span leaf=""><span>rm ./hisat/${i}.sam;</span></span></code><code><span leaf=""><span>samtools sort ./hisat/${i}.bam -o ./hisat/${i}_sorted.bam;</span></span></code><code><span leaf=""><span>samtools index ./hisat/${i}_sorted.bam;</span></span></code><code><span leaf=""><span>featureCounts -T 30 -t exon -g gene_id -a /data/yudonglin/reference/human/hg19/Homo_sapiens.GRCh37.75.gtf -o ./count/${i}.count ./hisat/${i}_sorted.bam &gt;&gt;~/count.txt 2&gt;&amp;1</span></span></code><code><span leaf=""><span>bamCoverage --bam ./hisat/${i}_sorted.bam -o ./hisat/${i}_sorted.bam.bw  --binSize 10 -p 40</span></span></code><code><span leaf=""><span>#rm ./hisat/${i}.bam;</span></span></code><code><span leaf=""><span>done</span></span></code></pre></section></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBricicFNLOEKibZHMftxcVVu2JZG594XY6N1fAnHkWKC4iaOIWbSxeWxlA88VF3HibrdkUHJMCzDfyr24Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2361111111111111" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100027825" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBricicFNLOEKibZHMftxcVVu2JZG594XY6N1fAnHkWKC4iaOIWbSxeWxlA88VF3HibrdkUHJMCzDfyr24Q/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf="">转录组分析基本就是入门级别了。</span></section><section nodeleaf=""><span></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/V9yNCpaNWl5alXjFSEIlxA",target="_blank" rel="noopener noreferrer">原文链接</a>
