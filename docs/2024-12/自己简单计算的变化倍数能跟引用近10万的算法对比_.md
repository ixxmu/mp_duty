---
title: "自己简单计算的变化倍数能跟引用近10万的算法对比？"
date: 2024-12-16T14:33:53Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
自己简单计算的变化倍数能跟引用近10万的算法对比？ by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>一个小伙伴表示他在处理两分组的转录组测序后的count矩阵的时候，发现手动计算的变化倍数跟金标准算法（DESeq2，edgeR，limma-voom）计算的不一样！</p></blockquote><p data-tool="mdnice编辑器">这个超级正常的，我们首先让人工智能大模型解释一下手动计算两分组的count矩阵中基因表达量的变化倍数（fold change）的过程：</p><p><img data-galleryid="" data-imgfileid="100046549" data-ratio="0.5620214395099541" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicIIFJRuxkurgFwrvS3kaHcFXS3XiaTNuA2NdhRRKf8bJ7mmFodAErtTXK2R1ltibdbyRFdibu6WMmFg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1306" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicIIFJRuxkurgFwrvS3kaHcFXS3XiaTNuA2NdhRRKf8bJ7mmFodAErtTXK2R1ltibdbyRFdibu6WMmFg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>变化倍数（fold change）</figcaption></figure><p data-tool="mdnice编辑器">我自己写过一个代码：</p><pre data-tool="mdnice编辑器"><span></span><code>load(file = <span>'./symbol_matrix.Rdata'</span>)<br>table(group_list)<br>group_list<br>symbol_matrix[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>] <span>## 基因名字的样品，矩阵</span><br>dat = log2(edgeR::cpm(symbol_matrix)+<span>1</span>)<br>dat[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span># 转换为长格式</span><br><span>library</span>(reshape2)<br>melted_data &lt;- melt(dat, <br>                    varnames = c(<span>"Gene"</span>, <span>"Sample"</span>), <br>                    value.name = <span>"ExpressionLevel"</span>)<br><span>library</span>(ggplot2)<br>ggplot(melted_data, aes(x = ExpressionLevel, fill = Sample)) +<br>  geom_density(alpha = <span>0.5</span>) +<br>  labs(title = <span>"Density Plot with Genes of Interest"</span>, <br>       x = <span>"Expression Level"</span>, y = <span>"Density"</span>) +<br>  theme_minimal()<br><br>mylogFC=rowMeans(dat[,<span>4</span>:<span>6</span>])-rowMeans(dat[,<span>1</span>:<span>3</span>])<br><br></code></pre><p data-tool="mdnice编辑器">然后我们很容易去拿到金标准算法（DESeq2，edgeR，limma-voom）的差异分析结果进行对比：</p><pre data-tool="mdnice编辑器"><span></span><code>load( file =  <span>'deg-raw/DEG_deseq2.Rdata'</span> )<br>head(DEG_deseq2)<br>df=data.frame(<br>  deseq2=DEG_deseq2$log2FoldChange,<br>  my=mylogFC[match(rownames(DEG_deseq2),names(mylogFC))]<br>)<br>head(df)<br>plot(df)<br>boxplot(dat[<span>'MKNK1'</span>,] ~group_list)<br>DEG_deseq2[<span>'MKNK1'</span>,]<br>df[<span>'MKNK1'</span>,]<br>plot(abs(DEG_deseq2$log2FoldChange),log(DEG_deseq2$baseMean+<span>1</span>))<br><br></code></pre><p data-tool="mdnice编辑器">就可以看到，两者其实很容易冲突，因为金标准算法（DESeq2，edgeR，limma-voom）考虑到的事情更多，毕竟是引用近10万的算法啊！</p><p><img data-galleryid="" data-imgfileid="100046548" data-ratio="0.5953038674033149" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicIIFJRuxkurgFwrvS3kaHc2jYhZT7ujVaYMoeuPxPibGDjP8DrnBviccH1ibn3MZqQwnnchesJTQarg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1448" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicIIFJRuxkurgFwrvS3kaHc2jYhZT7ujVaYMoeuPxPibGDjP8DrnBviccH1ibn3MZqQwnnchesJTQarg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>引用近10万的算法</figcaption></figure><p data-tool="mdnice编辑器">如果加上另外的两个包，轻轻松松破十万啊 ：</p><ul data-tool="mdnice编辑器"><li><section>作者：MD Robinson · 2010 · 被引用次数：39135</section></li><li><section>作者：ME Ritchie · 2015 · 被引用次数：31689</section></li></ul><p data-tool="mdnice编辑器">如果大家简简单单的随随便便的就能计算变化倍数， 那要这些引用近10万的算法干啥子？</p><h3 data-tool="mdnice编辑器"><span></span><span>其实大部分基因并不会冲突</span><span></span></h3><p data-tool="mdnice编辑器">人类的gtf文件里面记录的五六万基因里面，只有不到两万是蛋白质编码基因，去除5000低表达量的，剩下的一万多基因其实使用金标准算法（DESeq2，edgeR，limma-voom）拿到的变化倍数跟自己简单单的随随便便的就能计算变化倍数，并不会冲突很多。</p><p data-tool="mdnice编辑器">但是有一些时候确实是会出现大面积冲突，因为可能会某个组里面的某一些样品有离群点基因。正常情况下每个转录组测序的样品会两千万个reads，平均到两万个基因应该是每个基因1000左右的reads，但是等于核糖体和线粒体它们每个基因可以有几百万个reads，非常的浪费你的测序。<strong>这个时候，如果有一个样品的两千万个reads里面的一千万都是核糖体和线粒体，它就影响了你手动计算变化倍数，但是并不会影响金标准算法（DESeq2，edgeR，limma-voom）。因为金标准算法（DESeq2，edgeR，limma-voom）会考虑到这样的离群点基因。</strong></p></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Ahx0ziE8GoPnGPuK-bwz1g",target="_blank" rel="noopener noreferrer">原文链接</a>
