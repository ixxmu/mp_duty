---
title: "【R语言】HPAanalyze下载HPA免疫组化图"
date: 2024-12-12T10:18:58Z
draft: ["false"]
tags: [
  "fetched",
  "生信交流平台"
]
categories: ["Acdemic"]
---
【R语言】HPAanalyze下载HPA免疫组化图 by 生信交流平台
------
<div><p><img data-backh="188" data-backw="574" data-before-oversubscription-url="https://mmbiz.qpic.cn/mmbiz_gif/nZw6FoVHqJbhdN6aMwuR9wQdBJic0I1v3nqo7Pb7PD6lcmPI4jsT6OpXfLybg3ic5wDsce6LjFxia4ZKVunI6kcsg/640?wx_fmt=gif" data-ratio="0.3275862068965517" data-src="https://mmbiz.qpic.cn/mmbiz_gif/nZw6FoVHqJbhdN6aMwuR9wQdBJic0I1v3nqo7Pb7PD6lcmPI4jsT6OpXfLybg3ic5wDsce6LjFxia4ZKVunI6kcsg/640?wx_fmt=gif" data-type="gif" data-w="638" data-imgfileid="501750932" src="https://mmbiz.qpic.cn/mmbiz_gif/nZw6FoVHqJbhdN6aMwuR9wQdBJic0I1v3nqo7Pb7PD6lcmPI4jsT6OpXfLybg3ic5wDsce6LjFxia4ZKVunI6kcsg/640?wx_fmt=gif"></p><p><span><strong>关注下方公众号，get更多生信技能☟☟☟</strong></span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI4ODE0NTE3OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/nZw6FoVHqJYEygibUYdes2QW53MEDjeVDvt0c90QD97gTaP89zXibPq5H8JpGNxvggYN1ZlHEhkyu7gjPgUUx9Ew/0?wx_fmt=png" data-nickname="生信交流平台" data-alias="bifxplatform" data-signature="生信博士，分享生信知识，交流学习和工作中get的生信技能。提供一个学习和交流生信的平台。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section>前面小编给大家分享了</section><section><span>☞ <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4ODE0NTE3OA==&amp;mid=2649233407&amp;idx=1&amp;sn=c7349c67c02e49bdcaebc89768d9e108&amp;chksm=f3de5d8ac4a9d49c725eb3356d55165b112ce1ffa7ac5dfb714718f94c3cca6eac7e92d78403&amp;scene=21#wechat_redirect" textvalue="人蛋白质数据库（HPA，human protein Atlas）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">人蛋白质数据库（HPA，human protein Atlas）</a></span></section><section><span>☞ <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4ODE0NTE3OA==&amp;mid=2649233503&amp;idx=1&amp;sn=29b3b6f7fc7787e63f5476bd8651f323&amp;chksm=f3de522ac4a9db3c8c1a4cc1d16bdaea52d5b486ad8b07ed3bc372fd5fd9b1e738135ba9f504&amp;scene=21#wechat_redirect" textvalue="HPA(human protein atlas)数据库介绍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="5" tab="innerlink" data-linktype="2">HPA(human protein atlas)数据库介绍</a></span></section><section><span>☞ <a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI4ODE0NTE3OA==&amp;mid=2649233721&amp;idx=1&amp;sn=c6dfd48d743610aeca243bfc681a149b&amp;scene=21#wechat_redirect" textvalue="HPA数据库下载免疫组化原图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">HPA数据库下载免疫组化原图</a></span></section><section><br></section><section>今天小编继续给大家分享一个利用R代码下载HPA数据库中免疫组化图片的方法，，废话不多说，直接上代码</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span><span>#加载相关的R包</span></span></code><code><span>library(HPAanalyze)</span></code><code><span>library(clusterProfiler)</span></code><code><span>library(dplyr)</span></code><code><span><br></span></code><code><span><span>#这里以F12基因为例，根据自己的需要修改基因名字</span></span></code><code><span>ens_id=bitr(geneID=<span>"F12"</span>, fromType=<span>"SYMBOL"</span>, toType=<span>"ENSEMBL"</span>, OrgDb=<span>"org.Hs.eg.db"</span>)</span></code><code><span><br></span></code><code><span><span>#输入查询基因的ensembl gene ID，获取相关信息</span></span></code><code><span>xml &lt;- hpaXmlGet(ens_id<span>$ENSEMBL</span>)</span></code><code><span><br></span></code><code><span><span>#抗体信息查询,提取用于特定蛋白质的抗体的信息</span></span></code><code><span>ab &lt;- hpaXmlAntibody(xml)</span></code><code><span><span>#查看抗体信息, 这个基因只有一个抗体HPA003825 的数据</span></span></code><code><span>ab</span></code><code><span><br></span></code><code><span><span>#导入xml文档，提取每个样本的组织表达信息和url，以便下载图像</span></span></code><code><span>expr &lt;- hpaXmlTissueExpr(xml)</span></code><code><span><br></span></code><code><span><span>#expr[[1]]获取第一个抗体的信息，如果有多个抗体，这里需要填对应的数字</span></span></code><code><span><span>#与ab输出的顺序一致</span></span></code><code><span><span>data</span> &lt;- expr[[<span>1</span>]]</span></code><code><span><br></span></code><code><span><span>#输出所有免疫组化图片的链接，</span></span></code><code><span><span>#可以直接使用链接下载图片，一共有311张图片</span></span></code><code><span><span>#下面会循环批量下载</span></span></code><code><span><span>data</span><span>$imageUrl</span></span></code><code><span><br></span></code><code><span><span>#可以先到HPA数据库，找到想要下载的图片对应的病人ID号</span></span></code><code><span>patiendID=c(<span>"2072"</span>,<span>"1014"</span>)</span></code><code><span><span>#提取所需的样本的信息</span></span></code><code><span><span>data</span>2 &lt;- data[data<span>$patientId</span> %<span>in</span>% patiendID,]</span></code><code><span>dim(<span>data</span>2)</span></code><code><span><span>#[1]  2 18</span></span></code><code><span><br></span></code><code><span><span>#两个病人中F12蛋白免疫组化的图片链接</span></span></code><code><span><span>data</span>2<span>$imageUrl</span></span></code><code><span><span># [1] "https://images.proteinatlas.org/3825/11033_B_2_5.jpg"</span></span></code><code><span><span># [2] "https://images.proteinatlas.org/3825/11031_A_3_3.jpg"</span></span></code><code><span><br></span></code><code><span><br></span></code><code><span><span>#创建文件夹存放下载的图片</span></span></code><code><span>dir.create(<span>"img"</span>)</span></code><code><span><span>#循环批量下载两张图片</span></span></code><code><span><span>for</span> (i <span>in</span> <span>1</span>:nrow(<span>data</span>2)){</span></code><code><span>  download.file(<span>data</span>2<span>$imageUrl</span>[i],</span></code><code><span>                destfile = paste0(<span>"img/"</span>,</span></code><code><span>                                  <span>data</span>2<span>$patientId</span>[i],</span></code><code><span>                                  <span>".jpg"</span>),</span></code><code><span>                mode = <span>"wb"</span>)</span></code><code><span>}</span></code><code><span><br></span></code></pre></section><section>运行完之后，在img文件夹就会得到两张免疫组化的图<br></section><p><img data-galleryid="" data-imgfileid="501750936" data-ratio="0.48891786179921776" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/nZw6FoVHqJaUrOYmnfAP4rvWYfQhqL2icbytOrnH0rG5pNMcDVQlC5R2Kh4OaAOEU4QVosupsic21dkIKr1rR3IA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="767" src="https://mmbiz.qpic.cn/mmbiz_png/nZw6FoVHqJaUrOYmnfAP4rvWYfQhqL2icbytOrnH0rG5pNMcDVQlC5R2Kh4OaAOEU4QVosupsic21dkIKr1rR3IA/640?wx_fmt=png&amp;from=appmsg"></p><section><span></span></section><section><br></section><section>不会R语言的同学，可以参考下文进行下载，不需要编写代码。</section><section><span>☞ </span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI4ODE0NTE3OA==&amp;mid=2649233721&amp;idx=1&amp;sn=c6dfd48d743610aeca243bfc681a149b&amp;scene=21#wechat_redirect" textvalue="HPA数据库下载免疫组化原图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">HPA数据库下载免疫组化原图</a></section><section><br></section><section><br></section><section><span><strong>为了方便大家交流学习，共同进步，我特地创建了微信交流群</strong></span></section><p><strong><strong>后台留言“生信交流群”入群</strong></strong></p><p><img data-galleryid="" data-ratio="0.4050420168067227" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/nZw6FoVHqJYl4iawvPeN2mTbn453e4egk08ZiasvINASHMklicibibWOj9bGYcICthABaIM44WcwictaATVFJQ3BoKLg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="595" data-imgfileid="501750933" src="https://mmbiz.qpic.cn/mmbiz_png/nZw6FoVHqJYl4iawvPeN2mTbn453e4egk08ZiasvINASHMklicibibWOj9bGYcICthABaIM44WcwictaATVFJQ3BoKLg/640?wx_fmt=png&amp;from=appmsg"></p><p><br></p><section powered-by="xiumi.us"><br></section><section powered-by="xiumi.us"><p><br></p></section><p><br></p><section powered-by="xiumi.us"><p><span><strong>往期精彩内容</strong></span><span>(点击跳转)</span><span></span></p></section><section powered-by="xiumi.us"><table><tbody><tr><td width="123" valign="top"><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span><span>☞</span>R语言</span></a></section><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1587931358163730433#wechat_redirect" textvalue="R&amp;Rsudio视频" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>R&amp;Rsudio视频</span></a></section></td><td width="123" valign="top"><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1753096826628440072#wechat_redirect" textvalue="TCGA数据分析" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>TCGA数据分析</span></a></section><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1587941925645549568#wechat_redirect" textvalue="TCGA视频讲解" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>TCGA视频讲解</span></a></section></td><td width="123" valign="top"><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1777690989290160137#wechat_redirect" textvalue="GEO数据分析" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>GEO数据分析</span></a></section><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1764701291676532746#wechat_redirect" textvalue="GEO视频讲解" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>GEO视频讲解</span></a></section></td></tr><tr><td width="123" valign="top"><section><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1919787265644396545#wechat_redirect" textvalue="GO/KEGG富集分析" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>GO/KEGG富集分析</span></a></section></td><td width="123" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1686378508752617479#wechat_redirect" textvalue="科研绘图" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>科研绘图</span></a><br><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1664687332270112771#wechat_redirect" textvalue="科研图怎么看" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>科研图怎么看</span></a></td><td width="123" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1353048882263015424#wechat_redirect" textvalue="单细胞测序" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>单细胞测序</span></a></td></tr><tr><td width="123" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1345837080034852866#wechat_redirect" textvalue="python" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1612054102262251523#wechat_redirect" textvalue="miRNA靶基因" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>miRNA靶基因</span></a></td><td width="123" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1861869103813066756#wechat_redirect" textvalue="ceRNA网络构建" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>ceRNA网络构建</span></a></td><td width="123" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1645851265026850824#wechat_redirect" textvalue="m6A甲基化" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>m6A甲基化</span></a></td></tr><tr><td width="171" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1800390113982513153#wechat_redirect" textvalue="差异表达分析" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>差异表达分析</span></a></td><td width="171" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1861875000132075521#wechat_redirect" textvalue="Linux" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>Linux</span></a></td><td width="171" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1345837080034852866#wechat_redirect" textvalue="python" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>python</span></a></td></tr><tr><td width="171" valign="top"><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=2459967289002475524#wechat_redirect" textvalue="生存分析" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>生存分析</span></a><br><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1341421068984172544#wechat_redirect" textvalue="R语言" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>☞</span></a><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4ODE0NTE3OA==&amp;action=getalbum&amp;album_id=1679232720675110916#wechat_redirect" textvalue="零代码生存曲线" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2"><span>零代码生存曲线</span></a></td><td width="171" valign="top"><br></td><td width="171" valign="top"><br></td></tr></tbody></table><p><br></p></section><p><br></p><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LWfeevTiJ_AcYNkJWq_NUg",target="_blank" rel="noopener noreferrer">原文链接</a>
