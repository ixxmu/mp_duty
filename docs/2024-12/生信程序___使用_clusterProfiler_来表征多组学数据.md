---
title: "生信程序 | 使用 clusterProfiler 来表征多组学数据"
date: 2024-12-21T02:53:42Z
draft: ["false"]
tags: [
  "fetched",
  "BioJournal Link"
]
categories: ["Acdemic"]
---
生信程序 | 使用 clusterProfiler 来表征多组学数据 by BioJournal Link
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100007903" data-ratio="0.4425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJKRqDVb7TcPmCbh6ofhibarQqeial4XCMrLjYYg8CjPdhlNgcUvIUUSaQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJKRqDVb7TcPmCbh6ofhibarQqeial4XCMrLjYYg8CjPdhlNgcUvIUUSaQ/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Basic Information</span></span><span></span><span></span></h2><ul><li><section><span leaf="">英文标题： Using clusterProfiler to characterize multiomics data</span></section></li><li><section><span leaf="">中文标题：使用 clusterProfiler 来表征多组学数据</span></section></li><li><section><span leaf="">发表日期：17 July 2024</span></section></li><li><section><span leaf="">文章类型：Protocol</span></section></li><li><section><span leaf="">所属期刊：Nature Protocols</span></section></li><li><section><span leaf="">文章作者：Shuangbin Xu | Guangchuang Yu</span></section></li><li><section><span leaf="">文章链接：https://www.nature.com/articles/s41596-024-01020-z</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Abstract</span></span><span></span><span></span></h2><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">随着多组学的出现，能够进行多维富集分析的软件对于揭示生物过程和疾病通路中的基因集变化变得越来越重要。</span></section></li><li><section><span leaf="">这对于阐明疾病机制和识别潜在的治疗靶点至关重要。</span></section></li><li><section><span leaf="">clusterProfiler 以其对数据库的全面利用和高级可视化功能脱颖而出。</span></section></li><li><section><span leaf="">重要的是，clusterProfiler 支持多种生物学知识，包括基因本体论和京都基因与基因组百科全书，通过执行过度表达和基因集富集分析。</span></section></li><li><section><span leaf="">一个关键特性是 clusterProfiler 允许用户选择不同的图形输出以可视化结果，从而增强解释性。</span></section></li><li><section><span leaf="">本协议描述了 clusterProfiler 在整合代谢组学和宏基因组学分析、鉴定和表征应激条件下的转录因子以及注释单细胞研究中的创新应用方式。</span></section></li><li><section><span leaf="">在所有情况下，计算步骤可以在约 2 分钟内完成。</span></section></li><li><section><span leaf="">clusterProfiler 通过 Bioconductor 项目发布，可以通过 https://bioconductor.org/packages/clusterProfiler/ 访问。</span></section></li></ol><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Key points</span></span><span></span><span></span></h2><ul><li><section><p><strong><span leaf="">clusterProfiler</span></strong><span leaf=""> 是一个用于表征和解释组学数据的软件包。功能富集可以通过过度代表性分析（Over-Representation Analysis, ORA）或基因集富集分析（Gene Set Enrichment Analysis, GSEA）实现；它支持使用多种数据库，例如基因本体（Gene Ontology, GO）和京都基因与基因组百科全书（Kyoto Encyclopedia of Genes and Genomes, KEGG）。</span></p></section></li><li><section><p><span leaf="">三种方法展示了特定的 R 命令，用于示例应用程序，这些应用程序针对不同的研究问题并具有不同的图形输出。提供了关于如何修改这些方法以适应其他应用程序的建议。</span></p></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Introduction</span></span><span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Application of the protocol</span></span><span></span></h3><blockquote><span></span><p><span leaf="">协议的应用</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><p><span leaf="">功能富集分析是一种广泛使用的方法，用于研究特定基因列表或集合与某些生物功能、通路或分类之间的关联。</span></p></section></li><li><section><p><span leaf="">这种分析是通过计算方法进行的，通常用于研究在基因表达、蛋白质表达或其他大规模生物信息学数据中观察到的重要模式。</span></p></section></li><li><section><p><span leaf="">功能富集分析最常用的两种方法是：</span></p></section></li><ol><li><section><p><strong><span leaf="">过度代表性分析（Over-representation analysis, ORA）</span></strong><span leaf=""><br></span><span leaf="">ORA 是一种主要用于预定义基因列表的方法，例如实验中显著差异表达的基因（DEGs）。ORA 确定哪些功能或通路的频率比整个基因组或参考集中的预期频率更高，因此最适合分析具有显著效应的基因。</span></p></section></li><li><section><p><strong><span leaf="">基因集富集分析（Gene Set Enrichment Analysis, GSEA）</span></strong><span leaf=""><br></span><span leaf="">与 ORA 不同，GSEA 评估整个基因表达谱，以确定某个基因集是否显著排序。在此上下文中，基因集可能是与特定生化通路相关或与特定生理功能、疾病过程或药理学反应相关的一组基因。GSEA 能够识别整体基因行为，即使个别基因的变化较小。</span></p></section></li></ol><li><section><p><span leaf="">尽管 GSEA 和 ORA 被广泛应用，许多软件平台主要集中在传统的通路富集评估上。这些平台通常将分析局限于主流情景，例如基因表达模式对刺激的响应变化、常见信号通路的映射，以及研究与特定疾病相关的一般分子机制。然而，这种狭隘的关注往往忽略了分子生物学和生物信息学新兴领域的潜在发现，这需要更具跨学科性和细致的方法进行探索。</span></p></section></li><li><section><p><span leaf="">clusterProfiler 是一个多功能工具，能够无缝集成 GSEA 和 ORA 方法。它允许用户自定义数据库和注释，从而提供更广泛的解释范围，支持从单细胞类型到细菌代谢组甚至转录因子分析的前沿研究。在本协议中，我们展示了 clusterProfiler 用于全面功能富集分析的通用性和灵活性。</span></p></section></li><li><section><p><span leaf="">主要关注领域包括：</span></p></section></li></ol><ul><li><section><span leaf="">揭示微生物组、代谢物和疾病之间复杂的相互关系</span></section></li><li><section><span leaf="">确定植物抗寒通路中的活跃转录因子</span></section></li><li><section><span leaf="">为单细胞转录组学进行细胞类型注释</span></section></li></ul><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">通过拓宽功能富集分析应用的范围，我们旨在促进创新软件和分析策略的开发，以应对未来的研究前景。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Development of the protocol</span></span><span></span></h3><blockquote><span></span><p><span leaf="">协议的开发</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><p><span leaf="">ClusterProfiler 最初于2012年推出，主要功能是对多种模式生物进行ORA分析，允许进行功能谱型比较，例如不同处理组之间的比较。</span></p></section></li><li><section><p><span leaf="">随着时间的推移，该软件不断更新和维护以提升用户体验。</span></p></section></li><li><section><p><span leaf="">值得注意的是，该软件经历了四次重大升级，以进一步增强其功能。</span></p></section></li><li><section><p><span leaf="">分析方法扩展到包括</span><strong><span leaf="">ORA</span></strong><span leaf=""> 和</span><strong><span leaf="">GSEA</span></strong><span leaf="">。</span></p></section></li><li><section><p><span leaf="">软件支持的注释库变得更加丰富多样。</span></p></section></li><li><section><p><span leaf="">集成了新的辅助模块，以增强功能分析的深度。</span></p></section></li><li><section><p><span leaf="">富集分析的用户界面经过优化，变得更加简洁直观。</span></p></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">基因本体（GO）和京都基因与基因组百科全书（KEGG）是生物研究中广泛使用的两种工具，各自专注于不同的生物领域。</span></section></li><li><section><span leaf="">GO 提供了关于基因功能的详细信息，涵盖了基因产物在细胞内的作用，而 KEGG 则侧重于揭示代谢途径和信号传导网络的整体运作。</span></section></li><li><section><span leaf="">通过整合这两个有用的注释库，clusterProfiler 包大大扩展了其功能，支持过度表示分析（ORA）和基因集富集分析（GSEA），为各种研究场景中的生物学问题提供广泛的解释和全面的注释。</span></section></li><li><section><span leaf="">这一扩展增强了 clusterProfiler 在处理各种应用问题时的灵活性和深度，使其成为功能富集分析领域不可或缺的工具。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_03</span></span><span></span></h5><ol><li><section><span leaf="">在当前版本的 clusterProfiler 中，数据注释来源有了显著改进。</span></section></li><li><section><span leaf="">此版本不仅支持访问 Bioconductor 的 OrgDb 以获取模型生物的最新注释，每半年更新一次，还引入了针对非模式生物的新数据接口，例如通过 AnnotationHub 等平台提供的数据接口。</span></section></li><li><section><span leaf="">此外，为了满足从多个角度探索功能特征的需求以及对高级分子和细胞分析的需求，clusterProfiler 集成了与多个其他数据库的接口，包括 MSigDB 和 WikiPathways。</span></section></li><li><section><span leaf="">为了便于整合来自选定数据库的分析或纳入 Blast2GO 和 KAAS 等工具的分析结果，新版本提供了两个接口，即 enricher 和 GSEA。</span></section></li><li><section><span leaf="">这些改进使 clusterProfiler 成为一个更全面和强大的工具，支持广泛的生物信息学分析和研究。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_04</span></span><span></span></h5><ol><li><section><span leaf="">通过将我们开发的包如 ReactomePA、meshes、DOSE、GOSemSim 和 ChIPseeker 整合到 clusterProfiler 的框架中，我们扩展了该软件在多个维度上进行详细分析的能力，提供了对生物过程、疾病机制和功能通路的见解。</span></section></li><li><section><span leaf="">ReactomePA 是一个强大的工具，用于探索和分析 Reactome 数据库中的生物通路；meshes 包增加了文献和生物医学概念的富集分析功能，而 DOSE 包专注于疾病本体富集分析，有助于探索基因与疾病之间的联系。</span></section></li><li><section><span leaf="">此外，ChIPseeker 扩展了 clusterProfiler 的应用范围，包括非编码区域和表观遗传数据的富集分析，这对于理解基因表达调控和表观遗传机制至关重要。</span></section></li><li><section><span leaf="">另外，GOSemSim 通过从 GO 富集结果中去除冗余来优化结果分析，简化生物学解释过程，并提高分析的准确性。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_05</span></span><span></span></h5><ol><li><section><span leaf="">clusterProfiler 还通过引入 tidyverse 框架和 enrichplot 包增强了数据处理和可视化能力。</span></section></li><li><section><span leaf="">tidyverse 的引入，包括 dplyr 等工具，使得数据操作更加流畅，提高了数据集处理的效率。</span></section></li><li><section><span leaf="">同样地，enrichplot 包利用 ggplot2 的强大功能，扩展了可用的可视化格式和选项。</span></section></li><li><section><span leaf="">例如，它引入了富集图等可视化方法，有效地展示了富集分析路径之间的关系。</span></section></li><li><section><span leaf="">此外，它还实现了富集分析结果的分层聚类，为用户提供了一个全面的结果概览。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Advantages of clusterProfiler</span></span><span></span></h3><blockquote><span></span><p><span leaf="">clusterProfiler的优势</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">ClusterProfiler 通过集成额外功能、扩展注释数据库接口、纳入辅助软件包以及简化数据分析和可视化过程来增强其实用性。</span></section></li><li><section><span leaf="">这些特性使得 clusterProfiler 广泛应用于单细胞和其他组学数据，为潜在的生物学问题提供了一些解释性。</span></section></li><li><section><span leaf="">例如，R. Hoover 及其同事利用 enrichGO 功能进行 ORA 分析，研究局部消融免疫疗法在控制肿瘤生长中的作用，确定了与局部消融免疫疗法分子机制相关的调控差异表达基因，并揭示了 CD8+ T 细胞亚群中 T 细胞激活和 IFN 相关通路基因的选择性刺激。</span></section></li><li><section><span leaf="">在探索与免疫细胞浸润和胃癌预后相关的核心基因的研究中，使用了 gseKEGG 和 gseGO 等功能来深入研究预后分子标志物和免疫反应机制，发现了癌症反应通路（如 NF-kB、淋巴细胞和 CD40 通路）中的显著富集。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">在过去的12年中，我们通过各种渠道及时处理反馈并解决问题，包括Bioconductor论坛和GitHub问题。</span></section></li><li><section><span leaf="">为了更好地满足用户需求，我们提供了一份详尽的用户手册，并附有大量的教程材料（https://yulab-smu.top/biomedical-knowledge-mining-book/）。</span></section></li><li><section><span leaf="">研究人员可以根据项目需求选择和定制独特的分析场景。</span></section></li><li><section><span leaf="">例如，在分析特定类型的癌症时，他们可以从具有类似生物学特征的另一种癌症的工作流程中获得启发。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Comparative analysis of alternative tools</span></span><span></span></h3><blockquote><span></span><p><span leaf="">替代工具的比较分析</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">尽管有许多软件工具可用于富集分析，但它们都存在一些限制，例如 Enrichr、WebGestalt 和 fgsea 不支持全物种分析或最新的 KEGG 注释更新。</span></section></li><li><section><span leaf="">像 GOstats、gprofiler2、DAVID、Enrichr 和 Metascape 这样的工具只支持 ORA 算法，无法处理没有特定阈值的基因排名列表。</span></section></li><li><section><span leaf="">大多数工具不支持可视化，或者仅提供有限的可视化选项，这使得处理不同的使用场景和全面分析富集结果变得困难。</span></section></li><li><section><span leaf="">clusterProfiler 克服了这些限制，并提供了额外的优势，例如支持 tidy 接口、基因 ID 转换以及用户自定义注释数据集（包括 GMT、gson 和数据框格式）。</span></section></li><li><section><span leaf="">此外，clusterProfiler 的结果可以与 ggplot2 集成，以提供更多灵活和广泛的可视化选项。</span></section></li><li><section><span leaf="">比较结果详见补充表 1。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">与其它富集工具相比，clusterProfiler 的另一个常被忽视的优势是其可扩展性。</span></section></li><li><section><span leaf="">这不仅限于其功能模块的不断扩展。</span></section></li><li><section><span leaf="">到目前为止，它已经被集成到超过 40 个著名的 CRAN 和 Bioconductor 包中，并且在各种高级计算管道和在线平台如 ViralLink 和 ICARUS 中找到了一席之地，突显了其在科学界中的重要实用性和日益增长的影响力。</span></section></li></ol><blockquote><span></span><p><span leaf="">Table 1 R libraries that leverage clusterProfiler for their functional analysis tasks 表1 利用clusterProfiler进行功能分析任务的R库</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJ6AXBUVjSgXCToia1RHQEx26nkzLQicszrj4kVYHoBLRtFPKFFBibbNL6A/640?wx_fmt=png&amp;from=appmsg" data-ratio="2.232142857142857" data-type="png" data-w="896" data-imgfileid="100007904" src="https://mmbiz.qpic.cn/mmbiz_png/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJ6AXBUVjSgXCToia1RHQEx26nkzLQicszrj4kVYHoBLRtFPKFFBibbNL6A/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Applications</span></span><span></span></h3><blockquote><span></span><p><span leaf="">应用程序</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">clusterProfiler 可以应用于许多不同组学数据集的复杂分析。</span></section></li><li><section><span leaf="">特别是在癌症研究领域，它帮助研究人员更深入地了解基因突变或差异表达与癌症发展之间的关系。</span></section></li><li><section><span leaf="">此外，在进化基因组学中，该工具揭示了与特定进化事件相关的功能类别或通路。</span></section></li><li><section><span leaf="">在代谢组学领域，它用于分析与差异代谢物相关的通路，并与转录组数据进行整合分析。</span></section></li><li><section><span leaf="">对于微生物组学，它分析微生物群落的功能特征。</span></section></li><li><section><span leaf="">在新兴的单细胞转录组学领域，包括其空间维度，clusterProfiler 已被证明是数据分析和解释的宝贵工具。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">本研究方案旨在通过三个具体例子，对 clusterProfiler 的多种应用场景进行全面分析（图 1）</span></section></li><li><section><span leaf="">比较不同疾病的功能特征。</span></section></li><li><section><span leaf="">在非模式生物中进行转录因子分析。</span></section></li><li><section><span leaf="">从单细胞转录组数据中自动进行细胞类型注释。</span></section></li></ol><blockquote><span></span><p><span leaf="">Fig. 1: Overview of the protocol.</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJypWmDzBtWLDpXe42Py6vcwSKqiakbJ29I4CoEmWm1ef3yQVoricwz21w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7111111111111111" data-type="png" data-w="1080" data-imgfileid="100007905" src="https://mmbiz.qpic.cn/mmbiz_png/icGGGPyKsjUpWE2ibbwwZ5RNibKlFYyHOuJypWmDzBtWLDpXe42Py6vcwSKqiakbJ29I4CoEmWm1ef3yQVoricwz21w/640?wx_fmt=png&amp;from=appmsg"></span></figure><blockquote><span></span><ul><li><section><span leaf="">作为一种功能富集分析工具，clusterProfiler有助于系统地探索生物机制和描述多种物种的生物状态。</span></section></li><li><section><span leaf="">它接受多组学数据，提供了一个干净直观的界面，使研究人员能够高效地访问、管理和可视化富集分析结果。</span></section></li><li><section><span leaf="">独特的是，它支持在单一计算操作中同时分析和比较来自不同处理和时间点的数据。</span></section></li><li><section><span leaf="">这一特性简化了在不同条件下识别功能共识和检测差异的过程。</span></section></li><li><section><span leaf="">该协议中的详细应用包括代谢组和宏基因组的同步分析，应激条件下转录因子的鉴定和功能表征，以及单细胞研究范式中的细胞注释。</span></section></li><li><section><span leaf="">维数。</span></section></li></ul></blockquote><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Comparing functional profiles across diseases</span></span><span></span></h4><blockquote><span></span><p><span leaf="">比较不同疾病的功能谱型</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">在疾病研究中，结合多组学数据对于深入理解生物系统的复杂性以及探究疾病原因至关重要。</span></section></li><li><section><span leaf="">宏基因组学主要集中在微生物的遗传成分上，而代谢组学则专注于宿主-微生物相互作用的代谢终产物。</span></section></li><li><section><span leaf="">这两个领域的融合提供了一个独特的视角，使我们能够全面地考察疾病复杂性和其细微的亚型。</span></section></li><li><section><span leaf="">在这个框架下，我们使用 clusterProfiler 对两种炎症性肠病（IBD）亚型的差异代谢物和差异微生物基因进行了功能富集分析，然后比较了结果。</span></section></li><li><section><span leaf="">这种综合分析可以为不同疾病条件下微生物群落的代谢潜力和功能能力提供宝贵的见解。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Transcription factor analyses in nonmodel organisms</span></span><span></span></h4><blockquote><span></span><p><span leaf="">非模式生物中的转录因子分析</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">鉴于最近测序方法的进展，科学界获得了更强的能力来阐明非模式生物的复杂性。</span></section></li><li><section><span leaf="">现代非模式物种现在已经被编目为具有广泛的基因注释数据库，从而促进了对细胞系统生物学属性的更清晰理解，包括基因调控动态、细胞命运决定因素以及对生物刺激的反应范式。</span></section></li><li><section><span leaf="">在此讨论中，我们概述了一种方法框架，以利用来自非模式实体——竹子的转录组测序数据集。</span></section></li><li><section><span leaf="">这涉及到专门植物转录因子数据库的战略整合，用于基因集富集分析（GSEA）。</span></section></li><li><section><span leaf="">我们的研究目标集中在识别在不同发育阶段运作的转录调节因子，进一步旨在解码它们在冷驯化反应中的功能意义。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Automated cell type annotation from single-cell transcriptomic data</span></span><span></span></h4><blockquote><span></span><p><span leaf="">来自单细胞转录组数据的自动化细胞类型注释</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">单细胞测序技术使研究人员能够以单个细胞的精度审查基因表达谱，从而以显著的精确度探测细胞内在异质性。</span></section></li><li><section><span leaf="">这种细致的数据分析水平开启了生物学研究的新深度时代。</span></section></li><li><section><span leaf="">然而，在现代单细胞分析范式中，clusterProfiler工具的全面潜力似乎仍未得到充分利用。</span></section></li><li><section><span leaf="">主要上，其效用已被用于功能解释差异表达基因（DEGs）和描绘相关生物通路。</span></section></li><li><section><span leaf="">在处理细胞类型注释时，尽管已知基因或有限数据集需要准确性，研究人员倾向于手动注释。</span></section></li><li><section><span leaf="">这种方法虽然务实，但在注释属于广泛类型的细胞但表现出不同亚型时变得复杂，因为这些亚型往往表现出重叠的基因表达特征。</span></section></li><li><section><span leaf="">幸运的是，研究社区现在可以访问大量精心注释的基因数据库，例如来自MSigDB的C8基因集，用于细胞类型注释；这些数据库为研究人员提供了先前研究中在不同细胞类型中高表达的基因，作为手动注释方法的参考。</span></section></li><li><section><span leaf="">此外，单细胞数据的注释方法现在与传统差异基因表达分析方法非常相似。</span></section></li><li><section><span leaf="">基于这一见解，我们利用了MSigDB的C8基因集，并将其与clusterProfiler工具协同整合。</span></section></li><li><section><span leaf="">这种方法有助于避免人为偏见，并且还可以作为手动注释的基础。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Experimental design</span></span><span></span></h3><blockquote><span></span><p><span leaf="">实验设计</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">如前所述，在这三个例子中，我们主要使用 clusterProfiler 的 ORA（用于所有三个例子）和 GSEA 算法（用于第二个例子）来探索下游生物通路调控和细胞类型识别。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">对于ORA，总体方法包括：</span></section></li></ol><ul><li><section><span leaf="">通过差异分析获取感兴趣的特征列表，例如差异基因或代谢物。</span></section></li><li><section><span leaf="">选择合适的注释数据库，例如</span><strong><span leaf="">GO</span></strong><span leaf=""> 或</span><strong><span leaf="">KEGG</span></strong><span leaf=""> 路径数据库。</span></section></li><li><section><span leaf="">使用</span><strong><span leaf="">clusterProfiler</span></strong><span leaf=""> 提供的富集功能，例如</span><strong><span leaf="">enrichGO</span></strong><span leaf="">、</span><strong><span leaf="">enrichKEGG</span></strong><span leaf=""> 或</span><strong><span leaf="">enricher</span></strong><span leaf="">，通过 ORA 算法进行分析。</span></section></li></ul><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_03</span></span><span></span></h5><ol><li><section><span leaf="">对于 GSEA，目标是获取一个按生物学意义排序的特征列表，例如根据组间分析的倍数变化值、T 统计量或校正后的 P 值排序的特征。</span></section></li><li><section><span leaf="">然后，使用 clusterProfiler 中的 gseKEGG、gseGO 或 GSEA 函数进行 GSEA 分析。</span></section></li><li><section><span leaf="">对于涉及多个组的情况，可以使用 compareCluster 函数进行比较分析。</span></section></li><li><section><span leaf="">框 1 提供了如何在这两种方法之间选择的解释。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_04</span></span><span></span></h5><ol><li><section><span leaf="">用户可以使用提供的数据测试每个示例，或根据自己的数据调整分析过程。</span></section></li><li><section><span leaf="">识别一个与用户相似的样本数据集或与他们的研究结果一致的输出。</span></section></li><li><section><span leaf="">此外，在输入数据进行这些分析之前，执行初步的上游分析。</span></section></li><li><section><span leaf="">我们每个部分的建议可以指导用户调整分析过程以满足他们的需求。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Procedure 1: functional enrichment analyses in metabolomic and metagenomic data</span></span><span></span></h4><blockquote><span></span><p><span leaf="">步骤1：代谢组学和宏基因组学数据的功能富集分析</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">在示例中，我们使用了来自宏基因组的预处理 KEGG 基因丰度信息和来自代谢组的代谢物特征丰度表。</span></section></li><li><section><span leaf="">如何从原始测序数据中得出这两个组学特征丰度表不是本协议的重点，但我们已在方框 2 中总结了一般的处理流程。</span></section></li><li><section><span leaf="">在 KEGG 基因丰度表中，行名是 KEGG 基因 ID（KO），列名是样本名。</span></section></li><li><section><span leaf="">在代谢物特征丰度表中，行名是 KEGG COMPOUND，列名也是样本名。</span></section></li><li><section><span leaf="">此外，准备一个样本分组信息表，其中行名是样本名，确保其与特征丰度表的列名一致。</span></section></li><li><section><span leaf="">如果数据中的行和列完全相反，你可能需要使用 R 中的 t 函数来转置特征丰度表。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">在本例的第三步中，我们使用 MicrobiotaProcess 提供的 mp_diff_analysis 方法进行差异分析，该方法结合了 Wilcoxon 秩和检验和线性判别分析，以识别差异特征。</span></section></li><li><section><span leaf="">你也可以考虑其他差异分析方法，例如用于代谢组数据的参数检验如 t 检验或方差检验，或者仅使用 Wilcoxon 秩和检验。</span></section></li><li><section><span leaf="">对于宏基因组功能基因的差异特征识别，你可以直接使用 Wilcoxon 秩和检验，或者使用 edgeR 或 ALDEx2 等工具。</span></section></li><li><section><span leaf="">接下来，我们使用 enrichKEGG 和 compareCluster，并将生物体参数分别指定为 ‘ko’ 和 ‘cpd’，以对宏基因组和代谢组的差异特征进行富集分析。</span></section></li><li><section><span leaf="">如果你使用来自其他常用数据库的特征 ID，例如酶委员会 (EC) 编号、人类代谢组数据库 (HMDB) 或小分子通路数据库 (SMPDB)，你可以使用自行开发的 MicrobiomeProfiler 包，该包提供 enrichKO、enrichHMDB 和 enrichSMPDB 以替代 enrichKEGG 功能。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Procedure 2: transcription factor analysis pertaining to cold tolerance in PE</span></span><span></span></h4><blockquote><span></span><p><span leaf="">步骤2：与PE耐寒性相关的转录因子分析</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">我们使用了冷处理条件和对照条件下毛竹 Phyllostachys edulis (PE) 的原始基因丰度表达表格，其中行名为基因名，列名为样本名。</span></section></li><li><section><span leaf="">获取该基因表达表格的方法详见附录 3。</span></section></li><li><section><span leaf="">此外，还有一个样本信息表，类似于上述表格，其中的样本名需要与丰度表中的样本名匹配。</span></section></li><li><section><span leaf="">为了探讨冷处理条件下毛竹 (PE) 的潜在基因转录调控机制，我们从 PlantTFDB 下载了毛竹的转录因子家族列表和基因 GO 注释表。</span></section></li><li><section><span leaf="">用户可以根据自己的数据和实验设计替换这个转录因子列表和功能注释表。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">为了识别显著富集的转录因子，我们计算了不同冷处理时间与对照组之间的总基因对数倍变化值，并将这些值排序作为GSEA分析的输入。</span></section></li><li><section><span leaf="">如上所述，用户可以考虑其他统计方法，例如根据P值对基因进行排序。</span></section></li><li><section><span leaf="">此外，所有基因的对数倍变化值是使用DESeq2计算的，本例中没有进行P值过滤。</span></section></li><li><section><span leaf="">用户也可以选择使用edgeR、limma或其他工具进行计算。</span></section></li><li><section><span leaf="">接下来，我们使用clusterProfiler中的enricher函数对GSEA显著富集的转录因子的目标基因进行GO富集分析，确定这些转录因子调控的目标基因的关键生物过程。</span></section></li><li><section><span leaf="">在此步骤中，用户可以根据他们想要探索的生物学问题选择合适的知识库，例如KEGG通路或Wikipathway数据库，详见框4。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Procedure 3: single-cell transcriptomic cell type annotation</span></span><span></span></h4><blockquote><span></span><p><span leaf="">步骤3：单细胞转录组细胞类型注释</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">在这个例子中，我们使用了由 Cellranger 生成的外周血单核细胞（PBMCs）的单细胞数据，以及来自 MSigDB 数据库的 C8 细胞类型特征基因集。</span></section></li><li><section><span leaf="">我们主要使用 Seurat 进行上游数据分析和初步分析，包括去除线粒体基因、数据标准化、识别高变基因、主成分分析（PCA）、均匀流形近似和投影（UMAP）降维和聚类分析。</span></section></li><li><section><span leaf="">这些步骤主要为后续的细胞降维可视化和细胞簇标记基因识别做准备。</span></section></li><li><section><span leaf="">对于这些上游分析，用户也可以考虑使用 Bioconductor 中的 scater、scuttle 和 scranc 或者 Python 中的 scanpy。</span></section></li><li><section><span leaf="">具体步骤请参考这些软件工具的官方文档，这里不再详细描述。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">接下来，我们使用 RunMCA 分析和 GetGroupGeneSet 通过 CelliD60 从每个细胞簇中提取前 20 个特征基因。</span></section></li><li><section><span leaf="">然后，我们使用 clusterProfiler 的 compareCluster 和 enricher（clusterProfiler 提供的通用 ORA 函数）对每个簇进行细胞 GSEA 分析。</span></section></li><li><section><span leaf="">最后，我们根据 MSigDB 数据库中组织的细胞类型特征基因集，用最显著富集的细胞类型标注每个细胞簇。</span></section></li><li><section><span leaf="">用户也可以使用他们独立收集的可靠细胞类型基因集列表。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_03</span></span><span></span></h5><ol><li><section><span leaf="">通过遵循这些指南并根据用户数据特征和研究目标进行必要的调整，用户可以在他们的研究中最大化 clusterProfiler 的实用性。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Limitations</span></span><span></span></h3><blockquote><span></span><p><span leaf="">限制</span></p></blockquote><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Selecting the appropriate annotation database</span></span><span></span></h4><blockquote><span></span><p><span leaf="">选择适当的注释数据库</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">在使用 clusterProfiler 进行功能富集分析的过程中，选择适当的注释数据库成为一个关键步骤。</span></section></li><li><section><span leaf="">用户必须认识到，不同的数据库在版本更新频率和所包含的基因集方面可能存在显著差异。</span></section></li><li><section><span leaf="">选择不准确或过时的注释信息可能会对研究分析的结论引入深刻且不可逆的偏差。</span></section></li><li><section><span leaf="">此外，由于 clusterProfiler 主要依赖公共注释资源，其功能和准确性在很大程度上受到所选数据库的影响。</span></section></li><li><section><span leaf="">因此，在确定使用哪个注释数据库时，研究人员应全面评估其数据的适用性、更新的及时性及其与研究主题的一致性，以确保分析结果的准确性和可靠性。</span></section></li><li><section><span leaf="">关于常用数据库的更多介绍，请参见框 4。</span></section></li></ol><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">Depth and breadth of annotations</span></span><span></span></h4><blockquote><span></span><p><span leaf="">注释的深度和广度</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">在基因富集分析过程中，注释的‘深度’和‘广度’往往起着决定性因素，但它们本身存在一定局限性。</span></section></li><li><section><span leaf="">首先，必须承认当前基因与功能关联的深度可能较为表面。</span></section></li><li><section><span leaf="">一些研究表明，许多基因与功能的关系基于初步实验证据，缺乏更深入的生物学背景或详细的机制研究。</span></section></li><li><section><span leaf="">这可能是由于许多基因与功能的关联基于高通量实验的初始数据，尽管这些数据可以提供大量信息，但可能存在假阳性或不够全面的问题。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_02</span></span><span></span></h5><ol><li><section><span leaf="">其次，注释的‘广度’带来了一系列问题，特别是在考虑不同数据库之间的一致性时。这种不一致可能源于不同数据库采用的各种注释标准和方法，以及数据更新时间和频率的差异。例如，一个基因在一个数据库中可能被注释为参与某个生物途径，但在另一个数据库中却缺乏相应的注释。这不仅可能导致结果的差异性，还增加了解释结果的复杂性。</span></section></li></ol><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_03</span></span><span></span></h5><ol><li><section><span leaf="">因此，在使用 clusterProfiler 或其他基因富集分析工具时，研究人员需要谨慎选择和使用注释数据库，同时也要意识到这些工具和数据的局限性。</span></section></li><li><section><span leaf="">在可能的情况下，研究人员应考虑验证和比较来自多个来源的数据和注释，以获得更全面和准确的结果。</span></section></li><li><section><span leaf="">当前主流的基因集文件格式 GMT 仅包含基因与基因集之间的对应关系。</span></section></li><li><section><span leaf="">大量元数据，如数据的来源和发布时间，无法存储在这种文件格式中。</span></section></li><li><section><span leaf="">这可能是大量过时的注释文件被传播和使用的原因之一。</span></section></li><li><section><span leaf="">为了解决这个问题，我们提出了 gson 文件格式（https://cran.r-project.org/package=gson）用于存储基因集及其相关元数据。</span></section></li><li><section><span leaf="">未来，clusterProfiler 也将基于这种格式进行开发。</span></section></li></ol><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">Reporting summary</span></span><span></span></h3><blockquote><span></span><p><span leaf="">报告摘要</span></p></blockquote><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">有关研究设计的更多信息可在与本文链接的《自然组合》报告摘要中获取。</span></section></li></ol><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Data availability</span></span><span></span><span></span></h2><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">为了整合代谢组学和宏基因组学的分析，我们从补充材料中获得了原始的宏基因组基因表达数据及其对应的元数据，以及代谢组学的代谢物表达谱。</span></section></li><li><section><span leaf="">这些数据可以通过 PubMed Central 在 https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6342642 访问。</span></section></li><li><section><span leaf="">对于 PE 的转录组学分析，我们从 CNGBdb 数据库 (https://db.cngb.org/search/project/CNP0002243/) 获取了原始的 FASTQ 测序数据，并进行了比对和定量分析以确定单个基因的表达水平。</span></section></li><li><section><span leaf="">在步骤 3 中，我们从 10X Genomics (https://cf.10xgenomics.com/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz) 获取了 2,700 个 PBMC 的 Illumina NextSeq 500 测序数据。</span></section></li><li><section><span leaf="">本文提供了源数据。</span></section></li></ol><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Code availability</span></span><span></span><span></span></h2><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">Para_01</span></span><span></span></h5><ol><li><section><span leaf="">原始数据、处理后的数据和源代码，包括用于处理原始数据并在协议中演示的那些，都存放在 GitHub 仓库 https://github.com/YuLab-SMU/clusterProfiler_protocol/ 中。</span></section></li></ol></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/aq4kwybmI6gGKqUQ05yVkA",target="_blank" rel="noopener noreferrer">原文链接</a>
