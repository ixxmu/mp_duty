---
title: "本实验室可以做的分析：单细胞转录组分析-celescope"
date: 2024-12-19T16:20:55Z
draft: ["false"]
tags: [
  "fetched",
  "东林的扯淡小屋"
]
categories: ["Acdemic"]
---
本实验室可以做的分析：单细胞转录组分析-celescope by 东林的扯淡小屋
------
<div><p><span leaf=""><br></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="css"><code><span leaf=""><br></span></code><code><span leaf=""><span>cd /data1/yudonglin/scATAC</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695060/SRR12695060 -O SRR12695060.sra</span></span></code><code><span leaf=""><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695061/SRR12695061 -O SRR12695061.sra</span></span></code><code><span leaf=""><span>wget -c https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR12695062/SRR12695062 -O SRR12695062.sra</span></span></code><code><span leaf=""><span>fastq-dump --split-files --gzip SRR12695060.sra</span></span></code><code><span leaf=""><span>fastq-dump --split-files --gzip SRR12695061.sra</span></span></code><code><span leaf=""><span>fastq-dump --split-files --gzip SRR12695062.sra</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></span></code><code><span leaf=""><span>celescope rna   --help </span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>cd /data/yudonglin/reference/singcell</span></span></code><code><span leaf=""><span>mkdir hs_ensembl_99</span></span></code><code><span leaf=""><span>cd hs_ensembl_99</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>wget ftp://ftp.ensembl.org/pub/release-</span><span>99</span><span>/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></span></code><code><span leaf=""><span>wget ftp://ftp.ensembl.org/pub/release-</span><span>99</span><span>/gtf/homo_sapiens/Homo_sapiens.GRCh38.</span><span>99</span><span>.gtf.gz</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz</span></span></code><code><span leaf=""><span>gunzip Homo_sapiens.GRCh38.</span><span>99</span><span>.gtf.gz</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></span></code><code><span leaf=""><span>celescope utils mkgtf Homo_sapiens.GRCh38.</span><span>99</span><span>.gtf Homo_sapiens.GRCh38.</span><span>99</span><span>.filtered.gtf</span></span></code><code><span leaf=""><span>celescope rna mkref \</span></span></code><code><span leaf=""><span> --genome_name Homo_sapiens_ensembl_99_filtered \</span></span></code><code><span leaf=""><span> --fasta Homo_sapiens.GRCh38.dna.primary_assembly.fa \</span></span></code><code><span leaf=""><span> --gtf Homo_sapiens.GRCh38.</span><span>99</span><span>.filtered.gtf \</span></span></code><code><span leaf=""><span> --mt_gene_list mt_gene_list.txt</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>multi_rna\</span></span></code><code><span leaf=""><span>--mapfile ./mapfile \# 提供mapfile文件位置</span></span></code><code><span leaf=""><span>--genomeDir pathto/genome \ # mkref创建的参考基因组目录(路径)</span></span></code><code><span leaf=""><span>--thread </span><span>4</span><span>  \# 线程数</span></span></code><code><span leaf=""><span>--mod  shell \# 生成的脚本类型</span></span></code><code><span leaf=""><span>--outdir   ./   # 可以指定文件的输出路径</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>--mapfile：包含三列, 每列之间用tab分割；每一行是一个样本。</span></span></code><code><span leaf=""><span>第一列：fastq前缀</span></span></code><code><span leaf=""><span>第二列：fastq所在文件夹</span></span></code><code><span leaf=""><span>第三列：{sample}（即生成文件的前缀）</span></span></code><code><span leaf=""><span>第四列：可选，期望细胞数</span></span></code><code><span leaf=""><span>vi rna</span><span>.mapfile</span></span></code><code><span leaf=""><span>SRR12695060  /data1/yudonglin/scATAC/SRR12695060  primary_breast</span></span></code><code><span leaf=""><span>SRR12695061  /data1/yudonglin/scATAC/SRR12695061  positive_lymph_node</span></span></code><code><span leaf=""><span>SRR12695062  /data1/yudonglin/scATAC/SRR12695062  negative_lymph_node</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>multi_rna \</span></span></code><code><span leaf=""><span>  </span><span>--mapfile</span><span> ./rna</span><span>.mapfile</span><span> \</span></span></code><code><span leaf=""><span>  </span><span>--genomeDir</span><span> /data/yudonglin/reference/singcell/hs_ensembl_99 \</span></span></code><code><span leaf=""><span>  </span><span>--thread</span><span> </span><span>20</span><span> \</span></span></code><code><span leaf=""><span>  </span><span>--mod</span><span> shell</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>cd /data1/yudonglin/scATAC</span></span></code><code><span leaf=""><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></span></code><code><span leaf=""><span>sh /data1/yudonglin/scATAC/shell/negative_lymph_node</span><span>.sh</span><span>  </span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>cd /data1/yudonglin/scATAC</span></span></code><code><span leaf=""><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></span></code><code><span leaf=""><span>sh /data1/yudonglin/scATAC/shell/positive_lymph_node</span><span>.sh</span><span>  </span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>cd /data1/yudonglin/scATAC</span></span></code><code><span leaf=""><span>conda activate /home/yudonglin/miniconda3/envs/celescope</span></span></code><code><span leaf=""><span>sh /data1/yudonglin/scATAC/shell/primary_breast</span><span>.sh</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>celescope rna sample </span><span>--outdir</span><span> .//primary_breast/</span><span>00</span><span>.sample</span><span> </span><span>--sample</span><span> primary_breast </span><span>--thread</span><span> </span><span>20</span><span> </span><span>--chemistry</span><span> scopeV1  </span><span>--fq1</span><span> /data1/yudonglin/scATAC/SRR12695060/SRR12695060_1</span><span>.fastq.gz</span><span> </span></span></code><code><span leaf=""><span>celescope rna prep_map </span><span>--outdir</span><span> .//primary_breast/</span><span>01</span><span>.prep_map--sample</span><span> primary_breast </span><span>--thread20--chemistry</span><span> scopeV1 </span><span>--lowNum2--minimum_length20--nextseq_trim20--overlap10--genomeDir</span><span> /data/yudonglin/reference/singcell/hs_ensembl_99 </span><span>--outFilterMatchNmin50--outFilterMultimapNmax1--starMem30--fq1</span><span> /data1/yudonglin/scATAC/SRR12695060/SRR12695060_1</span><span>.fastq.gz--fq2</span><span> /data1/yudonglin/scATAC/SRR12695060/SRR12695060_2</span><span>.fastq.gz</span><span> </span></span></code><code><span leaf=""><span>celescope rna featureCounts </span><span>--outdir</span><span> .//primary_breast/</span><span>02</span><span>.featureCounts</span><span> </span><span>--sample</span><span> primary_breast </span><span>--thread</span><span> </span><span>20</span><span> </span><span>--gtf_type</span><span> gene </span><span>--genomeDir</span><span> /data/yudonglin/reference/singcell/hs_ensembl_99  </span><span>--input</span><span> .//primary_breast/</span><span>01</span><span>.prep_map</span><span>/primary_breast_Aligned</span><span>.out.bam</span><span> </span></span></code><code><span leaf=""><span>celescope rna count </span><span>--outdir</span><span> .//primary_breast/</span><span>03</span><span>.count</span><span> </span><span>--sample</span><span> primary_breast </span><span>--thread</span><span> </span><span>20</span><span> </span><span>--genomeDir</span><span> /data/yudonglin/reference/singcell/hs_ensembl_99 </span><span>--expected_cell_num</span><span> </span><span>3000</span><span> </span><span>--cell_calling_method</span><span> EmptyDrops_CR  </span><span>--count_detail</span><span> .//primary_breast/</span><span>02</span><span>.featureCounts</span><span>/primary_breast_count_detail</span><span>.txt</span><span> </span><span>--force_cell_num</span><span> </span><span>None</span><span> </span></span></code><code><span leaf=""><span>celescope rna analysis </span><span>--outdir</span><span> .//primary_breast/</span><span>04</span><span>.analysis</span><span> </span><span>--sample</span><span> primary_breast </span><span>--thread</span><span> </span><span>20</span><span> </span><span>--genomeDir</span><span> /data/yudonglin/reference/singcell/hs_ensembl_99  </span><span>--matrix_file</span><span> .//primary_breast/</span><span>03</span><span>.count</span><span>/primary_breast_filtered_feature_bc_matrix</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqvC8THrOZkaZ7WexicVJtzpncExiaU1QLcp0PFpzuiccibZenQ6hAzgdrCA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5907407407407408" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100025329" src="https://mmbiz.qpic.cn/mmbiz_png/kZ1wdgAscBq9WElrnNmwwWKxmVlFicuUqvC8THrOZkaZ7WexicVJtzpncExiaU1QLcp0PFpzuiccibZenQ6hAzgdrCA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf=""><br></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jwIAMC3Ll0AJFoHevvk7uw",target="_blank" rel="noopener noreferrer">原文链接</a>
