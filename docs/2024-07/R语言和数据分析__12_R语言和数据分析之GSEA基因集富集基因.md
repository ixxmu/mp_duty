---
title: "R语言和数据分析 |12.R语言和数据分析之GSEA基因集富集基因"
date: 2024-07-23T08:10:41Z
draft: ["false"]
tags: [
  "fetched",
  "医学生之学习生信"
]
categories: ["Acdemic"]
---
R语言和数据分析 |12.R语言和数据分析之GSEA基因集富集基因 by 医学生之学习生信
------
<div><blockquote><p>R语言和数据分析系列是以果子老师发布在b站的课程为基础记录的学习笔记，希望可以帮助刚学习R语言的同学。在课程里可以体会到老师付出时间与精力，在此衷心感谢果子老师的无私分享！感兴趣的同学可以去B站一起加入学习R语言的队伍~今天推出果子老师R语言和数据分析学习笔记<strong>第13期</strong>。本期分享内容为：<strong>R语言和数据分析之GSEA基因集富集基因</strong>。对应——果子学生信-R语言入坑必看的<strong>第35-36节</strong>视频内容。<br>【果子学生信-R语言入坑必看-01_introduction_and_warm_up】https://www.bilibili.com/video/BV118411d7JB?vd_source=20ee9ef1fa406aa6039ca07a30c4fdd1<br>对生信感兴趣的同学还可以点击关注果子老师公众号~</p></blockquote><section><mp-common-profile data-pluginname="mpprofile" data-id="MzIyMzA2MTcwMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/NDy5aEnReX12QhHoIrQQ5OKnIAmrdAxVtlT7WzJWKic4OC5sX7pkylLFG5u7lAws2tfUfMia6icu6CuCavSsJNzUw/0?wx_fmt=png" data-nickname="果子学生信" data-alias="guozixueshengxin" data-signature="记忆力开始下降，需要动笔记录一下。" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3><span>KEGG基础介绍</span></h3><p>对比于KEGG，GSEA分析的是基于基因集的整体表达变化，而不是单个基因的差异表达。这种方法可以捕捉到那些虽然表达变化不大，但功能重要的基因，从而提供更全面的生物学信息。</p><blockquote><p><strong>Gene Set Enrichment Analysis（GSEA）</strong>是一种计算方法，用于确定一组预先定义的基因在两种生物学状态（例如表型）之间是否显示出统计学上显著的、一致的差异。GSEA的输入数据包括两部分：一是<strong>已知功能的基因集</strong>，二是<strong>表达矩阵</strong>。软件会根据<strong>基因与表型的相关度</strong>进行排序，然后<strong>判断基因集中的基因是否在排序后的基因表的上部或下部富集</strong>，从而评估基因集对表型变化的影响。<br>GSEA会<strong>重复</strong>上述随机化过程数千次，每次都计算出一个随机化的富集分数。富集分数做一个频率图，可成为一个双峰图。这个分布代表了在没有生物学意义的随机情况下，富集分数可能的取值范围。<strong>GSEA计算观察到的ES在随机化ES分布中的位置。如果观察到的ES远大于大多数随机化的ES，那么它在分布中的位置会很高，对应的p值会很小，表示观察到的ES具有统计学显著性。</strong></p></blockquote><p><img data-imgfileid="100008850" data-ratio="0.5777777777777777" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxnzOMcuEYKKg7bVXg3mCibwibC919XMY6KVqyLdib1m1j0TibTb0VEm3w7A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="947" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxnzOMcuEYKKg7bVXg3mCibwibC919XMY6KVqyLdib1m1j0TibTb0VEm3w7A/640?wx_fmt=png&amp;from=appmsg"><ne-clipboard data="%7B%22type%22%3A%22fragment%22%2C%22name%22%3A%22%23fragment%22%2C%22children%22%3A%5B%7B%22type%22%3A%22card%22%2C%22id%22%3A%22uc8e679a8%22%2C%22name%22%3A%22image%22%2C%22attrs%22%3A%7B%22value%22%3A%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2024%2Fpng%2F33644105%2F1721620078221-e374f774-e991-4fc0-af9f-5d69c40f21b5.png%22%2C%22original%22%3A%7B%22type%22%3A%22binary%22%2C%22from%22%3A%22paste%22%2C%22ratio%22%3A2%2C%22width%22%3A1894%2C%22height%22%3A1094%7D%2C%22name%22%3A%22image.png%22%2C%22size%22%3A198269%2C%22width%22%3A947%2C%22status%22%3A%22done%22%2C%22style%22%3A%22none%22%2C%22taskId%22%3A%22u5c84d4e7-3a1f-46b1-9e42-157bec19ce9%22%2C%22clientId%22%3A%22u950476f2-a0b8-4%22%2C%22linkExternal%22%3Atrue%2C%22ocr%22%3A%5B%7B%22x%22%3A473%2C%22y%22%3A596%2C%22width%22%3A191%2C%22height%22%3A40%2C%22text%22%3A%22GENE%20SET%22%7D%2C%7B%22x%22%3A1344%2C%22y%22%3A759%2C%22width%22%3A161%2C%22height%22%3A37%2C%22text%22%3A%22GENELIST%22%7D%2C%7B%22x%22%3A1576%2C%22y%22%3A995%2C%22width%22%3A214%2C%22height%22%3A31%2C%22text%22%3A%220000000000%22%7D%2C%7B%22x%22%3A1375%2C%22y%22%3A996%2C%22width%22%3A181%2C%22height%22%3A27%2C%22text%22%3A%2260088008%22%7D%5D%2C%22search%22%3A%22GENE%20SET%20GENELIST%200000000000%2060088008%22%2C%22crop%22%3A%5B0%2C0%2C1%2C1%5D%2C%22showTitle%22%3Afalse%2C%22title%22%3A%22%22%2C%22rotation%22%3A0%2C%22averageHue%22%3A%22%23f8f7f7%22%2C%22__spacing%22%3A%22both%22%7D%2C%22cardType%22%3A%22inline%22%7D%2C%22cardType%22%3A%22inline%22%7D%5D%2C%22attrs%22%3A%7B%7D%7D" source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p>正向富集<img data-imgfileid="100008852" data-ratio="0.6435185185185185" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx4Zh130FaJnm4QgGdClsa8ib8QfIkGYOe0IN7LzvEB79bBnVC5aYcAIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1021.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx4Zh130FaJnm4QgGdClsa8ib8QfIkGYOe0IN7LzvEB79bBnVC5aYcAIg/640?wx_fmt=png&amp;from=appmsg"></p><p>负向富集：通路是抑制的<img data-imgfileid="100008853" data-ratio="0.6370370370370371" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx4ibKj9iaISpbUZJcQEmctIhrW3R0ibIldiaeIOdFfVKcAOTVpNNDoUKmlg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1029.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx4ibKj9iaISpbUZJcQEmctIhrW3R0ibIldiaeIOdFfVKcAOTVpNNDoUKmlg/640?wx_fmt=png&amp;from=appmsg"></p><h4><span><strong>GSEA至少需要的条件：</strong></span></h4><p><img data-imgfileid="100008854" data-ratio="0.33868378812199035" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxLoZfy4NqshHT4pBnCZCrTxPTblIheSFWNia1CZazK1OLKuPgElHWJlA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="623" width="311.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxLoZfy4NqshHT4pBnCZCrTxPTblIheSFWNia1CZazK1OLKuPgElHWJlA/640?wx_fmt=png&amp;from=appmsg"></p><h4><span><strong>如何获取基因集：</strong></span></h4><p>1、官网获取：https://www.gsea-msigdb.org/gsea/index.jsp<img data-imgfileid="100008855" data-ratio="0.7351851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxIrSU59iaogx1KpkSibxve3CXx2miajQJCOHE9TYGv8dTtNu540HLlOEtQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1026.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxIrSU59iaogx1KpkSibxve3CXx2miajQJCOHE9TYGv8dTtNu540HLlOEtQ/640?wx_fmt=png&amp;from=appmsg"></p><p>2、Enrichr官网获取：https://maayanlab.cloud/Enrichr/<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008856" data-ratio="0.7092592592592593" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxZ3EoOgBDq1YAMJNe4RicvrBapwVTkUUztOOWRiaNj4PGdFCeoAF3ddcA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1063" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxZ3EoOgBDq1YAMJNe4RicvrBapwVTkUUztOOWRiaNj4PGdFCeoAF3ddcA/640?wx_fmt=png&amp;from=appmsg"></p><h4><span><strong>GSEA的优势：</strong></span></h4><p>● GSEA不需要事先筛选出差异表达基因，<strong>不人为设定阈值</strong>。这使得它能够<strong>保留那些虽然表达变化不大但可能在生物学上具有重要意义的基因</strong>。</p><p>● 结果<strong>区分正负</strong>，利于科学指导实验。</p><p>● GSEA可以利用MSigDB（Molecular Signatures Database）等公共数据库中的大量注释基因集，<strong>基因集种类齐全，可自行定制。</strong></p><p>● GSEA分析的是基因集而不是单个基因，这有助于<strong>揭示基因集内基因的整体表达变化</strong>。这种方法更符合生物体中基因协同作用的实际情况。</p><h3><span>获取geneList</span></h3><p>与上一期KEGG的操作相同</p><pre><code><span> 1</span>rm(list = ls())<br><span> 2</span><span>library</span>(clusterProfiler)<br><span> 3</span>load(file = <span>"output/allDiff.Rdata"</span>)<span>##所有基因！KEGG是diffgene</span><br><span> 4</span><span>#获得基因列表</span><br><span> 5</span>gene &lt;- rownames(allDiff)<br><span> 6</span><span>## 转换</span><br><span> 7</span>gene = bitr(gene, fromType=<span>"SYMBOL"</span>, toType=<span>"ENTREZID"</span>, OrgDb=<span>"org.Hs.eg.db"</span>)<br><span> 8</span><br><span> 9</span><span>## 去重</span><br><span>10</span>gene &lt;- dplyr::distinct(gene,SYMBOL,.keep_all=<span>TRUE</span>)<br><span>11</span>gene_df &lt;- data.frame(logFC=allDiff$logFC,<br><span>12</span>                      SYMBOL = rownames(allDiff))<br><span>13</span>gene_df &lt;- merge(gene_df,gene,by=<span>"SYMBOL"</span>)<br><span>14</span><br><span>15</span>&gt; head(gene_df)<br><span>16</span>   SYMBOL       logFC ENTREZID<br><span>17</span><span>1</span>    A1CF -<span>0.01079556</span>    <span>29974</span><br><span>18</span><span>2</span>     A2M  <span>0.25980917</span>        <span>2</span><br><span>19</span><span>3</span>   A2ML1 -<span>0.08694667</span>   <span>144568</span><br><span>20</span><span>4</span> A3GALT2 -<span>0.34830778</span>   <span>127550</span><br><span>21</span><span>5</span>  A4GALT -<span>0.40488056</span>    <span>53947</span><br><span>22</span><span>6</span>   A4GNT -<span>0.12934722</span>    <span>51146</span><br><span>23</span><br><span>24</span><span>## geneList 三部曲</span><br><span>25</span><span>## 1.获取基因logFC</span><br><span>26</span>geneList &lt;- gene_df$logFC<br><span>27</span><span>## 2.命名</span><br><span>28</span>names(geneList) = gene_df$SYMBOL<br><span>29</span><span>## 3.排序很重要</span><br><span>30</span>geneList = sort(geneList, decreasing = <span>TRUE</span>)<br><span>31</span><br><span>32</span>&gt; head(geneList)<br><span>33</span>      CD36        DCT ST6GALNAC2     PRUNE2       TCN1 <br><span>34</span>  <span>5.804404</span>   <span>5.681340</span>   <span>3.910637</span>   <span>3.866406</span>   <span>3.388202</span> <br><span>35</span>      CD24 <br><span>36</span>  <span>3.322122</span> <br></code></pre><h3><span>读入基因集hallmarks gene set</span></h3><p>先打开GSEA官网：https://www.gsea-msigdb.org/gsea/index.jsp<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008857" data-ratio="0.5907407407407408" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxYN0DYPSkEy6ABOguFgrWhNZxPQzMGRzMm03vPfk4ianVzszWgXFia0NQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1245" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxYN0DYPSkEy6ABOguFgrWhNZxPQzMGRzMm03vPfk4ianVzszWgXFia0NQ/640?wx_fmt=png&amp;from=appmsg"></p><p>下载gene symbols<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008858" data-ratio="0.6203703703703703" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxvq24IuHaLhtzbvG4E9cdqA8bVBqndnfQiaxXduz8g7CoZWcz9DicqMBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1210" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxvq24IuHaLhtzbvG4E9cdqA8bVBqndnfQiaxXduz8g7CoZWcz9DicqMBA/640?wx_fmt=png&amp;from=appmsg"></p><p>移入文件夹再导入r<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008859" data-ratio="0.2601851851851852" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxfujmWjJW9tNJwRTmqicMw2ExnbWPDsic01Kibo5tyqW7fVHsdqRC2x8cg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="939.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxfujmWjJW9tNJwRTmqicMw2ExnbWPDsic01Kibo5tyqW7fVHsdqRC2x8cg/640?wx_fmt=png&amp;from=appmsg"></p><pre><code><span> 1</span><span>## 读入hallmarks gene set，从哪来？</span><br><span> 2</span>hallmarks &lt;- read.gmt(<span>"resource/h.all.v2022.1.Hs.symbols.gmt"</span>)<br><span> 3</span><br><span> 4</span><span>### 主程序GSEA</span><br><span> 5</span>y &lt;- GSEA(geneList,TERM2GENE =hallmarks)<br><span> 6</span><br><span> 7</span>yd &lt;- as.data.frame(y)<br><span> 8</span><span>### 看整体分布</span><br><span> 9</span><span>library</span>(ggplot2)<br><span>10</span>dotplot(y,showCategory=<span>30</span>,<br><span>11</span>        split=<span>".sign"</span>,<br><span>12</span>        font.size = <span>8</span>,<br><span>13</span>        label_format = <span>60</span>)+facet_grid(~.sign)<br></code></pre><p><img data-galleryid="" data-imgfileid="100008871" data-ratio="0.30608908868001633" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxgt95JQ4QnVMnx6JYUbPecVQS76K2aTw4MkLwvIf6WPbgljyoddQl2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2447" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxgt95JQ4QnVMnx6JYUbPecVQS76K2aTw4MkLwvIf6WPbgljyoddQl2w/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-galleryid="" data-imgfileid="100008872" data-ratio="0.5630936227951153" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxG9PUScXeeqSJrXfD7gT6TW4ZiaOABuERKsNfZOiaibj6PLVoRbtAytOXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1474" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxG9PUScXeeqSJrXfD7gT6TW4ZiaOABuERKsNfZOiaibj6PLVoRbtAytOXg/640?wx_fmt=png&amp;from=appmsg"></p><p><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p>可以修改标签长度，删除前面的HALLMARK</p><pre><code><span>1</span><span>library</span>(stringi)<br><span>2</span><span>library</span>(ggplot2)<br><span>3</span>dotplot(y,showCategory=<span>12</span>,split=<span>".sign"</span>)+<br><span>4</span>  facet_grid(~.sign)+<br><span>5</span>  scale_y_discrete(labels=<span>function</span>(x) stri_sub(x,<span>10</span>))<br></code></pre><p><img data-imgfileid="100008861" data-ratio="0.975" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxW2ibyicylR5E5LRgZAJbF4ibFeLIy2E8OicXVrric5VpnzrplyzWkibI60zQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="610.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxW2ibyicylR5E5LRgZAJbF4ibFeLIy2E8OicXVrric5VpnzrplyzWkibI60zQ/640?wx_fmt=png&amp;from=appmsg"><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p>选择需要呈现通路的来作图</p><pre><code><span>1</span><span>library</span>(enrichplot)<br><span>2</span>gseaplot2(y,<span>"HALLMARK_E2F_TARGETS"</span>,color = <span>"red"</span>,pvalue_table = <span>T</span>)<br><span>3</span>gseaplot2(y,<span>10</span>,color = <span>"red"</span>,pvalue_table = <span>T</span>)<br><span>4</span>gseaplot2(y, geneSetID = <span>1</span>:<span>3</span>)</code></pre><p>挑选基因通路<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008862" data-ratio="0.6240740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxvR2udDDD95r1yt4Y78ziaicLRNArLaMQ3lHLeslyEcKdgWZzS5Hb5U6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="679" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxvR2udDDD95r1yt4Y78ziaicLRNArLaMQ3lHLeslyEcKdgWZzS5Hb5U6Q/640?wx_fmt=png&amp;from=appmsg"></p><p>挑选多个通路<br><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008863" data-ratio="0.6037037037037037" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxpLKRShYvjEMlQ6CybYjh4qEs4SXdmVZeeeyK3AmKAsiaU3mzAxGtaPw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="678.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxpLKRShYvjEMlQ6CybYjh4qEs4SXdmVZeeeyK3AmKAsiaU3mzAxGtaPw/640?wx_fmt=png&amp;from=appmsg"></p><p>还可以呈现通路的共有基因</p><pre><code><span>1</span><span>### cutting edge作图</span><br><span>2</span><span>if</span>(!requireNamespace(<span>"ggnewscale"</span>,quietly = <span>TRUE</span>)){<br><span>3</span>  options(<span>"repos"</span>=c(CRAN=<span>"https://mirrors.tuna.tsinghua.edu.cn/CRAN/"</span>))<br><span>4</span>  install.packages(<span>"ggnewscale"</span>,update = <span>F</span>,ask = <span>F</span>)<br><span>5</span>}<br><span>6</span>cnetplot(y,showCategory = <span>4</span>,foldChange = geneList,colorEdge = <span>T</span>)<br></code></pre><p><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><p><img data-imgfileid="100008864" data-ratio="0.9333333333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx0D8ITffv9bY7KpNPic1DgHAVH22l5cDuZNIgE7cn4YdjicfsOuicyqEkg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="678.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx0D8ITffv9bY7KpNPic1DgHAVH22l5cDuZNIgE7cn4YdjicfsOuicyqEkg/640?wx_fmt=png&amp;from=appmsg"></p><h3><span>读入kegg 通路kegg gene set</span></h3><p><span>还是先打开GSEA官网</span>https://www.gsea-msigdb.org/gsea/index.jsp<ne-clipboard data="%7B%22type%22%3A%22fragment%22%2C%22name%22%3A%22%23fragment%22%2C%22children%22%3A%5B%7B%22type%22%3A%22element%22%2C%22id%22%3A%22u540ded30%22%2C%22name%22%3A%22p%22%2C%22attrs%22%3A%7B%7D%2C%22children%22%3A%5B%7B%22type%22%3A%22text%22%2C%22id%22%3A%22ub6283807%22%2C%22name%22%3A%22%23text%22%2C%22attrs%22%3A%7B%7D%2C%22data%22%3A%22%E5%85%88%E6%89%93%E5%BC%80GSEA%E5%AE%98%E7%BD%91%22%7D%2C%7B%22type%22%3A%22element%22%2C%22id%22%3A%22uc96ff60c%22%2C%22name%22%3A%22link%22%2C%22attrs%22%3A%7B%22src%22%3A%22https%3A%2F%2Fwww.gsea-msigdb.org%2Fgsea%2Findex.jsp%22%2C%22external%22%3Atrue%7D%2C%22children%22%3A%5B%7B%22type%22%3A%22text%22%2C%22id%22%3A%22u21499036%22%2C%22name%22%3A%22%23text%22%2C%22attrs%22%3A%7B%7D%2C%22data%22%3A%22https%3A%2F%2Fwww.gsea-msigdb.org%2Fgsea%2Findex.jsp%22%7D%5D%7D%5D%7D%5D%2C%22attrs%22%3A%7B%7D%7D" source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23v39Q1"></ne-clipboard></p><p><img data-imgfileid="100008865" data-ratio="0.6416666666666667" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxhcEXyGMroWJoaGB9LU60CqNEOtCblcdp4s4IDP937H5J6gCUfO7h0w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="1188" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxhcEXyGMroWJoaGB9LU60CqNEOtCblcdp4s4IDP937H5J6gCUfO7h0w/640?wx_fmt=png&amp;from=appmsg"><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23DjFk6"></ne-clipboard></p><pre><code><span>1</span>kegg &lt;- read.gmt(<span>"resource/c2.cp.kegg.v2022.1.Hs.symbols.gmt"</span>)<br><span>2</span>y &lt;- GSEA(geneList,TERM2GENE =kegg)<br><span>3</span>yd &lt;- as.data.frame(y)<br><span>4</span><span>### 看整体分布</span><br><span>5</span>dotplot(y,showCategory=<span>12</span>,<br><span>6</span>        font.size = <span>9</span>,<br><span>7</span>        split=<span>".sign"</span>,<br><span>8</span>        label_format = <span>60</span>)+<br><span>9</span>  facet_grid(~.sign)<br></code></pre><p><img data-galleryid="" data-imgfileid="100008873" data-ratio="0.32471264367816094" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxoy0LmWVTTmehicoOf0FscLr4S8nwslrDBectcZLibbrgeXUpcosFfHCw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2436" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxoy0LmWVTTmehicoOf0FscLr4S8nwslrDBectcZLibbrgeXUpcosFfHCw/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-imgfileid="100008866" data-ratio="0.9342592592592592" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx1AwEJibdao1g7GWQ3e8XacPunUKhq5giaURZCQdKqPNNiaOnoQmdAfsYQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="676.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQx1AwEJibdao1g7GWQ3e8XacPunUKhq5giaURZCQdKqPNNiaOnoQmdAfsYQ/640?wx_fmt=png&amp;from=appmsg"><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23GyTzk"></ne-clipboard></p><h3><span>读入转录因子数据集</span></h3><p><strong>转录因子</strong>作为基因调控网络中的重要成分，通过结合特定的DNA序列来控制下游基因的表达。它们通过结合DNA上的特定序列来激活或抑制下游基因的表达。分析转录因子数据有助于我们理解调控网络的复杂性、细胞如何响应信号并发展成特定的细胞类型、为疾病的诊断和治疗提供新的视角等等。</p><pre><code><span> 1</span><span>## 读入转录因子,高能，需要专业知识消化</span><br><span> 2</span>ENCODE_TF &lt;- read.gmt(<span>"resource/ENCODE_TF_ChIP-seq_2015.txt"</span>)<br><span> 3</span><br><span> 4</span>length(table(ENCODE_TF$term))<br><span> 5</span>[<span>1</span>] <span>816</span> <span>#有816个转录因子TF数据</span><br><span> 6</span><br><span> 7</span>tfbs &lt;- GSEA(geneList,TERM2GENE = ENCODE_TF)<br><span> 8</span>tfbsd &lt;- as.data.frame(tfbs)<br><span> 9</span><span>### 看整体分布</span><br><span>10</span>dotplot(tfbs,showCategory=<span>30</span>,split=<span>".sign"</span>)+facet_grid(~.sign)<br><span>11</span><br><span>12</span>gseaplot2(tfbs,<span>"E2F4 MEL cell line mm9"</span>,color = <span>"red"</span>,pvalue_table = <span>T</span>)<br></code></pre><p><img data-galleryid="" data-imgfileid="100008874" data-ratio="0.35919790758500436" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxDrgl6cT2aUwTzTDwpP13OkHrF2TEiantib9zSmib0Y9QGyDMpmfcLBbFQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2294" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxDrgl6cT2aUwTzTDwpP13OkHrF2TEiantib9zSmib0Y9QGyDMpmfcLBbFQ/640?wx_fmt=png&amp;from=appmsg"></p><p><img data-imgfileid="100008867" data-ratio="0.9296296296296296" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxWCiact10icKianzBt4wggdUMDLCCQrkMRuMM8FqRBzmATRtBMOVBbZBcg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="672.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxWCiact10icKianzBt4wggdUMDLCCQrkMRuMM8FqRBzmATRtBMOVBbZBcg/640?wx_fmt=png&amp;from=appmsg"></p><p><ne-clipboard source="https%3A%2F%2Fwww.yuque.com%2Fyuqueyonghupxlbjg%2Fmikh8s%2Fdwdg5mnxbxg1bvnq%23GyTzk"></ne-clipboard></p><p><img data-imgfileid="100008868" data-ratio="0.6064814814814815" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxoBDeiahhZTKF9rtfew1FfTUVCpPddSsRMAFsxS2icgZ3ictq0Oiam7Ydaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" width="676.5" src="https://mmbiz.qpic.cn/sz_mmbiz_png/dgYTF46r3icYqAAxcqtDydOzbHmtD8ZQxoBDeiahhZTKF9rtfew1FfTUVCpPddSsRMAFsxS2icgZ3ictq0Oiam7Ydaw/640?wx_fmt=png&amp;from=appmsg"></p><blockquote><p>感谢果子老师课程中的循循教导和付出，认真学习这个课程，收获很大！<br>对于生信分析感兴趣的同学，还可以看看果子老师其它的生信课程：<br>SC00果子单细胞大课<br>https://shop449275017.v.weidian.com/itemhtml?itemlD=5948666785<br>肿瘤数据挖掘大师课TM00<br>https://shop449275017.v.weidian.com/item.html?itemID=6509772590<br>GZ00果子R数据挖掘大课<br>https://shop449275017.v.weidian.com/item.html?itemID=4410312838</p></blockquote><p><span>作者：黎扬</span></p><p msttexthash="23311756" msthash="54"><span>编辑：</span><span>黎扬</span></p><p msttexthash="24160396" msthash="55"><span msttexthash="4865315" msthash="125">校审</span><span>：林炳昱</span></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ebWiuaiwqtpTYEO2yDJJ0A",target="_blank" rel="noopener noreferrer">原文链接</a>
