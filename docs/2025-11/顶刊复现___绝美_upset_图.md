---
title: "é¡¶åˆŠå¤ç° | ç»ç¾ upset å›¾"
date: 2025-11-05T13:34:52Z
draft: ["false"]
tags: [
  "fetched",
  "MsTtç¬”è®°"
]
categories: ["Acdemic"]
---
é¡¶åˆŠå¤ç° | ç»ç¾ upset å›¾ by MsTtç¬”è®°
------
<div><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTtç¬”è®°" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="SCIç»˜å›¾ï¼ŒPython/Rï¼Œç”Ÿç‰©ä¿¡æ¯ï¼Œæ•°ç†ç»Ÿè®¡ï¼Œå¤šç»„å­¦åŸç†" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf=""><br></span></span></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf="">è¯·å°Šé‡åŸåˆ›åŠ³åŠ¨æˆæœğŸ™</span></span></section><p><span><span leaf="">æœªç»å…è®¸ï¼Œä¸å¯æŠ„è¢­ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä»Šå¤©æ¥å¤ç°2å¼ ç»ç¾çš„</span><strong><span leaf="">upset plot</span></strong><span leaf="">ï¼Œå®ƒæ˜¯ç”¨äºå¯è§†åŒ–é›†åˆäº¤é›†çš„æœ‰æ•ˆå·¥å…·ï¼Œå®Œç¾åœ°å¼¥è¡¥äº†éŸ¦æ©å›¾åœ¨å±•ç¤ºè¶…è¿‡3-4ä¸ªé›†åˆæ—¶çš„å±€é™æ€§ã€‚</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VXfcgiafqWicoqfd8uOuOAeMJGfQwQHicM7BdRLAfbZOVbVZICf9GU0NmQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.2" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001716" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VXfcgiafqWicoqfd8uOuOAeMJGfQwQHicM7BdRLAfbZOVbVZICf9GU0NmQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">upsetå›¾çš„ä½œç”¨ï¼š</span></span></p><ul><li><section><strong><span leaf="">æœ‰æ•ˆå±•ç¤ºå¤šé›†åˆäº¤é›†</span></strong><span leaf="">ï¼šèƒ½å¤Ÿæ¸…æ™°ã€å‡†ç¡®åœ°å±•ç¤º</span><strong><span leaf=""><span textstyle="">3ä¸ªåŠä»¥ä¸Š</span></span></strong><span leaf="">é›†åˆä¹‹é—´çš„äº¤é›†æƒ…å†µã€‚è€Œä¼ ç»Ÿçš„éŸ¦æ©å›¾åœ¨è¶…è¿‡4ä¸ªé›†åˆæ—¶ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ã€éš¾ä»¥é˜…è¯»ã€‚</span></section></li><li><section><strong><span leaf="">åŒæ—¶å‘ˆç°äº¤é›†å¤§å°å’Œé›†åˆç»„æˆ</span></strong><span leaf="">ï¼šé€šè¿‡</span><strong><span leaf=""><span textstyle="">çŸ©é˜µç‚¹å›¾</span></span></strong><span leaf="">å’Œ</span><strong><span leaf=""><span textstyle="">æ¡å½¢å›¾</span></span></strong><span leaf="">çš„ç»„åˆï¼ŒåŒæ—¶å›ç­”äº†ä»¥ä¸‹ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š</span></section></li><ul><li><section><span leaf="">â€œå“ªäº›é›†åˆå‚ä¸äº†äº¤é›†ï¼Ÿâ€ ï¼ˆç”±ä¸‹æ–¹çš„çŸ©é˜µç‚¹å›¾å›ç­”ï¼‰</span></section></li><li><section><span leaf="">â€œè¿™ä¸ªäº¤é›†æœ‰å¤šå¤§ï¼Ÿâ€ ï¼ˆç”±å·¦ä¾§æˆ–ä¸Šæ–¹çš„æ¡å½¢å›¾å›ç­”ï¼‰</span></section></li></ul><li><section><strong><span leaf="">è¯†åˆ«æœ€é‡è¦çš„äº¤é›†</span></strong><span leaf="">ï¼šé€šè¿‡æŒ‰äº¤é›†å¤§å°å¯¹æ¡å½¢å›¾è¿›è¡Œæ’åºï¼Œå¯ä»¥è®©äººä¸€çœ¼å°±çœ‹å‡º</span><strong><span leaf=""><span textstyle="">å“ªä¸ªç»„åˆçš„äº¤é›†åŒ…å«çš„å…ƒç´ æœ€å¤š/æœ€å°‘</span></span></strong><span leaf="">ï¼Œä»è€Œå¿«é€Ÿå®šä½åˆ°æœ€æ˜¾è‘—çš„æ¨¡å¼ã€‚</span></section></li><li><section><strong><span leaf="">æ­ç¤ºé›†åˆé—´çš„å¤æ‚å…³ç³»</span></strong><span leaf="">ï¼šå¯ä»¥å‘ç°ä¸€äº›éç›´è§‚çš„æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š</span></section></li><ul><li><section><span leaf="">â€œæŸä¸ªç‰¹å®šçš„ä¸¤é›†åˆäº¤é›†å¾ˆå¤§ï¼Œä½†å½“å¼•å…¥ç¬¬ä¸‰ä¸ªé›†åˆæ—¶ï¼Œäº¤é›†æ€¥å‰§å˜å°ã€‚â€</span></section></li><li><section><span leaf="">â€œæŸä¸ªå…ƒç´ åªå±äºä¸€ä¸ªé›†åˆï¼Œè¿˜æ˜¯é€šå¸¸ä¸å…¶ä»–ç‰¹å®šé›†åˆå…±åŒå‡ºç°ã€‚â€</span></section></li></ul></ul><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°ä¸€</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¬¬ä¸€ç¯‡æ˜¯Â </span><strong><span leaf="">Clinical And Translational Medicine</span></strong><span leaf="">Â æ–‡ç« ä¸­ (Hengrui Liang et al. LcProt: Proteomics-based identification of plasmabiomarkers for lung cancer multievent, a multicentre study. Clin. Transl. Med. 2025;15:e70160. https://doi.org/10.1002/ctm2.70160) çš„ Fig. 2E</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VSFNSiatcfqguRokft3PNafbb1ebWlprCr6uJlQYqIJH0olWiaxibURB2g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5726415094339623" data-type="png" data-w="1060" data-imgfileid="100001717" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VSFNSiatcfqguRokft3PNafbb1ebWlprCr6uJlQYqIJH0olWiaxibURB2g/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™å¼ å›¾å±•ç¤ºäº†ä¸åŒæ¯”è¾ƒç»„é—´å·®å¼‚è¡¨è¾¾è›‹ç™½ï¼ˆDEPsï¼‰çš„åˆ†å¸ƒä¸é‡å æƒ…å†µï¼š</span></p><ul><li><section><span leaf="">é¡¶éƒ¨æ¡å½¢ï¼šè¡¨ç¤ºç‰¹å®šç»„åˆå…±äº«çš„DEPsæ•°é‡ï¼Œè“è‰²ä»£è¡¨å‡ºç°åœ¨å¤šä¸ªé›†åˆä¸­ï¼Œçº¢è‰²ä»£è¡¨ä»…å‡ºç°åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼›</span></section></li><li><section><span leaf="">å·¦ä¾§æ¡å½¢ï¼šæ˜¾ç¤ºå„æ¯”è¾ƒç»„çš„æ€»DEPsæ•°ï¼›</span></section></li><li><section><span leaf="">åº•éƒ¨çŸ©é˜µï¼šç‚¹æ˜äº†æ„æˆæ¯ä¸ªäº¤é›†çš„å…·ä½“æ¯”è¾ƒç»„ã€‚</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VIvCPPlrOtrWhhIsdbsNxQG5cGKAGwQHpxHhERFIDlnAljb2Iicxiaibww/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6064814814814815" data-type="png" data-w="1080" data-imgfileid="100001721" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VIvCPPlrOtrWhhIsdbsNxQG5cGKAGwQHpxHhERFIDlnAljb2Iicxiaibww/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ³¨æ„ï¼šåæ ‡è½´çš„æˆªæ–­æ•ˆæœï¼Œå¯é€šè¿‡AIå®ç°ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½RåŒ…ï¼Œå‡†å¤‡æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf=""><span>library</span>(UpSetR)</span></code><code><span leaf=""><span>library</span>(ggplot2)</span></code><code><span leaf=""><span>library</span>(readxl)</span></code><code><span leaf=""><span>library</span>(tibble)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ•°æ®</span></span></code><code><span leaf=""><span>data_mat</span>Â &lt;- read_excel(<span>"data1.xlsx"</span>)</span></code><code><span leaf=""><span>data_mat</span>Â &lt;- column_to_rownames(data_mat, var = colnames(data_mat)[<span>1</span>])</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥ï¼ˆ0/1å‹ï¼‰æ¨¡æ‹Ÿæ•°æ®ï¼Œ<span textstyle="">å¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–</span>ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜åˆ¶ UpSet å›¾ - åŸºç¡€ç‰ˆ</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span leaf="">upset(</span></code><code><span leaf="">Â  data_mat, nintersects =Â <span>25</span>,</span></code><code><span leaf="">Â  sets = names(data_mat),</span></code><code><span leaf="">Â  keep.order = TRUE, Â  Â  Â  Â  Â  Â Â <span># è¿™é‡Œæ˜¯Trueï¼Œä¼šä¸è¡¨æ ¼ä¸­åˆ—çš„é¡ºåºç›¸åŒ</span></span></code><code><span leaf="">Â  matrix.dot.alpha =Â <span>0.5</span>,</span></code><code><span leaf="">Â  point.size =Â <span>2.2</span>,</span></code><code><span leaf="">Â  line.size =Â <span>0.7</span>,</span></code><code><span leaf="">Â  mb.ratio = c(<span>0.55</span>,Â <span>0.45</span>),</span></code><code><span leaf="">Â  mainbar.y.label =Â <span>"Intersection size"</span>,</span></code><code><span leaf="">Â  sets.x.label =Â <span>"Set size"</span>,</span></code><code><span leaf="">Â  text.scale = c(<span>1.8</span>,<span>1.4</span>,<span>1.5</span>,<span>1.4</span>,<span>1.4</span>,<span>1.5</span>),Â <span># åˆ†åˆ«æŒ‡å®šYè½´æ ‡é¢˜ã€Yè½´åˆ»åº¦æ ‡ç­¾ã€Xè½´æ ‡é¢˜ã€Xè½´åˆ»åº¦æ ‡ç­¾ã€é›†åˆåç§°å’ŒæŸ±ä½“æ•°å­—æ ‡ç­¾çš„å­—å·å¤§å°</span></span></code><code><span leaf="">Â  order.<span>by</span>Â =Â <span>"freq"</span></span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VUb1ZmpF4EGaz16rCzNFHCShue7nX9AGAGGXjpmZsRS3D24UiaB6vSGw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6096408317580341" data-type="png" data-w="1058" data-imgfileid="100001719" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VUb1ZmpF4EGaz16rCzNFHCShue7nX9AGAGGXjpmZsRS3D24UiaB6vSGw/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜åˆ¶ UpSet å›¾ - ç¾åŒ–ç‰ˆ</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="css"><code><span leaf=""># é¢œè‰²æ˜ å°„</span></code><code><span leaf="">set_colors &lt;- corrplot::<span>COL2</span>(<span>'RdBu'</span>,Â <span>15</span>)[<span>c</span>(<span>4</span>:<span>7</span>,Â <span>9</span>:<span>12</span>)]</span></code><code><span leaf=""><span>names</span>(set_colors) &lt;-Â <span>colnames</span>(data_mat)</span></code><code><span leaf=""><br></span></code><code><span leaf=""># è®¾ç½®metadata</span></code><code><span leaf="">meta_info &lt;- data.<span>frame</span>(</span></code><code><span leaf="">Â  sets =Â <span>colnames</span>(data_mat),</span></code><code><span leaf="">Â  Group =Â <span>colnames</span>(data_mat) Â  Â  # ç”¨é›†åˆåä½œä¸ºåˆ†ç»„</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf="">set_meta &lt;-Â <span>list</span>(</span></code><code><span leaf="">Â  data = meta_info,</span></code><code><span leaf="">Â  plots =Â <span>list</span>(</span></code><code><span leaf="">Â  Â Â <span>list</span>(</span></code><code><span leaf="">Â  Â  Â  type =Â <span>"matrix_rows"</span>, Â  Â  Â  # çŸ©é˜µè¡Œ</span></code><code><span leaf="">Â  Â  Â  column =Â <span>"Group"</span>, Â  Â  Â  Â  Â  # æ ¹æ®å“ªåˆ—æ˜ å°„é¢œè‰²</span></code><code><span leaf="">Â  Â  Â  colors = set_colors, Â  Â  Â  Â # æ¯ä¸ªé›†åˆå¯¹åº”é¢œè‰²</span></code><code><span leaf="">Â  Â  Â  alpha =Â <span>0.25</span></span></code><code><span leaf="">Â  Â  )</span></code><code><span leaf="">Â  )</span></code><code><span leaf="">)</span></code></pre></section><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸºäº metadata - ç»˜åˆ¶ UpSet å›¾ï¼ˆ1ï¼‰</span></span><span></span></h3><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span leaf="">upset(</span></code><code><span leaf="">Â  data_mat, nintersects =Â <span>25</span>,</span></code><code><span leaf="">Â  sets = names(data_mat),</span></code><code><span leaf="">Â  keep.order = TRUE, Â  Â  Â  Â  Â  Â Â <span># è¿™é‡Œæ˜¯Trueï¼Œä¼šä¸è¡¨æ ¼ä¸­åˆ—çš„é¡ºåºç›¸åŒ</span></span></code><code><span leaf="">Â Â <span>set</span>.metadata = set_meta, Â  Â  Â Â <span># è¿™é‡Œæ§åˆ¶çŸ©é˜µèƒŒæ™¯é¢œè‰²å’Œç‚¹çš„é¢œè‰²</span></span></code><code><span leaf="">Â  sets.bar.color = set_colors, Â Â <span># å·¦ä¾§é›†åˆæ¡é¢œè‰²</span></span></code><code><span leaf="">Â  main.bar.color =Â <span>"#4E9AC6"</span>,</span></code><code><span leaf="">Â  queries = list(list(query = intersects,Â <span>params</span>Â = list(<span>"N+_vs_N0"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"StageIV_vs_StageIII"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"StageIV_vs_StageII"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"StageIV_vs_StageI"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"StageIII_vs_StageI"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"StageII_vs_StageI"</span>), color=Â <span>"#ae3336"</span>),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â list(query = intersects,Â <span>params</span>Â = list(<span>"Malignant_vs_Benign"</span>), color=Â <span>"#ae3336"</span>)),</span></code><code><span leaf="">Â  matrix.dot.alpha =Â <span>0.5</span>,</span></code><code><span leaf="">Â  point.size =Â <span>2.2</span>,</span></code><code><span leaf="">Â  line.size =Â <span>0.7</span>,</span></code><code><span leaf="">Â  mb.ratio = c(<span>0.55</span>,Â <span>0.45</span>),</span></code><code><span leaf="">Â  mainbar.y.label =Â <span>"Intersection size"</span>,</span></code><code><span leaf="">Â  sets.x.label =Â <span>"Set size"</span>,</span></code><code><span leaf="">Â  text.scale = c(<span>1.8</span>,<span>1.4</span>,<span>1.5</span>,<span>1.4</span>,<span>1.4</span>,<span>1.5</span>),Â <span># åˆ†åˆ«æŒ‡å®šYè½´æ ‡é¢˜ã€Yè½´åˆ»åº¦æ ‡ç­¾ã€Xè½´æ ‡é¢˜ã€Xè½´åˆ»åº¦æ ‡ç­¾ã€é›†åˆåç§°å’ŒæŸ±ä½“æ•°å­—æ ‡ç­¾çš„å­—å·å¤§å°</span></span></code><code><span leaf="">Â  order.<span>by</span>Â =Â <span>"freq"</span></span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VboNPPo859tJnngdddFJLapJsMrnkrDB8UQ4ZERwWgxpXnbwMnh1pIQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6064814814814815" data-type="png" data-w="1080" data-imgfileid="100001720" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VboNPPo859tJnngdddFJLapJsMrnkrDB8UQ4ZERwWgxpXnbwMnh1pIQ/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸºäº metadata - ç»˜åˆ¶ UpSet å›¾ï¼ˆ2ï¼‰</span></span><span></span></h3><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span leaf="">source(<span>"utils.R"</span>) Â <span># æ”¹å†™äº†ç”»çŸ©é˜µå›¾çš„å‡½æ•°ï¼Œå®ç°èƒŒæ™¯å’Œç‚¹é¢œè‰²çš„å¡«å……</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®æ¡å½¢å›¾é»˜è®¤çš„é¢œè‰²</span></span></code><code><span leaf="">main_bar_colors &lt;- rep(<span>"#4E9AC6"</span>,Â <span>40</span>)</span></code><code><span leaf=""><span># å°†æŒ‡å®šç´¢å¼•æ”¹ä¸ºçº¢è‰²</span></span></code><code><span leaf="">main_bar_colors[c(<span>2</span>,<span>3</span>,<span>4</span>,<span>6</span>,<span>10</span>,<span>11</span>,<span>12</span>)] &lt;-Â <span>"#ae3336"</span></span></code><code><span leaf=""><br></span></code><code><span leaf="">myupset(</span></code><code><span leaf="">Â  data_mat, nintersects =Â <span>25</span>,</span></code><code><span leaf="">Â  sets = names(data_mat),</span></code><code><span leaf="">Â  keep.order = TRUE, Â  Â  Â  Â  Â  Â Â <span># è¿™é‡Œæ˜¯Trueï¼Œä¼šä¸è¡¨æ ¼ä¸­åˆ—çš„é¡ºåºç›¸åŒ</span></span></code><code><span leaf="">Â Â <span>set</span>.metadata = set_meta, Â  Â  Â Â <span># è¿™é‡Œæ§åˆ¶çŸ©é˜µèƒŒæ™¯é¢œè‰²å’Œç‚¹çš„é¢œè‰²</span></span></code><code><span leaf="">Â  sets.bar.color = set_colors, Â Â <span># å·¦ä¾§é›†åˆæ¡é¢œè‰²</span></span></code><code><span leaf="">Â  main.bar.color = main_bar_colors,</span></code><code><span leaf="">Â  matrix.dot.alpha =Â <span>0.5</span>,</span></code><code><span leaf="">Â  point.size =Â <span>3</span>,</span></code><code><span leaf="">Â  line.size =Â <span>0.7</span>,</span></code><code><span leaf="">Â  mb.ratio = c(<span>0.55</span>,Â <span>0.45</span>),</span></code><code><span leaf="">Â  mainbar.y.label =Â <span>"Intersection size"</span>,</span></code><code><span leaf="">Â  sets.x.label =Â <span>"Set size"</span>,</span></code><code><span leaf="">Â  text.scale = c(<span>1.8</span>,<span>1.4</span>,<span>1.5</span>,<span>1.4</span>,<span>1.4</span>,<span>1.5</span>),</span></code><code><span leaf="">Â  order.<span>by</span>Â =Â <span>"freq"</span></span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VIvCPPlrOtrWhhIsdbsNxQG5cGKAGwQHpxHhERFIDlnAljb2Iicxiaibww/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6064814814814815" data-type="png" data-w="1080" data-imgfileid="100001721" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VIvCPPlrOtrWhhIsdbsNxQG5cGKAGwQHpxHhERFIDlnAljb2Iicxiaibww/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æˆ‘ä½¿ç”¨</span><code><span leaf="">UpsetR</span></code><span leaf="">åŒ…æ— æ³•å®Œå…¨å¤ç°è¿™ä¸ªå›¾ï¼Œç›®å‰ç”»å‡ºæ¥è¿™ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒæŒ‰éœ€é€‰æ‹©å§ï¼</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¥ä¸‹æ¥å°†é‡‡ç”¨åŠŸèƒ½æ›´å¼ºå¤§çš„</span><code><span leaf="">ComplexUpset</span></code><span leaf="">åŒ…æ¥å¤ç°ç¬¬äºŒä¸ªå›¾ï¼Œå®ƒçµæ´»æ˜“ç”¨ã€å¯é«˜åº¦è‡ªå®šä¹‰ï¼Œéå¸¸é€‚åˆç»˜åˆ¶å¤æ‚çš„ UpSet å›¾ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°äºŒ</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ç¬¬äºŒç¯‡æ˜¯Â </span><strong><span leaf="">Microbiome</span></strong><span leaf="">Â æ–‡ç« ä¸­ (Ferrarini, M.G., Vallier, A., Vincent-MonÃ©gat, C. et al. Coordination of host and endosymbiont gene expression governs endosymbiont growth and elimination in the cereal weevil Sitophilus spp.. Microbiome 11, 274 (2023). https://doi.org/10.1186/s40168-023-01714-8) çš„ Fig. 3</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VmCAjdj25eiarf2iciaw06QJ2iavMYtWtEt5iajD9DHRCWKKLL1nnk7tClsQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.525" data-type="png" data-w="1080" data-imgfileid="100001722" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VmCAjdj25eiarf2iciaw06QJ2iavMYtWtEt5iajD9DHRCWKKLL1nnk7tClsQ/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¿™å¼ å›¾å±•ç¤ºäº†</span><strong><span leaf="">2ç§ç±»å‹</span></strong><span leaf="">çš„æ˜†è™«åœ¨</span><strong><span leaf="">äº”ä¸ªå‘è‚²é˜¶æ®µ</span></strong><span leaf="">ä¸­çš„å·®å¼‚è¡¨è¾¾åŸºå› ï¼ˆDEGsï¼‰çš„åˆ†å¸ƒä¸é‡å æƒ…å†µï¼š</span></p><ul><li><section><span leaf="">é¡¶éƒ¨æ¡å½¢ï¼šè¡¨ç¤ºåœ¨ç‰¹å®šé˜¶æ®µç»„åˆä¸­å…±åŒå·®å¼‚è¡¨è¾¾çš„åŸºå› æ•°é‡ï¼Œç´«è‰²ä»£è¡¨ä»…åœ¨Symbioticä¸­ä¸Šè°ƒã€ç°è‰²ä»£è¡¨ä»…åœ¨Aposymbioticä¸­ä¸Šè°ƒã€é»„è‰²è¡¨ç¤ºå‘ˆç°æ··åˆè¡¨è¾¾æ¨¡å¼ï¼›</span></section></li><li><section><span leaf="">å·¦ä¾§æ¡å½¢ï¼šæ˜¾ç¤ºæ¯ä¸ªå‘è‚²é˜¶æ®µä¸­å·®å¼‚è¡¨è¾¾åŸºå› çš„æ€»æ•°ï¼›</span></section></li><li><section><span leaf="">åº•éƒ¨çŸ©é˜µï¼šæ ‡ç¤ºç»„æˆå„äº¤é›†çš„å‘è‚²é˜¶æ®µç»„åˆï¼Œåœ†å½¢ç‚¹ä»£è¡¨Symbioticä¸Šè°ƒã€ä¸‰è§’å½¢ç‚¹ä»£è¡¨Aposymbioticä¸Šè°ƒï¼›</span></section></li></ul><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾</span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VCe49BlSoXZsHiaIbUeCPVJ2ofR6wQN4Qu55WT83H5wicriax64jbY3SbA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.48148148148148145" data-type="png" data-w="1080" data-imgfileid="100001723" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VCe49BlSoXZsHiaIbUeCPVJ2ofR6wQN4Qu55WT83H5wicriax64jbY3SbA/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½RåŒ…ï¼Œå‡†å¤‡æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="python"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf="">library(ComplexUpset)</span></code><code><span leaf="">library(ggplot2)</span></code><code><span leaf="">library(readxl)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ•°æ®</span></span></code><code><span leaf="">DEG_df &lt;- read_excel(<span>"data2.xlsx"</span>) Â <span># å·®å¼‚åŸºå› </span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># æ‰¾åˆ° log2FC åˆ—å’Œ padj åˆ—</span></span></code><code><span leaf="">log2fc_cols &lt;- grep(<span>"log2fc"</span>, colnames(data))</span></code><code><span leaf="">padj_cols Â  &lt;- grep(<span>"padj"</span>, colnames(data))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆ¤æ–­æ¯ä¸ªåŸºå› åœ¨ä»»æ„æ—¶é—´ç‚¹æ˜¯å¦ä¸ºå·®å¼‚è¡¨è¾¾ï¼Œå¹¶åˆ›å»ºé€»è¾‘çŸ©é˜µ</span></span></code><code><span leaf="">is_DEG &lt;- apply(data,Â <span>1</span>, function(row) {</span></code><code><span leaf="">Â Â <span>any</span>(<span>abs</span>(<span>as</span>.numeric(row[log2fc_cols])) &gt;Â <span>0.5</span>Â &amp;Â <span>as</span>.numeric(row[padj_cols]) &lt;Â <span>0.05</span>)</span></code><code><span leaf="">})</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ç­›é€‰å·®å¼‚åŸºå› </span></span></code><code><span leaf="">DEG_df &lt;- data[is_DEG, ]</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥æ•°æ®ï¼Œæ­¤æ•°æ®åŒ…å«å¤šä¸ªæ¯”è¾ƒç»„çš„å·®å¼‚åˆ†æç»“æœï¼Œå¹¶ç­›é€‰å·®å¼‚åŸºå› ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">è½¬æ¢æ•°æ®æ ¼å¼</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span># å°†æ•°æ®è½¬æˆupsetéœ€è¦çš„0/1æ ¼å¼</span></span></code><code><span leaf=""><span># åˆ›å»ºä¸¤ä¸ªçŸ©é˜µï¼šApoæ–¹å‘ä¸Symæ–¹å‘</span></span></code><code><span leaf="">Apo_mat &lt;-Â <span>as</span>.data.<span>frame</span>(</span></code><code><span leaf="">Â Â <span>lapply</span>(DEG_df[, log2fc_cols], function(x)Â <span>as</span>.<span>integer</span>(<span>as</span>.<span>numeric</span>(x) &gt;Â <span>0.5</span>))</span></code><code><span leaf="">)</span></code><code><span leaf="">Sym_mat &lt;-Â <span>as</span>.data.<span>frame</span>(</span></code><code><span leaf="">Â Â <span>lapply</span>(DEG_df[, log2fc_cols], function(x)Â <span>as</span>.<span>integer</span>(<span>as</span>.<span>numeric</span>(x) &lt; -<span>0.5</span>))</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># é‡å‘½ååˆ—</span></span></code><code><span leaf=""><span>colnames</span>(Apo_mat) &lt;-Â <span>gsub</span>(<span>"\\.log2fc"</span>,Â <span>"_Apo"</span>,Â <span>colnames</span>(DEG_df)[log2fc_cols])</span></code><code><span leaf=""><span>colnames</span>(Sym_mat) &lt;-Â <span>gsub</span>(<span>"\\.log2fc"</span>,Â <span>"_Sym"</span>,Â <span>colnames</span>(DEG_df)[log2fc_cols])</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆå¹¶ä¸¤ä¸ªçŸ©é˜µ</span></span></code><code><span leaf="">binary_mat &lt;-Â <span>cbind</span>(DEG_df<span>$GeneID</span>, Apo_mat, Sym_mat, Expression = DEG_df<span>$Expression</span>)</span></code><code><span leaf=""><span>colnames</span>(binary_mat)[<span>1</span>] &lt;-Â <span>"GeneID"</span></span></code></pre></section><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜åˆ¶ UpSet å›¾ - åŸºç¡€ç‰ˆ</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span leaf="">upset(</span></code><code><span leaf="">Â  binary_mat,</span></code><code><span leaf="">Â Â <span>intersect</span>Â <span>=</span>Â set_cols, Â  Â  Â Â </span></code><code><span leaf="">Â  nameÂ <span>=</span>Â <span>NULL</span>, # å›¾ä¾‹æ ‡é¢˜</span></code><code><span leaf="">Â  height_ratioÂ <span>=</span>Â <span>1</span>,</span></code><code><span leaf="">Â  width_ratioÂ <span>=</span>Â <span>0.12</span>,Â </span></code><code><span leaf="">Â  min_sizeÂ <span>=</span>Â <span>21</span>,Â </span></code><code><span leaf="">Â  keep_empty_groupsÂ <span>=</span>Â <span>TRUE</span>,</span></code><code><span leaf="">Â  sort_setsÂ <span>=</span>Â <span>FALSE</span></span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3Vx8e3xyBsLhELnUVbQFHpc6o9jLfuh8MiaFfU9NpaIyn7p4corLSvmJw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.40431519699812385" data-type="png" data-w="1066" data-imgfileid="100001724" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3Vx8e3xyBsLhELnUVbQFHpc6o9jLfuh8MiaFfU9NpaIyn7p4corLSvmJw/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜åˆ¶ UpSet å›¾ - ç¾åŒ–ç‰ˆ</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf="">upset(</span></code><code><span leaf="">Â  binary_mat,</span></code><code><span leaf="">Â  intersect = set_cols, Â  Â  Â Â </span></code><code><span leaf="">Â  name = NULL,Â <span># å›¾ä¾‹æ ‡é¢˜</span></span></code><code><span leaf="">Â  height_ratio = 1,</span></code><code><span leaf="">Â  width_ratio = 0.12,Â </span></code><code><span leaf="">Â  min_size = 21,Â </span></code><code><span leaf="">Â  keep_empty_groups = TRUE,</span></code><code><span leaf="">Â  sort_sets = FALSE,</span></code><code><span leaf="">Â  stripes=c(<span>'white'</span>,<span>'#e7dcf5'</span>,<span>'white'</span>,<span>'#e7dcf5'</span>,<span>'white'</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>'#e4e4e4'</span>,<span>'white'</span>,<span>'#e4e4e4'</span>,<span>'white'</span>,<span>'#e4e4e4'</span>),</span></code><code><span leaf="">Â Â <span># è®¾ç½®ä¸Šä¾§æ¡å½¢å›¾</span></span></code><code><span leaf="">Â  base_annotations = list(</span></code><code><span leaf="">Â  Â Â <span>'Intersection size'</span>Â = intersection_size(</span></code><code><span leaf="">Â  Â  Â  counts = TRUE,</span></code><code><span leaf="">Â  Â  Â  text=list(color =Â <span>'black'</span>, size = 3),</span></code><code><span leaf="">Â  Â  Â  mapping = aes(fill = Expression), Â  Â  Â  Â <span># æŸ±å­å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â  Â  ) +</span></code><code><span leaf="">Â  Â  Â  scale_fill_manual(values = c( Â  Â  Â  Â  Â  Â <span># æŸ±å­çš„é¢œè‰²æ˜ å°„</span></span></code><code><span leaf="">Â  Â  Â  Â Â <span>"Up-regulated in Apoymbiotic Insects"</span>Â =Â <span>"#a9a9a9"</span>,</span></code><code><span leaf="">Â  Â  Â  Â Â <span>"Up-regulated in Symbiotic Insects"</span>Â  Â =Â <span>"#986bd3"</span>,</span></code><code><span leaf="">Â  Â  Â  Â Â <span>"Mixed expression"</span>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  =Â <span>"#feac03"</span></span></code><code><span leaf="">Â  Â  Â  ))</span></code><code><span leaf="">Â  ),</span></code><code><span leaf="">Â Â <span># è®¾ç½®å·¦ä¾§æ¡å½¢å›¾</span></span></code><code><span leaf="">Â  set_sizes = upset_set_size(</span></code><code><span leaf="">Â  Â  geom = geom_bar(width = 0.7)) +</span></code><code><span leaf="">Â  Â  ylab(<span>"Number of DEGs"</span>),</span></code><code><span leaf="">Â Â <span># è®¾ç½®åº•éƒ¨æ•£ç‚¹çŸ©é˜µå›¾</span></span></code><code><span leaf="">Â  matrix = intersection_matrix(</span></code><code><span leaf="">Â  Â  geom = geom_point(size = 2.5)</span></code><code><span leaf="">Â  ),</span></code><code><span leaf="">Â Â <span># è®¾ç½®æ¡å½¢å›¾å’Œæ•£ç‚¹å›¾çš„å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â  queries = list(</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D1_Apo'</span>, color =Â <span>'#ff9c98'</span>, fill =Â <span>'#ff9c98'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D3_Apo'</span>, color =Â <span>'#b41600'</span>, fill =Â <span>'#b41600'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D5_Apo'</span>, color =Â <span>'#8a0001'</span>, fill =Â <span>'#8a0001'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D7_Apo'</span>, color =Â <span>'#182d80'</span>, fill =Â <span>'#182d80'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D9_Apo'</span>, color =Â <span>'#1949e4'</span>, fill =Â <span>'#1949e4'</span>),</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D1_Sym'</span>, color =Â <span>'#ff9c98'</span>, fill =Â <span>'#ff9c98'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D3_Sym'</span>, color =Â <span>'#b41600'</span>, fill =Â <span>'#b41600'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D5_Sym'</span>, color =Â <span>'#8a0001'</span>, fill =Â <span>'#8a0001'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D7_Sym'</span>, color =Â <span>'#182d80'</span>, fill =Â <span>'#182d80'</span>),</span></code><code><span leaf="">Â  Â  upset_query(<span>set</span>Â =Â <span>'D9_Sym'</span>, color =Â <span>'#1949e4'</span>, fill =Â <span>'#1949e4'</span>)</span></code><code><span leaf="">Â  Â  )</span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VrGodWjoOMnwzsa9PZUBFyBnWHXxe3WibVsjLmD50oFYCncmPXLOWe3Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4166666666666667" data-type="png" data-w="1080" data-imgfileid="100001725" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VrGodWjoOMnwzsa9PZUBFyBnWHXxe3WibVsjLmD50oFYCncmPXLOWe3Q/640?wx_fmt=png&amp;from=appmsg"></span></p><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜åˆ¶äºŒå…ƒVennå›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf=""><span>library</span>(VennDiagram)</span></code><code><span leaf=""><span>library</span>(dplyr)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># åˆ†ç»„æå–åŸºå› é›†åˆï¼šå‡è®¾å·²ç»å‡†å¤‡å¥½DEG_dfï¼ˆè§upsetéƒ¨åˆ†ï¼‰</span></span></code><code><span leaf="">Up_Sym &lt;- DEG_df %&gt;%Â </span></code><code><span leaf="">Â Â <span>filter</span>(Expression !=Â <span>"Up-regulated in Apoymbiotic Insects"</span>) %&gt;%Â </span></code><code><span leaf="">Â Â <span>pull</span>(GeneID)</span></code><code><span leaf=""><br></span></code><code><span leaf="">Up_Apo &lt;- DEG_df %&gt;%Â </span></code><code><span leaf="">Â Â <span>filter</span>(Expression !=Â <span>"Up-regulated in Symbiotic Insects"</span>) %&gt;%Â </span></code><code><span leaf="">Â Â <span>pull</span>(GeneID)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># ç»˜åˆ¶Vennå›¾</span></span></code><code><span leaf="">venn.plot &lt;- venn.<span>diagram</span>(</span></code><code><span leaf="">Â  x =Â <span>list</span>(Apoymbiotic = Up_Apo, Symbiotic = Up_Sym),</span></code><code><span leaf="">Â  filename =Â <span>NULL</span>, Â  Â  Â Â <span># ä¸ä¿å­˜æ–‡ä»¶ï¼Œç›´æ¥ç»˜åˆ¶</span></span></code><code><span leaf="">Â  scaled =Â <span>FALSE</span>, Â  Â  Â  Â <span># æ˜¯å¦æ ¹æ®æ¯”ä¾‹æ˜¾ç¤ºå¤§å°</span></span></code><code><span leaf="">Â  category.names =Â <span>c</span>(<span>"Up-regulation in\nApoymbiotic"</span>,Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Up-regulation\nin Symbiotic"</span>),</span></code><code><span leaf="">Â  fill =Â <span>c</span>(<span>"#a9a9a9"</span>,Â <span>"#986bd3"</span>), Â Â <span># åœˆçš„å†…éƒ¨å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â  alpha =Â <span>1</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># åœˆçš„å†…éƒ¨å¡«å……é¢œè‰²çš„é€æ˜åº¦</span></span></code><code><span leaf="">Â  col =Â <span>"black"</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># åœˆçš„å¤–éƒ¨è¾¹æ¡†çº¿çš„é¢œè‰²</span></span></code><code><span leaf="">Â  lwd =Â <span>3</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># åœˆçš„å¤–éƒ¨è¾¹æ¡†çº¿çš„ç²—ç»†</span></span></code><code><span leaf="">Â  lty =Â <span>1</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># åœˆçš„å¤–éƒ¨è¾¹æ¡†çº¿çš„ç±»å‹ï¼Œ1ä¸ºç›´çº¿</span></span></code><code><span leaf="">Â  label.col =Â <span>"white"</span>, Â  Â  Â  Â <span># åœ†å†…æ•°å­—çš„å­—ä½“é¢œè‰²</span></span></code><code><span leaf="">Â  cex =Â <span>1.8</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â <span># åœˆå†…æ•°å­—çš„å­—ä½“å¤§å°</span></span></code><code><span leaf="">Â  fontfamily =Â <span>"ArialMT"</span>, Â  Â Â <span># åœ†å†…æ•°å­—çš„å­—ä½“</span></span></code><code><span leaf="">Â  cat.col =Â <span>c</span>(<span>"#444444"</span>,Â <span>"#953df8"</span>Â ), Â Â <span># å¤–åœˆç±»åˆ«æ ‡ç­¾çš„é¢œè‰²</span></span></code><code><span leaf="">Â  cat.cex =Â <span>1.8</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span># å¤–åœˆç±»åˆ«æ ‡ç­¾çš„å­—ä½“å¤§å°</span></span></code><code><span leaf="">Â  cat.fontfamily =Â <span>"ArialMT"</span>, Â  Â  Â  Â  Â Â <span># å¤–åœˆç±»åˆ«æ ‡ç­¾çš„å­—ä½“</span></span></code><code><span leaf="">Â  cat.dist =Â <span>0.15</span>, Â  Â  Â  Â  Â <span># åœˆçš„åŠå¾„</span></span></code><code><span leaf="">Â  cat.pos =Â <span>c</span>(<span>45</span>, -<span>145</span>), Â  Â <span># è°ƒæ•´æ ‡ç­¾ä½ç½®,é¡ºæ—¶é’Ÿ360åº¦</span></span></code><code><span leaf="">Â  rotation.degree = -<span>90</span>, Â  Â <span># æ•´ä½“æ—‹è½¬ 90Â°</span></span></code><code><span leaf="">Â  margin =Â <span>0.1</span>, Â  Â  Â  Â  Â  Â Â <span># è¾¹è·</span></span></code><code><span leaf="">Â  imagetype =Â <span>"pdf"</span></span></code><code><span leaf="">)</span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3V7r05PxFjuroIMD0iaJXaYjic630Wic7T1kglvBs4biauiaXia8K1pbdw5syA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.014827018121911" data-s="300,640" data-type="png" data-w="607" type="block" data-imgfileid="100001726" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3V7r05PxFjuroIMD0iaJXaYjic630Wic7T1kglvBs4biauiaXia8K1pbdw5syA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä½¿ç”¨AIç»„åˆå›¾å½¢ï¼š</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VCe49BlSoXZsHiaIbUeCPVJ2ofR6wQN4Qu55WT83H5wicriax64jbY3SbA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.48148148148148145" data-type="png" data-w="1080" data-imgfileid="100001727" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKL4VA9XLDiaDvGarIQ4CKb3VCe49BlSoXZsHiaIbUeCPVJ2ofR6wQN4Qu55WT83H5wicriax64jbY3SbA/640?wx_fmt=png&amp;from=appmsg"></span></p></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">è·å–ä»¥ RProject å½¢å¼ä¿å­˜çš„</span></span><strong><span leaf=""><span textstyle="">ç»˜å›¾ä»£ç +æ³¨é‡Š+æ•°æ®æ¨¡æ¿</span></span></strong><span leaf=""><span textstyle="">ï¼Œåå°å›å¤å…³é”®è¯:Â </span></span><strong><em><span leaf=""><span textstyle="">251105_upset_plot</span></span></em></strong></p></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v122" data-goodssouce="1" data-traceid="176cec84-7f71-40cd-a0ef-b05f19404150" data-pid="101_14324026"></mp-common-cpsad></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v122" data-goodssouce="1" data-traceid="176cec84-7f71-40cd-a0ef-b05f19404150" data-pid="101_14835066"></mp-common-cpsad></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ex5MbMF6OQSNd4DF7uMYeg",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
