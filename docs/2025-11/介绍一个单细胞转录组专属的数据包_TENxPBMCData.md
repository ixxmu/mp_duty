---
title: "介绍一个单细胞转录组专属的数据包：TENxPBMCData"
date: 2025-11-23T23:26:47Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
介绍一个单细胞转录组专属的数据包：TENxPBMCData by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">最近看文献，发现了一个有意思的R包，主要用来获取10X Genomics生成的外周血单核细胞多种单细胞RNA测序数据集。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">TENxPBMCData数据包用于表示和操作 10X Genomics 生成的九种不同外周血单核细胞（PBMC）单细胞RNA测序（scRNA-seq）及CITE-seq数据集：</span></p><ol><li><section><span leaf=""><span textstyle="">pbmc68k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/fresh_68k_pbmc_donor_a</span></section></li><li><section><span leaf=""><span textstyle="">frozen_pbmc_donor_a</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_a</span></section></li><li><section><span leaf=""><span textstyle="">frozen_pbmc_donor_b</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_b</span></section></li><li><section><span leaf=""><span textstyle="">frozen_pbmc_donor_c</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_c</span></section></li><li><section><span leaf=""><span textstyle="">pbmc33k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc33k</span></section></li><li><section><span leaf=""><span textstyle="">pbmc3k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc3k</span></section></li><li><section><span leaf=""><span textstyle="">pbmc6k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc6k</span></section></li><li><section><span leaf=""><span textstyle="">pbmc4k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc4k</span></section></li><li><section><span leaf=""><span textstyle="">pbmc8k</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k</span></section></li><li><section><span leaf=""><span textstyle="">pbmc5k-CITEseq</span>：https://support.10xgenomics.com/single-cell-gene-expression/datasets/3.0.2/5k_pbmc_protein_v3</span></section></li></ol><p data-tool="mdnice编辑器"><span leaf="">这里作者提供的数据未对经过“过滤”的10X单细胞RNA测序或CITE-seq数据进行任何处理，数据均保持原始状态提供。</span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">安装一下</span></span></h2><pre data-tool="mdnice编辑器"><code><span><span leaf="">## 使用西湖大学的 Bioconductor镜像</span></span><span leaf=""><br></span><span leaf="">options(BioC_mirror=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/bioconductor"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(</span><span><span leaf="">"repos"</span></span><span leaf="">=c(CRAN=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/CRAN/"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">if</span></span><span leaf=""> (!require(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">, quietly = TRUE))</span><span leaf=""><br></span><span leaf="">    install.packages(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">BiocManager::install(</span><span><span leaf="">"TENxPBMCData"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">加载数据</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">使用 TENxPBMCData 函数从 Bioconductor 的 ExperimentHub 网络资源下载相关文件，其中包括包含 counts 数据的 HDF5 文件，以及行（基因）和列（细胞）的 meta 数据。输出结果为  SingleCellExperiment 对象。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(TENxPBMCData)</span><span leaf=""><br></span><span leaf="">tenx_pbmc4k &lt;- TENxPBMCData(dataset = </span><span><span leaf="">"pbmc4k"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">tenx_pbmc4k</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## class: SingleCellExperiment </span></span><span leaf=""><br></span><span><span leaf="">## dim: 33694 4340 </span></span><span leaf=""><br></span><span><span leaf="">## metadata(0):</span></span><span leaf=""><br></span><span><span leaf="">## assays(1): counts</span></span><span leaf=""><br></span><span><span leaf="">## rownames(33694): ENSG00000243485 ENSG00000237613 ... ENSG00000277475</span></span><span leaf=""><br></span><span><span leaf="">##   ENSG00000268674</span></span><span leaf=""><br></span><span><span leaf="">## rowData names(3): ENSEMBL_ID Symbol_TENx Symbol</span></span><span leaf=""><br></span><span><span leaf="">## colnames: NULL</span></span><span leaf=""><br></span><span><span leaf="">## colData names(11): Sample Barcode ... Individual Date_published</span></span><span leaf=""><br></span><span><span leaf="">## reducedDimNames(0):</span></span><span leaf=""><br></span><span><span leaf="">## mainExpName: NULL</span></span><span leaf=""><br></span><span><span leaf="">## altExpNames(0):</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">counts值：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">counts(tenx_pbmc4k)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## &lt;33694 x 4340&gt; sparse DelayedMatrix object of type "integer":</span></span><span leaf=""><br></span><span><span leaf="">##                    [,1]    [,2]    [,3]    [,4] ... [,4337] [,4338] [,4339]</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000243485       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000237613       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000186092       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000238009       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000239945       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">##             ...       .       .       .       .   .       .       .       .</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000277856       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000275063       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000271254       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000277475       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000268674       0       0       0       0   .       0       0       0</span></span><span leaf=""><br></span><span><span leaf="">##                 [,4340]</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000243485       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000237613       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000186092       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000238009       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000239945       0</span></span><span leaf=""><br></span><span><span leaf="">##             ...       .</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000277856       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000275063       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000271254       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000277475       0</span></span><span leaf=""><br></span><span><span leaf="">## ENSG00000268674       0</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">转为seurat：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(scater)</span><span leaf=""><br></span><span leaf="">library(SingleCellExperiment)</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span><span leaf=""># 基因</span></span><span leaf=""><br></span><span leaf="">gene &lt;- rowData(tenx_pbmc4k)</span><span leaf=""><br></span><span leaf="">dim(gene)</span><span leaf=""><br></span><span leaf="">head(gene)</span><span leaf=""><br></span><span leaf="">kp &lt;- !duplicated(gene</span><span><span leaf="">$Symbol_TENx</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">table(kp)</span><span leaf=""><br></span><span leaf="">gene &lt;- gene[kp, ]</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 细胞信息</span></span><span leaf=""><br></span><span leaf="">meta &lt;- colData(tenx_pbmc4k)</span><span leaf=""><br></span><span leaf="">rownames(meta) &lt;- meta</span><span><span leaf="">$Barcode</span></span><span leaf=""><br></span><span leaf="">head(meta)</span><span leaf=""><br></span><span leaf="">dim(meta)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># count</span></span><span leaf=""><br></span><span leaf="">ct &lt;- as.matrix(counts(tenx_pbmc4k))</span><span leaf=""><br></span><span leaf="">dim(ct)</span><span leaf=""><br></span><span leaf="">ct &lt;- ct[kp, ]</span><span leaf=""><br></span><span leaf="">colnames(ct) &lt;- meta</span><span><span leaf="">$Barcode</span></span><span leaf=""><br></span><span leaf="">rownames(ct) &lt;- gene</span><span><span leaf="">$Symbol_TENx</span></span><span leaf=""><br></span><span leaf="">ct[1:9,1:8]</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">seurat_pbmc4k &lt;- CreateSeuratObject(counts = ct, meta.data =  meta)</span><span leaf=""><br></span><span leaf="">seurat_pbmc4k</span><span leaf=""><br></span><span leaf="">as.data.frame(seurat_pbmc4k@assays</span><span><span leaf="">$RNA</span></span><span><span leaf="">$counts</span></span><span leaf="">[c(</span><span><span leaf="">"CD3D"</span></span><span leaf="">,</span><span><span leaf="">"CD3E"</span></span><span leaf="">), 1:20])</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdApfib3xnib4G2swyicWWDtt1980gML3Guhe77XBicWoibVzmcrhsTvSykHQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.16111111111111112" data-type="png" data-w="1080" data-imgfileid="100063493" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdApfib3xnib4G2swyicWWDtt1980gML3Guhe77XBicWoibVzmcrhsTvSykHQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">首次调用TENxPBMCData()时可能需要一些时间，其他的数据集有哪些可以通过 dataset 参数选择要下载的数据集，具体可选值可通过函数定义查看：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">args(TENxPBMCData)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## function (dataset = c("pbmc4k", "pbmc68k", "frozen_pbmc_donor_a", </span></span><span leaf=""><br></span><span><span leaf="">##     "frozen_pbmc_donor_b", "frozen_pbmc_donor_c", "pbmc33k", </span></span><span leaf=""><br></span><span><span leaf="">##     "pbmc3k", "pbmc6k", "pbmc8k", "pbmc5k-CITEseq"), as.sparse = TRUE) </span></span><span leaf=""><br></span><span><span leaf="">## NULL</span></span><span leaf=""><br></span></code></pre><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">还有两个经常会用的数据包</span></span></h2><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">seurat-data包</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这个大家很熟悉了：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">############ 其他包：seurat-data----</span></span><span leaf=""><br></span><span><span leaf=""># install.packages('devtools')</span></span><span leaf=""><br></span><span><span leaf=""># devtools::install_github('satijalab/seurat-data')</span></span><span leaf=""><br></span><span leaf="">library(SeuratData) </span><span><span leaf=""># 加载seurat数据集  </span></span><span leaf=""><br></span><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf="">InstallData(</span><span><span leaf="">"pbmc3k"</span></span><span leaf="">)  </span><span leaf=""><br></span><span leaf="">data(</span><span><span leaf="">"pbmc3k"</span></span><span leaf="">)  </span><span leaf=""><br></span><span leaf="">sce &lt;- pbmc3k.final </span><span leaf=""><br></span><span leaf="">sce &lt;- UpdateSeuratObject(sce)</span><span leaf=""><br></span><span leaf="">sce</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdZ3Z7Zo7tDsB9E1JJWic7wdXKPbsgdEwHA3JJfhVKFtY8cAWxGgyIHfg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.1905972045743329" data-type="png" data-w="787" data-imgfileid="100063492" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdZ3Z7Zo7tDsB9E1JJWic7wdXKPbsgdEwHA3JJfhVKFtY8cAWxGgyIHfg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">scRNAseq包</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这个里面超多数据：</span></p><p data-tool="mdnice编辑器"><span leaf="">https://bioconductor.org/packages/release/data/experiment/vignettes/scRNAseq/inst/doc/scRNAseq.html</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">############ 其他包：seurat-data----</span></span><span leaf=""><br></span><span><span leaf=""># BiocManager::install("scRNAseq")</span></span><span leaf=""><br></span><span leaf="">library(scRNAseq)</span><span leaf=""><br></span><span leaf="">all.ds &lt;- surveyDatasets()</span><span leaf=""><br></span><span leaf="">all.ds</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">searchDatasets(</span><span><span leaf="">"brain"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce.416b &lt;- LunSpikeInData(</span><span><span leaf="">which</span></span><span leaf="">=</span><span><span leaf="">"416b"</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">sce.416b</span><span><span leaf="">$block</span></span><span leaf=""> &lt;- factor(sce.416b</span><span><span leaf="">$block</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sce.416b</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce.zeisel &lt;- ZeiselBrainData()</span><span leaf=""><br></span><span leaf="">sce.zeisel &lt;- aggregateAcrossFeatures(sce.zeisel, id=sub(</span><span><span leaf="">"_loc[0-9]+$"</span></span><span leaf="">, </span><span><span leaf="">""</span></span><span leaf="">, rownames(sce.zeisel)))</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce &lt;- GrunPancreasData()</span><span leaf=""><br></span><span leaf="">sce.pancreas</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdEpFJzf1RP5PWXmAj0mtYRDdPcweaI70sKzcJAe0wF2to7WRkpmluzw/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1289966923925028" data-type="png" data-w="907" data-imgfileid="100063494" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyppp6nV5oKmmK9qiacLzrJdEpFJzf1RP5PWXmAj0mtYRDdPcweaI70sKzcJAe0wF2to7WRkpmluzw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">如果画图或者什么分析一时半会找不到示例数据，就看看这几个包吧。</span></p><p data-tool="mdnice编辑器"><span leaf="">note：后面才发现曾老板以前也看到过了这个包，也是看文献里面知道的，这里 <a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247502623&amp;idx=1&amp;sn=9094ecf76cf65dc3fe167f42c4d9b2df&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">听说你还缺PBMC单细胞数据</a>。</span></p><p data-tool="mdnice编辑器"><span leaf="">目前走的还都是老板曾经的路，<span textstyle="">道阻且长啊</span>。</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">如果上面的内容对你有帮助，欢迎一键三连！</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">友情转发：</span></span></p></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247547012&amp;idx=1&amp;sn=f55923d9a6d9e04c3e923c2a3cae6e56&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课12月班" data-itemshowtype="0" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课12月班</a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/9n2taoH6K9Cr5majrE1NBg",target="_blank" rel="noopener noreferrer">原文链接</a>
