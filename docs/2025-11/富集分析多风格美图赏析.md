---
title: "富集分析多风格美图赏析"
date: 2025-11-21T08:18:34Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
富集分析多风格美图赏析 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">欢迎关注R语言数据分析指南</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">在上一节中，我们基于差异分析的结果进行GO富集分析，在拿到分析结果后就可以进行一系列的数据可视化。此前小编已经分享过了一系列此类图表，因此此次来展示一下以往写过的一系列火山图案例供各位读者参考。整体过程基本类似，可以说是一类一通百通的图表。个人观点，仅供参考。</span></p></blockquote><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">kegg富集分析</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">基于上一份文档未列出kegg的分析代码此次补充如下</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ekegg.lm &lt;- enrichKEGG(</span><span leaf=""><br></span><span leaf="">  gene          = deg.lm,</span><span leaf=""><br></span><span leaf="">  organism      = </span><span><span leaf="">"mmu"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  pvalueCutoff  = </span><span><span leaf="">0.05</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 转换成 gene symbol</span></span><span leaf=""><br></span><span leaf="">ekegg.lm &lt;- setReadable(ekegg.lm, OrgDb = org.Mm.eg.db, keyType=</span><span><span leaf="">"ENTREZID"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">ekegg.lm %&gt;% view()</span><span leaf=""><br></span><span><span leaf=""># 绘制基础图</span></span><span leaf=""><br></span><span leaf="">dotplot(ekegg.lm, showCategory = </span><span><span leaf="">20</span></span><span leaf="">) + </span><span leaf=""><br></span><span leaf="">  ggtitle(</span><span><span leaf="">"KEGG enrichment — Lm vs SPF"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2M3ghaK6dBh9h9relvxkjKbo1oJl3iaT9jQYZhFWH2nyuocYmrFMbKibQA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4527777777777778" data-type="png" data-w="1080" data-imgfileid="100054574" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2M3ghaK6dBh9h9relvxkjKbo1oJl3iaT9jQYZhFWH2nyuocYmrFMbKibQA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例1 多组学联合展示</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">该图通过桑基图结合气泡图的方式，直观展示了代谢物与代谢通路之间的对应关系及富集特征。左侧列出了显著代谢物，中间通过曲线连接其所属的KEGG代谢通路，右侧气泡图则反映每个通路的富集显著性（-logP值）、命中比例（Hit Ratio）和代谢物数量（Count）。图中如“Glycerophospholipid metabolism”等通路不仅命中代谢物多，且富集显著，提示其在本次代谢变化中可能具有关键生物学意义。</span></p><p data-tool="mdnice编辑器"><span leaf="">此图的绘制主要点在于如何将桑基图与气泡图拼接整齐，此次通过另一种思路来进行代码编写使得对齐度更高。通过获取桑基图右侧的文本位置y轴信息将其赋予给气泡图的Y轴，从而实现文本与气泡对齐，此后在通过y轴的微调来达到完全对齐。</span></p><p data-tool="mdnice编辑器"><span leaf="">此图若不看左侧桑基图就是一个基础款的富集分析气泡图</span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247531409&amp;idx=1&amp;sn=608e6f4be98f657f01f0d0a4b1f43d14&amp;scene=21#wechat_redirect" textvalue="NC图表复现-融合桑基图与气泡图的代谢通路富集分析图" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">NC图表复现-融合桑基图与气泡图的代谢通路富集分析图</span></a></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MLXQpzaHNLTmaARwP4Z8KlZWRozqGibKuogq8w0Lgz3nF8UAcSvw3Gmg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6888888888888889" data-type="png" data-w="1080" data-imgfileid="100054573" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MLXQpzaHNLTmaARwP4Z8KlZWRozqGibKuogq8w0Lgz3nF8UAcSvw3Gmg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例2 富集分析图优雅展示基因</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">此图作为基础图看起来很直观，其主要是在原图基础上展示出基因ID信息等，需要注意的是数据的转换、注释条带的添加及颜色的映射等一些细节问题，代码部分细节颇多，认真运行一番定有收获。</span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247517336&amp;idx=1&amp;sn=e5f1d4fe2f655ca0807f0ef0d1bd7f09&amp;scene=21#wechat_redirect" textvalue="ggplot绘制富集分析图优雅展示基因" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">ggplot绘制富集分析图优雅展示基因</span></a></span></p><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MqcrEicx7OkIyiaxpy6iaHib27xC1U0IkDty7tdEzYR14CdRqoY7eCMDltw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8101851851851852" data-type="png" data-w="1080" data-imgfileid="100054571" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MqcrEicx7OkIyiaxpy6iaHib27xC1U0IkDty7tdEzYR14CdRqoY7eCMDltw/640?wx_fmt=png&amp;from=appmsg"></span></p><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例3 功能富集分析Circos图</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">使用GOplot包来对富集分析的结果进行可视化</span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247533624&amp;idx=1&amp;sn=6e4e209fbcf2768aeab3d8b4fecbd75f&amp;scene=21#wechat_redirect" textvalue="功能富集分析Circos 图:基于 GOplot的深度定制方案" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">功能富集分析Circos 图:基于 GOplot的深度定制方案</span></a></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MHgPlMqPPjwA1Hia2Kiby5ultkmMajnpGudrUkNlqRrAElBMbHtj89Kvg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7861111111111111" data-type="png" data-w="1080" data-imgfileid="100054572" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MHgPlMqPPjwA1Hia2Kiby5ultkmMajnpGudrUkNlqRrAElBMbHtj89Kvg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例4 ClusterGVis展示富集分析结果</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247534186&amp;idx=1&amp;sn=ce99799d1ad70d0f62aa44e0ee7b21c4&amp;scene=21#wechat_redirect" textvalue="论文分享|富集结果动态解析：ClusterGVis绘制时间序列聚类热图" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">论文分享|富集结果动态解析：ClusterGVis绘制时间序列聚类热图</span></a></span></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MDBqW1pRkh4DKR63IiaApmaBgChqBn4ibpczWc49qREL3ib87yJpO2PxvA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5740740740740741" data-type="png" data-w="1080" data-imgfileid="100054570" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2MDBqW1pRkh4DKR63IiaApmaBgChqBn4ibpczWc49qREL3ib87yJpO2PxvA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例5 维恩图与棒棒糖图展示差异基因富集</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247531257&amp;idx=1&amp;sn=ab2722dfbd6fa5ab85f2767998d58f1c&amp;scene=21#wechat_redirect" textvalue="nature图表复现-维恩图与棒棒糖图展示差异基因富集" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">nature图表复现-维恩图与棒棒糖图展示差异基因富集</span></a></span></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2Mhsiaprf0LfYhKAvjaKOwy2ZFdRzS5KFpBv9fSmqvnJNeGZdJnSkQKhw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7935185185185185" data-type="png" data-w="1080" data-imgfileid="100054579" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2Mhsiaprf0LfYhKAvjaKOwy2ZFdRzS5KFpBv9fSmqvnJNeGZdJnSkQKhw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">案例6 基因重叠度驱动的通路相似性网络图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span data-pm-slice="0 0 []"><span leaf="">该通路富集网络图展示了在 ABPC 来源外泌体相较 F-BMSC 外泌体 中上调的基因所显著富集的 8 条生物学过程，包括 RNA 稳定性调控（25 基因）、氧水平应答（34 基因）、氧化应激相关细胞死亡调控（15 基因）、有丝分裂 G2/M 期转换（19 基因）、轴突发生正调控（15 基因）、端粒维持调控（12 基因）、DNA 结合正调控（9 基因） 和 炎症反应调控（28 基因）。节点大小对应富集基因数，颜色表示显著性水平，连线粗细反映通路间基因重叠度，整体提示这些外泌体在 应激反应、炎症免疫及细胞周期相关过程 中具有重要作用。</span></span></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span data-pm-slice="0 0 []"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg3MzQzNTYzMw==&amp;mid=2247535746&amp;idx=1&amp;sn=1394e84c6007bd9c4d85349a5f56a27f&amp;scene=21#wechat_redirect" textvalue="GO富集结果还能这样玩：基因重叠度驱动的通路相似性网络图" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">GO富集结果还能这样玩：基因重叠度驱动的通路相似性网络图</span></a></span></span></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100054578" data-ratio="0.8981481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2M3PQsqdDgA3SKgtFSHoYYF6ulXJS2nulj2Ogo7u6PmgYayMnrmtiagMQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZIReT0JrDkhHQVpcY2lg2M3PQsqdDgA3SKgtFSHoYYF6ulXJS2nulj2Ogo7u6PmgYayMnrmtiagMQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">关注下方公众号下回更新不迷路</span></span><span></span></h3><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-id="Mzg3MzQzNTYzMw==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/sS00eyP4-5GDGDTxFdPD8w",target="_blank" rel="noopener noreferrer">原文链接</a>
