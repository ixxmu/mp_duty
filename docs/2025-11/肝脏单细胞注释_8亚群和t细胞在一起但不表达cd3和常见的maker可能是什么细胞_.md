---
title: "肝脏单细胞注释：8亚群和t细胞在一起但不表达cd3和常见的maker可能是什么细胞？"
date: 2025-11-05T13:37:31Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
肝脏单细胞注释：8亚群和t细胞在一起但不表达cd3和常见的maker可能是什么细胞？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">曾老板在小红书上看到一个有意思的帖子发给了我，里面提到了一个单细胞数据的分析结果：</span><strong><span leaf="">「肝脏的单细胞分群注释的时候发现其中一个亚群8和t细胞在一起但不表达cd3和常见的maker，博主进行了求助问可能是什么类型的细胞！」</span></strong><span leaf="">这种问题的探索感觉是最有意思的了，下面就找个肝脏的数据来看看。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">小红书上的那位博主的数据结果图：确实看起来很诡异，右下角是一个评论区让其绘制的几个基因的umap特征图，基因为 "PRKCH","DPYD","KLF12","MAML2","ARHGAP15"，但是这几个基因我查了一下没有什么特别的地方，看着就像是从博主提供的差异表格中摘取来的。</span></p><p data-tool="mdnice编辑器"><span leaf="">note：原贴大家可以使用这篇微信文章的标题去小红书搜就能搜到了。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H59lsDsM8u1CicHfgEYPyiam0FHXrs2WZTKlen6XoVNhg01ZAdnaoptuDA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5861111111111111" data-type="jpeg" data-w="1080" data-imgfileid="100062497" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H59lsDsM8u1CicHfgEYPyiam0FHXrs2WZTKlen6XoVNhg01ZAdnaoptuDA/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">找一个肝癌单细胞数据</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">探索上面的问题得有米啊，我这就自己去找了一个数据，搜到了一篇肝癌数据库类似的文献，2025年发表在Journal of Genetics and Genomics的文献《uniLIVER: a human liver cell atlas for data-driven cellular state mapping》，作者收集了来自5个公开数据集和一个内部数据集的79个正常人类肝脏样本，以及来自12个数据集的439个异常或疾病样本。<span textstyle="">构建了一个综合的、数据驱动的人类肝脏细胞图谱uniLIVER。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">可以下载整合好的数据：http://lifeome.net/database/uniliver</span></p><p data-tool="mdnice编辑器"><span leaf="">左边可以下载每个文献单独的h5ad文件，右边可以下载整合好的数据h5ad文件。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5icmKUu2ianMVMRbIKvPOre4hUsH4nNepyUMhAbojCTibHZQWg7EBibM7RQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6064814814814815" data-type="png" data-w="1080" data-imgfileid="100062496" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5icmKUu2ianMVMRbIKvPOre4hUsH4nNepyUMhAbojCTibHZQWg7EBibM7RQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">我这里选择了其中的数据：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE189903</span></p><p data-tool="mdnice编辑器"><span leaf="">数据包含：seven liver cancer patients (four hepatocellular carcinoma, HCC and three intrahepatic cholangiocarcinoma, iCCA)</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">GSE189903_Info.txt.gz 558.5 Kb (ftp)(http) TXT         </span><span><span leaf=""># 数据注释信息</span></span><span leaf=""><br></span><span leaf="">GSE189903_RAW.tar 935.9 Mb (http)(custom) TAR (of H5) </span><span><span leaf=""># H5文件，含有背景barcode</span></span><span leaf=""><br></span><span leaf="">GSE189903_barcodes.tsv.gz 461.0 Kb (ftp)(http) TSV     </span><span><span leaf=""># 三个标准文件</span></span><span leaf=""><br></span><span leaf="">GSE189903_genes.tsv.gz 194.7 Kb (ftp)(http) TSV</span><span leaf=""><br></span><span leaf="">GSE189903_matrix.mtx.gz 372.8 Mb (ftp)(http)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">采样如下：</span></p><p data-tool="mdnice编辑器"><span leaf="">a：不同区域组织取样示意图</span></p><p data-tool="mdnice编辑器"><span leaf="">b：不同样本颜色的恶性细胞tnse图，c图不同取样区域上色</span></p><p data-tool="mdnice编辑器"><span leaf="">d：不同样本的层次聚类图：同一个病人的样本会聚在一起</span></p><p data-tool="mdnice编辑器"><span leaf="">e：代表性MRI影像图</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H560yVXpYMsanhYuSGAjrhvHXj2PiaWvSKz2fLyiaN2M5ibquBYSCpibJFgg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.9231481481481482" data-type="jpeg" data-w="1080" data-imgfileid="100062498" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H560yVXpYMsanhYuSGAjrhvHXj2PiaWvSKz2fLyiaN2M5ibquBYSCpibJFgg/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">分析看看</span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">首先将数据去读进来：</span></span><span></span></h3><pre data-tool="mdnice编辑器"><code><span><span leaf="">###</span></span><span leaf=""><br></span><span><span leaf="">### Create: Jianming Zeng</span></span><span leaf=""><br></span><span><span leaf="">### Update Log: 2024-12-09   by juan zhang (492482942@qq.com)</span></span><span leaf=""><br></span><span><span leaf="">### </span></span><span leaf=""><br></span><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">options(stringsAsFactors = F)</span><span leaf=""><br></span><span leaf="">library(ggsci)</span><span leaf=""><br></span><span leaf="">library(dplyr) </span><span leaf=""><br></span><span leaf="">library(future)</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(clustree)</span><span leaf=""><br></span><span leaf="">library(cowplot)</span><span leaf=""><br></span><span leaf="">library(data.table)</span><span leaf=""><br></span><span leaf="">library(ggplot2)</span><span leaf=""><br></span><span leaf="">library(patchwork)</span><span leaf=""><br></span><span leaf="">library(stringr)</span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">library(Matrix)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 创建目录</span></span><span leaf=""><br></span><span leaf="">getwd()</span><span leaf=""><br></span><span leaf="">gse &lt;- </span><span><span leaf="">"GSE189903"</span></span><span leaf=""><br></span><span leaf="">dir.create(gse)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 方式一：标准文件夹</span></span><span leaf=""><br></span><span><span leaf="">###### step1: 导入数据 ######   </span></span><span leaf=""><br></span><span leaf="">counts &lt;- Read10X(</span><span><span leaf="">"GSE189903/GSE189903/"</span></span><span leaf="">, gene.column = 2)</span><span leaf=""><br></span><span leaf="">dim(counts)</span><span leaf=""><br></span><span leaf="">counts[1:5,1:5]</span><span leaf=""><br></span><span leaf="">meta &lt;- read.table(</span><span><span leaf="">"GSE189903/GSE189903_Info.txt.gz"</span></span><span leaf="">,header = T,sep = </span><span><span leaf="">"\t"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(meta)</span><span leaf=""><br></span><span leaf="">rownames(meta) &lt;- meta</span><span><span leaf="">$Cell</span></span><span leaf=""><br></span><span leaf="">identical(rownames(meta),colnames(counts))</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce.all &lt;- CreateSeuratObject(counts, min.cells = 3, meta.data = meta)</span><span leaf=""><br></span><span leaf="">sce.all</span><span leaf=""><br></span><span leaf="">head(sce.all@meta.data)</span><span leaf=""><br></span><span leaf="">table(sce.all</span><span><span leaf="">$Type</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">qsave(sce.all, file=</span><span><span leaf="">"GSE189903/sce.all.qs"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">数据带有做好的注释，但是这里的注释还有点奇怪，</span><strong><span leaf="">「有一堆数据注释成了：unclassified，是不是上面的同样的那群啊！」</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5CregyqjU8L1sZiaMZiaPdj1ANzyH8cUfz4OiacSDybl3sekL8h4jadphQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.09074074074074075" data-type="png" data-w="1080" data-imgfileid="100062494" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5CregyqjU8L1sZiaMZiaPdj1ANzyH8cUfz4OiacSDybl3sekL8h4jadphQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">预处理并降维聚类分群注释</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">简单QC一下并降为聚类分群，这里我没有进行harmony，因为作者的数据单纯merge在一起的分群结果就挺好：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">library(harmony)</span><span leaf=""><br></span><span leaf="">library(qs)</span><span leaf=""><br></span><span leaf="">library(Seurat)</span><span leaf=""><br></span><span leaf="">library(clustree)</span><span leaf=""><br></span><span><span leaf="">###### step3: harmony整合多个单细胞样品 ######</span></span><span leaf=""><br></span><span leaf="">dir.create(</span><span><span leaf="">"2-harmony"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">getwd()</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 读取数据</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- qread(</span><span><span leaf="">"1-QC/sce.all.filt.qs"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span></span><span leaf=""><br></span><span leaf="">sce.all.filt</span><span leaf=""><br></span><span><span leaf="">print</span></span><span leaf="">(dim(sce.all.filt))</span><span leaf=""><br></span><span leaf="">head(sce.all.filt@meta.data)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 走标准流程</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- NormalizeData(sce.all.filt, normalization.method = </span><span><span leaf="">"LogNormalize"</span></span><span leaf="">,scale.factor = 1e4) </span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindVariableFeatures(sce.all.filt, nfeatures = 2000)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- ScaleData(sce.all.filt)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- RunPCA(sce.all.filt, features = VariableFeatures(object = sce.all.filt))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 降维聚类，UMAP降维</span></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindNeighbors(sce.all.filt, dims = 1:20)</span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- FindClusters(sce.all.filt, resolution = 0.5)</span><span leaf=""><br></span><span leaf="">head(Idents(sce.all.filt), 5)</span><span leaf=""><br></span><span leaf="">str(sce.all.filt@meta.data)</span><span leaf=""><br></span><span leaf="">head(sce.all.filt</span><span><span leaf="">$RNA_snn_res</span></span><span leaf="">.0.5)</span><span leaf=""><br></span><span leaf="">head(sce.all.filt</span><span><span leaf="">$seurat_clusters</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sce.all.filt &lt;- RunUMAP(sce.all.filt,  dims = 1:20, reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">p &lt;- DimPlot(sce.all.filt, reduction = </span><span><span leaf="">"umap"</span></span><span leaf="">,label=T,group.by = </span><span><span leaf="">"Sample"</span></span><span leaf="">) </span><span leaf=""><br></span><span leaf="">p</span><span leaf=""><br></span><span leaf="">ggsave(filename=</span><span><span leaf="">'2-harmony/umap-by-orig.ident-before-harmony.png'</span></span><span leaf="">,plot = p, width = 6,height = 5.5)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H58upprGAH2uhVqQltxadJwZhoWtGsWibU04rHkrpibInzapDMq0gS4wWw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9895536562203229" data-type="png" data-w="1053" data-imgfileid="100062495" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H58upprGAH2uhVqQltxadJwZhoWtGsWibU04rHkrpibInzapDMq0gS4wWw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">不同样本上色umap图：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5ENDy3HRKJSshibLYyYh2K6Cmgh0B8vsicyjeksJ7VzuxaMauLibFNQuVw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9027777777777778" data-type="png" data-w="1080" data-imgfileid="100062501" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5ENDy3HRKJSshibLYyYh2K6Cmgh0B8vsicyjeksJ7VzuxaMauLibFNQuVw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">看看各种marker情况：</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5iaHiaDGr9BGiavV4M4jyFXAatFtMfUQL873xoCC1Zs69qn0FZrAIt43rQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5638888888888889" data-type="png" data-w="1080" data-imgfileid="100062500" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5iaHiaDGr9BGiavV4M4jyFXAatFtMfUQL873xoCC1Zs69qn0FZrAIt43rQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span leaf="">特征基因图：</span><span></span></h4><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100062499" data-ratio="0.9944444444444445" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5iaHErEupWEMFdXyNpM5LnCPhe7iahzN0WJRPjTRic5DOJ7libETg7jzwdA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wznIKQbBavr9cuW3G9ar5H5iaHErEupWEMFdXyNpM5LnCPhe7iahzN0WJRPjTRic5DOJ7libETg7jzwdA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span leaf="">上面的情况看来就是13群可能有点不明确，但是离T细胞那一大坨远得很，第7群有一些不表达t的marker，但是人家处于很明显的细胞周期中！我这里并没有作者提到的那个8亚群的特征哇！！！哭死！</span><span></span></h5><h5 data-tool="mdnice编辑器"><span></span><span leaf="">在线蹲一个具有标题特征的数据：求发微信 Biotree123！</span><span></span></h5></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">友情转发：</span></span></p></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247545889&amp;idx=1&amp;sn=b7b37a458eead4645137126753d58c34&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课10月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课10月班</span></a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/nXjcwKFRyGWj7tCBJkCX5Q",target="_blank" rel="noopener noreferrer">原文链接</a>
