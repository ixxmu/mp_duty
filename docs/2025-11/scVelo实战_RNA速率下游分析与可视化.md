---
title: "scVelo实战：RNA速率下游分析与可视化"
date: 2025-11-23T23:22:12Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
scVelo实战：RNA速率下游分析与可视化 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">velocyto运行结果</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">昨天使用</span><code><span leaf="">velocyto</span></code><span leaf="">将cellranger流程跑完得到的bam文件，转换为了loom文件</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">具体的流程可以参考一下<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247496852&amp;idx=1&amp;sn=032b8bbf12e2efed349677142fd02483&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">RNA速率分析初探</a>，分析时间的话，因为是挂载在服务器跑的，大概跑了一个半小时，数据使用的是pbmc1k的数据，比较小。</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013207" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmuxlqbibVN0kSVqotkkkZOsbibw5Z42AcRnkTAEBpHYuTfrCRwyZaaFUg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmuxlqbibVN0kSVqotkkkZOsbibw5Z42AcRnkTAEBpHYuTfrCRwyZaaFUg/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013209" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmapnbb3BuTibNRrjdqvV4LcIrIZY0WMD5m8iaX6O108Rt8ia9VzficY1Siag/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmapnbb3BuTibNRrjdqvV4LcIrIZY0WMD5m8iaX6O108Rt8ia9VzficY1Siag/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">结果会在</span><code><span leaf="">run_pbmc_1k_v3_fastqs/velocyto</span></code><span leaf="">的文件夹里面，保存了</span><code><span leaf="">run_pbmc_1k_v3_fastqs.loom</span></code><span leaf="">文件</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013205" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmUwsXorB6q3GqITACq683K84DkQKPcKwQ0R9eRQdiacMiaRZoqP4TFRicQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmUwsXorB6q3GqITACq683K84DkQKPcKwQ0R9eRQdiacMiaRZoqP4TFRicQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">基于</span><code><span leaf="">run_pbmc_1k_v3_fastqs.loom</span></code><span leaf="">文件可以进行后续的分析以及可视化，但是直接用跑完上游分析的原始数据得到的结果，所以在进行速率分析的时候，需要进行降维聚类分群。</span></strong></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">scVelo简介</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">使用浏览器检索RNA速率分析的时候，除了文献还有个</span><code><span leaf="">scVelo</span></code><span leaf="">分析流程跳了出来，本着雨露均沾的原则，那下游分析和可视化就试试</span><code><span leaf="">scVelo</span></code><span leaf="">叭！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013208" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmIQCone6xn1NE80LWkKScyzA1C22DloLMx2Nhyjbc4fHiaTO3tWkA4XQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmIQCone6xn1NE80LWkKScyzA1C22DloLMx2Nhyjbc4fHiaTO3tWkA4XQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><blockquote><span></span><p><strong><span leaf="">scVelo</span></strong><span leaf=""> 是一个用于单细胞RNA测序的Python软件包，核心功能是</span><strong><span leaf="">计算RNA velocity</span></strong><span leaf="">——通过量化mRNA剪接动力学来预测细胞状态转变的方向和速率，从而重建发育轨迹和细胞命运决定过程。</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013206" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmG78EviazsMznGth0YvErBoZX09GZVJCytxNxoHH2XFP8qMcdRrnkibPQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmG78EviazsMznGth0YvErBoZX09GZVJCytxNxoHH2XFP8qMcdRrnkibPQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">基于转录本剪接的时间差异：新生成的mRNA包含内含子（</span><strong><span leaf="">未剪接</span></strong><span leaf="">），经剪接后成为成熟mRNA（</span><strong><span leaf="">剪接</span></strong><span leaf="">）。</span></p><p data-tool="mdnice编辑器"><span leaf="">通过比较两者比例偏离理论稳态的程度，估算每个基因的"速度"（表达量即将上升或下降），整合所有基因的速度向量即可预测单细胞的未来状态。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">三种计算模型（由简到精）</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013214" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmnB7NYp3ltZicodfbT11OHkrcASY0GbHs9pdM4D5apETLQicZmfXAjlJA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmnB7NYp3ltZicodfbT11OHkrcASY0GbHs9pdM4D5apETLQicZmfXAjlJA/640?wx_fmt=png&amp;from=appmsg"></span></figure><section data-tool="mdnice编辑器"><table><thead><tr><th><section><span leaf="">模型</span></section></th><th><section><span leaf="">原理</span></section></th><th><section><span leaf="">优点</span></section></th><th><section><span leaf="">局限</span></section></th><th><section><span leaf="">适用场景</span></section></th></tr></thead><tbody><tr><td><strong><span leaf="">稳态模型</span></strong><br><section><span leaf="">(Steady-state)</span></section></td><td><section><span leaf="">假设转录诱导/抑制足够长以达到稳态，用线性回归估算稳态比率</span></section></td><td><section><span leaf="">计算最快（分钟级）</span></section></td><td><section><span leaf="">假设所有基因剪接速率相同，常被违反，异质群体中误差大</span></section></td><td><section><span leaf="">快速初步分析，简单系统</span></section></td></tr><tr><td><strong><span leaf="">随机模型</span></strong><br><section><span leaf="">(Stochastic)</span></section></td><td><section><span leaf="">将转录、剪接、降解视为概率事件，用二阶矩（协方差）捕捉稳态信息</span></section></td><td><section><span leaf="">平衡效率与精度，比稳态模型一致性更高</span></section></td><td><section><span leaf="">近似动态模型，仍可能遗漏复杂动态</span></section></td><td><section><span leaf="">30k细胞规模，需更高精度</span></section></td></tr><tr><td><strong><span leaf="">动态模型</span></strong><br><section><span leaf="">(Dynamical)</span></section></td><td><strong><span leaf="">求解完整转录动力学</span></strong><section><span leaf="">，用似然框架推断每个基因的全参数化速率模型</span></section></td><td><strong><span leaf="">最强大、最精确</span></strong><section><span leaf="">，能识别驱动基因，推断共享的"细胞内部潜在时间"</span></section></td><td><section><span leaf="">计算成本高（3万细胞需约1小时）</span></section></td><td><section><span leaf="">发表级分析，复杂分化过程</span></section></td></tr></tbody></table></section><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">scVelo-RNA速率下游分析与可视化</span></span><span></span></h2><p data-tool="mdnice编辑器"><strong><span leaf="">主要的分析教程：</span></strong></p><blockquote><span></span><p><span leaf="">Getting Started——https://scvelo.readthedocs.io/en/stable/getting_started.html</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013211" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmKoK3d8yPbHB2KU828kDtShLcPuCmu9g5SysQQDoqJcFN4tPrfsde5w/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmKoK3d8yPbHB2KU828kDtShLcPuCmu9g5SysQQDoqJcFN4tPrfsde5w/640?wx_fmt=png&amp;from=appmsg"></span></figure><blockquote><span></span><p><span leaf="">RNA Velocity Basics——https://scvelo.readthedocs.io/en/stable/VelocityBasics.html</span></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013212" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm8hT1uUlarcjQHoTKjKibibGKOiaRySfedlkIsAht2KdJEDx9AiaNkxhicbg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm8hT1uUlarcjQHoTKjKibibGKOiaRySfedlkIsAht2KdJEDx9AiaNkxhicbg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">安装与导入需要的Python包</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 环境配置</span></span><br><span leaf="">conda activate sc</span><br><br><span leaf="">pip install scanpy -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><br><span leaf="">pip install scvelo -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><br><span><span leaf=""><a topic-id="mibla7kj-28656r" data-topic="1">#运行过程中缺少包补啥包</a></span></span><br><br><span leaf="">pip install igraph -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><br><span leaf="">pip install leidenalg -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013213" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmSop91fyTvEufMqAJUR0nY5FD7ic2RPHpG0aicdYhFxwL3UMibKH7Nsf9A/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmSop91fyTvEufMqAJUR0nY5FD7ic2RPHpG0aicdYhFxwL3UMibKH7Nsf9A/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""><a topic-id="mibla7kj-zs589u" data-topic="1">#导入需要的包</a></span></span><br><span leaf="">import scvelo as scv</span><br><span leaf="">import scanpy as sc</span><br><span leaf="">import numpy as np</span><br><br><span><span leaf=""># 设置图像可视化效果</span></span><br><span leaf="">scv.set_figure_params(figsize=(6, 6), </span><br><span leaf="">                      color_map=</span><span><span leaf="">'viridis'</span></span><span leaf="">, </span><br><span leaf="">                      frameon=False, </span><br><span leaf="">                      fontsize=12)</span><br></code></pre><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">加载loom文件</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">adata = sc.read(</span><span><span leaf="">'./run_pbmc_1k_v3_fastqs/velocyto/run_pbmc_1k_v3_fastqs.loom'</span></span><span leaf="">, cache=True)</span><br><br><span><span leaf=""># 检查数据结构</span></span><br><span><span leaf="">print</span></span><span leaf="">(adata)  </span><span><span leaf=""># 应显示 layers: 'spliced', 'unspliced'</span></span><br><br><span leaf="">scv.pl.proportions(adata,  </span><span><span leaf=""># 自动保存</span></span><br><span leaf="">                   figsize=(6, 4))</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013210" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmj4LmPJKCOicKicC9VnNAeOyaGvPRJwHTmwpTp71RX0pNyK6BWVkXB4UA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmj4LmPJKCOicKicC9VnNAeOyaGvPRJwHTmwpTp71RX0pNyK6BWVkXB4UA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">预处理：过滤与标准化</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 2. 【核心】先运行scVelo预处理（它会统一处理X和layers）</span></span><br><span leaf="">scv.pp.filter_and_normalize(</span><br><span leaf="">    adata,</span><br><span leaf="">    min_shared_counts=20,</span><br><span leaf="">    n_top_genes=2000,</span><br><span leaf="">    min_counts=20,</span><br><span leaf="">    </span><span><span leaf="">log</span></span><span leaf="">=True  </span><span><span leaf=""># 统一对X、spliced、unspliced做log1p转换</span></span><br><span leaf="">)</span><br><br><span><span leaf=""># 3. 计算速度估计所需的矩</span></span><br><span leaf="">scv.pp.moments(adata, n_neighbors=30, n_pcs=30)</span><br><br><span><span leaf=""># 4. 现在可以运行标准Scanpy流程（但跳过归一化和log转换！）</span></span><br><span leaf="">sc.pp.pca(adata)</span><br><span leaf="">sc.pp.neighbors(adata,n_pcs=15)</span><br><span leaf="">sc.tl.leiden(adata,flavor=</span><span><span leaf="">"igraph"</span></span><span leaf="">,n_iterations=2,resolution=0.5)</span><br><span leaf="">sc.tl.umap(adata)</span><br><br><span><span leaf=""># 5. 可视化聚类（自动分配颜色）</span></span><br><span leaf="">sc.pl.umap(adata, color=</span><span><span leaf="">'leiden'</span></span><span leaf="">, legend_loc=</span><span><span leaf="">'on data'</span></span><span leaf="">, save=</span><span><span leaf="">'_clusters.png'</span></span><span leaf="">)</span><br><br><span><span leaf=""># 6. 重新检查比例</span></span><br><span leaf="">scv.pl.proportions(adata, save=</span><span><span leaf="">'proportions_filtered.pdf'</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013216" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmrMJGEujBRicB5Okgcnoic6uGfk4fhlyozV3jXIQJo7ZNhLxPKI9l5pibQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmrMJGEujBRicB5Okgcnoic6uGfk4fhlyozV3jXIQJo7ZNhLxPKI9l5pibQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">因为是测试看看能不能跑通流程，所以并没有给细胞呀群进行注释。</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 绘制剪接vs未剪接的分数分布（重要质控）</span></span><br><span leaf="">scv.pl.proportions(adata, </span><br><span leaf="">                   save=</span><span><span leaf="">"proportions.pdf"</span></span><span leaf="">,  </span><span><span leaf=""># 自动保存</span></span><br><span leaf="">                   figsize=(6, 4))</span><br><span><span leaf=""># 正常范围：未剪接比例5-20%</span></span><br><span><span leaf=""># 异常：过低(&lt;2%)可能无动态信息，过高(&gt;30%)可能技术噪音</span></span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013215" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm6uNpUF3EVTbCyRqeYjZJBbakt6cTflNPgpJ9h3w4IIw9Jc1DUaYeDQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm6uNpUF3EVTbCyRqeYjZJBbakt6cTflNPgpJ9h3w4IIw9Jc1DUaYeDQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">速率估计</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">scv.tl.velocity(adata)</span><br><br><span><span leaf=""># 构建速率图</span></span><br><span leaf="">scv.tl.velocity_graph(adata)</span><br></code></pre><hr><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013218" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmd6jMGn1ZfYzCc1oS9ZS4XMwB9qDOmJb0NWCiczaJxQRQOGSibpY93S5A/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmd6jMGn1ZfYzCc1oS9ZS4XMwB9qDOmJb0NWCiczaJxQRQOGSibpY93S5A/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">流线型图（最常用）</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">scv.pl.velocity_embedding_stream(adata, </span><br><span leaf="">                                 basis='umap',  # 嵌入空间</span><br><span leaf="">                                 color= 'leiden',</span><br><span leaf="">                                 figsize=(7, 7),</span><br><span leaf="">                                 legend_loc='right',</span><br><span leaf="">                                 title="RNA Velocity Stream",</span><br><span leaf="">                                 save="velocity_stream.pdf",  # 自动保存</span><br><span leaf="">                                 dpi=300)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013219" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmgAgUwv1YrzUwJEl2YAicTV7kn0rXWez9K7kUOFYXatOfs66iam4ReJtg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmgAgUwv1YrzUwJEl2YAicTV7kn0rXWez9K7kUOFYXatOfs66iam4ReJtg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">网格箭头图（方向更明确）</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""><a topic-id="mibla7kk-dtllgz" data-topic="1">#网格箭头图</a></span></span><br><span leaf="">scv.pl.velocity_embedding_grid(adata, </span><br><span leaf="">                               basis=</span><span><span leaf="">'umap'</span></span><span leaf="">,</span><br><span leaf="">                               color=</span><span><span leaf="">'leiden'</span></span><span leaf="">,</span><br><span leaf="">                               arrow_length=3,   </span><span><span leaf=""># 箭头长度</span></span><br><span leaf="">                               arrow_size=2,     </span><span><span leaf=""># 箭头大小</span></span><br><span leaf="">                               density=0.8,      </span><span><span leaf=""># 网格密度</span></span><br><span leaf="">                               figsize=(7, 7),</span><br><span leaf="">                               save=</span><span><span leaf="">"velocity_grid.pdf"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013217" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm25jswsJSD6FjAW5Pqp7kRqyicW1UvEJwwIqrQPJVbe4Lm9YHmPAMfew/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm25jswsJSD6FjAW5Pqp7kRqyicW1UvEJwwIqrQPJVbe4Lm9YHmPAMfew/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">散点箭头图（展示单细胞级别）</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 散点箭头图</span></span><br><span leaf="">scv.pl.velocity_embedding(adata, </span><br><span leaf="">                          basis=</span><span><span leaf="">'umap'</span></span><span leaf="">,</span><br><span leaf="">                          color=</span><span><span leaf="">'leiden'</span></span><span leaf="">,</span><br><span leaf="">                          arrow_length=2,</span><br><span leaf="">                          arrow_size=1.5,</span><br><span leaf="">                          alpha=0.7,  </span><span><span leaf=""># 透明度</span></span><br><span leaf="">                          size=30,    </span><span><span leaf=""># 点大小</span></span><br><span leaf="">                          legend_loc=</span><span><span leaf="">'right'</span></span><span leaf="">,</span><br><span leaf="">                          save=</span><span><span leaf="">"velocity_embedding.pdf"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013223" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmGJ3M6brwaAzicedZCkV2ibvJF6GWKo0xJHQV0gkahzjkbOicVBV4ialdkg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmGJ3M6brwaAzicedZCkV2ibvJF6GWKo0xJHQV0gkahzjkbOicVBV4ialdkg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">正经结尾</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">教程后续还有很多内容，比如</span><code><span leaf="">Interprete the velocities</span></code><span leaf="">和</span><code><span leaf="">Identify important genes</span></code><span leaf="">以及</span><code><span leaf="">Velocities in cycling progenitors</span></code></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013224" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm5hULEOvwdLdkQI49z0Ofzca1u3csS5viauOS0w3x1ACNSnobTKcGlbg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzm5hULEOvwdLdkQI49z0Ofzca1u3csS5viauOS0w3x1ACNSnobTKcGlbg/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">不过准备先简单测试一下，等后续学习完Python课程中完整的流程之后，再来回头跑跑剩下的内容叭！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100013222" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmnicg1JB3vGvON0jRWZrVP3Oae3TrpJ9zlsAOghxoZOOsmGkEZP7hF1Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YKIy6EWe4f35xTibhM5ZDzmnicg1JB3vGvON0jRWZrVP3Oae3TrpJ9zlsAOghxoZOOsmGkEZP7hF1Q/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/wu-I7sktGV8Ie9hcPapZmg",target="_blank" rel="noopener noreferrer">原文链接</a>
