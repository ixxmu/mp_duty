---
title: "常见的机器学习和深度学习模型的实现方法分享~"
date: 2025-11-05T21:43:11Z
draft: ["false"]
tags: [
  "fetched",
  "作图丫"
]
categories: ["Acdemic"]
---
常见的机器学习和深度学习模型的实现方法分享~ by 作图丫
------
<div><p><span><strong><strong><span leaf="">最近有小伙伴反映收不到推送，因为公众号改了推送算法，现在需要加星标，多点赞、点在看，才能准时收到推送哦。</span></strong></strong></span></p><section label="Powered by 135editor.com" data-role="outer"><section data-id="undefined"><section><section data-style="background-color:rgb(248, 248, 248); color:rgb(115, 115, 115); font-size:14px; line-height:21px"><p><span leaf="">导语：</span><span data-pm-slice="0 0 []"><span leaf="">R语言在机器学习和深度学习领域有着丰富的生态系统。虽然Python在深度学习领域更流行，但R凭借其强大的统计基础、数据可视化和数据处理能力，在传统机器学习和部分深度学习任务中表现出色。</span></span><span leaf=""><br></span></p></section></section></section></section><section data-id="96283" data-tools="135编辑器"><section><section><section><span leaf=""><br></span></section><p><span><span><span leaf="">北京墨因生物已经与</span></span><span><span leaf="">国内50+知名医院的老师或</span></span><span><span leaf="">名牌大学实验室合作（协和、哈工大、同济、哈医大等）。</span><span><span leaf="">欢迎有生信分析需求的老师垂询，</span></span><span><span leaf="">公共</span></span><span><span leaf="">数据库数据挖掘或</span></span><span><span leaf="">自测数据分析均可。</span></span></span></span></p><section><span><span leaf="">欢迎长期合作</span></span></section><section><span><span leaf="">联系请扫描下方二维码</span></span></section><p><span leaf=""><img data-imgfileid="100032582" data-ratio="1.0092592592592593" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/DgSHw3V1iaJxs4NpB9icYspMJLdfLBIms8zdiaeytYtbZyjlMERIm7B8mLBVnQwqc9QBXUbyUmRUIicrVrpscf9Z8g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/DgSHw3V1iaJxs4NpB9icYspMJLdfLBIms8zdiaeytYtbZyjlMERIm7B8mLBVnQwqc9QBXUbyUmRUIicrVrpscf9Z8g/640?wx_fmt=jpeg&amp;from=appmsg"></span></p><section data-width="100%"><span leaf=""><br></span></section><p></p></section></section></section><section data-id="96283" data-tools="135编辑器"><section><section><section data-id="94674" data-tools="135编辑器"><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/DgSHw3V1iaJwuSD9luOs4P16C9qmHN4uh4MxTNkkIibVkTeRzeGt4miaDE7kbeHmoNj8IicOJglMY6FTfiaujH46uQA/640?wx_fmt=gif" data-ratio="0.22169811320754718" data-type="gif" data-w="636" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/DgSHw3V1iaJwuSD9luOs4P16C9qmHN4uh4MxTNkkIibVkTeRzeGt4miaDE7kbeHmoNj8IicOJglMY6FTfiaujH46uQA/640?wx_fmt=gif"></span></section></section><section><span leaf=""><img data-ratio="1.0625" data-src="https://mmbiz.qpic.cn/mmbiz_png/DgSHw3V1iaJxXClpLyMwEZQh6Z6ibDyjmaPv8j3WcGIuVdJkyW4cmiaf38RaNBeXHFBn3IibZXgFER38e5efRzkFdQ/640?wx_fmt=png" data-type="png" data-w="32" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/DgSHw3V1iaJxXClpLyMwEZQh6Z6ibDyjmaPv8j3WcGIuVdJkyW4cmiaf38RaNBeXHFBn3IibZXgFER38e5efRzkFdQ/640?wx_fmt=png"></span></section><section><section data-brushtype="text"><strong><span leaf="">结果解析</span></strong></section><section data-width="80%"><span leaf=""><br></span></section><section><span leaf=""><br></span></section></section><section><section><span leaf=""><br></span></section></section><section><section><span leaf=""><br></span></section></section></section></section></section><section><section><section><span><strong><span leaf="">01</span></strong></span></section><section data-brushtype="text"><span><span leaf="">常见机器学习模型</span></span></section></section></section><section><span><span leaf=""><br></span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>1</span>.数据准备</span></code><code><span leaf=""><span># 加载必要的包</span></span></code><code><span leaf=""><span>library</span>(tidymodels)</span></code><code><span leaf=""><span>library</span>(ggplot2)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 使用波士顿房价数据集（从modeldata包）</span></span></code><code><span leaf=""><span>data</span>(<span>"boston_housing"</span>, package = <span>"modeldata"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 查看数据结构</span></span></code><code><span leaf=""><span>glimpse</span>(boston_housing)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 划分训练集和测试集</span></span></code><code><span leaf=""><span>set</span>.seed(<span>123</span>)</span></code><code><span leaf=""><span>data_split</span> &lt;- initial_split(boston_housing, prop = <span>0</span>.<span>8</span>, strata = medv)</span></code><code><span leaf=""><span>train_data</span> &lt;- training(data_split)</span></code><code><span leaf=""><span>test_data</span> &lt;- testing(data_split)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建预处理配方</span></span></code><code><span leaf=""><span>recipe_spec</span> &lt;- recipe(medv ~ ., data = train_data) %&gt;%</span></code><code><span leaf="">  <span>step_normalize</span>(all_numeric_predictors()) %&gt;%</span></code><code><span leaf="">  <span>step_dummy</span>(all_nominal_predictors())</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf="">2.多种机器学习模型的实现</span></code><code><span leaf=""><span># 定义多个模型</span></span></code><code><span leaf="">models &lt;- list(</span></code><code><span leaf="">  <span># 线性回归</span></span></code><code><span leaf="">  linear_reg = linear_reg(engine = <span>"lm"</span>),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 随机森林</span></span></code><code><span leaf="">  random_forest = rand_forest(</span></code><code><span leaf="">    trees = 200,</span></code><code><span leaf="">    mode = <span>"regression"</span>,</span></code><code><span leaf="">    engine = <span>"ranger"</span></span></code><code><span leaf="">  ),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 梯度提升（XGBoost）</span></span></code><code><span leaf="">  xgboost = boost_tree(</span></code><code><span leaf="">    trees = 200,</span></code><code><span leaf="">    mode = <span>"regression"</span>, </span></code><code><span leaf="">    engine = <span>"xgboost"</span></span></code><code><span leaf="">  ),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 支持向量机</span></span></code><code><span leaf="">  svm = svm_rbf(</span></code><code><span leaf="">    mode = <span>"regression"</span>,</span></code><code><span leaf="">    engine = <span>"kernlab"</span></span></code><code><span leaf="">  ),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># K近邻</span></span></code><code><span leaf="">  knn = nearest_neighbor(</span></code><code><span leaf="">    mode = <span>"regression"</span>,</span></code><code><span leaf="">    engine = <span>"kknn"</span></span></code><code><span leaf="">  ),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 神经网络（单隐藏层）</span></span></code><code><span leaf="">  neural_net = mlp(</span></code><code><span leaf="">    hidden_units = 10,</span></code><code><span leaf="">    mode = <span>"regression"</span>,</span></code><code><span leaf="">    engine = <span>"nnet"</span></span></code><code><span leaf="">  )</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建工作流并训练所有模型</span></span></code><code><span leaf="">results &lt;- list()</span></code><code><span leaf=""><span>for</span> (model_name <span>in</span> names(models)) {</span></code><code><span leaf="">  <span>cat</span>(<span>"训练模型:"</span>, model_name, <span>"\n"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  wf &lt;- workflow() %&gt;%</span></code><code><span leaf="">    add_recipe(recipe_spec) %&gt;%</span></code><code><span leaf="">    add_model(models[[model_name]])</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 训练模型</span></span></code><code><span leaf="">  fit_model &lt;- wf %&gt;% fit(data = train_data)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 在测试集上预测</span></span></code><code><span leaf="">  predictions &lt;- predict(fit_model, new_data = test_data) %&gt;%</span></code><code><span leaf="">    bind_cols(test_data %&gt;% <span>select</span>(medv))</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 计算性能指标</span></span></code><code><span leaf="">  metrics &lt;- predictions %&gt;%</span></code><code><span leaf="">    metrics(truth = medv, estimate = .pred)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  results[[model_name]] &lt;- list(</span></code><code><span leaf="">    fit = fit_model,</span></code><code><span leaf="">    predictions = predictions,</span></code><code><span leaf="">    metrics = metrics</span></code><code><span leaf="">  )</span></code><code><span leaf="">}</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 比较所有模型性能</span></span></code><code><span leaf="">performance_comparison &lt;- map_dfr(names(results), <span>function</span>(model_name) {</span></code><code><span leaf="">  results[[model_name]]<span>$metrics</span> %&gt;%</span></code><code><span leaf="">    mutate(model = model_name)</span></code><code><span leaf="">})</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 显示模型比较结果</span></span></code><code><span leaf="">performance_comparison %&gt;%</span></code><code><span leaf="">  ggplot(aes(x = model, y = .estimate, fill = .metric)) +</span></code><code><span leaf="">  geom_col(position = <span>"dodge"</span>) +</span></code><code><span leaf="">  labs(title = <span>"机器学习模型性能比较"</span>, y = <span>"指标值"</span>, x = <span>"模型"</span>) +</span></code><code><span leaf="">  theme_minimal()</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf="">3. 超参数调优示例（以随机森林为例）</span></code><code><span leaf=""><span># 定义需要调优的随机森林模型</span></span></code><code><span leaf="">tune_spec &lt;- rand_forest(</span></code><code><span leaf="">  mtry = tune(),</span></code><code><span leaf="">  trees = tune(),</span></code><code><span leaf="">  min_n = tune(),</span></code><code><span leaf="">  mode = <span>"regression"</span></span></code><code><span leaf="">) %&gt;% set_engine(<span>"ranger"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建工作流</span></span></code><code><span leaf="">tune_wf &lt;- workflow() %&gt;%</span></code><code><span leaf="">  add_recipe(recipe_spec) %&gt;%</span></code><code><span leaf="">  add_model(tune_spec)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建交叉验证折</span></span></code><code><span leaf="">set.seed(123)</span></code><code><span leaf="">folds &lt;- vfold_cv(train_data, v = 5)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 定义调优网格</span></span></code><code><span leaf="">param_grid &lt;- grid_random(</span></code><code><span leaf="">  parameters(tune_spec),</span></code><code><span leaf="">  size = 20  <span># 尝试20种参数组合</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 执行调优</span></span></code><code><span leaf="">tune_results &lt;- tune_grid(</span></code><code><span leaf="">  tune_wf,</span></code><code><span leaf="">  resamples = folds,</span></code><code><span leaf="">  grid = param_grid,</span></code><code><span leaf="">  metrics = metric_set(rmse, rsq)</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 选择最佳参数</span></span></code><code><span leaf="">best_params &lt;- select_best(tune_results, <span>"rmse"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 用最佳参数训练最终模型</span></span></code><code><span leaf="">final_wf &lt;- finalize_workflow(tune_wf, best_params)</span></code><code><span leaf="">final_fit &lt;- final_wf %&gt;% fit(data = train_data)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 评估最终模型</span></span></code><code><span leaf="">final_predictions &lt;- predict(final_fit, test_data) %&gt;%</span></code><code><span leaf="">  bind_cols(test_data %&gt;% <span>select</span>(medv))</span></code><code><span leaf=""><br></span></code><code><span leaf="">final_metrics &lt;- final_predictions %&gt;%</span></code><code><span leaf="">  metrics(truth = medv, estimate = .pred)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>print</span>(final_metrics)</span></code></pre></section><section><span><span leaf=""><br></span></span></section><section><section><section><span><strong><span leaf="">02</span></strong></span></section><section data-brushtype="text"><span><span leaf="">深度学习模型实现</span></span></section></section></section><section><span leaf=""><br></span></section><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>1</span>.环境配置</span></code><code><span leaf=""><span># 安装和加载keras</span></span></code><code><span leaf=""><span>install</span>.packages(<span>"keras"</span>)</span></code><code><span leaf=""><span>library</span>(keras)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 安装TensorFlow后端（只需要运行一次）</span></span></code><code><span leaf=""><span>install_keras</span>()</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 加载其他必要包</span></span></code><code><span leaf=""><span>library</span>(tfdatasets)</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>2</span>.回归问题深度学习模型</span></code><code><span leaf=""><span># 准备数据</span></span></code><code><span leaf="">x_train &lt;- train_data %&gt;% <span>select</span>(-medv) %&gt;% <span>as</span>.<span>matrix</span>()</span></code><code><span leaf="">y_train &lt;- train_data %&gt;% <span>pull</span>(medv)</span></code><code><span leaf="">x_test &lt;- test_data %&gt;% <span>select</span>(-medv) %&gt;% <span>as</span>.<span>matrix</span>() </span></code><code><span leaf="">y_test &lt;- test_data %&gt;% <span>pull</span>(medv)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 数据标准化</span></span></code><code><span leaf="">x_train &lt;- <span>scale</span>(x_train)</span></code><code><span leaf="">x_test &lt;- <span>scale</span>(x_test)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 构建神经网络模型</span></span></code><code><span leaf="">build_model &lt;- <span><span>function</span></span><span>() </span>{</span></code><code><span leaf="">  model &lt;- <span>keras_model_sequential</span>() %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>64</span>, activation = <span>"relu"</span>, input_shape = <span>ncol</span>(x_train)) %&gt;%</span></code><code><span leaf="">    <span>layer_batch_normalization</span>() %&gt;%</span></code><code><span leaf="">    <span>layer_dropout</span>(rate = <span>0.3</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>32</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dropout</span>(rate = <span>0.2</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>16</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>1</span>)  <span># 输出层，回归问题不需要激活函数</span></span></code><code><span leaf=""><br></span></code><code><span leaf="">  model %&gt;% <span>compile</span>(</span></code><code><span leaf="">    optimizer = <span>optimizer_adam</span>(learning_rate = <span>0.001</span>),</span></code><code><span leaf="">    loss = <span>"mse"</span>,</span></code><code><span leaf="">    metrics = <span>c</span>(<span>"mae"</span>)</span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>return</span>(model)</span></code><code><span leaf="">}</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建模型</span></span></code><code><span leaf="">model &lt;- <span>build_model</span>()</span></code><code><span leaf=""><span>summary</span>(model)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 设置早停法</span></span></code><code><span leaf="">early_stop &lt;- <span>callback_early_stopping</span>(</span></code><code><span leaf="">  monitor = <span>"val_loss"</span>,</span></code><code><span leaf="">  patience = <span>20</span>,</span></code><code><span leaf="">  restore_best_weights = <span>TRUE</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 训练模型</span></span></code><code><span leaf="">history &lt;- model %&gt;% <span>fit</span>(</span></code><code><span leaf="">  x_train, y_train,</span></code><code><span leaf="">  epochs = <span>200</span>,</span></code><code><span leaf="">  batch_size = <span>32</span>,</span></code><code><span leaf="">  validation_split = <span>0.2</span>,</span></code><code><span leaf="">  callbacks = <span>list</span>(early_stop),</span></code><code><span leaf="">  verbose = <span>1</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 绘制训练历史</span></span></code><code><span leaf=""><span>plot</span>(history)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 评估模型</span></span></code><code><span leaf="">model %&gt;% <span>evaluate</span>(x_test, y_test)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 进行预测</span></span></code><code><span leaf="">dl_predictions &lt;- model %&gt;% <span>predict</span>(x_test)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 与真实值比较</span></span></code><code><span leaf="">results_comparison &lt;- data.<span>frame</span>(</span></code><code><span leaf="">  Actual = y_test,</span></code><code><span leaf="">  Predicted = <span>as</span>.<span>vector</span>(dl_predictions),</span></code><code><span leaf="">  Model = <span>"Deep Learning"</span></span></code><code><span leaf="">)</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>3</span>.分类问题深度学习模型</span></code><code><span leaf=""><span># 分类问题示例</span></span></code><code><span leaf=""><span>data</span>(iris)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 准备数据</span></span></code><code><span leaf="">set.<span>seed</span>(<span>123</span>)</span></code><code><span leaf="">iris_split &lt;- <span>initial_split</span>(iris, prop = <span>0.8</span>, strata = Species)</span></code><code><span leaf="">iris_train &lt;- <span>training</span>(iris_split)</span></code><code><span leaf="">iris_test &lt;- <span>testing</span>(iris_split)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 准备深度学习数据</span></span></code><code><span leaf="">x_train_iris &lt;- iris_train %&gt;% <span>select</span>(-Species) %&gt;% <span>as</span>.<span>matrix</span>()</span></code><code><span leaf="">y_train_iris &lt;- iris_train %&gt;% <span>pull</span>(Species) %&gt;% <span>as</span>.<span>numeric</span>() - <span>1</span>  <span># 转为0,1,2</span></span></code><code><span leaf="">x_test_iris &lt;- iris_test %&gt;% <span>select</span>(-Species) %&gt;% <span>as</span>.<span>matrix</span>()</span></code><code><span leaf="">y_test_iris &lt;- iris_test %&gt;% <span>pull</span>(Species) %&gt;% <span>as</span>.<span>numeric</span>() - <span>1</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 将标签转换为one-hot编码</span></span></code><code><span leaf="">y_train_categorical &lt;- <span>to_categorical</span>(y_train_iris, <span>3</span>)</span></code><code><span leaf="">y_test_categorical &lt;- <span>to_categorical</span>(y_test_iris, <span>3</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 构建分类模型</span></span></code><code><span leaf="">build_classification_model &lt;- <span><span>function</span></span><span>() </span>{</span></code><code><span leaf="">  model &lt;- <span>keras_model_sequential</span>() %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>32</span>, activation = <span>"relu"</span>, input_shape = <span>4</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dropout</span>(rate = <span>0.3</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>16</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dropout</span>(rate = <span>0.2</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(units = <span>3</span>, activation = <span>"softmax"</span>)  <span># 3个类别</span></span></code><code><span leaf=""><br></span></code><code><span leaf="">  model %&gt;% <span>compile</span>(</span></code><code><span leaf="">    optimizer = <span>optimizer_adam</span>(learning_rate = <span>0.001</span>),</span></code><code><span leaf="">    loss = <span>"categorical_crossentropy"</span>,</span></code><code><span leaf="">    metrics = <span>c</span>(<span>"accuracy"</span>)</span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>return</span>(model)</span></code><code><span leaf="">}</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 训练分类模型</span></span></code><code><span leaf="">class_model &lt;- <span>build_classification_model</span>()</span></code><code><span leaf=""><br></span></code><code><span leaf="">history_class &lt;- class_model %&gt;% <span>fit</span>(</span></code><code><span leaf="">  x_train_iris, y_train_categorical,</span></code><code><span leaf="">  epochs = <span>100</span>,</span></code><code><span leaf="">  batch_size = <span>16</span>,</span></code><code><span leaf="">  validation_split = <span>0.2</span>,</span></code><code><span leaf="">  callbacks = <span>list</span>(early_stop),</span></code><code><span leaf="">  verbose = <span>0</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 评估分类模型</span></span></code><code><span leaf="">class_model %&gt;% <span>evaluate</span>(x_test_iris, y_test_categorical)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 预测类别</span></span></code><code><span leaf="">class_predictions &lt;- class_model %&gt;% <span>predict</span>(x_test_iris) %&gt;% <span>k_argmax</span>() %&gt;% <span>as</span>.<span>numeric</span>()</span></code><code><span leaf="">predicted_species &lt;- <span>levels</span>(iris<span>$Species</span>)[class_predictions + <span>1</span>]</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 计算准确率</span></span></code><code><span leaf="">accuracy &lt;- <span>mean</span>(predicted_species == iris_test<span>$Species</span>)</span></code><code><span leaf=""><span>cat</span>(<span>"深度学习分类准确率:"</span>, <span>round</span>(accuracy, <span>3</span>))</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>4</span>.使用管道的深度学习模型</span></code><code><span leaf=""><span># 使用tfdatasets创建数据管道</span></span></code><code><span leaf="">create_dataset &lt;- <span><span>function</span></span><span>(</span><span><span>x, y, batch_size = </span></span><span><span><span>32</span></span></span><span><span>, shuffle = </span></span><span><span><span>TRUE</span></span></span><span>) </span>{</span></code><code><span leaf="">  dataset &lt;- <span>tensor_slices_dataset</span>(<span>list</span>(x, y))</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>if</span> (shuffle) {</span></code><code><span leaf="">    dataset &lt;- dataset %&gt;% <span>dataset_shuffle</span>(buffer_size = <span>nrow</span>(x))</span></code><code><span leaf="">  }</span></code><code><span leaf=""><br></span></code><code><span leaf="">  dataset %&gt;% </span></code><code><span leaf="">    <span>dataset_batch</span>(batch_size) %&gt;%</span></code><code><span leaf="">    <span>dataset_prefetch</span>(buffer_size = tf$data<span>$AUTOTUNE</span>)</span></code><code><span leaf="">}</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 创建训练和验证数据集</span></span></code><code><span leaf="">train_dataset &lt;- <span>create_dataset</span>(x_train, y_train)</span></code><code><span leaf="">val_dataset &lt;- <span>create_dataset</span>(x_test, y_test, shuffle = <span>FALSE</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 使用函数式API构建更复杂的模型</span></span></code><code><span leaf="">build_advanced_model &lt;- <span><span>function</span></span><span>(</span><span><span>input_shape</span></span><span>) </span>{</span></code><code><span leaf="">  inputs &lt;- <span>layer_input</span>(shape = input_shape)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 创建多个并行路径</span></span></code><code><span leaf="">  path1 &lt;- inputs %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(<span>64</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_batch_normalization</span>()</span></code><code><span leaf=""><br></span></code><code><span leaf="">  path2 &lt;- inputs %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(<span>32</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_batch_normalization</span>()</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 合并路径</span></span></code><code><span leaf="">  concatenated &lt;- <span>layer_concatenate</span>(<span>list</span>(path1, path2))</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 输出层</span></span></code><code><span leaf="">  outputs &lt;- concatenated %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(<span>32</span>, activation = <span>"relu"</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dropout</span>(<span>0.3</span>) %&gt;%</span></code><code><span leaf="">    <span>layer_dense</span>(<span>1</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  model &lt;- <span>keras_model</span>(inputs, outputs)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  model %&gt;% <span>compile</span>(</span></code><code><span leaf="">    optimizer = <span>optimizer_adam</span>(learning_rate = <span>0.001</span>),</span></code><code><span leaf="">    loss = <span>"mse"</span>,</span></code><code><span leaf="">    metrics = <span>c</span>(<span>"mae"</span>)</span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span>return</span>(model)</span></code><code><span leaf="">}</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 训练高级模型</span></span></code><code><span leaf="">advanced_model &lt;- <span>build_advanced_model</span>(<span>ncol</span>(x_train))</span></code><code><span leaf=""><br></span></code><code><span leaf="">history_advanced &lt;- advanced_model %&gt;% <span>fit</span>(</span></code><code><span leaf="">  train_dataset,</span></code><code><span leaf="">  epochs = <span>100</span>,</span></code><code><span leaf="">  validation_data = val_dataset,</span></code><code><span leaf="">  callbacks = <span>list</span>(early_stop),</span></code><code><span leaf="">  verbose = <span>1</span></span></code><code><span leaf="">)</span></code></pre></section><section><span leaf=""><br></span></section><section><section><section><span><strong><span leaf="">03</span></strong></span></section><section data-brushtype="text"><span><span leaf="">模型比较和选择</span></span></section></section></section><section><span leaf=""><br></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># 比较传统机器学习与深度学习</span></span></code><code><span leaf="">comparison_results &lt;- bind_rows(</span></code><code><span leaf="">  <span># 传统机器学习结果</span></span></code><code><span leaf="">  performance_comparison %&gt;%</span></code><code><span leaf="">    <span>filter</span>(.metric == <span>"rmse"</span>) %&gt;%</span></code><code><span leaf="">    <span>select</span>(model, rmse = .estimate) %&gt;%</span></code><code><span leaf="">    mutate(<span>type</span> = <span>"Machine Learning"</span>),</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 深度学习结果</span></span></code><code><span leaf="">  data.frame(</span></code><code><span leaf="">    model = <span>"Deep Learning"</span>,</span></code><code><span leaf="">    rmse = sqrt(model %&gt;% evaluate(x_test, y_test, verbose = <span>0</span>)[[<span>1</span>]]),</span></code><code><span leaf="">    <span>type</span> = <span>"Deep Learning"</span></span></code><code><span leaf="">  )</span></code><code><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 可视化比较</span></span></code><code><span leaf="">ggplot(comparison_results, aes(x = reorder(model, rmse), y = rmse, fill = <span>type</span>)) +</span></code><code><span leaf="">  geom_col() +</span></code><code><span leaf="">  coord_flip() +</span></code><code><span leaf="">  labs(title = <span>"模型性能比较 (RMSE越低越好)"</span>, </span></code><code><span leaf="">       x = <span>"模型"</span>, y = <span>"RMSE"</span>) +</span></code><code><span leaf="">  theme_minimal()</span></code></pre></section><section><span leaf=""><br></span></section><section data-id="96283" data-tools="135编辑器"><section><section><section data-id="94674" data-tools="135编辑器"><section><span leaf=""><img data-ratio="0.22169811320754718" data-src="https://mmbiz.qpic.cn/mmbiz_gif/DgSHw3V1iaJwuSD9luOs4P16C9qmHN4uh4MxTNkkIibVkTeRzeGt4miaDE7kbeHmoNj8IicOJglMY6FTfiaujH46uQA/640?wx_fmt=gif" data-type="gif" data-w="636" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/DgSHw3V1iaJwuSD9luOs4P16C9qmHN4uh4MxTNkkIibVkTeRzeGt4miaDE7kbeHmoNj8IicOJglMY6FTfiaujH46uQA/640?wx_fmt=gif"></span></section></section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/DgSHw3V1iaJxXClpLyMwEZQh6Z6ibDyjmaPv8j3WcGIuVdJkyW4cmiaf38RaNBeXHFBn3IibZXgFER38e5efRzkFdQ/640?wx_fmt=png" data-ratio="1.0625" data-type="png" data-w="32" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_png/DgSHw3V1iaJxXClpLyMwEZQh6Z6ibDyjmaPv8j3WcGIuVdJkyW4cmiaf38RaNBeXHFBn3IibZXgFER38e5efRzkFdQ/640?wx_fmt=png"></span></section><section><section data-brushtype="text"><strong><span leaf="">小编总结</span></strong></section><section data-width="80%"><span leaf=""><br></span></section><section><span leaf=""><br></span></section></section><section><section><span leaf=""><br></span></section></section><section><section><span leaf="">)</span></section></section></section></section></section><section><span><span data-pm-slice="0 0 []"><span leaf="">R语言在AI领域已经形成了</span></span><strong><span leaf="">独特的竞争优势</span></strong><span><span leaf="">：将统计学的严谨性与现代AI的灵活性完美结合。无论是传统的机器学习任务还是前沿的深度学习应用，R都提供了</span></span><strong><span leaf="">生产级的解决方案</span></strong><span><span leaf="">。特别适合那些需要深厚统计基础、强调可解释性、并追求完整数据分析生命周期的应用场景。</span></span></span></section><section><span leaf=""><br></span></section><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/HaaibyndPicBichBbjTmfn3t5GIesdrp5soTxpZIFsf18w8N7HAFF7XVt9l51HXaMeJqOwzE06GS9AQ4smDf8SicFA/640?wx_fmt=png" data-ratio="0.9166666666666666" data-type="png" data-w="24" data-fileid="100016082" src="https://mmbiz.qpic.cn/mmbiz_png/HaaibyndPicBichBbjTmfn3t5GIesdrp5soTxpZIFsf18w8N7HAFF7XVt9l51HXaMeJqOwzE06GS9AQ4smDf8SicFA/640?wx_fmt=png"></span></section><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/H1YldzEORib75cEkpXjN27FU2UH8V4qgKqjgPUePJ0IT5S4xn1UQMlf5ocHtRr0vcLHOV040fpQWPbuLicViawJCA/640?wx_fmt=png" data-ratio="0.9166666666666666" data-type="png" data-w="24" data-fileid="100016080" src="https://mmbiz.qpic.cn/mmbiz_png/H1YldzEORib75cEkpXjN27FU2UH8V4qgKqjgPUePJ0IT5S4xn1UQMlf5ocHtRr0vcLHOV040fpQWPbuLicViawJCA/640?wx_fmt=png"></span></section></section><section data-mid="" mpa-from-tpl="t"><section><span><p><span leaf=""><br></span></p><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/jvibaTuwDCBHkp4Ocd4ibfkBJqRgkiaxZ8bWqDzrhReRrRcczPEsAV9qwuhESMWxNrGaxvGiax4Jky0thTibbQNOF2A/640?wx_fmt=png" data-ratio="0.18518518518518517" data-type="png" data-w="108" data-fileid="100016076" src="https://mmbiz.qpic.cn/mmbiz_png/jvibaTuwDCBHkp4Ocd4ibfkBJqRgkiaxZ8bWqDzrhReRrRcczPEsAV9qwuhESMWxNrGaxvGiax4Jky0thTibbQNOF2A/640?wx_fmt=png"></span></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span leaf="">往期推荐</span></p></section><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/kjOBCbXenyDJl0zqzjZSohdOpooZGtE9t5kznNnwDxY8GftM54027Qm9wgg7V1xCAhlon8RSlxUpDZb4OTVTSQ/640?wx_fmt=png" data-ratio="0.18518518518518517" data-type="png" data-w="108" data-fileid="100016083" src="https://mmbiz.qpic.cn/mmbiz_png/kjOBCbXenyDJl0zqzjZSohdOpooZGtE9t5kznNnwDxY8GftM54027Qm9wgg7V1xCAhlon8RSlxUpDZb4OTVTSQ/640?wx_fmt=png"></span></section></section></section></section><p><span leaf=""><br></span></p><p><span><span leaf="">分析专辑</span></span></p><p><span leaf=""><br></span></p><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439296529227169792&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">单细胞scRNA</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1411481499404451840&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">R包绘图</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439276066627239937&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">免疫浸润分析</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439317668720656387&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">肿瘤纯度评估工具</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439303845016092674&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">数据库</a></span></span></p><p><span leaf=""><br></span></p><p><span><span leaf="">文章解读专辑</span></span></p><p><span leaf=""><br></span></p><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1320422885441306624&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">多区域进化文章精读</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439310805396471811&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">高分文章精读</a></span></span><span><span leaf=""> | </span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;album_id=1439284039948812289&amp;__biz=Mzg2NTE1MzU4NQ==#wechat_redirect" textvalue="" linktype="text" data-linktype="2">免疫微环境文献解读</a></span></span></p><p><span leaf=""><br></span></p><p><span><span leaf="">招聘信息</span></span></p><p><span leaf=""><br></span></p><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg2NTE1MzU4NQ==&amp;action=getalbum&amp;album_id=1905608451808903168#wechat_redirect" textvalue="" linktype="text" data-linktype="2">招聘</a></span></span></p><p><span leaf=""><br></span></p><p><span><span leaf="">点击</span></span><span><strong><span leaf="">红字</span></strong></span><span><span leaf="">即可进入专栏！</span></span></p></span></section><section><span leaf=""><br></span></section><section><span><span leaf="">码字不易，欢迎读者分享或转发到朋友圈，任何公众号或其他媒体未经许可不得私自转载或抄袭。</span></span></section><section><span><span leaf="">由于微信平台算法改版，公众号内容将不再以时间排序展示，建议设置“作图丫”公众号为星标，防止丢失。星标具体步骤为：</span></span></section><section><span><span leaf="">（1）点击页面最上方“作图丫”，进入公众号主页；</span></span></section><section><span><span leaf="">（2）点击右上角的小点点，在弹出界面选择“设为星标”即可。</span></span></section><section><span leaf=""><br></span></section></section><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/QAeGPMg6mLHanHicMnib0MXvXH7qgdniaicCTPJANlHzicibE3sYqn1cQvV44wNW8gUstPlDakqyhPYQrABpjqPgia8cA/640?wx_fmt=png" data-ratio="0.9166666666666666" data-type="png" data-w="24" data-fileid="100016081" src="https://mmbiz.qpic.cn/mmbiz_png/QAeGPMg6mLHanHicMnib0MXvXH7qgdniaicCTPJANlHzicibE3sYqn1cQvV44wNW8gUstPlDakqyhPYQrABpjqPgia8cA/640?wx_fmt=png"></span></section><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/gVbW22e6tKxOQhGYgU8ARXmEW82kBj8BREKtIdPibNkGZz6w3JqJCiaR8ytTQBdVOu4wlHNEVkHUShWAmoG2tr5A/640?wx_fmt=png" data-ratio="0.9166666666666666" data-type="png" data-w="24" data-fileid="100016084" src="https://mmbiz.qpic.cn/mmbiz_png/gVbW22e6tKxOQhGYgU8ARXmEW82kBj8BREKtIdPibNkGZz6w3JqJCiaR8ytTQBdVOu4wlHNEVkHUShWAmoG2tr5A/640?wx_fmt=png"></span></section></section></section></section></section><p><span leaf=""><br></span></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/szwC3dO9ULQsNyxYzGuJKRIlyjU2rKCnBHc4dUKxNaE991olhpeMVR3CzWGhQtSwMl1CeMuqniclZqWMz23qFicg/640?wx_fmt=png" data-ratio="1.105263157894737" data-type="png" data-w="38" data-fileid="100016085" src="https://mmbiz.qpic.cn/mmbiz_png/szwC3dO9ULQsNyxYzGuJKRIlyjU2rKCnBHc4dUKxNaE991olhpeMVR3CzWGhQtSwMl1CeMuqniclZqWMz23qFicg/640?wx_fmt=png"></span></section></section><section data-mid="" mpa-from-tpl="t"><p data-mid=""><span><span leaf="">点个</span><span data-mid=""><span leaf="">在看</span></span><span leaf="">你最好看</span></span></p></section><section data-mid="" mpa-from-tpl="t"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/e04oVjfBibI5Sh4ibn3ZUnjKq2p5KiaSfeXpVxGF1lqQVM3hRA2dw87CIIjnccRRZd18xjXKTJy0MuiafNt5jU9v3g/640?wx_fmt=gif" data-ratio="0.9473684210526315" data-type="gif" data-w="114" data-fileid="100016086" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/e04oVjfBibI5Sh4ibn3ZUnjKq2p5KiaSfeXpVxGF1lqQVM3hRA2dw87CIIjnccRRZd18xjXKTJy0MuiafNt5jU9v3g/640?wx_fmt=gif"></span></section></section></section></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/yvTj5BQYykeIN0Yes6w4TA",target="_blank" rel="noopener noreferrer">原文链接</a>
