---
title: "写一个 R 版本的 ORFfinder"
date: 2024-11-12T15:45:53Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
写一个 R 版本的 ORFfinder by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="%E5%8C%86%E5%8C%86%E9%82%A3%E5%B9%B4" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M0000036eU2A4VBjo2_1.jpg" singer="王菲" duration="240000" username="" music_source="1" is_vip="1" listenid="78225850303231776"></mp-common-clmusic></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>预测 <strong>开放阅读框</strong> 的软件和一下 <strong>非编码 RNA 翻译微肽</strong> 的数据库都有一些。根据提供的序列去寻找可能的 <strong>ORF(Open Reading frame)</strong> 。比如 <strong>NCBI</strong> 的 <strong>ORFfinder</strong>，我们需要满足最基本符合翻译的原则。</p></blockquote><p data-tool="mdnice编辑器"><strong>地址：https://www.ncbi.nlm.nih.gov/orffinder/</strong></p><p data-tool="mdnice编辑器">只需要粘贴 <strong>FASTA</strong> 序列即可：<img data-imgfileid="100031937" data-ratio="0.42566844919786095" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Fuo1iaEJMibCWEvk8PxFmP2WGubB6nYy1c64icT2sqdiciaNHS445YJKczw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1870" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Fuo1iaEJMibCWEvk8PxFmP2WGubB6nYy1c64icT2sqdiciaNHS445YJKczw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031935" data-ratio="0.464" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7l33KP3KgvQQXDE5GVpke90J1KLjtVHGGiavISRxQdCg10G1IxSuGz4A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1875" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7l33KP3KgvQQXDE5GVpke90J1KLjtVHGGiavISRxQdCg10G1IxSuGz4A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>页面端只能处理一定长度的序列，而且不能多序列处理</strong>，页面提供了一个本地安装版:</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031933" data-ratio="0.2453416149068323" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7PUEEGyTnAMEeic5yEALUegCxrzia0Femnkj1urVv1iamsYomltBicv9wIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="966" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7PUEEGyTnAMEeic5yEALUegCxrzia0Femnkj1urVv1iamsYomltBicv9wIg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>github</strong> 上淘宝了一下，找到一个 <strong>python</strong> 版本的，但是也只能单次处理一条序列。</p></blockquote><p data-tool="mdnice编辑器"><strong>地址：https://github.com/Chokyotager/ORFFinder</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031936" data-ratio="0.5290368271954674" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Hg4um4NtvJf05CDdfLWgTdJJxcjonydHHs8dbzdKZAfibYhEy6D1Kqg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1412" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Hg4um4NtvJf05CDdfLWgTdJJxcjonydHHs8dbzdKZAfibYhEy6D1Kqg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031934" data-ratio="0.5799086757990868" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Zvf6umafYLo7rJ4bNFFUEmMHcEJMhK8JXFyX5oPRssOKVl9HAzxgibw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1095" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Zvf6umafYLo7rJ4bNFFUEmMHcEJMhK8JXFyX5oPRssOKVl9HAzxgibw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><p data-tool="mdnice编辑器">自己造个：</p><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/ORFfinderR"</span>)<br><br><span># or</span><br>remotes::install_github(<span>"junjunlab/ORFfinderR"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>python 转 R</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><ul><li><section>把 python 版的 <strong>ORFFinder</strong> 代码改一下，增加一个批量处理并输出的结果。</section></li><li><section>放到 R 里面调用并进行分析返回结果。</section></li></ul></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># batch get orf</span><br><span><span>def</span> <span>batch_get_orf</span><span>(sequence=<span>""</span>,output_file=<span>""</span>, **kwargs)</span>:</span><br>    <span>from</span> Bio <span>import</span> SeqIO<br><br>    orf_lst = []<br><br>    <span>for</span> sequence <span>in</span> SeqIO.parse(sequence, <span>"fasta"</span>):<br>        orf = getORFProteins(sequence, **kwargs)<br>        orf_lst.append(orf)<br><br>    flatern = []<br>    <span>for</span> i <span>in</span> orf_lst:<br>        <span>for</span> j <span>in</span> i:<br>            flatern.append(j)<br><br>    out_file = open(output_file, <span>'w'</span>)<br>    <span>for</span> i <span>in</span> flatern:<br>        out_file.write(<span>"\t"</span>.join([str(i[<span>"id"</span>]),str(i[<span>"t_len"</span>]),str(i[<span>"start"</span>]),str(i[<span>"end"</span>]),str(i[<span>"frame"</span>]),str(i[<span>"sense"</span>]),str(i[<span>"length"</span>]),str(i[<span>"protein"</span>])]) + <span>'\n'</span>)<br>    out_file.close()<br></code></pre><p data-tool="mdnice编辑器">测试的两条序列：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031942" data-ratio="0.8090010976948409" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7M4Fatnv9SjTPIzFA6kbsWfZ9Q9UtH19wphsPjw8NwicxfzYv8ttHnqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="911" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7M4Fatnv9SjTPIzFA6kbsWfZ9Q9UtH19wphsPjw8NwicxfzYv8ttHnqw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">非常简单的使用，同时返回蛋白序列：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(ORFfinderR)<br><br>df &lt;- get_orf(sequence = <span>"../test.fa"</span>,remove_nested = <span>"TRUE"</span>,output_file = <span>"pkg_test.txt"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031940" data-ratio="0.13695090439276486" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7vaKuUueQlCIEXywNJeyfHflhUIrgiaLMjs93LiclCTpEUxAyZCtZt3nA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1161" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7vaKuUueQlCIEXywNJeyfHflhUIrgiaLMjs93LiclCTpEUxAyZCtZt3nA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">和 <strong>API</strong> 调用是一样的结果：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031938" data-ratio="0.19706078824315298" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7QBLXLg7PS0LPl6qIv8acpsxIanypMQ4UTenQWD10vNro1vk1JXyukg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1497" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7QBLXLg7PS0LPl6qIv8acpsxIanypMQ4UTenQWD10vNro1vk1JXyukg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可视化一下：</p><pre data-tool="mdnice编辑器"><span></span><code>df &lt;- get_orf(sequence = <span>"../test.fa"</span>,output_file = <span>"pkg_test.txt"</span>)<br><br>orf_plot(data = df)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031939" data-ratio="0.5240295748613678" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7C9egHB3xpzRAjJNoic2HFarlsVW8JWqHnK0kug5cHBpLlV0zicJuDw5A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1082" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7C9egHB3xpzRAjJNoic2HFarlsVW8JWqHnK0kug5cHBpLlV0zicJuDw5A/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>寻找 ORF</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这里我们还是自己手动去写一个函数，<strong>基本原理是分别从给定序列的正链和负链寻找用户给定的起始密码子（ATG）和终止密码子（TAA，TAG，TGA）所有位置，然后筛选不是 3 的倍数的序列即可。</strong></p></blockquote><p data-tool="mdnice编辑器">一句代码搞定：</p><pre data-tool="mdnice编辑器"><span></span><code>tt &lt;- find_orf(seq_obj = <span>"../test.fa"</span>)<br><br><span># return amino acid</span><br>tt &lt;- find_orf(seq_obj = <span>"../test.fa"</span>,return_AA = <span>T</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031941" data-ratio="0.23096942094990242" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7yKVzdVOA11Ml404dITnvCowqGfTsIffrZ1QE1fqtZt78zJjPZhAkaQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1537" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7yKVzdVOA11Ml404dITnvCowqGfTsIffrZ1QE1fqtZt78zJjPZhAkaQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">返回所有的可能情况：</p><pre data-tool="mdnice编辑器"><span></span><code>tt &lt;- find_orf(seq_obj = <span>"../test.fa"</span>,return_AA = <span>T</span>,filter_orf = <span>F</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031947" data-ratio="0.315958815958816" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu74J16T76ubc4PwzgWbD96ibEf5M0qdkIbgnFgxqrd5xibBfwiciap8hGzTA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1554" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu74J16T76ubc4PwzgWbD96ibEf5M0qdkIbgnFgxqrd5xibBfwiciap8hGzTA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可视化一下：</p><pre data-tool="mdnice编辑器"><span></span><code>orf_plot(data = tt)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031946" data-ratio="0.520888418826018" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Oj9Txb65NDAsrwfia7C3PwVsFY8uwibUFAdF2yWP7Uz86z0LO2bZHTXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1891" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7Oj9Txb65NDAsrwfia7C3PwVsFY8uwibUFAdF2yWP7Uz86z0LO2bZHTXg/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>可以看到，有很多 <strong>具有相同的 start_codon 或者 stop_codon 的序列</strong>。所以需要有一个筛选的规则的。<strong>filter_orf</strong> 的原则是：<strong>相同的 start_codon 选最短的序列，相同的 stop_codon 选最长的序列。</strong> 具体翻译的情况还得需要实验去验证的。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031945" data-ratio="0.6083707025411061" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7v8UO48NAZgcicFGFVAwDcZZVUKeS3ibKZlLvWGM1N0eibNZWCYuiaxqoKg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezsHav73gsT9j0cgDibmHAu7v8UO48NAZgcicFGFVAwDcZZVUKeS3ibKZlLvWGM1N0eibNZWCYuiaxqoKg/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录 </strong></center><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515569&amp;idx=1&amp;sn=8838873a67cd108744a6206f1c9e3972&amp;chksm=c18487c0f6f30ed66faed2ec61160fb8fe8466fc650e32560a16051f032264864f577b04fb29&amp;token=837342039&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">TCGA+GTEX 数据联合分析</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515543&amp;idx=1&amp;sn=49d6991c5d610fbe3fda761b7421934d&amp;chksm=c18487e6f6f30ef002f9e7d88bb19c2fed2de330786d1ad69d36c713b444f19b64aca79e27c2&amp;token=837342039&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">SNAF 新型计算工具鉴定广谱癌症新抗原</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515529&amp;idx=1&amp;sn=b047eb05ccbce0a9ad6ee734b4188416&amp;chksm=c18487f8f6f30eee3c027ac7c5f9b0babcc2fe737dfc2a6c5236e906ec6853b1f508e184af5f&amp;token=2137498509&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想给 visCluster 添加行注释？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515507&amp;idx=1&amp;sn=bfd0f92a6dbad64dd41d8242e4868132&amp;chksm=c1848702f6f30e140bbe092108d9eeadf4e9e7b9ca13fa33a5575bfc778a7d2af01c982a622f&amp;token=2137498509&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Julia 中也可以使用 ggplot？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515491&amp;idx=1&amp;sn=d2cfe70986882a8cbc4aecb23fbc1dad&amp;chksm=c1848712f6f30e0413b5808b4cb284b7a98b4e374812d71b8e7e1f3278a3308d6ea1e8a7600d&amp;token=697561698&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">trackc：HiC 数据可视化神器！</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515447&amp;idx=1&amp;sn=d8e01ea8fe0b37ee430142ea058a0f9d&amp;chksm=c1848746f6f30e50d75249f9a198946d211e08317960ce7388f2dde95db27d3f9351195aa211&amp;token=697561698&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">scplotter：单细胞可视化神包！</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515426&amp;idx=1&amp;sn=a4911c55b9f53ea046cf7aebc5fc0855&amp;chksm=c1848753f6f30e4561303f7f5da0edcb9008ca7925b111e25cb365f9df7962bd57c937c341cb&amp;token=96515316&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GseaVis 绘制山脊图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515405&amp;idx=1&amp;sn=d3b3ba1ffe1f533ea0fe2f0daf1823a6&amp;chksm=c184877cf6f30e6a36e6e4a32c2677a37dd3ebd24f4e9da823d435f6af9e28678b99676e860b&amp;token=96515316&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 综合使用手册</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515358&amp;idx=1&amp;sn=98fe527ac548ee46720c11a26b723d39&amp;chksm=c18486aff6f30fb9c0953f5a8d7a1aa39b4dcb8202bb5c34cf61cadae042f8eb2e8631dc36c1&amp;token=2130598365&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 进行 TCseq 聚类分析</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515345&amp;idx=1&amp;sn=a57b858a3b02af88baf27bc990c8540d&amp;chksm=c18486a0f6f30fb627fa948b07e5b59348fa16eb9e9f9bff3f0895a61ab7c2fdbaa8f9a23d76&amp;token=2130598365&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GseaVis 使用文档</a></center></strong><p><br></p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/JoSuuaTmdDAI5BcuzHvfTA",target="_blank" rel="noopener noreferrer">原文链接</a>
