---
title: "R语言ggplot2做堆积柱形图展示密码子偏向性RSCU值（更新版）"
date: 2024-11-10T02:25:12Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言ggplot2做堆积柱形图展示密码子偏向性RSCU值（更新版） by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器">之前有一篇推文记录过画图的代码</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI3NzQ3MTcxMg==&amp;mid=2247485492&amp;idx=1&amp;sn=f953839006340732b62cfc14ecc0813d&amp;chksm=eb6480bbdc1309ad6ec0c81804213e48b2d09546ec18cef9546ba78eb6067c2e0330dc9d9210&amp;scene=21#wechat_redirect" textvalue="R语言ggplot2画堆积柱形图展示密码子偏向性的RSCU值" linktype="text" imgurl="" imgdata="null" data-itemshowtype="5" tab="innerlink" data-linktype="2">R语言ggplot2画堆积柱形图展示密码子偏向性的RSCU值</a>，</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI3NzQ3MTcxMg==&amp;mid=2247488958&amp;idx=2&amp;sn=7b681a4baf8737e6e8912981947f0a13&amp;chksm=eb649d31dc131427b12adc206de3808c8009711e535f4a1d8d0b8eec21bbc32af773146abd0e&amp;scene=21#wechat_redirect" textvalue="R语言ggplot2画分组堆积柱形图展示密码子偏向性的RSCU值" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R语言ggplot2画分组堆积柱形图展示密码子偏向性的RSCU值</a><br></p><p data-tool="mdnice编辑器">那篇推文里需要借助python区算RSCU值，然后用R语言画图。R语言里有一个R包seqinr也可以计算RSCU值</p><h2 data-tool="mdnice编辑器"><span></span><span>计算RSCU值的代码</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">输入数据为多个cds序列</p><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>seqinr::read.fasta("calculateRSCUexampleCDS.fa") %&gt;% <br>  unlist() %&gt;% <br>  seqinr::uco(index="rscu") %&gt;% <br>  as.data.frame() %&gt;% <br>  rownames_to_column() %&gt;% <br>  magrittr::set_colnames(c("codon","rscu"))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014516" data-ratio="0.6175548589341693" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4ibhoJYkeO1BLoq0EPYicZM6LFzlaWJrHlEHO4FlCDmsV2bz2H2250t288KOpcz1FwbQkl1CqLpS0w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="319" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4ibhoJYkeO1BLoq0EPYicZM6LFzlaWJrHlEHO4FlCDmsV2bz2H2250t288KOpcz1FwbQkl1CqLpS0w/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>构造作图数据</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>data.frame(<br>  acids=c("Isoleucine","Leucine","Valine","Phenylalanine",<br>          "Methionine","Cysteine","Alanine","Glycine",<br>          "Proline","Threonine","Serine",<br>           "Tyrosine","Tryptophan","Glutamine",<br>          "Asparagine","Histidine","Glutamic acid",<br>          "Aspartic acid","Lysine","Arginine","Stop codons"),<br>  slc=c("I","L","V","F","M","C","A","G","P","T",<br>        "S","Y","W","Q","N","H","E","D","K","R","Stop"),<br>  codon=c("ATT, ATC, ATA","CTT, CTC, CTA, CTG, TTA, TTG",<br>          "GTT, GTC, GTA, GTG","TTT, TTC",<br>          "ATG","TGT, TGC",<br>           "GCT, GCC, GCA, GCG","GGT, GGC, GGA, GGG",<br>          "CCT, CCC, CCA, CCG","ACT, ACC, ACA, ACG",<br>          "TCT, TCC, TCA, TCG, AGT, AGC",<br>           "TAT, TAC","TGG","CAA, CAG","AAT, AAC","CAT, CAC","GAA, GAG","GAT, GAC",<br>          "AAA, AAG","CGT, CGC, CGA, CGG, AGA, AGG",<br>          "TAA, TAG, TGA")<br>  <br>) %&gt;% <br>  separate(codon,paste0("col",1:6),sep=", ") %&gt;% <br>  pivot_longer(!c(acids,slc)) %&gt;% <br>  na.omit() %&gt;% <br>  select(-name) %&gt;% <br>  magrittr::set_colnames(c("acids","abbr","codon"))-&gt; codon.table<br><br><br>seqinr::read.fasta("calculateRSCUexampleCDS.fa") %&gt;% <br>  unlist() %&gt;% <br>  seqinr::uco(index="rscu") %&gt;% <br>  as.data.frame() %&gt;% <br>  rownames_to_column() %&gt;% <br>  magrittr::set_colnames(c("codon","rscu")) %&gt;% <br>  mutate(codon=str_to_upper(codon)) %&gt;% <br>  left_join(codon.table,by=c("codon"="codon")) %&gt;% <br>  mutate(acids=str_sub(acids,1,3)) %&gt;% <br>  arrange(acids,rscu)%&gt;% <br>  group_by(acids) %&gt;% <br>  mutate(id=row_number()) %&gt;% <br>  dplyr::select(codon,acids,rscu,id) %&gt;% <br>  mutate(codon=factor(codon,level=codon),<br>         id=-id)  -&gt; rscu.dat<br><br><br>rscu.dat<br><br>colnames(rscu.dat)&lt;-paste0("V",1:4)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>作图代码</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>ggplot(rscu.dat,aes(fill=as.character(V4),x=V2,y=V3))+<br>  geom_bar(position = "stack",stat="identity")+<br>  theme_bw()+scale_y_continuous(expand=c(0,0),<br>                                limits = c(0,6.2))+<br>  theme(legend.position = "none")+labs(y="RSCU",x="")+<br>  theme(panel.grid = element_blank())+<br>  scale_fill_manual(values = c("#999999","#56b4e8","#d55e00",<br>                               "#009f73","#cc79a7","#0072b1"))+<br>  theme(plot.margin = unit(c(0.1,0.1,0,0.1),'mm'))-&gt; rscu.p1<br><br>ggplot(rscu.dat,aes(x=V2,y=V4))+<br>  geom_label(aes(label=V1,fill=as.character(V4)),<br>             size=3)+<br>  labs(x="",y="")+<br>  theme_minimal()+<br>  theme(legend.position = "none",<br>        axis.text = element_blank(),<br>        axis.ticks = element_blank(),<br>        panel.grid = element_blank())+<br>  scale_fill_manual(values = c("#999999","#56b4e8","#d55e00",<br>                               "#009f73","#cc79a7","#0072b1"))+<br>  theme(plot.margin = unit(c(0,0.1,0.1,0.1),'mm'))+<br>  coord_cartesian(clip = "off") -&gt; rscu.p2<br><br>library(patchwork)<br><br>cairo_pdf("RSCU_barplot.pdf",<br>          width = 9.4,height = 4)<br>rscu.p1+rscu.p2 + plot_layout(ncol=1,heights = c(2,1))<br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014517" data-ratio="0.425" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4ibhoJYkeO1BLoq0EPYicZM6unMgWeKO27lPSlgsX4ogzh5B4udV3vc7nWPxIyTpEywvozSLXHN9JQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4ibhoJYkeO1BLoq0EPYicZM6unMgWeKO27lPSlgsX4ogzh5B4udV3vc7nWPxIyTpEywvozSLXHN9JQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p>R语言是用来做统计和数据可视化的软件，推荐《R语言实战》这本参考书用来入门学习R语言。</p><p><br></p><section><mp-common-cpsad data-pluginname="mpcps" data-templateid="card" data-traceid="485c0929-923e-49ab-9d8c-fad64e1be4b0" data-goodssouce="1" data-pid="101_11939734" data-appuin="3277471712" data-cpsversion="v112"></mp-common-cpsad></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/aTE2FVq2UYXvUn2tUTbXKQ",target="_blank" rel="noopener noreferrer">原文链接</a>
