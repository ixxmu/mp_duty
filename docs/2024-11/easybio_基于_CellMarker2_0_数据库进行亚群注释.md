---
title: "easybio 基于 CellMarker2.0 数据库进行亚群注释"
date: 2024-11-27T06:57:28Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
easybio 基于 CellMarker2.0 数据库进行亚群注释 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0" data-service_type="1"></mp-common-profile></section><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>单细胞亚群的注释是整个单细胞分析流程的灵魂所在，也是一个需要时间，精力和充足的生物学背景的过程。一些细胞标记基因的数据库如 <strong>CellMarker</strong>，<strong>PanglaoDB</strong> 和 <strong>Mouse Cell Atlas</strong> 有助于我们查询对应的细胞类型。<strong>CellMarker</strong> 是网页版工具，<strong>easybio</strong> 这个 R 包提供了在 R 环境使用 <strong>CellMarker 2.0</strong> 数据库来对亚群进行注释。具体结果怎么样大家可以试试对比看看。</p></blockquote><p data-tool="mdnice编辑器"><strong>github 地址：https://github.com/person-c/easybio</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031995" data-ratio="0.6196319018404908" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG55Voib0sr4ebor1KiaXFufdq51YAjRXKAf8O1xoRhnX9AQnUpf5Kibj8jA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1141" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG55Voib0sr4ebor1KiaXFufdq51YAjRXKAf8O1xoRhnX9AQnUpf5Kibj8jA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>安装：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>install.packages(<span>"easybio"</span>, repos = c(<span>"https://person-c.r-universe.dev"</span>, <span>"https://cloud.r-project.org"</span>))<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>使用</span><span></span></h2><p data-tool="mdnice编辑器">输入 <strong>FindAllMarkers</strong> 的结果：</p><pre data-tool="mdnice编辑器"><span></span><code>file.show(system.file(package = <span>'easybio'</span>, <span>'example-single-cell.R'</span>))<br><br><span>library</span>(easybio)<br>head(pbmc.markers)<br><span>#&gt;               p_val avg_log2FC pct.1 pct.2     p_val_adj cluster  gene</span><br><span>#&gt; RPS12 1.273332e-143  0.7387061 1.000 0.991 1.746248e-139       0 RPS12</span><br><span>#&gt; RPS6  6.817653e-143  0.6934523 1.000 0.995 9.349729e-139       0  RPS6</span><br><span>#&gt; RPS27 4.661810e-141  0.7372604 0.999 0.992 6.393206e-137       0 RPS27</span><br><span>#&gt; RPL32 8.158412e-138  0.6266075 0.999 0.995 1.118845e-133       0 RPL32</span><br><span>#&gt; RPS14 5.177478e-130  0.6336957 1.000 0.994 7.100394e-126       0 RPS14</span><br><span>#&gt; RPS25 3.244898e-123  0.7689940 0.997 0.975 4.450053e-119       0 RPS25</span><br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><ul><li><section><strong>The function matches the top 50 genes in each cluster with the CellMarker2 database.</strong></section></li><li><section><strong>It then calculates the cell count for each matched cell type and prints the result, helping you identify possible cell types for the cluster.</strong></section></li></ul></blockquote><p data-tool="mdnice编辑器">注释：</p><pre data-tool="mdnice编辑器"><span></span><code>(marker &lt;- matchCellMarker2(marker = pbmc.markers, n = <span>50</span>, spc = <span>'Human'</span>)[, head(.SD, <span>2</span>), by=cluster])<br><span>#&gt; Key: &lt;cluster&gt;</span><br><span>#&gt;     cluster                        cell_name uniqueN     N</span><br><span>#&gt;      &lt;fctr&gt;                           &lt;char&gt;   &lt;int&gt; &lt;int&gt;</span><br><span>#&gt;  1:       0                Naive CD8+ T cell       6    34</span><br><span>#&gt;  2:       0                Naive T(Th0) cell       3    32</span><br><span>#&gt;  3:       1                         Monocyte       9   133</span><br><span>#&gt;  4:       1                       Macrophage       8    63</span><br><span>#&gt;  5:       2          Regulatory T(Treg) cell      11   148</span><br><span>#&gt;  6:       2                           T cell      11    82</span><br><span>#&gt;  7:       3                           B cell       9   317</span><br><span>#&gt;  8:       3                     Naive B cell       6    33</span><br><span>#&gt;  9:       4                           T cell      15   104</span><br><span>#&gt; 10:       4              Natural killer cell      17    99</span><br><span>#&gt; 11:       5                       Macrophage       4    34</span><br><span>#&gt; 12:       5                         Monocyte       3    10</span><br><span>#&gt; 13:       6              Natural killer cell      14   196</span><br><span>#&gt; 14:       6                 Cytotoxic T cell       4    24</span><br><span>#&gt; 15:       7 Plasmacytoid dendritic cell(pDC)       8    42</span><br><span>#&gt; 16:       7                   Dendritic cell       6    38</span><br><span>#&gt; 17:       8                    Megakaryocyte       9    52</span><br><span>#&gt; 18:       8                 Endothelial cell       6    41</span><br><span>#&gt;                                   ordered_symbol                      orderN</span><br><span>#&gt;                                           &lt;list&gt;                      &lt;list&gt;</span><br><span>#&gt;  1:               CCR7,LEF1,CD8B,MAL,NELL2,TSHZ2           14,12, 2, 2, 2, 2</span><br><span>#&gt;  2:                              CCR7,LEF1,LRRN3                    23, 8, 1</span><br><span>#&gt;  3: CD14,S100A8,S100A9,S100A12,FCGR1A,MS4A6A,...       82,22,15, 5, 4, 2,...</span><br><span>#&gt;  4:    CD14,FCGR1A,CCL2,PLA2G7,RNASE1,S100A8,...       46, 6, 2, 2, 2, 2,...</span><br><span>#&gt;  5:  FOXP3,IL2RA,CTLA4,TNFRSF4,TNFRSF18,ICOS,...       55,45,22, 7, 6, 4,...</span><br><span>#&gt;  6:        CD2,CTLA4,FOXP3,IL2RA,CD40LG,CCR6,...       32,12, 8, 7, 6, 4,...</span><br><span>#&gt;  7:       CD79A,CD19,MS4A1,FCER2,TCL1A,IGLL5,... 102, 97, 97,  6,  5,  3,...</span><br><span>#&gt;  8:           TCL1A,MS4A1,CD19,FCER2,CD79A,PCDH9           13, 6, 5, 5, 3, 1</span><br><span>#&gt;  9:           CD8A,CD8B,GZMK,TIGIT,CCL5,GZMA,...       38,10, 7, 7, 6, 6,...</span><br><span>#&gt; 10:          NKG7,KLRB1,GZMA,CCL5,CD160,CD8A,...       50, 9, 6, 5, 5, 3,...</span><br><span>#&gt; 11:                       C1QA,C1QB,MS4A7,MS4A4A                 13,10, 7, 4</span><br><span>#&gt; 12:                              MS4A7,C1QB,C1QA                       7,2,1</span><br><span>#&gt; 13:          NCAM1,GNLY,KLRF1,GZMB,NCR1,XCL1,...       61,42,25,16,14,11,...</span><br><span>#&gt; 14:                        PRF1,GZMB,GNLY,FGFBP2                     9,8,6,1</span><br><span>#&gt; 15:  CLEC4C,LILRA4,SCT,LAMP5,LRRC26,SERPINF1,...       19,16, 2, 1, 1, 1,...</span><br><span>#&gt; 16:       FCER1A,CLEC10A,LILRA4,FLT3,CD1E,CLEC4C           16,11, 4, 3, 2, 2</span><br><span>#&gt; 17:           PPBP,PF4,ITGA2B,GP9,MYL9,TUBB1,...       15,12, 9, 4, 4, 3,...</span><br><span>#&gt; 18:         CLDN5,ESAM,GNG11,LCN2,SERPINE1,SPARC           36, 1, 1, 1, 1, 1</span><br><span>#&gt;                                          markerWith</span><br><span>#&gt;                                              &lt;list&gt;</span><br><span>#&gt;  1:               LEF1,CCR7,MAL,LEF1,TSHZ2,CCR7,...</span><br><span>#&gt;  2:              CCR7,CCR7,LRRN3,CCR7,CCR7,CCR7,...</span><br><span>#&gt;  3:       S100A9,S100A8,CD14,S100A8,S100A9,CD14,...</span><br><span>#&gt;  4:               CD14,CD14,CD14,CD14,CD14,CD14,...</span><br><span>#&gt;  5:    CTLA4,TNFRSF4,IL2RA,TNFRSF18,FOXP3,FOXP3,...</span><br><span>#&gt;  6:         IL2RA,IL2RA,CD40LG,CD40LG,CD2,CTLA4,...</span><br><span>#&gt;  7:           MS4A1,CD19,CD79A,CD79A,CD19,MS4A1,...</span><br><span>#&gt;  8:         MS4A1,TCL1A,PCDH9,CD79A,TCL1A,FCER2,...</span><br><span>#&gt;  9:               CD8A,CD8A,CD8A,GZMA,CD8B,CD8A,...</span><br><span>#&gt; 10:              NKG7,NKG7,KLRB1,CD8A,NKG7,NKG7,...</span><br><span>#&gt; 11:             MS4A7,C1QB,C1QA,MS4A7,C1QA,C1QB,...</span><br><span>#&gt; 12:          MS4A7,MS4A7,MS4A7,MS4A7,MS4A7,C1QB,...</span><br><span>#&gt; 13:           GNLY,NCAM1,NCAM1,KLRF1,GNLY,NCAM1,...</span><br><span>#&gt; 14:             PRF1,GZMB,FGFBP2,GNLY,GZMB,PRF1,...</span><br><span>#&gt; 15: CLEC4C,LILRA4,SERPINF1,CLEC4C,LILRA4,LILRA4,...</span><br><span>#&gt; 16: FCER1A,CLEC10A,FCER1A,LILRA4,CLEC10A,FCER1A,...</span><br><span>#&gt; 17:            PF4,PPBP,SPARC,PPBP,ITGA2B,TUBB1,...</span><br><span>#&gt; 18:         CLDN5,CLDN5,CLDN5,CLDN5,SPARC,CLDN5,...</span><br></code></pre><p data-tool="mdnice编辑器">可视化可能的细胞类型：</p><pre data-tool="mdnice编辑器"><span></span><code>plotPossibleCell(marker)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031991" data-ratio="0.8" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5d5vyaVIRYF13TkUEg1ztJMrEJUjdTL2iaxiajGal4uWHQtlRlNmdjvlg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="720" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5d5vyaVIRYF13TkUEg1ztJMrEJUjdTL2iaxiajGal4uWHQtlRlNmdjvlg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">取第一个注释结果：</p><pre data-tool="mdnice编辑器"><span></span><code>cl2cell &lt;- marker[, head(.SD, <span>1</span>), by = .(cluster)]<br>cl2cell &lt;- setNames(cl2cell[[<span>"cell_name"</span>]], cl2cell[[<span>"cluster"</span>]])<br>cl2cell<br><span>#&gt;                                  0                                  1</span><br><span>#&gt;                "Naive CD8+ T cell"                         "Monocyte"</span><br><span>#&gt;                                  2                                  3</span><br><span>#&gt;          "Regulatory T(Treg) cell"                           "B cell"</span><br><span>#&gt;                                  4                                  5</span><br><span>#&gt;                           "T cell"                       "Macrophage"</span><br><span>#&gt;                                  6                                  7</span><br><span>#&gt;              "Natural killer cell" "Plasmacytoid dendritic cell(pDC)"</span><br><span>#&gt;                                  8</span><br><span>#&gt;                    "Megakaryocyte"</span><br></code></pre><p data-tool="mdnice编辑器">作者还和 <strong>singleR</strong> 结果进行比较：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031994" data-ratio="0.5864197530864198" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5y3C83h9klaVJic9WOpRclVL9RmFzB6AvSyVEaFl76lEcIGGiapVDYEiag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="810" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5y3C83h9klaVJic9WOpRclVL9RmFzB6AvSyVEaFl76lEcIGGiapVDYEiag/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031992" data-ratio="0.12546583850931678" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5Yhds7BewvVRTkicjUJhsYS5g83bN05HFSuwPYQGMBE0M9hDoXibIQQLg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="805" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG5Yhds7BewvVRTkicjUJhsYS5g83bN05HFSuwPYQGMBE0M9hDoXibIQQLg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031993" data-ratio="0.6083707025411061" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG59GLOoBmYJpORs5UdxV0Lv237yHVPjBqnnZnWB6QUYPyTJW0DsIZ6ng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useymJAsMOibDQxwv8xdtYMfG59GLOoBmYJpORs5UdxV0Lv237yHVPjBqnnZnWB6QUYPyTJW0DsIZ6ng/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录 </strong></center><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515609&amp;idx=1&amp;sn=2f81a1d58af368bc0a261a59f4026652&amp;token=1970442110&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">写一个 R 版本的 ORFfinder</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515569&amp;idx=1&amp;sn=8838873a67cd108744a6206f1c9e3972&amp;chksm=c18487c0f6f30ed66faed2ec61160fb8fe8466fc650e32560a16051f032264864f577b04fb29&amp;token=837342039&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">TCGA+GTEX 数据联合分析</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515543&amp;idx=1&amp;sn=49d6991c5d610fbe3fda761b7421934d&amp;chksm=c18487e6f6f30ef002f9e7d88bb19c2fed2de330786d1ad69d36c713b444f19b64aca79e27c2&amp;token=837342039&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">SNAF 新型计算工具鉴定广谱癌症新抗原</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515529&amp;idx=1&amp;sn=b047eb05ccbce0a9ad6ee734b4188416&amp;chksm=c18487f8f6f30eee3c027ac7c5f9b0babcc2fe737dfc2a6c5236e906ec6853b1f508e184af5f&amp;token=2137498509&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">听说你想给 visCluster 添加行注释？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515507&amp;idx=1&amp;sn=bfd0f92a6dbad64dd41d8242e4868132&amp;chksm=c1848702f6f30e140bbe092108d9eeadf4e9e7b9ca13fa33a5575bfc778a7d2af01c982a622f&amp;token=2137498509&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Julia 中也可以使用 ggplot？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515491&amp;idx=1&amp;sn=d2cfe70986882a8cbc4aecb23fbc1dad&amp;chksm=c1848712f6f30e0413b5808b4cb284b7a98b4e374812d71b8e7e1f3278a3308d6ea1e8a7600d&amp;token=697561698&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">trackc：HiC 数据可视化神器！</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515447&amp;idx=1&amp;sn=d8e01ea8fe0b37ee430142ea058a0f9d&amp;chksm=c1848746f6f30e50d75249f9a198946d211e08317960ce7388f2dde95db27d3f9351195aa211&amp;token=697561698&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">scplotter：单细胞可视化神包！</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515426&amp;idx=1&amp;sn=a4911c55b9f53ea046cf7aebc5fc0855&amp;chksm=c1848753f6f30e4561303f7f5da0edcb9008ca7925b111e25cb365f9df7962bd57c937c341cb&amp;token=96515316&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GseaVis 绘制山脊图</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515405&amp;idx=1&amp;sn=d3b3ba1ffe1f533ea0fe2f0daf1823a6&amp;chksm=c184877cf6f30e6a36e6e4a32c2677a37dd3ebd24f4e9da823d435f6af9e28678b99676e860b&amp;token=96515316&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 综合使用手册</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515358&amp;idx=1&amp;sn=98fe527ac548ee46720c11a26b723d39&amp;chksm=c18486aff6f30fb9c0953f5a8d7a1aa39b4dcb8202bb5c34cf61cadae042f8eb2e8631dc36c1&amp;token=2130598365&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 进行 TCseq 聚类分析</a></center></strong><p><br></p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/RhOy1ciG4zgUC-jSgMDppg",target="_blank" rel="noopener noreferrer">原文链接</a>
