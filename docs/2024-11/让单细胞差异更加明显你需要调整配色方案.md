---
title: "让单细胞差异更加明显你需要调整配色方案"
date: 2024-11-11T10:26:17Z
draft: ["false"]
tags: [
  "fetched",
  "珠海健明生物医药科技"
]
categories: ["Acdemic"]
---
让单细胞差异更加明显你需要调整配色方案 by 珠海健明生物医药科技
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span>https://mp.weixin.qq.com/s/55LaSijBtgURLaS3nKYT5g</span><p>安排学徒复现一个新鲜出炉的阿兹海默症的单细胞文章：《Characterisation of premature cell senescence in Alzheimer’s disease using single nuclear transcriptomics》：</p></blockquote><ul data-tool="mdnice编辑器"><li><section>Acta Neuropathologica (2024)</section></li><li><section>https://doi.org/10.1007/s00401-024-02727-9</section></li></ul><p data-tool="mdnice编辑器">对应的数据集是：GSE264648，大家很容易读取作者提供的表达量矩阵然后进行降维聚类分群，但是学徒在进行 the ‘canonical senescence pathway (CSP)’, the ‘senescence initiating pathway (SIP)’ 的打分的时候，虽然是复现出来了文章的主要是结论， 就是：</p><ul data-tool="mdnice编辑器"><li><section>the aver- age expression of individual senescence gene was most in microglia (e.g., <em>ATM</em>, <em>RB1</em>, <em>NFATC2</em> and <em>GLB1</em>)</section></li></ul><p data-tool="mdnice编辑器">前面的代码详见：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247532928&amp;idx=1&amp;sn=20904eb0ac52acefb226239715fe19cb&amp;chksm=9b4b013bac3c882db280954963c58b01af6396a5b39e485b02388dc000ddb3271b18d0bef325&amp;scene=21#wechat_redirect" textvalue="无论如何也不可能达到文献的完美分群？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">无论如何也不可能达到文献的完美分群？</a> 以及 <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247532911&amp;idx=1&amp;sn=faf7d315e364fddc6daca9bb2120f00f&amp;chksm=9b4b01d4ac3c88c2b0f2c6c97e75ceabb5fe283be725548b97beb185f7c49787630019a9ab68&amp;scene=21#wechat_redirect" textvalue="如何看一堆基因在各个单细胞亚群是否有差异呢？" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">如何看一堆基因在各个单细胞亚群是否有差异呢？</a></p><p data-tool="mdnice编辑器">如下所示被高亮的区域就是小胶质细胞，确实是打分会比较高，但是不够显著。</p><p data-tool="mdnice编辑器">所以我让它简单的询问了人工智能大模型的解决方案。做了一个简单的配色， 就可以达到显著的效果，代码是：</p><pre data-tool="mdnice编辑器"><span></span><code>my.colors &lt;- colorRampPalette(c(<span>"lightblue"</span>, <span>"white"</span>, <span>"darkred"</span>))(<span>100</span>) <br>FeaturePlot(sc_dataset,<span>'gene_vector_UCell'</span> ) +<br>  FeaturePlot(sc_dataset,<span>'gene_vector_UCell'</span>,cols = my.colors)<br><br></code></pre><p><img data-galleryid="" data-imgfileid="100049284" data-ratio="1.0740740740740742" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxmQIkJb2aUDBPRuPv5KWUHsN12a5o4IR9AETkQD7yfLnYSmiaDR7vJ2v1dibn6WHTpjbdiciazoSvwBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxmQIkJb2aUDBPRuPv5KWUHsN12a5o4IR9AETkQD7yfLnYSmiaDR7vJ2v1dibn6WHTpjbdiciazoSvwBA/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>打分会比较高，但是不够显著</figcaption></figure><p data-tool="mdnice编辑器">提问：r编程语言里面的Seurat包里面的FeaturePlot函数可视化一个基因的时候颜色渐变不够明显，有什么调色方案吗</p><p data-tool="mdnice编辑器">在R语言的Seurat包中，<code>FeaturePlot</code> 函数用于可视化单个或多个基因在各个细胞中的表达水平。如果颜色渐变不够明显，可以通过调整颜色渐变的参数来增强视觉效果。以下是一些常用的调色方案和参数调整的建议：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>使用已有的颜色渐变方案</strong>：Seurat内置了一些颜色渐变方案，例如"viridis"、"cividis"、"magma"、"inferno"、"plasma"等，这些颜色方案通常提供较好的对比度和渐变效果。</p></section></li><li><section><p><strong>自定义颜色渐变</strong>：你可以使用R的颜色函数，如<code>colorRampPalette()</code>或<code>brewer.pal()</code>来自定义颜色渐变。例如：</p><pre><span></span><code>my.colors &lt;- colorRampPalette(c(<span>"blue"</span>, <span>"white"</span>, <span>"red"</span>))(<span>100</span>)<br></code></pre><p>这段代码创建了一个从蓝色到白色再到红色的颜色渐变。</p></section></li><li><section><p><strong>调整颜色的数量</strong>：通过调整颜色的数量，可以改变渐变的细腻程度。颜色数量越多，渐变越细腻。</p></section></li><li><section><p><strong>调整底图的分辨率</strong>：使用<code>FeaturePlot</code>函数时，可以通过<code>nCol</code>参数调整底图的列数，以及<code>pt.size</code>参数调整点的大小，从而影响视觉效果。</p></section></li><li><section><p><strong>使用<code>reorder</code>参数</strong>：使用<code>reorder</code>参数可以根据基因表达量的大小重新排序细胞，可能会使表达模式更加明显。</p></section></li><li><section><p><strong>调整透明度</strong>：通过设置<code>alpha</code>参数，可以调整点的透明度，有助于在细胞点重叠时区分不同的表达水平。</p></section></li><li><section><p><strong>使用对数转换</strong>：如果基因表达水平差异很大，使用对数转换可能会使渐变更加明显。可以通过<code>Log1p</code>函数对数据进行转换。</p></section></li><li><section><p><strong>使用<code>Scale</code>参数</strong>：<code>FeaturePlot</code>函数的<code>scale</code>参数可以调整颜色的缩放，例如使用<code>scale = "count"</code>根据基因计数缩放颜色。</p></section></li></ol><p data-tool="mdnice编辑器">下面是一个使用自定义颜色渐变的<code>FeaturePlot</code>示例：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><br><span># 假设seurat_obj是你的Seurat对象，gene是你想可视化的基因</span><br>my.colors &lt;- colorRampPalette(c(<span>"lightblue"</span>, <span>"white"</span>, <span>"darkred"</span>))(<span>100</span>)<br>FeaturePlot(seurat_obj, features = gene, cols = my.colors)<br></code></pre><p data-tool="mdnice编辑器">请注意，这些调整可能需要根据你的具体数据和可视化需求进行尝试和优化。如果需要更专业的调色方案，可以考虑使用如<code>ggplot2</code>的<code>scale_color_gradientn()</code>函数来获取更多的颜色选项。</p><h3 data-tool="mdnice编辑器"><span></span><span>但是为什么修改配色的同时造成了值的修改</span><span></span></h3><p data-tool="mdnice编辑器">如果仔细看上面的两个FeaturePlot就会发现<strong>最开始默认配色的时候打分在0到0.25这个范围，但是配色后值的范围成为了0到1，这个是为什么呢？</strong></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4NCYgqyGiEwdCANjd1sDLA",target="_blank" rel="noopener noreferrer">原文链接</a>
