---
title: "人工智能大模型会以为是错误的PCA图"
date: 2024-11-06T07:59:21Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
人工智能大模型会以为是错误的PCA图 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>我们的马拉松授课最重要的技能就是表达量数据处理，包括表达量芯片，转录组测序，以及单细胞转录组的数据分析。<strong>然后有小伙伴在实战到时候处理了他自己的一个简单的转录组测序，就是2分组，每个组是3个样品。然后使用我们的授课代码出图发现了一个他自己的知识点盲区：</strong></p></blockquote><p><img data-galleryid="" data-imgfileid="100051255" data-ratio="0.9100817438692098" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxblich7a2C7ZghGCdI4Kec5Yl1u7m38snlvE9aawaIuzHwM37ZJcLTEn47CRxZmhPtpCOXxTRicTQg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="734" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxblich7a2C7ZghGCdI4Kec5Yl1u7m38snlvE9aawaIuzHwM37ZJcLTEn47CRxZmhPtpCOXxTRicTQg/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>知识点盲区</figcaption></figure><p data-tool="mdnice编辑器">我们这个代码使用了十几年了，一直没有问题，<strong>我随手处理了一个表达量芯片数据集：5 healthy tissue samples, 9 DCIS and 5 invasive ductal carcinomas were analysed.</strong></p><ul data-tool="mdnice编辑器"><li><section>https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE21422</section></li></ul><p data-tool="mdnice编辑器">可以看到， 其中control样品，就是 5 healthy tissue samples，在层次聚类热图里面确实是5个样品，在pca图里面也是5个小点，然后有一个大的点。<strong>所以看起来给初学者的感觉是多了一个样品，因为默认样品才是有点作为标记。</strong></p><p><img data-galleryid="" data-imgfileid="100051256" data-ratio="0.42407407407407405" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxblich7a2C7ZghGCdI4Kec5YMSUDOBan6uCONlV9EyHIc2C7Vx0gyFBiaVpGoaWjswEyHkaib6icHjoA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxblich7a2C7ZghGCdI4Kec5YMSUDOBan6uCONlV9EyHIc2C7Vx0gyFBiaVpGoaWjswEyHkaib6icHjoA/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>在pca图里面也是5个小点</figcaption></figure><p data-tool="mdnice编辑器">实际上，这个是画主成分分析图需要加载的这两个包的特性，它给每个分组加上一个代表性的点这个点比样品的点大一些，所以很容易区分，它并不是一个样品。</p><pre data-tool="mdnice编辑器"><span></span><code>  <span>library</span>(<span>"FactoMineR"</span>)<span>#画主成分分析图需要加载这两个包</span><br>  <span>library</span>(<span>"factoextra"</span>)  <br>  <span>#～～～主成分分析图p2～～～</span><br>  dat.pca &lt;- PCA(exp , graph = <span>FALSE</span>)<span>#现在exp最后一列是group_list，需要重新赋值给一个dat.pca,这个矩阵是不含有分组信息的</span><br>  this_title &lt;- paste0(pro,<span>'_PCA'</span>)<br>  p2 &lt;- fviz_pca_ind(dat.pca,<br>                     geom.ind = <span>"point"</span>, <span># show points only (nbut not "text")</span><br>                     col.ind = group_list, <span># color by groups</span><br>                     palette = <span>"Dark2"</span>,<br>                     addEllipses = <span>TRUE</span>, <span># Concentration ellipses</span><br>                     legend.title = <span>"Groups"</span>)+<br>    ggtitle(this_title)+<br>    theme_ggstatsplot()+<br>    theme(plot.title = element_text(size=<span>12</span>,hjust = <span>0.5</span>))<br>  <br>  p2<br>  ggsave(<span>'qc_pca.pdf'</span>,width = <span>5</span>,height = <span>5</span>)<br></code></pre><p data-tool="mdnice编辑器">但是如果问人工智能大模型这个问题：做bulk RNAseq的时候只用了六个样本 3个实验组 3个对照组 ，但是PCA图上每个分组却有四个点 这是什么原因呢？</p><h3 data-tool="mdnice编辑器"><span></span><span>人工智能大模型给出的答案并不是合理的：</span><span></span></h3><p data-tool="mdnice编辑器">在使用bulk RNA-seq数据进行主成分分析（PCA）时，如果每个分组在PCA图上显示了四个点，而不是预期的三个点，可能有几个原因：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>技术重复</strong>：</p></section></li></ol><ul><li><section>实验中可能无意中包含了技术重复，即某些样本被测序了多次。</section></li></ul><li><section><p><strong>数据处理错误</strong>：</p></section></li><ul><li><section>在数据处理或数据导入时可能发生了错误，导致某些样本被错误地计算或标记了多次。</section></li></ul><li><section><p><strong>样本标记错误</strong>：</p></section></li><ul><li><section>在样本处理或数据记录过程中可能发生了标记错误，使得同一个样本被错误地归入了不同的组。</section></li></ul><li><section><p><strong>数据合并</strong>：</p></section></li><ul><li><section>如果数据来自不同的实验批次或不同的测序运行，可能在合并数据时发生了错误，导致某些样本被重复计算。</section></li></ul><li><section><p><strong>批次效应</strong>：</p></section></li><ul><li><section>即使样本数量不多，批次效应也可能导致数据在PCA图上出现意外的分布模式。</section></li></ul><li><section><p><strong>数据标准化问题</strong>：</p></section></li><ul><li><section>数据标准化过程中的问题可能导致某些样本的表达模式被放大或缩小，从而影响PCA结果。</section></li></ul><li><section><p><strong>基因表达量异常</strong>：</p></section></li><ul><li><section>某些样本中可能存在异常高的基因表达量，这可能影响PCA分析的结果。</section></li></ul><li><section><p><strong>PCA分析参数设置</strong>：</p></section></li><ul><li><section>PCA分析时的参数设置可能不正确，例如在计算主成分时使用了不恰当的变量或权重。</section></li></ul><li><section><p><strong>数据可视化错误</strong>：</p></section></li><ul><li><section>在将PCA结果可视化时可能发生了错误，导致图上的点被错误地标记或显示。</section></li></ul><li><section><p><strong>样本污染或交叉污染</strong>：</p></section></li><ul><li><section>实验操作过程中的污染可能导致样本混合，影响PCA结果。</section></li></ul><p data-tool="mdnice编辑器">为了解决这个问题，需要仔细检查实验设计、样本处理、数据质量和数据处理流程。可能需要重新检查原始数据、实验记录和分析代码，以确定问题的根源，并采取相应的措施进行修正。在必要时，可能需要重新进行实验或测序以获得准确的数据。</p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p><span>如果你也想做单细胞转录组数据分析，</span><span>最好是有自己的计算机资源哦，比如我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533037&amp;idx=2&amp;sn=e6dd07e9339a84c8cbad2a9d6b42c8ca&amp;chksm=9b4b0156ac3c88403c55822722f6a93cde401fbb7b7cdbaee2a07211347e751ce414b7a47ec7&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然‍是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247534569&amp;idx=1&amp;sn=b784451a39ca32e4d87200ea4c31bc57&amp;chksm=9b4b0752ac3c8e44a4751ddd99180a4ff24119b1ab6b3827e4f1c76d26339339b1abaf8abc74&amp;scene=21#wechat_redirect" textvalue="生物‍信息学马拉松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。</span></p><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Lua1jRdwGCmK9jvGSkH3rQ",target="_blank" rel="noopener noreferrer">原文链接</a>
