---
title: "pathlinkR：差异分析 + 蛋白互作 + 功能富集网络可视化，这个R包赶紧收藏用起来！"
date: 2024-11-05T16:23:51Z
draft: ["false"]
tags: [
  "fetched",
  "生信碱移"
]
categories: ["Acdemic"]
---
pathlinkR：差异分析 + 蛋白互作 + 功能富集网络可视化，这个R包赶紧收藏用起来！ by 生信碱移
------
<div><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-type="gif" data-w="154" data-imgfileid="100011090" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section><section><section powered-by="xiumi.us"><section><p>老铁快点击蓝字 <strong>关注俺</strong></p></section></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><img data-ratio="1.0324675324675325" data-type="gif" data-w="154" data-imgfileid="100011091" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" src="https://mmbiz.qpic.cn/mmbiz_gif/lN9Tp5oiaqHFn9Rg6MwMU3ukMR9ROPh7bf7QWHEMwhUBUwSUKFsV8oK9noHic3jLaeJVQewHJcLq1cTXVAat35Tw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></section></section></section></section></section></section></section></section></section><section data-mpa-powered-by="yiban.io" data-style='white-space: normal; max-width: 100%; letter-spacing: 0.544px; text-size-adjust: auto; background-color: rgb(255, 255, 255); font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif; box-sizing: border-box !important; overflow-wrap: break-word !important;'><section><section><section><section data-id="85660" data-custom="rgb(117, 117, 118)" data-color="rgb(117, 117, 118)"><section data-style="margin-top: 2em; padding-top: 0.5em; padding-bottom: 0.5em; max-width: 100%; border-style: solid none; text-decoration: inherit; border-top-color: rgb(204, 204, 204); border-bottom-color: rgb(204, 204, 204); border-top-width: 1px; border-bottom-width: 1px; box-sizing: border-box !important; overflow-wrap: break-word !important;"><p><span>生信碱移</span></p><section><span><span><strong>pathlinkR助力富集</strong></span></span></section></section></section></section></section></section></section><p data-tool="markdown.com.cn编辑器">微阵列和RNA-Seq等基因表达研究常常会产生成百上千个差异表达基因 (DEG)。要了解这种海量数据集的生物学意义变得非常困难，尤其是在存在多种条件和比较的情况下。</p><section><img data-galleryid="" data-imgfileid="100011093" data-ratio="1.3270935960591133" data-s="300,640" data-type="png" data-w="1015" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNnt8VIdlhe0VYQDYXQcXbYdUDPI8piaFdBtST10ibcibMCWky7MskBHXfA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNnt8VIdlhe0VYQDYXQcXbYdUDPI8piaFdBtST10ibcibMCWky7MskBHXfA/640?wx_fmt=png&amp;from=appmsg"></section><p data-class="mbImgTitle">▲ 常规的RNA测序分析流程。图片来源：<span>10.1186/s12859-018-2486-6。</span></p><p data-tool="markdown.com.cn编辑器">为此，来自英属哥伦比亚大学的研究者开发了一款软件包<span><strong>pathlinkR</strong></span>，于2024年9月16号发表于<span><strong>PLoS Comput Biol</strong></span><span><strong>[IF: 3.8]</strong></span>。该软件包集成了通路富集和蛋白-蛋白相互作用网络，基于差异基因表达结果的可视化和下游分析，可以帮助研究人员从基因表达研究中揭示潜在的生物学和病理生理学。</p><section><img data-galleryid="" data-imgfileid="100011094" data-ratio="0.4777777777777778" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNyxeBafyXvkDvey608rDdpWJgA3D4cibaK8XFQMheAMHAibsc0xH0rSPQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNyxeBafyXvkDvey608rDdpWJgA3D4cibaK8XFQMheAMHAibsc0xH0rSPQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-class="mbImgTitle">▲ DOI: 10.1371/journal.pcbi.1012422</p><p data-tool="markdown.com.cn编辑器">本文简要介绍一下pathlinkR的示例运行，想进一步了解的铁子可以阅读以下链接：</p><ul data-tool="markdown.com.cn编辑器"><li><section>https://github.com/hancockinformatics/pathlinkR</section></li><li><section>https://hancockinformatics.github.io/pathlinkR/</section></li></ul><h3 data-tool="markdown.com.cn编辑器"><span></span><span>R包安装与示例数据</span><span></span></h3><p data-tool="markdown.com.cn编辑器">该软件包中提供了一个基因差异表达结果的示例数据集，即对象<code>exampleDESeqResults</code>。这是一个由2个数据框组成的列表，是使用软件包DESeq2中的<code>results()</code>函数生成的。数据来自一项RNA-Seq研究，该研究调查了COVID-19和非 COVID-19 败血症患者在入院时（T1）与在重症监护室约一周后（T2）的情况，并进行了时间比较（即T2 vs T1）。</p><p data-tool="markdown.com.cn编辑器">可以使用以下代码安装引用R包，并加载示例数据集：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code><span># We'll also be using some functions from dplyr</span><br><span># BiocManager::install("pathlinkR")</span><br><span>library</span>(dplyr)<br><span>library</span>(pathlinkR)<br><br><span>## A quick look at the DESeq2 results table</span><br>data(<span>"exampleDESeqResults"</span>)<br>knitr::kable(head(exampleDESeqResults[[<span>1</span>]]))<br><span># baseMean log2FoldChange lfcSE stat pvalue padj</span><br><span>#ENSG00000000938 16292.64814 -0.5624954 0.1458274 -3.857268 0.0001147 0.0013531</span><br><span>#ENSG00000002586 1719.51750 0.4501181 0.1520122 2.961066 0.0030658 0.0153820</span><br><span>#ENSG00000002919 870.64168 -0.2445729 0.1249293 -1.957690 0.0502664 0.1236844</span><br><span>#ENSG00000002933 266.65476 0.8838310 0.2093628 4.221528 0.0000243 0.0004313</span><br><span>#ENSG00000003249 11.43282 1.3287128 0.2881385 4.611369 0.0000040 0.0001200</span><br><span>#ENSG00000003509 207.88545 -0.1825614 0.1763556 -1.035189 0.3005807 0.4453252</span><br></code></pre><p data-tool="markdown.com.cn编辑器">此外，该包还包含了一个使用通路富集软件包Sigora，基于Reactome数据库的富集结果注释。有关Reactome通路和Sigora软件包的更多信息，可以参阅等会的通路富集部分。</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data(<span>"sigoraDatabase"</span>)<br>head(sigoraDatabase)<br><span># A tibble: 6 × 4</span><br><span>#  pathwayId     pathwayName                                      ensemblGeneId   hgncSymbol</span><br><span>#  &lt;chr&gt;         &lt;chr&gt;                                            &lt;chr&gt;           &lt;chr&gt;     </span><br><span>#1 R-HSA-114608  "Platelet degranulation "                        ENSG00000121410 A1BG      </span><br><span>#2 R-HSA-6798695 "Neutrophil degranulation"                       ENSG00000121410 A1BG      </span><br><span>#3 R-HSA-76002   "Platelet activation, signaling and aggregation" ENSG00000121410 A1BG      </span><br><span>#4 R-HSA-76005   "Response to elevated platelet cytosolic Ca2+"   ENSG00000121410 A1BG      </span><br><span>#5 R-HSA-156580  "Phase II - Conjugation of compounds"            ENSG00000156006 NAT2      </span><br><span>#6 R-HSA-211859  "Biological oxidations"                          ENSG00000156006 NAT2  </span><br></code></pre><h3 data-tool="markdown.com.cn编辑器"><span></span><span>pathlinkR使用</span><span></span></h3><h5 data-tool="markdown.com.cn编辑器"><span></span>① 火山图:<span></span></h5><pre data-tool="markdown.com.cn编辑器"><span></span><code>eruption(<br>    rnaseqResult=exampleDESeqResults[[<span>1</span>]],<br>    title=names(exampleDESeqResults[<span>1</span>])<br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011095" data-ratio="0.6199770378874856" data-s="300,640" data-type="png" data-w="871" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNIoQDy23nskkSPX3iczTIN4Kj1MvXaCSyrs9WdaB8MQe0vDfS0O3ia9qQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNIoQDy23nskkSPX3iczTIN4Kj1MvXaCSyrs9WdaB8MQe0vDfS0O3ia9qQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器"><code>eruption</code>函数支持多种参数。比如，我们也可以指定高亮某些基因：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data(<span>"sigoraDatabase"</span>)<br>interferonGenes &lt;- sigoraDatabase %&gt;% <br>    filter(pathwayName == <span>"Interferon Signaling"</span>) %&gt;% <br>    pull(ensemblGeneId)<br><br>eruption(<br>    rnaseqResult=exampleDESeqResults[[<span>1</span>]],<br>    title=names(exampleDESeqResults[<span>1</span>]),<br>    highlightGenes=interferonGenes,<br>    highlightName=<span>"Interferon genes (red)"</span>,<br>    label=<span>"highlight"</span>,<br>    nonlog2=<span>TRUE</span>,<br>    n=<span>10</span><br>)<br></code></pre><p data-tool="markdown.com.cn编辑器">上方参数达成的效果是：</p><ul data-tool="markdown.com.cn编辑器"><li><section>突出干扰素基因并简要说明</section></li><li><section>将x轴从log2FC转换为非log2FC</section></li><li><section>仅标出属于干扰素通路的前 10 个上调和下调基因</section></li></ul><p><img data-galleryid="" data-imgfileid="100011096" data-ratio="0.6215909090909091" data-s="300,640" data-type="png" data-w="880" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNIvogzv5ULjhCydQYTTNwPTORrrUKXxyicQxsiaomWV44YjzYsAw6nCiaQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNIvogzv5ULjhCydQYTTNwPTORrrUKXxyicQxsiaomWV44YjzYsAw6nCiaQ/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="markdown.com.cn编辑器"><span></span>② 热图：<span></span></h5><p data-tool="markdown.com.cn编辑器">除了创建火山图外，可以使用参与特定通路（例如通过<code>pathwayEnrichment()</code>函数确定为重要的通路）的基因热图来可视化 DEGs。函数<code>plotFoldChange()</code>通过接收<code>DESeq2::results()</code>的输入列表并创建组成基因的FC (Fold Chage)热图来实现这一目的。</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>plotFoldChange(<br>    exampleDESeqResults,<br>    pathName=<span>"Interferon alpha/beta signaling"</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011097" data-ratio="1.2306818181818182" data-s="300,640" data-type="png" data-w="880" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNlOcIoxTJQvQ1HV9A0MvagkhftnPmxCQVpfo9RQpIp5WLIen0icMqE7g/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNlOcIoxTJQvQ1HV9A0MvagkhftnPmxCQVpfo9RQpIp5WLIen0icMqE7g/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器">另一个例子使用了更多参数，定制化程度更高：</p><ul data-tool="markdown.com.cn编辑器"><li><section>缩短每次比较的名称</section></li><li><section>提供可视化基因的自定义列表，并添加内容丰富的标题</section></li><li><section>在热图单元中使用log2FC</section></li><li><section>交换默认的行和列，并在行之间添加分割（比较）</section></li></ul><pre data-tool="markdown.com.cn编辑器"><span></span><code>exampleDESeqResultsRenamed &lt;- setNames(<br>    exampleDESeqResults,<br>    c("Pos", "Neg")<br>)<br><br>plotFoldChange(<br>    exampleDESeqResultsRenamed,<br>    manualTitle="Signature genes",<br>    genesToPlot=c("CD4", "CD8A","CD8B", "CD28", "ZAP70"),<br>    geneFormat="hgnc",<br>    colSplit=c("Pos", "Neg"),<br>    log2FoldChange=TRUE,<br>    colAngle=45,<br>    clusterRows=FALSE,<br>    clusterColumns=TRUE,<br>    invert=TRUE<br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011098" data-ratio="0.6238716148445336" data-s="300,640" data-type="png" data-w="997" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN1QEXvRTvK74R928wm8LDmdIG0Xak2icdknM4VsxBYPxCGenaqHoib9Ug/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN1QEXvRTvK74R928wm8LDmdIG0Xak2icdknM4VsxBYPxCGenaqHoib9Ug/640?wx_fmt=png&amp;from=appmsg"></section><h5 data-tool="markdown.com.cn编辑器"><span></span>③ 构建和可视化PPI网络：<span></span></h5><p data-tool="markdown.com.cn编辑器">pathlinkR包含用于构建和可视化蛋白质-蛋白质相互作用（PPI）网络的工具。<strong>在这里，利用从InnateDB收集到的PPI数据，生成基因表达分析中发现的DE基因之间的相互作用列表。</strong>可以继续观察COVID阳性患者的DEGs随时间变化的情况，利用显著的DEGs构建PPI网络。由于输入的数据包括所有测量基因，因此需要使用<code>filterInput=TRUE</code>选项来确保只使用通过标准阈值的基因来构建网络。此外，还可以通过指定<code>fillType="foldChange"</code>来为节点着色，以指示其失调的方向（即上调或下调）。</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>exNetwork &lt;- ppiBuildNetwork(<br>    rnaseqResult=exampleDESeqResults[[<span>1</span>]],<br>    filterInput=<span>TRUE</span>,<br>    order=<span>"zero"</span><br>)<br><br>ppiPlotNetwork(<br>    network=exNetwork,<br>    title=names(exampleDESeqResults)[<span>1</span>],<br>    fillColumn=LogFoldChange,<br>    fillType=<span>"foldChange"</span>,<br>    label=<span>TRUE</span>,<br>    labelColumn=hgncSymbol,<br>    legend=<span>TRUE</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011100" data-ratio="0.805" data-s="300,640" data-type="png" data-w="1000" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN3HYfma0j222ib5sAJtN38rE0lIQ4gk5fjyE4RAVviaELT0pgQiavgN2Fw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN3HYfma0j222ib5sAJtN38rE0lIQ4gk5fjyE4RAVviaELT0pgQiavgN2Fw/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器">带有蓝色标签的节点（如 STAT1、FBXO6、CDH1 等）是网络中的枢纽，即具有较高BC分值的基因。用于确定中心节点的统计量可在<code>ppiBuildNetwork()</code>中使用<code>hubMeasure</code>选项进行设置。</p><p data-tool="markdown.com.cn编辑器">随后还对这个标准网络进行一些调整。<code>ppiBuildNetwork()</code>的输出是一个tidygraph对象，这意味着可以使用一套<code>dplyr</code>函数来进行调整。比如，添加一列来表示<code>DEG</code>是否来自干扰素通路（如上定义），并只突出显示这些基因:</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>exNetworkInterferon &lt;- mutate(<br>    exNetwork,<br>    isInterferon = if_else(name %<span>in</span>% interferonGenes, <span>"y"</span>, <span>"n"</span>)<br>)<br><br>ppiPlotNetwork(<br>    network=exNetworkInterferon,<br>    title=names(exampleDESeqResults)[<span>1</span>],<br>    fillColumn=isInterferon,<br>    fillType=<span>"categorical"</span>,<br>    catFillColours=c(<span>"y"</span>=<span>"red"</span>, <span>"n"</span>=<span>"grey"</span>),<br>    label=<span>TRUE</span>,<br>    labelColumn=hgncSymbol,<br>    legend=<span>TRUE</span>,<br>    legendTitle=<span>"Interferon\ngenes"</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011102" data-ratio="0.6262729124236253" data-s="300,640" data-type="png" data-w="982" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNu4nCa4T3wpSBeU7mgAN8j9icYicrNzLSQWUg1UEl888EPIrDqp6UjtOg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNu4nCa4T3wpSBeU7mgAN8j9icYicrNzLSQWUg1UEl888EPIrDqp6UjtOg/640?wx_fmt=png&amp;from=appmsg"></section><h5 data-tool="markdown.com.cn编辑器"><span></span>④ ppi的网络富集：<span></span></h5><p data-tool="markdown.com.cn编辑器">pathlinkR包含两个函数用于进一步分析PPI网络。首先，<code>ppiEnrichNetwork()</code>将使用网络中的节点富集的Reactome通路或Hallmark基因集（有关于富集的详细内容可以参照下一节）：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>exNetworkPathways &lt;- ppiEnrichNetwork(<br>    network=exNetwork, <br>    analysis=<span>"hallmark"</span>,<br>    filterResults=<span>"default"</span>,<br>    geneUniverse = rownames(exampleDESeqResults[[<span>1</span>]])<br>)<br>exNetworkPathways<br><span># A tibble: 5 × 10</span><br><span>#  pathwayId           pathwayName  pValue pValueAdjusted genes numCandidateGenes</span><br><span>#  &lt;chr&gt;               &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;</span><br><span>#1 INTERFERON GAMMA R… INTERFERON… 1.68e-7     0.00000791 HLA-…                45</span><br><span>#2 INTERFERON ALPHA R… INTERFERON… 2.20e-6     0.0000518  IRF7…                30</span><br><span>#3 TNFA SIGNALING VIA… TNFA SIGNA… 3.58e-5     0.000560   CEBP…                32</span><br><span>#4 APOPTOSIS           APOPTOSIS   1.01e-3     0.0118     CASP…                21</span><br><span>#5 INFLAMMATORY RESPO… INFLAMMATO… 1.98e-3     0.0186     MXD1…                28</span><br><span># ℹ 4 more variables: numBgGenes &lt;dbl&gt;, geneRatio &lt;dbl&gt;, totalGenes &lt;int&gt;,</span><br><span>#   topLevelPathway &lt;chr&gt;</span><br></code></pre><p data-tool="markdown.com.cn编辑器">随后，函数<code>ppiExtractSubnetwork()</code>可以从起始网络中提取最小连接的子网络，并将富集通路中的基因作为提取的 "起始 "节点。例如，下面使用上述Hallmark富集的结果，从 "干扰素γ反应 "项中提取出一个由基因组成的子网络，然后绘制这个缩小的网络，同时突出显示通路中的基因：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>exSubnetwork &lt;- ppiExtractSubnetwork(<br>    network=exNetwork,<br>    pathwayEnrichmentResult=exNetworkPathways,<br>    pathwayToExtract=<span>"INTERFERON GAMMA RESPONSE"</span><br>)<br><br>ppiPlotNetwork(<br>    network=exSubnetwork,<br>    fillType=<span>"oneSided"</span>,<br>    fillColumn=degree,<br>    label=<span>TRUE</span>,<br>    labelColumn=hgncSymbol,<br>    legendTitle = <span>"Degree"</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011103" data-ratio="0.6247484909456741" data-s="300,640" data-type="png" data-w="994" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN1BIcr1lmKdd2ejUvCDBFy4VWqeJQZk4Sh2ECd5Fsw2NYSbFTtxq4UQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKN1BIcr1lmKdd2ejUvCDBFy4VWqeJQZk4Sh2ECd5Fsw2NYSbFTtxq4UQ/640?wx_fmt=png&amp;from=appmsg"></section><h5 data-tool="markdown.com.cn编辑器"><span></span>⑤ 进行通路富集：<span></span></h5><p data-tool="markdown.com.cn编辑器">路径富集分析的核心是过度代表性分析(over-representation)，即在我们关注的差异表达基因（DEG）列表中，属于特定通路的基因是否比预期出现得更多。简单来说，这种分析通过比较通路中DEG的比例和数据库中所有基因的比例来实现。<code>pathlinkR</code>主要使用 Reactome 数据库来完成这一分析。<strong>然而，这种方法假设每个基因在每条通路中的作用是“均等”的，忽视了基因可能在多个通路中发挥不同作用的问题。</strong>这会导致结果中出现大量相似的通路，或与生物学不相关的“假阳性”通路，增加了解读结果的难度。</p><p data-tool="markdown.com.cn编辑器">为了解决这一问题，pathlinkR使用了Sigora提出的一种基于唯一基因对的方法，可以减少因多功能基因而导致的通路重叠，聚焦于与生物学现象更相关的通路。pathlinkR的<code>pathwayEnrichment()</code>函数默认采用这种方法，并可选择<code>fgsea</code>包实现的基因集富集分析，同时支持Reactome和Hallmark数据集。<code>pathwayEnrichment()</code>函数以多个<code>DESeq2::results()</code>数据框作为输入，默认按上调和下调基因进行富集分析。对于<code>analysis="sigora"</code>的选项，还需要提供基因对签名库（GPS repository），默认使用来自Sigora的Reactome库:</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>enrichedResultsSigora &lt;- pathwayEnrichment(<br>    inputList=exampleDESeqResults,<br>    analysis=<span>"sigora"</span>,<br>    filterInput=<span>TRUE</span>,<br>    gpsRepo=<span>"default"</span><br>)<br><br>head(enrichedResultsSigora)<br><span># A tibble: 6 × 12</span><br><span>#  comparison       direction pathwayId pathwayName   pValue pValueAdjusted genes</span><br><span>#  &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;     &lt;fct&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;</span><br><span>#1 COVID Pos Over … Up        R-HSA-38… Chemokine … 7.04e-46       7.05e-43 CCR3…</span><br><span>#2 COVID Pos Over … Up        R-HSA-19… Immunoregu… 5.46e-45       5.46e-42 CD1A…</span><br><span>#3 COVID Pos Over … Up        R-HSA-38… Costimulat… 2.56e-40       2.56e-37 CD28…</span><br><span>#4 COVID Pos Over … Up        R-HSA-67… Neutrophil… 7.88e-31       7.89e-28 ABCA…</span><br><span>#5 COVID Pos Over … Up        R-HSA-20… Cell surfa… 3.55e-21       3.55e-18 ATP1…</span><br><span>#6 COVID Pos Over … Up        R-HSA-14… Alpha-defe… 1.02e-20       1.02e-17 CD4;…</span><br><span># ℹ 5 more variables: numCandidateGenes &lt;dbl&gt;, numBgGenes &lt;int&gt;,</span><br><span>#   geneRatio &lt;dbl&gt;, totalGenes &lt;int&gt;, topLevelPathway &lt;chr&gt;</span><br></code></pre><p data-tool="markdown.com.cn编辑器">注意上面的direction是分开的，也就是上调基因、下调基因单独富集。如果想同时测试上调基因和下调基因，只需设置<code>split=FALSE</code>参数。</p><p data-tool="markdown.com.cn编辑器">对于那些仍然偏好传统过度表现分析的人，作者也提供了参数<code>analysis="reactomepa"</code>，使用基于余光创老师开发的ReactomePA包进行富集：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data(<span>"mappingFile"</span>)<br>exGeneUniverse &lt;- mappingFile %&gt;% <br>    filter(ensemblGeneId %<span>in</span>% rownames(exampleDESeqResults[[<span>1</span>]])) %&gt;% <br>    pull(entrezGeneId)<br><br>enrichedResultsRpa &lt;- pathwayEnrichment(<br>    inputList=exampleDESeqResults,<br>    analysis=<span>"reactomepa"</span>,<br>    filterInput=<span>TRUE</span>,<br>    split=<span>TRUE</span>,<br>    geneUniverse=exGeneUniverse<br>)<br><br>head(enrichedResultsRpa)<br><span># A tibble: 6 × 12</span><br><span>#  comparison       direction pathwayId pathwayName   pValue pValueAdjusted genes</span><br><span>#  &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;</span><br><span>#1 COVID Pos Over … Up        R-HSA-20… Generation… 3.63e-10    0.000000219 PLCG…</span><br><span>#2 COVID Pos Over … Up        R-HSA-20… Translocat… 1.51e- 9    0.000000302 HLA-…</span><br><span>#3 COVID Pos Over … Up        R-HSA-38… PD-1 signa… 1.51e- 9    0.000000302 HLA-…</span><br><span>#4 COVID Pos Over … Up        R-HSA-20… Phosphoryl… 1.22e- 7    0.0000184   HLA-…</span><br><span>#5 COVID Pos Over … Up        R-HSA-38… Costimulat… 1.22e- 6    0.000146    CD28…</span><br><span>#6 COVID Pos Over … Up        R-HSA-20… TCR signal… 3.61e- 6    0.000321    PLCG…</span><br><span># ℹ 5 more variables: numCandidateGenes &lt;dbl&gt;, numBgGenes &lt;dbl&gt;,</span><br><span>#   geneRatio &lt;dbl&gt;, totalGenes &lt;int&gt;, topLevelPathway &lt;chr&gt;</span><br></code></pre><p data-tool="markdown.com.cn编辑器">富集结果可以通过以下代码进行可视化（想了解更多参数可以看看官网）：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>pathwayPlots(<br>    pathwayEnrichmentResults=enrichedResultsSigora, <br>    columns=<span>2</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011104" data-ratio="0.8506559031281534" data-s="300,640" data-type="png" data-w="991" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNicjoVVeWJfH6cT8FudiczR9SXe1y4XbCFymBTUcmoOxLMpddWvg7jEhg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNicjoVVeWJfH6cT8FudiczR9SXe1y4XbCFymBTUcmoOxLMpddWvg7jEhg/640?wx_fmt=png&amp;from=appmsg"></section><h5 data-tool="markdown.com.cn编辑器"><span></span>⑥ 根据富集结果生成网络<span></span></h5><p data-tool="markdown.com.cn编辑器">pathlinkR包括将基于Reactome 方法（"sigora "或 "reactomepa"）的通路富集结果转化为网络的功能，利用分配给每个通路的基因的重叠性来确定它们之间的相似性。在这些网络中，每条通路都是一个节点，它们之间的连接或边缘是通过距离度量确定的。可以设置一个阈值，将具有最小相似度的两条途径视为相连，并在它们的节点之间画一条边。<strong>默认情况下，该包提供了一个预先计算的Reactome通路距离矩阵，该矩阵是使用 Jaccard 距离生成的，但也支持使用多种距离度量</strong>。一旦创建了通路相互作用的 "基础"，就可以使用<code>createPathnet</code>函数构建通路网络：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>data(<span>"sigoraExamples"</span>) <span># 加载富集结果</span><br>pathwayDistancesJaccard &lt;- getPathwayDistances(pathwayData = sigoraDatabase)<br><br>startingPathways &lt;- pathnetFoundation(<br>    mat=pathwayDistancesJaccard,<br>    maxDistance=<span>0.8</span><br>)<br><br><span># Get the enriched pathways from the "COVID Pos Over Time" comparison</span><br>exPathwayNetworkInput &lt;- sigoraExamples %&gt;% <br>    filter(comparison == <span>"COVID Pos Over Time"</span>)<br><br>myPathwayNetwork &lt;- pathnetCreate(<br>    pathwayEnrichmentResult=exPathwayNetworkInput,<br>    foundation=startingPathways<br>)<br></code></pre><p data-tool="markdown.com.cn编辑器">随后可以使用两种方案可视化，第一种是静态网络：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>pathnetGGraph(<br>    myPathwayNetwork,<br>    labelProp=<span>0.1</span>,<br>    nodeLabelSize=<span>4</span>,<br>    nodeLabelOverlaps=<span>8</span>,<br>    segColour=<span>"red"</span><br>)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011106" data-ratio="0.6990740740740741" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNT00aAs22vqUofhtVpA6nwFUdNL6mTgnqvSzmhczZgOFsDKS5ZCUXtA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNT00aAs22vqUofhtVpA6nwFUdNL6mTgnqvSzmhczZgOFsDKS5ZCUXtA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="markdown.com.cn编辑器">第二种是交互式网络：</p><pre data-tool="markdown.com.cn编辑器"><span></span><code>pathnetVisNetwork(myPathwayNetwork)<br></code></pre><section><img data-galleryid="" data-imgfileid="100011105" data-ratio="0.6657407407407407" data-s="300,640" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNjBMYciaWq0YIG2Vo4ojRZQyMjl50aSQribAgoQlN3Uw8ibaq6zxEvgtow/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/sz_mmbiz_png/LvUIqvYKCeVbKeVUqZdWqjXvy2PfEhKNjBMYciaWq0YIG2Vo4ojRZQyMjl50aSQribAgoQlN3Uw8ibaq6zxEvgtow/640?wx_fmt=png&amp;from=appmsg"></section><section>最后，可以使用以下代码在生成通路网络信息时只使用 DEGs：</section><pre data-tool="markdown.com.cn编辑器"><span></span><code>candidateData &lt;- sigoraExamples %&gt;%<br>    filter(comparison == <span>"COVID Pos Over Time"</span>) %&gt;% <br>    select(pathwayId, genes) %&gt;%<br>    tidyr::separate_rows(genes, sep=<span>";"</span>) %&gt;%<br>    left_join(<br>        sigoraDatabase,<br>        by=c(<span>"pathwayId"</span>, <span>"genes"</span> = <span>"hgncSymbol"</span>),<br>        multiple=<span>"all"</span><br>    ) %&gt;%<br>    relocate(pathwayId, ensemblGeneId, <span>"hgncSymbol"</span>=genes, pathwayName) %&gt;%<br>    distinct()<br><br><span>## Now that we have a smaller table in the same format as sigoraDatabase, we</span><br><span>## can construct our own matrix of pathway distances</span><br>candidateDistData &lt;- getPathwayDistances(<br>    pathwayData=candidateData,<br>    distMethod=<span>"jaccard"</span><br>)<br><br>candidateStartingPathways &lt;- pathnetFoundation(<br>    mat=candidateDistData,<br>    maxDistance=<span>0.9</span><br>)<br><br>candidatesAsNetwork &lt;- pathnetCreate(<br>    pathwayEnrichmentResult=filter(<br>        sigoraExamples, <br>        comparison == <span>"COVID Pos Over Time"</span><br>    ),<br>    foundation=candidateStartingPathways,<br>    trim=<span>FALSE</span><br>)<br><span># </span><br>pathnetGGraph(<br>    myPathwayNetwork,<br>    labelProp=<span>0.1</span>,<br>    nodeLabelSize=<span>4</span>,<br>    nodeLabelOverlaps=<span>8</span>,<br>    segColour=<span>"red"</span><br>)<br></code></pre><section><strong><span>简单分享到这</span></strong><strong><span></span></strong></section><section><strong><span><strong><span><span><strong><span>各位佬哥佬姐关注起来 </span></strong><strong><span><img data-ratio="1" data-w="128" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Yellowdog.png" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/Yellowdog.png"><img data-ratio="1" data-w="128" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/smiley_83b.png" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/v1.3.10/assets/newemoji/smiley_83b.png"></span></strong></span></span></strong></span></strong></section><section><mp-common-profile data-id="MzkyNTIzMzYyMA==" data-pluginname="mpprofile" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/LvUIqvYKCeXYZNMxRMnjiaicO2a27jDZ2FgQga8TdeQcsGRJRIn2IInkKtfcbbMXOBSViaPXpTOBulUlNzd11pzow/0?wx_fmt=png" data-nickname="生信碱移" data-alias="liudoufu307" data-signature="春来秋至，分享我的所见与所识" data-from="2" data-weuitheme="light"></mp-common-profile></section><section><br></section><section><strong><span>END~</span></strong><br></section><p><span><strong>仅供粉丝老铁们参考</strong></span><strong></strong></p><p><strong>如有侵权或错误，请联系删除改正～</strong></p><p><br></p><section data-class="_mbEditor" data-id="32689"><section><section><section><p><span><strong mpa-from-tpl="t">推荐好文，点击查看:</strong></span></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTIzMzYyMA==&amp;mid=2247494500&amp;idx=1&amp;sn=f8b9899be8a729975a2626edb2d8b9d7&amp;chksm=c1cb13dff6bc9ac9c3e5b0e51e3553eae52032f3838ba29ff97aacf7d29bd5b6271521d34512&amp;scene=21#wechat_redirect" textvalue="【教程】一文读懂孟德‍尔随机化！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">【教程】一文读懂！NHANES数据库入门级教程</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTIzMzYyMA==&amp;mid=2247494562&amp;idx=1&amp;sn=20ab1c2c80cb7b5b2a8b49a0bb0a4b40&amp;chksm=c1cb1319f6bc9a0fc71379139522d0ccc70589da77ee0ab8a389ff87ac2aa255a2b10185806a&amp;scene=21#wechat_redirect" textvalue="【工具‍】单细胞密度算法，绝哥！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>【工具】NBT: 单细胞可解释张量分解算法sclTD！</span></a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTIzMzYyMA==&amp;mid=2247494365&amp;idx=1&amp;sn=1d840424ddc223f4756636ebae7eea6d&amp;chksm=c1cb1266f6bc9b704a4567cac832ea23118c70675607d1da523834c84473a9b60cec3d55f143&amp;scene=21#wechat_redirect" textvalue="‍【文献】这篇顶刊" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">【文献】这篇顶刊纯生信领先常规生信分析一个版本！</a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkyNTIzMzYyMA==&amp;mid=2247494690&amp;idx=1&amp;sn=ed3862abf2eb9c37e2cdf445d7c2bcac&amp;chksm=c1cb1499f6bc9d8fe71841453e92036b3a78871428cedf3ecb56935a51bbfbe4ba67c47a0ff1&amp;scene=21#wechat_redirect" textvalue="【期刊】无版面费低分 SCI 期刊，近期发表多‍篇纯网药研究！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>【期刊】</span></a><span>审稿速度快！</span><span>影响因子5分，中科院三区，无版面费生信友好期刊！</span></p></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Qwc9UJIewSjsWYKlDbFGcg",target="_blank" rel="noopener noreferrer">原文链接</a>
