---
title: "玩转服务器4—服务器间数据传输"
date: 2024-11-13T13:53:39Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
玩转服务器4—服务器间数据传输 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6">滴水穿石 非一日之功</strong></p></section></section></section></section></section></section></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">随着单细胞的火热，我们的共享服务器也进行了对应的升级迭代，从早期的96线程512G内存到如今的256线程2T内存【<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247520503&amp;idx=2&amp;sn=375db3093ce4345b66739a37993458ff&amp;chksm=fa4555cacd32dcdc9a5d59d914707bea9acea34fd6bfebbccdd33992243502824d58ba93224c&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a>】，可以说是加量不加价。由于我们的共享服务器广受好评，其中有不少用户有多个账号，或者在早期账号到期后，选择新开账号。这时候常常面临的问题就是旧账号数据需要拷贝到新账号，或者多个账号之间互相传输数据。一些用户选择先下载数据到自己的硬盘，然后再上传到新账号，其实这是非常低效的一个方法。那么如何更快速方便的实现自己账号间数据的传输呢？这时候我们就需要用到 <code>scp</code> 命令了。</p><h2 data-tool="mdnice编辑器"><span></span><span>背景知识</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>scp</span><span></span></h3><p data-tool="mdnice编辑器"><code>scp</code>（Secure Copy Protocol）是Linux系统中的一个命令行工具，用于通过SSH协议在本地和远程主机之间安全传输文件。它的工作方式类似于<code>cp</code>命令，但具有加密功能，能够保证数据在传输过程中的安全性。</p><p data-tool="mdnice编辑器"><strong>基本语法</strong></p><pre data-tool="mdnice编辑器"><span></span><code>scp [选项] source_file target_file<br></code></pre><ul data-tool="mdnice编辑器"><li><section><code>source_file</code>：要传输的源文件路径，可以是本地文件，也可以是远程主机上的文件。</section></li><li><section><code>target_file</code>：文件传输的目标路径，可以是本地路径，也可以是远程主机上的路径。</section></li></ul><p data-tool="mdnice编辑器"><strong>常用选项</strong></p><ul data-tool="mdnice编辑器"><li><section><code>-P</code>：指定远程主机的SSH端口（默认是22）。</section></li><li><section><code>-r</code>：递归复制整个目录，适合传输文件夹。</section></li><li><section><code>-C</code>：在传输过程中启用压缩，有助于提高传输速度。</section></li><li><section><code>-i</code>：指定身份验证的私钥文件，常用于基于密钥的认证方式。</section></li><li><section><code>-l</code>：限制传输带宽，以防止占用过多的网络资源。</section></li></ul><p data-tool="mdnice编辑器"><strong>基本使用方式</strong></p><ol data-tool="mdnice编辑器"><li><section><strong>从本地复制到远程</strong>:</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>scp /path/to/<span>local</span>/file username@remotehost:/path/to/remote/directory<br></code></pre><p data-tool="mdnice编辑器">在这个例子中，命令会将本地的文件复制到远程主机的指定目录下。</p><ol start="2" data-tool="mdnice编辑器"><li><section><strong>从远程复制到本地</strong>:</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>scp username@remotehost:/path/to/remote/file /path/to/<span>local</span>/directory<br></code></pre><p data-tool="mdnice编辑器">在这个例子中，命令会将远程主机的文件复制到本地的指定目录下。</p><ol start="3" data-tool="mdnice编辑器"><li><section><strong>复制目录</strong>:要复制整个目录，可以使用 <code>-r</code> 选项：</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>scp -r /path/to/<span>local</span>/directory username@remotehost:/path/to/remote/directory<br></code></pre><p data-tool="mdnice编辑器">在这个例子中，命令会将本地的目录及其所有内容复制到远程主机的指定目录下。</p><ol start="4" data-tool="mdnice编辑器"><li><section><strong>指定端口</strong>:如果远程主机的SSH服务不是运行在默认的22端口上，可以使用 <code>-P</code> 选项来指定端口：</section></li></ol><pre data-tool="mdnice编辑器"><span></span><code>scp -P port /path/to/<span>local</span>/file username@remotehost:/path/to/remote/directory<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>具体演示</span><span></span></h2><p data-tool="mdnice编辑器">了解了 <code>scp</code> 命令，那么具体到我们的服务器上，该如何操作。</p><p data-tool="mdnice编辑器">我们的共享服务器一般都是通过域名登录的，这个时候你有两个选择，一是通过内网传输（建议）、二是通过外网传输（不建议）</p><h3 data-tool="mdnice编辑器"><span></span><span>scp 内网传输</span><span></span></h3><p data-tool="mdnice编辑器"><strong>从账号2（t020559）拷贝文件/文件夹到账号1（t160560）</strong></p><p data-tool="mdnice编辑器">首先查看账号1所在服务器的内网ip地址，可以使用 <code>ifconfig</code>  或者 <code>ip</code> 命令实现</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100045094" data-ratio="1.1027777777777779" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibStX7pvyxeALBezJnhwjxWb351D6QliaR6fOkokVYSAUEZoxsA6FoAQw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibStX7pvyxeALBezJnhwjxWb351D6QliaR6fOkokVYSAUEZoxsA6FoAQw/640?wx_fmt=png&amp;from=appmsg"><figcaption>ifconfig命令查看</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100045092" data-ratio="0.3453703703703704" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibkKNFWIFyZwxPGZdibpPqBgjuTzGMr70b0NPCaoRuSp6ks04Z3rbykgA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibkKNFWIFyZwxPGZdibpPqBgjuTzGMr70b0NPCaoRuSp6ks04Z3rbykgA/640?wx_fmt=png&amp;from=appmsg"><figcaption>ip命令查看</figcaption></figure><p data-tool="mdnice编辑器">然后在账户2执行命令：<code>scp -r  需要拷贝的文件 账号1@服务器ip地址:/home/data/usrename/目标目录</code></p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span>#传输文件</span></span><br>scp GRCh38.p14.genome.fa t160560@10.10.11.80:/home/data/t160560/ref<br><span>#</span><span><span>#传输整个文件夹</span></span><br>scp -r refdata-gex-GRCh38-2020-A t160560@10.10.11.80:/home/data/t160560/ref<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100045095" data-ratio="0.2972222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibIHAflEw2micZ1102gxc3Thic64oNBvNGcIHHOzLxSaJDU3TfhEriamlsw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibIHAflEw2micZ1102gxc3Thic64oNBvNGcIHHOzLxSaJDU3TfhEriamlsw/640?wx_fmt=png&amp;from=appmsg"><figcaption>t020559上传数据到t160560</figcaption></figure><p data-tool="mdnice编辑器">如果文件非常大，建议放到后台传输，避免中断。比如使用<code>screen</code></p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span>#创建一个screen会话</span></span><br>screen -R share<br><span><br>#</span><span><span>#然后再执行传输命令</span></span><br>scp -r refdata-gex-GRCh38-2020-A t160560@10.10.11.80:/home/data/t160560/ref<br><span><br>#</span><span><span># 退出会话</span></span><br>ctrl+a+d (快捷键)<br><span><br>#</span><span><span># 重新进入(恢复)之前创建的会话窗口</span></span><br>screen -r share<br></code></pre><p data-tool="mdnice编辑器">同理，如果需要从账号1(t160560)拷贝数据到账号2(t020559)，只需要调换一下主机前后位置即可  <code>scp -r 账号1@服务器ip地址:/home/data/usrename/需要拷贝的文件  /账号2/目标目录</code></p><pre data-tool="mdnice编辑器"><span></span><code>scp -r t160560@10.10.11.80:/home/data/t160560/updata   ~/tmp<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100045091" data-ratio="0.15925925925925927" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibshUgr2ggT1LpDhicEGgjicpPC8xKuZWJos6iaqIDE8ydnlkXPgrkWedhA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibshUgr2ggT1LpDhicEGgjicpPC8xKuZWJos6iaqIDE8ydnlkXPgrkWedhA/640?wx_fmt=png&amp;from=appmsg"><figcaption>从t160560下载数据到t020559</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>scp 外网传输</span><span></span></h3><p data-tool="mdnice编辑器">如果文件很小，其实也可以使用外网，进行服务器间传输（大文件不建议这么做，会占用整个服务器网速）</p><p data-tool="mdnice编辑器">走外网传输首先就是要搞清楚两个账号的域名和端口。ssh默认是运行在22号端口，但是我们的共享服务器均是设定了固定的端口，所以需要使用 <code>-P</code> 参数来指定端口</p><p data-tool="mdnice编辑器"><strong>从账号2（t020559）拷贝文件/文件夹到账号1（t160560）</strong></p><p data-tool="mdnice编辑器">在账号2执行命令：<code>scp -r -P 账号1端口号 /账号2/需拷贝的文件 账号1@biotrainee.cn:/home/data/username/目标目录</code></p><pre data-tool="mdnice编辑器"><span></span><code>scp -r -P 9941 gencode.v45.transcripts.fa   t160560@biotrainee.cn:/home/data/t160560/ref<br></code></pre><p data-tool="mdnice编辑器"><strong>从账号1（t160560）拷贝文件/文件夹到账号2（t020559）</strong></p><p data-tool="mdnice编辑器">同理，<code>scp -r -P 账号1@biotrainee.cn:/home/data/username/需拷贝的文件 /账号2/目标目录</code></p><pre data-tool="mdnice编辑器"><span></span><code>scp -P 9941 t160560@biotrainee.cn:/home/data/t160560/test_project/idmap1-master.zip   /home/data/t020559/tmp<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100045093" data-ratio="0.2814814814814815" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibHASRZeZYgu34sibxg2TVCIUMbmWXEN9AsiabWwyG67icX24FP58EMleicQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9TwutkickF8SiaypOGGxibzHibHASRZeZYgu34sibxg2TVCIUMbmWXEN9AsiabWwyG67icX24FP58EMleicQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>外网传输示例</figcaption></figure></section><blockquote><p>注意事项：</p><ul><li><section><code>scp</code>会覆盖目标目录中同名文件，因此在传输时需小心，一定要理解代码，清楚自己在做什么。</section></li><li><section>由于<code>scp</code>基于SSH，因此需要确保SSH服务在两台主机之间正常运行，并且用户拥有相应的权限。</section></li></ul><section><br></section><p>如果你也需要共享服务器，详见： <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247520503&amp;idx=2&amp;sn=375db3093ce4345b66739a37993458ff&amp;chksm=fa4555cacd32dcdc9a5d59d914707bea9acea34fd6bfebbccdd33992243502824d58ba93224c&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">2024的共享服务器交个朋友福利价仍然是800</a> 福利抢购方式</p><figure><img data-imgfileid="100045107" data-ratio="0.5534979423868313" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx8tiaCRKgw4nvUrrmkMN50Lu2zX5xYpB6nUhwI9QgLzzibaicXM5BPoUTc8HlmRyshUiczAyib6NMBPZw/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="972" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wx8tiaCRKgw4nvUrrmkMN50Lu2zX5xYpB6nUhwI9QgLzzibaicXM5BPoUTc8HlmRyshUiczAyib6NMBPZw/640?wx_fmt=other&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"><figcaption>还等什么呢，赶快扫描下面二维码添加微信抢购吧！</figcaption></figure></blockquote><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section><section powered-by="xmyeditor.com" data-md5="8b46d"><img data-imgfileid="100045090" data-ratio="0.6940298507462687" data-type="gif" data-w="134" data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section></section></section></section></section></section><p><span></span><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247517649&amp;idx=1&amp;sn=1db8e7f43d447ac77fa152b85e0ed0fe&amp;chksm=fa4540eccd32c9fad1df66c76d64f280da56cfc26120bd91924ddbd3611f4d6b01f1991f4700&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课11月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><strong>生信入门&amp;数据挖掘线上直播课11月班</strong></a><strong>，你的生物信息学入门课</strong></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>时隔5年，我们的生信技能树VIP学徒继续招生啦</strong></a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;chksm=9b4b2f10ac3ca606c1c4bac8cf112bb9b0f18e3c4262f5f2b8c0dba3bfedf2ba201507247005&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>2024的共享服务器交个朋友福利价仍然是800</strong></a><strong><span></span></strong></section></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/67BOEPOK0EV3_jiruCDIpA",target="_blank" rel="noopener noreferrer">原文链接</a>
