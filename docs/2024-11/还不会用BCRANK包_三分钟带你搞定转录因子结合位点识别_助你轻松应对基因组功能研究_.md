---
title: "还不会用BCRANK包？三分钟带你搞定转录因子结合位点识别，助你轻松应对基因组功能研究！"
date: 2024-11-23T14:10:11Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
还不会用BCRANK包？三分钟带你搞定转录因子结合位点识别，助你轻松应对基因组功能研究！ by R语言学徒
------
<div><p><img data-galleryid="" data-imgfileid="100011939" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEW1MImenDROfZvBdaU52v92yvD63bmIonEwzSbK1jyS1MNtwKRT3DZxqr7226nrqqXj39KTc2HKcw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEW1MImenDROfZvBdaU52v92yvD63bmIonEwzSbK1jyS1MNtwKRT3DZxqr7226nrqqXj39KTc2HKcw/640?wx_fmt=jpeg&amp;from=appmsg"></p><p><img data-imgfileid="100012001" data-ratio="0.22965641952983726" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyg4LK6C287nE3Trz2vicY5kVoPqhtrPfdAEBicA9ayPibAlQtoclFib5d2Q/640?wx_fmt=png" data-type="png" data-w="553" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyg4LK6C287nE3Trz2vicY5kVoPqhtrPfdAEBicA9ayPibAlQtoclFib5d2Q/640?wx_fmt=png"></p><p><span>有了 BCRANK包，轻松搞定TFBS 分析，如果同学们遇到任何生信问</span><span>题，随时来找小师妹讨论哦！</span></p><p><span>在本次学习中，我们将从 BCRANK 包的安装开始，逐步掌握如何用它预测 DNA 序列中的 motif，并学习如何可视化位权矩阵，以及如何定位与 motif 匹配的结合位点。通过实际操作，同学们将了解 BCRANK 的工作流程，掌握核心命令和常见分析步骤。相信通过今天的学习，同学们会更加熟练地使用 BCRANK 包，在基因组调控和生物信息学分析领域中迈出重要的一步！接下来，让我们一起开启 BCRANK 的学习之旅吧！</span><page></page></p><p><span>          <p> </p></span></p><p><span>本次介绍的R包在服务器上能更加流畅地运行，如果没有服务器，欢迎联系我们进行服务器租赁~</span></p><section><section><section><section><section><section><section><img data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="194" data-imgfileid="100012002" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEW1MImenDROfZvBdaU52v92SfreVJbLib3Px7pIoG7ZtjVMamM8iacZCD44AibwWAP5OLVxI6tyUhTZg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="396" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEW1MImenDROfZvBdaU52v92SfreVJbLib3Px7pIoG7ZtjVMamM8iacZCD44AibwWAP5OLVxI6tyUhTZg/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section><section><p><span><strong>定制生信分析</strong></span></p><p><span><strong>云服务器租赁</strong></span></p><p><strong>(加微信<span>备注99</span>领取试用)</strong></p></section></section></section></section></section></section></section><section><br><span></span></section><p><span>BCRANK包介绍</span><span></span></p><p><span><br></span></p><p><span>BCRANK 包用于识别基因组序列中的转录因子结合位点（TFBS）。它通过迭代算法优化从一组候选序列中提取的核苷酸序列模型，进而预测转录因子的潜在结合位点。BCRANK 包特别适用于处理长的或较复杂的序列。常用函数包括 bcrank（执行预测）、matchingSites（提取预测位点）等，能够方便地将结果进一步分析，如结合位点的序列、位置和评分。这个工具在生物信息学中广泛应用，帮助研究调控元件及其功能。</span></p><p><span>BCRANK包安装</span></p><p><span><br></span></p><p><span>需要R语言版本为4.4，在控制台中输入以下命令：</span></p><section><ul><li><li><li></ul><pre data-lang="php"><code><span><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))</span></code><code><span>    install.packages(<span>"BiocManager"</span>)</span></code><code><span>BiocManager::install(<span>"BCRANK"</span>) <span>#在BiocManager环境下安装BCRANK包</span></span></code></pre></section><p><span>查看是否安装成功：</span><page></page></p><section><ul><li></ul><pre data-lang="bash"><code><span>packageVersion(<span>"BCRANK"</span>) <span># 查看BCRANK版本</span></span></code></pre></section><p><span><img data-imgfileid="100011998" data-ratio="0.12244897959183673" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyLyTFSKIwAKcUExwbK0XIXqCDgYqiaa5CXbHxiaaAfvT99JbGwJFrxhfg/640?wx_fmt=png" data-type="png" data-w="1225" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyLyTFSKIwAKcUExwbK0XIXqCDgYqiaa5CXbHxiaaAfvT99JbGwJFrxhfg/640?wx_fmt=png"></span></p><p><span>显示为1.66.0版本，则表示已经安装了BCRANK包。</span></p><p><span>除此之外，后续示例还需要使用seqLogo包，我们可以提前安装，安装命令如下：</span></p><section><ul><li></ul><pre data-lang="php"><code><span>BiocManager::install(<span>"seqLogo"</span>) <span># 在BiocManager环境下安装seqLogo</span></span></code></pre></section><p><span>          <p> </p></span></p><p><span>使用BCRANK包识别给定DNA序列中的潜在转录因子结合位点</span></p><p><span><br></span></p><p><strong><span>本篇文章文章所使用的代码、示例数据或基因集等，关注公众号回复【666】获取哦~编号：241123</span></strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg5MDk3Mzg4OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/oCSOtP61aEVVCT8bjvGjvicxiaj3q39iaClXlQMVUcyTp0N2Jr5MX57B5mxKLt8W1YiaA7lEibyicLLicYAMJImkJQs4A/300?wx_fmt=png&amp;wxfrom=19" data-nickname="R语言学徒" data-alias="" data-signature="R语言学习从入门到精通，持续关注小师妹，每天更新R语言知识，生信干货内容。如需定制生信分析、服务器租赁，欢迎咨询小师妹" data-from="2" data-is_biz_ban="0" data-origin_num="281" data-isban="0" data-biz_account_status="0" data-index="0"></mp-common-profile></section><p><span><br></span></p><p><span>载入需要用到的包和数据</span></p><p><span><br></span></p><p><span>首先，我们需要载入本次学习的主角——BCRANK包，代码如下：</span></p><section><ul><li></ul><pre data-lang="bash"><code><span>library(BCRANK) <span># 载入BCRANK包</span></span></code></pre></section><p><span>除此之外，后续进行序列可视化还需要用到seqLogo包，我们可以提前载入：</span></p><section><ul><li></ul><pre data-lang="bash"><code><span>library(seqLogo) <span>#载入seqLogo包</span></span></code></pre></section><p><span>BCRANK包需要包含已排序序列的 FASTA 文件作为输入。本文中我们将采用从人类肝细胞系 HepG2 中进行全基因组 ChIP-chip 实验得到的 2500 个排序区域数据作为示例。</span></p><p><span>载入示例数据的命令如下：</span><page></page></p><section><ul><li></ul><pre data-lang="nginx"><code><span><span>fastaFile</span> &lt;- system.file(<span>"Exfiles/USF1_small.fa"</span>, package=<span>"BCRANK"</span>) <span># 加载示例 FASTA 文件，文件中包含从人类肝细胞系 HepG2 中的全基因组 ChIP-chip 实验中获得的 2500 个排序区域。</span></span></code></pre></section><p><span>使用bcrank（）函数预测DNA序列中的motif</span></p><p><span><br></span></p><p><span>载入示例数据后，我们就可以使用BCRANK包中的核心函数bcrank（）来预测DNA序列中的motif，在 DNA 中，motif 通常是一些短的核苷酸序列，它们与特定的生物功能相关，如转录因子识别和结合位点。代码如下:</span></p><section><ul><li><li></ul><pre data-lang="objectivec"><code><span>set.seed(<span>0</span>) <span># 设置随机数生成器种子，确保结果可重复</span></span></code><code><span>BCRANKout &lt;- bcrank(fastaFile, restarts=<span>25</span>, use.P1=<span>TRUE</span>, use.P2=<span>TRUE</span>) <span># 运行 BCRANK 算法，使用的输入文件是 fastaFile，restarts 参数设为 5，使用了 P1 和 P2 方法来优化 motif 发现过程</span></span></code></pre></section><p><span></span></p><p><span>运行时间可能较长，需要同学们耐心等待，如果希望预测的准确度提高，可以适当提高restarts 参数的值。</span></p><section><ul><li></ul><pre data-lang="nginx"><code><span><span>BCRANKout</span> <span># 运行结束后，显示 BCRANK 算法输出结果，列出了预测的前 5 个 DNA motif 及其得分</span></span></code></pre></section><p><span></span></p><p><span><img data-imgfileid="100011994" data-ratio="0.23457943925233646" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzybRy4zgloB1tZBs2sib4jO6JVDo4aZicibZ9Jtzr3FNgYuN0ia7WmoEXkTA/640?wx_fmt=png" data-type="png" data-w="1070" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzybRy4zgloB1tZBs2sib4jO6JVDo4aZicibZ9Jtzr3FNgYuN0ia7WmoEXkTA/640?wx_fmt=png"></span></p><p><span>结果如上图，显示了前5个DNA motif的得分，可知得分最高的motif为“GTCACGTG”序列</span><page></page></p><p><span>接下来我们可以把这个motif的预测结果提取出来进行可视化分析，代码如下：</span></p><section><ul><li><li></ul><pre data-lang="nginx"><code><span><span>topMotif</span> &lt;- toptable(BCRANKout, <span>1</span>) <span># 提取 BCRANK 结果中得分最高的 motif</span></span></code><code><span>topMotif <span># 显示得分最高的 motif 及其相关信息，如位权矩阵和搜索路径</span></span></code></pre></section><p><span></span></p><p><span><img data-imgfileid="100011995" data-ratio="0.4140625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyzohia6hqyiaPrwBTv5KRUT8P1BZdaJaDBqiajq5vicDn2uySmFoVasNeRA/640?wx_fmt=png" data-type="png" data-w="1536" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyzohia6hqyiaPrwBTv5KRUT8P1BZdaJaDBqiajq5vicDn2uySmFoVasNeRA/640?wx_fmt=png"></span></p><p><span>显示结果上图，可以看到“GTCACGTG”这个motif的搜索路线，以及位权矩阵，我们可以使用seqLogo包把位权矩阵可视化，代码如下：</span></p><section><ul><li><li></ul><pre data-lang="php"><code><span>weightMatrixNormalized &lt;- BCRANK::pwm(topMotif,  normalize=<span>TRUE</span>) <span># 生成归一化的位权矩阵（PWM），将 motif 的权重值标准化，使之更适合可视化</span></span></code><code><span>seqLogo(weightMatrixNormalized) <span># 使用 seqLogo 包来可视化位权矩阵，显示出每个碱基在 motif 各个位置的权重信息</span></span></code></pre></section><p><span></span></p><p><span>显示结果如下图：</span>    <page></page></p><p><span><img data-imgfileid="100011996" data-ratio="0.5" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEXZYDYaGFpC4duVy786IBzyIvmQKK09iaPhpcfGYn7fsQLUNnM8rnf37DGWeVJPibSwgtNxvOKFGe8A/640?wx_fmt=jpeg" data-type="jpeg" data-w="1000" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEXZYDYaGFpC4duVy786IBzyIvmQKK09iaPhpcfGYn7fsQLUNnM8rnf37DGWeVJPibSwgtNxvOKFGe8A/640?wx_fmt=jpeg"></span></p><p><span>使用matchingSites()函数预测DNA序列的结合位点</span></p><p><span><br></span></p><p><span>通过以上的分析，我们已经找到了得分最高的motif，接下来我们可以使用BCRANK中的matchingSites()函数来在DNA序列中查找和报告与该motif匹配的结合位点。代码如下：</span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span># 提取得分最高的motif共识序列</span></span></code><code><span>topConsensus &lt;- <span>as</span>.character(toptable(BCRANKout)[<span>1</span>,<span>"Consensus"</span>])</span></code><code><span><span># 打印最高得分的motif共识序列</span></span></code><code><span><span>print</span>(topConsensus)</span></code><code><span><span># 输出为 "GTCACGTG"</span></span></code><code><span><span># 查找输入fasta文件中与topConsensus ("GTCACGTG") 匹配的结合位点</span></span></code><code><span>bindingSites &lt;- matchingSites(fastaFile, topConsensus)</span></code><code><span><span># 统计预测到的结合位点数量</span></span></code><code><span>nrSites &lt;- nrow(bindingSites)</span></code><code><span><span># 输出结合位点的数量    </span></span></code><code><span>cat(<span>"Number predicted binding sites:"</span>, nrSites, <span>"\n"</span>)</span></code><code><span><span># 输出：预测的结合位点数量为 842</span></span></code><code><span><span>print</span>(bindingSites[<span>1</span>:<span>15</span>,]) <span># 打印前 15 个结合位点的详细信息</span></span></code></pre></section><p><span>结果如下图：</span><span></span></p><p><span><img data-imgfileid="100011999" data-ratio="0.2978571428571429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyUPlEZGLzG8KNm9cIU0eean07wL3KegF5effpuArYINH0xuSHicoW6kg/640?wx_fmt=png" data-type="png" data-w="1400" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEXZYDYaGFpC4duVy786IBzyUPlEZGLzG8KNm9cIU0eean07wL3KegF5effpuArYINH0xuSHicoW6kg/640?wx_fmt=png"></span></p><p><span>上图显示了 DNA 序列中预测的结合位点信息。每一行代表一个结合位点，包含区域（染色体或片段位置）、序列编号、起始和结束位置、链的方向（正链“+”或反链“-”）以及匹配的序列。比如，第1行和第2行表示同一区域的不同链上的匹配序列，由于共识序列是回文结构，因此在正链和反链上都报告了相同的结合位点。</span></p><p><span>以上就是对 BCRANK 包的所有介绍了，通过本文，我们了解了 BCRANK 包在识别基因组序列中的转录因子结合位点（TFBS）方面的应用。BCRANK 通过迭代算法优化从候选序列中提取的核苷酸序列模型，预测潜在的结合位点，并生成位置权矩阵，便于进一步分析和可视化。希望同学们能够继续深入学习和探索 BCRANK 包，通过不断的实践和应用，大家一定能在转录调控及基因组功能研究中取得不错的进展和成果。</span></p><p><span>同学们如果觉得自己写代码麻烦，可以体验一下我们的云生信小工具，只需输入数据，即可轻松生成所需图表。立即访问云生信</span><span><span>（</span></span><span><span>http://www.biocloudservice.com/home.html</span></span><span><span>）</span></span><span></span><span>，开启便捷的生信之旅！</span></p><p><br><span></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p>E</p></section></section><section><section powered-by="xiumi.us"><p>N</p></section></section><section><section powered-by="xiumi.us"><p>D</p></section></section><section><section powered-by="xiumi.us"><section><br></section></section></section></section></section><p><span>如果您的时间和精力有限或者缺乏相关经验，并且对生信分析和服务器有所需要的话，我们非常乐意为您提供如下服务：免费思路评估、付费生信分析和方案设计以及服务器租赁等，有意向的小伙伴欢迎咨询师妹哦！</span></p><p><span></span><span></span></p><section powered-by="xiumi.us"><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="257" data-galleryid="" data-imgfileid="100012003" data-ratio="0.4444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEW1MImenDROfZvBdaU52v92sJJ0qPeVcmMelurW2XFkD9oaCgLicbazDhlHmncbcia3E41driaP3wTXg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEW1MImenDROfZvBdaU52v92sJJ0qPeVcmMelurW2XFkD9oaCgLicbazDhlHmncbcia3E41driaP3wTXg/640?wx_fmt=jpeg&amp;from=appmsg"></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><p><strong>往期推荐</strong></p></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section powered-by="xiumi.us"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492496&amp;idx=1&amp;sn=b3be5983f3f8f068ebdf1b773b7cb792&amp;chksm=cfd6d83ff8a15129493abd81502ab5c3128247ff20fd576c1ba880303f346110e8bee971478e&amp;scene=21#wechat_redirect" textvalue="别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！</a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492387&amp;idx=1&amp;sn=fc12277c2ebd379a297d0c7a2c96c970&amp;chksm=cfd6d88cf8a1519a3a6eb4938cb44ebcb2d1b857ffc558c1c033ac88913384cb2f11d03a00f4&amp;scene=21#wechat_redirect" textvalue="师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492197&amp;idx=1&amp;sn=40540e16ddc99310445236401505c47e&amp;chksm=cfd6d9caf8a150dc8f010750cacc4bd241ed68a8974593d499c1b34edf5f222de567732a5705&amp;scene=21#wechat_redirect" textvalue="是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247488665&amp;idx=1&amp;sn=6d7b7b1e8b36a92df691b0ab014e7663&amp;chksm=cfd52f36f8a2a620a790e74d99e3d8af879904a131c4e1f653448590453941b7ff356d486531&amp;scene=21#wechat_redirect" textvalue="师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅</a></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jKTfL-3T2r_YC5SBk8sITg",target="_blank" rel="noopener noreferrer">原文链接</a>
