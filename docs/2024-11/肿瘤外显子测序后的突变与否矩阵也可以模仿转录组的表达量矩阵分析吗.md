---
title: "肿瘤外显子测序后的突变与否矩阵也可以模仿转录组的表达量矩阵分析吗"
date: 2024-11-16T00:08:11Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
肿瘤外显子测序后的突变与否矩阵也可以模仿转录组的表达量矩阵分析吗 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>转录组测序来源的表达量矩阵数据分析大家都耳熟能详了，从基因表达数据的差异分析到功能注释和通路分析的整个分析流程是理解基因表达变化及其生物学意义的重要步骤。以下是详细步骤的介绍：</p></blockquote><ol data-tool="mdnice编辑器"><li><section><strong>基因表达量矩阵的准备</strong>：</section></li></ol><ul><li><section>首先，需要获得全部基因的mRNA表达量矩阵，这通常来自于RNA测序（RNA-Seq）或蛋白质组学数据。</section></li></ul><li><section><strong>数据预处理</strong>：</section></li><ul><li><section>对原始数据进行质量控制、标准化和过滤，以确保数据的可靠性和可比性。</section></li></ul><li><section><strong>差异表达分析</strong>：</section></li><ul><li><section>使用统计方法（如t检验、ANOVA、Limma、DESeq2等）比较两组样本（例如，治疗组与对照组）之间的基因表达差异，以识别差异表达基因（DEGs）。</section></li></ul><li><section><strong>上下调基因的确定</strong>：</section></li><ul><li><section>根据差异表达分析的结果，使用合适的统计学阈值去确定上调（表达量增加）和下调（表达量减少）的基因。</section></li></ul><li><section><strong>GO和KEGG富集分析</strong>：</section></li><ul><li><section>使用富集分析工具（如DAVID、clusterProfiler等）来确定差异表达基因是否在特定的GO术语或KEGG通路中富集，这有助于揭示基因表达变化背后的生物学过程。</section></li></ul><li><section><strong>GSEA分析</strong>：</section></li><ul><li><section>基因集富集分析（GSEA）是一种方法，用于评估预定义的基因集（如KEGG通路或GO术语）在排序列表中的富集情况，这有助于识别与特定生物学状态或条件相关的基因集。在GSEA中，基因的重要性排序通常基于它们的差异表达程度和统计显著性。</section></li></ul><li><section><strong>验证和实验</strong>：</section></li><ul><li><section>使用实验方法（如qPCR、Western blot、细胞实验等）来验证差异表达分析和GSEA的结果。</section></li></ul><li><section><strong>数据可视化</strong>：</section></li><ul><li><section>利用图表（如火山图、热图、富集图等）来直观展示差异表达基因和富集分析的结果。</section></li></ul><li><section><strong>整合分析</strong>：</section></li><ul><li><section>将基因表达数据与其他类型的数据（如表观遗传学、蛋白质互作网络等）整合，以获得更全面的生物学见解。</section></li></ul><p data-tool="mdnice编辑器">整个流程涉及从原始数据到生物学解释的多个步骤，每一步都对最终的生物学结论至关重要。通过这些分析，研究人员可以更好地理解基因表达变化背后的分子机制，并为进一步的实验研究提供方向。</p><p data-tool="mdnice编辑器">一个简单的转录组测序来源的表达量矩阵大概如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>     Sample1 Sample2 Sample3<br>Gene1     10      15      20<br>Gene2      5       8       12<br>Gene3     18      22      25<br>Gene4      7       9       11<br>Gene5      3       6       9<br></code></pre><p data-tool="mdnice编辑器">这个表达量矩阵可以用作演示如何进行差异表达分析、数据可视化或其他生物信息学分析的起点。在实际应用中，表达量矩阵可能会包含成千上万的基因和样本，并且数据通常存储在文件中，如CSV、TXT或专用的生物信息学文件格式。</p><p data-tool="mdnice编辑器">可以使用一个简单的r代码，作为非常简单的表达量矩阵示例，它包含了5个基因在3个样本中的表达量数据。这个矩阵可以用作差异表达分析或其他类型的基因表达分析的基础。</p><pre data-tool="mdnice编辑器"><span></span><code><span># 创建一个简单的表达量矩阵示例</span><br>expression_matrix &lt;- matrix(c(<br>  <span>10</span>, <span>15</span>, <span>20</span>,  <span># 基因1在样本1、2、3中的表达量</span><br>  <span>5</span>,  <span>8</span>,  <span>12</span>,  <span># 基因2在样本1、2、3中的表达量</span><br>  <span>18</span>, <span>22</span>, <span>25</span>,  <span># 基因3在样本1、2、3中的表达量</span><br>  <span>7</span>,  <span>9</span>,  <span>11</span>,  <span># 基因4在样本1、2、3中的表达量</span><br>  <span>3</span>,  <span>6</span>,  <span>9</span>    <span># 基因5在样本1、2、3中的表达量</span><br>), nrow = <span>5</span>, byrow = <span>TRUE</span>, dimnames = list(c(<span>"Gene1"</span>, <span>"Gene2"</span>, <span>"Gene3"</span>, <span>"Gene4"</span>, <span>"Gene5"</span>), c(<span>"Sample1"</span>, <span>"Sample2"</span>, <span>"Sample3"</span>)))<br><br><span># 查看表达量矩阵</span><br>print(expression_matrix)<br></code></pre><p data-tool="mdnice编辑器">这段代码创建了一个5行3列的矩阵，其中行代表基因，列代表样本。<code>nrow = 5</code> 指定了矩阵的行数，<code>byrow = TRUE</code> 表示矩阵是按行填充的，<code>dimnames</code> 为矩阵的行和列提供了名称。不过，绝大部分情况下，我们是直接下载网络的表达量矩阵，或者读取自己的txt或者csv文件啦，不需要上面的每个基因在每个样品的手动创建！比如这个学徒作业：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247535093&amp;idx=1&amp;sn=d6fd91982636c9aa27d91982c5694e15&amp;scene=21#wechat_redirect" data-linktype="2">不要简单的相信作者提供的表达量矩阵</a>，针对这个GSE13904数据集里面的找到脓毒症和正常对照，这两个分组的样品，就是简单的从网络下载。</p><h3 data-tool="mdnice编辑器"><span></span><span>肿瘤外显子测序后的突变与否矩阵</span><span></span></h3><p data-tool="mdnice编辑器">上面的转录组测序表达量矩阵，如果是最原始的count值，每个基因在每个样品的值动态范围可以很大很大。但是在肿瘤外显子测序（Exome Sequencing）中，突变与否矩阵通常记录了特定基因位点在样本中的突变状态。这种矩阵可以用二进制值（0和1）来表示，其中0可能表示野生型（未突变），1表示突变型。</p><p data-tool="mdnice编辑器">以下是一个简单的R代码示例，用于创建一个肿瘤外显子测序后的突变矩阵：</p><pre data-tool="mdnice编辑器"><span></span><code><span># 创建一个简单的突变矩阵示例</span><br><span># 假设我们有5个样本和3个基因位点</span><br>mutation_matrix &lt;- matrix(c(<br>  <span>0</span>, <span>1</span>, <span>0</span>,  <span># 样本1的基因位点1、2、3的突变状态</span><br>  <span>1</span>, <span>0</span>, <span>1</span>,  <span># 样本2的基因位点1、2、3的突变状态</span><br>  <span>0</span>, <span>1</span>, <span>0</span>,  <span># 样本3的基因位点1、2、3的突变状态</span><br>  <span>1</span>, <span>1</span>, <span>0</span>,  <span># 样本4的基因位点1、2、3的突变状态</span><br>  <span>0</span>, <span>0</span>, <span>1</span>   <span># 样本5的基因位点1、2、3的突变状态</span><br>), nrow = <span>3</span>, byrow = <span>TRUE</span>, dimnames = list(c(<span>"Gene1"</span>, <span>"Gene2"</span>, <span>"Gene3"</span>), c(<span>"Sample1"</span>, <span>"Sample2"</span>, <span>"Sample3"</span>, <span>"Sample4"</span>, <span>"Sample5"</span>)))<br><br><span># 查看突变矩阵</span><br>print(mutation_matrix)<br></code></pre><p data-tool="mdnice编辑器">这段代码创建了一个3行5列的矩阵，其中行代表基因位点，列代表样本。<code>nrow = 3</code> 指定了矩阵的行数，<code>byrow = TRUE</code> 表示矩阵是按行填充的，<code>dimnames</code> 为矩阵的行和列提供了名称。</p><p data-tool="mdnice编辑器">输出结果将如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>     Sample1 Sample2 Sample3 Sample4 Sample5<br>Gene1      0       1       0       1       0<br>Gene2      1       0       1       1       0<br>Gene3      0       1       0       0       1<br></code></pre><p data-tool="mdnice编辑器">在这个矩阵中，<code>0</code> 表示该基因位点在相应样本中未检测到突变，<code>1</code> 表示检测到突变。这种类型的矩阵可以用于后续的突变分析，如突变负荷分析、突变谱分析或与临床数据的相关性分析。在实际应用中，突变矩阵可能包含更多的样本和基因位点，并且数据通常来源于生物信息学分析流程，如变异检测工具（如GATK、MuTect等）的输出。</p><p data-tool="mdnice编辑器">而且，因为绝大部分基因在绝大部分样品其实都是野生型，根据TMB概念，每个肿瘤病人的2万多个编码基因发生somatic突变的基因大多数在100到1000之间，也就是说其它的19000个基因都是野生型的，这样的话上面的肿瘤外显子测序后的突变与否矩阵就太稀疏了。所以肿瘤外显子测序（Exome Sequencing）后得到的突变数据通常保存在特定的文件格式中，以便于存储和分析。MAF（Mutation Annotation Format）和VCF（Variant Call Format）是两种常用的突变数据文件格式：</p><ol data-tool="mdnice编辑器"><li><section><strong>MAF（Mutation Annotation Format）</strong>：</section></li></ol><ul><li><section>MAF是一种用于存储突变信息的文本文件格式，它由TCGA（The Cancer Genome Atlas）项目推广使用。</section></li><li><section>MAF文件包含了突变的详细注释信息，包括染色体位置、突变类型、氨基酸变化、基因名称、样本信息等。</section></li><li><section>这种格式便于在不同研究之间共享和比较突变数据，因为它提供了一种标准化的方式来记录突变信息。</section></li></ul><li><section><strong>VCF（Variant Call Format）</strong>：</section></li><ul><li><section>VCF是一种用于存储基因组变异信息的文本文件格式，被广泛用于高通量测序数据的变异检测结果。</section></li><li><section>VCF文件包含了关于变异（如SNPs、插入、缺失等）的详细信息，包括变异的位置、参考和替代等位基因、质量分数、过滤状态等。</section></li><li><section>VCF格式支持多种类型的变异注释，并且可以包含多个样本的变异数据。</section></li></ul><p data-tool="mdnice编辑器"><strong>MAF和VCF</strong>通常是记录了哪些基因在哪个样品有突变即可，没有突变的基因就压根不会记录。</p><h3 data-tool="mdnice编辑器"><span></span><span>肿瘤外显子测序后的突变与否矩阵也可以差异分析吗</span><span></span></h3><p data-tool="mdnice编辑器">大部分情况下， 大家都会从公司那边拿到了，肿瘤外显子测序后的突变与否信息，可能是MAF和VCF格式。如果万一大家拿到了的是fastq格式的测序数据，就需要服务器走下面的流程了：</p><ul data-tool="mdnice编辑器"><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489435&amp;idx=1&amp;sn=0333509a96f8cfda13e5cb94c2834c98&amp;chksm=fa46d2a6cd315bb090dce00d4762dd5706ecca0e3b3d20d52b8e956ec1ee3d06c99e484d5dfa&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（九）找 Somatic Mutations的 Signature 图谱</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489366&amp;idx=1&amp;sn=3ab3e4433a7b1f8dda26f09404a774b7&amp;chksm=fa46d26bcd315b7daa5e383812c16c7b1afcf04d3c7beeddc2951e07f4009a9bf23039134b8f&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（九）拷贝数变异分析（不同软件的比较）</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489286&amp;idx=1&amp;sn=872cd54d021bc838a75195119322d526&amp;chksm=fa46d23bcd315b2d4c1da26e6493f93f67724067a8c4209c452ccf83c57a0c8192d8fe74412c&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（九）拷贝数变异分析（主要是GATK）</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489203&amp;idx=1&amp;sn=05383e24812c6535afab4c46168d100d&amp;chksm=fa46d38ecd315a98a72eee5fee589c00e1dbe08c91a9ea1e91490a2f27cc7362fdcd2e641f13&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（八）不同注释软件的比较(下)：可视化比较maf文件</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489131&amp;idx=1&amp;sn=09b63fbdd8ee40f3285916ddb932cfda&amp;chksm=fa46d356cd315a401cfdc10e2fb12ba5d6f6fdd667c15133d195eb9963ec313ee9fdf6f229dd&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（八）不同注释软件的比较（中）：注释后转成maf文件</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247489048&amp;idx=1&amp;sn=4a152933075fbf7cd10aaad1824c189b&amp;chksm=fa46d325cd315a33956a44ec0521b2db3a909dddf67ffcefd45182760972b40ac1824bb28653&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（八）不同注释软件的比较（上）：安装及使用</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488721&amp;idx=1&amp;sn=eb9a4624efcf36ac15458561e01c77e0&amp;chksm=fa46d1eccd3158fa50d55e5ae95d54413e2c3936526ce21a1c92b49725a84fc3b8a53b1353b7&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（七）maftools可视化</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488653&amp;idx=1&amp;sn=df0bfc10581eb9b1e161021e5424b7e5&amp;chksm=fa46d1b0cd3158a63d0c3ca8ac04e857f6e25d7a0505f40698ed4f1d77942d9716e0322f86c2&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（六）vcf文件的注释及ANNOVAR的使用</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488565&amp;idx=1&amp;sn=cf5629835b3947e372e8916b95d05fd7&amp;chksm=fa46d108cd31581e710b1ee7961f9991a39f3b8a9dc76e7cb2e55e396b3ffe1b5098e9aae902&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（五）GATK的最佳实践</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488497&amp;idx=2&amp;sn=ccee8550494e4aef673969857dfe7dc5&amp;chksm=fa46d6cccd315fdad8726a699930cb4a3194c1b999daecf5a785d5d97eb2e05f132085855ea8&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（番外篇）bam文件载入igv可视化</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247488425&amp;idx=1&amp;sn=658a5f66af8fdeec60810cb0f5a2dfb6&amp;chksm=fa46d694cd315f82ea7ac6fa7cb5f35cac76da7df8948cc780664a3abcae90a89ef1a74605d6&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（四）比对结果的质控</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247487719&amp;idx=2&amp;sn=025308308a40d28fa84ba2924e26c12f&amp;chksm=fa46d5dacd315ccc1bc4e2d9b976ed76e9dc9f4b9f7d87e71419c8339e4fe14a30498b0ff1cd&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（三）比对</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247487653&amp;idx=2&amp;sn=45c7c9c13af5b18fbea1f50489c01676&amp;chksm=fa46d598cd315c8e11014156b9a5e3f5601dedac676aed375eb5a0f565cd55adec39e1b1beb8&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（二）质控与去接头</a></section></li><li><section><a href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247487620&amp;idx=1&amp;sn=c64df71f838f0672d7a39a51481e465c&amp;chksm=fa46d5b9cd315caf1749ffb6fad716998fc81e6ca81a8393564a607e419aa2b72ba2b25a9c13&amp;scene=21#wechat_redirect" data-linktype="2">肿瘤外显子数据处理系列教程（一）读文献并且下载测序数据</a></section></li></ul><p data-tool="mdnice编辑器">如果是，比如这个2024的文章：《PICK1 inhibits the malignancy of nasopharyngeal carcinoma and serves as a novel prognostic marker》，就  Landscape of somatic mutation profiles in 13 NPC samples. 分成了  NDM (no distant metastasis) and DM (distant metastasis) groups. 如下所示：</p><p><img data-galleryid="" data-imgfileid="100045233" data-ratio="0.919683257918552" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k93q3gKge5MgxfHaVxkADamsVMfUvjKTmGzUDMmcE2Mxkag1B0wIiaQgM75llw9Sribibs2vCTVzCw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1768" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8k93q3gKge5MgxfHaVxkADamsVMfUvjKTmGzUDMmcE2Mxkag1B0wIiaQgM75llw9Sribibs2vCTVzCw/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption> </figcaption></figure><p data-tool="mdnice编辑器">就是一个很简单的差异分析，然后略微有点莫名其妙的就定位到了PICK1基因。而如果是要实现上面的图超级简单，把上面的两分组各自独立做成maf格式文件然后分开读取，使用这个函数即可：https://rdrr.io/bioc/maftools/man/mafCompare.html</p><pre data-tool="mdnice编辑器"><span></span><code>primary.apl &lt;- system.file(<span>"extdata"</span>, <span>"APL_primary.maf.gz"</span>, package = <span>"maftools"</span>)<br>relapse.apl &lt;- system.file(<span>"extdata"</span>, <span>"APL_relapse.maf.gz"</span>, package = <span>"maftools"</span>)<br>primary.apl &lt;- read.maf(maf = primary.apl)<br>relapse.apl &lt;- read.maf(maf = relapse.apl)<br>pt.vs.rt &lt;- mafCompare(m1 = primary.apl, m2 = relapse.apl, m1Name = <span>'Primary'</span>,<br>m2Name = <span>'Relapse'</span>, minMut = 5)<br></code></pre><p data-tool="mdnice编辑器">然后就可以看出来了：</p><pre data-tool="mdnice编辑器"><span></span><code><span>## $results</span><br><span>##    Hugo_Symbol Primary Relapse         pval         or       ci.up      ci.low</span><br><span>##         &lt;char&gt;   &lt;num&gt;   &lt;int&gt;        &lt;num&gt;      &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span><br><span>## 1:         PML       1      11 1.529935e-05 0.03537381   0.2552937 0.000806034</span><br><span>## 2:        RARA       0       7 2.574810e-04 0.00000000   0.3006159 0.000000000</span><br><span>## 3:       RUNX1       1       5 1.310500e-02 0.08740567   0.8076265 0.001813280</span><br><span>## 4:        FLT3      26       4 1.812779e-02 3.56086275  14.7701728 1.149009169</span><br><span>## 5:      ARID1B       5       8 2.758396e-02 0.26480490   0.9698686 0.064804160</span><br><span>## 6:         WT1      20      14 2.229087e-01 0.60619329   1.4223101 0.263440988</span><br><span>## 7:        KRAS       6       1 4.334067e-01 2.88486293 135.5393108 0.337679367</span><br><span>## 8:        NRAS      15       4 4.353567e-01 1.85209500   8.0373994 0.553883512</span><br><span>## 9:      ARID1A       7       4 7.457274e-01 0.80869223   3.9297309 0.195710173</span><br><span>##         adjPval</span><br><span>##           &lt;num&gt;</span><br><span>## 1: 0.0001376942</span><br><span>## 2: 0.0011586643</span><br><span>## 3: 0.0393149868</span><br><span>## 4: 0.0407875250</span><br><span>## 5: 0.0496511201</span><br><span>## 6: 0.3343630535</span><br><span>## 7: 0.4897762916</span><br><span>## 8: 0.4897762916</span><br><span>## 9: 0.7457273717</span><br><span>## </span><br><span>## $SampleSummary</span><br><span>##     Cohort SampleSize</span><br><span>##     &lt;char&gt;      &lt;num&gt;</span><br><span>## 1: Primary        124</span><br><span>## 2: Relapse         58</span><br></code></pre><p data-tool="mdnice编辑器">但是，这一切的结果的合理性的前提都是样品数量。关于上面的对比结果，其实文档里面 有很多 对比的可视化函数：</p><ul data-tool="mdnice编辑器"><li><section>9.5 Comparing two cohorts (MAFs)</section></li><ul><li><section>9.5.1 Forest plots</section></li><li><section>9.5.2 Co-onco plots</section></li><li><section>9.5.3 Co-bar plots</section></li></ul></ul></section><p><br></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/4l20oC4HxwDxClc7jBv7mQ",target="_blank" rel="noopener noreferrer">原文链接</a>
