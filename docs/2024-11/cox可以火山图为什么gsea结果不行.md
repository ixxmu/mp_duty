---
title: "cox可以火山图为什么gsea结果不行"
date: 2024-11-10T02:26:00Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
cox可以火山图为什么gsea结果不行 by 生信技能树
------
<div><section><blockquote><p>前面我在生信技能树分享过 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492979&amp;idx=1&amp;sn=d6a76824e0edff9e3195b544c76596ea&amp;scene=21#wechat_redirect" data-linktype="2">批量cox生存分析结果也可以火山图可视化</a> 介绍了火山图的基础认识，同时也给了大家代码可以批量做cox分析，并且绘制出来火山图。</p></blockquote><p>最近看到一个文献，是数据集：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE101668</p><pre><code><span>GSM2711785</span>    RKO-WT-rep1<br>GSM2711786    RKO-WT-rep2<br>GSM2711787    RKO-PRDM1-KO2-rep1<br>GSM2711788    RKO-PRDM1-KO2-rep2<br>GSM2711789    RKO-PRDM1-KO5-rep1<br>GSM2711790    RKO-PRDM1-KO5-rep2<br>GSM2711791    RKO-GFP-OE-rep1<br>GSM2711792    RKO-GFP-OE-rep2<br>GSM2711793    RKO-PRDM1α-OE-rep1<br>GSM2711794    RKO-PRDM1α-OE-rep2<br>GSM2711795    RKO-PRDM1β-OE-rep1<br>GSM2711796    RKO-PRDM1β-OE-rep2<br></code></pre><p>可以看到样本不多，但是分组不少，所以作者分析这个转录组数据的时候，可视化很丰富：</p><figure><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="26" data-ratio="0.3093278463648834" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8CpmwTpUYzb5dCQdOofqJicmq0fEVSEbVb4uXvefdsKYvgtSJX5BiaWyww/640?wx_fmt=png" data-type="png" data-w="2916" title="两个差异分析取交集" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8CpmwTpUYzb5dCQdOofqJicmq0fEVSEbVb4uXvefdsKYvgtSJX5BiaWyww/640?wx_fmt=png"><figcaption>两个差异分析取交集</figcaption></figure><p>这样的火山图，韦恩图，相信大家看过我的GEO数据挖掘系列教程，肯定没有问题的啦。</p><p>我已经多次讲解了，走标准分析流程，火山图，热图，GO/KEGG数据库注释等等。这些流程的视频教程都在B站和GitHub了，目录如下：</p><ul><li><p><span>第一讲：GEO，表达芯片与R</span></p></li><li><p><span>第二讲：从GEO下载数据得到表达量矩阵</span></p></li><li><p><span>第三讲：对表达量矩阵用GSEA软件做分析</span></p></li><li><p><span>第四讲：根据分组信息做差异分析</span></p></li><li><p><span>第五讲：对差异基因结果做GO/KEGG超几何分布检验富集分析</span></p></li><li><p><span>第六讲：指定基因分组boxplot指定基因list画热图</span></p></li></ul><p>仅仅是最后得到的差异分子，并不是以前的mRNA后面的基因名，而是miRNA，lncRNA，甚至circRNA的ID，看起来很陌生罢了。感兴趣可以细读表达芯片的公共数据库挖掘系列推文 ；</p><ul><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486063&amp;idx=1&amp;sn=156bee5397e979722b36b78284188538&amp;scene=21#wechat_redirect" data-linktype="2">解读GEO数据存放规律及下载，一文就够</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486054&amp;idx=1&amp;sn=209975adee162228cfe6e6c5065c5c8c&amp;scene=21#wechat_redirect" data-linktype="2">解读SRA数据库规律一文就够</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486087&amp;idx=1&amp;sn=1e775a1c3e215384e381953a9fa74ec3&amp;scene=21#wechat_redirect" data-linktype="2">从GEO数据库下载得到表达矩阵 一文就够</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486090&amp;idx=1&amp;sn=62374fbdd4f20c3185beb6568bbeb3e9&amp;scene=21#wechat_redirect" data-linktype="2">GSEA分析一文就够（单机版+R语言版）</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486112&amp;idx=1&amp;sn=67a2104c62222bcb139623699f874a6c&amp;scene=21#wechat_redirect" data-linktype="2">根据分组信息做差异分析- 这个一文不够的</a></p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247486120&amp;idx=1&amp;sn=14d7892c1beec2fb9cdfc0ec0aba3e4e&amp;scene=21#wechat_redirect" data-linktype="2">差异分析得到的结果注释一文就够</a></p></li></ul><p>这样简单的分析，当然只能是结合生物学背景尽量去解释它。但是有一个图，值得我分享一下，就是</p><figure><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="26" data-ratio="0.32238193018480493" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8CcvXOHnK2dQZ5jTvEicWt8YeiaKfvfCziaibiaSxLeIsbcPcA5Ppty1hjt8A/640?wx_fmt=png" data-type="png" data-w="2922" title="image-20200305232133605" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8CcvXOHnK2dQZ5jTvEicWt8YeiaKfvfCziaibiaSxLeIsbcPcA5Ppty1hjt8A/640?wx_fmt=png"><figcaption>image-20200305232133605</figcaption></figure><p>作者把比表达矩阵的差异分析结果(PRDM1-KO and PRDM1-OE RKO cells.)，进行gsea分析，针对MSigDB Hallmark 的50个基因集。</p><blockquote><p>Volcano plot of GSEA of the MSigDB Hallmark database. The FDR versus the normalized enrichment score (NES) for each evaluated gene set is shown. Blue dots are significantly enriched gene sets (FDR adjusted P value &lt;0.05).</p></blockquote><p>当然了，针对MSigDB Hallmark 的50个基因集的gsea代码我其实也给了大家，跟我们一直讲解的针对kegg的gsea不一样哦，下面是针对kegg的：</p><pre><code>geneList=gene$logfc<br>names(geneList)=gene$ENTREZID <br>geneList=sort(geneList,decreasing = <span>T</span>)<br>head(geneList)<br><br><span>library</span>(clusterProfiler)<br>kk_gse &lt;- gseKEGG(geneList     = geneList,<br>                  organism     = <span>'hsa'</span>,<br>                  nPerm        = <span>1000</span>,<br>                  minGSSize    = <span>10</span>,<br>                  pvalueCutoff = <span>0.9</span>,<br>                  verbose      = <span>FALSE</span>)<br>tmp=kk_gse@result<br>kk=DOSE::setReadable(kk_gse, OrgDb=<span>'org.Hs.eg.db'</span>,keyType=<span>'ENTREZID'</span>)<br></code></pre><p>然后是针对MSigDB Hallmark 的50个基因集的gsea代码，需要自己下载gmt文件哦。</p><pre><code><span>#选择gmt文件（MigDB中的全部基因集）</span><br>  d=<span>'~/biosoft/MSigDB/symbols/'</span><br>  gmts &lt;- list.files(d,pattern = <span>'all'</span>)<br>  gmts<br>  <span>#GSEA分析</span><br>  <span>library</span>(GSEABase) <span># BiocManager::install('GSEABase')</span><br>  <span>## 下面使用lapply循环读取每个gmt文件，并且进行GSEA分析</span><br>  <span>## 如果存在之前分析后保存的结果文件，就不需要重复进行GSEA分析。</span><br>  f=<span>'gsea_results.Rdata'</span><br>  <span>if</span>(!file.exists(f)){<br>    gsea_results &lt;- lapply(gmts, <span>function</span>(gmtfile){<br>      <span># gmtfile=gmts[2]</span><br>      geneset &lt;- read.gmt(file.path(d,gmtfile)) <br>      print(paste0(<span>'Now process the '</span>,gmtfile))<br>      egmt &lt;- GSEA(geneList, TERM2GENE=geneset, verbose=<span>FALSE</span>)<br>      head(egmt)<br>      <span># gseaplot(egmt, geneSetID = rownames(egmt[1,]))</span><br><br>      <span>return</span>(egmt)<br>    })<br>    <span># 上面的代码耗时，所以保存结果到本地文件</span><br>    save(gsea_results,file = f)<br>  }<br></code></pre><p>同样的可以拿到能够被火山图展现的数据，如下：</p><figure><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="26" data-ratio="0.4912485414235706" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8Cha1gKueHHx7uUWVSYoXUZd5gttXHYeOibbsyQBr1oJLhRgyZAGsDbjg/640?wx_fmt=png" data-type="png" data-w="1714" title="火山图收入数据" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyGrplCiacG81UgNc6N1lib8Cha1gKueHHx7uUWVSYoXUZd5gttXHYeOibbsyQBr1oJLhRgyZAGsDbjg/640?wx_fmt=png"><figcaption>火山图收入数据</figcaption></figure><h4><span>文末友情宣传</span><span> </span></h4><p>强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492995&amp;idx=1&amp;sn=e6991e98846f14aa23914ece88b5a0bc&amp;scene=21#wechat_redirect" data-linktype="2">全国巡讲全球听（买一得五），第二期</a> ，你的生物信息学入门课</p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492711&amp;idx=1&amp;sn=5b629127522cd19fb3210e80f3841bc1&amp;scene=21#wechat_redirect" data-linktype="2">生信技能树的2019年终总结</a>  ，你的生物信息学成长宝藏</p></li><li><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247492732&amp;idx=1&amp;sn=26ce7dfb8bcfd9fe18fcabfb83de101b&amp;scene=21#wechat_redirect" data-linktype="2">2020学习主旋律，B站74小时免费教学视频为你领路</a></p></li></ul></section><p><br></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ZcOPNzcj1EZhrHPfUZfwyQ",target="_blank" rel="noopener noreferrer">原文链接</a>
