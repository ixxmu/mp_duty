---
title: "Alphafold3源代码已完全公开（附本地安装教程）"
date: 2024-11-25T23:33:50Z
draft: ["false"]
tags: [
  "fetched",
  "危生物组"
]
categories: ["Acdemic"]
---
Alphafold3源代码已完全公开（附本地安装教程） by 危生物组
------
<div><section><h1><span><span leaf="">Alphafold3开源</span></span></h1><blockquote><p><span leaf="">写在前面的</span><span leaf=""><br></span><span leaf="">DeepMind于2024年5月9日正式发布Alphafold3，作为其前身AlphaFold2的升级版本Alphafold3采用了扩散模型来生成最终的三维结构。该模型通过加噪和去噪的过程，从随机噪声中逐步生成清晰的原子坐标。这一过程强调了局部和全局结构的学习，能够在不同的尺度上理解蛋白质的构象。同时Alphafold3采用了Pairformer模块取代了AlphaFold2中的Evoformer模块，专注于处理成对表示（pair representation），并通过成对特征的交互来更新单一特征（single representation）。这一模块的设计使得信息流动更加高效，能够更好地捕捉分子间的相互作用使得AlphaFold3在蛋白质及其他生物分子的结构预测方面具有更高的准确性和广度。此前，DeepMind并未公开Alphafold3的源代码，而是提供了一个在线的AlphaFold Server，用户可以在该平台上进行蛋白质结构预测。用户只需注册并登录，即可提交蛋白质序列进行预测。由于源代码未公开，同时受到网络的限制，国内用户想使用Alphafold3完成蛋白质与其他生物大分子或小分子的预测非常困难。最近，DeepMind公司公开了Alphafold3的源代码https://github.com/google-deepmind/alphafold3，使得蛋白质及其他生物分子的相互作用可以批量在本地进行。</span></p></blockquote><h3><span><span leaf="">Alphafold3安装</span></span></h3><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/V6qOSNufyVR57kgeYiaQkD8ibUFE18DgPzoel0mohGia5ej0jic5rROa2I9V4zA2viboVjSXpR7UxicTc0laB89jhkZA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9631372549019608" data-s="300,640" data-type="png" data-w="1275" data-backw="578" data-backh="557" data-imgfileid="100001600" src="https://mmbiz.qpic.cn/sz_mmbiz_png/V6qOSNufyVR57kgeYiaQkD8ibUFE18DgPzoel0mohGia5ej0jic5rROa2I9V4zA2viboVjSXpR7UxicTc0laB89jhkZA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">       要安装AlphaFold3，需要遵循以下步骤。请注意，AlphaFold3仅支持Linux操作系统，并且需要具备一定的硬件要求，包括NVIDIA GPU和足够的内存。</span></p><p><span leaf="">安装步骤</span></p><h4><span><span leaf="">1.准备环境：</span></span></h4><p><span leaf="">       确保服务器是Linux操作系统，推荐使用Ubuntu 22.04 LTS。需要至少64 GB的RAM和NVIDIA GPU（计算能力8.0或更高）。</span></p><h4><span><span leaf="">通过Docker安装</span></span></h4><p><span leaf="">       更新包管理器并安装必要的依赖</span></p><pre><code><span leaf="">sudo apt-get </span><span><span leaf="">update</span></span><span leaf=""><br></span><span leaf="">sudo apt-</span><span><span leaf="">get</span></span><span leaf=""> </span><span><span leaf="">install</span></span><span leaf=""> ca-certificates curl</span><span leaf=""><br></span></code></pre><p><span leaf="">       添加Docker的GPG密钥并安装Docker：</span></p><pre><code><span leaf="">sudo </span><span><span leaf="">install</span></span><span leaf=""> -m </span><span><span leaf="">0755</span></span><span leaf=""> -d /etc/apt/keyrings</span><span leaf=""><br></span><span leaf="">sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc</span><span leaf=""><br></span><span leaf="">sudo chmod a+r /etc/apt/keyrings/docker.asc</span><span leaf=""><br></span><span leaf="">echo </span><span><span leaf="">"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu $(. /etc/os-release &amp;&amp; echo "</span></span><span leaf="">$VERSION_CODENAME</span><span><span leaf="">") stable"</span></span><span leaf=""> | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/</span><span><span leaf="">null</span></span><span leaf=""><br></span><span leaf="">sudo apt-</span><span><span leaf="">get</span></span><span leaf=""> </span><span><span leaf="">update</span></span><span leaf=""><br></span><span leaf="">sudo apt-</span><span><span leaf="">get</span></span><span leaf=""> </span><span><span leaf="">install</span></span><span leaf=""> -y docker-ce docker-ce-cli containerd.io docker-buildx-</span><span><span leaf="">plugin</span></span><span leaf=""> docker-compose-</span><span><span leaf="">plugin</span></span><span leaf=""><br></span></code></pre><h4><span><span leaf="">2.安装NVIDIA驱动</span></span></h4><p><span leaf="">       安装NVIDIA驱动以支持GPU：</span></p><pre><code><span><span leaf="">sudo</span></span><span leaf=""> ubuntu-drivers install</span><span leaf=""><br></span><span leaf="">sudo nvidia-smi</span><span leaf=""><br></span></code></pre><h4><span><span leaf="">通过github安装</span></span></h4><pre><code><span leaf="">git </span><span><span leaf="">clone</span></span><span leaf=""> https://github.com/google-deepmind/alphafold3.git</span><span leaf=""><br></span><span><span leaf="">cd</span></span><span leaf=""> alphafold3</span><span leaf=""><br></span></code></pre><h4><span><span leaf="">数据库下载</span></span></h4><p><span leaf="">         使用提供的Python脚本下载所需的基因数据库：确保下载目录有足够的存储空间（约252 GB的下载大小）。</span></p><pre><code><span leaf="">python3 fetch_databases.py --download_destination=</span><span><span><span leaf="">&lt;</span><span><span leaf="">DATABASES_DIR</span></span><span leaf="">&gt;</span></span><span leaf=""><br></span></span></code></pre><h3><span><span leaf="">Alphafold3使用方法</span></span></h3><h4><span><span leaf="">使用前测试</span></span></h4><pre><code><span leaf="">{</span><span leaf=""><br></span><span leaf="">  </span><span><span leaf="">"name"</span></span><span leaf="">: </span><span><span leaf="">"2PV7"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  </span><span><span leaf="">"sequences"</span></span><span leaf="">: [</span><span leaf=""><br></span><span leaf="">    {</span><span leaf=""><br></span><span leaf="">      </span><span><span leaf="">"protein"</span></span><span leaf="">: {</span><span leaf=""><br></span><span leaf="">        </span><span><span leaf="">"id"</span></span><span leaf="">: [</span><span><span leaf="">"A"</span></span><span leaf="">, </span><span><span leaf="">"B"</span></span><span leaf="">],</span><span leaf=""><br></span><span leaf="">        </span><span><span leaf="">"sequence"</span></span><span leaf="">: </span><span><span leaf="">"GMRESYANENQFGFKTINSDIHKIVIVGGYGKLGGLFARYLRASGYPISILDREDWAVAESILANADVVIVSVPINLTLETIERLKPYLTENMLLADLTSVKREPLAKMLEVHTGAVLGLHPMFGADIASMAKQVVVRCDGRFPERYEWLLEQIQIWGAKIYQTNATEHDHNMTYIQALRHFSTFANGLHLSKQPINLANLLALSSPIYRLELAMIGRLFAQDAELYADIIMDKSENLAVIETLKQTYDEALTFFENNDRQGFIDAFHKVRDWFGDYSEQFLKESRQLLQQANDLKQG"</span></span><span leaf=""><br></span><span leaf="">      }</span><span leaf=""><br></span><span leaf="">    },</span><span leaf=""><br></span><span leaf="">  ],</span><span leaf=""><br></span><span leaf="">  </span><span><span leaf="">"modelSeeds"</span></span><span leaf="">: [</span><span><span leaf="">1</span></span><span leaf="">],</span><span leaf=""><br></span><span leaf="">  </span><span><span leaf="">"dialect"</span></span><span leaf="">: </span><span><span leaf="">"alphafold3"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  </span><span><span leaf="">"version"</span></span><span leaf="">: </span><span><span leaf="">1</span></span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span></code></pre><h4><span><span leaf="">基于命令行运行方法</span></span></h4><pre><code><span><span leaf="">#基于docker的使用方法</span></span><span leaf=""><br></span><span leaf="">docker run -it \</span><span leaf=""><br></span><span leaf="">    --volume $HOME/</span><span><span leaf="">af_input:</span></span><span leaf="">/root/af_input \</span><span leaf=""><br></span><span leaf="">    --volume $HOME/</span><span><span leaf="">af_output:</span></span><span leaf="">/root/af_output \</span><span leaf=""><br></span><span leaf="">    --volume &lt;MODEL_PARAMETERS_DIR&gt;</span><span><span leaf="">:/root/models</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">    --volume &lt;DATABASES_DIR&gt;</span><span><span leaf="">:/root/public_databases</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">    --gpus all \</span><span leaf=""><br></span><span leaf="">    alphafold3 \</span><span leaf=""><br></span><span><span leaf="">#基于python源码的使用方法</span></span><span leaf=""><br></span><span leaf="">python run_alphafold.py \</span><span leaf=""><br></span><span leaf="">    --json_path=</span><span><span leaf="">/root/af</span></span><span leaf="">_input/fold_input.json \</span><span leaf=""><br></span><span leaf="">    --model_dir=</span><span><span leaf="">/root/models</span></span><span leaf=""> \</span><span leaf=""><br></span><span leaf="">    --output_dir=</span><span><span leaf="">/root/af</span></span><span leaf="">_output</span><span leaf=""><br></span></code></pre><h3><span><span leaf="">Alphafold3的硬件依赖</span></span></h3><p><span leaf="">        AlphaFold 3 不支持其他操作系统，目前只支持Linux操作系统。安装完整版Alphafold3（包含数据库和预训练等库）需要高达 1 TB 的磁盘空间保存（建议使用 SSD 存储）和具有计算能力 8.0 或更高版本的 NVIDIA GPU（具有更多内存的 GPU 可以预测更大的蛋白质结构）。Deepmind团队已经验证，单个 NVIDIA A100 80 GB 或单个 NVIDIA H100 80 GB 可以容纳多达 5,120 个令牌的输入。我们已经在 NVIDIA A100 和 H100 GPU上验证了数值准确性。特别是对于长序列对象，序列搜索阶段可能会消耗大量运行内存，建议至少使用大于64GB的RAM运行。Deepmind公司提供了具有 NVIDIA A100 80 GB GPU 和纯净版Ubuntu 22.04 LTS 安装的计算机的安装说明。</span></p><h1><span><span leaf="">A100显卡要求</span></span></h1><pre><code><span leaf="">Mon Nov  </span><span><span leaf="">11</span></span><span leaf=""> </span><span><span leaf="">12</span></span><span><span leaf="">:</span></span><span><span leaf="">00</span></span><span><span leaf="">:</span></span><span><span leaf="">00</span></span><span leaf=""> </span><span><span leaf="">2024</span></span><span leaf=""><br></span><span leaf="">+-----------------------------------------------------------------------------------------+</span><span leaf=""><br></span><span><span leaf="">| NVIDIA-SMI 550.120                Driver Version: 550.120        CUDA Version: 12.6     |</span></span><span leaf=""><br></span><span><span leaf="">|-----------------------------------------+------------------------+----------------------+</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf=""> GPU  Name                 Persistence-M </span><span><span leaf="">| Bus-Id          Disp.A |</span></span><span leaf=""> Volatile Uncorr. ECC </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf=""> Fan  Temp   Perf          </span><span><span leaf="">Pwr:</span></span><span leaf="">Usage/Cap </span><span><span leaf="">|           Memory-Usage |</span></span><span leaf=""> GPU-Util  Compute M. </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">                                         </span><span><span leaf="">|                        |</span></span><span leaf="">               MIG M. </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">=========================================+========================+======================</span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">   </span><span><span leaf="">0</span></span><span leaf="">  NVIDIA A10</span><span><span leaf="">0</span></span><span leaf="">-SXM4-</span><span><span leaf="">80</span></span><span leaf="">GB          Off </span><span><span leaf="">|   00000000:00:05.0 Off |</span></span><span leaf="">                    </span><span><span leaf="">0</span></span><span leaf=""> </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf=""> N/A   </span><span><span leaf="">34</span></span><span leaf="">C    P</span><span><span leaf="">0</span></span><span leaf="">             </span><span><span leaf="">51</span></span><span leaf="">W /  </span><span><span leaf="">400</span></span><span leaf="">W </span><span><span leaf="">|       1MiB /  81920MiB |</span></span><span leaf="">      </span><span><span leaf="">0</span></span><span leaf="">%      Default </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">                                         </span><span><span leaf="">|                        |</span></span><span leaf="">             Disabled </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">+-----------------------------------------+------------------------+----------------------+</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">+-----------------------------------------------------------------------------------------+</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf=""> </span><span><span leaf="">Processes:</span></span><span leaf="">                                                                              </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">  GPU   GI   CI        PID   Type   Process name                              GPU Memory </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">        ID   ID                                                               Usage      </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">=========================================================================================</span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">|</span></span><span leaf="">  No running processes found                                                             </span><span><span leaf="">|</span><span leaf=""><br></span><span leaf="">+-----------------------------------------------------------------------------------------+</span><span leaf=""><br></span></span></code></pre><h3><span><span leaf="">基于Docker安装的NVIDIA支持</span></span></h3><pre><code><span leaf="">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg </span><span><span leaf="">--dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \</span></span><span leaf=""><br></span><span leaf="">  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \</span><span leaf=""><br></span><span leaf="">    sed 's</span><span><span leaf="">#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \</span></span><span leaf=""><br></span><span leaf="">    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><span leaf=""><br></span><span leaf="">sudo apt-get </span><span><span leaf="">update</span></span><span leaf=""><br></span><span leaf="">sudo apt-</span><span><span leaf="">get</span></span><span leaf=""> </span><span><span leaf="">install</span></span><span leaf=""> -y nvidia-</span><span><span leaf="">container</span></span><span leaf="">-toolkit</span><span leaf=""><br></span><span leaf="">nvidia-ctk runtime configure </span><span><span leaf="">--runtime=docker --config=$HOME/.config/docker/daemon.json</span></span><span leaf=""><br></span><span leaf="">systemctl </span><span><span leaf="">--user restart docker</span></span><span leaf=""><br></span><span leaf="">sudo nvidia-ctk config </span><span><span leaf="">--set nvidia-container-cli.no-cgroups --in-place</span></span><span leaf=""><br></span><span leaf="">docker run </span><span><span leaf="">--rm --gpus all nvidia/cuda:12.6.0-base-ubuntu22.04 nvidia-smi</span></span><span leaf=""><br></span></code></pre><h3><span><span leaf="">Linux NIVDIA显卡驱动安装</span></span></h3><pre><code><span leaf="">sudo apt-get -y </span><span><span leaf="">install</span></span><span leaf=""> alsa-utils ubuntu-drivers-common</span><span leaf=""><br></span><span leaf="">sudo ubuntu-drivers </span><span><span leaf="">install</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">sudo nvidia-smi </span><span><span leaf="">--gpu-reset</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">nvidia-smi  </span><span><span leaf=""># Check that the drivers are installed.</span></span><span leaf=""><br></span></code></pre></section><p><span leaf=""><br></span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/A4bvxQ2oKypCyd6ML9W5vw",target="_blank" rel="noopener noreferrer">原文链接</a>
