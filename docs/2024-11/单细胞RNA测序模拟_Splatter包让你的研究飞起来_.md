---
title: "单细胞RNA测序模拟，Splatter包让你的研究飞起来！"
date: 2024-11-10T12:31:41Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
单细胞RNA测序模拟，Splatter包让你的研究飞起来！ by R语言学徒
------
<div><p><img data-galleryid="" data-imgfileid="100011257" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4AFAUQvRhZ09kszrxgL2LKooSvsEzP3Zn7Qn9yYGZia3xs7JVFWptNAyw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4AFAUQvRhZ09kszrxgL2LKooSvsEzP3Zn7Qn9yYGZia3xs7JVFWptNAyw/640?wx_fmt=jpeg&amp;from=appmsg"></p><section><span>嘿，科研小伙伴们，小师妹我又来啦！今天，我要给大家带来一个超级实用的生物信息学工具——Splatter包。在这个单细胞RNA测序数据爆炸的时代，你是不是也在为如何</span><span>获取和</span><span>处理这些复杂的数据而头疼？别担心，有了Splatter包，我们可以轻松模拟单细胞RNA测序数据，让数据分析变得更加简单直观。</span></section><section><span>Splatter是一个R包，专门用于简单模拟单细胞RNA测序数据。这个包的功能非常强大，它不仅可以帮助我们理解数据的特性，还能让我们在实际研究中更加得心应手。通过这个包，我们可以模拟出与真实数据极为相似的单细胞数据集，这对于验证分析方法、测试新的算法或进行教学演示都是非常有用的。</span></section><section><span>在这个教程中，小师妹将带你一步步了解Splatter包的安装、快速入门指南，以及如何进行参数估计和数据模拟。</span><span>注意哦，这个R包操作占用内存比较大，建议使用服务器哦，欢迎联系小师妹租赁性价比高的服务器~ </span></section><section><span>准备好了吗？让我们一起开启这场单细胞数据分析的奇妙之旅吧！</span><span>如果在旅途中遇到任何问题，记得找小师妹帮忙哦！</span></section><section><section><section><section><section><section><section><img data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="196" data-imgfileid="100011650" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4AlKWaqibVOibhMXCwA4ffrv7MzBHIdY7QQdDHqgLW0pMgbWBibRWONmqMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="396" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4AlKWaqibVOibhMXCwA4ffrv7MzBHIdY7QQdDHqgLW0pMgbWBibRWONmqMA/640?wx_fmt=png&amp;from=appmsg"></section></section></section><section><section><section><p><span><strong>定制生信分析</strong></span></p><p><span><strong>云服务器租赁</strong></span></p><p><strong>(加微信<span>备注99</span>领取试用)</strong></p></section></section></section></section></section></section></section><section><br></section><section><span>首先，让我们开始安装multistateQTL包</span><span>和另外需要用到的包</span><span>：</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="php"><code><span><span>if</span> (!<span>require</span>(<span>"BiocManager"</span>, quietly=<span>TRUE</span>))</span></code><code><span>    install.packages(<span>"BiocManager"</span>)</span></code><code><span>BiocManager::install(<span>"splatter"</span>)</span></code><code><span>BiocManager::install(<span>"scater"</span>)</span></code></pre></section><section><span></span></section><section><span>安装好了之后，</span><span>记得</span><span>加载这些必要的库：</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre><code><span>lsuppressPackageStartupMessages({</span></code><code><span>  library(splatter)</span></code><code><span>  library(scater)</span></code><code><span>})</span></code></pre></section><p><strong><span>本篇文章文章所使用的代码、示例数据或基因集等，关注公众号回复【666】获取哦~编号：241110</span></strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg5MDk3Mzg4OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/oCSOtP61aEVVCT8bjvGjvicxiaj3q39iaClXlQMVUcyTp0N2Jr5MX57B5mxKLt8W1YiaA7lEibyicLLicYAMJImkJQs4A/300?wx_fmt=png&amp;wxfrom=19" data-nickname="R语言学徒" data-alias="" data-signature="R语言学习从入门到精通，持续关注小师妹，每天更新R语言知识，生信干货内容。如需定制生信分析、服务器租赁，欢迎咨询小师妹" data-from="2" data-is_biz_ban="0" data-origin_num="271" data-isban="0" data-biz_account_status="0" data-index="0"></mp-common-profile></section><section><span>一、</span><span>快速上手 Splatter包</span><span></span>    <page></page></section><section><span>如果你已经有了一个类似于你想要模拟的计数数据集，那么只需要两步，我们就能创建一个模拟的数据集。下面是如何用`scater`包生成一个模拟数据集的例子：</span></section><section><span></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span><span># 创建模拟数据</span></span></code><code><span><span>set</span>.seed(<span>1</span>)</span></code><code><span>sce &lt;- mockSCE()</span></code><code><span>           </span></code><code><span><span># 从模拟数据估计参数</span></span></code><code><span><span>params</span> &lt;- splatEstimate(sce)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011616" data-ratio="0.03148148148148148" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJaXX3J71w5WmtxExic6mUfZiaCWOh12vjsdXDDkvDEUGnDSLiaYtYJAULw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJaXX3J71w5WmtxExic6mUfZiaCWOh12vjsdXDDkvDEUGnDSLiaYtYJAULw/640?wx_fmt=png"></span><span></span></section><section><span>这一步，Splatter会提醒我们，</span><span>它</span><span>发现库大小是正态分布而不是对数正态分布。这个提示很有用，因为它告诉我们数据的分布特性，我们可以根据这个信息调整模拟参数。</span></section><section><span>接下来，我们用估计出的参数来模拟新的数据集：</span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span># 使用估计的参数模拟数据</span></span></code><code><span>sim &lt;- splatSimulate(<span>params</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011620" data-ratio="0.49525101763907736" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJKJXE8QM9vxUGpiaDqBDib9ZY0CfhWNDFlYC4sAq9LrK3UiblTpia5AxcDg/640?wx_fmt=png" data-type="png" data-w="737" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJKJXE8QM9vxUGpiaDqBDib9ZY0CfhWNDFlYC4sAq9LrK3UiblTpia5AxcDg/640?wx_fmt=png"></span><span></span></section><section><span>在模拟过程中，Splatter会执行一系列步骤：获取参数、创建模拟对象、模拟库大小、基因均值、生物学变异系数（BCV）、计数、如果需要的话模拟dropout（数据丢失），以及将结果稀疏化。这个过程会生成一个稀疏矩阵，这有助于我们更有效地处理和分析数据。</span></section><section><span>简单来说，我们首先从一个数据集中估计出模拟所需的参数，然后用这些参数来创建一个新的模拟数据集。接下来的部分会详细解释这些步骤，但现在，我们只需要知道这两个主要步骤就可以了。</span></section><section><span>二、</span><span>Splat模拟：数据生成的奥秘</span><span></span>    <page></page></section><section><span>小伙伴们，在深入研究参数估算之前，先跟小师妹快速了解一下Splatter包的Splat模拟是怎么回事。Splat其实就是Splatter包里用来生成模拟数据的模型。它用伽马-泊松分布来模拟每个基因在每个细胞中的表达计数。这个过程中，每个基因的平均表达量是从伽马分布中模拟出来的，然后用生物学变异系数来调整，以符合均值-方差的关系。Splat还能模拟那些表达量异常的基因和随机的dropout现象，每个细胞的</span><span>库</span><span>大小也是根据对数正态分布来模拟的，这样就能更好地匹配真实数据集。</span></section><section><span>更酷的是，Splat还能模拟不同细胞类型之间的表达差异，或者细胞分化过程中表达的连续变化。这些细节我们在后面模拟计数的部分再详细说。放心，虽然听起来有点复杂，但实际操作起来就简单多了。通过模拟数据，我们可以在不接触真实样本的情况下，测试我们的分析方法，这对于研究的前期准备来说非常有帮助</span><span>。</span></section><section><span>三、</span><span>SplatParams对象：模拟参数的宝库</span><span></span></section><section><span>接下来，小师妹要给大家展示的是Splatter模拟中非常核心的部分——`SplatParams`对象。这个对象就像是我们的模拟参数的小宝库，里面存储了所有模拟需要的参数。让我们来创建一个，看看它长什么样吧。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span>params</span> &lt;- newSplatParams()</span></code><code><span><span>params</span>  </span></code></pre></section><p><br></p><section><span><img data-imgfileid="100011618" data-ratio="1.1593023255813955" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJpFuIxHeTmgp6wJqbZn3gKmvTYicbfVBibRSCOtNraeJfZmt1lc9p145Q/640?wx_fmt=png" data-type="png" data-w="860" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJpFuIxHeTmgp6wJqbZn3gKmvTYicbfVBibRSCOtNraeJfZmt1lc9p145Q/640?wx_fmt=png"></span><span></span></section><section><span>执行上面的代码后，我们会得到一个`SplatParams`类的参数对象，里面包含了基因数量、细胞数量、随机种子等全局参数，还有批次效应、平均表达水平、</span><span>库</span><span>大小、表达量异常基因、组别、差异表达、BCV（生物学变异系数）、dropout（数据丢失）和路径等一大堆参数。这些参数中，有些是可以估算的，有些是固定的，还有些是可以调整的。</span></section><section><span>获取和设置参数：定制你的模拟</span><span></span></section><section><span>如果你想要查看或修改某个特定参数，比如模拟的基因数量，可以用`getParam`函数来获取，用`setParam`函数来设置新值。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span># 查看模拟的基因数量</span></span></code><code><span>getParam(<span>params</span>, <span>"nGenes"</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011619" data-ratio="0.1388888888888889" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJIGlqHIMibyicr0RnwoBoapCw9WGdY0Rg5Ipy2xln3N8ibu5ILwkjMxFcA/640?wx_fmt=png" data-type="png" data-w="324" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJIGlqHIMibyicr0RnwoBoapCw9WGdY0Rg5Ipy2xln3N8ibu5ILwkjMxFcA/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span># 设置模拟的基因数量为5000</span></span></code><code><span><span>params</span> &lt;- setParam(<span>params</span>, <span>"nGenes"</span>, <span>5000</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011617" data-ratio="0.14150943396226415" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ01eB9f4icQibKRQlXibUFAW50TiaFJ2Fvu3SJASr0rjiaXGqWxbuUic1eZXg/640?wx_fmt=png" data-type="png" data-w="318" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ01eB9f4icQibKRQlXibUFAW50TiaFJ2Fvu3SJASr0rjiaXGqWxbuUic1eZXg/640?wx_fmt=png"></span><span></span></section><section><span>如果你想一次设置多个参数，可以用`getParams`或`setParams`函数。</span><span></span>    <page></page></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="cs"><code><span><span># 一次性设置多个参数（使用列表）</span></span></code><code><span><span>params</span> &lt;- setParams(<span>params</span>, update = list(nGenes = <span>8000</span>, mean.rate = <span>0.5</span>))</span></code><code><span><span># 作为列表提取多个参数</span></span></code><code><span>getParams(<span>params</span>, c(<span>"nGenes"</span>, <span>"mean.rate"</span>, <span>"mean.shape"</span>))</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011621" data-ratio="0.3106646058732612" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJZ7jPu1HGHA6s1GnTDwsSAicSKtB6vVJ3KsenKIKsQu3dKkfUxEdLZbw/640?wx_fmt=png" data-type="png" data-w="647" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJZ7jPu1HGHA6s1GnTDwsSAicSKtB6vVJ3KsenKIKsQu3dKkfUxEdLZbw/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="cs"><code><span><span># 一次性设置多个参数（使用额外的参数）</span></span></code><code><span><span>params</span> &lt;- setParams(<span>params</span>, mean.shape = <span>0.5</span>, de.prob = <span>0.2</span>)</span></code><code><span>Params</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011624" data-ratio="1.15625" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJrCMEvZo2XGKt5HhTu9ubD8knsGhhEnN2BOQUQMP4eIqsNiaJFibkJI7Q/640?wx_fmt=png" data-type="png" data-w="864" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJrCMEvZo2XGKt5HhTu9ubD8knsGhhEnN2BOQUQMP4eIqsNiaJFibkJI7Q/640?wx_fmt=png"></span><span></span></section><section><span>改变了的参数会以大写字母显示，这样我们就知道它们已经被定制过了，不再是默认值。</span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="cs"><code><span><span># 直接在创建时设置参数</span></span></code><code><span><span>params</span> &lt;- newSplatParams(lib.loc = <span>12</span>, lib.scale = <span>0.6</span>)</span></code><code><span>getParams(<span>params</span>, c(<span>"lib.loc"</span>, <span>"lib.scale"</span>))    </span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011623" data-ratio="0.2608695652173913" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ3UwFnGNj2767KzL5hR8PQOiaQmZ8qxpVrn6AkF1ZNmfbf1oU2iauFdXA/640?wx_fmt=png" data-type="png" data-w="506" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ3UwFnGNj2767KzL5hR8PQOiaQmZ8qxpVrn6AkF1ZNmfbf1oU2iauFdXA/640?wx_fmt=png"></span><span></span></section><section><span>通过这种方式，我们可以轻松地定制我们的模拟参数，让模拟数据更贴近我们研究的需求。是不是很方便呢？</span></section><section><span>四、</span><span>参数估算：让模拟更精准</span><span></span></section><section><span>你知道么，Splatter包的`splatEstimate`函数能帮我们从含有计数数据的集合中估算出许多参数。这就像是给模拟数据装上了一个精准的指南针，让它更贴近真实世界的数据。下面，就让我们一起来看看这神奇的步骤吧！</span></section><section><span>首先，我们需要获取一个模拟的计数矩阵。这里我们用`scater`包的`mockSCE`函数来生成一个模拟的单细胞数据对象`sce`，然后从中提取计数矩阵。</span></section><section><span></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="objectivec"><code><span><span># 获取模拟的计数矩阵</span></span></code><code><span>counts &lt;- counts(sce)</span></code><code><span><span># 检查counts是否为整数矩阵</span></span></code><code><span><span>class</span>(counts)</span></code><code><span><span>typeof</span>(counts)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011622" data-ratio="0.33460076045627374" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJSG8ky0ttptUuWD89X4tA1a5rhqbyN7gc2cZ79Q2aWwfxrzVspdENibQ/640?wx_fmt=png" data-type="png" data-w="263" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJSG8ky0ttptUuWD89X4tA1a5rhqbyN7gc2cZ79Q2aWwfxrzVspdENibQ/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 查看维度，每一行代表一个基因，每一列代表一个细胞</span></span></code><code><span><span>dim</span>(counts)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011625" data-ratio="0.2903225806451613" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJze6Acv74U6QWS2wHDrZ5V2wTgRmkNxGy3GwmRQrkGd4C0dcib2BgdrA/640?wx_fmt=png" data-type="png" data-w="155" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJze6Acv74U6QWS2wHDrZ5V2wTgRmkNxGy3GwmRQrkGd4C0dcib2BgdrA/640?wx_fmt=png"></span></section><section><span>我们可以通过查看矩阵的前几行来了解数据的概貌</span><span>。</span><span>这个计数矩阵是一个整数矩阵，每一行代表一个基因，每一列代表一个细胞。</span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="makefile"><code><span><span># 显示前几项数据</span></span></code><code><span><span>counts[1:5, 1:5]  </span></span></code></pre></section><p><br></p><section><span><img data-imgfileid="100011626" data-ratio="0.2365079365079365" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJsDpg6VrIJks1Gdy3rHzAjhA9ibGsAotJNxXUQicTxyIVNa4e0l8ATUicQ/640?wx_fmt=png" data-type="png" data-w="630" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJsDpg6VrIJks1Gdy3rHzAjhA9ibGsAotJNxXUQicTxyIVNa4e0l8ATUicQ/640?wx_fmt=png"><span>        </span><p> </p></span></section><section><span>接下来，就是重头戏——参数估算了。我们会用`splatEstimate`函数来完成这个任务。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span># 参数估算</span></span></code><code><span><span>params</span> &lt;- splatEstimate(counts)</span></code></pre></section><section><span></span><span></span></section><section><span>这个过程包括几个步骤：</span></section><section><span>1. 平均参数：通过拟合平均表达水平的伽马分布来估算。</span></section><section><span>2. </span><span>库</span><span>大小参数：通过拟合</span><span>库</span><span>大小的对数正态分布来估算。</span></section><section><span>3. 表达量异常参数：通过确定异常值的数量，并拟合这些异常值与中位数差异的对数正态分布来估算。</span></section><section><span>4. BCV参数：使用`edgeR`包中的`estimateDisp`函数来估算。</span></section><section><span>5. Dropout参数：通过检查dropout现象是否存在，并拟合平均表达水平与零值比例之间的关系的逻辑函数来估算。</span></section><section><span>通过这些步骤，我们就能获得一组贴近真实数据的参数，用它们来模拟新的数据集，是不是很棒呢？这样一来，我们就能在不接触真实样本的情况下，测试和验证我们的分析方法了。</span></section><section><span>五、</span><span>模拟计数：用`splatSimulate`生成数据</span><span></span></section><section><span>当我们对一组参数感到满意后，就可以用这些参数来生成新的数据集了。如果我们想要微调这些参数，可以直接在函数中提供它们；如果我们不提供任何参数，就会使用默认值。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span>sim &lt;- splatSimulate(<span>params</span>, nGenes = <span>1000</span>)    </span></code><code><span>sim</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011629" data-ratio="0.38565022421524664" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJHbpH4FOZfCa5CW6m43Ihn83YjM9SA4pgpIEDQQvbfb0rC4JBwKaJmw/640?wx_fmt=png" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJHbpH4FOZfCa5CW6m43Ihn83YjM9SA4pgpIEDQQvbfb0rC4JBwKaJmw/640?wx_fmt=png"></span><span></span></section><section><span>执行上面的代码后，我们会得到一个`SingleCellExperiment`对象，里面包含了1000个特征（基因）和200个样本（细胞）。这个对象的主要部分是一个特征乘以样本的矩阵，包含了模拟的计数数据，我们可以通过`counts`来访问这些数据。此外，这个对象还可以包含其他表达量度量，比如FPKM或TPM。此外，`SingleCellExperiment`对象还包含了每个细胞的表型信息（通过`colData`访问）和每个基因的特征信息（通过`rowData`访问）。Splatter利用这些插槽以及`assays`来存储模拟过程中的中间值。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="makefile"><code><span><span># 访问计数数据</span></span></code><code><span><span>counts(sim)[1:5, 1:5]</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011628" data-ratio="0.3559718969555035" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJia1F9do2AxKhn5RoeNlUW9Pr6UKZ12BqOc0LHibj4pPWKg9yoFRdX5TQ/640?wx_fmt=png" data-type="png" data-w="427" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJia1F9do2AxKhn5RoeNlUW9Pr6UKZ12BqOc0LHibj4pPWKg9yoFRdX5TQ/640?wx_fmt=png"></span><span></span></section><section><span>我们可以访问关于基因的信息，比如基础基因均值、异常因子和基因均值等。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 基因信息</span></span></code><code><span><span>head</span>(rowData(sim))</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011627" data-ratio="0.3467741935483871" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJuHbJutCHAnpTibIOTuDqow5qT7XjrU5hESv8oK2fUQ9IDdJweNWSEIQ/640?wx_fmt=png" data-type="png" data-w="620" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJuHbJutCHAnpTibIOTuDqow5qT7XjrU5hESv8oK2fUQ9IDdJweNWSEIQ/640?wx_fmt=png"></span><span></span></section><section><span>同样，我们也可以获取关于细胞的信息，比如每个细胞所属的组或路径、预期的</span><span>库</span><span>大小等。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 细胞信息</span></span></code><code><span><span>head</span>(colData(sim)) </span></code></pre></section><p><br></p><section><span><img data-imgfileid="100011630" data-ratio="0.47186147186147187" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ1YHbDLicOssNrRMWH8FVLa3ePebQPh4yc8ZFAIO9Siakvu5THniaTGgAQ/640?wx_fmt=png" data-type="png" data-w="462" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ1YHbDLicOssNrRMWH8FVLa3ePebQPh4yc8ZFAIO9Siakvu5THniaTGgAQ/640?wx_fmt=png"></span><span></span></section><section><span>此外，我们还可以查看基因与细胞之间的矩阵信息，比如每个基因在每个细胞中的表达均值、生物学变异系数（BCV）、细胞均值、真实计数和dropout信息等。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span><span># 基因与细胞矩阵信息</span></span></code><code><span><span>names</span>(assays(sim))</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011633" data-ratio="0.043761638733705775" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJAHtvgHFSBXtQmHBDajyu3mZRTJAV4YrqHAFCJLNOlx8e1vMjApwVZQ/640?wx_fmt=png" data-type="png" data-w="1074" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJAHtvgHFSBXtQmHBDajyu3mZRTJAV4YrqHAFCJLNOlx8e1vMjApwVZQ/640?wx_fmt=png"></span><span></span></section><section><span>我们还可以得到</span><span>细胞均值矩阵，并查看前几行和前几列的数据：</span></section><section><ul><li></ul><pre data-lang="bash"><code><span>assays(sim)<span>$CellMeans</span>[1:5, 1:5]</span></code></pre></section><section><span><img data-imgfileid="100011631" data-ratio="0.23170731707317074" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJN2RibMibbob942rQ0wdBE9qiaDqyOjPrXoKKF14kD7XxETtOuAa2zF9jg/640?wx_fmt=png" data-type="png" data-w="656" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJN2RibMibbob942rQ0wdBE9qiaDqyOjPrXoKKF14kD7XxETtOuAa2zF9jg/640?wx_fmt=png"></span><span></span></section><section><span>执行这个命令后，我们会得到一个矩阵，里面包含了五个基因（Gene1到Gene5）在五个细胞（Cell1到Cell5）中的表达均值。这些数值可以帮助我们理解基因在不同细胞中的表达模式。</span></section><section><span>使用`SingleCellExperiment`对象的另一个大好处是，我们可以立即使用其他分析包，比如`scater`包中的绘图函数。例如，我们可以制作</span><span><span>PCA图</span></span><span></span><span>来可视化数据。</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="properties"><code><span><span># 使用scater计算logcounts并绘制PCA图</span></span></code><code><span><span>sim</span> <span>&lt;- logNormCounts(sim)</span></span></code><code><span><span>sim</span> <span>&lt;- runPCA(sim)</span></span></code><code><span><span>plotPCA(sim)</span>    <span></span></span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011635" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJaV0ibIoicWTYPXcgVOVNPr0aaE4CPu8icp8UjCUyibb1RDgR4C9hjK7f3w/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJaV0ibIoicWTYPXcgVOVNPr0aaE4CPu8icp8UjCUyibb1RDgR4C9hjK7f3w/640?wx_fmt=png"></span></section><section><span>注意：由于模拟是随机的，每次运行的结果可能会有所不同。</span></section><section><span>通过这些步骤，我们就能生成一个包含丰富信息的模拟数据集，并且可以利用现有的分析工具进行进一步的分析。是不是感觉Splatter包超级强大呢？如果你在模拟数据的过程中有任何疑问，记得找小师妹帮忙哦！</span></section><section><span>模拟细胞群组</span><span></span></section><section><span>想象一下，我们不仅想研究单一类型的细胞，还想看看不同细胞类型混合在一起时会发生什么。Splatter包可以通过改变`method`参数来模拟这种情况。比如，我们可以设置`group.prob`参数，并把`method`参数设为"groups"来模拟两组细胞。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="cs"><code><span>sim.groups &lt;- splatSimulate(</span></code><code><span>    <span>group</span>.prob = c(<span>0.5</span>, <span>0.5</span>),</span></code><code><span>    method = <span>"groups"</span>,</span></code><code><span>    verbose = FALSE)</span></code><code><span>sim.groups &lt;- logNormCounts(sim.groups)</span></code><code><span>sim.groups &lt;- runPCA(sim.groups)</span></code><code><span>plotPCA(sim.groups, colour_by = <span>"Group"</span>)    </span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011632" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ9QJDXGj6o2cWFWsJuRJTBPj6sXia3gxTtRtuEOibNjoBocSCO313iad9w/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJ9QJDXGj6o2cWFWsJuRJTBPj6sXia3gxTtRtuEOibNjoBocSCO313iad9w/640?wx_fmt=png"></span></section><section><span>如果我们把两组细胞的概率都设为0.5，那么我们应该能得到大约相等数量的细胞（在这个例子中大约是50个）。如果我们想要不等数量的细胞群，我们可以把`group.prob`设为任何加起来等于1的概率集合。</span></section><section><span>模拟分化路径</span><span></span></section><section><span>另一个我们经常感兴趣的情况是细胞分化过程，其中一个细胞类型逐渐转变为另一种类型。Splatter通过模拟两组之间的一系列步骤，并随机将每个细胞分配给一个步骤来近似这个过程。我们可以使用"paths"方法来创建这种模拟。</span><span></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="objectivec"><code><span>sim.paths &lt;- splatSimulate(</span></code><code><span>    de.prob = <span>0.2</span>,</span></code><code><span>    nGenes = <span>1000</span>,</span></code><code><span>    method = <span>"paths"</span>,</span></code><code><span>    verbose = <span>FALSE</span>)</span></code><code><span>sim.paths &lt;- logNormCounts(sim.paths)</span></code><code><span>sim.paths &lt;- runPCA(sim.paths)</span></code><code><span>plotPCA(sim.paths, colour_by = <span>"Step"</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011634" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJlTHCadSHetYib83ckaVCBXp3XaB9aSBvkiaHiaoPLFkp0vjHdW31l5DPA/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJlTHCadSHetYib83ckaVCBXp3XaB9aSBvkiaHiaoPLFkp0vjHdW31l5DPA/640?wx_fmt=png"></span>    <page></page></section><section><span>在这里，颜色代表了每个细胞在分化路径上的“步骤”。我们可以看到，颜色较深的细胞更接近原始细胞类型，而颜色较浅的细胞更接近最终分化的细胞类型。通过设置额外的参数，我们可以模拟更复杂的过程（例如，从单一祖细胞分化出多种成熟细胞类型）。</span></section><section><span>批次效应</span><span></span></section><section><span>在任何测序实验的分析中，批次效应都是一个重要因素，这是同一时间处理的一组样本中常见的技术变异。我们可以通过告诉Splatter每个批次中有多少个细胞来应用批次效应。</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="objectivec"><code><span>sim.batches &lt;- splatSimulate(batchCells = c(<span>50</span>, <span>50</span>), verbose = <span>FALSE</span>)</span></code><code><span>sim.batches &lt;- logNormCounts(sim.batches)</span></code><code><span>sim.batches &lt;- runPCA(sim.batches)</span></code><code><span>plotPCA(sim.batches, colour_by = <span>"Batch"</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011639" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJDiciaAtLot2KpWOwvDIiakvEvqYy1fg9ugKUalOYOHleQYD0XA6ODEvTw/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJDiciaAtLot2KpWOwvDIiakvEvqYy1fg9ugKUalOYOHleQYD0XA6ODEvTw/640?wx_fmt=png"></span></section><section><span>这看起来和我们模拟群组时很像，因为过程非常相似。不同的是，批次效应适用于所有基因，不仅仅是那些差异表达的基因，而且效应通常较小。通过结合群组和批次，我们可以模拟我们不感兴趣的变异（批次）和我们感兴趣的变异（群组）。</span></section><section><span>模拟不同的表达值</span></section><section><span>Splatter默认是设计来模拟计数数据的，但有些分析方法可能需要其他类型的表达值，尤其是长度标准化的值，比如TPM或FPKM。scater包有函数可以将这些值添加到SingleCellExperiment对象中，但它们需要每个基因的长度。这时，我们可以用addGeneLengths函数来模拟这些长度。</span>    <page></page></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="properties"><code><span><span>sim</span> <span>&lt;- simpleSimulate(verbose = FALSE)</span></span></code><code><span><span>sim</span> <span>&lt;- addGeneLengths(sim)</span></span></code><code><span><span>head(rowData(sim))</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011637" data-ratio="0.48322147651006714" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJtKhMjwyIwvWXfb5n5D8fFGibfibqtUeeaS5mpn97hnpzhJrzWIcTvWAw/640?wx_fmt=png" data-type="png" data-w="447" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJtKhMjwyIwvWXfb5n5D8fFGibfibqtUeeaS5mpn97hnpzhJrzWIcTvWAw/640?wx_fmt=png"></span><span></span></section><section><span>然后，我们就可以用scater来计算TPM了。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="bash"><code><span>tpm(sim) &lt;- calculateTPM(sim, rowData(sim)<span>$Length</span>)</span></code><code><span>tpm(sim)[1:5, 1:5]</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011636" data-ratio="0.29" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJGpgSfKTXmoUgMtD3TcCWJQt81jjrThLFI6gCGn0ia3XGgsdHm7yTERw/640?wx_fmt=png" data-type="png" data-w="600" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJGpgSfKTXmoUgMtD3TcCWJQt81jjrThLFI6gCGn0ia3XGgsdHm7yTERw/640?wx_fmt=png"></span><span></span></section><section><span>默认情况下，addGeneLengths使用对数正态分布生成值，然后四舍五入得到整数长度。这个分布的参数是基于人类蛋白质编码基因的，但如果需要，也可以调整（比如针对其他物种）。或者，也可以从一个提供的向量中抽样长度。</span></section><section><span>缩减模拟大小</span></section><section><span>在使用Splatter包模拟数据时，我们会得到很多中间值，这些值虽然有助于评估，但也会大大增加数据的大小。如果你不需要这些中间值，我们可以用`minimiseSCE()`函数来缩减模拟数据的大小，非常实用哦！</span></section><section><span>首先，我们运行`splatSimulate()`函数来生成模拟数据：</span></section><section><ul><li></ul><pre data-lang="nginx"><code><span><span>sim</span> &lt;- splatSimulate()</span></code></pre></section><section><span></span></section><section><span>然后，我们使用`minimiseSCE()`函数来缩减数据大小：</span></section><section><span></span></section><section><ul><li></ul><pre><code><span>minimiseSCE(sim)    </span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011640" data-ratio="0.6002400960384153" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJYMbQEbP98cHXd2VaNWctmps2Mo2aSic3y9iaH3EAJaZhzV1ltCqrSzMQ/640?wx_fmt=png" data-type="png" data-w="833" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJYMbQEbP98cHXd2VaNWctmps2Mo2aSic3y9iaH3EAJaZhzV1ltCqrSzMQ/640?wx_fmt=png"></span><span></span></section><section><span>这个函数默认会移除`rowData(sce)`、`colData(sce)`和`metadata(sce)`中的所有内容，只保留`counts`。如果你有其他想要保留的内容，可以在函数中指定。例如，我们可以保留`Gene`、`Cell`和`Batch`列：</span><span></span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="objectivec"><code><span>minimiseSCE(sim,</span></code><code><span>    rowData.keep = <span>"Gene"</span>,</span></code><code><span>    colData.keep = c(<span>"Cell"</span>, <span>"Batch"</span>),</span></code><code><span>    metadata.keep = <span>TRUE</span>)</span></code></pre></section><section><span></span></section><section><span>这样，我们就能得到一个更小的`SingleCellExperiment`对象，同时保留了我们关心的信息。是不是很方便呢？</span></section><section><span>六、</span><span>比较模拟数据与真实数据</span></section><section><span>在模拟数据生成之后，你可能想要将其与真实数据集进行比较，或者比较不同参数或模型下的模拟结果。`splat`包提供了一个名为`compareSCEs`的函数，旨在简化这些比较工作。顾名思义，这个函数接收一组`SingleCellExperiment`对象，将数据集合并，并生成一些比较它们的图表。让我们进行两个小的模拟，看看它们如何比较。</span></section><section><span></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="php"><code><span>sim1 &lt;- splatSimulate(nGenes = <span>1000</span>, batchCells = <span>20</span>, verbose = <span>FALSE</span>)</span></code><code><span>sim2 &lt;- simpleSimulate(nGenes = <span>1000</span>, nCells = <span>20</span>, verbose = <span>FALSE</span>)    </span></code><code><span>comparison &lt;- compareSCEs(<span>list</span>(Splat = sim1, Simple = sim2))</span></code><code><span>names(comparison)</span></code><code><span>names(comparison$Plots)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011638" data-ratio="0.06481481481481481" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJpicYOmJgRicxqvnxpPlWY6UXAqdRArMWSibHve6raLvQW8Gyww0mKk2DQ/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJpicYOmJgRicxqvnxpPlWY6UXAqdRArMWSibHve6raLvQW8Gyww0mKk2DQ/640?wx_fmt=png"></span><span></span></section><section><span>返回的列表包含三个项目。前两个是通过基因（RowData）和通过细胞（ColData）合并的数据集，第三个包含一些比较图表（使用`ggplot2`生成），例如，一个展示</span><span><span>均值分布</span></span><span></span><span>的图表：</span></section><section><ul><li></ul><pre data-lang="bash"><code><span>comparison<span>$Plots</span><span>$Means</span></span></code></pre></section><section><span><img data-imgfileid="100011644" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJco4Xe6kaObP3ibytuGQo2oHTrsZR5MN1aPnf987krN1bYxAqeIFrl2Q/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJco4Xe6kaObP3ibytuGQo2oHTrsZR5MN1aPnf987krN1bYxAqeIFrl2Q/640?wx_fmt=png"></span></section><section><span>这些只是你可能想要考虑的一些图表，但应该很容易使用返回的数据制作更多图表。例如，我们可以绘制</span><span><span>表达基因数量与</span></span><span><span>库</span></span><span><span>大小的关系图</span></span><span></span><span>：</span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="bash"><code><span>library(<span>"ggplot2"</span>)</span></code><code><span>ggplot(comparison<span>$ColData</span>, aes(x = sum, y = detected, colour = Dataset)) +</span></code><code><span>    geom_point()</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011643" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJFunMxl7pFUY8QRl4UyjHo4KAmOaUMZKfh8Xx3cnf9OLxN8iaB3GdmsQ/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJFunMxl7pFUY8QRl4UyjHo4KAmOaUMZKfh8Xx3cnf9OLxN8iaB3GdmsQ/640?wx_fmt=png"></span></section><section><span>比较差异</span></section><section><span>有时，与其直观地比较数据集，不如看看它们之间的差异。我们可以使用`diffSCEs`函数来实现这一点。类似于`compareSCEs`，这个函数也接收一组`SingleCellExperiment`对象，但现在我们还需要指定一个作为参考的数据集。返回的一系列图表与之前类似，但它们不是展示整体分布，而是展示</span><span><span>与参考数据集的差异</span></span><span></span><span>。</span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="nginx"><code><span><span>difference</span> &lt;- diffSCEs(list(Splat = sim1, Simple = sim2), ref = <span>"Simple"</span>)</span></code><code><span>difference<span>$Plots</span><span>$Means</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011641" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJVUmn6ibzrZcyE2gOYFZEfINKsr2x1sXibbJfiaz63yJTvECOtJE1a5noQ/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJVUmn6ibzrZcyE2gOYFZEfINKsr2x1sXibbJfiaz63yJTvECOtJE1a5noQ/640?wx_fmt=png"></span></section><section><span>我们还会得到一系列</span><span><span>分位数-分位数图</span></span><span></span><span>，可以用来比较分布。</span></section><section><ul><li></ul><pre data-lang="bash"><code><span>difference<span>$QQPlots</span><span>$Means</span></span></code></pre></section><section><span><img data-imgfileid="100011642" data-ratio="0.7261785356068204" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJd6QLEs98Buv9PPNLWmTmdGFTbloOQIC9Zylozl2GAQ9ibsicBiadD0YAA/640?wx_fmt=png" data-type="png" data-w="997" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJd6QLEs98Buv9PPNLWmTmdGFTbloOQIC9Zylozl2GAQ9ibsicBiadD0YAA/640?wx_fmt=png"></span></section><section><span>制作面板</span><span></span></section><section><span>这些比较会生成多个图表，可能会让人眼花缭乱。为了简化这个过程，或者为了制作出版物中的图表，你可以使用`makeCompPanel`、`makeDiffPanel`和`makeOverallPanel`函数。</span>    <page></page></section><section><span>这些函数使用`cowplot`包将图表合并成一个面板。面板可能会很大，难以查看（例如，在RStudio的图表查看器中），因此最好输出面板并单独查看。幸运的是，`cowplot`提供了一个方便的函数来保存图像。以下是输出每个面板的一些建议参数：</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cpp"><code><span>panel &lt;- makeCompPanel(comparison)</span></code><code><span>cowplot::save_plot(<span>"comp_panel.png"</span>, panel, nrow = <span>4</span>, ncol = <span>3</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011645" data-ratio="0.8240740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJgq1LFscbccWtImqeQtfjRgYJC4cib4x3SgeaDBOsM6BDTNFibqu44uBg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJgq1LFscbccWtImqeQtfjRgYJC4cib4x3SgeaDBOsM6BDTNFibqu44uBg/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cpp"><code><span>panel &lt;- makeDiffPanel(difference)</span></code><code><span>cowplot::save_plot(<span>"diff_panel.png"</span>, panel, nrow = <span>3</span>, ncol = <span>5</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011646" data-ratio="0.37037037037037035" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJjVd0Ew4UNmMicVpicGpwpmIibv3vpswMf9ShuFwknficCJ7DvoBvhEXQdg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJjVd0Ew4UNmMicVpicGpwpmIibv3vpswMf9ShuFwknficCJ7DvoBvhEXQdg/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cpp"><code><span>panel &lt;- makeOverallPanel(comparison, difference)    </span></code><code><span>cowplot::save_plot(<span>"overall_panel.png"</span>, panel, ncol = <span>4</span>, nrow = <span>7</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011647" data-ratio="1.0814814814814815" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJJkw799R3gMIteNbrMDkdvuQF1IElOvS137fbrykalwiahgglclw6Svg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUmjlK7RC1kwqnnic1wM0LiaJJkw799R3gMIteNbrMDkdvuQF1IElOvS137fbrykalwiahgglclw6Svg/640?wx_fmt=png"></span></section><section><span>通过这些函数，我们可以更直观地比较不同模拟数据集之间的差异，并且能够将这些比较整合成一个易于查看和理解的面板。这样，无论是在研究中还是在准备发表的论文中，我们都能够更有效地展示我们的发现。</span></section><section><span>通过使用Splatter包进行模拟，我们能够高效地生成单细胞RNA测序数据，为研究提供了强有力的支持。这不仅帮助我们理解基因表达的复杂性，也为未来的生物医学研究奠定了基础。</span><span>如果你对如何应用这个强大的工具有任何疑问，记得找小师妹，让我们一起探索基因组的奥秘！</span></section><section><span>无论你是在优化代码，还是在云端进行便捷的分析，云生信神器都能为你提供强大的支持。</span><span>欢迎试试我们的云生信神器，只需一键上传数据，想要的图就能轻松get~</span></section><section><span>云生信平台链接：http://www.biocloudservice.com/home.html</span><span></span> <page></page></section><p><br><span></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p>E</p></section></section><section><section powered-by="xiumi.us"><p>N</p></section></section><section><section powered-by="xiumi.us"><p>D</p></section></section><section><section powered-by="xiumi.us"><section><br></section></section></section></section></section><p><span>如果您的时间和精力有限或者缺乏相关经验，并且对生信分析和服务器有所需要的话，我们非常乐意为您提供如下服务：免费思路评估、付费生信分析和方案设计以及服务器租赁等，有意向的小伙伴欢迎咨询师妹哦！</span></p><p><span></span><span></span></p><section powered-by="xiumi.us"><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="257" data-galleryid="" data-imgfileid="100011649" data-ratio="0.4444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4A5AM9THY9KGGFrwlIYT6bnbpsuhEo8moBRrMZibpIyv1NNcQAAGajRVQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEU8snR3OLBX3wdjR4oZ7c4A5AM9THY9KGGFrwlIYT6bnbpsuhEo8moBRrMZibpIyv1NNcQAAGajRVQ/640?wx_fmt=jpeg&amp;from=appmsg"></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><p><strong>往期推荐</strong></p></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section powered-by="xiumi.us"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492496&amp;idx=1&amp;sn=b3be5983f3f8f068ebdf1b773b7cb792&amp;chksm=cfd6d83ff8a15129493abd81502ab5c3128247ff20fd576c1ba880303f346110e8bee971478e&amp;scene=21#wechat_redirect" textvalue="别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！</a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492387&amp;idx=1&amp;sn=fc12277c2ebd379a297d0c7a2c96c970&amp;chksm=cfd6d88cf8a1519a3a6eb4938cb44ebcb2d1b857ffc558c1c033ac88913384cb2f11d03a00f4&amp;scene=21#wechat_redirect" textvalue="师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492197&amp;idx=1&amp;sn=40540e16ddc99310445236401505c47e&amp;chksm=cfd6d9caf8a150dc8f010750cacc4bd241ed68a8974593d499c1b34edf5f222de567732a5705&amp;scene=21#wechat_redirect" textvalue="是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247488665&amp;idx=1&amp;sn=6d7b7b1e8b36a92df691b0ab014e7663&amp;chksm=cfd52f36f8a2a620a790e74d99e3d8af879904a131c4e1f653448590453941b7ff356d486531&amp;scene=21#wechat_redirect" textvalue="师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅</a></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/juoO2v8lBhIuomTtZaRHVA",target="_blank" rel="noopener noreferrer">原文链接</a>
