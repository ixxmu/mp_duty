---
title: "圆角矩形确实很好看"
date: 2024-11-16T01:47:58Z
draft: ["false"]
tags: [
  "fetched",
  "生信杂货铺"
]
categories: ["Acdemic"]
---
圆角矩形确实很好看 by 生信杂货铺
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器" data-remoteid="c1731679976651" data-cacheurl="https://files.mdnice.com/koala-2.png"><span>圆角矩形绘制</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>数据准备</span><span></span></h3><p data-tool="mdnice编辑器">导入包</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(grid)<br><span>library</span>(ggpubr)<br><span>library</span>(cowplot)<br><span>library</span>(ggforce)<br><span>library</span>(tidyverse)<br></code></pre><p data-tool="mdnice编辑器">导入自定义函数，这三个函数是自己封装的，可以到知识星球获取。</p><p data-tool="mdnice编辑器">也可以自己封装改写 <code>ggforce</code> 包中的 <code>geom_shape</code> 对象，基本也可以实现类似的功能。</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkxMjE4NDc2Mw==&amp;mid=2247493816&amp;idx=1&amp;sn=6aadb8d730d9df23fec24235d84779ae&amp;chksm=c1126c6cf665e57a862a7bbb9c069ecd17d10450d7607aad2a2ee3992a95ec7b131ce6bd7266&amp;scene=21#wechat_redirect" textvalue="R 数据可视化 —— ggforce（形状）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R 数据可视化 —— ggforce（形状）</a><br></p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkxMjE4NDc2Mw==&amp;mid=2247493900&amp;idx=1&amp;sn=266e06e5f5c2c9e4f403fb5aa3a0b1ef&amp;chksm=c1126dd8f665e4ce03f5bf338b31ff0afea145b3a7574bba19860f42797820cd3b00461ac63d&amp;scene=21#wechat_redirect" textvalue="R 数据可视化 —— ggforce（线条）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R 数据可视化 —— ggforce（线条）</a><br></p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzkxMjE4NDc2Mw==&amp;mid=2247493965&amp;idx=1&amp;sn=f9b393511189551b7f60c10ff32a1873&amp;chksm=c1126d99f665e48ff829f3ff9ee35c597cb3be77cda9e2f549a4e5c5ddf77fdd1d337a33179c&amp;scene=21#wechat_redirect" textvalue="R 数据可视化 —— ggforce（注释和分面）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">R 数据可视化 —— ggforce（注释和分面）</a><br></p><pre data-tool="mdnice编辑器"><span></span><code><span>source</span>(<span>'code/geom-round-rect.R'</span>)<br><span>source</span>(<span>'code/geom-round-bar.R'</span>)<br><span>source</span>(<span>'code/geom-round-col.R'</span>)<br></code></pre><p data-tool="mdnice编辑器">获取数据</p><p data-tool="mdnice编辑器">下载 <span>TCGA-Pancancer</span><sup>[1]</sup> 研究中提供的补充文件</p><ul data-tool="mdnice编辑器"><li><section><span>TCGA-Clinical Data Resource (CDR) Outcome</span><sup>[2]</sup></section></li></ul><p data-tool="mdnice编辑器">将文件放入 <code>data</code> 文件夹中，然后就可以读取数据了</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| warning: false</span><br><span>#| message: false</span><br><br>CDR &lt;- readxl::read_excel(<span>'data/TCGA-CDR-SupplementalTableS1.xlsx'</span>) %&gt;%<br>    dplyr::select(-<span>1</span>)<br></code></pre><p data-tool="mdnice编辑器">导入之前处理好的 <code>TCGA-LIHC</code> 表达数据</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>'data/TCGA-LIHC.exprs.rda'</span>)<br></code></pre><p data-tool="mdnice编辑器">从 <code>UCSC xena</code> 下载 <code>GDC LIHC</code> 的突变数据</p><pre data-tool="mdnice编辑器"><span></span><code><span># https://gdc-hub.s3.us-east-1.amazonaws.com/download/TCGA-LIHC.somaticmutation_wxs.tsv.gz</span><br>lihc.mut &lt;- read_tsv(<span>'data/TCGA-LIHC.somaticmutation_wxs.tsv.gz'</span>,<br>                     show_col_types = <span>FALSE</span>) %&gt;%<br>    dplyr::select(c(<span>'sample'</span>, <span>'gene'</span>, <span>'effect'</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>自定义样式</span><span></span></h3><p data-tool="mdnice编辑器">定义图例的圆角矩形边框</p><pre data-tool="mdnice编辑器"><span></span><code><span>#' @export</span><br><span>#' @rdname element</span><br>element_round_rect &lt;- <span>function</span>(fill = <span>NULL</span>, colour = <span>NULL</span>, linewidth = <span>NULL</span>,<br>  linetype = <span>NULL</span>, color = <span>NULL</span>, inherit.blank = <span>FALSE</span>, radius = <span>NULL</span>) {<br>    <br>    <span>if</span> (!is.null(color))  colour &lt;- color<br>    structure(<br>        list(fill = fill, colour = colour, linewidth = linewidth, <br>             linetype = linetype, radius = radius,<br>             inherit.blank = inherit.blank),<br>        class = c(<span>"element_round_rect"</span>, <span>"element_rect"</span>, <span>"element"</span>)<br>    )<br>}<br><br>element_grob.element_round_rect &lt;- <span>function</span>(<br>        element, x = <span>0.5</span>, y = <span>0.5</span>, width = <span>1</span>, height = <span>1</span>, <br>        radius = <span>NULL</span>,<br>        fill = <span>NULL</span>, colour = <span>NULL</span>, linewidth = <span>NULL</span>, linetype = <span>NULL</span>,<br>        <span>...</span>) {<br><br>    <span># The gp settings can override element_gp</span><br>    gp &lt;- gpar(<br>        lwd = linewidth %||% element$linewidth, <br>        col = colour %||% element$colour, <br>        fill = fill %||% element$fill, <br>        lty = linetype %||% element$linetype)<br>    <span># radius</span><br>    r &lt;- radius %||% element$radius<br>    roundrectGrob(x, y, width, height, r = r, gp = gp, <span>...</span>)<br>}<br></code></pre><p data-tool="mdnice编辑器">定义颜色和主题</p><pre data-tool="mdnice编辑器"><span></span><code>my_colors &lt;- list(<br>    two = c(<span>'#a1d76a'</span>, <span>'#e9a3c9'</span>),<br>    three = c(<span>'#0099e5'</span>, <span>'#ff4c4c'</span>, <span>'#34bf49'</span>),<br>    four = c(<span>'#ed6ca4'</span>, <span>'#fbb05b'</span>, <span>'#acd372'</span>, <span>'#7bc4e2'</span>),<br>    five = c(<span>'#f29c98'</span>, <span>'#f5b697'</span>, <span>'#f5e797'</span>, <span>'#a2e4f5'</span>, <span>'#009dd3'</span>),<br>    gradient = c(<span>'#009392'</span>, <span>'#39b185'</span>, <span>'#9ccb86'</span>, <span>'#e9e29c'</span>,<br>                 <span>'#eeb479'</span>, <span>'#e88471'</span>, <span>'#cf597e'</span>)<br>)<br><br>my_theme &lt;- theme_minimal() +<br>    theme(panel.grid = element_blank(),<br>          axis.title = element_text(size = <span>14</span>, face = <span>'bold'</span>),<br>          axis.line.y.left = element_line(colour = <span>'black'</span>),<br>          axis.line.x.bottom = element_line(colour = <span>'black'</span>),<br>          legend.background = element_round_rect(<br>              colour = <span>'#a5aa99'</span>, radius = unit(<span>10</span>, <span>'pt'</span>), linewidth = <span>1.5</span>))<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>简单柱状图</span><span></span></h3><p data-tool="mdnice编辑器">可视化 TCGA 不同癌症类型中的患者数量分布</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-x</span><br><br>ggplot(CDR) +<br>    geom_round_bar(aes(type, fill = type), show.legend = <span>FALSE</span>) +<br>    labs(x = <span>NULL</span>) +<br>    scale_y_continuous(expand = expansion(mult = c(<span>0</span>, <span>0.1</span>))) +<br>    my_theme +<br>    theme(axis.text.x.bottom = element_text(angle = <span>90</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016461" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5Ttbx22tSz7PWZesDSKribic1Y9yqhAZE2180kNv1552j7dnicXo0k6IKw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5Ttbx22tSz7PWZesDSKribic1Y9yqhAZE2180kNv1552j7dnicXo0k6IKw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-y</span><br><br>ggplot(CDR, aes(type)) +<br>    geom_round_bar(aes(fill = type), show.legend = <span>FALSE</span>) +<br>    geom_text(aes(label = after_stat(count)), stat = <span>"count"</span>, <br>              hjust = <span>0</span>, size = <span>3</span>) +<br>    scale_y_continuous(expand = expansion(mult = c(<span>0</span>, <span>0.1</span>))) +<br>    coord_flip() +<br>    labs(x = <span>NULL</span>) +<br>    my_theme +<br>    theme(axis.text.x.bottom = element_text(angle = <span>90</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016462" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5Vfws0icAjbVvBrcrn8JH3GDstw91Rw5C8bWyW1ARrtTfc4Z57h8CuBw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5Vfws0icAjbVvBrcrn8JH3GDstw91Rw5C8bWyW1ARrtTfc4Z57h8CuBw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>分组柱状图</span><span></span></h3><p data-tool="mdnice编辑器">数据太多，选择其中几个癌症类型来展示，看看每种癌症治愈比例有多少。</p><p data-tool="mdnice编辑器">先去掉缺失数据</p><pre data-tool="mdnice编辑器"><span></span><code>data &lt;- dplyr::filter(CDR, <br>                      type %<span>in</span>% c(<span>'BRCA'</span>, <span>'GBM'</span>, <span>'LIHC'</span>, <span>'PAAD'</span>, <span>'STAD'</span>),<br>                      tumor_status %<span>in</span>% c(<span>'WITH TUMOR'</span>, <span>'TUMOR FREE'</span>))<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>堆积柱状图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-stack</span><br><br>ggplot(data, aes(type, group = tumor_status)) +<br>    geom_round_bar(aes(fill = tumor_status), radius = unit(<span>5</span>, <span>'pt'</span>),<br>                   colour = <span>'#f7f7f7'</span>, lwd = <span>1</span>) +<br>    geom_text(aes(label = after_stat(count)), stat = <span>'count'</span>,<br>              position = position_stack(vjust = <span>0.5</span>)) +<br>    scale_fill_manual(values = my_colors$two) +<br>    labs(x = <span>NULL</span>) +<br>    my_theme +<br>    theme(axis.line.y.left = element_blank(),<br>          axis.text.y.left = element_blank())<br></code></pre><p data-tool="mdnice编辑器"><img data-imgfileid="100016463" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5fmKOJ1MvYZCJAknbzYtaT1ic5CO6jicztICqPARbeJ9RCCXTd5YAtxdg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5fmKOJ1MvYZCJAknbzYtaT1ic5CO6jicztICqPARbeJ9RCCXTd5YAtxdg/640?wx_fmt=png&amp;from=appmsg">胶质瘤确实很致命，乳腺癌还是比较乐观的</p><h4 data-tool="mdnice编辑器"><span></span><span>百分比柱状图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-fill</span><br><br>ggplot(data, aes(type, group = tumor_status)) +<br>    geom_round_bar(aes(fill = tumor_status), position = <span>'fill'</span>, <br>                   radius = unit(<span>5</span>, <span>'pt'</span>), colour = <span>'#f7f7f7'</span>) +<br>    scale_fill_manual(values = my_colors$two) +<br>    labs(x = <span>NULL</span>, y = <span>'Percent'</span>) +<br>    my_theme +<br>    scale_y_continuous(expand = expansion(<span>0</span>, <span>0</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016464" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ReWdETPMqQn2GTic6ibIr3Cic5rcEyic9n3IE0wmbaH3QrlBd4PJ3lzkqw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ReWdETPMqQn2GTic6ibIr3Cic5rcEyic9n3IE0wmbaH3QrlBd4PJ3lzkqw/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>并列比柱状图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-parallel</span><br><br>ggplot(data, aes(type, group = tumor_status)) +<br>    geom_round_bar(aes(fill = tumor_status), <br>                   position = position_dodge2(width = <span>0.5</span>),<br>                   radius = unit(<span>5</span>, <span>'pt'</span>),<br>                   colour = <span>'#f7f7f7'</span>) +<br>    geom_text(aes(label = after_stat(count)), stat = <span>'count'</span>,<br>              position = position_dodge2(width = <span>0.9</span>), <br>              vjust = <span>0</span>, hjust = <span>0.5</span>) +<br>    scale_fill_manual(values = my_colors$two) +<br>    labs(x = <span>NULL</span>) +<br>    my_theme +<br>    theme(axis.line.y.left = element_blank(),<br>          axis.text.y.left = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016465" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5pwkIEGYU8nxI3MFwcSbtbIxFAVS39kNoS2feNRAicm8u4OTAMe1ia6dQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5pwkIEGYU8nxI3MFwcSbtbIxFAVS39kNoS2feNRAicm8u4OTAMe1ia6dQ/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>带误差线柱状图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-error-bar</span><br><br>data.age &lt;- dplyr::select(data, type, age_at_initial_pathologic_diagnosis) %&gt;%<br>    rename_with(~ <span>'age'</span>, .cols = <span>2</span>) %&gt;%<br>    dplyr::filter(!is.na(age)) <br><br>data.summary &lt;- data.age %&gt;%<br>    group_by(type) %&gt;%<br>    summarise(<br>        mean_age= mean(age),<br>        .groups = <span>'drop'</span>,<br>        se = sqrt(var(age) / length(age))<br>    ) %&gt;%<br>    mutate(lower = mean_age - se, upper = mean_age + se) <br><br>data.summary %&gt;%<br>    ggplot(aes(type, mean_age)) +<br>    geom_round_col(aes(fill = type), width = <span>0.7</span>) +<br>    geom_errorbar(aes(ymin = lower, ymax = upper), width = <span>0.3</span>) +<br>    scale_fill_manual(name = <span>'Cancer Type'</span>, values = my_colors$five) +<br>    labs(x = <span>'Cancer Type'</span>, y = <span>'Age'</span>) +<br>    my_theme<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016466" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ58oG13RPDquWicgFDNXq0thsBR9q5gpH8nYWOCNwtGpk3mia0fLFtQfOQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ58oG13RPDquWicgFDNXq0thsBR9q5gpH8nYWOCNwtGpk3mia0fLFtQfOQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">诊断年龄倒是差别不大</p><h4 data-tool="mdnice编辑器"><span></span><span>带散点柱状图</span><span></span></h4><p data-tool="mdnice编辑器">提取 <code>TCGA-LIHC</code> 肿瘤分级信息</p><pre data-tool="mdnice编辑器"><span></span><code>lihc.data &lt;- dplyr::filter(CDR, type == <span>'LIHC'</span>) %&gt;%<br>    dplyr::select(c(<span>'bcr_patient_barcode'</span>, <span>'histological_grade'</span>,<br>                    <span>'ajcc_pathologic_tumor_stage'</span>)) %&gt;%<br>    rename_with(~c(<span>'sample'</span>, <span>'grade'</span>, <span>'stage'</span>)) %&gt;%<br>    mutate(stage = case_when(<br>        startsWith(stage, <span>'Stage IV'</span>) ~ <span>'Stage IV'</span>,<br>        startsWith(stage, <span>'Stage III'</span>) ~ <span>'Stage III'</span>,<br>        startsWith(stage, <span>'Stage II'</span>) ~ <span>'Stage II'</span>,<br>        startsWith(stage, <span>'Stage I'</span>) ~ <span>'Stage I'</span>,<br>        .default = <span>NA</span>),<br>        grade = ifelse(startsWith(grade, <span>'G'</span>), grade, <span>NA</span>)) %&gt;%<br>    dplyr::filter(!is.na(stage), stage != <span>'Stage IV'</span>, !is.na(grade))<br></code></pre><p data-tool="mdnice编辑器">不同分期数量</p><pre data-tool="mdnice编辑器"><span></span><code>table(lihc.data<span>$stage</span>)<br><span>#   Stage I  Stage II Stage III </span><br><span>#       174        86        86 </span><br></code></pre><p data-tool="mdnice编辑器">合并 <code>TP53</code> 基因表达数据</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| message: false</span><br><br>tp53.data &lt;- lihc.tumor[, <span>'TP53'</span>, drop = <span>FALSE</span>] %&gt;%<br>    tibble::rownames_to_column(<span>'sample'</span>) %&gt;%<br>    inner_join(lihc.data)<br></code></pre><p data-tool="mdnice编辑器">绘制带散点的柱状图</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-jitter</span><br><br>tp53.summary &lt;- group_by(tp53.data, grade) %&gt;%<br>    summarise(mu = mean(TP53))<br><br>ggplot(tp53.summary, aes(grade, mu, fill = grade)) +<br>    geom_round_col(width = 0.6, alpha = 0.8, radius = unit(15, <span>'pt'</span>)) +<br>    geom_jitter(data = tp53.data, aes(grade, TP53, fill = grade),<br>                width = 0.1, size = 3, shape = 21) +<br>    scale_fill_manual(name = NULL, values = my_colors<span>$four</span>) +<br>    labs(x = NULL, y = <span>'TP53 Expression level'</span>) +<br>    my_theme<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016467" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5U8JAGc8HnVXsaIniaWh0StbOI3R7XyH4uyzWrgAdSBFD9VbibYRJJaibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5U8JAGc8HnVXsaIniaWh0StbOI3R7XyH4uyzWrgAdSBFD9VbibYRJJaibg/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>差异显著性</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-diff</span><br><br>tp53.summary &lt;- group_by(tp53.data, stage) %&gt;%<br>    summarise(mu = mean(TP53))<br>ggplot(tp53.data, aes(stage, TP53)) +<br>    geom_round_col(aes(stage, mu, fill = stage), data = tp53.summary, <br>                   width = <span>0.6</span>, alpha = <span>0.5</span>) +<br>    geom_jitter(aes(fill = stage), width = <span>0.1</span>, size = <span>3</span>, shape = <span>21</span>,<br>                alpha = <span>0.6</span>) +<br>    stat_compare_means(aes(label = paste0(<span>"p = "</span>, after_stat(p.signif))),<br>                       comparisons = list(c(<span>'Stage I'</span>, <span>'Stage II'</span>),<br>                                          c(<span>'Stage II'</span>, <span>'Stage III'</span>),<br>                                          c(<span>'Stage I'</span>, <span>'Stage III'</span>)),<br>                       method = <span>"t.test"</span>,<br>                       bracket.size = <span>0.6</span>) +<br>    scale_fill_manual(name = <span>NULL</span>, values = my_colors$three) +<br>    labs(x = <span>NULL</span>, y = <span>'TP53 Expression level'</span>) +<br>    my_theme<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016468" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ibsqTdKnbYb5taFEEGpDpBxXia5ctnVAFP6C8KroSvVRIfTuIZUqAlqg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ibsqTdKnbYb5taFEEGpDpBxXia5ctnVAFP6C8KroSvVRIfTuIZUqAlqg/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>金字塔图</span><span></span></h4><p data-tool="mdnice编辑器">可以展示基因在肿瘤或正常中的表达均值</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-pyramid</span><br><br>df &lt;- tibble(<br>    gene = factor(paste0(<span>"gene_"</span>, rep(<span>1</span>:<span>16</span>, <span>2</span>)), <br>                  levels = paste0(<span>"gene_"</span>, <span>16</span>:<span>1</span>)),<br>    stat = c(seq(-<span>1</span>, -<span>10</span>, -<span>1</span>), seq(-<span>9</span>, -<span>4</span>, <span>1</span>), <br>               seq(<span>1</span>, <span>10</span>, <span>1</span>), seq(<span>9</span>, <span>4</span>, -<span>1</span>)),<br>    direct = rep(c(<span>"down"</span>, <span>"up"</span>), each=<span>16</span>)<br>)<br><br>ggplot(df, aes(gene, stat, fill = direct)) + <br>    geom_round_col(radius = unit(<span>5</span>, <span>'pt'</span>)) +<br>    coord_flip() + <br>    scale_y_continuous(breaks = seq(-<span>10</span>, <span>10</span>, <span>2</span>),<br>                     labels = c(seq(<span>10</span>, <span>0</span>, -<span>2</span>), seq(<span>2</span>, <span>10</span>, <span>2</span>))) +<br>    scale_fill_manual(values = my_colors$two) +<br>    my_theme<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016469" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5E1Mzbh59s2rfiacG0fX9nPjgSp3yfCVm9hNAPdlVbaiaavtRoUpQTvpQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5E1Mzbh59s2rfiacG0fX9nPjgSp3yfCVm9hNAPdlVbaiaavtRoUpQTvpQ/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>偏差图</span><span></span></h4><p data-tool="mdnice编辑器">可以搭配前面分析过的差异基因或通路富集的结果来展示。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-deviation</span><br><br>df &lt;- tibble(<br>    gene = factor(paste0(<span>'gene_'</span>, 1:20), levels = paste0(<span>'gene_'</span>, 20:1)),<br>    log2FC = c(seq(10, 1, -1), seq(-1, -10, -1)),<br>    direct = factor(rep(c(<span>'up'</span>, <span>'down'</span>), each=10), levels = c(<span>'up'</span>, <span>'down'</span>)),<br>    sign = ifelse(direct == <span>'up'</span>, 1, 0)<br>)<br><br>ggplot(df, aes(gene, log2FC, fill = direct)) + <br>    geom_round_col(radius = unit(5, <span>'pt'</span>)) +<br>    geom_text(aes(y = 0, label = gene, hjust = sign)) +<br>    coord_flip() +<br>    scale_fill_manual(values = my_colors<span>$two</span>) +<br>    my_theme +<br>    theme(axis.line.y.left = element_blank(),<br>          axis.text.y.left = element_blank(),<br>          axis.title.y.left = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016470" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ56OLXnZBC9XDvae6HCbow2Q4TP7FcWmy34EpyPtbadlYAORZL4am2xg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ56OLXnZBC9XDvae6HCbow2Q4TP7FcWmy34EpyPtbadlYAORZL4am2xg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>环状图</span><span></span></h3><p data-tool="mdnice编辑器">环状图就是换成了极坐标系，基本上和正常使用没有区别，只有一个要注意的点</p><p data-tool="mdnice编辑器">当发现图片中数据有丢失的情况，应该将半径（radius）调小，太小的形状无法做出较大的弧度弯曲</p><h4 data-tool="mdnice编辑器"><span></span><span>南丁格尔玫瑰图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-nightingale-rose</span><br><br>ggplot(data, aes(<span>type</span>, fill = <span>type</span>)) +<br>    geom_round_bar(radius = unit(5, <span>'pt'</span>), colour = <span>'#f7f7f7'</span>) +<br>    scale_fill_manual(values = my_colors<span>$five</span>) +<br>    coord_polar() +<br>    labs(x = NULL) +<br>    theme_minimal() +<br>    theme(axis.line.y.left = element_blank(),<br>          axis.text.y.left = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016471" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5umoknlTD6SyqnNtq4ziaHy226fk9k1ofMcInqrlZWjczmAgElRN0aqA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5umoknlTD6SyqnNtq4ziaHy226fk9k1ofMcInqrlZWjczmAgElRN0aqA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>径向柱状图</span><span></span></h4><p data-tool="mdnice编辑器">可以用于展示不同癌型（多分组）中某一指标（如，样本量、突变频率或某一基因）的分布情况</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot-radial-bar</span><br><br>ggplot(CDR) +<br>    geom_round_bar(aes(type, fill = type), show.legend = <span>FALSE</span>,<br>                   radius = unit(<span>1.5</span>, <span>'pt'</span>)) +<br>    coord_polar() +<br>    scale_fill_manual(values = colorRampPalette(my_colors$gradient)(<span>33</span>)) +<br>    labs(x = <span>NULL</span>, y = <span>NULL</span>) +<br>    ylim(c(-<span>500</span>, <span>1100</span>)) +<br>    theme_minimal() +<br>    theme(axis.line.y.left = element_blank(),<br>          axis.text.y.left = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016472" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5nVmZdRBIJxf32VPuZMHTuicKdbqbTpILqF2pGicGLkibWTr5Wiaiap47UpA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5nVmZdRBIJxf32VPuZMHTuicKdbqbTpILqF2pGicGLkibWTr5Wiaiap47UpA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">手动构建了一份基因突变数据，来展示不同突变类型中高频突变的基因</p><pre data-tool="mdnice编辑器"><span></span><code>lihc.mut %&gt;%<br>    group_by(effect, gene) %&gt;%<br>    summarise(count = n()) %&gt;%<br>    group_by(effect) %&gt;%<br>    arrange(-count) %&gt;%<br>    top_n(<span>3</span>)<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code><span># 设置空白柱子的个数</span><br>empty_bar = <span>2</span><br><span># 自定义突变类型</span><br>mut_type &lt;- c(<span>"Ins"</span>, <span>"Del"</span>, <span>"Mismatch"</span>, <span>"Silent"</span>)<br><span># 构造数据</span><br>custom.data &lt;- tibble(<br>  gene=paste( <span>"Gene "</span>, seq(<span>1</span>,<span>60</span>), sep=<span>""</span>),<br>  group=c(rep(<span>'Ins'</span>, <span>10</span>), rep(<span>'Mismatch'</span>, <span>30</span>), rep(<span>'Del'</span>, <span>14</span>), rep(<span>'Silent'</span>, <span>6</span>)) ,<br>  value=sample(seq(<span>10</span>,<span>100</span>), <span>60</span>, replace=<span>T</span>)<br>) %&gt;%<br>  <span># 添加 NA 数据，用于在分组之间绘制空白柱形</span><br>  add_row(tibble(<br>    gene = rep(<span>NA</span>, empty_bar * length(mut_type)),<br>    group = rep(mut_type, empty_bar),<br>    value = gene<br>  )) %&gt;%<br>  mutate(group = factor(group, levels = mut_type)) %&gt;%<br>  <span># 排序，为了让统一分组绘制在一起</span><br>  arrange(group)<br><br><span># 构造唯一标识，用作 x 轴，并按该顺序绘制</span><br>custom.data$id = <span>1</span>:nrow(custom.data)<br><span># 添加显示文本的角度</span><br>angle &lt;- <span>90</span> - <span>360</span> * (custom.data$id - <span>0.5</span>) / nrow(custom.data)<br><span># 添加内圈注释</span><br>base_anno &lt;- group_by(custom.data, group) %&gt;%<br>  summarise(start = min(id), end = max(id) - empty_bar) %&gt;%<br>  mutate(mid = (start + end) / <span>2</span>)<br></code></pre><p data-tool="mdnice编辑器">绘制图像</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: plot_mutation</span><br><span>#| warning: false</span><br>  <br>ggplot(custom.data, aes(id, value, fill = group)) +<br>    geom_round_col(position = position_dodge2(), radius = unit(<span>2</span>, <span>'pt'</span>)) +<br>    <span># 基因名称</span><br>    geom_text(aes(y = value + <span>18</span>, label = gene,<br>                  hjust = ifelse(angle &gt; -<span>90</span>, <span>0.3</span>, <span>0.7</span>)), <br>              size = <span>2.5</span>, alpha = <span>0.6</span>, <br>            angle = ifelse(angle &lt; -<span>90</span>, angle + <span>180</span>, angle)) +<br>    <span># 内圈线段</span><br>    geom_segment(data = base_anno, <br>                 aes(x = start, y = -<span>5</span>, xend = end, yend = -<span>5</span>),<br>                 colour = <span>"grey40"</span>) +<br>    <span># 分组标签</span><br>    geom_text(data = base_anno, aes(x = mid, y = -<span>18</span>, label = group), <br>              angle = c(-<span>26</span>, -<span>100</span>, -<span>50</span>, <span>26</span>), colour = <span>"grey40"</span>) +<br>    coord_polar() +<br>    scale_fill_manual(values = my_colors$four) +<br>    ylim(-<span>100</span>,<span>120</span>) +<br>    theme(<br>        panel.background = element_blank(),<br>        axis.text = element_blank(),<br>        axis.ticks = element_blank(),<br>        axis.title = element_blank(),<br>        panel.grid = element_blank(),<br>    )<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016473" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5pcH0WAeqXzV6icFyaEFX2hwVYvmeotfs6X7h8BxMnUDv4Xq9CqlNiaEQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5pcH0WAeqXzV6icFyaEFX2hwVYvmeotfs6X7h8BxMnUDv4Xq9CqlNiaEQ/640?wx_fmt=png&amp;from=appmsg"></figure><section><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-traceid="cbcb41f7-fac5-4d14-8a97-a45ad2fcee5awxcc9a104b861c9084" data-appid="wxcc9a104b861c9084" data-adtype="mini-game" data-goodssouce="1" data-cpsversion="v112" data-playcpstype="1"></mp-common-cpsad></section><h3 data-tool="mdnice编辑器"><span>圆角矩形</span><span></span></h3><p data-tool="mdnice编辑器">下面介绍两个使用 <code>geom_round_rect</code> 函数的例子</p><h4 data-tool="mdnice编辑器"><span></span><span>马赛克图</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>set.seed(<span>123</span>)<br>df &lt;- tibble(<br>    gene = rep(LETTERS[<span>1</span>:<span>5</span>], <span>4</span>),<br>    status = rep(c(<span>"alpha"</span>, <span>"beta"</span>, <span>"gamma"</span>, <span>"delta"</span>), each = <span>5</span>),<br>    value = sample(<span>1</span>:<span>100</span>, <span>20</span>),<br>    percent = rep(c(<span>10</span>, <span>30</span>, <span>30</span>, <span>20</span>, <span>10</span>), <span>4</span>)<br>)<br><br>df %&gt;% <br>    group_by(status) %&gt;%<br>    mutate(xmax = cumsum(percent), xmin = xmax - percent) %&gt;%<br>    group_by(gene) %&gt;% <br>    mutate(ytmp = value * <span>100</span> / sum(value), <br>           ymax = cumsum(ytmp), ymin = ymax - ytmp) %&gt;%<br>    mutate(x = (xmin + xmax) / <span>2</span>, y = (ymin + ymax) / <span>2</span>) %&gt;%<br>    ggplot() + <br>    geom_round_rect(aes(xmin = xmin, ymin = ymin,<br>                        xmax = xmax, ymax = ymax, fill = status),<br>                    colour = <span>"#eef3ef"</span>, radius = unit(<span>10</span>, <span>'pt'</span>)) +<br>    geom_text(aes(x, y, label = paste0(round(ytmp, <span>2</span>), <span>"%"</span>))) +<br>    geom_text(aes(x = x, y = <span>103</span>, label = gene)) +<br>    scale_fill_manual(values = my_colors$four) +<br>    theme(panel.background = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016474" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5WRVwzh6hPSw5xtWIt56KiclWumokJS0UBJNII6xulqiaDzEcVPyFxTgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5WRVwzh6hPSw5xtWIt56KiclWumokJS0UBJNII6xulqiaDzEcVPyFxTgw/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>瀑布图</span><span></span></h4><p data-tool="mdnice编辑器">整理突变数据，突变类型有点<span>多，挑选一些频率较高的突变类型来说明。</span><span>具体分析需要根据自己的需求进行调整</span></p><pre data-tool="mdnice编辑器"><span></span><code><span>#| message: false</span><br><br>mut_type &lt;- c(<span>'missense_variant'</span>, <span>'frameshift_variant'</span>, <span>'intron_variant'</span>,<br>              <span>'stop_gained'</span>, <span>'synonymous_variant'</span>)<br><br>mut.data &lt;- lihc.mut %&gt;% select(sample, gene, effect) %&gt;%<br>  distinct() %&gt;%<br>  filter(effect %<span>in</span>% mut_type)<br><br>genes &lt;- count(mut.data, gene) %&gt;%<br>    top_n(n = <span>20</span>, wt = n) %&gt;%<br>    mutate(percent = round(n * <span>100</span> / sum(n), <span>1</span>)) %&gt;%<br>    arrange(desc(n))<br>  <br>samples &lt;- subset(mut.data, gene %<span>in</span>% genes$gene) %&gt;%<br>    count(sample) %&gt;% arrange(desc(n)) %&gt;%<br>    rename(num = n) %&gt;%<br>    dplyr::filter(num &gt;= <span>5</span>)<br><br>plot.data &lt;- inner_join(mut.data, genes) %&gt;%<br>    inner_join(samples) %&gt;%<br>    mutate(gene = factor(gene, levels = rev(genes$gene)),<br>           sample = factor(sample, levels = samples$sample),<br>           x = as.integer(sample),<br>           y = as.integer(gene))<br><br>head(plot.data)<br></code></pre><p data-tool="mdnice编辑器">首先，绘制样本的突变基因数目条形图</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: sample_mut</span><br><br>p1 &lt;- ggplot(plot.data) +<br>    geom_round_bar(aes(x = sample, fill = effect), radius = unit(<span>3</span>, <span>'pt'</span>)) +<br>    <span># 使用 expand 删除数据与轴之间的空隙</span><br>    scale_y_continuous(breaks = seq(<span>0</span>, <span>25</span>, <span>5</span>), limits = c(<span>0</span>, <span>25</span>), <br>                       expand = expansion(mult = <span>0</span>, add = <span>0</span>)) +<br>    scale_fill_manual(values = my_colors$five) +<br>    theme(<br>        legend.position = <span>"none"</span>,<br>        panel.background = element_blank(),<br>        axis.title = element_blank(),<br>        axis.ticks.x = element_blank(),<br>        axis.title.x = element_blank(),<br>        axis.text.x = element_blank(),<br>        axis.ticks.length.y.left = unit(<span>.25</span>, <span>"cm"</span>),<br>        axis.line.y.left = element_line(colour = <span>"black"</span>),<br>    )<br>p1<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016475" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ltEG3icnY75eqfCC3vKbkFTl1fRicBVWD0yPJD8ubnb9ghngeSuXEXCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5ltEG3icnY75eqfCC3vKbkFTl1fRicBVWD0yPJD8ubnb9ghngeSuXEXCg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">绘制中间的基因在样本中的突变图谱</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: gene_mut_in_samples</span><br><br>width &lt;- <span>0.5</span><br>height &lt;- <span>0.5</span><br><br>p2 &lt;- ggplot(plot.data) +<br>    <span># geom_tile(aes(x = sample, y = gene, fill = effect)) +</span><br>    geom_round_rect(aes(xmin = x - width, xmax = x + width,<br>                        ymin = y - height, ymax = y + height, <br>                        fill = effect), radius = unit(<span>2</span>, <span>'pt'</span>)) +<br>    <span># 图例行数的调整放到 fill，单独用 guides 无效</span><br>    scale_fill_manual(values = my_colors$five,<br>                      guide = guide_legend(nrow = <span>2</span>)) +<br>    scale_x_continuous(breaks = seq(width, max(plot.data$x) + width, <span>2</span>),<br>                       expand = expansion(<span>0</span>, <span>0</span>)) +<br>    scale_y_continuous(position = <span>"right"</span>,<br>                       breaks = seq(height, max(plot.data$y) + height, <span>1</span>),<br>                       labels = c(<span>''</span>, rev(genes$gene)),<br>                       expand = expansion(<span>0</span>, <span>0</span>)) +<br>    theme(<br>        axis.text.x = element_blank(),<br>        axis.text.y = element_text(size = <span>6</span>, vjust = <span>1.4</span>),<br>        axis.ticks = element_blank(),<br>        axis.title = element_blank(),<br>        panel.grid.minor = element_blank(),<br>        legend.position = <span>"bottom"</span>,<br>        <span># panel.background = element_blank()</span><br>        )<br>p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016428" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5nJY27b05sHcsRTSxmBTsQ0EL8ia65ibzoTqBWhsvX6JtTDCiazBh2VNibg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5nJY27b05sHcsRTSxmBTsQ0EL8ia65ibzoTqBWhsvX6JtTDCiazBh2VNibg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">绘制 <code>TOP</code> 基因的突变频数条形图</p><pre data-tool="mdnice编辑器"><span></span><code><span>#| label: genes_mut</span><br><br>p3 &lt;- ggplot(plot.data) +<br>    geom_round_bar(aes(y = gene, fill = effect), radius = unit(<span>2</span>, <span>'pt'</span>)) +<br>    scale_x_continuous(position = <span>"top"</span>, breaks = seq(<span>0</span>, <span>65</span>, <span>20</span>),<br>                       limits = c(<span>0</span>, <span>65</span>), <br>                       expand = expansion(mult = <span>0</span>, add = <span>0</span>)) +<br>    scale_fill_manual(values = my_colors$five) +<br>    theme(<br>        legend.position = <span>"none"</span>,<br>        panel.background = element_blank(),<br>        axis.title = element_blank(),<br>        axis.ticks.y = element_blank(),<br>        axis.title.y = element_blank(),<br>        axis.text.y = element_blank(),<br>        axis.ticks.length.x.top = unit(<span>.25</span>, <span>"cm"</span>),<br>        axis.line.x.top = element_line(colour = <span>"black"</span>)<br>    )<br>p3<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016420" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5AlPElCq17qat2qCtuRPq3CmuHvicRTodx87o6jmq3vty6ibfBhBXuP3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5AlPElCq17qat2qCtuRPq3CmuHvicRTodx87o6jmq3vty6ibfBhBXuP3g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">合并图像</p><pre data-tool="mdnice编辑器"><span></span><code>p12 &lt;- plot_grid(p1, p2, nrow = <span>2</span>, align = <span>"v"</span>,<br>          rel_heights = c(<span>2</span>, <span>5</span>))<br><br>pr &lt;- plot_grid(<span>NULL</span>, p3, <span>NULL</span>, nrow = <span>3</span>, align = <span>"v"</span>,<br>                rel_heights = c(<span>2</span>, <span>5</span>, <span>1.8</span>))<br><br>plot_grid(p12, pr, ncol = <span>2</span>, align = <span>"h"</span>,<br>          rel_widths = c(<span>5</span>, <span>1</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100016429" data-ratio="0.7142857142857143" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ53q1WEDY2n8yPicD4GCkVpE8r50bJQvrxTESc9DCHKvIanPzhnrjnKKw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1344" src="https://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ53q1WEDY2n8yPicD4GCkVpE8r50bJQvrxTESc9DCHKvIanPzhnrjnKKw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">所有数据、代码（包含注释）以及原始文档都上传到了知识星球，任何代码的问题都可以提问，自愿加入。<img data-imgfileid="100016430" data-ratio="1.5822222222222222" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5TKGuSNHtnlanVQibGSkTrJeb5YicIxCX3kmQWR3jLIY1HWiaOpNTGElyg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1125" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/R14BjDEcNWJFwAJ6oAiaBIiahddvlYmzJ5TKGuSNHtnlanVQibGSkTrJeb5YicIxCX3kmQWR3jLIY1HWiaOpNTGElyg/640?wx_fmt=jpeg&amp;from=appmsg"></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkxMjE4NDc2Mw==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/R14BjDEcNWKgcIVlZ69OBM3mfiarb4tHc8aApGDf11AV6iaYYj6CRgf4VLzogibhDtdHo9JUfUZSt4errsCMNmtbg/0?wx_fmt=png" data-nickname="生信杂货铺" data-alias="comelove2020" data-signature="生物信息知识内容分享，学习笔记，资源分享，编程技巧" data-from="0" data-is_biz_ban="0" data-service_type="1"></mp-common-profile></section><section data-tool="mdnice编辑器"><span>参考资料</span></section><section data-tool="mdnice编辑器"><span><span>[1]</span><p>TCGA-Pancancer: <em>https://gdc.cancer.gov/about-data/publications/pancanatlas</em></p></span><span><span>[2]</span><p>TCGA-Clinical Data Resource (CDR) Outcome: <em>https://api.gdc.cancer.gov/data/1b5f413e-a8d1-4d10-92eb-7c4ae739ed81</em></p></span></section></section><section><mp-common-cpsad data-pluginname="mpcps" data-adtype="short-play" data-playappid="wx4bd2f276faecec4d" data-planid="202411081018000944105" data-dramaid="204760" data-srcappid="wx2ab73633e3b9fcbf" data-templateid="list" data-defaultpath="plugin-private%3A%2F%2Fwx94a6522b1d640c3b%2Fpages%2Fplaylet%2Fplaylet%3FdramaId%3D204760%26srcAppid%3Dwx2ab73633e3b9fcbf%26wxTicket%3DdGlja2V0Mjc3NzgwNDkxMDE5NjczMDYxNDU5ODIy" data-goodssouce="1" data-cpsversion="v112" data-traceid="832ccf52-f855-4cb2-89fb-8fe57c86b5bf204760" data-playcpstype="1"></mp-common-cpsad></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/LYeqTuB_WAQzXQou4QsV3g",target="_blank" rel="noopener noreferrer">原文链接</a>
