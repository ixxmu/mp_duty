---
title: "GseaVis 绘制山脊图"
date: 2024-11-13T03:53:11Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
GseaVis 绘制山脊图 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="%E6%88%91%E6%80%80%E5%BF%B5%E7%9A%84" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M000000P3l050Olt27_5.jpg" singer="孙燕姿" duration="289000" username="" music_source="1" is_vip="1" listenid="78222614400300384"></mp-common-clmusic></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>加一个 <strong>enrich_ridge_plot</strong> 来给富集结果绘制山脊图，对于 <strong>gsea/非 gsea</strong> 富集结果都可。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/GseaVis"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>示例</span><span></span></h2><p data-tool="mdnice编辑器">gsea 富集结果：</p><pre data-tool="mdnice编辑器"><span></span><code><span>library</span>(clusterProfiler)<br><span>library</span>(org.Hs.eg.db)<br><span>library</span>(tidyverse)<br><br><span># loda genelist</span><br>data(geneList, package=<span>"DOSE"</span>)<br><br><span># enrichment</span><br>ego3 &lt;- gseGO(geneList     = geneList,<br>              OrgDb        = org.Hs.eg.db,<br>              ont          = <span>"BP"</span>,<br>              minGSSize    = <span>100</span>,<br>              maxGSSize    = <span>500</span>,<br>              pvalueCutoff = <span>0.05</span>,<br>              verbose      = <span>FALSE</span>)<br></code></pre><p data-tool="mdnice编辑器">可视化：</p><pre data-tool="mdnice编辑器"><span></span><code>enrich_ridge_plot(object = ego3,<br>                  terms_ID = sample(unique(data.frame(ego3)$ID),<span>10</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031758" data-ratio="0.7738231917336394" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaA8BVjWKicUxGPop0Xs0jtdFfIVTYH6GW0SIE7fHGcj4ptdhWGwqSn8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="871" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaA8BVjWKicUxGPop0Xs0jtdFfIVTYH6GW0SIE7fHGcj4ptdhWGwqSn8Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">颜色映射可以通过 <strong>geom_density_ridges_params</strong> 进行调整，其它关于 <strong>geom_density_ridges</strong> 的参数也可以：</p><pre data-tool="mdnice编辑器"><span></span><code>enrich_ridge_plot(object = ego3,<br>                  terms_ID = sample(unique(data.frame(ego3)$ID),<span>10</span>),<br>                  geom_density_ridges_params = list(mapping = aes(fill = NES)))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031760" data-ratio="0.7408716136631331" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaydY7R4IE1IkerYiaIicJ8aWRxk7737W0YyiaZ5dmmibuvZ6QHewgOAz1qA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="849" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaydY7R4IE1IkerYiaIicJ8aWRxk7737W0YyiaZ5dmmibuvZ6QHewgOAz1qA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">换个线颜色：</p><pre data-tool="mdnice编辑器"><span></span><code>enrich_ridge_plot(object = ego3,<br>                  terms_ID = sample(unique(data.frame(ego3)$ID),<span>10</span>),<br>                  geom_density_ridges_params = list(mapping = aes(fill = NES),<br>                                                    point_color = <span>"black"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031759" data-ratio="0.7394366197183099" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaLDjT0q7MvpDaMAlAnH49LJsxoN6hIZ6bLUwReREhhTRicgkjX1GrwvA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="852" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSaLDjT0q7MvpDaMAlAnH49LJsxoN6hIZ6bLUwReREhhTRicgkjX1GrwvA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">普通的 go 富集：</p><pre data-tool="mdnice编辑器"><span></span><code>go &lt;- enrichGO(gene = names(geneList[geneList&gt;<span>1</span>]),<br>               ont = <span>"BP"</span>,<br>               OrgDb = org.Hs.eg.db)<br></code></pre><p data-tool="mdnice编辑器">绘图你需要提供一个两列的 genelist 数据框，包含 <strong>id</strong> 和 <strong>logfc</strong> 两列：</p><pre data-tool="mdnice编辑器"><span></span><code>gene_list &lt;- data.frame(id = names(geneList),logfc = geneList)<br><br><span># check</span><br>head(gene_list,<span>3</span>)<br><span>#          id    logfc</span><br><span># 4312   4312 4.572613</span><br><span># 8318   8318 4.514594</span><br><span># 10874 10874 4.418218</span><br></code></pre><p data-tool="mdnice编辑器">绘图：</p><pre data-tool="mdnice编辑器"><span></span><code>enrich_ridge_plot(object = go,<br>                  terms_ID = sample(unique(data.frame(go)$ID),<span>10</span>),<br>                  gene_list = gene_list)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031762" data-ratio="0.7426210153482881" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSa5TKCZ6vcpI6CwFAw9sFiaDXyRACaFH12Yz4gI5hsDHcrO2XskLadKMg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="847" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSa5TKCZ6vcpI6CwFAw9sFiaDXyRACaFH12Yz4gI5hsDHcrO2XskLadKMg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031761" data-ratio="0.6083707025411061" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSa3gL4rVjmoyQtDicRAiaAgKLpnwVfukY3krr4DRdhvvdgJrs0FUfVZc6g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4useyVE0NbEuibMLn5icH16EBkSa3gL4rVjmoyQtDicRAiaAgKLpnwVfukY3krr4DRdhvvdgJrs0FUfVZc6g/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录 </strong></center><p data-tool="mdnice编辑器"><br></p><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515405&amp;idx=1&amp;sn=d3b3ba1ffe1f533ea0fe2f0daf1823a6&amp;chksm=c184877cf6f30e6a36e6e4a32c2677a37dd3ebd24f4e9da823d435f6af9e28678b99676e860b&amp;token=96515316&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 综合使用手册</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515358&amp;idx=1&amp;sn=98fe527ac548ee46720c11a26b723d39&amp;chksm=c18486aff6f30fb9c0953f5a8d7a1aa39b4dcb8202bb5c34cf61cadae042f8eb2e8631dc36c1&amp;token=2130598365&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">ClusterGvis 进行 TCseq 聚类分析</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515345&amp;idx=1&amp;sn=a57b858a3b02af88baf27bc990c8540d&amp;chksm=c18486a0f6f30fb627fa948b07e5b59348fa16eb9e9f9bff3f0895a61ab7c2fdbaa8f9a23d76&amp;token=2130598365&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">GseaVis 使用文档</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515329&amp;idx=1&amp;sn=48aef9779d113c6c0bbdb5848de285f7&amp;chksm=c18486b0f6f30fa6fd5437d175f8fa42e4c811f23c9f982572237305d57c6d490088381ec4a5&amp;token=1520616408&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">R 语言里的非标准求值</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515312&amp;idx=1&amp;sn=82b8aa5ca4f9e0621d3afb20a7dbaf69&amp;chksm=c18486c1f6f30fd70062ee76e62a9ae724cb9ad4aa5ac255cdf932b691abd71d1433f2c7108f&amp;token=1460764668&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">fastplyr 加速 dplyr？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515280&amp;idx=1&amp;sn=defc9a1c16991378192d39cd07f8ab2b&amp;chksm=c18486e1f6f30ff714bb06fc51b6ac30640f4e8fc12e33675e23e11321501ddd0338c15e8f73&amp;token=289129565&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">离散傅里叶计算 riboseq 的 3nt 周期性</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515259&amp;idx=1&amp;sn=b19dca820116f79399ce38141c6bd9e5&amp;chksm=c184860af6f30f1caac47d51f32d5bd8507e8b38ddafb7faff22aed751f63f5fdcbd8ea4163c&amp;token=1715275324&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Nature 文章的数据也如此奇妙</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515217&amp;idx=1&amp;sn=0f6aa07f021f19dd8c29bc182b1c4973&amp;chksm=c1848620f6f30f362a55caa9aa1b1fba6e24f871545c78927ef5f6c73f99debd8164b7c8644c&amp;token=1715275324&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">bam/sam 文件里的 flag16 的序列可能和你想的不一样</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515196&amp;idx=1&amp;sn=827ad75ace9c9f9d71e89ca35ea37035&amp;chksm=c184864df6f30f5b1456a60f32b1d9884daa6a0060dd8596c3283e69af8d600778e8d92ac1c9&amp;token=2067075838&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">IGV 也能查看 ribo-seq 的 E/P/A density</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247515167&amp;idx=1&amp;sn=bd4107378e08a3ce1d2a122a74c5ec1c&amp;chksm=c184866ef6f30f78ed84a51bad9ff1cf34f64387fdeffbfc79ff896b26fb355aa49c22c77987&amp;token=2067075838&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Open Science Framework (OSF) 数据下载</a></center></strong><p><br></p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/yOB9kFWtNYAqMLHoZ765eg",target="_blank" rel="noopener noreferrer">原文链接</a>
