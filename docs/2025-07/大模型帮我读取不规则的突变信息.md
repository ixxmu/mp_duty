---
title: "大模型帮我读取不规则的突变信息"
date: 2025-07-20T23:38:04Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
大模型帮我读取不规则的突变信息 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">现在的肿瘤外显子队列研究通常情况下他们的fastq测序文件很难获取，因为涉及到病人隐私。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">但是呢，为了学术共享，大多数会把最后的somatic mutation信息给出来，但是不一定是标准的maf文件格式，很可能是Excel文件里面的，如下所示：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><br></span><figcaption><span leaf=""><br></span></figcaption></figure></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmIm1AJiaT6iaYsibfWncY4z4tbClRnKFY4lKoSiblAAaicPib7yiaKFd3DRrGQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5388888888888889" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100052193" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmIm1AJiaT6iaYsibfWncY4z4tbClRnKFY4lKoSiblAAaicPib7yiaKFd3DRrGQ/640?wx_fmt=png&amp;from=appmsg"></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><figcaption><span leaf=""><br></span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">来自于2025年6月底的在《Nature Genetics》杂志在线发表的题为《Multi-omic analysis of gallbladder cancer identifies distinct tumor microenvironments associated with disease progression》的研究论文，大家可以自己下载上面的Excel文件。</span></p><h4 data-tool="mdnice编辑器"><span><span leaf="">首先让人工智能大模型帮我们 解释一下maftools这个R包的读取的maf文件的标准格式</span></span></h4><hr><h3 data-tool="mdnice编辑器"><span><span leaf="">MAF 文件的标准格式（简化版）</span></span></h3><p data-tool="mdnice编辑器"><span leaf="">MAF（Mutation Annotation Format）文件是一种用于存储基因突变信息的标准文件格式，广泛应用于癌症基因组学研究中。</span><code><span leaf="">maftools</span></code><span leaf="">包可以读取和分析 MAF 文件，以下是 MAF 文件的简化标准格式：</span></p><h4 data-tool="mdnice编辑器"><span><span leaf="">必需字段</span></span></h4><ul><li><section><strong><span leaf="">Hugo_Symbol</span></strong><span leaf="">：基因名称。</span></section></li><li><section><strong><span leaf="">Chromosome</span></strong><span leaf="">：染色体编号。</span></section></li><li><section><strong><span leaf="">Start_Position</span></strong><span leaf="">：突变起始位置。</span></section></li><li><section><strong><span leaf="">End_Position</span></strong><span leaf="">：突变结束位置。</span></section></li><li><section><strong><span leaf="">Reference_Allele</span></strong><span leaf="">：参考等位基因。</span></section></li><li><section><strong><span leaf="">Tumor_Seq_Allele2</span></strong><span leaf="">：肿瘤样本中的突变等位基因。</span></section></li><li><section><strong><span leaf="">Variant_Classification</span></strong><span leaf="">：变异分类（如 Missense_Mutation、Nonsense_Mutation 等）。</span></section></li><li><section><strong><span leaf="">Variant_Type</span></strong><span leaf="">：变异类型（如 SNV、Insertion、Deletion 等）。</span></section></li><li><section><strong><span leaf="">Tumor_Sample_Barcode</span></strong><span leaf="">：肿瘤样本的条形码。</span></section></li></ul><h4 data-tool="mdnice编辑器"><span><span leaf="">推荐字段</span></span></h4><ul><li><section><strong><span leaf="">VAF</span></strong><span leaf="">（Variant Allele Frequency）：变异等位基因频率。</span></section></li><li><section><strong><span leaf="">amino_acid_change</span></strong><span leaf="">：氨基酸变化信息。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span><span leaf="">示例 MAF 文件内容</span></span></h3><p data-tool="mdnice编辑器"><span leaf="">以下是一个简化的 MAF 文件示例，包含上述必需字段：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Hugo_Symbol\tChromosome\tStart_Position\tEnd_Position\tReference_Allele\tTumor_Seq_Allele2\tVariant_Classification\tVariant_Type\tTumor_Sample_Barcode</span><span leaf=""><br></span><span leaf="">TP53\t17\t7565095\t7565095\tC\tG\tMissense_Mutation\tSNV\tTCGA-AB-1234</span><span leaf=""><br></span><span leaf="">BRCA1\t17\t43045613\t43045613\tA\tT\tNonsense_Mutation\tSNV\tTCGA-AB-5678</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf="">使用 </span><code><span leaf="">maftools</span></code><span leaf="">读取 MAF 文件</span></span></h3><p data-tool="mdnice编辑器"><span leaf="">以下是一个使用 </span><code><span leaf="">maftools</span></code><span leaf="">包读取 MAF 文件的示例代码：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 安装 maftools 包</span></span><span leaf=""><br></span><span><span leaf="">if</span></span><span leaf=""> (!requireNamespace(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">, quietly = </span><span><span leaf="">TRUE</span></span><span leaf="">)) {</span><span leaf=""><br></span><span leaf="">    install.packages(</span><span><span leaf="">"BiocManager"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span><span leaf="">BiocManager::install(</span><span><span leaf="">"maftools"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 加载 maftools 包</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(maftools)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 指定 MAF 文件路径</span></span><span leaf=""><br></span><span leaf="">maf_file &lt;- </span><span><span leaf="">"path/to/your/maf_file.maf"</span></span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 读取 MAF 文件</span></span><span leaf=""><br></span><span leaf="">maf_data &lt;- read.maf(maf = maf_file)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 查看 MAF 数据的基本情况</span></span><span leaf=""><br></span><span leaf="">print(maf_data)</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span><span leaf="">总结</span></span></h3><p data-tool="mdnice编辑器"><span leaf="">MAF 文件是一种标准化的格式，用于存储基因突变信息。</span><code><span leaf="">maftools</span></code><span leaf="">包提供了强大的功能来读取、分析和可视化 MAF 文件中的数据。通过确保 MAF 文件包含上述必需字段，可以确保 </span><code><span leaf="">maftools</span></code><span leaf="">包能够正确读取和分析数据。</span></p><hr><p data-tool="mdnice编辑器"><span leaf="">然后可以继续问人工智能大模型，如何使用</span><code><span leaf="">maftools</span></code><span leaf="">包读取研究者在Excel共享的突变信息：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><br></span><figcaption><span leaf=""><br></span></figcaption></figure></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmttuYOUricvKVOt7aY3oueO2TxY5fg5Z3zWl3ia4j9BmlPRVswFsdxicdg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8925925925925926" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100052194" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmttuYOUricvKVOt7aY3oueO2TxY5fg5Z3zWl3ia4j9BmlPRVswFsdxicdg/640?wx_fmt=png&amp;from=appmsg"></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><figcaption><span leaf=""><br></span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">给出来的代码也很容易使用，而且注释的超级清晰：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 加载必要的库</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(readxl)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(openxlsx)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 读取 Excel 文件</span></span><span leaf=""><br></span><span leaf="">file_path &lt;- </span><span><span leaf="">"for_maftools.xlsx"</span></span><span><span leaf=""># 替换为你的 Excel 文件路径</span></span><span leaf=""><br></span><span leaf="">data &lt;- read_excel(file_path)</span><span leaf=""><br></span><span><span leaf=""># 检查数据结构</span></span><span leaf=""><br></span><span leaf="">print(head(data))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 确保列名与 MAF 格式一致</span></span><span leaf=""><br></span><span><span leaf=""># 重命名列以匹配 MAF 文件的标准列名</span></span><span leaf=""><br></span><span leaf="">colnames(data) &lt;- c(</span><span leaf=""><br></span><span><span leaf="">"Chromosome"</span></span><span leaf="">, </span><span><span leaf="">"Start_Position"</span></span><span leaf="">, </span><span><span leaf="">"End_Position"</span></span><span leaf="">, </span><span><span leaf="">"Reference_Allele"</span></span><span leaf="">, </span><span leaf=""><br></span><span><span leaf="">"Tumor_Seq_Allele2"</span></span><span leaf="">, </span><span><span leaf="">"Tumor_Sample_Barcode"</span></span><span leaf="">, </span><span><span leaf="">"Hugo_Symbol"</span></span><span leaf="">, </span><span leaf=""><br></span><span><span leaf="">"Variant_Classification"</span></span><span leaf="">, </span><span><span leaf="">"tx"</span></span><span leaf="">, </span><span><span leaf="">"exon"</span></span><span leaf="">, </span><span><span leaf="">"txChange"</span></span><span leaf="">, </span><span><span leaf="">"aaChange"</span></span><span leaf="">, </span><span leaf=""><br></span><span><span leaf="">"Variant_Type"</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 选择 MAF 文件所需的列</span></span><span leaf=""><br></span><span leaf="">maf_columns &lt;- c(</span><span leaf=""><br></span><span><span leaf="">"Hugo_Symbol"</span></span><span leaf="">, </span><span><span leaf="">"Chromosome"</span></span><span leaf="">, </span><span><span leaf="">"Start_Position"</span></span><span leaf="">, </span><span><span leaf="">"End_Position"</span></span><span leaf="">, </span><span leaf=""><br></span><span><span leaf="">"Reference_Allele"</span></span><span leaf="">, </span><span><span leaf="">"Tumor_Seq_Allele2"</span></span><span leaf="">, </span><span><span leaf="">"Variant_Classification"</span></span><span leaf="">, </span><span leaf=""><br></span><span><span leaf="">"Variant_Type"</span></span><span leaf="">, </span><span><span leaf="">"Tumor_Sample_Barcode"</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 提取所需的列</span></span><span leaf=""><br></span><span leaf="">maf_data &lt;- data[, maf_columns]</span><span leaf=""><br></span><span><span leaf=""># 检查处理后的数据</span></span><span leaf=""><br></span><span leaf="">print(head(maf_data))</span><span leaf=""><br></span><span><span leaf=""># 加载 maftools 包</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(maftools) </span><span leaf=""><br></span><span><span leaf=""># 读取 MAF 内容</span></span><span leaf=""><br></span><span leaf="">maf.df &lt;- read.maf( maf_data )</span><span leaf=""><br></span><span><span leaf=""># 查看 MAF 数据的基本情况</span></span><span leaf=""><br></span><span leaf="">print(maf.df)</span><span leaf=""><br></span><span leaf="">plotmafSummary(maf.df)</span><span leaf=""><br></span><span leaf="">oncoplot(maf.df,top = </span><span><span leaf="">20</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">其中突变全景图如下所示：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmfVH7eDiav1ywpTV0ia3wRMD35qLfFhv0nZy8DiaNvFdQGrEBrgBnbLibUw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6842592592592592" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100052195" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8a46kglic2vfRs7DdBCAVWmfVH7eDiav1ywpTV0ia3wRMD35qLfFhv0nZy8DiaNvFdQGrEBrgBnbLibUw/640?wx_fmt=png&amp;from=appmsg"></section><figure data-tool="mdnice编辑器"><span leaf=""><br></span><figcaption><span leaf="">突变全景图</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">当然了，还可以做大量的分析，这个时候可以选择去看看maftools的官方文档，很多示例代码，也可以继续跟人工智能大模型对话啦！</span></p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/gBL0b5QMHf4Ad9TOkX0oUA",target="_blank" rel="noopener noreferrer">原文链接</a>
