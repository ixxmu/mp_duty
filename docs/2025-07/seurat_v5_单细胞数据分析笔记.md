---
title: "seurat v5 单细胞数据分析笔记"
date: 2025-07-15T05:10:33Z
draft: ["false"]
tags: [
  "fetched",
  "seqyuan"
]
categories: ["Acdemic"]
---
seurat v5 单细胞数据分析笔记 by seqyuan
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器"><span leaf="">单细胞数据分析R包seurat v5经过了一段时间检验，seurat v4经久不衰，很多同学看的资料比较繁杂，没有深刻理解流程的步骤，不利于灵活运用。此笔记用于记录seurat v5分析单细胞数据代码中的几个关键点。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">1. 读入测试数据</span></span><span></span></h2><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">options(future.globals.maxSize = </span><span><span leaf="">1000</span></span><span leaf=""> * </span><span><span leaf="">1024</span></span><span leaf="">^</span><span><span leaf="">3</span></span><span leaf="">)</span><br><span leaf="">format(Sys.time(), </span><span><span leaf="">"%a %b %d %H:%M:%S %Y"</span></span><span leaf="">)</span><br><br><span><span leaf="">library</span></span><span leaf="">(Seurat)</span><br><span leaf="">load(file=</span><span><span leaf="">'./ifnb.rda'</span></span><span leaf="">)</span><br><span><span leaf=""># 测试数据ifnb下载自seurat-data, seuratObject是seurat v5之前的版本，可通过下面代码确认seuratObject版本</span></span><br><span leaf="">str(ifnb@assays$RNA)</span><br><span><span leaf=""># Formal class 'Assay' [package "Seurat"] with 8 slots</span></span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">显示的class 'Assay'表示这个数据seuratObject版本是v3，如果数据对象是v5 则会显示class 'Assay5'</span></p><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">升级数据的seuratObject version</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ifnb = UpdateSeuratObject(object = ifnb)</span><br><span leaf="">ifnb@assays</span><span><span leaf="">$RNA</span></span><span leaf=""> &lt;- as(object = ifnb@assays</span><span><span leaf="">$RNA</span></span><span leaf="">, Class = </span><span><span leaf="">"Assay5"</span></span><span leaf="">)</span><br><span leaf="">str(ifnb@assays</span><span><span leaf="">$RNA</span></span><span leaf="">)</span><br><span><span leaf=""># Formal class 'Assay5' [package "SeuratObject"] with 8 slots</span></span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf=""><span textstyle="">拆分每个样本到单个layer</span></span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">这里meta.data里的stim列存放的是样本名，所以用</span><code><span leaf="">f = ifnb$stim</span></code><span leaf="">来拆分样本</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ifnb[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]] &lt;- split(ifnb[[</span><span><span leaf="">"RNA"</span></span><span leaf="">]], f = ifnb$stim)</span><br><span leaf="">ifnb</span><br><span><span leaf=""># An object of class Seurat </span></span><br><span><span leaf=""># 14053 features across 13999 samples within 1 assay </span></span><br><span><span leaf=""># Active assay: RNA (14053 features, 0 variable features)</span></span><br><span><span leaf=""># 4 layers present: counts.CTRL, counts.STIM, data.CTRL, data.STIM</span></span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">我的数据是v5之前的版本，所以有以上的操作。如果您一开始使用的就是v5，并且是从</span><code><span leaf="">Read10X</span></code><span leaf="">函数开始读取的matrix，可以把所有样本对象存放在一个向量中(e.g. scelist)，那么用</span><code><span leaf="">merge</span></code><span leaf="">函数就可以把多个样本seurat对象合并到一个seurat对象，并且每个样本的表达矩阵存到了不同的layer。</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">sce = merge(scelist[[</span><span><span leaf="">1</span></span><span leaf="">]], y=scelist[-</span><span><span leaf="">1</span></span><span leaf="">], add.cell.ids=rownames(info), project=</span><span><span leaf="">"LC"</span></span><span leaf="">)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">这次演示的是公共数据，这里就不再重复数据质量控制的代码。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">2. 标准化-计算高变基因-PCA线性降维</span></span><span></span></h2><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ifnb &lt;- NormalizeData(ifnb)</span><br><span leaf="">ifnb &lt;- FindVariableFeatures(ifnb)</span><br><span leaf="">ifnb &lt;- ScaleData(ifnb)</span><br><span leaf="">ifnb &lt;- RunPCA(ifnb)</span><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">3. 整合分群</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">下面两个代码框表示常用的两种整合方法，可以任选其一</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># RPCA 整合方法</span></span><br><span leaf="">ifnb &lt;- IntegrateLayers(</span><br><span leaf="">  object = ifnb, </span><br><span leaf="">  method = RPCAIntegration,</span><br><span leaf="">  orig.reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">, </span><br><span leaf="">  new.reduction = </span><span><span leaf="">"integrated.rpca"</span></span><span leaf="">,</span><br><span leaf="">  verbose = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br><span leaf="">  </span><br><span leaf="">ifnb &lt;- FindNeighbors(ifnb, reduction = </span><span><span leaf="">"integrated.rpca"</span></span><span leaf="">, dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">27</span></span><span leaf="">)</span><br><span leaf="">ifnb &lt;- FindClusters(ifnb, resolution = </span><span><span leaf="">0.4</span></span><span leaf="">, cluster.name = </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">)</span><br><span leaf="">ifnb &lt;- RunUMAP(ifnb, reduction = </span><span><span leaf="">"integrated.rpca"</span></span><span leaf="">, dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">27</span></span><span leaf="">, reduction.name = </span><span><span leaf="">"umap.rpca"</span></span><span leaf="">)</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">or</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># harmony整合</span></span><br><span leaf="">ifnb &lt;- IntegrateLayers(</span><br><span leaf="">  object = ifnb, method = HarmonyIntegration,</span><br><span leaf="">  orig.reduction = </span><span><span leaf="">"pca"</span></span><span leaf="">, new.reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">,</span><br><span leaf="">  verbose = </span><span><span leaf="">FALSE</span></span><br><span leaf="">)</span><br><span leaf="">ifnb &lt;- FindNeighbors(ifnb, reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">, dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">27</span></span><span leaf="">)</span><br><span leaf="">ifnb &lt;- FindClusters(ifnb, resolution = </span><span><span leaf="">0.4</span></span><span leaf="">, cluster.name = </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">)</span><br><span leaf="">ifnb &lt;- RunUMAP(ifnb, reduction = </span><span><span leaf="">"harmony"</span></span><span leaf="">, dims = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">27</span></span><span leaf="">, reduction.name = </span><span><span leaf="">"umap.harmony"</span></span><span leaf="">)</span><br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">umap 降维可视化</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(RColorBrewer)</span><br><span leaf="">custom_color &lt;- colorRampPalette(brewer.pal(</span><span><span leaf="">12</span></span><span leaf="">,</span><span><span leaf="">'Paired'</span></span><span leaf="">))(length(unique(ifnb@meta.data$seurat_clusters)))</span><br><br><span leaf="">p &lt;- DimPlot(ifnb, reduction = </span><span><span leaf="">"umap.rpca"</span></span><span leaf="">, group.by = c(</span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">, </span><span><span leaf="">"seurat_annotations"</span></span><span leaf="">),</span><br><span leaf="">             cols=custom_color,</span><br><span leaf="">              combine = </span><span><span leaf="">TRUE</span></span><span leaf="">, label.size = </span><span><span leaf="">4</span></span><span leaf="">, label=</span><span><span leaf="">TRUE</span></span><span leaf="">)</span><br><br><span leaf="">options(repr.plot.width=</span><span><span leaf="">11</span></span><span leaf="">, repr.plot.height=</span><span><span leaf="">5</span></span><span leaf="">)</span><br><span leaf="">p</span><br></code></pre><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100000857" data-src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9Amice8Q1J9p3Tcj7QurrMK420YcBSVsAufAYY4VbF52LXgCMkmibBB7CA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9Amice8Q1J9p3Tcj7QurrMK420YcBSVsAufAYY4VbF52LXgCMkmibBB7CA/640?wx_fmt=png&amp;from=appmsg">seurat v5的聚类与数据自带的细胞注释标签overlap可以帮助判断分群效果</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">options(repr.plot.width=</span><span><span leaf="">10</span></span><span leaf="">, repr.plot.height=</span><span><span leaf="">7</span></span><span leaf="">)</span><br><span leaf="">par(mar = c(</span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">2</span></span><span leaf="">, </span><span><span leaf="">0</span></span><span leaf="">))</span><br><span leaf="">gplots::balloonplot(table(ifnb$seurat_clusters, ifnb$seurat_annotations), rowmar=</span><span><span leaf="">3</span></span><span leaf="">, colmar=</span><span><span leaf="">1</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100000856" data-src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9A240S7h7g598EQfL3UzeGE7Zu5RnFszCrYDWKutiansSOGjpxVpq4YHw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9A240S7h7g598EQfL3UzeGE7Zu5RnFszCrYDWKutiansSOGjpxVpq4YHw/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">p &lt;- DimPlot(ifnb, reduction = </span><span><span leaf="">"umap.rpca"</span></span><span leaf="">, group.by = </span><span><span leaf="">'seurat_clusters'</span></span><span leaf="">,</span><br><span leaf="">             cols=custom_color, split.by=</span><span><span leaf="">"stim"</span></span><span leaf="">, ncol=</span><span><span leaf="">2</span></span><span leaf="">,</span><br><span leaf="">             label.size = </span><span><span leaf="">4</span></span><span leaf="">, label=</span><span><span leaf="">TRUE</span></span><span leaf="">)</span><br><br><span leaf="">options(repr.plot.width=</span><span><span leaf="">9</span></span><span leaf="">, repr.plot.height=</span><span><span leaf="">5</span></span><span leaf="">)</span><br><span leaf="">p</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100000858" data-src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9AJ4NGic7VNRX12S1Igdnric0VllfOiczKudKUpuzCU7n6RD8sV9faBu6rg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9AJ4NGic7VNRX12S1Igdnric0VllfOiczKudKUpuzCU7n6RD8sV9faBu6rg/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cell_fraction &lt;- </span><span><span leaf="">function</span></span><span leaf="">(RDS, group=c(</span><span><span leaf="">'orig.ident'</span></span><span leaf="">, </span><span><span leaf="">'celltype0'</span></span><span leaf="">)){</span><br><span leaf="">    sample_cluster_cells &lt;- table(RDS@meta.data[[group[</span><span><span leaf="">1</span></span><span leaf="">]]], RDS@meta.data[[group[</span><span><span leaf="">2</span></span><span leaf="">]]])</span><br><span leaf="">    sample_cluster_cells &lt;- as.data.frame(sample_cluster_cells)</span><br><span leaf="">    colnames(sample_cluster_cells) &lt;- c(group, </span><span><span leaf="">'cellnumber'</span></span><span leaf="">)</span><br><span leaf="">    </span><span><span leaf="">#return(sample_cluster_cells)</span></span><br><span leaf="">    mycolor &lt;- colorRampPalette(brewer.pal(</span><span><span leaf="">12</span></span><span leaf="">,</span><span><span leaf="">'Paired'</span></span><span leaf="">))(length(unique(RDS@meta.data[[group[</span><span><span leaf="">2</span></span><span leaf="">]]])))</span><br><span leaf="">    p1 &lt;- ggplot(sample_cluster_cells, aes_string(x=group[</span><span><span leaf="">1</span></span><span leaf="">], weight=</span><span><span leaf="">"cellnumber"</span></span><span leaf="">, fill=group[</span><span><span leaf="">2</span></span><span leaf="">]))+</span><br><span leaf="">      geom_bar(position=</span><span><span leaf="">"fill"</span></span><span leaf="">,width = </span><span><span leaf="">0.7</span></span><span leaf="">,size = </span><span><span leaf="">0.5</span></span><span leaf="">,colour = </span><span><span leaf="">NA</span></span><span leaf="">)+</span><br><span leaf="">      scale_fill_manual(values = mycolor) + </span><br><span leaf="">      theme(panel.grid = element_blank(),</span><br><span leaf="">            panel.background = element_rect(fill = </span><span><span leaf="">"transparent"</span></span><span leaf="">,colour = </span><span><span leaf="">NA</span></span><span leaf="">),</span><br><span leaf="">            axis.line.x = element_line(colour = </span><span><span leaf="">"black"</span></span><span leaf="">),</span><br><span leaf="">            axis.line.y = element_line(colour = </span><span><span leaf="">"black"</span></span><span leaf="">),</span><br><span leaf="">            axis.text.x = element_text(size = </span><span><span leaf="">12</span></span><span leaf="">),</span><br><span leaf="">            axis.text.y = element_text(size = </span><span><span leaf="">12</span></span><span leaf="">),</span><br><span leaf="">            plot.title = element_text(lineheight=</span><span><span leaf="">.8</span></span><span leaf="">, face=</span><span><span leaf="">"bold"</span></span><span leaf="">, hjust=</span><span><span leaf="">0.5</span></span><span leaf="">, size =</span><span><span leaf="">16</span></span><span leaf="">)</span><br><span leaf="">      )+labs(y=</span><span><span leaf="">"Percentage"</span></span><span leaf="">)+RotatedAxis()+coord_flip()</span><span><span leaf=""># + </span></span><br><span leaf="">        </span><span><span leaf="">#guides(color=guide_legend(override.aes = list(size=10), ncol=1))</span></span><br><br><span leaf="">    </span><span><span leaf="">return</span></span><span leaf="">(p1)</span><br><span leaf="">}</span><br><br><span leaf="">p &lt;- cell_fraction(sce, group=c(</span><span><span leaf="">'stim'</span></span><span leaf="">, </span><span><span leaf="">'seurat_clusters'</span></span><span leaf="">))</span><br><span leaf="">options(repr.plot.width=</span><span><span leaf="">7</span></span><span leaf="">, repr.plot.height=</span><span><span leaf="">4</span></span><span leaf="">)</span><br><span leaf="">p</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100000855" data-src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9AjnfP11snB11VhJ6zt3PRjUUKjDATxdibibkxh7ic3bpZKTfOYl9uW201Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9AjnfP11snB11VhJ6zt3PRjUUKjDATxdibibkxh7ic3bpZKTfOYl9uW201Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">4. 计算marker基因</span></span><span></span></h2><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">sce &lt;- JoinLayers(ifnb)</span><br><span><span leaf=""># 把样本的layer合并成一个大矩阵，基于这个大的矩阵去做FindAllMarkers</span></span><br><span leaf="">DefaultAssay(sce) &lt;- </span><span><span leaf="">'RNA'</span></span><br><span><span leaf=""># devtools::install_github('seqyuan/s4wrapper')</span></span><br><span><span leaf="">library</span></span><span leaf="">(s4wrapper)</span><br><span><span leaf=""># 我把SeuratWrappers::RunPrestoAll单独拆了出来作为s4wrapper包</span></span><br><span><span leaf=""># 可代替FindAllMarkers实现top marker的快速计算</span></span><br><br><span leaf="">cluster_markersres &lt;- RunPrestoAll(sce, logfc.threshold = </span><span><span leaf="">0.15</span></span><span leaf="">, min.pct = </span><span><span leaf="">0.1</span></span><span leaf="">)</span><br><span leaf="">write.table(cluster_markers, </span><span><span leaf="">"major.rpca.cluster_markers.tsv"</span></span><span leaf="">, sep=</span><span><span leaf="">"\t"</span></span><span leaf="">, quote=</span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br><br><span><span leaf="">library</span></span><span leaf="">(dplyr)</span><br><span leaf="">cluster_markersres %&gt;%</span><br><span leaf="">    group_by(cluster) %&gt;%</span><br><span leaf="">    dplyr::filter(avg_log2FC &gt; </span><span><span leaf="">0.2</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    arrange(desc(avg_log2FC)) %&gt;%</span><br><span leaf="">    slice_head(n = </span><span><span leaf="">7</span></span><span leaf="">) %&gt;%</span><br><span leaf="">    ungroup() -&gt; top7</span><br><span leaf="">    </span><br><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><br><span leaf="">plot_dot &lt;- </span><span><span leaf="">function</span></span><span leaf="">(RDS, markers, group.by=</span><span><span leaf="">"rpca_clusters"</span></span><span leaf="">){</span><br><span leaf="">    genes &lt;- as.vector(unlist(markers))</span><br><span leaf="">    tmp &lt;- ScaleData(RDS, features = genes, verbose = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><br><br><span leaf="">    p &lt;- DotPlot(tmp, features=markers, group.by = group.by) + </span><br><span leaf="">        theme(axis.text.x = element_text(angle=</span><span><span leaf="">60</span></span><span leaf="">, vjust=</span><span><span leaf="">1</span></span><span leaf="">, hjust=</span><span><span leaf="">1</span></span><span leaf="">)) + </span><br><span leaf="">        xlab(</span><span><span leaf="">''</span></span><span leaf="">)+ylab(</span><span><span leaf="">''</span></span><span leaf="">) +</span><br><span leaf="">        guides(color = guide_colorbar(title = </span><span><span leaf="">'Scaled expression'</span></span><span leaf="">,order = </span><span><span leaf="">1</span></span><span leaf="">),</span><br><span leaf="">               size = guide_legend(</span><span><span leaf="">"Percent expressed"</span></span><span leaf="">), order = </span><span><span leaf="">0</span></span><span leaf=""> ) +</span><br><span leaf="">        scale_colour_gradientn(colours = c(</span><span><span leaf="">"dodgerblue1"</span></span><span leaf="">,</span><span><span leaf="">"#44c1f0"</span></span><span leaf="">, </span><span><span leaf="">'#fe2f4a'</span></span><span leaf="">)) + </span><br><span leaf="">        </span><span><span leaf="">#scale_colour_gradientn(colours = c("dodgerblue1","#44c1f0", "lightgoldenrod","#e20612",'#cc340c'))+  </span></span><br><span leaf="">        theme(legend.position = </span><span><span leaf="">"top"</span></span><span leaf="">) +</span><br><span leaf="">        </span><span><span leaf="">#theme(panel.border = element_rect(fill=NA,color="black", size=, linetype="solid")) +</span></span><br><span leaf="">        geom_point(aes(size=pct.exp), shape = </span><span><span leaf="">21</span></span><span leaf="">, colour=</span><span><span leaf="">NA</span></span><span leaf="">, stroke=</span><span><span leaf="">NA</span></span><span leaf="">)</span><br><br><span leaf="">    </span><span><span leaf="">return</span></span><span leaf="">(p)</span><br><span leaf="">}</span><br><br><span leaf="">p &lt;- plot_dot(sce, unique(top7$gene), </span><span><span leaf="">"seurat_clusters"</span></span><span leaf="">)</span><br><span leaf="">options(repr.plot.width=</span><span><span leaf="">18</span></span><span leaf="">, repr.plot.height=</span><span><span leaf="">6</span></span><span leaf="">)</span><br><span leaf="">p</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100000859" data-src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9Ap8JPiakJSBZsAnwuiaN8pmic3icAMSWtcj7YytWTTOmytePMjSZhR0m0YA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/SiacuSjV1nDzemqW68C3FEQrmTMdPicf9Ap8JPiakJSBZsAnwuiaN8pmic3icAMSWtcj7YytWTTOmytePMjSZhR0m0YA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">保存RDS用于后续分析</span></span><span></span></h2><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">saveRDS(ifnb, </span><span><span leaf="">"ifnb.layers.rds"</span></span><span leaf="">)</span><br><span leaf="">saveRDS(sce, </span><span><span leaf="">"ifnb.rpca.rds"</span></span><span leaf="">)</span><br></code></pre></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Wmx3j-J26kx1xlYyKzhHsw",target="_blank" rel="noopener noreferrer">原文链接</a>
