---
title: "新的单细胞数据分析方法：DA-seq算法识别在两种状态之间丰度差异最显著的细胞亚群（IF9.1/Q1）"
date: 2025-07-06T08:31:28Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
新的单细胞数据分析方法：DA-seq算法识别在两种状态之间丰度差异最显著的细胞亚群（IF9.1/Q1） by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">最近看的一个单细胞数据分析文献（标题为<span textstyle="">：《Single-cell landscape of peripheral immune cells in MASLD/MASH》</span>）中<span textstyle="">应用了一个方法DA-seq来做单细胞数据的丰度差异检验（differential abundance testing）</span>，这个分析还没有见过呢，现在来看看~。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">文献中的结果如下图B：<span textstyle="">在MASLD/MASH（酒精相关脂肪性肝病/脂肪性肝炎）患者中，中性粒细胞整体上富集，而CD8+记忆T细胞则减少，与健康对照组相比有显著差异。</span></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5UzS0nLriaOl7g1OsxoubnyBek80TvoPaeoRXQGUDAZmCQtkUWX8HHsw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6768518518518518" data-type="png" data-w="1080" data-imgfileid="100060246" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5UzS0nLriaOl7g1OsxoubnyBek80TvoPaeoRXQGUDAZmCQtkUWX8HHsw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">DA-seq介绍</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">DA-seq是一种用于单细胞RNA测序数据分析的新方法，专门用于比较两种生物学状态（如胚胎发育阶段）的样本。<span textstyle="">它能够识别在两种状态之间丰度差异最显著的细胞亚群，从而揭示传统方法无法检测到的细胞过程中的重要变化。</span>与传统的无监督聚类分析相比，DA-seq采用多尺度策略，能够更精准地定位差异细胞亚群。</span></p><p data-tool="mdnice编辑器"><span leaf="">该算法于2021年5月17号发表在Proc Natl Acad Sci U S A. 杂志，文献标题为：《Detection of differentially abundant cell subpopulations in scRNA-seq data》。</span></p><p data-tool="mdnice编辑器"><span leaf="">软件官网：https://klugerlab.github.io/DAseq/articles/tutorial.html</span></p><p data-tool="mdnice编辑器"><span leaf="">the DA-seq algorithm 概览如下：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5qgQ4e7euDzCSkRhAAgvnnE7G1zDAE9Ix20V1XdFBg7eUPCVv62B9kw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9666666666666667" data-type="png" data-w="1080" data-imgfileid="100060244" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5qgQ4e7euDzCSkRhAAgvnnE7G1zDAE9Ix20V1XdFBg7eUPCVv62B9kw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">简单安装</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">这个软件在github上，安装非常简单：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">getOption(</span><span><span leaf="">'timeout'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(timeout=10000)</span><span leaf=""><br></span><span leaf="">options(download.file.method = </span><span><span leaf="">"libcurl"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(url.method = </span><span><span leaf="">"libcurl"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf="">## 使用西湖大学的 Bioconductor镜像</span></span><span leaf=""><br></span><span leaf="">options(BioC_mirror=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/bioconductor"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">options(</span><span><span leaf="">"repos"</span></span><span leaf="">=c(CRAN=</span><span><span leaf="">"https://mirrors.westlake.edu.cn/CRAN/"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 安装</span></span><span leaf=""><br></span><span leaf="">devtools::install_github(</span><span><span leaf="">"KlugerLab/DAseq"</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 加载</span></span><span leaf=""><br></span><span leaf="">library(DAseq)</span><span leaf=""><br></span></code></pre><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">示例数据</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">这个数据研究的一个目标是识别与免疫检查点治疗成功或失败相关的因素。为此，对48名接受检查点抑制剂治疗的黑色素瘤患者的16,291个免疫细胞进行了分析和鉴定。根据放射学评估，将肿瘤样本分为响应者和非响应者。图2A中的（t-SNE）图显示了来自响应肿瘤和非响应肿瘤的细胞标签。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5xfJTyMax7tRZFqbLIv20X37Hcaqj0bHib2FBcluNXBibAxDJkbPK4pYQ/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.9055555555555556" data-type="jpeg" data-w="1080" data-imgfileid="100060245" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5xfJTyMax7tRZFqbLIv20X37Hcaqj0bHib2FBcluNXBibAxDJkbPK4pYQ/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">获取数据中两种生物学条件的样本标签名称：分别是响应者（R）和非响应者（NR）。总共有48个样本，其中17个是响应者（R），31个是非响应者（NR）。这些信息包含在DAseq包附带的</span><code><span leaf="">X.label.info</span></code><span leaf="">数据框中：</span><code><span leaf="">label</span></code><span leaf="">列显示样本标签名称，</span><code><span leaf="">condition</span></code><span leaf="">列显示条件（R或NR）。</span></p><p data-tool="mdnice编辑器"><span leaf="">这个数据本身来源在这个文献中：https://www.sciencedirect.com/science/article/pii/S0092867418313941</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list=ls())</span><span leaf=""><br></span><span leaf="">library(DAseq)</span><span leaf=""><br></span><span leaf="">python2use &lt;- </span><span><span leaf="">"/nas2/zhangj/biosoft/miniconda3/envs/scanpy/bin/python"</span></span><span leaf=""><br></span><span leaf="">GPU &lt;- 5</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf="">## 数据</span></span><span leaf=""><br></span><span><span leaf=""># label information</span></span><span leaf=""><br></span><span leaf="">dim(X.label.info)</span><span leaf=""><br></span><span leaf="">head(X.label.info)</span><span leaf=""><br></span><span leaf="">table(X.label.info</span><span><span leaf="">$condition</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># get the sample label names for R and NR.</span></span><span leaf=""><br></span><span leaf="">labels_res &lt;- X.label.info[X.label.info</span><span><span leaf="">$condition</span></span><span leaf=""> == </span><span><span leaf="">"R"</span></span><span leaf="">, </span><span><span leaf="">"label"</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">labels_nonres &lt;- X.label.info[X.label.info</span><span><span leaf="">$condition</span></span><span leaf=""> == </span><span><span leaf="">"NR"</span></span><span leaf="">, </span><span><span leaf="">"label"</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">labels_res</span><span leaf=""><br></span><span leaf="">labels_nonres</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5Z1kCqKiaOUj4m7bK0QK0NXvl7TWrrEnsTJdySEbsqGf5RibprxEG5wyQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.25925925925925924" data-type="png" data-w="1080" data-imgfileid="100060242" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5Z1kCqKiaOUj4m7bK0QK0NXvl7TWrrEnsTJdySEbsqGf5RibprxEG5wyQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">获取 DA cells</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">这一步整合了DAseq算法的前两个步骤。输入数据包括：</span></p><ul><li><section><span leaf="">X：经过降维（PCA）处理的单细胞RNA测序数据，包含在DAseq包中，为</span><code><span leaf="">X.melanoma</span></code><span leaf="">；</span></section></li><li><section><span leaf="">cell.labels：数据中每个细胞的样本标签，为</span><code><span leaf="">X.label.melanoma</span></code><span leaf="">；</span></section></li><li><section><span leaf="">labels.1：对应于一种生物学条件（R）的样本标签名称，labels_res；</span></section></li><li><section><span leaf="">labels.2：对应于另一种生物学条件（NR）的样本标签名称，labels_nonres；</span></section></li><li><section><span leaf="">k.vector：用于计算kNN得分向量时使用的k值，这里使用从50到500的k值；</span></section></li><li><section><span leaf="">plot.embedding：用于可视化结果的t-SNE，包含在DAseq包中，为</span><code><span leaf="">X.2d.melanoma</span></code><span leaf="">；</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">运行：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># DA cells</span></span><span leaf=""><br></span><span leaf="">da_cells &lt;- getDAcells(</span><span leaf=""><br></span><span leaf="">  X = X.melanoma,</span><span leaf=""><br></span><span leaf="">  cell.labels = X.label.melanoma,</span><span leaf=""><br></span><span leaf="">  labels.1 = labels_res,</span><span leaf=""><br></span><span leaf="">  labels.2 = labels_nonres,</span><span leaf=""><br></span><span leaf="">  k.vector = seq(50, 500, 50),</span><span leaf=""><br></span><span leaf="">  plot.embedding = X.2d.melanoma</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">da_cells</span><span leaf=""><br></span><span leaf="">str(da_cells,max.level = 1)</span><span leaf=""><br></span><span leaf="">da_cells</span><span><span leaf="">$pred</span></span><span leaf="">.plot</span><span leaf=""><br></span></code></pre><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">输出结果</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">生成的da_cells对象包含一下内容：</span></p><ul><li><section><code><span leaf="">da.ratio</span></code><span leaf="">, 每个细胞的打分</span></section></li><li><section><code><span leaf="">da.pred</span></code><span leaf="">,  每个细胞的DA measure</span></section></li><li><section><code><span leaf="">da.up</span></code><span leaf="">, 与non-responders相关的DA cells</span></section></li><li><section><code><span leaf="">da.down</span></code><span leaf="">, 与responders相关的DA cells</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5cKYxBEzv0MbnOgU4ibVGfhic6uWmtGREGqICmQcz70TbkppPL2gX9IYw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3509259259259259" data-type="png" data-w="1080" data-imgfileid="100060243" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5cKYxBEzv0MbnOgU4ibVGfhic6uWmtGREGqICmQcz70TbkppPL2gX9IYw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">对结果可视化：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">da_cells</span><span><span leaf="">$pred</span></span><span leaf="">.plot</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5JojKKlbYp6Epuyym3IXibNU4luIn5jz15EsJQcuZs4x6OAS85lZkHhg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-type="png" data-w="877" data-imgfileid="100060251" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5JojKKlbYp6Epuyym3IXibNU4luIn5jz15EsJQcuZs4x6OAS85lZkHhg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">默认情况下，DA（差异丰度）测量值大于最大值或小于最小值的细胞被选为DA细胞。这些最大值和最小值是通过置换DA测量值得到的。可以通过运行</span><code><span leaf="">updateDAcells()</span></code><span leaf="">函数来更改阈值，以便查看最显著的DA细胞。在这组数据中，我们使用0.8（用于非响应者）和-0.8（用于响应者）作为阈值。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">da_cells &lt;- updateDAcells(</span><span leaf=""><br></span><span leaf="">  X = da_cells, pred.thres = c(-0.8,0.8),</span><span leaf=""><br></span><span leaf="">  plot.embedding = X.2d.melanoma</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">da_cells</span><span><span leaf="">$da</span></span><span leaf="">.cells.plot</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">选定的DA细胞被突出显示，<span textstyle="">红色的细胞位于顶部（这些细胞在非响应者样本中更为丰富），而蓝色的细胞位于底部（这些细胞在响应者样本中更为丰富）:</span></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5WpqMic0nN2suaGeoibACFP5LC3AK4sNwFWAkOiaXXJia2H44icQWib2YKD3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0011376564277588" data-type="png" data-w="879" data-imgfileid="100060250" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wxHTt3ktYs0NrwSCf0RiaGC5WpqMic0nN2suaGeoibACFP5LC3AK4sNwFWAkOiaXXJia2H44icQWib2YKD3A/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">是不是给你提供了<span textstyle="">一种新思路：不用再担心关注的细胞亚群在两组中的细胞比例没有显著差异了</span>，试试看这个！</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课7月班</span></a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/iqFsTojw8nxgNhqf4vM_gw",target="_blank" rel="noopener noreferrer">原文链接</a>
