---
title: "Indel和SV以及CNV数据如何做GWAS分析？"
date: 2025-07-06T08:32:16Z
draft: ["false"]
tags: [
  "fetched",
  "育种数据分析之放飞自我"
]
categories: ["Acdemic"]
---
Indel和SV以及CNV数据如何做GWAS分析？ by 育种数据分析之放飞自我
------
<div><p data-mpa-powered-by="yiban.io"><span leaf="">大家好，我是邓飞，今天介绍一下如何使用Indel和SV数据，进行GWAS分析，参考章节：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247496617&amp;idx=1&amp;sn=663f5b11943b7f81739946b8d176b8f3&amp;scene=21#wechat_redirect" textvalue="领取 | GWAS和统计遗传书籍汇总" data-itemshowtype="0" linktype="text" data-linktype="2">领取 | GWAS和统计遗传书籍汇总</a>中<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247495815&amp;idx=1&amp;sn=6b29b9dcf15b9244d4e015ffe20699dc&amp;scene=21#wechat_redirect" textvalue="GWAS书籍：《Genome-Wide Association Studies》，电子版pdf" data-itemshowtype="0" linktype="text" data-linktype="2">GWAS书籍：《Genome-Wide Association Studies》，电子版pdf</a>的第十章：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7SqqomIZsAHnicz6cWOVc1fa5cM5fWEdEoaicu3eZl1veIzebibnyJzZ9Wg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.575925925925926" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100012984" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7SqqomIZsAHnicz6cWOVc1fa5cM5fWEdEoaicu3eZl1veIzebibnyJzZ9Wg/640?wx_fmt=png&amp;from=appmsg"></section><p><strong><span leaf="">变异概念介绍：</span></strong><span leaf=""><br></span></p><ol><li><p><span><span leaf="">indel（插入缺失变异）</span></span><span leaf="">：</span></p></li></ol><ul><li><p><span leaf="">Indel是“insertions and deletions”的简称，指的是DNA序列中小的插入或缺失变异。具体来说，indel是一种常见的基因组变异，涉及到一个或多个碱基对的加入（插入）或删除（缺失）。Indel变异可能影响基因功能和表型。</span></p></li></ul><li><p><span><span leaf="">SV（结构变异）</span></span><span leaf="">：</span></p></li><ul><li><p><span leaf="">SV是“structural variants”的简称，指的是基因组中的较大规模变异，通常涉及数百个碱基对到数百万个碱基对。常见的结构变异包括大规模的缺失、重复、倒位和易位等。SV可以对基因功能产生重大影响，并且常常与复杂的疾病和性状相关。</span></p></li></ul><li><p><span><span leaf="">CNV（拷贝数变异）</span></span><span leaf="">：</span></p></li><ul><li><p><span leaf="">CNV是“copy number variations”的简称，特指在基因组中，某些特定区域的拷贝数的变化。CNV是一种特定类型的SV，它通常涉及基因组中一段较大的DNA序列，可以是插入、删除或重复。CNV可能影响基因表达水平和功能，因此与多种疾病和复杂性状有关。</span></p></li></ul><p><span leaf=""><br></span></p><p><strong><span leaf="">SV变异挖掘方法：</span></strong><span leaf=""><br></span></p><ul><li><p><span leaf="">1. 不一致的读段对方法，根据一对读段的两个读段之间不寻常的比对距离或方向来检测 SV 特征，因此通常基于双端短读段测序技术。</span></p></li><li><p><span leaf="">2. 读取深度方法检测基因组中连续位置的异常低或高测序深度的拷贝数变异，例如缺失或重复。</span></p></li><li><p><span leaf="">3. split-read 方法从与参考基因组比对中的异常签名中检测读段本身内的 SV 边界。</span></p></li><li><p><span leaf="">4. 最后，基于程序集的方法将从头或本地程序集与参考进行比较，以检测 SV 边界。</span></p></li></ul><p><strong><span leaf=""><br></span></strong></p><p><strong><span leaf="">SV挖掘常用的工具：</span></strong></p><ul><li><p><span leaf="">smoove</span><span leaf=""><br></span></p></li><li><p><span leaf="">Manta</span><span leaf=""><br></span></p></li><li><p><span leaf="">GRIDSS</span><span leaf=""><br></span></p></li></ul><p><span leaf=""><br></span></p><p><span leaf="">SV变异，Indel变异，CNV变异，常常使用vcf格式存储，GWAS分析大都是针对SNP数据，二倍体物种，一般保留二分类的数据，比如AT突变，AA、AT、TT，进而变为0-1-2编码的形式。具体基因型数据常见质控流程，可以参考：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247496622&amp;idx=1&amp;sn=8bcadb98814f805458136b4c576d0b5c&amp;scene=21#wechat_redirect" textvalue="GWAS分析中高质量基因型数据处理" data-itemshowtype="0" linktype="text" data-linktype="2">GWAS分析中高质量基因型数据处理</a></span><span leaf=""><br></span></p><p><strong><span leaf="">SV基因型数据转化：</span></strong><span leaf=""><br></span></p><p><span leaf="">GWAS常用的软件：TASSEL、GAPIT、GEMMA、GCTA都不支持SV直接的基因型数据，要么是SNP类型的plink格式数据，要么是0-1-2的数字格式，因此，我们需要对SV或者Indel或者CNV的基因型数据进行格式转换。</span><span leaf=""><br></span></p><p><span leaf="">我们需要将有SV格式的vcf数据，进行处理，处理步骤包括将ALT和REF变为A和T，将Type类型中，提取SV或者INdel或者CNV字符。</span><span leaf=""><br></span></p><p><span leaf="">比如原始vcf数据：</span><span leaf=""><br></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7ST1v7QhwQeGw5nF1nNcWaHF7ib0aY25PwehbVxHJN759SpibgrY6Oyx8Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.24410933081998115" data-s="300,640" data-type="png" data-w="1061" data-imgfileid="100012985" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7ST1v7QhwQeGw5nF1nNcWaHF7ib0aY25PwehbVxHJN759SpibgrY6Oyx8Q/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">示例代码：</span><span leaf=""><br></span></p><p><span><span leaf="">awk 'BEGIN {OFS = "\t"} /^#/ {print} !/^#/ &amp;&amp; $8 ~ /SVTYPE/ { $4 = "A" $5 = "T" gsub(/Gm0?/,"", $1) print}' \ smoove_filtered.vcf &gt; smoove_reformatted.vcf</span></span></p><p><span leaf="">修改后的vcf数据：</span><span leaf=""><br></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7S14RbPHdEwSic21pgczkicM9ZAokkxBGFiczpJrE5RXwyhxCMVhJuG8htA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.22962962962962963" data-s="300,640" data-type="png" data-w="1080" data-imgfileid="100012986" src="https://mmbiz.qpic.cn/mmbiz_png/XEicwVA08daD1y1yQ5Z17PV0Cwz7lnd7S14RbPHdEwSic21pgczkicM9ZAokkxBGFiczpJrE5RXwyhxCMVhJuG8htA/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">这样，SV的基因型数据，就变为了类似SNP类型的数据，就可以变为plink格式，直接在TASSEL、GEMMA、GCTA中使用了。</span><span leaf=""><br></span></p><p><strong><span leaf="">注意事项：</span></strong><span leaf=""><br></span></p><p><span><span leaf="">单纯提取Indel、SV或者CNV进行GWAS分析，如果位点足够多的话，和提取的SNP结果应该基本一致，因为都是关联的基因，是基因导致性状有变化，而不是这些变异，这些变异这是基因LD状态的代表标签。</span></span></p><p><span><span leaf="">基因注释时，需要根据Indel、SV和CNV的区间，SNP只有一个位置，而Indel、SV和CNV是两个位置（一个开头，一个结尾），进行上下游区间划分时，注意区分。基因注释参考：</span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247494970&amp;idx=1&amp;sn=3768f38c66cc350e71ad47c9b101175f&amp;scene=21#wechat_redirect" textvalue="批量对显著性SNP进行注释：bedtools" data-itemshowtype="0" linktype="text" data-linktype="2">批量对显著性SNP进行注释：bedtools</a></span></span><span><span leaf="">，</span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247492672&amp;idx=1&amp;sn=d48aa02e3d3e2c9842922f4d64fba428&amp;scene=21#wechat_redirect" textvalue="使用bedtools进行gwas基因注释" data-itemshowtype="0" linktype="text" data-linktype="2">使用bedtools进行gwas基因注释</a></span></span><span leaf=""><br></span></p><p><span><span leaf="">无论是Indel，SV还是CNV，以及SNP数据，GWAS分析流程都是类似的，变为SNP格式的数据，计算PCA、计算kinship也都是一样的。大片段的变异，有时候能找到比较大的效应，有比较大的PVE（</span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247494467&amp;idx=1&amp;sn=5707e1b3ae8fcef050242b570af67c8b&amp;scene=21#wechat_redirect" textvalue="GWAS中的effect有什么用？计算PVE和PRS！" data-itemshowtype="0" linktype="text" data-linktype="2">GWAS中的effect有什么用？计算PVE和PRS！</a></span></span><span><span leaf="">，</span></span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490562&amp;idx=1&amp;sn=b46f4bb04b6db399f713a4a910b45f9d&amp;scene=21#wechat_redirect" textvalue="GWAS软件：GAPIT+GEMMA+GCTA如何计算PVE？" data-itemshowtype="0" linktype="text" data-linktype="2">GWAS软件：GAPIT+GEMMA+GCTA如何计算PVE？</a></span></span><span><span leaf="">），这些位点对于分子标记辅助MAS和单位点筛选是非常具有实际意义的。</span></span></p><p data-pm-slice="0 0 []"><strong><span leaf="">推荐阅读：</span></strong><span leaf=""><br></span></p><p><strong><span leaf=""><br></span></strong></p><p><strong><strong><span><span leaf="">想要更好的学习和交流，快来加入</span></span><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247491476&amp;idx=1&amp;sn=8512962ea1264b569db4aa8d15b8712f&amp;chksm=e90ff086de7879908a1fa151e81004993a15650bae3f68e4d518a332beb18a130373c492043e&amp;scene=21#wechat_redirect" textvalue="飞哥的知识星球" data-itemshowtype="0" linktype="text" data-linktype="2">飞哥的知识星球</a></span><span><span leaf="">，这是一个生物统计+数量遗传学+GWAS+GS的社区，在这里你可以向飞哥提问、帮你指定学习计划、跟着飞哥一起做实战项目，冲冲冲。</span></span><span><strong><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247491476&amp;idx=1&amp;sn=8512962ea1264b569db4aa8d15b8712f&amp;chksm=e90ff086de7879908a1fa151e81004993a15650bae3f68e4d518a332beb18a130373c492043e&amp;scene=21#wechat_redirect" textvalue="点击这里加入吧：飞哥的学习圈子" data-itemshowtype="0" linktype="text" data-linktype="2">点击这里加入吧：</a></span></strong></span><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247491476&amp;idx=1&amp;sn=8512962ea1264b569db4aa8d15b8712f&amp;chksm=e90ff086de7879908a1fa151e81004993a15650bae3f68e4d518a332beb18a130373c492043e&amp;scene=21#wechat_redirect" textvalue="点击这里加入吧：飞哥的学习圈子" data-itemshowtype="0" linktype="text" data-linktype="2">飞哥的学习圈子</a></span></strong></strong></p><p><strong><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/XEicwVA08daCyoYQooxoH1tCzgN5xxevlQokBib7RiaStK9nPw4qo80OfqYAuRHsPAU4DJ2StOCUnHicqZNuG4fibow/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" alt="图片" data-ratio="1.2462264150943396" data-w="1060" data-imgfileid="100011428" src="https://mmbiz.qpic.cn/mmbiz_jpg/XEicwVA08daCyoYQooxoH1tCzgN5xxevlQokBib7RiaStK9nPw4qo80OfqYAuRHsPAU4DJ2StOCUnHicqZNuG4fibow/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></strong></p><p><span leaf=""><br></span></p><p><span leaf="">1，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489866&amp;idx=1&amp;sn=e8631d343a33ae956b23d97a6b2b3fe4&amp;chksm=e90ff658de787f4e3b52929c85adadbe8c6f54bf0943780ea94f9e19e4cc6ef8756e068761f9&amp;scene=21#wechat_redirect" textvalue="快来领取 | 飞哥的GWAS分析教程" data-itemshowtype="0" linktype="text" data-linktype="2">快来领取 | 飞哥的GWAS分析教程</a></span></p><p><span leaf=""><br></span></p><p><span leaf="">2，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247489124&amp;idx=1&amp;sn=923b2d827f0e4b6c70494ebd458bdfa5&amp;chksm=e90ff976de78706065f72955113db192e9f74682c503dc69c3ebf8d17e9b8726db82be1ffa0a&amp;scene=21#wechat_redirect" textvalue="飞哥汇总 | 入门数据分析资源推荐" data-itemshowtype="0" linktype="text" data-linktype="2">飞哥汇总 | 入门数据分析资源推荐</a></span><span leaf=""><br></span></p><p><span leaf=""><br></span></p><p><span leaf="">3，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247488460&amp;idx=3&amp;sn=b3acd30a2ab34e10415dacc90f596e4a&amp;chksm=e90ffcdede7875c8ba669382e38e91f5d1e10960448a1b88dbbe60bde1e5c2880e8ab918e914&amp;scene=21#wechat_redirect" textvalue="数量遗传学，分享几本书的电子版" data-itemshowtype="0" linktype="text" data-linktype="2">数量遗传学，分享几本书的电子版</a></span></p><p><span leaf=""><br></span></p><p><span leaf="">4，<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490492&amp;idx=1&amp;sn=24434d7598cf1993bbece938b63cc7e8&amp;chksm=e90ff4aede787db837d5de895a24bb0cc055868d4345a5974a24534827aaff9882c86bbe6550&amp;scene=21#wechat_redirect" textvalue="R语言学习看最新版的电子书不香嘛？" data-itemshowtype="0" linktype="text" data-linktype="2">R语言学习看最新版的电子书不香嘛？</a></span></p><p><span leaf=""><br></span></p><p><span><span leaf="">5，</span></span><span><span leaf=""><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI0MTIzNjYwNQ==&amp;mid=2247490897&amp;idx=1&amp;sn=2836fdb9bf636213d2ac9438c5d4d575&amp;chksm=e90ff243de787b55c501cf2ecc5bf3eb23f462b303ed4c861f0ade5c9d34741d338f18db3976&amp;scene=21#wechat_redirect" textvalue="书籍及配套代码领取--统计遗传分析导论" data-itemshowtype="0" linktype="text" data-linktype="2">书籍及配套代码领取--统计遗传分析导论</a></span></span></p><p><span><span leaf=""><br></span></span></p><section><span leaf=""><br></span><span></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/B2BdjFsqtV3SpEVFIFddwQ",target="_blank" rel="noopener noreferrer">原文链接</a>
