---
title: "R语言中的geneHapR包做单倍型/单倍型网络分析（1）"
date: 2025-07-20T15:33:13Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言中的geneHapR包做单倍型/单倍型网络分析（1） by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">这个R包对应的论文</span></p><p data-tool="mdnice编辑器"><span leaf="">https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-023-05318-9</span></p><h1 data-tool="mdnice编辑器"><span></span><span><font><span leaf="">geneHapR: an R package for gene haplotypic statistics and visualization</span></font></span><span></span></h1><p data-tool="mdnice编辑器"><span leaf="">对应的github链接</span></p><p data-tool="mdnice编辑器"><span leaf="">https://github.com/ZhangRenL/geneHapR</span></p><p data-tool="mdnice编辑器"><span leaf="">https://gitee.com/zhangrenl/genehapr 这个链接的wiki部分有比较详细的教程</span></p><p data-tool="mdnice编辑器"><span leaf="">正好今天看到一篇论文</span></p><p data-tool="mdnice编辑器"><span leaf="">https://www.nature.com/articles/s41467-025-60436-7</span></p><h1 data-tool="mdnice编辑器"><span></span><span><font><span leaf="">Allelic variations in </span></font><em><font><span leaf="">GA20ox3</span></font></em><font><span leaf=""> regulate fruit length and seed germination timing for high-altitude adaptation in </span></font><em><font><span leaf="">Arabidopsis thaliana</span></font></em></span><span></span></h1><p data-tool="mdnice编辑器"><span leaf="">论文中的Figure5是单倍型的分析</span></p><p data-tool="mdnice编辑器"><span leaf="">论文中提供了这个部分的比对好的fasta文件</span></p><p data-tool="mdnice编辑器"><span leaf="">论文中的方法部分写到</span></p><blockquote><span></span><p><font><span leaf="">The −412 to −434 bp segment of the </span></font><em><font><span leaf="">GA20ox3</span></font></em><font><span leaf=""> promoter region from 576 accessions was analyzed to construct a statistical parsimony network. This haplotype network was generated using Network 10.2 software</span></font></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">这里有一个疑问是为啥用专门的那三个碱基去做单倍型，通常某个基因的区间内或者上下游会有很多变异位点，如何选择变异位点做单倍型分析暂时还没有想明白。</span></p><p data-tool="mdnice编辑器"><span leaf="">论文中的FigS11，这三个碱基正好是位于一个转录因子结合基序的上面</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCWYd7q9Rn7Uoe7pIpPugJgyl0QvP927FZtfbyXmpafQ3OD4K2Pibd9Sg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1942336874051593" data-type="png" data-w="659" data-imgfileid="100015411" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCWYd7q9Rn7Uoe7pIpPugJgyl0QvP927FZtfbyXmpafQ3OD4K2Pibd9Sg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">从数据中把三个碱基的位点挑出来对应的位置是185-188，用geneHapR来分析单倍型</span></p><p data-tool="mdnice编辑器"><span leaf="">geneHapR 中有函数可以直接读vcf文件，也可以直接读fasta文件</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">library(geneHapR)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">library(tidyverse)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">seqs&lt;-import_seqs("genehapR/abc.txt")</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">单倍型分析</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">seqs2hap(seqs) -&gt; hapResults</span><span leaf=""><br></span><span leaf="">hapSummary&lt;-hap_summary(hapResults)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">画图展示不同类别的单倍型</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">plotHapTable(hapSummary)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCCD2Sl0ibrUBpgCp0IKmfhSQWM5Tt3SIIJcGRUpD1fB2BpBk489K1uIQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.674975074775673" data-type="png" data-w="1003" data-imgfileid="100015410" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCCD2Sl0ibrUBpgCp0IKmfhSQWM5Tt3SIIJcGRUpD1fB2BpBk489K1uIQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这个和论文中的结果符合，只不过有两个样本有gap被过滤掉了</span></p><p data-tool="mdnice编辑器"><span leaf="">单倍型网络分析</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">hapnet &lt;- get_hapNet(hapSummary)</span><span leaf=""><br></span><span leaf="">plotHapNet(hapnet)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCtR6TBTs17LvTiby5ibflTNCyeicIGPJFC47PQ2wuibKoLYTWspRpkQR0Og/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8126984126984127" data-type="png" data-w="630" data-imgfileid="100015408" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCtR6TBTs17LvTiby5ibflTNCyeicIGPJFC47PQ2wuibKoLYTWspRpkQR0Og/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">给单倍型网络一个分组</span></p><p data-tool="mdnice编辑器"><span leaf="">序列里的id对应的是 分组数据框的行名，我这里随机构造了</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">group.info&lt;-data.frame(x1=names(seqs),</span><span leaf=""><br></span><span leaf="">                       x2=paste0("group",sample(1:3,576,replace = TRUE))) %&gt;% </span><span leaf=""><br></span><span leaf="">  column_to_rownames("x1")</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">hapnet &lt;- get_hapNet(hapSummary,</span><span leaf=""><br></span><span leaf="">                     AccINFO = group.info, </span><span leaf=""><br></span><span leaf="">                     groupName = "x2")</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">plotHapNet(hapnet,legend = TRUE,show_color_legend = TRUE,show_size_legend = FALSE)</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCZILZ9XwUibaF8fd7qj4YExOuzE15sL5AvkAsicfmgwuG9ZxLW9Xia1gUA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7364341085271318" data-type="png" data-w="645" data-imgfileid="100015409" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4SHibjUngwmEzkwKkWfc7wCZILZ9XwUibaF8fd7qj4YExOuzE15sL5AvkAsicfmgwuG9ZxLW9Xia1gUA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这里比较有意思的是图里是需要借助鼠标点击一下作图区域，鼠标点击哪里图例就出现在哪里，这个功能不知道是怎么实现的</span></p><p data-tool="mdnice编辑器"><span leaf="">不同的单倍型对应的表型，对应的是论文中的fig5fghi</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">example.pheno&lt;-data.frame(x1=names(seqs),</span><span leaf=""><br></span><span leaf="">                          x2=sample(1:1000,576,replace = TRUE)) %&gt;% </span><span leaf=""><br></span><span leaf="">  column_to_rownames("x1")</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">example.pheno %&gt;% dim()</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">hapVsPheno(hap = hapResult,</span><span leaf=""><br></span><span leaf="">            pheno = example.pheno,</span><span leaf=""><br></span><span leaf="">            hapPrefix = "H",</span><span leaf=""><br></span><span leaf="">            filename.prefix = "A")  </span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">这个命令通常可以直接出图，我这里遇到了报错</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">Error in hapVsPheno(hap = hapResult, pheno = example.pheno, hapPrefix = "H",  : </span><span leaf=""><br></span><span leaf="">  After removed NAs, observations for 'x2' is not enough.</span><span leaf=""><br></span><span leaf="">此外: Warning message:</span><span leaf=""><br></span><span leaf="">In hapVsPheno(hap = hapResult, pheno = example.pheno, hapPrefix = "H",  :</span><span leaf=""><br></span><span leaf="">  phenoName is null, will use the first pheno</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">暂时看不出来是什么问题，有时间再研究吧</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">欢迎大家关注我的公众号</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">小明的数据分析笔记本</span></strong></p><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="小明的数据分析笔记本" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-id="MzI3NzQ3MTcxMg==" data-is_biz_ban="0" data-service_type="1" data-verify_status="1"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong><span leaf=""><br></span></strong></p><blockquote><span></span><p><span leaf="">小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</span></p></blockquote></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/EQTiBGqoVrYxGTmj5l3AGA",target="_blank" rel="noopener noreferrer">原文链接</a>
