---
title: "Nature å¤ç° | (æ‰‡å½¢/åŠåœ†å½¢) ç®±çº¿å›¾"
date: 2025-07-24T03:59:04Z
draft: ["false"]
tags: [
  "fetched",
  "MsTtç¬”è®°"
]
categories: ["Acdemic"]
---
Nature å¤ç° | (æ‰‡å½¢/åŠåœ†å½¢) ç®±çº¿å›¾ by MsTtç¬”è®°
------
<div><section data-tool="markdown2wechatç¼–è¾‘å™¨" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTtç¬”è®°" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="SCIç»˜å›¾ï¼ŒPython/Rï¼Œç”Ÿç‰©ä¿¡æ¯ï¼Œæ•°ç†ç»Ÿè®¡ï¼Œå¤šç»„å­¦åŸç†" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf=""><br></span></span></section><section data-mpa-powered-by="yiban.io" data-pm-slice="0 0 []"><span><span leaf="">è¯·å°Šé‡åŸåˆ›åŠ³åŠ¨æˆæœğŸ™</span></span></section><p><span><span leaf="">æœªç»å…è®¸ï¼Œä¸å¯æŠ„è¢­ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä»Šå¤©æ¥å¤ç°ä¸€ä¸ªæ—¢ç¾è§‚åˆæ•´æ´çš„ç®±çº¿å›¾ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">ç®±çº¿å›¾</span></strong><span leaf="">æ˜¯ä¸€ç§ç”¨äºå±•ç¤ºæ•°æ®åˆ†å¸ƒçš„å›¾å½¢ï¼Œç‰¹åˆ«é€‚åˆå±•ç¤ºä¸åŒç»„ä¹‹é—´çš„å·®å¼‚ã€‚å®ƒä¸»è¦å±•ç¤ºäº†ï¼š</span></p><ul><li><section><span leaf="">ä¸­ä½æ•°ï¼ˆMedianï¼‰ï¼šç®±å­ä¸­é—´çš„é‚£æ¡æ¨ªçº¿</span></section></li><li><section><span leaf="">ä¸Šä¸‹å››åˆ†ä½æ•°ï¼ˆQ1 å’Œ Q3ï¼‰ï¼šç®±å­çš„åº•éƒ¨å’Œé¡¶éƒ¨</span></section></li><li><section><span leaf="">å››åˆ†ä½è·ï¼ˆIQRï¼‰ï¼šQ3 - Q1ï¼Œè¡¡é‡æ•°æ®çš„ç¦»æ•£ç¨‹åº¦</span></section></li><li><section><span leaf="">é¡»ï¼ˆWhiskersï¼‰ï¼šå»¶ä¼¸åˆ°æ•°æ®ä¸­ä¸è¢«è§†ä¸ºæç«¯å€¼çš„æœ€å¤§èŒƒå›´</span></section></li><li><section><span leaf="">ç¦»ç¾¤å€¼ï¼ˆOutliersï¼‰ï¼šè¶…å‡ºé¡»ä¹‹å¤–çš„ç‚¹ï¼Œé€šå¸¸æ˜¯å¼‚å¸¸å€¼</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è™½ç„¶ç®±çº¿å›¾èƒ½æ¦‚æ‹¬æ•°æ®çš„åˆ†å¸ƒï¼Œä½†å®ƒçœ‹ä¸åˆ°æ¯ä¸ªå…·ä½“çš„æ•°æ®ç‚¹ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥åŠ ä¸Šï¼š</span><strong><span leaf="">æŠ–åŠ¨æ•£ç‚¹å›¾</span></strong><span leaf="">ã€‚å³åœ¨æ¯ä¸ªç»„çš„ç®±çº¿å›¾ä¸ŠåŠ ä¸€å±‚è½»å¾®â€œæŠ–åŠ¨â€çš„æ•£ç‚¹ï¼Œè®©æ‰€æœ‰è§‚æµ‹å€¼éƒ½å¯è§ï¼Œä¸ä¼šé‡å ï¼Œæ›´ç›´è§‚åœ°çœ‹åˆ°æ•°æ®å¯†åº¦ã€ç¦»ç¾¤ç‚¹ã€æ•°æ®åˆ†å¸ƒç­‰ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ‰æ—¶å€™æˆ‘ä»¬æƒ³çŸ¥é“ä¸¤ä¸ªç»„ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸æ˜¯â€œæ˜¾è‘—çš„â€ï¼Œè¿™å°±éœ€è¦åš</span><strong><span leaf="">ç»Ÿè®¡æ£€éªŒ</span></strong><span leaf="">ã€‚</span></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ˜¾è‘—æ€§æ£€éªŒæ–¹æ³•æ±‡æ€»è¡¨ï¼ˆé€‚ç”¨äºç®±çº¿å›¾ç­‰åˆ†ç»„æ¯”è¾ƒï¼‰</span></span><span></span></h3><section data-tool="mdniceç¼–è¾‘å™¨"><table><thead><tr><th data-colwidth="88"><section><span leaf="">æ¯”è¾ƒç±»å‹</span></section></th><th data-colwidth="138"><section><span leaf="">é€‚ç”¨æ–¹æ³•</span></section></th><th data-colwidth="97"><section><span leaf="">æ•°æ®è¦æ±‚</span></section></th><th><section><span leaf="">éå‚æ•°æ›¿ä»£æ–¹æ³•</span></section></th><th data-colwidth="88"><section><span leaf="">Rä¸­å‡½æ•°</span></section></th></tr></thead><tbody><tr><td data-colwidth="88"><section><span leaf="">ä¸¤ç»„ç‹¬ç«‹æ ·æœ¬</span></section></td><td data-colwidth="138"><strong><span leaf="">ç‹¬ç«‹æ ·æœ¬tæ£€éªŒ</span></strong></td><td data-colwidth="97"><section><span leaf="">æ­£æ€æ€§ + æ–¹å·®é½æ€§</span></section></td><td><strong><span leaf="">Mann-Whitney Uæ£€éªŒ</span></strong></td><td data-colwidth="88"><code><span leaf="">t.test()</span></code></td></tr><tr><td data-colwidth="88"><section><span leaf="">ä¸¤ç»„é…å¯¹æ ·æœ¬</span></section></td><td data-colwidth="138"><strong><span leaf="">é…å¯¹tæ£€éªŒ</span></strong></td><td data-colwidth="97"><section><span leaf="">æ­£æ€æ€§ + æˆå¯¹å·®å¼‚</span></section></td><td><strong><span leaf="">Wilcoxonç¬¦å·ç§©æ£€éªŒ</span></strong></td><td data-colwidth="88"><code><span leaf="">t.test(paired=TRUE)</span></code></td></tr><tr><td data-colwidth="88"><section><span leaf="">å¤šç»„ç‹¬ç«‹æ ·æœ¬</span></section></td><td data-colwidth="138"><strong><span leaf="">ANOVA</span></strong></td><td data-colwidth="97"><section><span leaf="">æ­£æ€æ€§ + æ–¹å·®é½æ€§</span></section></td><td><strong><span leaf="">Kruskal-Wallisæ£€éªŒ</span></strong></td><td data-colwidth="88"><code><span leaf="">aov()</span></code><section><span leaf="">Â æˆ–Â </span><code><span leaf="">anova()</span></code></section></td></tr><tr><td data-colwidth="88"><section><span leaf="">å¤šç»„é…å¯¹æ ·æœ¬</span></section></td><td data-colwidth="138"><strong><span leaf="">é‡å¤æµ‹é‡ANOVA</span></strong></td><td data-colwidth="97"><section><span leaf="">æ­£æ€æ€§ + çƒå½¢æ£€éªŒ</span></section></td><td><strong><span leaf="">Friedmanæ£€éªŒ</span></strong></td><td data-colwidth="88"><code><span leaf="">aov() + Error()</span></code><section><span leaf="">Â æˆ–Â </span><code><span leaf="">lme4::lmer()</span></code></section></td></tr><tr><td data-colwidth="88"><section><span leaf="">ä¸¤ä¸¤ç»„é—´å¤šé‡æ¯”è¾ƒ</span></section></td><td data-colwidth="138"><strong><span leaf="">Tukey HSD</span></strong></td><td data-colwidth="97"><section><span leaf="">åŸºäºANOVAç»“æœ</span></section></td><td><strong><span leaf="">Dunnæ£€éªŒ</span></strong><section><span leaf="">ï¼ˆé…åˆKr-Wï¼‰</span></section></td><td data-colwidth="88"><code><span leaf="">TukeyHSD()</span></code><section><span leaf="">Â æˆ–</span><code><span leaf="">multcomp::glht()</span></code></section></td></tr><tr><td data-colwidth="88"><section><span leaf="">éå‚æ•°å¤šç»„æ¯”è¾ƒåä¸¤ä¸¤æ¯”è¾ƒ</span></section></td><td data-colwidth="138"><section><span leaf="">â€”</span></section></td><td data-colwidth="97"><section><span leaf="">æ— éœ€æ­£æ€</span></section></td><td><strong><span leaf="">Dunnæ£€éªŒ</span></strong><section><span leaf="">ï¼ˆåŠ Bonf.ï¼‰</span></section></td><td data-colwidth="88"><code><span leaf="">FSA::dunnTest()</span></code></td></tr></tbody></table></section><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf=""><span textstyle="">ç®±çº¿å›¾å¸®ä½ çœ‹æ¦‚å†µï¼ŒæŠ–åŠ¨ç‚¹å¸®ä½ çœ‹ç»†èŠ‚ï¼Œæ˜¾è‘—æ€§æ£€éªŒå‘Šè¯‰ä½ â€œå·®å¼‚æ˜¯ä¸æ˜¯é è°±â€ã€‚</span></span></strong></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŸå›¾</span></span></h2><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic82mza4m4Km9JT1q1DicdiaS3kjHJIgticibr3z2B1tvr5QerJd8FdrpichJg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0905797101449275" data-s="300,640" data-type="png" data-w="828" type="block" data-imgfileid="100001480" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic82mza4m4Km9JT1q1DicdiaS3kjHJIgticibr3z2B1tvr5QerJd8FdrpichJg/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">å¤ç°å›¾ - ç®±çº¿å›¾</span></span></h2><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8aJCSdcXOQCnI0GpTFxVK5eSiaf3ut39vLocsyy9QNcK3KiaXwazvczKQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.087037037037037" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001481" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8aJCSdcXOQCnI0GpTFxVK5eSiaf3ut39vLocsyy9QNcK3KiaXwazvczKQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ‹“å±•å›¾1 - æ‰‡å½¢ç®±çº¿å›¾</span></span></h2><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic86aNOgAF0iaGiabVFlbHCdMCZ9Bn97CwevR2yicHeo3ickLfbV8bDjicW5GQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7314814814814815" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001482" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic86aNOgAF0iaGiabVFlbHCdMCZ9Bn97CwevR2yicHeo3ickLfbV8bDjicW5GQ/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ‹“å±•å›¾2 - åŠåœ†å½¢å°æç´å›¾</span></span></h2><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8DaQR1vz2rurCU2PicnJibzEfNgIUicSRQEJwPbC26TngRWlicRTkhuvpZw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.649074074074074" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001483" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8DaQR1vz2rurCU2PicnJibzEfNgIUicSRQEJwPbC26TngRWlicRTkhuvpZw/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf=""><span textstyle="">åŸå›¾-ç®±çº¿å›¾</span></span></span><span></span></h3><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½åŒ…ï¼Œè¯»å…¥æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf="">library(tidyverse) Â Â </span></code><code><span leaf="">library(readxl) Â  Â  Â </span></code><code><span leaf="">library(ggbeeswarm) Â </span></code><code><span leaf="">library(ggpubr)Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®éšæœºç§å­ä¿è¯ç»“æœå¯é‡å¤</span></span></code><code><span leaf="">set.seed(<span>123</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ•°æ®</span></span></code><code><span leaf=""><span>data</span>Â &lt;- read_excel(<span>"data.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å°†æ•°æ®ä»å®½æ ¼å¼è½¬æ¢ä¸ºé•¿æ ¼å¼</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  pivot_longer(</span></code><code><span leaf="">Â  Â  cols = starts_with(<span>"Sample"</span>), Â </span></code><code><span leaf="">Â  Â  names_to =Â <span>"Sample"</span>, Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  Â  values_to =Â <span>"Value"</span>Â  Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  )</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å¯¹Valueè¿›è¡Œlog10è½¬æ¢ï¼Œç”¨äºYè½´æ ‡å‡†åŒ–</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  mutate(log_Value = log10(Value))Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰åˆ†ç»„é¡ºåºï¼ˆå› å­æ°´å¹³ï¼‰</span></span></code><code><span leaf=""><span>data</span><span>$group</span>&lt;<span>-factor</span>(<span>data</span><span>$group</span>,levels = c(<span>"SARS-CoV-2"</span>,<span>"SARS-CoV-2 Delta"</span>,<span>"SARS-CoV-2 Beta"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Mu"</span>,<span>"Bat CoV BANAL-52"</span>,<span>"Pangolin CoV GD-1"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Omicron BA.1"</span>,<span>"SARS-CoV-2 Omicron BA.2"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Bat CoV RaTG13"</span>,<span>"Pangolin CoV GX-P5L"</span>,<span>"SARS-CoV-1"</span>))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰é¢œè‰²</span></span></code><code><span leaf=""><span># å¡«å……è‰²</span></span></code><code><span leaf="">my_color&lt;- c(<span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#7aced6"</span>,<span>"#b09ac9"</span>,<span>"#f9af8b"</span>,<span>"#f48d8e"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â <span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#ed1d23"</span>,<span>"#007c8a"</span>,<span>"#f16221"</span>)</span></code><code><span leaf=""><span># è¾¹æ¡†è‰²</span></span></code><code><span leaf="">my_color1 &lt;- c(<span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#007c8a"</span>,<span>"#2c165a"</span>,<span>"#f16221"</span>,<span>"#eb1c22"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#f58e8f"</span>,<span>"#7aced6"</span>,<span>"#f8ab85"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰è¦è¿›è¡Œç»Ÿè®¡æ¯”è¾ƒçš„ç»„åˆ«å¯¹</span></span></code><code><span leaf="">my_comparisons &lt;- list(</span></code><code><span leaf="">Â  c(<span>"SARS-CoV-2 Beta"</span>,Â <span>"Bat CoV BANAL-52"</span>),</span></code><code><span leaf="">Â  c(<span>"SARS-CoV-2 Omicron BA.1"</span>,Â <span>"SARS-CoV-2 Omicron BA.2"</span>),</span></code><code><span leaf="">Â  c(<span>"SARS-CoV-2 Omicron BA.1"</span>,Â <span>"Bat CoV RaTG13"</span>),</span></code><code><span leaf="">Â  c(<span>"SARS-CoV-2 Omicron BA.1"</span>,Â <span>"Pangolin CoV GX-P5L"</span>)</span></code><code><span leaf="">)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥æ•°æ®ï¼Œå¤„ç†æ•°æ®ï¼Œå®šä¹‰åˆ†ç»„é¡ºåºã€é¢œè‰²ã€è¦è¿›è¡Œç»Ÿè®¡æ¯”è¾ƒçš„ç»„åˆ«å¯¹ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼Œæ— å®é™…æ„ä¹‰ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># å…ˆç»˜åˆ¶ç®±çº¿å›¾å¹¶æå–ç¦»ç¾¤å€¼</span></span></code><code><span leaf=""><span>p</span>Â &lt;- ggplot(data, aes(x = group, y = log_Value)) + geom_boxplot()</span></code><code><span leaf=""><span>box_data</span>Â &lt;- ggplot_build(p)$data[[<span>1</span>]] Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è·å–ç¦»ç¾¤å€¼</span></span></code><code><span leaf=""><span>outliers</span>Â &lt;- box_data %&gt;%</span></code><code><span leaf="">Â Â <span>select</span>(x, y = outliers) %&gt;% Â Â </span></code><code><span leaf="">Â Â <span>tidyr</span>::unnest(y) Â  Â  Â  Â  Â  Â  Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¿‡æ»¤åŸå§‹æ•°æ®ï¼ˆæ’é™¤ç¦»ç¾¤å€¼ï¼‰</span></span></code><code><span leaf=""><span>data_filtered</span>Â &lt;- data %&gt;%</span></code><code><span leaf="">Â Â <span>anti_join</span>(outliers, by = c(<span>"group"</span>Â =Â <span>"x"</span>,Â <span>"log_Value"</span>Â =Â <span>"y"</span>)) %&gt;%Â </span></code><code><span leaf="">Â Â <span>group_by</span>(group) %&gt;% Â  Â  Â  Â  Â  Â  Â  Â </span></code><code><span leaf="">Â Â <span>mutate</span>(max = max(log_Value)) %&gt;% Â Â </span></code><code><span leaf="">Â Â <span>ungroup</span>()Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># é‡æ–°ç»˜åˆ¶å®Œæ•´å›¾å½¢</span></span></code><code><span leaf=""><span>ggplot</span>(data, aes(x = group, y = log_Value)) +</span></code><code><span leaf="">Â Â <span>geom_boxplot</span>(aes(colour = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>outlier</span>.shape = NA, size =Â <span>0</span>.<span>3</span>, width =Â <span>0</span>.<span>4</span>, staplewidth =Â <span>0</span>.<span>5</span>) +</span></code><code><span leaf="">Â Â <span>geom_quasirandom</span>(data = data_filtered, aes(fill = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>1</span>.<span>1</span>, shape =Â <span>21</span>, stroke =Â <span>0</span>, width =Â <span>0</span>.<span>2</span>) +</span></code><code><span leaf="">Â Â <span>geom_quasirandom</span>(data = data_filtered, aes(colour = group ),Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>1</span>.<span>1</span>, shape =Â <span>21</span>, stroke =Â <span>0</span>.<span>25</span>, width =Â <span>0</span>.<span>2</span>, fill = NA) +</span></code><code><span leaf="">Â Â <span>stat_compare_means</span>(comparisons = my_comparisons, Â  # æŒ‡å®šè¦æ¯”è¾ƒçš„ç»„åˆ«å¯¹</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>method</span>Â =Â <span>"t.test"</span>, Â  Â  Â  Â  Â  Â  Â # ä½¿ç”¨çš„ç»Ÿè®¡æ£€éªŒæ–¹æ³•</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>label</span>Â =Â <span>"p.format"</span>, Â  Â  Â  Â  Â  Â  # æ ‡ç­¾æ˜¾ç¤ºæ ¼å¼ï¼šæ˜¾ç¤ºpå€¼</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>tip</span>.length =Â <span>0</span>.<span>01</span>, Â  Â  Â  Â  Â  Â  Â # æ˜¾è‘—æ€§çº¿é¡¶ç«¯çš„çŸ­æ¨ªçº¿é•¿åº¦</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>step</span>.increase =Â <span>0</span>.<span>1</span>, Â  Â  Â  Â  Â  Â # å¤šé‡æ¯”è¾ƒæ—¶æ ‡ç­¾çš„å‚ç›´é—´è·å¢é‡</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>4</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ ‡ç­¾æ–‡å­—å¤§å°</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>vjust</span>Â =Â <span>0</span>.<span>2</span>) + Â  Â  Â  Â  Â  Â  Â  Â  Â # æ ‡ç­¾å‚ç›´è°ƒæ•´ä½ç½®</span></code><code><span leaf="">Â Â <span># æ·»åŠ æ¯ç»„çš„å‡å€¼</span></span></code><code><span leaf="">Â Â <span>geom_text</span>(data = distinct(data_filtered, group, mean, max), Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>aes</span>(x = group, y = max+<span>0</span>.<span>15</span>, label = sprintf(<span>"%.1f"</span>, mean)),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>hjust</span>Â =Â <span>0</span>.<span>5</span>, vjust =Â <span>0</span>.<span>5</span>, size =Â <span>4</span>) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_fill_manual</span>(values = my_color) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_color_manual</span>(values = my_color1) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®Yè½´èŒƒå›´ï¼Œä¸”ä¸æ‰©å±•</span></span></code><code><span leaf="">Â Â <span>scale_y_continuous</span>(expand = c(<span>0</span>,Â <span>0</span>), limits = c(<span>0</span>,Â <span>5</span>))+</span></code><code><span leaf="">Â Â <span># Yè½´æ ‡é¢˜</span></span></code><code><span leaf="">Â Â <span>labs</span>(y=<span>"sVNT (log NT50)"</span>)+</span></code><code><span leaf="">Â Â <span># è®¾ç½®ä¸»é¢˜</span></span></code><code><span leaf="">Â Â <span>theme_classic</span>() +</span></code><code><span leaf="">Â Â <span>theme</span>(axis.ticks.length = unit(<span>8</span>,Â <span>"pt"</span>), Â  Â  Â  Â  Â  Â  # åæ ‡è½´åˆ»åº¦çº¿é•¿åº¦</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.title.x = element_blank(), Â  Â  Â  Â  Â  Â  Â  Â # ç§»é™¤Xè½´æ ‡é¢˜</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.ticks = element_line(linewidth =Â <span>0</span>.<span>3</span>), Â  Â # åæ ‡è½´åˆ»åº¦çº¿å®½åº¦</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.line = element_line(linewidth =Â <span>0</span>.<span>3</span>), Â  Â  # åæ ‡è½´çº¿å®½åº¦</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.title.y = element_text(size =Â <span>13</span>), Â  Â  Â  Â # Yè½´æ ‡é¢˜å¤§å°</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.x = element_text(angle =Â <span>90</span>, hjust =Â <span>1</span>,vjust =Â <span>0</span>.<span>5</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>13</span>, color =Â <span>"black"</span>), Â # Xè½´æ ‡ç­¾æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.y = element_text(size =Â <span>13</span>, color =Â <span>"black"</span>), Â # Yè½´æ ‡ç­¾æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>legend</span>.position =Â <span>"none"</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # ä¸æ˜¾ç¤ºå›¾ä¾‹</span></code><code><span leaf="">Â  Â  Â  Â Â <span>plot</span>.margin = margin(<span>10</span>,Â <span>10</span>,Â <span>10</span>,Â <span>10</span>)) Â  Â  Â  Â  Â  # å››å‘¨è¾¹è·ï¼šä¸Š/å³/ä¸‹/å·¦ Â </span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8BEkIWl2JMC8dmhKhwOpEFbSrJh0XOiaeBE1Baaarj6SzlWgPSZvtPIw/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0972222222222223" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001484" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8BEkIWl2JMC8dmhKhwOpEFbSrJh0XOiaeBE1Baaarj6SzlWgPSZvtPIw/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf=""><span textstyle="">æ‹“å±•å›¾1 - æ‰‡å½¢ç®±çº¿å›¾</span></span></span><span></span></h3><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½åŒ…ï¼Œè¯»å…¥æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf="">library(tidyverse) Â Â </span></code><code><span leaf="">library(readxl) Â  Â  Â </span></code><code><span leaf="">library(ggbeeswarm) Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®éšæœºç§å­ä¿è¯ç»“æœå¯é‡å¤</span></span></code><code><span leaf="">set.seed(<span>123</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ•°æ®</span></span></code><code><span leaf=""><span>data</span>Â &lt;- read_excel(<span>"data.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å°†æ•°æ®ä»å®½æ ¼å¼è½¬æ¢ä¸ºé•¿æ ¼å¼</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  pivot_longer(</span></code><code><span leaf="">Â  Â  cols = starts_with(<span>"Sample"</span>), Â </span></code><code><span leaf="">Â  Â  names_to =Â <span>"Sample"</span>, Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  Â  values_to =Â <span>"Value"</span>Â  Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  )</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å¯¹Valueè¿›è¡Œlog10è½¬æ¢ï¼Œç”¨äºYè½´æ ‡å‡†åŒ–</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  mutate(log_Value = log10(Value))Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰åˆ†ç»„é¡ºåºï¼ˆå› å­æ°´å¹³ï¼‰</span></span></code><code><span leaf=""><span>data</span><span>$group</span>&lt;<span>-factor</span>(<span>data</span><span>$group</span>,levels = c(<span>"SARS-CoV-2"</span>,<span>"SARS-CoV-2 Delta"</span>,<span>"SARS-CoV-2 Beta"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Mu"</span>,<span>"Bat CoV BANAL-52"</span>,<span>"Pangolin CoV GD-1"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Omicron BA.1"</span>,<span>"SARS-CoV-2 Omicron BA.2"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Bat CoV RaTG13"</span>,<span>"Pangolin CoV GX-P5L"</span>,<span>"SARS-CoV-1"</span>))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰é¢œè‰²</span></span></code><code><span leaf=""><span># å¡«å……è‰²</span></span></code><code><span leaf="">my_color&lt;- c(<span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#7aced6"</span>,<span>"#b09ac9"</span>,<span>"#f9af8b"</span>,<span>"#f48d8e"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â <span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#ed1d23"</span>,<span>"#007c8a"</span>,<span>"#f16221"</span>)</span></code><code><span leaf=""><span># è¾¹æ¡†è‰²</span></span></code><code><span leaf="">my_color1 &lt;- c(<span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#007c8a"</span>,<span>"#2c165a"</span>,<span>"#f16221"</span>,<span>"#eb1c22"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#f58e8f"</span>,<span>"#7aced6"</span>,<span>"#f8ab85"</span>)</span></code></pre></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">è¯»å…¥æ•°æ®ï¼Œè½¬æˆä¾¿äºç»˜å›¾çš„é•¿æ ¼å¼ï¼Œå®šä¹‰å¥½æ¯ä¸ªåˆ†ç»„çš„é¢œè‰²å’Œé¡ºåºã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ­¤ç»˜å›¾æ•°æ®ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼Œæ— å®é™…æ„ä¹‰ï¼Œå¦‚éœ€æ–‡æœ«å¯ä»¥è‡ªåŠ©è·å–ã€‚</span></span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># å…ˆç»˜åˆ¶ç®±çº¿å›¾å¹¶æå–ç¦»ç¾¤å€¼</span></span></code><code><span leaf=""><span>p</span>Â &lt;- ggplot(data, aes(x = group, y = log_Value)) + geom_boxplot()</span></code><code><span leaf=""><span>box_data</span>Â &lt;- ggplot_build(p)$data[[<span>1</span>]] Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è·å–ç¦»ç¾¤å€¼</span></span></code><code><span leaf=""><span>outliers</span>Â &lt;- box_data %&gt;%</span></code><code><span leaf="">Â Â <span>select</span>(x, y = outliers) %&gt;% Â Â </span></code><code><span leaf="">Â Â <span>tidyr</span>::unnest(y) Â  Â  Â  Â  Â  Â  Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¿‡æ»¤åŸå§‹æ•°æ®ï¼ˆæ’é™¤ç¦»ç¾¤å€¼ï¼‰</span></span></code><code><span leaf=""><span>data_filtered</span>Â &lt;- data %&gt;%</span></code><code><span leaf="">Â Â <span>anti_join</span>(outliers, by = c(<span>"group"</span>Â =Â <span>"x"</span>,Â <span>"log_Value"</span>Â =Â <span>"y"</span>)) %&gt;% Â </span></code><code><span leaf="">Â Â <span>group_by</span>(group) %&gt;% Â  Â  Â  Â  Â  Â  Â  Â </span></code><code><span leaf="">Â Â <span>mutate</span>(max = max(log_Value)) %&gt;% Â  #</span></code><code><span leaf="">Â Â <span>ungroup</span>()Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># é‡æ–°ç»˜åˆ¶å®Œæ•´å›¾å½¢</span></span></code><code><span leaf=""><span>ggplot</span>(data, aes(x = group, y = log_Value)) +</span></code><code><span leaf="">Â Â <span>geom_boxplot</span>(aes(colour = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>outlier</span>.shape = NA, size =Â <span>0</span>.<span>3</span>, width =Â <span>0</span>.<span>4</span>, staplewidth =Â <span>0</span>.<span>5</span>) +</span></code><code><span leaf="">Â Â <span>geom_quasirandom</span>(data = data_filtered, aes(fill = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>0</span>.<span>8</span>, shape =Â <span>21</span>, stroke =Â <span>0</span>, width =Â <span>0</span>.<span>2</span>) +</span></code><code><span leaf="">Â Â <span>geom_quasirandom</span>(data = data_filtered, aes(colour = group ),Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>size</span>Â =Â <span>0</span>.<span>8</span>, shape =Â <span>21</span>, stroke =Â <span>0</span>.<span>25</span>, width =Â <span>0</span>.<span>2</span>, fill = NA) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®Yè½´èŒƒå›´ï¼Œä¸”ä¸æ‰©å±•</span></span></code><code><span leaf="">Â Â <span>scale_y_continuous</span>(expand = c(<span>0</span>,Â <span>0</span>), limits = c(<span>0</span>,Â <span>4</span>)) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ å‚ç›´çº¿ (x = 11.7å¤„)</span></span></code><code><span leaf="">Â Â <span>annotate</span>(<span>"segment"</span>, x =Â <span>11</span>.<span>7</span>, xend =Â <span>11</span>.<span>7</span>, y =Â <span>0</span>, yend =Â <span>4</span>, linewidth =Â <span>0</span>.<span>3</span>) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ æ°´å¹³çº¿ (y = 0å¤„)</span></span></code><code><span leaf="">Â Â <span>annotate</span>(<span>"segment"</span>, x =Â <span>0</span>, xend =Â <span>11</span>.<span>7</span>, y =Â <span>0</span>, yend =Â <span>0</span>, linewidth =Â <span>0</span>.<span>3</span>) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_fill_manual</span>(values = my_color) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_color_manual</span>(values = my_color1) +</span></code><code><span leaf="">Â Â <span># æåæ ‡å˜æ¢</span></span></code><code><span leaf="">Â Â <span>coord_radial</span>(start = -pi/<span>3</span>, Â  Â  Â  Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>end</span>Â = pi/<span>3</span>, Â  Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>r</span>.axis.inside = TRUE, Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>inner</span>.radius =Â <span>0</span>.<span>3</span>, Â  Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>rotate</span>.angle = TRUE, Â  Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>clip</span>Â =Â <span>"off"</span>) + Â  Â  Â  Â Â </span></code><code><span leaf="">Â Â <span># æ·»åŠ å¾„å‘æ ‡ç­¾ï¼Œå¹¶è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>geom_text</span>(data = distinct(data_filtered, group), Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>aes</span>(x = group, y =Â <span>4</span>, label = group, color = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>angle</span>Â =Â <span>90</span>, hjust = -<span>0</span>.<span>05</span>, size =Â <span>3</span>.<span>5</span>, fontface =Â <span>"bold"</span>) + Â  # æ–‡æœ¬æ–¹å‘æ˜¯å‚ç›´</span></code><code><span leaf="">Â Â <span># æ·»åŠ å‡å€¼æ ‡ç­¾</span></span></code><code><span leaf="">Â Â <span>geom_text</span>(data = distinct(data_filtered, group, mean, max), Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>aes</span>(x = group, y = max+<span>0</span>.<span>2</span>, label = sprintf(<span>"%.1f"</span>, mean)),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>hjust</span>Â =Â <span>0</span>.<span>5</span>, vjust =Â <span>0</span>.<span>5</span>, size =Â <span>3</span>.<span>5</span>) +</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># è®¾ç½®ä¸»é¢˜</span></span></code><code><span leaf="">Â Â <span>theme_minimal</span>() +</span></code><code><span leaf="">Â Â <span>theme</span>(axis.title = element_blank(), Â # ä¸æ˜¾ç¤ºXå’ŒYåæ ‡è½´æ ‡é¢˜</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.line = element_line(color =Â <span>"black"</span>, linewidth =Â <span>0</span>.<span>3</span>), Â # è®¾ç½®åæ ‡è½´çº¿æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.ticks = element_line(color =Â <span>"black"</span>), Â  # è®¾ç½®åˆ»åº¦çº¿é¢œè‰²</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.x = element_blank(), Â  Â  Â  Â  Â  Â  Â  Â # éšè—xè½´(è§’åº¦è½´)æ ‡ç­¾ï¼Œå› ä¸ºå‰é¢è‡ªå®šä¹‰å·²ç»æ·»åŠ äº†</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.y = element_text(size =Â <span>12</span>, color =Â <span>"black"</span>), Â # è®¾ç½®yè½´(åŠå¾„è½´)æ ‡ç­¾æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>panel</span>.grid = element_line(linewidth =Â <span>0</span>.<span>3</span>), Â  Â  Â  Â # è®¾ç½®ç½‘æ ¼çº¿ç²—ç»†</span></code><code><span leaf="">Â  Â  Â  Â Â <span>legend</span>.position =Â <span>"none"</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ä¸æ˜¾ç¤ºå›¾ä¾‹</span></code><code><span leaf="">Â  Â  Â  Â Â <span>plot</span>.margin = margin(<span>10</span>,Â <span>10</span>,Â <span>0</span>,Â <span>10</span>)) Â  Â  Â  Â  Â # å››å‘¨è¾¹è·ï¼šä¸Š/å³/ä¸‹/å·¦ Â </span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8EO6IAws4Q3xJBaEzJqmWQsdrxE5TN8hjibgVddHqO4FJORVwvd1TPfA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.737037037037037" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001485" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8EO6IAws4Q3xJBaEzJqmWQsdrxE5TN8hjibgVddHqO4FJORVwvd1TPfA/640?wx_fmt=png&amp;from=appmsg"></section><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf=""><span textstyle="">æ‹“å±•å›¾2 - åŠåœ†å½¢å°æç´å›¾</span></span></span><span></span></h3><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½åŒ…ï¼Œè¯»å…¥æ•°æ®</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="powershell"><code><span leaf=""><span># åŠ è½½å¿…è¦çš„åŒ…</span></span></code><code><span leaf="">library(tidyverse) Â Â </span></code><code><span leaf="">library(readxl) Â  Â  Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¾ç½®éšæœºç§å­ä¿è¯ç»“æœå¯é‡å¤</span></span></code><code><span leaf="">set.seed(<span>123</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è¯»å…¥æ•°æ®</span></span></code><code><span leaf=""><span>data</span>Â &lt;- read_excel(<span>"data.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å°†æ•°æ®ä»å®½æ ¼å¼è½¬æ¢ä¸ºé•¿æ ¼å¼</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  pivot_longer(</span></code><code><span leaf="">Â  Â  cols = starts_with(<span>"Sample"</span>), Â </span></code><code><span leaf="">Â  Â  names_to =Â <span>"Sample"</span>, Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  Â  values_to =Â <span>"Value"</span>Â  Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  )</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># è®¡ç®—æ¯ç»„çš„æœ€å¤§å€¼</span></span></code><code><span leaf=""><span>data</span>Â &lt;-Â <span>data</span>Â %&gt;%</span></code><code><span leaf="">Â  group_by(<span>group</span>) %&gt;% Â  Â  Â  Â  Â Â </span></code><code><span leaf="">Â  mutate(max = max(Value)) %&gt;% Â </span></code><code><span leaf="">Â  ungroup()Â </span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰åˆ†ç»„é¡ºåºï¼ˆå› å­æ°´å¹³ï¼‰</span></span></code><code><span leaf=""><span>data</span><span>$group</span>&lt;<span>-factor</span>(<span>data</span><span>$group</span>,levels = c(<span>"SARS-CoV-2"</span>,<span>"SARS-CoV-2 Delta"</span>,<span>"SARS-CoV-2 Beta"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Mu"</span>,<span>"Bat CoV BANAL-52"</span>,<span>"Pangolin CoV GD-1"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"SARS-CoV-2 Omicron BA.1"</span>,<span>"SARS-CoV-2 Omicron BA.2"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>"Bat CoV RaTG13"</span>,<span>"Pangolin CoV GX-P5L"</span>,<span>"SARS-CoV-1"</span>))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># å®šä¹‰é¢œè‰²</span></span></code><code><span leaf=""><span># å¡«å……è‰²</span></span></code><code><span leaf="">my_color&lt;- c(<span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#7aced6"</span>,<span>"#b09ac9"</span>,<span>"#f9af8b"</span>,<span>"#f48d8e"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â <span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#ed1d23"</span>,<span>"#007c8a"</span>,<span>"#f16221"</span>)</span></code><code><span leaf=""><span># è¾¹æ¡†è‰²</span></span></code><code><span leaf="">my_color1 &lt;- c(<span>"#2c165a"</span>,<span>"#3364af"</span>,<span>"#007c8a"</span>,<span>"#2c165a"</span>,<span>"#f16221"</span>,<span>"#eb1c22"</span>,</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>"#b09ac9"</span>,<span>"#2ac4f4"</span>,<span>"#f58e8f"</span>,<span>"#7aced6"</span>,<span>"#f8ab85"</span>)</span></code></pre></section><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç»˜å›¾</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># ç»˜å›¾</span></span></code><code><span leaf=""><span>ggplot</span>(data, aes(x = group, y = log10(Value))) +</span></code><code><span leaf="">Â Â <span>geom_violin</span>(aes(fill = group, color = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â Â <span>width</span>Â =Â <span>0</span>.<span>4</span>, scale =Â <span>"width"</span>) +</span></code><code><span leaf="">Â Â <span>geom_boxplot</span>(width =Â <span>0</span>.<span>1</span>, outlier.shape = NA, size =Â <span>0</span>.<span>3</span>, staplewidth =Â <span>0</span>.<span>5</span>) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®Yè½´èŒƒå›´ï¼Œä¸”ä¸æ‰©å±•</span></span></code><code><span leaf="">Â Â <span>scale_y_continuous</span>(expand = c(<span>0</span>,Â <span>0</span>), limits = c(<span>0</span>,Â <span>4</span>)) +</span></code><code><span leaf="">Â Â <span># æ·»åŠ å‚ç›´çº¿ (x = 11.7å¤„)</span></span></code><code><span leaf="">Â Â <span>annotate</span>(<span>"segment"</span>, x =Â <span>11</span>.<span>7</span>, xend =Â <span>11</span>.<span>7</span>, y =Â <span>0</span>, yend =Â <span>4</span>, linewidth =Â <span>0</span>.<span>3</span>) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®å¡«å……é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_fill_manual</span>(values = my_color) +</span></code><code><span leaf="">Â Â <span># è®¾ç½®è¾¹æ¡†é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>scale_color_manual</span>(values = my_color1) +</span></code><code><span leaf="">Â Â <span># æåæ ‡å˜æ¢</span></span></code><code><span leaf="">Â Â <span>coord_radial</span>(start = -pi/<span>2</span>, Â  Â  Â  Â  Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>end</span>Â = pi/<span>2</span>, Â  Â  Â  Â  Â  Â  #</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>r</span>.axis.inside = TRUE, Â  #Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>inner</span>.radius =Â <span>0</span>.<span>1</span>, Â  Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>rotate</span>.angle = TRUE, Â  Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â <span>clip</span>Â =Â <span>"off"</span>) + Â  Â  Â  Â </span></code><code><span leaf="">Â Â <span># æ·»åŠ å¾„å‘æ ‡ç­¾ï¼Œå¹¶è®¾ç½®æ–‡æœ¬é¢œè‰²</span></span></code><code><span leaf="">Â Â <span>geom_text</span>(data = distinct(data, group), Â Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>aes</span>(x = group, y =Â <span>4</span>, label = group, color = group),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>angle</span>Â =Â <span>90</span>, hjust = -<span>0</span>.<span>05</span>, size =Â <span>3</span>.<span>5</span>, fontface =Â <span>"bold"</span>) + Â  # æ–‡æœ¬æ–¹å‘æ˜¯å‚ç›´</span></code><code><span leaf="">Â Â <span># æ·»åŠ å‡å€¼æ ‡ç­¾</span></span></code><code><span leaf="">Â Â <span>geom_text</span>(data = distinct(data, group, mean, max), Â </span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>aes</span>(x = group, y = log10(max)+<span>0</span>.<span>2</span>, label = sprintf(<span>"%.1f"</span>, mean)),</span></code><code><span leaf="">Â  Â  Â  Â  Â  Â Â <span>hjust</span>Â =Â <span>0</span>.<span>5</span>, vjust =Â <span>0</span>.<span>5</span>, size =Â <span>3</span>.<span>5</span>) +</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># è®¾ç½®ä¸»é¢˜</span></span></code><code><span leaf="">Â Â <span>theme_minimal</span>() +</span></code><code><span leaf="">Â Â <span>theme</span>(axis.title = element_blank(), Â # ä¸æ˜¾ç¤ºXå’ŒYåæ ‡è½´æ ‡é¢˜</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.line = element_line(color =Â <span>"black"</span>, linewidth =Â <span>0</span>.<span>3</span>), Â # è®¾ç½®åæ ‡è½´çº¿æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.ticks = element_line(color =Â <span>"black"</span>), Â  # è®¾ç½®åˆ»åº¦çº¿é¢œè‰²</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.x = element_blank(), Â  Â  Â  Â  Â  Â  Â  Â # éšè—xè½´(è§’åº¦è½´)æ ‡ç­¾ï¼Œå› ä¸ºå‰é¢è‡ªå®šä¹‰å·²ç»æ·»åŠ äº†</span></code><code><span leaf="">Â  Â  Â  Â Â <span>axis</span>.text.y = element_text(size =Â <span>12</span>, color =Â <span>"black"</span>), Â # è®¾ç½®yè½´(åŠå¾„è½´)æ ‡ç­¾æ ·å¼</span></code><code><span leaf="">Â  Â  Â  Â Â <span>panel</span>.grid = element_line(linewidth =Â <span>0</span>.<span>3</span>), Â  Â  Â  Â # è®¾ç½®ç½‘æ ¼çº¿ç²—ç»†</span></code><code><span leaf="">Â  Â  Â  Â Â <span>legend</span>.position =Â <span>"none"</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ä¸æ˜¾ç¤ºå›¾ä¾‹</span></code><code><span leaf="">Â  Â  Â  Â Â <span>plot</span>.margin = margin(<span>10</span>,Â <span>60</span>,Â <span>0</span>,Â <span>60</span>)) Â  Â  Â  Â  Â # å››å‘¨è¾¹è·ï¼šä¸Š/å³/ä¸‹/å·¦ Â Â </span></code></pre></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8icicLMOE6QnMkhdSEPZMCGncciakldECiaXQS0RYxfcx1OwD5jONbnfx9Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.65" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100001486" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic8icicLMOE6QnMkhdSEPZMCGncciakldECiaXQS0RYxfcx1OwD5jONbnfx9Q/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">æ›´å¤šç®±çº¿å›¾æ¡ˆä¾‹ï¼š</span></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247484110&amp;idx=1&amp;sn=e5693a88d7d1422da0143d1b90a8fdce&amp;scene=21#wechat_redirect" textvalue='å¤ç°ä¸€å¼ "ä¸ä¸€æ ·"çš„å°æç´å›¾ï¼Œè¢«ç‚«åˆ°äº†ï¼' data-itemshowtype="0" linktype="text" data-linktype="2">å¤ç°ä¸€å¼ "ä¸ä¸€æ ·"çš„å°æç´å›¾ï¼Œè¢«ç‚«åˆ°äº†ï¼</a></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic87RdEX4Au7FB5urI6czS0EpbxgHU58OysVbeg5amJwQQfmWLXmEWd7g/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5620814013395157" data-type="png" data-w="1941" data-imgfileid="100001490" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic87RdEX4Au7FB5urI6czS0EpbxgHU58OysVbeg5amJwQQfmWLXmEWd7g/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic83pibw8ZThjiaccEStpDiccdAp6MuKtGk88t2oaiaRUyibic6bEYCndIJm75Q/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.562037037037037" data-type="png" data-w="1080" data-imgfileid="100001491" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKLCIr6mwrSunP9fs1pmTzic83pibw8ZThjiaccEStpDiccdAp6MuKtGk88t2oaiaRUyibic6bEYCndIJm75Q/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><span textstyle="">è·å–ä»¥ RProject å½¢å¼ä¿å­˜çš„</span></span><strong><span leaf=""><span textstyle="">ç»˜å›¾ä»£ç +æ³¨é‡Š+æ•°æ®æ¨¡æ¿</span></span></strong><span leaf=""><span textstyle="">ï¼Œåå°å›å¤å…³é”®è¯:Â </span></span><em><span leaf=""><span textstyle="">250724_boxplots</span></span></em></p></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="eb64b4c7-a246-498f-af10-9c12e7063e5e" data-pid="101_14835066"></mp-common-cpsad></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="eb64b4c7-a246-498f-af10-9c12e7063e5e" data-pid="101_14324026"></mp-common-cpsad></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/cPBBUA1QLryNnMS554uCqw",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
