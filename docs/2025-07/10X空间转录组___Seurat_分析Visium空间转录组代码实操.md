---
title: "10X空间转录组 | Seurat 分析Visium空间转录组代码实操"
date: 2025-07-06T14:42:57Z
draft: ["false"]
tags: [
  "fetched",
  "生信兔子"
]
categories: ["Acdemic"]
---
10X空间转录组 | Seurat 分析Visium空间转录组代码实操 by 生信兔子
------
<div><h1 data-pm-slice="0 0 []"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUyMzk3ODY5Nw==&amp;mid=2247485662&amp;idx=1&amp;sn=bd957ad0a8d03c704c1831dc4b08c969&amp;chksm=fa351a78cd42936e315550ab74e5b13328291648f9ee7f5671453c44920acdebdde4722e640d&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">免费获取英文文献SCI，中文文献，加文献互助群</a></span></h1><h1 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">为什么要做空间转录组呢？</span></span></h1><h1 data-pm-slice="0 0 []"><span leaf="">我们从下图案例中就可直观感受到。如果使用单细胞测序，A和B两个样本可能分析出来的细胞亚群是一样的，但事实上，A病人的预后效果就比B病人好，因为他的淋巴细胞使均匀地浸润在组织中，而B病人的淋巴细胞被肿瘤阻挡在外面。空间转录组测序就能很好地解释这一预后差异。</span></h1><h1 data-pm-slice="0 0 []"><span leaf="">Seurat 对空间转录组Visium的结果分析中实现的功能：</span></h1><ul><li><section><span leaf="">归一化</span></section></li><li><section><span leaf="">降维和聚类</span></section></li><li><section><span leaf="">检测空间可变特征(spatially-variable features)</span></section></li><li><section><span leaf="">互动式的可视化</span></section></li><li><section><span leaf="">与单细胞RNA-seq数据整合</span></section></li><li><section><span leaf="">处理多个切片</span></section></li></ul><section><span leaf=""><span textstyle="">1. 安装Seurat</span></span></section><section><ul><li><li><li></ul><pre data-lang="ruby"><code><span leaf=""><span>#install.packages("devtools")</span></span></code><code><span leaf="">devtools::install_github(<span>"satijalab/seurat"</span>, ref = <span>"spatial"</span>)</span></code><code><span leaf="">devtools::install_github(<span>'satijalab/seurat-data'</span>)</span></code></pre></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>#加载包：</span></span></code><code><span leaf=""><span>library</span>(Seurat)</span></code><code><span leaf=""><span>library</span>(SeuratData)</span></code><code><span leaf=""><span>library</span>(ggplot2)</span></code><code><span leaf=""><span>library</span>(cowplot)</span></code><code><span leaf=""><span>library</span>(dplyr)</span></code></pre></section><section><span data-pm-slice="0 0 []"><span leaf=""><span textstyle="">我们拿到的是10 X Space Ranger的输出结果：</span></span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span leaf="">├── analysis</span></code><code><span leaf="">│<span>??</span> ├── clustering</span></code><code><span leaf="">│<span>??</span> ├── diffexp</span></code><code><span leaf="">│<span>??</span> ├── pca</span></code><code><span leaf="">│<span>??</span> ├── tsne</span></code><code><span leaf="">│<span>??</span> └── umap</span></code><code><span leaf="">├── cloupe.cloupe</span></code><code><span leaf="">├── filtered_feature_bc_matrix</span></code><code><span leaf="">│<span>??</span> ├── barcodes.tsv.gz</span></code><code><span leaf="">│<span>??</span> ├── features.tsv.gz</span></code><code><span leaf="">│<span>??</span> └── matrix.mtx.gz</span></code><code><span leaf="">├── filtered_feature_bc_matrix.h5</span></code><code><span leaf="">├── metrics_summary.csv</span></code><code><span leaf="">├── molecule_info.h5</span></code><code><span leaf="">├── possorted_genome_bam.bam</span></code><code><span leaf="">├── possorted_genome_bam.bam.bai</span></code><code><span leaf="">├── raw_feature_bc_matrix</span></code><code><span leaf="">│<span>??</span> ├── barcodes.tsv.gz</span></code><code><span leaf="">│<span>??</span> ├── features.tsv.gz</span></code><code><span leaf="">│<span>??</span> └── matrix.mtx.gz</span></code><code><span leaf="">├── raw_feature_bc_matrix.h5</span></code><code><span leaf="">├── spatial  <span># 空间信息全在这 :这些文件是用户提供的原始全分辨率brightfield图像的下采样版本。</span></span></code><code><span leaf="">下采样是通过box滤波实现的，它对全分辨率图像中像素块的<span>RGB</span>值进行平均，得到下采样图像中一个像素点的<span>RGB</span>值。</span></code><code><span leaf="">│<span>??</span> ├── aligned_fiducials.jpg   这个图像的尺寸是tissue_hires_image.png。由基准对齐算法发现的基准点用红色高亮显示。此文件对于验证基准对齐是否成功非常有用。</span></code><code><span leaf="">│<span>??</span> ├── detected_tissue_image.jpg</span></code><code><span leaf="">│<span>??</span> ├── scalefactors_json.json</span></code><code><span leaf="">│<span>??</span> ├── tissue_hires_image.png 图像的最大尺寸为<span>2</span>,<span>000</span>像素 </span></code><code><span leaf="">│<span>??</span> ├── tissue_lowres_image.png 图像的最大尺寸为<span>600</span>像素。</span></code><code><span leaf="">│<span>??</span> └── tissue_positions_list.csv</span></code><code><span leaf="">└── web_summary.html</span></code></pre></section><section><span leaf=""><span textstyle="">2. 读取数据：</span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span leaf="">setwd(<span>"H:\\singlecell\\spaceranger\\V1_Mouse_Brain_Sagittal_Anterio/"</span>)</span></code><code><span leaf="">  <span># Load the expression data</span></span></code><code><span leaf="">  expr.url &lt;- <span>'H:\\singlecell\\spaceranger\\V1_Mouse_Brain_Sagittal_Anterio/V1_Mouse_Brain_Sagittal_Anterior_filtered_feature_bc_matrix.h5'</span></span></code><code><span leaf="">  expr.data &lt;- <span>Seurat</span><span>::Read10X_h5</span>(filename =  expr.url )</span></code><code><span leaf="">  anterior1 &lt;- <span>Seurat</span><span>::CreateSeuratObject</span>(counts = expr.data, project = <span>'anterior1'</span>, assay = <span>'Spatial'</span>)</span></code><code><span leaf="">  anterior1<span>$slice</span> &lt;- <span>1</span></span></code><code><span leaf="">  anterior1<span>$region</span> &lt;- <span>'anterior'</span></span></code><code><span leaf="">  <span># Load the image data</span></span></code><code><span leaf="">  img.url &lt;- <span>'H:\\singlecell\\spaceranger\\V1_Mouse_Brain_Sagittal_Anterio/V1_Mouse_Brain_Sagittal_Anterior_spatial.tar.gz'</span></span></code><code><span leaf="">  untar(tarfile =  img.url)</span></code><code><span leaf="">  img &lt;- <span>Seurat</span><span>::Read10X_Image</span>(image.dir = <span>'H:\\singlecell\\spaceranger\\V1_Mouse_Brain_Sagittal_Anterio/spatial'</span>)</span></code><code><span leaf="">  <span>Seurat</span><span>::DefaultAssay</span>(object = img) &lt;- <span>'Spatial'</span></span></code><code><span leaf="">  img &lt;- img[colnames(x = anterior1)]</span></code><code><span leaf="">  anterior1[[<span>'image'</span>]] &lt;- img</span></code><code><span leaf="">  anterior1</span></code><code><span leaf=""><span>An</span> object of <span>class</span> <span>Seurat</span> </span></code><code><span leaf=""><span>31053</span> features across <span>2696</span> samples within <span>1</span> assay </span></code><code><span leaf=""><span>Active</span> <span>assay:</span> <span>Spatial</span> (<span>31053</span> features)</span></code><code><span leaf="">}</span></code></pre></section><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">在Seurat对象中，spot by基因表达矩阵与典型的“RNA”分析类似，但包含spot水平，而不是单细胞水平的数据。图像本身存储在Seurat对象中的一个images 槽（slot ）中。图像槽还存储必要的信息，以将斑点与其在组织图像上的物理位置相关联。</span></span></p><section nodeleaf=""><img data-imgfileid="100012366" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYoKySOwYUHAicFWKwDqv441tal7tnibria8icLuWQHdcLkMNTYCb6WvCKWw/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYoKySOwYUHAicFWKwDqv441tal7tnibria8icLuWQHdcLkMNTYCb6WvCKWw/640?wx_fmt=png&amp;from=appmsg"></section><h6 data-pm-slice="0 0 []"><span leaf=""><span textstyle="">3. 数据预处理</span></span></h6><p><span leaf="">在spot中基因表达数据进行初始的预处理步骤与典型的scRNA-seq相似。我们首先需要对数据进行规范化，以考虑数据点之间测序深度的差异。</span></p><p data-pm-slice="0 0 []"><span data-pm-slice="0 0 []"><span leaf="">计算一下所有细胞的counts分布情况，发现counts差距比较大，因此需要normalize</span></span></p><section><ul><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>plot1</span> &lt;- VlnPlot(brain, features = <span>"nCount_Spatial"</span>, pt.size = <span>0</span>.<span>1</span>) + NoLegend()</span></code><code><span leaf=""><span>plot2</span> &lt;- SpatialFeaturePlot(brain, features = <span>"nCount_Spatial"</span>) + theme(legend.position = <span>"right"</span>)</span></code><code><span leaf=""><span>plot_grid</span>(plot1, plot2)</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012378" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYYbhc9LWicFzklW20R84icSvomPHrbbugPq9If0DThpV2N2TaiaBMtCcow/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYYbhc9LWicFzklW20R84icSvomPHrbbugPq9If0DThpV2N2TaiaBMtCcow/640?wx_fmt=png&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">作为一种替代方法，我们推荐使用sctransform (Hafemeister和Satija，已出版)，它构建了基因表达的正则化负二项模型，以便在保留生物差异的同时考虑技术因素。sctransform将数据归一化，检测高方差特征，并将数据存储在SCT分析中。</span></span></p><section><ul><li></ul><pre data-lang="php"><code><span leaf="">brain &lt;- <span>SCTransform</span>(brain, assay = <span>"Spatial"</span>, <span>return</span>.only.<span>var</span>.genes = <span>FALSE</span>, verbose = <span>FALSE</span>)</span></code></pre></section><section><span data-pm-slice="0 0 []"><span leaf="">为了进行比较，我们首先重新运行</span></span><code><span leaf="">sctransform</span></code><span><span leaf="">以存储所有基因的值，然后通过</span></span><code><span leaf="">NormalizeData</span></code><span><span leaf="">进行 log-normalization 过程。</span></span></section><section><ul><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span># 重新运行归一化以存储所有基因的基因变换残差</span></span></code><code><span leaf="">brain &lt;- <span>SCTransform</span>(brain, assay = <span>"Spatial"</span>, <span>return</span>.only.<span>var</span>.genes = <span>FALSE</span>, verbose = <span>FALSE</span>)</span></code><code><span leaf=""><span># 还要运行标准日志规范化以进行比较</span></span></code><code><span leaf="">brain &lt;- <span>NormalizeData</span>(brain, verbose = <span>FALSE</span>, assay = <span>"Spatial"</span>) <span>#这步有些慢</span></span></code></pre></section><p><span leaf="">计算日志归一化数据和sctransform残差与umi数的相关性</span></p><section><ul><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>brain</span> &lt;- GroupCorrelation(brain, group.assay = <span>"Spatial"</span>, assay = <span>"Spatial"</span>, slot = <span>"data"</span>, do.plot = FALSE)</span></code><code><span leaf=""><span>brain</span> &lt;- GroupCorrelation(brain, group.assay = <span>"Spatial"</span>, assay = <span>"SCT"</span>, slot = <span>"scale.data"</span>, do.plot = FALSE)</span></code><code><span leaf=""><span>p1</span> &lt;- GroupCorrelationPlot(brain, assay = <span>"Spatial"</span>, cor = <span>"nCount_Spatial_cor"</span>) + ggtitle(<span>"Log Normalization"</span>) + </span></code><code><span leaf="">    <span>theme</span>(plot.title = element_text(hjust = <span>0</span>.<span>5</span>))</span></code><code><span leaf=""><span>p2</span> &lt;- GroupCorrelationPlot(brain, assay = <span>"SCT"</span>, cor = <span>"nCount_Spatial_cor"</span>) + ggtitle(<span>"SCTransform Normalization"</span>) + </span></code><code><span leaf="">    <span>theme</span>(plot.title = element_text(hjust = <span>0</span>.<span>5</span>))</span></code><code><span leaf=""><span>plot_grid</span>(p1, p2)</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012369" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPY3UnNDZ8PyEP6ovVY9QajjTX1llNow5DjhFsx6iaOtL5cGMSJWQNjU2g/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPY3UnNDZ8PyEP6ovVY9QajjTX1llNow5DjhFsx6iaOtL5cGMSJWQNjU2g/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">4. 基因表达可视化</span></span></section><p data-pm-slice="0 0 []"><span leaf="">Seurat的</span><code><span leaf="">SpatialFeaturePlot</span></code><span leaf="">函数扩展了</span><code><span leaf="">FeaturePlot</span></code><span leaf="">, 可以将表达数据覆盖在组织组织上。例如，在这个小鼠大脑数据中，Hpca基因是一个强烈的海马区（hippocampal ）marker ，Ttr是一个脉络丛(choroid plexus)marker。</span></p><section><ul><li></ul><pre data-lang="javascript"><code><span leaf=""><span>SpatialFeaturePlot</span>(brain, features = <span>c</span>(<span>"Hpca"</span>, <span>"Ttr"</span>))</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012371" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYSPJDTkSFZjMUa3bZXia6RJZyfcUR4UibiazV9FBcBAZz3eVqTVhw5L1AQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYSPJDTkSFZjMUa3bZXia6RJZyfcUR4UibiazV9FBcBAZz3eVqTVhw5L1AQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span leaf="">Seurat中的默认参数强调分子数据的可视化。但是，您还可以通过更改以下参数来调整斑点的大小（及其透明度），以改善组织学图像的可视化：</span></p><ul><li><code><span leaf="">pt.size.factor</span></code><section><span leaf="">-这将缩放斑点的大小。默认值为1.6</span></section></li><li><code><span leaf="">alpha</span></code><section><span leaf="">-最小和最大透明度。默认值为c（1，1）。</span></section></li><li><section><span leaf="">尝试设置为</span><code><span leaf="">alphac</span></code><span leaf="">（0.1，1），以降低具有较低表达的点的透明度</span></section></li></ul><section><ul><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>p1</span> &lt;- SpatialFeaturePlot(brain, features = <span>"Ttr"</span>, pt.size.factor = <span>1</span>)</span></code><code><span leaf=""><span>p2</span> &lt;- SpatialFeaturePlot(brain, features = <span>"Ttr"</span>, alpha = c(<span>0</span>.<span>1</span>, <span>1</span>))</span></code><code><span leaf=""><span>plot_grid</span>(p1, p2)</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012372" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYap1JvbVBREcWpHkegWuaawB3LlBiceXzqF2ah8UbzwA6YicDnQdcZdAg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYap1JvbVBREcWpHkegWuaawB3LlBiceXzqF2ah8UbzwA6YicDnQdcZdAg/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">5. 降维，聚类和可视化</span></span></section><section><span leaf=""><span textstyle="">然后，我们可以使用与scRNA-seq分析相同的工作流程，对RNA表达数据进行降维和聚类。</span></span></section><section><ul><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>brain</span> &lt;- RunPCA(brain, assay = <span>"SCT"</span>, verbose = FALSE)  #选择SCT归一化的assay</span></code><code><span leaf=""><span>brain</span> &lt;- FindNeighbors(brain, reduction = <span>"pca"</span>, dims = <span>1</span>:<span>30</span>)</span></code><code><span leaf=""><span>brain</span> &lt;- FindClusters(brain, verbose = FALSE)</span></code><code><span leaf=""><span>brain</span> &lt;- RunUMAP(brain, reduction = <span>"pca"</span>, dims = <span>1</span>:<span>30</span>)</span></code></pre></section><section><span data-pm-slice="0 0 []"><span leaf="">再然后，我们可以在UMAP空间(使用</span></span><code><span leaf="">DimPlot</span></code><span><span leaf="">)或使用</span></span><code><span leaf="">SpatialDimPlot</span></code><span><span leaf="">将聚类clustering的结果显示在图像上</span></span></section><section><ul><li><li><li></ul><pre data-lang="objectivec"><code><span leaf="">p1 &lt;- DimPlot(brain, reduction = <span>"umap"</span>, label = <span>TRUE</span>)</span></code><code><span leaf="">p2 &lt;- SpatialDimPlot(brain, label = <span>TRUE</span>, label.size = <span>3</span>)</span></code><code><span leaf="">plot_grid(p1, p2)</span></code></pre></section><section><span leaf=""><img data-imgfileid="100012373" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYhwzs0GVYPHUOQqKm9U4rBsedfpmZJIbU4U5UTvhlQviaOsia7YIs82ow/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYhwzs0GVYPHUOQqKm9U4rBsedfpmZJIbU4U5UTvhlQviaOsia7YIs82ow/640?wx_fmt=png&amp;from=appmsg"></span></section><p data-pm-slice="0 0 []"><span leaf="">由于颜色太多，因此可视化哪个立体像素voxel属于哪个cluster可能是一个挑战。</span><br><span leaf="">解决方案：</span></p><ul><li><section><span leaf="">设置</span><code><span leaf="">label</span></code><span leaf="">参数会在每个cluster的中间处放置一个彩色框（请参见上图），</span></section></li><li><section><span leaf="">而SpatialDimPlot的</span><code><span leaf="">do.hover</span></code><span leaf="">参数允许交互式地查看当前点的标识。</span></section></li></ul><section><ul><li><li></ul><pre data-lang="php"><code><span leaf=""><span># 鼠标框选</span></span></code><code><span leaf=""><span>SpatialDimPlot</span>(brain, <span>do</span>.hover = <span>TRUE</span>)</span></code></pre></section><section><span data-pm-slice="0 0 []"><span leaf="">您还可以在</span></span><code><span leaf="">SpatialDimPlot</span></code><span><span leaf="">上使用</span></span><code><span leaf="">cells.highlight</span></code><span><span leaf="">参数在上划分特定的关注细胞，这对于区分单个cluster的空间定位非常有用。如下所示：</span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>SpatialDimPlot</span>(brain, cells.highlight = CellsByIdentities(object = brain, idents = c(<span>1</span>, <span>2</span>, <span>5</span>, <span>3</span>, </span></code><code><span leaf=""><span>4</span>, <span>8</span>)), facet.highlight = TRUE, ncol = <span>3</span>)</span></code></pre></section><section><span leaf="" data-remoteid="" data-asynid="" data-src="blob:https://mp.weixin.qq.com/233abfcd-6ac9-423f-8997-aaffa296995f" src="" align="" alt="" border="" data-ratio="" data-s="300,640" data-type="webp" data-w="" aria-label="" aria-braillelabel="" aria-description="" height="" hspace="" ismap opacity="" sizes="" title="" type="block" usemap="" vspace="" width="" data-width="" data-height="" data-croporisrc="" data-cropx1="" data-cropx2="" data-cropy1="" data-cropy2="" data-cropselx1="" data-cropselx2="" data-cropsely1="" data-cropsely2="" data-backw="" data-backh="" data-copyright="" data-oversubscription-url="" data-before-oversubscription-url="" data-galleryid="" data-gallerysupplier="" data-cardimg="" data-fileid="" data-imgfileid="" data-positionback="" data-imgqrcoded="1" data-imgid="" data-upload="" data-fromlib="" data-aiimageid="" data-cacheurl="blob:https://mp.weixin.qq.com/233abfcd-6ac9-423f-8997-aaffa296995f" data-retry="1"><br></span></section><section nodeleaf=""><img data-imgfileid="100012375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYa1Fm2t0DjM2iaGibibfVicorhvzJdBqctZbTh5OKLmoLzy31FE84IkWxcQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYa1Fm2t0DjM2iaGibibfVicorhvzJdBqctZbTh5OKLmoLzy31FE84IkWxcQ/640?wx_fmt=png&amp;from=appmsg"></section><section><span leaf=""><span textstyle="">6. 识别空间可变特征</span></span></section><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">Seurat提供了两种工作流程来识别与组织内空间位置相关的分子特征。</span></span></p><ul><li><strong><span leaf=""><span textstyle="">第一种方法</span></span></strong><section><span leaf=""><span textstyle="">，是</span></span><strong><span leaf=""><span textstyle="">基于组织内预先标注</span></span></strong><span leaf=""><span textstyle="">的解剖区域执行差异表达，这可以从无监督聚类或先验知识中确定。在这种情况下，此策略将起作用，因为上面的cluster显示出明显的空间限制。</span></span></section></li></ul><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>de_markers</span> &lt;- FindMarkers(brain, ident.<span>1</span> = <span>0</span>, ident.<span>2</span> = <span>1</span>)</span></code><code><span leaf=""><span>SpatialFeaturePlot</span>(object = brain, features = rownames(de_markers)[<span>1</span>:<span>3</span>], alpha = c(<span>0</span>.<span>1</span>, <span>1</span>), ncol = <span>3</span>)</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012376" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYMsrQtKKHQ7blDTPLF6Rx7A2n7XLA3qsUTcdtsmklAvHcfic0KevoadQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYMsrQtKKHQ7blDTPLF6Rx7A2n7XLA3qsUTcdtsmklAvHcfic0KevoadQ/640?wx_fmt=png&amp;from=appmsg"></section><section><strong data-pm-slice="0 0 []"><span leaf="">第二种方法</span></strong><span><span leaf="">，</span></span><code><span leaf="">FindSpatiallyVariables</span></code><span><span leaf="">在中实施的是在</span></span><strong><span leaf="">没有预先注释的情况</span></strong><span><span leaf="">下搜索展现出空间模式spatial patterning的特征。</span></span></section><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>top</span>.features &lt;- head(SpatiallyVariableFeatures(brain, selection.method = <span>"markvariogram"</span>), <span>6</span>)</span></code><code><span leaf=""><span>SpatialFeaturePlot</span>(brain, features = top.features, ncol = <span>3</span>, alpha = c(<span>0</span>.<span>1</span>, <span>1</span>))</span></code></pre></section><section nodeleaf=""><img data-imgfileid="100012377" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYab0XxBtNaeGVoKdibZTJ41AFibKllicUzRW7fKegueylMZpFkVapN0cCg/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/FEvW4f3QZPr0d0f8DI24ica4KkVCdLcPYab0XxBtNaeGVoKdibZTJ41AFibKllicUzRW7fKegueylMZpFkVapN0cCg/640?wx_fmt=png&amp;from=appmsg"></section><section data-pm-slice="0 0 []"><span><strong><span><span leaf="">以上就是本期的全部内容啦！</span></span></strong></span><strong><span><strong><span leaf="">「欢迎点赞，点在看！」</span></strong></span></strong><span><strong><span><span leaf="">后面会尽快更新哦！分享最新热门文献！制作不易，你的打赏将成为我继续更新的十足动力！</span></span></strong></span></section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="Image" data-ratio="1" data-type="gif" data-w="400" data-imgfileid="100010197" src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="Image" data-ratio="1" data-type="gif" data-w="400" data-imgfileid="100010200" src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="Image" data-ratio="1" data-type="gif" data-w="400" data-imgfileid="100010199" src="https://mmbiz.qpic.cn/mmbiz_gif/FEvW4f3QZPqT9DxXichpMxjqfgIiclEiblUlg2m72q4eWzMOejyhamY0xxwtEU7NNTl4HmWZGKkI3ZhKObOeMO1fQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></span></section></section></section><p><span leaf=""><br></span></p><blockquote><p><span><span leaf="">公众号：生信兔子（+v: shengxintuzi）</span></span><span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUyMzk3ODY5Nw==&amp;mid=2247485662&amp;idx=1&amp;sn=bd957ad0a8d03c704c1831dc4b08c969&amp;chksm=fa351a78cd42936e315550ab74e5b13328291648f9ee7f5671453c44920acdebdde4722e640d&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">免费获取英文文献SCI，中文文献，加文献互助群</a></span></span></span></p></blockquote><p><span leaf="">需要商务合作的请移步私信。</span></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7cJmq6BtPuMxXhxwEE8vmQ",target="_blank" rel="noopener noreferrer">原文链接</a>
