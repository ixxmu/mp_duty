---
title: "python实战：学习生信大牛Sarah A. Teichmann发在Science上的单细胞分析"
date: 2025-07-19T14:03:33Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
python实战：学习生信大牛Sarah A. Teichmann发在Science上的单细胞分析 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><blockquote><p><span leaf="">python也学了一段时间了，现在找一下教程做一些代码训练实战，今天分享的就是来自<span textstyle="">2020年2月21号发表在Science杂志</span>上的一个资源，文献标题为<span textstyle="">《A cell atlas of human thymic development defines T cell repertoire formation》</span>。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">以前也有一篇完整的python版本实战：</span></p><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247507955&amp;idx=1&amp;sn=6268e0602b2678db25a2d9587c7b204e&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|01-文献阅读：致命COVID-19分子单细胞肺图谱</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247507998&amp;idx=1&amp;sn=ac7aee0b9b5f42aaf77bc79b0496477f&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|02-数据介绍与下载</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508067&amp;idx=1&amp;sn=32b6eb2f8b053b4046fc3a83ce15b7b8&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|03-多样本整合分析</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508108&amp;idx=1&amp;sn=3131f1fdb24e893e622c2eb0588d1520&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|04-绘制单细胞文献Figure 1</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508161&amp;idx=1&amp;sn=a9d2de49e4b489f849e6c088a5f061f4&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|05-绘制单细胞差异分析热图</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247508185&amp;idx=1&amp;sn=8f390f47fb7142beced128754e8cc40e&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">Python图文复现2022|06-单细胞功能富集分析</a></span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">在这篇Science杂志的文献中，作者利用单细胞RNA测序技术，<span textstyle="">创建了一个涵盖一生的人类胸腺的全面图谱，并为人类T细胞发育提供了新的见解</span>：包括CD8αα⁺ T细胞、成纤维细胞亚型和激活的树突状细胞，并发现TCR重排和选择存在偏向性，与基因组位置和谱系承诺动力学相关。这些发现为理解人类T细胞发育提供了新的视角和全面的胸腺图谱。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHfVnmshYueC7f3fE5VqeqrsrMk6JaBlyTgFbxKYcAuQOLes3WBxjnKA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5120370370370371" data-type="png" data-w="1080" data-imgfileid="100060472" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHfVnmshYueC7f3fE5VqeqrsrMk6JaBlyTgFbxKYcAuQOLes3WBxjnKA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">这篇文献的通讯作者Sarah A. Teichmann也是生信届的大牛，介绍见：<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU1MjE5MTQwMA==&amp;mid=2247487780&amp;idx=1&amp;sn=fc5a44329377bb09cec0eaa8d252a8b2&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">【生信进阶之路】盘点生物信息大牛课题组 EP16：Sarah A. Teichmann</a></span></p><blockquote><p><span leaf=""><span textstyle="">Sarah教授是人类细胞图谱（the Human Cell Atlas，HCA）国际联盟的联合创始人和主要负责人。</span></span></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">人类胸腺单细胞图谱</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">本研究对15个胎儿胸腺样本（胎龄7-17孕周）和9个出生后样本进行了单细胞RNA测序。</span>通过基于CD45、CD3或EpCAM的细胞分选，研究者分析了胸腺细胞和非胸腺细胞的转录组，并结合了T细胞受体αβ（TCRαβ）分析。经过质量控制后，<span textstyle="">共获得255,901个细胞数据。</span>研究还对同一供体的其他相关器官进行了分析，并使用BBKNN算法结合线性回归进行了批次校正，以确保数据的准确性和可比性。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzH7ibFASS4FBLefLjIHUKnlib05iaUT1BDTxoQBFtMvK7BCANxcD6hI5ibcw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.1925925925925926" data-type="png" data-w="1080" data-imgfileid="100060470" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzH7ibFASS4FBLefLjIHUKnlib05iaUT1BDTxoQBFtMvK7BCANxcD6hI5ibcw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">图谱：</span></p><p data-tool="mdnice编辑器"><span leaf="">人类胸腺细胞组成的UMAP可视化，按细胞类型着色（DN，双阴性T细胞；DP，双阳性T细胞；ETP，早期胸腺祖细胞；aDC，激活的树突状细胞；pDC，浆细胞样树突状细胞；Mono，单核细胞；Mac，巨噬细胞；Mgk，巨核细胞；Endo，内皮细胞；VSMC，血管平滑肌细胞；Fb，成纤维细胞；Ery，红细胞）。</span></p><p data-tool="mdnice编辑器"><span leaf="">(E) 胸腺基质细胞类型中标志基因表达的点图。</span></p><p data-tool="mdnice编辑器"><span leaf="">(G) 不同年龄组中细胞类型的相对比例。</span></p><p data-tool="mdnice编辑器"><span leaf="">数据集还涵盖了构成胸腺微环境的多种非免疫细胞类型。进一步将它们分类为亚型，包括胸腺上皮细胞（TECs）、成纤维细胞、血管平滑肌细胞（VSMCs）、内皮细胞和淋巴内皮细胞（图1E）。</span></p><p data-tool="mdnice编辑器"><span leaf="">胸腺成纤维细胞被进一步划分为两个之前未被描述过的亚型：</span></p><ul><li><section><span leaf="">成纤维细胞1型（Fb1）细胞（标志基因COLEC11、C7、GDF10），Fb1细胞独特地表达COLEC11，该基因在先天免疫中发挥重要作用（27），以及ALDH1A2，这是一种负责产生调节上皮细胞生长的视黄酸的酶（28）。</span></section></li><li><section><span leaf="">成纤维细胞2型（Fb2）细胞（标志基因PI16、FN1、FBN1）（图1E）。相比之下，调节血管发育的细胞外基质（ECM）基因和sema基因则特异性地在Fb2中被检测到（图S3A）。</span></section></li><li><section><span leaf="">smFISH显示，Fb1细胞位于小叶周围（perilobular），而Fb2细胞则位于小叶之间（interlobular），并且常常与由VSMCs衬里的大血管相关联，这与其转录组中调节血管发育的基因特征一致。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHc2HsNOI8FDtRNLicYuJCKibXJ5J0V0suicgLga2DwgFbV7R03TqznAN1w/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.8287037037037037" data-type="jpeg" data-w="1080" data-imgfileid="100060471" src="https://mmbiz.qpic.cn/mmbiz_jpg/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHc2HsNOI8FDtRNLicYuJCKibXJ5J0V0suicgLga2DwgFbV7R03TqznAN1w/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">数据下载与简单探索</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">数据可以在这里下载：</span></p><p data-tool="mdnice编辑器"><span leaf="">格式为h5ad：https://developmental.cellatlas.io/thymus-development</span></p><p data-tool="mdnice编辑器"><span leaf="">其他地方：ArrayExpress (accession number E-MTAB-8581)</span></p><p data-tool="mdnice编辑器"><span leaf="">分析代码：Zenodo repository (DOI: 10.5281/zenodo.3572422)，<span textstyle="">以这里为主，数据和代码都有，看清楚有好几个版本，下载最新的那个版本</span></span></p><p data-tool="mdnice编辑器"><span leaf="">代码在这里也可以下载到：https://github.com/Teichlab/thymusatlas</span></p><p data-tool="mdnice编辑器"><span leaf="">数据下载比较麻烦一点，我这里还折腾了一下，可以加我微信发给你：Biotree123，下载下来的数据：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">HTA08_v01_A05_Science_human_epi.h5ad</span><span leaf=""><br></span><span leaf="">HTA08_v01_A05_Science_human_fig1.h5ad</span><span leaf=""><br></span><span leaf="">HTA08_v01_A05_Science_human_hsc.h5ad</span><span leaf=""><br></span><span leaf="">HTA08_v01_A06_Science_human_tcells.h5ad</span><span leaf=""><br></span><span leaf="">HTA08_v02_A04_Science_mouse_stromal.h5ad</span><span leaf=""><br></span><span leaf="">HTA08_v02_A04_Science_mouse_total.h5ad</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">数据分析中作者开发了一个包，在这里可以找到：https://github.com/jepark87/scjp</span></p><p data-tool="mdnice编辑器"><span leaf="">数据对应情况：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">fig1_data = </span><span><span leaf="">'HTA08.v01.A05.Science_human_fig1.h5ad'</span></span><span leaf=""><br></span><span leaf="">hsc_data = </span><span><span leaf="">'HTA08.v01.A05.Science_human_hsc.h5ad'</span></span><span leaf=""><br></span><span leaf="">tcell_data = </span><span><span leaf="">'HTA08.v01.A06.Science_human_tcells.h5ad'</span></span><span leaf=""><br></span><span leaf="">human_epi_data = </span><span><span leaf="">'HTA08.v01.A05.Science_human_epi.h5ad'</span></span><span leaf=""><br></span><span leaf="">mouse_stromal_data = </span><span><span leaf="">'HTA08.v02.A04.Science_mouse_stromal.h5ad'</span></span><span leaf=""><br></span><span leaf="">mouse_total_data = </span><span><span leaf="">'HTA08.v02.A04.Science_mouse_total.h5ad'</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">读取</span><strong><span leaf="">Load thymus data (corresponds to Fig 1C)</span></strong><span leaf=""> 进来看一下：</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">#import scanpy.api as sc</span></span><span leaf=""><br></span><span><span leaf="">import</span></span><span leaf=""> scanpy </span><span><span leaf="">as</span></span><span leaf=""> sc</span><span leaf=""><br></span><span leaf="">sc.settings.verbosity = </span><span><span leaf="">3</span></span><span leaf=""><br></span><span leaf="">sc.settings.set_figure_params(dpi=</span><span><span leaf="">100</span></span><span leaf="">, color_map=</span><span><span leaf="">'OrRd'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">sc.logging.print_version_and_date()</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 读取数据</span></span><span leaf=""><br></span><span leaf="">fig1 = sc.read(</span><span><span leaf="">'HTA08.v01.A05.Science_human_fig1.h5ad'</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">fig1</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHSZzvu4gic4XQricJNnMiavKd88qAERQLrBpia9LyurKzKtfic0qicjCgdOFw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.0712962962962963" data-type="png" data-w="1080" data-imgfileid="100060469" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHSZzvu4gic4XQricJNnMiavKd88qAERQLrBpia9LyurKzKtfic0qicjCgdOFw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">样本相关的表型信息：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">fig1.obs.head()</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHltldPgbhA2XWQTVibXmUVuNs2w0auYJ0xb2cq0NLokvVuXVReSxMjBQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.2490740740740741" data-type="png" data-w="1080" data-imgfileid="100060468" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHltldPgbhA2XWQTVibXmUVuNs2w0auYJ0xb2cq0NLokvVuXVReSxMjBQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">可视化fig1c的注释结果：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">sc.pl.umap(fig1,color = </span><span><span leaf="">'Anno_level_fig1'</span></span><span leaf="">.split(</span><span><span leaf="">','</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHk2I5YsZD8Emq7wWKSEywAEUq2PHXkVBPfCxV1Cx7QRmGbL22YsY8Cw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5194444444444445" data-type="png" data-w="1080" data-imgfileid="100060477" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHk2I5YsZD8Emq7wWKSEywAEUq2PHXkVBPfCxV1Cx7QRmGbL22YsY8Cw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">按照年龄分组上色：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">sc.pl.umap(fig1,color = </span><span><span leaf="">'Age'</span></span><span leaf="">.split(</span><span><span leaf="">','</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHvoOEkeric6qlLQee225eqkCiaJFnNDCPqem2lzKwcJhfjJdBVCo7xz1A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7035984848484849" data-type="png" data-w="1056" data-imgfileid="100060476" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzHvoOEkeric6qlLQee225eqkCiaJFnNDCPqem2lzKwcJhfjJdBVCo7xz1A/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">按照marker分选上色：</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">sc.pl.umap(fig1,color = </span><span><span leaf="">'sort'</span></span><span leaf="">.split(</span><span><span leaf="">','</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzH3f73l3S67AdGUcwXnt0RfdBe1jS4icqUpa3J0nOztQqINmk7XhCBhyw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8111353711790393" data-type="png" data-w="916" data-imgfileid="100060475" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wzhQu0LkTB3AwlyLMhUiaOzH3f73l3S67AdGUcwXnt0RfdBe1jS4icqUpa3J0nOztQqINmk7XhCBhyw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">今天分享到这，去试试看~</span></p></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课7月班</span></a><span textstyle="">，你的生物信息学入门课</span></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=1679199708449144836&amp;scene=173&amp;subscene=207&amp;sessionid=1745492310&amp;enterid=1745492314&amp;from_msgid=2247541298&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信故事会" data-itemshowtype="0" linktype="text" data-linktype="2">生信故事会</a>，来看看他们的生信入门故事</span></section></li><li><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxMDkxODM1Ng==&amp;action=getalbum&amp;album_id=3690970204957147140&amp;scene=173&amp;subscene=207&amp;sessionid=1745066271&amp;enterid=1745066274&amp;from_msgid=2247540702&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue="生信马拉松答疑专辑" data-itemshowtype="0" linktype="text" data-linktype="2">生信马拉松答疑专辑</a>，获取你的生信专属答疑</span></section></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/PbZ7jiJXYQWtCVIkv6CFvA",target="_blank" rel="noopener noreferrer">原文链接</a>
