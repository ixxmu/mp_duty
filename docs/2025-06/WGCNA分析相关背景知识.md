---
title: "WGCNA分析相关背景知识"
date: 2025-06-16T01:26:47Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
WGCNA分析相关背景知识 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">虽然该学习多样品数据整合分析了，但是呢不按流程学的小谢决定先学WGCNA。反正蛋白互作网络都学完了，倒序学一下也不是不可以！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010863" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RqqcGCdI1jvHdOQQRjjaWAD31FhgyFVcOMX5uibb8pKnnKvvyicNSfLhg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RqqcGCdI1jvHdOQQRjjaWAD31FhgyFVcOMX5uibb8pKnnKvvyicNSfLhg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">所以这一期我们就来一起学习一下WGCNA相关的背景知识叭，参考的内容有WGCNA文献以及Kimi老师！</span></strong></p><blockquote><span></span><p><strong><span leaf="">小说明：因为还没结合代码理解，所以可能有些理解的不够透彻，如有不足还请大家指正与补充.</span></strong></p></blockquote><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010862" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RvAVysounJr7HA5uibo56P77rEAre4O1rqewox6kzcxia717vzpNbxqRA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RvAVysounJr7HA5uibo56P77rEAre4O1rqewox6kzcxia717vzpNbxqRA/640?wx_fmt=png&amp;from=appmsg"></span></figure><blockquote><span></span><p><strong><span leaf="">参考文献：《WGCNA: an R package for weighted correlation network analysis》——https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-559.</span></strong><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="22px" height="22px" viewbox="0 0 32 32" enable-background="new 0 0 32 32"><image width="32" height="32" x="0" y="0"></image></svg></p></blockquote><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">WGCNA功能简介</span></span><span></span></h2><blockquote><span></span><p><strong><span leaf="">WGCNA（加权基因共表达网络分析）的原理基于基因共表达网络的构建和模块化分析。它通过分析基因之间的表达相关性，将基因聚类为模块（module），并进一步研究这些模块与样本性状之间的关系。</span></strong></p><p><span leaf="">可以用于识别高度相关的基因簇（模块）、总结模块特征、关联模块与外部样本性状、计算模块成员资格等。</span></p></blockquote><ul><li><section><p><strong><span leaf="">WGCNA的主要功能：</span></strong></p></section></li><ul><li><section><span leaf="">识别高度相关的基因簇（模块）。</span></section></li><li><section><span leaf="">使用模块特征基因（Module Eigengene）或模块内的中心基因（Hub Gene）来总结这些模块。</span></section></li><li><section><span leaf="">分析模块之间的关系以及模块与外部样本性状（如疾病状态、生理指标等）的关系。</span></section></li><li><section><span leaf="">计算模块成员资格，识别与特定模块相关的基因。</span></section></li><li><section><span leaf="">通过网络分析筛选候选生物标志物或治疗靶点。</span></section></li></ul><li><section><p><strong><span leaf="">WGCNA的核心优势：</span></strong></p></section></li></ul><ol><li><section><strong><span leaf="">无监督分析</span></strong><span leaf="">：不需要预先定义基因的功能或类别，完全基于基因表达数据的内在结构进行分析。</span></section></li><li><section><strong><span leaf="">模块化分析</span></strong><span leaf="">：能够将基因聚类为模块，简化复杂基因表达数据的分析。</span></section></li><li><section><strong><span leaf="">性状关联分析</span></strong><span leaf="">：可以识别与特定性状相关的基因模块，为生物学研究提供重要的线索。</span></section></li></ol><li><section><p><strong><span leaf="">WGCNA实现方法：</span></strong></p></section></li><ul><li><section><strong><span leaf="">WGCNA R包</span></strong><span leaf="">：提供了一系列R函数，用于执行加权相关网络分析的各个方面，包括网络构建、模块检测、基因选择、拓扑属性计算、数据模拟、可视化和与其他软件的接口。</span></section></li><li><section><strong><span leaf="">功能分类</span></strong><span leaf="">：软件包中的函数分为网络构建、模块检测、模块和基因选择、拓扑属性计算、数据模拟、可视化和与其他软件包的接口等类别。</span></section></li><li><section><strong><span leaf="">模块检测方法</span></strong><span leaf="">：提供了多种模块检测方法，包括层次聚类和动态树剪枝方法。</span></section></li><li><section><strong><span leaf="">网络可视化</span></strong><span leaf="">：提供了多种可视化工具，如网络热图、多维缩放图和模块特征基因的层次聚类图。</span></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">主要分析流程</span></span><span></span></h4><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010866" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RRw7ugmOqIdUqAbk7UYwjyz1OrLKQibrzfsRZK2IHgHIILBOFLIEKlSg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RRw7ugmOqIdUqAbk7UYwjyz1OrLKQibrzfsRZK2IHgHIILBOFLIEKlSg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">1. 基因共表达网络的构建</span></span><span></span></h3><ul><li><section><strong><span leaf="">计算基因对的相关性</span></strong><span leaf="">：首先计算基因表达矩阵中每对基因之间的表达相关性（通常使用皮尔逊相关系数）。</span></section></li><li><section><strong><span leaf="">加权相关性</span></strong><span leaf="">：为了强调强相关性并减少弱相关性的影响，WGCNA引入了一个加权参数（软阈值）(β)，将相关性转换为加权相关性：选择合适的 (β) 值可以使网络接近无标度网络（scale-free network），即网络中少数节点（基因）具有大量连接，而大多数节点连接较少。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">2. 模块的识别</span></span><span></span></h3><ul><li><section><strong><span leaf="">模块定义</span></strong><span leaf="">：在加权共表达网络中，模块是一组基因，这些基因在基因表达模式上高度相关，且与其他模块的基因相关性较低。</span></section></li><li><section><strong><span leaf="">层次聚类和动态剪枝</span></strong><span leaf="">：WGCNA使用层次聚类（hierarchical clustering）方法对基因进行聚类，并通过动态剪枝（dynamic tree cutting）算法将基因划分为不同的模块。每个模块用一种颜色表示，模块内的基因具有相似的表达模式。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">3. 模块与性状的关联分析</span></span><span></span></h3><ul><li><section><strong><span leaf="">模块性状相关性</span></strong><span leaf="">：计算每个模块与样本性状之间的相关性。通常使用模块特征基因（Module Eigengene，ME）来代表模块的表达水平。模块特征基因是模块内基因表达矩阵的第一主成分（PCA），它能够捕捉模块内基因的共表达模式。</span></section></li><li><section><strong><span leaf="">性状关联分析</span></strong><span leaf="">：通过计算模块特征基因与样本性状之间的相关性，识别与特定性状显著相关的模块。例如，如果某个模块与某种疾病状态高度相关，则该模块中的基因可能在疾病发生中起重要作用。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">4. 模块内基因的分析</span></span><span></span></h3><ul><li><section><strong><span leaf="">识别Hub基因</span></strong><span leaf="">：在与性状相关的模块中，进一步分析模块内的基因。Hub基因是指在模块内连接度（connectivity）较高的基因，它们在模块中起到关键作用。连接度可以通过基因的模块内连接性（Module Membership，MM）来衡量。</span></section></li><li><section><strong><span leaf="">功能注释</span></strong><span leaf="">：对模块中的基因进行功能注释，如GO（Gene Ontology）富集分析或KEGG（Kyoto Encyclopedia of Genes and Genomes）通路分析，以揭示模块的生物学功能。</span></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">网络可视化结果</span></span><span></span></h4><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">检查无标度拓扑的对数-对数图：</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010864" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RkcQU3wosKenMJWJu0H3PpiavNIZI4TmZw39icLmBwDic98XblECEHYGhg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RkcQU3wosKenMJWJu0H3PpiavNIZI4TmZw39icLmBwDic98XblECEHYGhg/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">横轴表示整个网络连通性的对数，纵轴表示相应频率分布的对数。</span></section></li><li><section><span leaf="">图中的分布大致沿着一条直线，这表明网络具有近似无标度（scale-free）的拓扑结构。</span></section></li><li><section><span leaf="">给出的拟合优度 (R^2 = 0.97) 和斜率 (-2.76) 进一步支持了这一结论。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">经典多维尺度分析（MDS）的结果：</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010865" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RGY3OCKSgKvyZy6via9C4IX0EnpSjmzsXCNUwWk4x6Bwl2P3ghz0F4Bg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RGY3OCKSgKvyZy6via9C4IX0EnpSjmzsXCNUwWk4x6Bwl2P3ghz0F4Bg/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">模块倾向于在这个图中形成独立的“分支”。</span></section></li><li><section><span leaf="">模块内的关键基因（hub genes）位于分支的顶端。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">网络热图：</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010871" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RcYkHRIvhcUe55UfSg4Y7r1zdguPOuFLrSAOQrSJNOicCpQ34r8MOqXA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RcYkHRIvhcUe55UfSg4Y7r1zdguPOuFLrSAOQrSJNOicCpQ34r8MOqXA/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">层次聚类树状图中的分支对应于不同的模块。</span></section></li><li><section><span leaf="">颜色条显示了基因对各个模块的成员资格。</span></section></li><li><section><span leaf="">热图中，高度的共表达互联性通过越来越饱和的黄色和红色表示。</span></section></li><li><section><span leaf="">模块对应于高度互联基因的块。</span></section></li><li><section><span leaf="">具有高模块内连通性的基因位于模块分支的顶端，因为它们与模块内其他基因的互联性最高。</span></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">模块和特征基因网络图分析结果</span></span><span></span></h4><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">模块间基因显著性柱状图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010867" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2R3aILsjclniad0baqYtVNEic2U6a7mNXLyM39sNNSN3T0yptmiaP1iczAVQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2R3aILsjclniad0baqYtVNEic2U6a7mNXLyM39sNNSN3T0yptmiaP1iczAVQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">不同模块（蓝色、棕色、灰色、黄色）中基因的平均显著性。</span></section></li><li><section><span leaf="">使用基于性状的基因显著性（如公式2所示）作为度量。</span></section></li><li><section><span leaf="">柱状图表明，模块中基因显著性越高，该模块与临床性状的相关性越显著。</span></section></li><li><section><span leaf="">棕色模块的基因显著性最高，表明其与研究的性状关联最强（p值为5.6e-13）。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">绿色模块中基因显著性与模块成员资格的散点图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010870" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2Rib13Khyt9qhc5LyN45PreZz3VXDmNv0V2gkiaFyag7wniaTewjhuWz41A/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2Rib13Khyt9qhc5LyN45PreZz3VXDmNv0V2gkiaFyag7wniaTewjhuWz41A/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">展示了绿色模块中基因显著性（纵轴）与模块成员资格（横轴）之间的关系。</span></section></li><li><section><span leaf="">散点图显示，与性状相关的模块中，高模块成员资格的基因往往也具有高基因显著性。</span></section></li><li><section><span leaf="">相关系数为0.87，p值小于10^{-20}，表明两者之间存在显著的正相关关系。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">模块特征基因的层次聚类树状图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010869" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RH8JWPvE9ylUlHFRibDSIfgpFONd74iaJ6SB6yBXBzRQPVPyQ947PchlA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RH8JWPvE9ylUlHFRibDSIfgpFONd74iaJ6SB6yBXBzRQPVPyQ947PchlA/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">展示了不同模块特征基因（用颜色标记）以及微阵列样本性状y的层次聚类结果。</span></section></li><li><section><span leaf="">树状图可以帮助识别特征基因之间的相似性和聚类关系。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">特征基因网络的热图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010868" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RXpz5EocFHYx0Btfcmlo7lNaImLrGDSSicVzoyOLxRA0VnWECvoZl76Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RXpz5EocFHYx0Btfcmlo7lNaImLrGDSSicVzoyOLxRA0VnWECvoZl76Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">显示了包括性状y在内的特征基因网络的邻接关系。</span></section></li><li><section><span leaf="">热图中的每一行和每一列对应一个特征基因（用颜色标记）或性状（用y标记）。</span></section></li><li><section><span leaf="">绿色表示低邻接度（负相关），红色表示高邻接度（正相关）。</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">文献里面还有用小鼠作为例子进行的结果展示，大家感兴趣的可以看看，后续会结合小洁老师的代码进行整理，那就下期再见叭！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010877" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RhvjIJibh1rp9ibn1HSnyBRQTbZ68KI7Rb6KIYuaJJp6k1K6ZUHwQKYIQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9bDhuFeGHZ08a0IXP4czb2RhvjIJibh1rp9ibn1HSnyBRQTbZ68KI7Rb6KIYuaJJp6k1K6ZUHwQKYIQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">学习资料💾：</span></strong></p><ol><li><section><span leaf="">生新技能树数据挖掘课程——<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课7月班</a></span></section></li><li><section><span leaf="">参考书籍📚——《R语言数据可视化与统计基础》</span></section></li></ol></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/IrVWwX93n14JQy1tagRQJg",target="_blank" rel="noopener noreferrer">原文链接</a>
