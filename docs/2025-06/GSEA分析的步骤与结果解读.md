---
title: "GSEA分析的步骤与结果解读"
date: 2025-06-05T01:46:42Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
GSEA分析的步骤与结果解读 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">之前整理了<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247493974&amp;idx=1&amp;sn=9f141750e6ddda5075611cced6bc7a23&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">GO与KEGG富集分析的详细步骤与结果解读</a>的内容，今天来看看GSEA富集分析吧。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">学完富集分析之后，标准分析流程就只差蛋白互作网络分析啦！看看这周能不能整理完！</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010422" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJCic3RJNib9T6hCDn8ib82Xkw9DRDVfjgiciaicppkRoy7hOK4FTrQJP8XSJQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJCic3RJNib9T6hCDn8ib82Xkw9DRDVfjgiciaicppkRoy7hOK4FTrQJP8XSJQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">基因集富集分析（GSEA）</span></span><span></span></h2><blockquote><span></span><p><span leaf="">GSEA（Gene Set Enrichment Analysis）是一种基于基因表达水平的富集分析方法，用于分析基因集在样本中的整体表达趋势，而不仅仅是简单地判断基因是否富集。</span></p></blockquote><p data-tool="mdnice编辑器"><strong><span leaf="">大致分析过程</span></strong><span leaf="">：</span></p><ul><li><section><span leaf="">首先，根据基因表达水平对基因进行排序，形成一个基因列表。</span></section></li><li><section><span leaf="">然后，根据预定义的基因集（如某个通路中的基因集合），在排序后的基因列表中寻找基因集的分布情况。</span></section></li><li><section><span leaf="">通过计算富集分数（Enrichment Score, ES）来衡量基因集在基因列表中的分布趋势。ES值反映了基因集在基因列表中的聚集程度。</span></section></li><li><section><span leaf="">最后，通过置换检验（Permutation Test）计算P值，判断基因集的富集是否具有统计学意义。</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">输出结果</span></strong><span leaf="">：通常以富集曲线图（Enrichment Plot）的形式展示，显示基因集在基因列表中的分布情况。结果中会包含富集分数（ES）、P值、校正后的P值（如FDR）等信息。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">优点</span></strong><span leaf="">：考虑了基因表达水平的变化趋势，能够更全面地反映基因集在样本中的生物学意义，适用于分析复杂的基因表达模式。</span></p><h2 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">具体分析流程</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">加载需要的R包</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">rm(list = ls())</span><br><span leaf="">library(GSEABase) </span><br><span leaf="">library(clusterProfiler)</span><br><span leaf="">library(org.Hs.eg.db)</span><br><span leaf="">library(ggplot2)</span><br><span leaf="">library(stringr)</span><br><span leaf="">library(enrichplot)</span><br><span leaf="">library(msigdbr)</span><br><br></code></pre><ul><li><section><p><strong><span leaf="">GSEABase</span></strong><span leaf="">：用于基因集富集分析（Gene Set Enrichment Analysis, GSEA）的基础功能，提供用于处理和注释基因集的工具，是许多富集分析包的基础依赖包。</span></p></section></li><li><section><p><strong><span leaf="">msigdbr</span></strong><span leaf="">：用于访问和处理MSigDB（Molecular Signatures Database）数据，提供MSigDB基因集的R接口，方便用户下载和使用MSigDB中的基因集数据。</span></p></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">整理输入数据</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">输入数据</span></strong><span leaf="">：通常是基因表达矩阵，包含所有基因在不同样本中的表达水平。</span><strong><span leaf="">但只能拿只能拿一个包的差异分析结果来做，比如选择</span><code><span leaf="">DESeq2</span></code><span leaf="">的差异分析结果</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">load(</span><span><span leaf="">"pip_DEG.Rdata"</span></span><span leaf="">)</span><br><span leaf="">deg = DEG1</span><br><br><span leaf="">ge = deg</span><span><span leaf="">$log2FoldChange</span></span><span leaf=""> </span><span><span leaf=""># ⭐注意换不同的R包时logFC列的列名不同</span></span><br><span leaf="">names(ge) = rownames(deg)</span><br><span leaf="">ge = sort(ge,decreasing = T)</span><br><span leaf="">head(ge)</span><br></code></pre><ul><li><section><span leaf="">加载保存的差异表达基因数据。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010421" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJdbrRCIviaoAm68FCrV3qv5LF52qsNT86Q8lxC0iaOeSWp67OTqUx6yaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJdbrRCIviaoAm68FCrV3qv5LF52qsNT86Q8lxC0iaOeSWp67OTqUx6yaw/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img alt="deg" data-imgfileid="100010424" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJQzN3LLN3thHvcF76RKDkhrK2L5SciaDIouFKMJRXGrlBbDKgZ6jWKjA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJQzN3LLN3thHvcF76RKDkhrK2L5SciaDIouFKMJRXGrlBbDKgZ6jWKjA/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">deg</span></figcaption></figure><ul><li><section><span leaf="">提取基因的log2FC值。</span></section></li><li><section><span leaf="">为log2FC值设置基因名作为标识，并且按log2FC值降序排序。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010420" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJbq8S56dibudQOfURWLQ2lCiccImeibMod7BEibL6V8JVCNYHJsqQsvkoFw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJbq8S56dibudQOfURWLQ2lCiccImeibMod7BEibL6V8JVCNYHJsqQsvkoFw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">GSEA分析过程</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">1. 从MSigDB数据库中获取人类基因集数据，并对基因集名称进行格式化处理，使其更易读。</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">geneset &lt;- msigdbr(species = </span><span><span leaf="">"Homo sapiens"</span></span><span leaf="">,category = </span><span><span leaf="">"H"</span></span><span leaf="">) %&gt;%</span><br><span leaf="">  dplyr::select(gs_name,gene_symbol)</span><br><span leaf="">  </span><br><span leaf="">geneset[1:4,]</span><br></code></pre><ul><li><section><code><span leaf="">msigdbr()</span></code><span leaf="">函数用于从MSigDB数据库中获取基因集数据。</span></section></li><li><section><span leaf="">参数</span><code><span leaf="">species = "Homo sapiens"</span></code><span leaf="">指定物种为人类。</span></section></li><li><section><span leaf="">参数</span><code><span leaf="">category = "H"</span></code><span leaf="">指定基因集的类别为“H”，代表MSigDB中的Hallmark基因集，这些基因集代表了细胞和生理过程中的关键生物学状态。</span></section></li><li><section><code><span leaf="">dplyr::select(gs_name, gene_symbol)</span></code><span leaf="">选择基因集名称（</span><code><span leaf="">gs_name</span></code><span leaf="">）和基因符号（</span><code><span leaf="">gene_symbol</span></code><span leaf="">）这两列，以便后续使用。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010423" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJE9HPsT4GIFPXdLticRlUqicBx0dZFHZDiaoRf5D4qfvFVelPp8fdSIOFA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJE9HPsT4GIFPXdLticRlUqicBx0dZFHZDiaoRf5D4qfvFVelPp8fdSIOFA/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">2. 对基因集名称进行格式化处理。</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">geneset</span><span><span leaf="">$gs_name</span></span><span leaf=""> = geneset</span><span><span leaf="">$gs_name</span></span><span leaf=""> %&gt;%</span><br><span leaf="">  str_split(</span><span><span leaf="">"_"</span></span><span leaf="">,simplify = T,n = 2)%&gt;%</span><br><span leaf="">  .[,2]%&gt;%</span><br><span leaf="">  str_replace_all(</span><span><span leaf="">"_"</span></span><span leaf="">,</span><span><span leaf="">" "</span></span><span leaf="">) %&gt;% </span><br><span leaf="">  str_to_sentence()</span><br><br></code></pre><ul><li><section><code><span leaf="">str_split("_", simplify = T, n = 2)</span></code><span leaf="">：将基因集名称按</span><code><span leaf="">_</span></code><span leaf="">分割成两部分，并简化为矩阵格式，提取分割后的第二部分（通常是基因集的描述）。</span></section></li><li><section><code><span leaf="">str_replace_all("_", " ")</span></code><span leaf="">：将描述中的下划线</span><code><span leaf="">_</span></code><span leaf="">替换为空格</span><code></code><span leaf="">，使名称更易读。</span></section></li><li><section><code><span leaf="">str_to_sentence()</span></code><span leaf="">：将文本转换为首字母大写的句子格式，使名称更规范。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010426" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJcbH50J0qEpOXblK215IFSeTOJXTdwbZpaBh8XHwnxSSAczWvghra6g/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJcbH50J0qEpOXblK215IFSeTOJXTdwbZpaBh8XHwnxSSAczWvghra6g/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">3. 进行基因集富集分析（GSEA）：</span><code><span leaf="">GSEA</span></code><span leaf="">函数会根据基因表达变化倍数和基因集信息，计算每个基因集的富集得分。</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">em &lt;- GSEA(ge, TERM2GENE = geneset)</span><br></code></pre><ul><li><section><code><span leaf="">ge</span></code><span leaf="">是之前提取并排序的基因表达变化倍数（log2FC）向量。</span></section></li><li><section><code><span leaf="">TERM2GENE = geneset</span></code><span leaf="">：指定基因集数据，其中</span><code><span leaf="">gs_name</span></code><span leaf="">是基因集名称，</span><code><span leaf="">gene_symbol</span></code><span leaf="">是对应的基因符号。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010428" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJCrffAGBDjhbMkHaHRZ3eCxGnOF6XUzG60ogr8tnOmWhHaE2UuzicmRw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJCrffAGBDjhbMkHaHRZ3eCxGnOF6XUzG60ogr8tnOmWhHaE2UuzicmRw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">结果数据 </span><code><span leaf="">em</span></code><span leaf=""> 是一个 S4 类对象，名为 </span><code><span leaf="">gseaResult</span></code><span leaf="">，其中包含了多个元素，每个元素存储了富集分析的不同方面。以下是 </span><code><span leaf="">em</span></code><span leaf=""> 对象中主要包含的内容：</span></p><ol><li><section><p><strong><span leaf="">result</span></strong><span leaf="">数据框（data.frame）：包含富集分析的结果。数据框有3行11列，每一行代表一个基因集的富集分析结果，列包括：</span></p></section></li></ol><ul><li><section><code><span leaf="">ID</span></code><span leaf="">：基因集的标识符。</span></section></li><li><section><code><span leaf="">Description</span></code><span leaf="">：基因集的描述。</span></section></li><li><section><code><span leaf="">setSize</span></code><span leaf="">：基因集中基因的数量。</span></section></li><li><section><code><span leaf="">enrichmentScore</span></code><span leaf="">：富集得分，表示基因集在排序列表中的富集程度。</span></section></li><li><section><code><span leaf="">NES</span></code><span leaf="">（Normalized Enrichment Score）：标准化富集得分，用于比较不同基因集的富集程度。</span></section></li><li><section><code><span leaf="">pvalue</span></code><span leaf="">：原始p值，表示富集得分的统计显著性。</span></section></li><li><section><code><span leaf="">p.adjust</span></code><span leaf="">：调整后的p值，通常使用多重假设检验校正方法（如Bonferroni校正）来调整p值。</span></section></li><li><section><code><span leaf="">qvalue</span></code><span leaf="">：q值，另一种多重假设检验校正方法，通常比调整后的p值更保守。</span></section></li><li><section><code><span leaf="">rank</span></code><span leaf="">：基因集中排名最高的基因在整个基因列表中的位置。</span></section></li><li><section><code><span leaf="">leading_edge</span></code><span leaf="">：领先边缘基因列表，即在排序列表中位于基因集最前端的基因子集，这些基因对富集得分贡献最大。</span></section></li><li><section><code><span leaf="">core_enrichment</span></code><span leaf="">：核心富集得分，考虑了领先边缘基因对富集得分的贡献。</span></section></li></ul><li><section><p><strong><span leaf="">geneSets</span></strong><span leaf="">列表：包含50个元素，每个元素代表一个基因集，其中包含了基因集中所有基因的标识符。</span></p></section></li><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010429" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJLAlGj92AicSAKMv3nVUV6xcsWqIetOzhtpvEiaWqRfZJQxOH7zCYO6SQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJLAlGj92AicSAKMv3nVUV6xcsWqIetOzhtpvEiaWqRfZJQxOH7zCYO6SQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><ol><li><section><strong><span leaf="">geneList</span></strong><span leaf="">：一个向量，包含18438个元素，每个元素对应一个基因的富集得分。</span></section></li></ol><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010427" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJlXKNJicPQcMw708jmL8HRkyV9ylKEgibMGTRj2sRtg1gVPOj1GCNcehQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJlXKNJicPQcMw708jmL8HRkyV9ylKEgibMGTRj2sRtg1gVPOj1GCNcehQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><ol><li><section><p><strong><span leaf="">keytype</span></strong><span leaf=""> 和 </span><strong><span leaf="">keyvalue</span></strong><span leaf="">：分别表示基因标识符的类型和值，这里都是 'UNKNOWN'。</span></p></section></li><li><section><p><strong><span leaf="">permScores</span></strong><span leaf="">：一个空的向量，通常用于存储排列检验的得分。</span></p></section></li><li><section><p><strong><span leaf="">params</span></strong><span leaf="">：一个列表，包含6个元素，存储了GSEA分析的参数设置，例如分析方法、统计检验方法等。</span></p></section></li></ol><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010425" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJhicHpRl0elEmpmQaJDh2APMvW4BfYW3vEoiaVLu7qialF8JoEU6Wr9RXw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJhicHpRl0elEmpmQaJDh2APMvW4BfYW3vEoiaVLu7qialF8JoEU6Wr9RXw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">4. 绘制富集分析结果图</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gseaplot2(em, geneSetID = 1, title = em</span><span><span leaf="">$Description</span></span><span leaf="">[1])</span><br></code></pre><ul><li><section><code><span leaf="">em</span></code><span leaf="">是富集分析的结果。</span></section></li><li><section><code><span leaf="">geneSetID = 1</span></code><span leaf="">：指定绘制第一个基因集的富集结果。</span></section></li><li><section><code><span leaf="">title = em$Description[1]</span></code><span leaf="">：将第一个基因集的描述作为图表标题。</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010434" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJeNF5brcEKKm19UrL2HLXATNxgrf7hAmoFia1qIQibibj3TtKYrgTaAWhA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJeNF5brcEKKm19UrL2HLXATNxgrf7hAmoFia1qIQibibj3TtKYrgTaAWhA/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">绿色曲线在左侧达到峰值，表示基因集的基因在排序列表的前端更集中，可能与上调相关。</span></section></li><li><section><span leaf="">图表中间的黑色竖线显示了基因集中的基因在排序列表中的位置。</span></section></li><li><section><span leaf="">图表中间的颜色条显示了基因表达的变化方向或显著性，红色表示上调，蓝色表示下调。</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">对于如何理解GSEA结果图小洁老师有详细的讲过，这里结合人工智能给的资料进行整理汇总：</span></strong></p><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">GSEA结果图表结构</span></span><span></span></h4><ol><li><section><p><strong><span leaf="">Running Enrichment Score（运行富集得分）基因集的富集情况</span></strong><span leaf="">：<img data-imgfileid="100010432" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJ89GT93TjZdM0E2mNsR4ShvjJMdiaMW95JVAM67yxX8j39KHxmFO6IQQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJ89GT93TjZdM0E2mNsR4ShvjJMdiaMW95JVAM67yxX8j39KHxmFO6IQQ/640?wx_fmt=png&amp;from=appmsg"></span></p></section></li></ol><ul><li><section><span leaf="">这条曲线表示在基因列表中，随着基因的顺序变化，基因集的累积富集得分。</span></section></li><li><section><span leaf="">曲线的峰值表示基因集中的基因在排序列表中富集程度最高的点。</span></section></li><li><section><span leaf="">如果曲线在左侧达到峰值，表示基因集的基因在排序列表的前端更集中，可能与上调相关。</span></section></li><li><section><span leaf="">如果曲线在右侧达到峰值，表示基因集的基因在排序列表的后端更集中，可能与下调相关。</span></section></li></ul><li><section><p><strong><span leaf="">Rank in Ordered Dataset（排序数据集中的排名）</span></strong><span leaf="">：</span></p></section></li><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010430" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJqFGQrFvEickkAOvXl16nXZysPsFzSZ3yQqfNYkj9eQsESdZBqiawfKCQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJqFGQrFvEickkAOvXl16nXZysPsFzSZ3yQqfNYkj9eQsESdZBqiawfKCQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">图表中间的黑色竖线表示基因集中的基因在排序列表中的位置。</span></section></li><li><section><span leaf="">这些竖线的分布可以帮助识别哪些基因对富集得分的贡献最大。</span></section></li><li><section><span leaf="">图表中间的颜色条表示基因表达的变化方向或显著性。</span></section></li><li><section><span leaf="">通常，红色表示上调，蓝色表示下调，颜色的深浅表示变化的程度或显著性。</span></section></li></ul><ol><li><section><strong><span leaf="">Ranked List Metric（排序列表指标）</span></strong><span leaf="">：</span></section></li></ol><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010433" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJODr5BQicD5zibt9ffobYNZEfz3Ll82JJbsTC7yfYgncibnY4sXsiaLF0uw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJODr5BQicD5zibt9ffobYNZEfz3Ll82JJbsTC7yfYgncibnY4sXsiaLF0uw/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">图表的下半部分显示了排序列表指标（Ranked List Metric），这是一条灰色的曲线。</span></section></li><li><section><span leaf="">这条曲线表示每个基因的统计量（如差异表达的显著性）。</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">5.绘制多个通路</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010431" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJcWh4dvA4SNKB6Kk7QISAOmN7HDpgaYmpKSJxLWiapLcBJuJiaibLmrVFg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJcWh4dvA4SNKB6Kk7QISAOmN7HDpgaYmpKSJxLWiapLcBJuJiaibLmrVFg/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gseaplot2(em, geneSetID = 1:3,pvalue_table = T) </span><span><span leaf="">#多个通路</span></span><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">也可以同时展示多个基因集的富集分析结果，并在图中添加一个包含p值和调整后p值的表格，有助于比较不同基因集的富集情况和统计显著性。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010438" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJqEibI2BZgbKiaGYcBAo31FHXE4anULmpDDQ0YE2XcNicJvyIxicia4fQcfQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJqEibI2BZgbKiaGYcBAo31FHXE4anULmpDDQ0YE2XcNicJvyIxicia4fQcfQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><ul><li><section><span leaf="">三条不同颜色的曲线分别代表三个不同的基因集（如上皮间质转化、mTORC1信号传导、紫外线响应）。</span></section></li><li><section><span leaf="">每条曲线的峰值表示基因集在排序列表中的富集程度最高的位置。</span></section></li><li><section><span leaf="">图表中间的竖线显示了基因集中的基因在排序列表中的位置。</span></section></li><li><section><span leaf="">图表中间的颜色条显示了基因表达的变化方向或显著性，红色表示上调，蓝色表示下调。</span></section></li><li><section><span leaf="">右上角的表格显示了每个基因集的p值和调整后的p值，帮助评估富集结果的显著性。</span></section></li></ul><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">其余可视化基因集富集分析方式</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">比如气泡图和山脊图</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">dotplot(em,split=</span><span><span leaf="">".sign"</span></span><span leaf="">)+facet_grid(~.sign)</span><br><span leaf="">ridgeplot(em)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010439" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJzbnwnQXtZfW9IWaFfp7wuU7WuMzFBmajXlcf3icwN3Se8W20QrSiaib6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiaRwSceXjzEldORG3tHZmJzbnwnQXtZfW9IWaFfp7wuU7WuMzFBmajXlcf3icwN3Se8W20QrSiaib6Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">学习资料💾：</span></strong></p><ol><li><section><span leaf="">生新技能树数据挖掘课程——<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247542908&amp;idx=1&amp;sn=f3b2ea17f54499441d39900218a0fd6a&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课6月班</a></span></section></li><li><section><span leaf="">参考书籍📚——《R语言数据可视化与统计基础》</span></section></li></ol></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/3PRMNGorbjZRwlfjOlA6Zw",target="_blank" rel="noopener noreferrer">原文链接</a>
