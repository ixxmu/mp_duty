---
title: "CEL结尾的芯片数据处理方法(oligo和affy)学习"
date: 2025-06-05T15:58:53Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
CEL结尾的芯片数据处理方法(oligo和affy)学习 by 生信方舟
------
<div><section><span leaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="生信方舟" data-alias="shengxinfangzhou" data-from="0" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyGfe15Xm0WHdoAMNGvE93bmxaF9iabfPiaO9ic6Tmd8XW1PMiaeuqicSFhCLQJibAUhHsamS1LbaJMFiaZXA/0?wx_fmt=png" data-signature="热爱医学和数据科学，站在巨人的肩膀上，学习和整理相关的知识。" data-id="MzkwMjYyMDA1OA==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></span></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">oligo和affy这两个包都能够处理CEL结尾的芯片数据，但是适用性存在一定的差别。让大模型帮忙整理了一下。<img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTS6q4XzbTibbicuRo5ic1fdYibTPxX9hpWicDG7XgwDpzOx9E2O7tItuD4Sg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6307490144546649" data-type="png" data-w="761" data-imgfileid="100004639" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTS6q4XzbTibbicuRo5ic1fdYibTPxX9hpWicDG7XgwDpzOx9E2O7tItuD4Sg/640?wx_fmt=png&amp;from=appmsg">感觉回答的还挺好。<img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTyw7OPV6JXPK5La4QLqKApybCN1Ot9tpPb15gPHdvq9KiaoGHg4HP1Dg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4879725085910653" data-type="png" data-w="582" data-imgfileid="100004637" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTyw7OPV6JXPK5La4QLqKApybCN1Ot9tpPb15gPHdvq9KiaoGHg4HP1Dg/640?wx_fmt=png&amp;from=appmsg"></span></p><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">oligo包分析流程</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">选择一个适合oligo包的CEL数据<img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTouEYLXCiapuvVd6gEibgFSTUpH3WxD2NgJEsMQGS9uBQZMe9bEUeR3Hw/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.1203252032520326" data-type="png" data-w="615" data-imgfileid="100004640" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTouEYLXCiapuvVd6gEibgFSTUpH3WxD2NgJEsMQGS9uBQZMe9bEUeR3Hw/640?wx_fmt=png&amp;from=appmsg">提供一个解压缩并且移动文件的思路代码</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 解压缩</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(R.utils)</span><span leaf=""><br></span><span><span leaf=""># 设置原始目录（包含 .gz 文件）</span></span><span leaf=""><br></span><span leaf="">input_dir &lt;- </span><span><span leaf="">"~/Desktop/GSE76250/GSE76250_RAW/"</span></span><span leaf=""><br></span><span><span leaf=""># 设置解压后的目标目录（确保已存在）</span></span><span leaf=""><br></span><span leaf="">output_dir &lt;- </span><span><span leaf="">"~/Desktop/GSE76250/GSE76250_new/"</span></span><span leaf=""><br></span><span leaf="">dir.create(output_dir, showWarnings = </span><span><span leaf="">FALSE</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 获取所有 .gz 文件路径</span></span><span leaf=""><br></span><span leaf="">gz_files &lt;- list.files(input_dir, pattern = </span><span><span leaf="">"\\.gz$"</span></span><span leaf="">, full.names = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 解压到新的文件夹中</span></span><span leaf=""><br></span><span><span leaf="">for</span></span><span leaf=""> (f </span><span><span leaf="">in</span></span><span leaf=""> gz_files) {</span><span leaf=""><br></span><span leaf="">  gunzip(filename = f,</span><span leaf=""><br></span><span leaf="">         destname = file.path(output_dir, sub(</span><span><span leaf="">"\\.gz$"</span></span><span leaf="">, </span><span><span leaf="">""</span></span><span leaf="">, basename(f))),</span><span leaf=""><br></span><span leaf="">         overwrite = </span><span><span leaf="">FALSE</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">         remove = </span><span><span leaf="">FALSE</span></span><span leaf="">)  </span><span><span leaf=""># 设置为 FALSE 不删除原文件</span></span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">正式流程</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(oligo)</span><span leaf=""><br></span><span><span leaf=""># 设置路径</span></span><span leaf=""><br></span><span leaf="">dir_cels=</span><span><span leaf="">'/Users/zaneflying/Desktop/GSE76250/GSE76250_new/'</span></span><span leaf=""><br></span><span leaf="">cel_files &lt;- list.celfiles(dir_cels, full.names = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">affy_data &lt;- read.celfiles(cel_files)</span><span leaf=""><br></span><span leaf="">expr_matrix &lt;- exprs(eset)  </span><span><span leaf=""># 获取表达量数据</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTvrLMRkXpL5MGKh6rChVbuyJwSNcCSG4q3LjO69e1ENMQ5YiaIqaDEWg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.46673596673596673" data-type="png" data-w="962" data-imgfileid="100004638" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTvrLMRkXpL5MGKh6rChVbuyJwSNcCSG4q3LjO69e1ENMQ5YiaIqaDEWg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">affy包分析流程</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">选择一个适合affy包的CEL数据<img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTJm6AKBLDgiaibqknD27G04CBwYhfqTHgRJElLrmSR0xT5pKta53QyJHA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9678972712680578" data-type="png" data-w="623" data-imgfileid="100004641" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyFZleXcLdRzu2tozmJDNzKTJm6AKBLDgiaibqknD27G04CBwYhfqTHgRJElLrmSR0xT5pKta53QyJHA/640?wx_fmt=png&amp;from=appmsg"></span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(affy)</span><span leaf=""><br></span><span leaf="">getwd()</span><span leaf=""><br></span><span leaf="">dir_cels=</span><span><span leaf="">'~/Desktop/GSE76250/GSE76250_RAW/'</span></span><span leaf=""><br></span><span><span leaf="">#affy_data = ReadAffy(celfile.path=dir_cels)</span></span><span leaf=""><br></span><span leaf="">eSet = rma(affy_data) </span><span><span leaf="">#rma函数去normalization</span></span><span leaf=""><br></span><span><span leaf="">##要进行过滤</span></span><span leaf=""><br></span><span leaf="">calls = mas5calls(affy_data) </span><span><span leaf=""># get PMA calls</span></span><span leaf=""><br></span><span leaf="">calls = exprs(calls)</span><span leaf=""><br></span><span leaf="">absent = rowSums(calls == </span><span><span leaf="">'A'</span></span><span leaf="">) </span><span><span leaf=""># how may samples are each gene 'absent' in all samples</span></span><span leaf=""><br></span><span leaf="">absent = which(absent == ncol(calls)) </span><span><span leaf=""># which genes are 'absent' in all samples</span></span><span leaf=""><br></span><span leaf="">eSet = eSet[-absent,] </span><span><span leaf=""># filters out the genes 'absent' in all samples</span></span><span leaf=""><br></span><span leaf="">save(eSet,file = </span><span><span leaf="">"GSE38832_afterCEL.Rdata"</span></span><span leaf="">)</span></code></pre></section><p><span leaf=""><br></span></p><p><strong><span leaf="">注</span></strong><span><span leaf="">：若对内容有疑惑或者有发现明确错误的朋友，请联系后台。更多相关内容可关注公众号：</span></span><strong><span leaf="">生信方舟</span></strong><span><span leaf=""> 。</span></span><span></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span><span leaf="">结尾</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">欢迎加入"生信&amp;临床“交流群，若有意向进群的小伙伴请加微信：</span><strong><span leaf="">couqiliugeziba321</span></strong><span leaf="">，请注明“</span><strong><span leaf="">单位或学校-专业或方向-姓名或昵称</span></strong><span leaf="">”。希望进群的你收获知识的同时也能够收获快乐~ 🤗<img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyHhicvYGnNG4ykv8kpHtAFj11AWnpy95ONib1lQc42bTawwyRCYUqkTkuPRFfvYM65WZ8cFCiawuUYibA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6166666666666667" data-type="png" data-w="1080" data-imgfileid="100004358" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyHhicvYGnNG4ykv8kpHtAFj11AWnpy95ONib1lQc42bTawwyRCYUqkTkuPRFfvYM65WZ8cFCiawuUYibA/640?wx_fmt=png&amp;from=appmsg"></span></p><section><span><span leaf="">- END -</span></span></section></section><p><span leaf=""><br></span></p><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/ft5xwx8IUd-nEHMOz-mPCA",target="_blank" rel="noopener noreferrer">原文链接</a>
