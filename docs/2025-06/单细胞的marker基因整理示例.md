---
title: "单细胞的marker基因整理示例"
date: 2025-06-29T04:04:49Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
单细胞的marker基因整理示例 by 生信星球
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="3 5 []"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013059" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013061" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"></span><span><span leaf=""> 今天是生信星球陪你的</span><span><strong><span leaf="">第1049天</span></strong></span></span><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013060" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png">   </span></section><section><blockquote><section><span><span leaf="">公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。</span></span><span><span leaf="">我的课程都是循环开课，</span></span><span><span leaf="">点进去咨询微信，随时可以报名↓</span></span><span leaf=""><br></span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247496614&amp;idx=1&amp;sn=4177354e87d394a022c3d410f482546a&amp;scene=21#wechat_redirect" textvalue="生信分‍析直播课程" data-itemshowtype="11" linktype="text" data-linktype="2">生信分析直播课程</a>(每月初开一期)</span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497024&amp;idx=2&amp;sn=8c8b240b5df1d3b2c2e29b17f407ee75&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组长期报名中" data-itemshowtype="0" linktype="text" data-linktype="2">生信新手保护学习小组长期报名中</a>（每月一期）</span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497024&amp;idx=1&amp;sn=6bd813f1722c4d6e6ca6eb0b1ce60848&amp;scene=21#wechat_redirect" textvalue="单细胞陪伴学习小组" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞陪伴学习小组</a>（每月一期）</span></section></blockquote></section></section></section><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">0.需求</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">单细胞的marker基因整理，要求一行是一个细胞和一个基因，但我们从文献中查找的结果未必规范。如果一个细胞有多个marker基因，应分布在多行上。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">1.读取数据</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">GCmarker.txt文件内容如下，将其放在工作目录下。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">G;GAST</span><span leaf=""><br></span><span leaf="">X;GHRL</span><span leaf=""><br></span><span leaf="">D;SST</span><span leaf=""><br></span><span leaf="">PMC;MUC5AC</span><span leaf=""><br></span><span leaf="">GMC;MUC6</span><span leaf=""><br></span><span leaf="">parietal;ATP4A,ATP4B,GIF</span><span leaf=""><br></span><span leaf="">chief;PGA4,PGA3,LIPF</span><span leaf=""><br></span><span leaf="">T;CD2, CD3D,CD3E,CD3G</span><span leaf=""><br></span><span leaf="">B;CD79A,CD19</span><span leaf=""><br></span><span leaf="">mast;TPSAB1,TPSB2</span><span leaf=""><br></span><span leaf="">Macrophage;CD14, CD163, CD68, CSF1R</span><span leaf=""><br></span><span leaf="">Fibroblasts;FAP, PDPN,COL1A2,DCN, COL3A1,COL6A1</span><span leaf=""><br></span><span leaf="">Endothelial;PECAM1,VWF,ENG,MCAM</span><span leaf=""><br></span><span leaf="">stem;OLFM4,SOX2,LGR5,CCKBR</span><span leaf=""><br></span><span leaf="">SMC;ACTA2,ACTN2,MYL2,MYH2</span><span leaf=""><br></span><span leaf="">PC;MKI67,BIRC5,CDK1</span><span leaf=""><br></span><span leaf="">goblet;TFF3,SPINK4,MUC2</span><span leaf=""><br></span><span leaf="">enteroendocrine;CHGA,CHGB,TAC1,TPH1,NEUROG3</span><span leaf=""><br></span><span leaf="">enterocytes;FABP1,CA1,VIL1</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">上次我的学生整理了一个，是手动整理的，太费事了。所以我来教一个函数自动完成！</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span leaf="">markers = read.delim(</span><span><span leaf="">"GCmarker.txt"</span></span><span leaf="">,header = </span><span><span leaf="">F</span></span><span leaf="">,sep = </span><span><span leaf="">";"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(markers,</span><span><span leaf="">20</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">##                 V1                                  V2</span><span leaf=""><br></span><span leaf="">## 1                G                                GAST</span><span leaf=""><br></span><span leaf="">## 2                X                                GHRL</span><span leaf=""><br></span><span leaf="">## 3                D                                 SST</span><span leaf=""><br></span><span leaf="">## 4              PMC                              MUC5AC</span><span leaf=""><br></span><span leaf="">## 5              GMC                                MUC6</span><span leaf=""><br></span><span leaf="">## 6         parietal                     ATP4A,ATP4B,GIF</span><span leaf=""><br></span><span leaf="">## 7            chief                      PGA4,PGA3,LIPF</span><span leaf=""><br></span><span leaf="">## 8                T                 CD2, CD3D,CD3E,CD3G</span><span leaf=""><br></span><span leaf="">## 9                B                          CD79A,CD19</span><span leaf=""><br></span><span leaf="">## 10            mast                        TPSAB1,TPSB2</span><span leaf=""><br></span><span leaf="">## 11      Macrophage            CD14, CD163, CD68, CSF1R</span><span leaf=""><br></span><span leaf="">## 12     Fibroblasts FAP, PDPN,COL1A2,DCN, COL3A1,COL6A1</span><span leaf=""><br></span><span leaf="">## 13     Endothelial                 PECAM1,VWF,ENG,MCAM</span><span leaf=""><br></span><span leaf="">## 14            stem               OLFM4,SOX2,LGR5,CCKBR</span><span leaf=""><br></span><span leaf="">## 15             SMC               ACTA2,ACTN2,MYL2,MYH2</span><span leaf=""><br></span><span leaf="">## 16              PC                    MKI67,BIRC5,CDK1</span><span leaf=""><br></span><span leaf="">## 17          goblet                    TFF3,SPINK4,MUC2</span><span leaf=""><br></span><span leaf="">## 18 enteroendocrine         CHGA,CHGB,TAC1,TPH1,NEUROG3</span><span leaf=""><br></span><span leaf="">## 19     enterocytes                      FABP1,CA1,VIL1</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">nrow(markers)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">## [1] 19</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">可见，一共有19种细胞，每种细胞对应一个或多个基因。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2.行的拆分</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">一个细胞对应多个基因的行，拆分成多行。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">library</span></span><span leaf="">(tidyr)</span><span leaf=""><br></span><span leaf="">markers = separate_rows(markers,V2,sep = </span><span><span leaf="">","</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(markers,</span><span><span leaf="">20</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">## # A tibble: 20 × 2</span><span leaf=""><br></span><span leaf="">##    V1         V2      </span><span leaf=""><br></span><span leaf="">##    &lt;chr&gt;      &lt;chr&gt;   </span><span leaf=""><br></span><span leaf="">##  1 G          "GAST"  </span><span leaf=""><br></span><span leaf="">##  2 X          "GHRL"  </span><span leaf=""><br></span><span leaf="">##  3 D          "SST"   </span><span leaf=""><br></span><span leaf="">##  4 PMC        "MUC5AC"</span><span leaf=""><br></span><span leaf="">##  5 GMC        "MUC6"  </span><span leaf=""><br></span><span leaf="">##  6 parietal   "ATP4A" </span><span leaf=""><br></span><span leaf="">##  7 parietal   "ATP4B" </span><span leaf=""><br></span><span leaf="">##  8 parietal   "GIF"   </span><span leaf=""><br></span><span leaf="">##  9 chief      "PGA4"  </span><span leaf=""><br></span><span leaf="">## 10 chief      "PGA3"  </span><span leaf=""><br></span><span leaf="">## 11 chief      "LIPF"  </span><span leaf=""><br></span><span leaf="">## 12 T          "CD2"   </span><span leaf=""><br></span><span leaf="">## 13 T          " CD3D" </span><span leaf=""><br></span><span leaf="">## 14 T          "CD3E"  </span><span leaf=""><br></span><span leaf="">## 15 T          "CD3G"  </span><span leaf=""><br></span><span leaf="">## 16 B          "CD79A" </span><span leaf=""><br></span><span leaf="">## 17 B          "CD19"  </span><span leaf=""><br></span><span leaf="">## 18 mast       "TPSAB1"</span><span leaf=""><br></span><span leaf="">## 19 mast       "TPSB2" </span><span leaf=""><br></span><span leaf="">## 20 Macrophage "CD14"</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">nrow(markers)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">## [1] 55</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">19行变成了55行，一行一个细胞一个基因。</span></p><p data-tool="mdnice编辑器"><span leaf="">有的基因名称前面有空格，会影响后续的画图，可以用trimws函数去除每个基因名前后的空格。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">markers$V2 =  trimws(markers$V2)</span><span leaf=""><br></span><span leaf="">head(markers,</span><span><span leaf="">20</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">## # A tibble: 20 × 2</span><span leaf=""><br></span><span leaf="">##    V1         V2    </span><span leaf=""><br></span><span leaf="">##    &lt;chr&gt;      &lt;chr&gt; </span><span leaf=""><br></span><span leaf="">##  1 G          GAST  </span><span leaf=""><br></span><span leaf="">##  2 X          GHRL  </span><span leaf=""><br></span><span leaf="">##  3 D          SST   </span><span leaf=""><br></span><span leaf="">##  4 PMC        MUC5AC</span><span leaf=""><br></span><span leaf="">##  5 GMC        MUC6  </span><span leaf=""><br></span><span leaf="">##  6 parietal   ATP4A </span><span leaf=""><br></span><span leaf="">##  7 parietal   ATP4B </span><span leaf=""><br></span><span leaf="">##  8 parietal   GIF   </span><span leaf=""><br></span><span leaf="">##  9 chief      PGA4  </span><span leaf=""><br></span><span leaf="">## 10 chief      PGA3  </span><span leaf=""><br></span><span leaf="">## 11 chief      LIPF  </span><span leaf=""><br></span><span leaf="">## 12 T          CD2   </span><span leaf=""><br></span><span leaf="">## 13 T          CD3D  </span><span leaf=""><br></span><span leaf="">## 14 T          CD3E  </span><span leaf=""><br></span><span leaf="">## 15 T          CD3G  </span><span leaf=""><br></span><span leaf="">## 16 B          CD79A </span><span leaf=""><br></span><span leaf="">## 17 B          CD19  </span><span leaf=""><br></span><span leaf="">## 18 mast       TPSAB1</span><span leaf=""><br></span><span leaf="">## 19 mast       TPSB2 </span><span leaf=""><br></span><span leaf="">## 20 Macrophage CD14</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">完工</span></p></section><section><span leaf=""><br></span></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/KQaGJuE4B6Mcdl4JZBo64g",target="_blank" rel="noopener noreferrer">原文链接</a>
