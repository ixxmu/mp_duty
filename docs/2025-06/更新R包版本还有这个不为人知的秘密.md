---
title: "更新R包版本还有这个不为人知的秘密"
date: 2025-06-14T09:47:23Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
更新R包版本还有这个不为人知的秘密 by 生信菜鸟团
------
<div><h3 data-pm-slice="0 0 []"><span leaf="">背景简介</span></h3><p><span leaf="">共享服务器，考虑到用户的需求，服务器维护团队已经在服务器上安装了1300+的公共R包，路径为： </span><code><span><span leaf="">/refdir/</span></span><span><span leaf="">Rlib</span></span></code><span leaf="">。</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIbsMkYapBbOYlLQuCLIjTYeELLnPXBaPO4zeFAYcyL17kUtoZujleYg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4083333333333333" data-type="png" data-w="1080" data-imgfileid="100051300" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIbsMkYapBbOYlLQuCLIjTYeELLnPXBaPO4zeFAYcyL17kUtoZujleYg/640?wx_fmt=png&amp;from=appmsg"></section><p><span leaf="">一般来说，用户只需要在 .libPaths 中添加服务器公共R包即可调用，</span><font><span leaf="">有两种方法（其中4.4需要根据服务器的R语言版本进行适当修改）：</span></font></p><ul><li><span><span><font><span leaf="">方法一（需要每次登陆服务器中都设置一下）：</span></font></span></span></li></ul><p><font><span leaf="">直接在 </span></font><strong><font><span leaf="">.libPaths()</span></font></strong><font><span leaf=""> 中添加服务器公共R包的路径即可。但是这样设置仅仅是当前R会话生效，当会话重启或者切换了其他项目 Rproj 之后就会失效。</span></font></p><pre><ol><li><span><span><code><span><span leaf="">.</span></span><span><span leaf="">libPaths</span></span><span><span leaf="">(</span></span><span><span leaf="">c</span></span><span><span leaf="">(</span></span><span><span leaf="">'~/R/x86_64-pc-linux-gnu-library/4.4'</span></span><span><span leaf="">,</span></span></code></span></span></li><li><span><span><code><span><span leaf="">'/refdir/Rlib'</span></span><span><span leaf="">,</span></span></code></span></span></li><li><span><span><code><span><span leaf="">'/usr/local/lib/R/library'</span></span><span><span leaf="">))</span></span></code></span></span></li></ol></pre><ul><li><span><span><font><span leaf="">方法二（是一次设置长期有效）：</span></font></span></span></li></ul><p><font></font><strong><font><span leaf="">ssh 登陆服务器</span></font></strong><font><span leaf="">创建一个 .Rprofile（R语言配置文件）然后在这个文件中输入你要调用R包的位置即可。示例代码如下：</span></font></p><pre><ol><li><span><span><code><span><span leaf="">echo </span></span><span><span leaf="">".libPaths(c('~/R/x86_64-pc-linux-gnu-library/4.4',</span></span></code></span></span></li><li><span><span><code><span><span leaf="">'/refdir/Rlib',</span></span></code></span></span></li><li><span><span><code><span><span leaf="">'/usr/local/lib/R/library'))"</span></span><span></span><span><span leaf="">&gt;&gt;</span></span><span></span><span><span leaf="">~/.</span></span><span><span leaf="">Rprofile</span></span></code></span></span></li></ol></pre><p><font><span leaf="">设置后了之后，重启 Rsession 即可生效：</span></font></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIsBlsL39JEaE0JODVy2s4JibbvIhyHf3JHzEB6NJvMLbiaZ4pDfJc2XzQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5244897959183673" data-type="png" data-w="490" data-backw="490" data-backh="257" data-imgfileid="100051296" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIsBlsL39JEaE0JODVy2s4JibbvIhyHf3JHzEB6NJvMLbiaZ4pDfJc2XzQ/640?wx_fmt=png&amp;from=appmsg"></section><p><font><span leaf="">需要注意的是：服务器公共R包 </span></font><code><span><span leaf=""><br></span></span><span><span leaf="">/refdir/Rlib</span></span></code><font><span leaf="">的版本不一定是最新的，且不一定兼容所有环境。不同用户的需求不同，可能需要用到不同版本的R包，用户需要请自行安装到自己目录下，示例方法：</span></font></p><pre><ol><li><span><span><code><span><span leaf="">install</span></span><span><span leaf="">.</span></span><span><span leaf="">packages</span></span><span><span leaf="">(</span></span><span><span leaf="">"xx"</span></span><span><span leaf="">,</span></span><span><span leaf="">lib </span></span><span><span leaf="">=</span></span><span></span><span><span leaf="">"~/R/x86_64-pc-linux-gnu-library/4.4"</span></span><span><span leaf="">)</span></span></code></span></span></li></ol></pre><p><span leaf="">有一些用户的分析环境更加复杂，比如使用了conda环境里的R，就需要用户自行再根据其个人环境进行个性化修改，需要用户有较强的R包管理基础。</span></p><h3><span leaf="">问题描述</span></h3><p><span leaf="">用户在分析过程中，原先已经在个人目录下安装了 Seurat5 版本，且可以正常使用。现在分析需求要将Seurat 版本降低为 V4，需要重新安装R包，但是遇到问题，无论怎样，都无法降级R包 Seurat 至 V4 版本，报错截图：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaInAf7Vv8WSeMX6WUx2S6AIZGC7XkR1Sul8DUibib7sutuibDltRWTLdiaJg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.39945652173913043" data-type="png" data-w="736" data-imgfileid="100051297" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaInAf7Vv8WSeMX6WUx2S6AIZGC7XkR1Sul8DUibib7sutuibDltRWTLdiaJg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaI9tia9t9ibaMB2Tsjsgkk0icQLicdpWY7iaDWI1iagUP59qGJ6mnb1R1Us3wQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.13703703703703704" data-type="png" data-w="1080" data-imgfileid="100051298" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaI9tia9t9ibaMB2Tsjsgkk0icQLicdpWY7iaDWI1iagUP59qGJ6mnb1R1Us3wQ/640?wx_fmt=png&amp;from=appmsg"></section><h3><span leaf="">解决方法</span></h3><p><span leaf="">首先，用户原先 Seurat 版本为 5.2.0，用户前面 library(Seurat) 将其加载到环境中。然后remove之后，重装R包 Seurat V4 版本，再重新检测的时候，版本依然为 5.2。这是因为在该会话中，用户library Seurat V5 版本，已经加载到会话环境中，重装版本需要结束掉当前会话或者重启会话环境，才能将前面的R包缓存清空。重启会话的方法是：</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaI7596xbS1tof6OXLBqBdmbFO3czYlskJvMs1M83icw5Razsicibtxl0zZQ/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.5244897959183673" data-type="jpeg" data-w="490" data-backw="490" data-backh="257" data-imgfileid="100051299" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaI7596xbS1tof6OXLBqBdmbFO3czYlskJvMs1M83icw5Razsicibtxl0zZQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf="">之后再重新加载 Seurat 包，就可以发现版本已经修改为 V4</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIUznZm81e9y3LqyZgCLoiaIjJqw05W1aafcbLIlN6Rlcxwzu938FgE3w/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4331896551724138" data-type="png" data-w="464" data-backw="464" data-backh="201" data-imgfileid="100051301" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaIUznZm81e9y3LqyZgCLoiaIjJqw05W1aafcbLIlN6Rlcxwzu938FgE3w/640?wx_fmt=png&amp;from=appmsg"></section><h3><span leaf="">共享服务器</span></h3><p><font><span leaf="">如果你也需要共享服务器，详见： </span></font><font><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></font><font><span leaf="">福利抢购方式：</span></font></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaID6nDUnreS9Tw0Sse2OyUAFeaxHMGHZKovDZ3u2nazGo88sc7LWjtdg/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.7777777777777777" data-type="jpeg" data-w="1080" data-imgfileid="100051302" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Losicw8HZp9n1oYYgkNZzznaaID6nDUnreS9Tw0Sse2OyUAFeaxHMGHZKovDZ3u2nazGo88sc7LWjtdg/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><font><span leaf="">还等什么呢，赶快扫描下面二维码添加微信抢购吧！</span></font></p><hr><h4><font><span leaf="">文末友情宣传</span></font></h4><p><font><span leaf="">强烈建议你推荐给身边的</span></font><strong><font><span leaf="">博士后以及年轻生物学PI</span></font></strong><font><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></font></p><ul><li><span><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247541231&amp;idx=1&amp;sn=6704a3ae8233d19ca94fd4929b5e1f63&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课5月班</a></span><strong><font><span leaf="">，你的生物信息学入门课</span></font></strong></span></span></li><li><span><span><font><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247525079&amp;idx=1&amp;sn=0b997af16a58195b4192691373048fd5&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">时隔5年，我们的生信技能树VIP学徒继续招生啦</a></span></font></span></span></li><li><span><span><strong><font><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></font></strong></span></span></li></ul><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/nMvxtKva4qKllfQJ8owptQ",target="_blank" rel="noopener noreferrer">原文链接</a>
