---
title: "NCï½œå•ç»†èƒæµ‹åºç”Ÿä¿¡æ–‡ç« ï¼Œé‰´å®šå‡ºä¸€ç¾¤å…·æœ‰ II å‹å¹²æ‰°ç´ ç‰¹å¾çš„ CD8âºæ•ˆåº”è®°å¿† T ç»†èƒï¼Œçœ‹çœ‹æ˜¯æ€ä¹ˆå‘ç°çš„"
date: 2025-06-25T01:45:11Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡é’±åŒå­¦"
]
categories: ["Acdemic"]
---
NCï½œå•ç»†èƒæµ‹åºç”Ÿä¿¡æ–‡ç« ï¼Œé‰´å®šå‡ºä¸€ç¾¤å…·æœ‰ II å‹å¹²æ‰°ç´ ç‰¹å¾çš„ CD8âºæ•ˆåº”è®°å¿† T ç»†èƒï¼Œçœ‹çœ‹æ˜¯æ€ä¹ˆå‘ç°çš„ by ç”Ÿä¿¡é’±åŒå­¦
------
<div><section nodeleaf="" data-pm-slice="0 0 []"><mp-common-profile data-pluginname="mpprofile" data-nickname="ç”Ÿä¿¡é’±åŒå­¦" data-alias="sx_qtx" data-from="2" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFtcpBwtWKuVVVOibic8Mf7DibowIaY4jHoZ0RZUroB06EPAYGCf2SEthicyl7ATbtCRjCWJ7NoHYLG2oQ/0?wx_fmt=png" data-signature="åŒ—äº¬å¤§å­¦åœ¨è¯»åšå£«ç”Ÿï¼Œè®°å½•è‡ªå·±çš„å­¦ä¹ æ—¥å¸¸ğŸŒåˆ†äº«ç”Ÿä¿¡çŸ¥è¯†ï¼šå¦‚å•ç»†èƒå’Œç©ºé—´æµ‹åºã€å¤šç»„å­¦åˆ†æã€å®åŸºå› ç»„ã€ç—…ç†ç»„å­¦ã€å½±åƒç»„å­¦ç­‰ç”Ÿç‰©ä¿¡æ¯å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ å†…å®¹ğŸŒ¬" data-id="MzkwMzY2NjkwNg==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section><section nodeleaf=""><img data-imgfileid="100000054" data-ratio="0.8304597701149425" data-s="300,640" data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSDYiclWHXzARYMrQrK37WboobakSHx4iab0Nbv0YzhsyJsR52ZbZD9eWw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="696" type="block" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSDYiclWHXzARYMrQrK37WboobakSHx4iab0Nbv0YzhsyJsR52ZbZD9eWw/640?wx_fmt=jpeg&amp;from=appmsg"></section><h2 spellcheck="true" placeholder="æ ‡é¢˜ 1" data-content-editable-leaf="true" data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">ä»£ç éƒ¨åˆ†ğŸ‘†</span></span></span></h2><h2 spellcheck="true" placeholder="æ ‡é¢˜ 1" data-content-editable-leaf="true" data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">æ—¥æœ¬ç ”ç©¶å›¢é˜Ÿæ­ç¤ºç³»ç»Ÿæ€§ç¡¬åŒ–ç—‡ä¸´åºŠå¼‚è´¨æ€§èƒŒåçš„å…ç–«ç»†èƒå¼‚å¸¸</span></span></span></h2><p><span leaf=""><span textstyle="">è¿‘æ—¥ï¼Œæ¥è‡ªæ—¥æœ¬å¤§é˜ªå¤§å­¦ç­‰æœºæ„çš„ç ”ç©¶å›¢é˜Ÿåœ¨ã€Šè‡ªç„¶ãƒ»é€šè®¯ã€‹ï¼ˆ</span></span><span data-token-index="1"><span leaf=""><span textstyle="">Nature Communications</span></span></span><span leaf=""><span textstyle="">ï¼‰æ‚å¿—å‘è¡¨é‡è¦ç ”ç©¶æˆæœã€‚ä»–ä»¬é€šè¿‡å•ç»†èƒåˆ†æï¼Œæ­ç¤ºäº†ç³»ç»Ÿæ€§ç¡¬åŒ–ç—‡ï¼ˆSScï¼‰æ‚£è€…ä¸´åºŠå¼‚è´¨æ€§èƒŒåçš„å…ç–«ç»†èƒå¼‚å¸¸ï¼Œä¸ºç†è§£è¯¥ç–¾ç—…ä¸åŒå™¨å®˜å—ç´¯çš„æœºåˆ¶åŠå¼€å‘ä¸ªä½“åŒ–æ²»ç–—ç­–ç•¥æä¾›äº†æ€è·¯ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100000046" data-ratio="0.36574074074074076" data-s="300,640" data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSFR6ppyTekjf8fKBHgcRtAstEITnPNTk2K4cTQqaHwCtGDBCvacianMg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" type="block" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSFR6ppyTekjf8fKBHgcRtAstEITnPNTk2K4cTQqaHwCtGDBCvacianMg/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">ç ”ç©¶èƒŒæ™¯ï¼šç³»ç»Ÿæ€§ç¡¬åŒ–ç—‡çš„ä¸´åºŠæŒ‘æˆ˜</span></span></span></p><p><span data-token-index="0"><span leaf=""><span textstyle="">ç³»ç»Ÿæ€§ç¡¬åŒ–ç—‡æ˜¯ä¸€ç§å¤æ‚çš„è‡ªèº«å…ç–«æ€§ç–¾ç—…ï¼Œå…¨çƒçº¦æœ‰ 100 ä¸‡æ‚£è€…ã€‚é™¤äº†å…¸å‹çš„é›·è¯ºç°è±¡å’Œçš®è‚¤ç¡¬åŒ–å¤–ï¼Œæ‚£è€…å¸¸å‡ºç°å¤šç§å™¨å®˜å—ç´¯ï¼ŒåŒ…æ‹¬é—´è´¨æ€§è‚ºç—…ï¼ˆILDï¼‰ã€æŒ‡ç«¯æºƒç–¡ï¼Œç”šè‡³å±åŠç”Ÿå‘½çš„ç¡¬çš®ç—…è‚¾å±è±¡ï¼ˆSRCï¼‰ã€‚</span></span></span><span leaf=""><span textstyle="">è¿™äº›ä¸´åºŠå¼‚è´¨æ€§ç»™ç–¾ç—…ç®¡ç†å¸¦æ¥å·¨å¤§æŒ‘æˆ˜ï¼Œè€Œå…ç–«å¤±è°ƒé©±åŠ¨çš„è¡€ç®¡æŸä¼¤å’Œç»„ç»‡çº¤ç»´åŒ–æ˜¯å…¶æ ¸å¿ƒç—…ç†æœºåˆ¶ã€‚å°½ç®¡æ­¤å‰ç ”ç©¶å·²ä»ç—…å˜ç»„ç»‡è§’åº¦æ­ç¤ºäº†éƒ¨åˆ†ç—…ç†è¿‡ç¨‹ï¼Œä½†ä»å•ç»†èƒè½¬å½•ç»„æ°´å¹³ç†è§£å…ç–«ç»†èƒå¤šæ ·æ€§ä¸ç—‡çŠ¶å¤šæ ·æ€§çš„å…³è”ä»å­˜åœ¨ç©ºç™½ã€‚</span></span></p><section nodeleaf=""><img data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSek4wdDVeFia8S4KooYrCryiaaQ6nicwE4MyQHxnv1c4IYQ6OhRicW5ia4Ng/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.0574074074074074" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100000047" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSek4wdDVeFia8S4KooYrCryiaaQ6nicwE4MyQHxnv1c4IYQ6OhRicW5ia4Ng/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">ç ”ç©¶æ–¹æ³•ï¼šå•ç»†èƒæŠ€æœ¯è§£æå…ç–«æ™¯è§‚</span></span></span></p><p><span leaf=""><span textstyle="">ä¸ºæ¢ç´¢ SSc æ‚£è€…å…ç–«ç»†èƒäºšç¾¤çš„å˜åŒ–åŠå…¶ä¸ä¸´åºŠå¼‚è´¨æ€§çš„è”ç³»</span></span><span data-token-index="1"><span leaf=""><span textstyle="">ï¼Œç ”ç©¶å›¢é˜Ÿå¯¹ 21 åæœªæ¥å—è¿‡å…ç–«æŠ‘åˆ¶æ²»ç–—çš„ SSc æ‚£è€…åŠ 6 åå¥åº·å¯¹ç…§çš„å¤–å‘¨è¡€å•ä¸ªæ ¸ç»†èƒï¼ˆPBMCï¼‰è¿›è¡Œäº†å•ç»†èƒ RNA æµ‹åºï¼ˆscRNA-seqï¼‰å’Œç»†èƒè¡¨ä½æµ‹åºï¼ˆCITE-seqï¼‰ï¼ŒåŒæ—¶ç»“åˆç©ºé—´è½¬å½•ç»„å­¦åˆ†æäº† SRC æ‚£è€…çš„è‚¾è„ç»„ç»‡ã€‚è¯¥ç ”ç©¶å…±å¤„ç†äº† 238,924 ä¸ªç»†èƒï¼Œ</span></span></span><span leaf=""><span textstyle="">é€šè¿‡æ— ç›‘ç£åˆ†æå’Œå·®å¼‚ä¸°åº¦åˆ†æï¼Œé‰´å®šå‡ºä¸ç‰¹å®šå™¨å®˜å¹¶å‘ç—‡ç›¸å…³çš„å…ç–«ç»†èƒäºšç¾¤ã€‚</span></span></p><section nodeleaf=""><img data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS0rJ9DAqQKnuluFJtCpqNoTUicicXIyqHkCTGQlXX2Vk5EFqDh93Bz53A/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.7694444444444445" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100000048" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS0rJ9DAqQKnuluFJtCpqNoTUicicXIyqHkCTGQlXX2Vk5EFqDh93Bz53A/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">å…³é”®å‘ç°ä¸€ï¼šç¡¬çš®ç—…è‚¾å±è±¡ä¸­çš„å•æ ¸ç»†èƒå¼‚å¸¸</span></span></span></p><p><span data-token-index="0"><span leaf=""><span textstyle="">ç ”ç©¶å‘ç°ï¼ŒSRC æ‚£è€…å¤–å‘¨è¡€ä¸­å­˜åœ¨ä¸€ç¾¤ç‰¹å¼‚æ€§å¯Œé›†çš„ EGR1âº CD14âºå•æ ¸ç»†èƒã€‚è¿™ç±»ç»†èƒæ¿€æ´»äº† NF-ÎºB ä¿¡å·é€šè·¯ï¼Œå¹¶å¯åˆ†åŒ–ä¸ºæŸä¼¤ç»„ç»‡çš„å·¨å™¬ç»†èƒï¼Œåœ¨è‚¾è„æŸä¼¤éƒ¨ä½ç§¯èšã€‚è¿›ä¸€æ­¥åˆ†ææ˜¾ç¤ºï¼ŒEGR1âº CD14âºå•æ ¸ç»†èƒçš„æ¯”ä¾‹åœ¨ SRC æ‚£è€…ä¸­æ˜¾è‘—å‡é«˜ï¼Œä¸”å…¶è¡¨è¾¾çš„ EGR1 åŸºå› æ°´å¹³ä¸ SRC çš„ä¸´åºŠæŒ‡æ ‡ï¼ˆå¦‚æ”¹è‰¯ Rodnan çš®è‚¤è¯„åˆ†ã€æ”¶ç¼©å‹ï¼‰å‘ˆæ­£ç›¸å…³ã€‚</span></span></span><span leaf=""><span textstyle="">åœ¨ç–¾ç—…è¿›ç¨‹ä¸­ï¼ŒSRC å‘ä½œæ—¶å•æ ¸ç»†èƒ EGR1 è¡¨è¾¾æ˜¾è‘—ä¸Šè°ƒï¼Œæ²»ç–—æ”¹å–„åé™ä½ï¼Œæç¤ºå…¶å¯èƒ½ä½œä¸º SRC è¿›å±•çš„é¢„æµ‹ç”Ÿç‰©æ ‡å¿—ç‰©ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100000049" data-ratio="1.0777777777777777" data-s="300,640" data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSVe3VGvibVx7EPVthepYmJctlIseyv60VNfNnxA1jAyoyXl7k2tfQhicA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" type="block" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSVe3VGvibVx7EPVthepYmJctlIseyv60VNfNnxA1jAyoyXl7k2tfQhicA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf=""><span textstyle="">ç©ºé—´è½¬å½•ç»„å­¦åˆ†æå‘ç°ï¼ŒSRC æ‚£è€…è‚¾è„ç»„ç»‡ä¸­ THBS1âºå·¨å™¬ç»†èƒä¸å—æŸçš„è¿‘ç«¯å°ç®¡ç»†èƒç´§å¯†ç›¸é‚»ï¼Œè¿™äº›å·¨å™¬ç»†èƒé«˜è¡¨è¾¾ä¸è¡€ç®¡æŸä¼¤å’Œçº¤ç»´åŒ–ç›¸å…³çš„åŸºå› ï¼Œå¦‚ THBS1ã€IL1B å’Œ LRG1ã€‚è½¨è¿¹åˆ†æè¡¨æ˜ï¼Œå¤–å‘¨è¡€ä¸­çš„ EGR1âº CD14âºå•æ ¸ç»†èƒå¯åˆ†åŒ–ä¸ºè‚¾è„ä¸­çš„ THBS1âºå·¨å™¬ç»†èƒï¼Œé€šè¿‡æ¿€æ´» NF-ÎºB é€šè·¯å‚ä¸è‚¾ç»„ç»‡çº¤ç»´åŒ–å’ŒæŸä¼¤ã€‚</span></span></p><section nodeleaf=""><img data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSpibKfYIc22z17p0oZzKBX1kb4dwY6z6nk0scR1J48O01CtUd1sOm5NA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.15" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100000050" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSpibKfYIc22z17p0oZzKBX1kb4dwY6z6nk0scR1J48O01CtUd1sOm5NA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">å…³é”®å‘ç°äºŒï¼šé—´è´¨æ€§è‚ºç—…ä¸­çš„ T ç»†èƒå¼‚å¸¸</span></span></span></p><p><span data-token-index="0"><span leaf=""><span textstyle="">å¯¹äºè¿›å±•æ€§ ILD æ‚£è€…ï¼Œç ”ç©¶å›¢é˜Ÿåœ¨å…¶å¤–å‘¨è¡€å’Œè‚ºç»„ç»‡ä¸­é‰´å®šå‡ºä¸€ç¾¤å…·æœ‰</span></span></span><span data-token-index="1"><span leaf=""><span textstyle="">Â II å‹å¹²æ‰°ç´ ç‰¹å¾çš„ CD8âºæ•ˆåº”è®°å¿† T ç»†èƒï¼ˆCD8âº TEM_T2ISGï¼‰ã€‚è¿™ç±»ç»†èƒé«˜è¡¨è¾¾ CXCR3 å’Œ CCR5 ç­‰è¶‹åŒ–å› å­å—ä½“ï¼Œæç¤ºå…¶é€šè¿‡è¶‹åŒ–å› å­é©±åŠ¨çš„è¿ç§»å‚ä¸ ILD è¿›å±•ã€‚</span></span></span><span data-token-index="2"><span leaf=""><span textstyle="">åœ¨è‚ºç»„ç»‡ä¸­ï¼Œç±»ä¼¼çš„ CD8âº T ç»†èƒäºšç¾¤ï¼ˆCD8âº T_T2ISGï¼‰ä¹Ÿæ˜¾è‘—å¯Œé›†ï¼Œä¸”å…¶åŸºå› è¡¨è¾¾ç‰¹å¾ä¸å¤–å‘¨è¡€ä¸­çš„ CD8âº TEM_T2ISG é«˜åº¦ç›¸ä¼¼ã€‚</span></span></span></p><section nodeleaf=""><img data-imgfileid="100000051" data-ratio="0.8583333333333333" data-s="300,640" data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSc3xx3OaFicSIibH0YJYEAOPh4FOnvPDPiaOVWYR0eVqIr2pUTIhoCPYRw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" type="block" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSc3xx3OaFicSIibH0YJYEAOPh4FOnvPDPiaOVWYR0eVqIr2pUTIhoCPYRw/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">è¿›ä¸€æ­¥ç ”ç©¶æ˜¾ç¤ºï¼ŒæŠ—æ‹“æ‰‘å¼‚æ„é…¶ I æŠ—ä½“ï¼ˆATAï¼‰æˆ–æŠ— RNA èšåˆé…¶ III æŠ—ä½“ï¼ˆARAï¼‰é˜³æ€§çš„ ILD æ‚£è€…ä¸­ï¼ŒCD8âº TEM_T2ISG äºšç¾¤æ¯”ä¾‹æ›´é«˜ï¼Œè€Œè¿™ç±»æ‚£è€…çš„ ILD è¿›å±•é£é™©é€šå¸¸æ›´é«˜ã€‚è¿™è¡¨æ˜ CD8âº T ç»†èƒä»‹å¯¼çš„å…ç–«ååº”å¯èƒ½é€šè¿‡ IFN-Î³ ç›¸å…³é€šè·¯ä¿ƒè¿›è‚ºç»„ç»‡æŸä¼¤ï¼Œä¸ºç†è§£ ILD çš„è¿›å±•æœºåˆ¶æä¾›äº†æ–°çº¿ç´¢ã€‚</span></span></span></p><section nodeleaf=""><img data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSLCcYibOxNickhvNEBYpuyqj3Of0vs308K1nofVicyYic2VQjWuMCsqpiaQA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.2074074074074075" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100000052" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJSLCcYibOxNickhvNEBYpuyqj3Of0vs308K1nofVicyYic2VQjWuMCsqpiaQA/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmecoa.qpic.cn/mmecoa_png/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS1c7ibERBwxtdrKxXtqq2MkJ2vRRia0WUX6COQf4gzCEcu6uwsdBzw3Vg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.4601851851851852" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100000045" src="https://mmecoa.qpic.cn/mmecoa_png/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS1c7ibERBwxtdrKxXtqq2MkJ2vRRia0WUX6COQf4gzCEcu6uwsdBzw3Vg/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100000053" data-ratio="0.5518518518518518" data-s="300,640" data-src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS41o8R3JgicE3wAfWmdN2GxRdvbGaMxzxnDicLR9zt95UxsB9Ao9jNtxw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" type="block" src="https://mmecoa.qpic.cn/mmecoa_jpg/WSicobplxKJmfGUD9wdJKkoEqDPNOtNJS41o8R3JgicE3wAfWmdN2GxRdvbGaMxzxnDicLR9zt95UxsB9Ao9jNtxw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section><code><span leaf=""><br></span></code></section><section data-role="outer" label="Powered by 135editor.com onekey" data-pm-slice="0 0 []"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p><span leaf=""><span textstyle="">Shimagami, H., Nishimura, K., Matsushita, H. et al. Single-cell analysis reveals immune cell abnormalities underlying the clinical heterogeneity of patients with systemic sclerosis. Nat Commun 16, 4949 (2025).</span></span><span leaf=""><br></span></p><p data-brushtype="text" data-pm-slice="0 0 []"><strong><strong><strong><span leaf="">åè‹”â†©ï¸ä¹‹å‰è´´å­çš„å²¸å·å³å¯éœå¾—ä¹‹å‰çš„</span></strong></strong></strong></p><p data-brushtype="text"><strong><strong><strong><strong data-pm-slice="0 0 []"><span leaf="">ä»£ç ï¼Œä»Šæ—¥å…³é”®è¯ï¼š250625</span></strong></strong></strong></strong></p></section></section></section></section></section></section></section><section><span data-pm-slice="0 0 []"><span leaf="">CosMX spatial transcriptomic åˆ†æä»£ç </span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="ruby"><code><span leaf=""><span># åŠ è½½æ‰€éœ€çš„RåŒ…</span></span></code><code><span leaf="">library(<span>Seurat</span>) Â  Â  Â  Â  Â <span># å•ç»†èƒæ•°æ®åˆ†æçš„æ ¸å¿ƒåŒ…</span></span></code><code><span leaf="">library(cowplot) Â  Â  Â  Â Â <span># ç”¨äºç»„åˆå¤šä¸ªå›¾å½¢</span></span></code><code><span leaf="">library(dplyr) Â  Â  Â  Â  Â Â <span># æ•°æ®å¤„ç†å’Œæ“ä½œ</span></span></code><code><span leaf="">library(ggplot2) Â  Â  Â  Â Â <span># æ•°æ®å¯è§†åŒ–</span></span></code><code><span leaf="">library(<span>Polychrome</span>) Â  Â  Â <span># æä¾›æ›´å¤šé¢œè‰²é€‰æ‹©</span></span></code><code><span leaf="">library(patchwork) Â  Â  Â Â <span># å›¾å½¢æ‹¼æ¥</span></span></code><code><span leaf="">library(<span>BiocManager</span>) Â  Â Â <span># å®‰è£…BioconductoråŒ…</span></span></code><code><span leaf="">library(sctransform) Â  Â Â <span># å•ç»†èƒæ•°æ®æ ‡å‡†åŒ–</span></span></code><code><span leaf="">library(tidyverse) Â  Â  Â Â <span># æ•°æ®ç§‘å­¦å·¥å…·é›†åˆ</span></span></code><code><span leaf="">library(hdf5r) Â  Â  Â  Â  Â Â <span># å¤„ç†HDF5æ ¼å¼æ–‡ä»¶</span></span></code><code><span leaf="">library(glmGamPoi) Â  Â  Â Â <span># å¹¿ä¹‰çº¿æ€§æ¨¡å‹åˆ†æ</span></span></code><code><span leaf="">library(<span>SeuratDisk</span>) Â  Â  Â <span># Seuratå¯¹è±¡æ ¼å¼è½¬æ¢</span></span></code><code><span leaf="">library(scran) Â  Â  Â  Â  Â Â <span># å•ç»†èƒRNA-seqåˆ†æ</span></span></code><code><span leaf="">library(future) Â  Â  Â  Â  Â <span># å¹¶è¡Œè®¡ç®—</span></span></code><code><span leaf="">library(data.table) Â  Â  Â <span># é«˜æ•ˆæ•°æ®å¤„ç†</span></span></code><code><span leaf="">library(tidyr) Â  Â  Â  Â  Â Â <span># æ•°æ®æ•´ç†</span></span></code><code><span leaf="">library(gplots) Â  Â  Â  Â  Â <span># å›¾å½¢ç»˜åˆ¶</span></span></code><code><span leaf="">library(dbscan) Â  Â  Â  Â  Â <span># å¯†åº¦èšç±»åˆ†æ</span></span></code><code><span leaf="">library(scclusteval) Â  Â Â <span># å•ç»†èƒèšç±»è¯„ä¼°</span></span></code><code><span leaf="">library(<span>ComplexHeatmap</span>) Â <span># å¤æ‚çƒ­å›¾ç»˜åˆ¶</span></span></code><code><span leaf=""><span># --------------------------- æ•°æ®è¯»å–ä¸Seuratå¯¹è±¡åˆ›å»º ---------------------------</span></span></code><code><span leaf=""><span># è¯»å–SSc1è¡¨è¾¾çŸ©é˜µæ•°æ®</span></span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"SSc1_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf=""><span># è®¾ç½®è¡Œåä¸ºç¬¬ä¸€åˆ—</span></span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf=""><span># æå–ç¬¬4åˆ—åˆ°1003åˆ—ä½œä¸ºè¡¨è¾¾çŸ©é˜µ</span></span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf=""><span># åˆ›å»ºSeuratå¯¹è±¡ï¼Œè½¬ç½®è¡¨è¾¾çŸ©é˜µä½œä¸ºè®¡æ•°æ•°æ®</span></span></code><code><span leaf="">s1 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf=""><span># è¯»å–å…ƒæ•°æ®</span></span></code><code><span leaf="">metadata &lt;- read.csv(<span>"SSc1_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf=""><span># åŒ¹é…Seuratå¯¹è±¡ä¸­çš„ç»†èƒä¸å…ƒæ•°æ®</span></span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s1), rownames(metadata)), ]</span></code><code><span leaf=""><span># å‘Seuratå¯¹è±¡æ·»åŠ å…ƒæ•°æ®</span></span></code><code><span leaf="">s1 &lt;-Â <span>AddMetaData</span>(s1, metadata = matching_metadata)</span></code><code><span leaf=""><span># æå–å…ƒæ•°æ®</span></span></code><code><span leaf="">metadata &lt;- s1<span>@meta</span>.data</span></code><code><span leaf=""><span># é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œå¤„ç†SSc2ã€SSc3ã€HD1ã€HD2ã€HD3æ•°æ®</span></span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"SSc2_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf="">s2 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf="">metadata &lt;- read.csv(<span>"SSc2_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s2), rownames(metadata)), ]</span></code><code><span leaf="">s2 &lt;-Â <span>AddMetaData</span>(s2, metadata = matching_metadata)</span></code><code><span leaf="">metadata &lt;- s2<span>@meta</span>.data</span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"SSc3_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf="">s3 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf="">metadata &lt;- read.csv(<span>"SSc3_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s3), rownames(metadata)), ]</span></code><code><span leaf="">s3 &lt;-Â <span>AddMetaData</span>(s3, metadata = matching_metadata)</span></code><code><span leaf="">metadata &lt;- s3<span>@meta</span>.data</span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"HD1_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf="">s4 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf="">metadata &lt;- read.csv(<span>"HD1_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s4), rownames(metadata)), ]</span></code><code><span leaf="">s4 &lt;-Â <span>AddMetaData</span>(s4, metadata = matching_metadata)</span></code><code><span leaf="">metadata &lt;- s4<span>@meta</span>.data</span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"HD2_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf="">s5 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf="">metadata &lt;- read.csv(<span>"HD2_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s5), rownames(metadata)), ]</span></code><code><span leaf="">s5 &lt;-Â <span>AddMetaData</span>(s5, metadata = matching_metadata)</span></code><code><span leaf="">metadata &lt;- s5<span>@meta</span>.data</span></code><code><span leaf="">expr_data &lt;- read.csv(<span>"HD3_exprMat_data.csv"</span>, header =Â <span>TRUE</span>)</span></code><code><span leaf="">rownames(expr_data) &lt;- expr_data[,Â <span>1</span>]</span></code><code><span leaf="">expr_matrix &lt;- expr_data[,Â <span>4</span><span>:</span><span>1003</span>]</span></code><code><span leaf="">s6 &lt;-Â <span>CreateSeuratObject</span>(counts = t(expr_matrix), assay =Â <span>"RNA"</span>)</span></code><code><span leaf="">metadata &lt;- read.csv(<span>"HD3_metadata_data.csv"</span>, row.names =Â <span>1</span>)</span></code><code><span leaf="">matching_metadata &lt;- metadata[match(<span>Cells</span>(s6), rownames(metadata)), ]</span></code><code><span leaf="">s6 &lt;-Â <span>AddMetaData</span>(s6, metadata = matching_metadata)</span></code><code><span leaf="">metadata &lt;- s6<span>@meta</span>.data</span></code><code><span leaf=""><span># --------------------------- ä¸ºæ ·æœ¬æ·»åŠ æ ‡ç­¾ ---------------------------</span></span></code><code><span leaf=""><span># ä¸ºæ¯ä¸ªSeuratå¯¹è±¡æ·»åŠ æ ·æœ¬æ ‡ç­¾</span></span></code><code><span leaf="">s1<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"SSc1"</span></span></code><code><span leaf="">s2<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"SSc2"</span></span></code><code><span leaf="">s3<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"SSc3"</span></span></code><code><span leaf="">s4<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"HD1"</span></span></code><code><span leaf="">s5<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"HD2"</span></span></code><code><span leaf="">s6<span>@meta</span>.data<span>$sample</span>Â &lt;-Â <span>"HD3"</span></span></code><code><span leaf=""><span># ä¸ºæ¯ä¸ªSeuratå¯¹è±¡æ·»åŠ ç–¾ç—…æ ‡ç­¾ï¼ˆSRCæˆ–HDï¼‰</span></span></code><code><span leaf="">s1<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"SRC"</span></span></code><code><span leaf="">s2<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"SRC"</span></span></code><code><span leaf="">s3<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"SRC"</span></span></code><code><span leaf="">s4<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"HD"</span></span></code><code><span leaf="">s5<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"HD"</span></span></code><code><span leaf="">s6<span>@meta</span>.data<span>$disease</span>Â &lt;-Â <span>"HD"</span></span></code><code><span leaf=""><span># ä¸ºæ¯ä¸ªSeuratå¯¹è±¡æ·»åŠ ç¼–å·</span></span></code><code><span leaf="">s1<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>1</span></span></code><code><span leaf="">s2<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>2</span></span></code><code><span leaf="">s3<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>3</span></span></code><code><span leaf="">s4<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>4</span></span></code><code><span leaf="">s5<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>5</span></span></code><code><span leaf="">s6<span>@meta</span>.data<span>$number</span>Â &lt;-Â <span>6</span></span></code><code><span leaf=""><span># --------------------------- è°ƒæ•´ç»†èƒåæ ‡ä»¥åŒºåˆ†ä¸åŒæ ·æœ¬ ---------------------------</span></span></code><code><span leaf=""><span># ä¸ºé¿å…ä¸åŒæ ·æœ¬çš„ç»†èƒåœ¨é‚»è¿‘åˆ†æä¸­è¢«è¯†åˆ«ä¸ºé‚»å±…ï¼Œ</span></span></code><code><span leaf=""><span># ç»™æ¯ä¸ªæ ·æœ¬çš„ç»†èƒxå’Œyåæ ‡åŠ ä¸Šnumber*1000ï¼ˆè¶³å¤Ÿå¤§çš„æ•°ï¼‰</span></span></code><code><span leaf="">s1<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s1<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s1<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s1<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s1<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s1<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s2<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s2<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s2<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s2<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s2<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s2<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s3<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s3<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s3<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s3<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s3<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s3<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s4<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s4<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s4<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s4<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s4<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s4<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s5<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s5<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s5<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s5<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s5<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s5<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s6<span>@meta</span>.data<span>$x_slide_mm</span>Â &lt;- s6<span>@meta</span>.data<span>$x_slide_mm</span>Â + (s6<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf="">s6<span>@meta</span>.data<span>$y_slide_mm</span>Â &lt;- s6<span>@meta</span>.data<span>$y_slide_mm</span>Â + (s6<span>@meta</span>.data<span>$number</span>Â *Â <span>1000</span>)</span></code><code><span leaf=""><span># --------------------------- è´¨é‡æ§åˆ¶ ---------------------------</span></span></code><code><span leaf=""><span># ç­›é€‰æ‰è´¨é‡æ§åˆ¶æ ‡è®°ä¸ºä¸åˆæ ¼çš„ç»†èƒ</span></span></code><code><span leaf="">s1 &lt;- subset(s1, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf="">s2 &lt;- subset(s2, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf="">s3 &lt;- subset(s3, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf="">s4 &lt;- subset(s4, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf="">s5 &lt;- subset(s5, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf="">s6 &lt;- subset(s6, subset = qcCellsFlagged ==Â <span>FALSE</span>)</span></code><code><span leaf=""><span># --------------------------- åŸºäºç»†èƒé¢ç§¯çš„æ•°æ®æ ‡å‡†åŒ– ---------------------------</span></span></code><code><span leaf=""><span># è®¡ç®—æ¯ä¸ªæ ·æœ¬ç»†èƒé¢ç§¯çš„ä¸­ä½æ•°</span></span></code><code><span leaf="">median_value &lt;- median(s1<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf=""><span># è®¡ç®—é¢ç§¯å› å­ï¼ˆç»†èƒé¢ç§¯/ä¸­ä½æ•°ï¼‰</span></span></code><code><span leaf="">s1<span>$Area</span>.um2_factor &lt;- s1<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf=""><span># è·å–åŸå§‹è®¡æ•°çŸ©é˜µ</span></span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s1, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf=""><span># ç”¨é¢ç§¯å› å­æ ‡å‡†åŒ–è®¡æ•°çŸ©é˜µ</span></span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s1<span>$Area</span>.um2_factor</span></code><code><span leaf=""><span># å°†æ ‡å‡†åŒ–åçš„è®¡æ•°çŸ©é˜µè®¾ç½®ä¸ºSeuratå¯¹è±¡çš„è®¡æ•°æ•°æ®</span></span></code><code><span leaf="">s1 &lt;-Â <span>SetAssayData</span>(object = s1, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf=""><span># é‡å¤ä¸Šè¿°æ ‡å‡†åŒ–æ­¥éª¤ï¼Œå¤„ç†s2åˆ°s6</span></span></code><code><span leaf="">median_value &lt;- median(s2<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf="">s2<span>$Area</span>.um2_factor &lt;- s2<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s2, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s2<span>$Area</span>.um2_factor</span></code><code><span leaf="">s2 &lt;-Â <span>SetAssayData</span>(object = s2, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf="">median_value &lt;- median(s3<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf="">s3<span>$Area</span>.um2_factor &lt;- s3<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s3, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s3<span>$Area</span>.um2_factor</span></code><code><span leaf="">s3 &lt;-Â <span>SetAssayData</span>(object = s3, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf="">median_value &lt;- median(s4<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf="">s4<span>$Area</span>.um2_factor &lt;- s4<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s4, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s4<span>$Area</span>.um2_factor</span></code><code><span leaf="">s4 &lt;-Â <span>SetAssayData</span>(object = s4, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf="">median_value &lt;- median(s5<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf="">s5<span>$Area</span>.um2_factor &lt;- s5<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s5, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s5<span>$Area</span>.um2_factor</span></code><code><span leaf="">s5 &lt;-Â <span>SetAssayData</span>(object = s5, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf="">median_value &lt;- median(s6<span>@meta</span>.data<span>$Area</span>.um2, na.rm =Â <span>TRUE</span>)</span></code><code><span leaf="">s6<span>$Area</span>.um2_factor &lt;- s6<span>@meta</span>.data<span>$Area</span>.um2 / median_value</span></code><code><span leaf="">counts_matrix &lt;-Â <span>GetAssayData</span>(s6, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>)</span></code><code><span leaf="">new_counts_matrix &lt;- counts_matrix / s6<span>$Area</span>.um2_factor</span></code><code><span leaf="">s6 &lt;-Â <span>SetAssayData</span>(object = s6, assay =Â <span>"RNA"</span>, layer =Â <span>"counts"</span>, new.data = new_counts_matrix)</span></code><code><span leaf=""><span># --------------------------- æ•°æ®æ•´åˆä¸åˆ†æ ---------------------------</span></span></code><code><span leaf=""><span># åˆå¹¶æ‰€æœ‰Seuratå¯¹è±¡</span></span></code><code><span leaf="">s.int_layer &lt;- merge(s1, y = c(s2, s3, s4, s5, s6))</span></code><code><span leaf=""><span># æ•°æ®æ ‡å‡†åŒ–</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>NormalizeData</span>(s.int_layer)</span></code><code><span leaf=""><span># è·å–æ‰€æœ‰åŸºå› åç§°</span></span></code><code><span leaf="">all.genes &lt;- rownames(s.int_layer)</span></code><code><span leaf=""><span># æ•°æ®ç¼©æ”¾</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>ScaleData</span>(s.int_layer, features = all.genes)</span></code><code><span leaf=""><span># è¿è¡Œä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ï¼Œä½¿ç”¨30ä¸ªä¸»æˆåˆ†</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>Run</span>PCA(s.int_layer, npcs =Â <span>30</span>, features = all.genes)</span></code><code><span leaf=""><span># è®¾ç½®æœªæ¥è®¡ç®—çš„å…¨å±€æœ€å¤§å†…å­˜ï¼ˆ15GBï¼‰</span></span></code><code><span leaf="">options(future.globals.maxSize =Â <span>15</span>Â *Â <span>1024</span>^<span>3</span>)</span></code><code><span leaf=""><span># åƒåœ¾å›æ”¶</span></span></code><code><span leaf="">gc()</span></code><code><span leaf=""><span># ä½¿ç”¨CCAæ–¹æ³•æ•´åˆæ•°æ®å±‚</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>IntegrateLayers</span>(</span></code><code><span leaf="">Â  object = s.int_layer, method =Â <span>CCAIntegration</span>,</span></code><code><span leaf="">Â  orig.reduction =Â <span>"pca"</span>, features = all.genes, new.reduction =Â <span>"integrated.CCA"</span>,</span></code><code><span leaf="">Â  verbose =Â <span>FALSE</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><span># æŸ¥æ‰¾é‚»å±…ç»†èƒï¼ŒåŸºäºæ•´åˆåçš„é™ç»´ç»“æœ</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>FindNeighbors</span>(s.int_layer, reduction =Â <span>"integrated.CCA"</span>, dims =Â <span>1</span><span>:</span><span>30</span>)</span></code><code><span leaf=""><span># ç»†èƒèšç±»ï¼Œåˆ†è¾¨ç‡è®¾ä¸º0.9</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>FindClusters</span>(s.int_layer, resolution =Â <span>0.9</span>)</span></code><code><span leaf=""><span># è¿è¡ŒUMAPé™ç»´ï¼ŒåŸºäºæ•´åˆåçš„ä¸»æˆåˆ†</span></span></code><code><span leaf="">s.int_layer &lt;-Â <span>Run</span>UMAP(s.int_layer, reduction =Â <span>"integrated.CCA"</span>, dims =Â <span>1</span><span>:</span><span>30</span>, reduction.name =Â <span>"umap.CCA"</span>)</span></code><code><span leaf=""><span># --------------------------- é«“ç³»ç»†èƒäºšç¾¤åˆ†æ ---------------------------</span></span></code><code><span leaf=""><span># ç­›é€‰å‡ºé«“ç³»ç»†èƒç¾¤ï¼ˆç°‡8ï¼‰</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;- subset(s.int_layer, ident = c(<span>"8"</span>))</span></code><code><span leaf=""><span># æ•°æ®ç¼©æ”¾</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;-Â <span>ScaleData</span>(<span>Mo</span>, features = all.genes)</span></code><code><span leaf=""><span># è¿è¡ŒPCA</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;-Â <span>Run</span>PCA(<span>Mo</span>, npcs =Â <span>30</span>, features = all.genes)</span></code><code><span leaf=""><span># è¿è¡ŒUMAPé™ç»´</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;-Â <span>Run</span>UMAP(<span>Mo</span>, reduction =Â <span>"pca"</span>, dims =Â <span>1</span><span>:</span><span>30</span>)</span></code><code><span leaf=""><span># æŸ¥æ‰¾é‚»å±…ç»†èƒ</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;-Â <span>FindNeighbors</span>(<span>Mo</span>, reduction =Â <span>"pca"</span>, dims =Â <span>1</span><span>:</span><span>30</span>)</span></code><code><span leaf=""><span># ç»†èƒèšç±»ï¼Œåˆ†è¾¨ç‡è®¾ä¸º0.2</span></span></code><code><span leaf=""><span>Mo</span>Â &lt;-Â <span>FindClusters</span>(<span>Mo</span>, resolution =Â <span>0.2</span>)</span></code><code><span leaf=""><span># --------------------------- ç»†èƒé‚»è¿‘åˆ†æ ---------------------------</span></span></code><code><span leaf=""><span># å°†æ¯ä¸ªç»†èƒçš„æ³¨é‡Šä¿¡æ¯å­˜å‚¨ä¸º"seurat_clusters2"å…ƒæ•°æ®</span></span></code><code><span leaf="">s.int_layer2 &lt;- subset(s.int_layer, subset = disease ==Â <span>"SRC"</span>)</span></code><code><span leaf=""><span># è·å–ç»†èƒçš„xå’Œyåæ ‡ï¼ˆç¬¬88å’Œ89åˆ—ï¼‰</span></span></code><code><span leaf="">mat &lt;- s.int_layer2<span>@meta</span>.data[,Â <span>88</span><span>:</span><span>89</span>]</span></code><code><span leaf=""><span># è½¬æ¢ä¸ºçŸ©é˜µ</span></span></code><code><span leaf="">mat &lt;- as.matrix(mat)</span></code><code><span leaf=""><span># è®¾ç½®é‚»åŸŸåŠå¾„</span></span></code><code><span leaf="">eps &lt;-Â <span>0.03</span></span></code><code><span leaf=""><span># ä½¿ç”¨frNNå‡½æ•°æŸ¥æ‰¾æ¯ä¸ªç»†èƒçš„é‚»å±…</span></span></code><code><span leaf="">nn &lt;- frNN(x = mat, eps = eps)</span></code><code><span leaf=""><span># æŸ¥çœ‹å‰3ä¸ªç»†èƒçš„é‚»å±…ID</span></span></code><code><span leaf="">nn<span>$id</span>Â %&gt;% head(n =Â <span>3</span>)</span></code><code><span leaf=""><span># å°†é‚»å±…IDè½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf="">nn_df &lt;- nn<span>$id</span>Â %&gt;% stack()</span></code><code><span leaf=""><span># è·å–æ¯ä¸ªç»†èƒçš„ç°‡ID</span></span></code><code><span leaf="">cluster_ids &lt;- s.int_layer2<span>$seurat_clusters2</span>Â %&gt;% unname()</span></code><code><span leaf=""><span># ä¸ºé‚»å±…æ•°æ®æ¡†æ·»åŠ ç°‡ID</span></span></code><code><span leaf="">nn_df<span>$cluster_id</span>Â &lt;- cluster_ids[nn_df<span>$values</span>]</span></code><code><span leaf=""><span># è½¬æ¢ç°‡IDä¸ºå› å­</span></span></code><code><span leaf="">nn_df<span>$cluster_id</span>Â &lt;- factor(nn_df<span>$cluster_id</span>)</span></code><code><span leaf=""><span># è½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf="">nn_df &lt;- as.data.frame(nn_df)</span></code><code><span leaf=""><span># è½¬æ¢ç°‡IDå’Œç´¢å¼•ä¸ºå‘é‡</span></span></code><code><span leaf="">nn_df<span>$cluster_id</span>Â &lt;- unlist(nn_df<span>$cluster_id</span>)</span></code><code><span leaf="">nn_df<span>$ind</span>Â &lt;- unlist(nn_df<span>$ind</span>)</span></code><code><span leaf="">nn_df<span>$values</span>Â &lt;- unlist(nn_df<span>$values</span>)</span></code><code><span leaf="">nn_df<span>$cluster_id</span>Â &lt;- as.vector(unlist(nn_df<span>$cluster_id</span>))</span></code><code><span leaf="">nn_df<span>$ind</span>Â &lt;- as.vector(unlist(nn_df<span>$ind</span>))</span></code><code><span leaf="">nn_df &lt;- as.data.frame(nn_df)</span></code><code><span leaf=""><span># æŒ‰ç»†èƒå’Œç°‡åˆ†ç»„ï¼Œè®¡ç®—æ¯ä¸ªç°‡ä¸­é‚»å±…çš„æ•°é‡</span></span></code><code><span leaf="">nn_count &lt;- nn_df %&gt;%</span></code><code><span leaf="">Â  group_by(ind, cluster_id) %&gt;%</span></code><code><span leaf="">Â  summarize(n = n(), .groups =Â <span>"drop"</span>)</span></code><code><span leaf=""><span># è½¬æ¢ä¸ºå®½æ ¼å¼</span></span></code><code><span leaf="">nn_count &lt;- nn_count %&gt;%</span></code><code><span leaf="">Â  tidyr::pivot_wider(names_from = cluster_id, values_from = n)</span></code><code><span leaf=""><span># æå–é‚»å±…æ•°é‡çŸ©é˜µ</span></span></code><code><span leaf="">nn_mat &lt;- nn_count[,-<span>1</span>] %&gt;% as.matrix()</span></code><code><span leaf=""><span># è®¾ç½®çŸ©é˜µè¡Œå</span></span></code><code><span leaf="">rownames(nn_mat) &lt;- nn_count<span>$ind</span></span></code><code><span leaf=""><span># å°†NAå€¼è®¾ä¸º0</span></span></code><code><span leaf="">nn_mat[is.na(nn_mat)] &lt;-Â <span>0</span></span></code><code><span leaf=""><span># è¿è¡Œk-meansèšç±»ï¼Œåˆ†ä¸º9ä¸ªä¸­å¿ƒ</span></span></code><code><span leaf="">k_means_res &lt;- kmeans(nn_mat, centers =Â <span>9</span>)</span></code><code><span leaf=""><span># å°†èšç±»ç»“æœè½¬æ¢ä¸ºæ•°æ®æ¡†</span></span></code><code><span leaf="">k_means_id &lt;- k_means_res<span>$cluster</span>Â %&gt;%</span></code><code><span leaf="">Â  tibble::enframe(name =Â <span>"cell_id"</span>, value =Â <span>"kmeans_cluster"</span>)</span></code><code><span leaf=""><span># æŸ¥çœ‹å‰å‡ è¡Œ</span></span></code><code><span leaf="">head(k_means_id)</span></code><code><span leaf="">k_means_df &lt;- as.data.frame(k_means_id)</span></code><code><span leaf="">rownames(k_means_df) &lt;- k_means_id<span>$cell_id</span></span></code><code><span leaf=""><span># åˆ›å»ºSeuratå¯¹è±¡ç”¨äºé‚»è¿‘åˆ†æ</span></span></code><code><span leaf="">nn_obj &lt;-Â <span>CreateSeuratObject</span>(counts = t(nn_mat), Â min.features =Â <span>5</span>)</span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/f0R1-79ovnqfS9kcwuDG6Q",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
