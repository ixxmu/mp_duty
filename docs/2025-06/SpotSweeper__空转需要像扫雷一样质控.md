---
title: "SpotSweeper🧹：空转需要像扫雷一样质控"
date: 2025-06-25T01:49:05Z
draft: ["false"]
tags: [
  "fetched",
  "AI4Omic"
]
categories: ["Acdemic"]
---
SpotSweeper🧹：空转需要像扫雷一样质控 by AI4Omic
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []" data-mpa-action-id="mcafmawdg8z"><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []" data-mpa-action-id="mcag8tn0fn0"><p data-tool="mdnice编辑器" mpa-font-style="mcag8zyfr0u" data-mpa-action-id="mcag8zyr1846" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">引言💬</span></span></p><p data-tool="mdnice编辑器"><span leaf="" data-mpa-action-id="mcag8tmjpq7">空间转录组技术（Spatial Transcriptomics, SRT）自问世以来，极大地拓展了我们对组织结构与基因表达关系的理解。尤其是在肿瘤、神经、发育等复杂组织中，空间背景下的转录组数据揭示了诸如细胞异质性、组织微环境以及空间信号通路等全新生物学问题。然而，在享受SRT带来的空间分辨率红利时，我们也面临一个关键的基础问题：<span textstyle="">如何有效进行质量控制（Quality Control, QC），以剔除低质量数据点、识别组织损伤区域，从而保障后续分析结果的可靠性与可解释性？</span></span></p><p data-tool="mdnice编辑器"><span leaf="">长期以来，空间转录组数据的质控流程借用了单细胞RNA测序（sc/snRNA-seq）领域的方法，如通过文库大小、基因数、线粒体基因比例等指标设定固定阈值进行筛选，或者使用miQC等统计建模方法。这些方法在细胞水平下取得了一定成功，但并不适用于具有空间属性的SRT数据。其核心问题在于：组织内本身存在天然的空间表达异质性，不同空间域（如灰质/白质、肿瘤/间质）在表达量、线粒体比例上存在系统差异——<span textstyle="">这些差异不是“坏数据”，却往往被传统QC方法误判，从而误删了有生物学意义的区域信息</span>。</span></p><p data-tool="mdnice编辑器"><span leaf="">面对这一挑战，来自约翰霍普金斯大学的Michael Totty、Stephanie C. Hicks与Boyi Guo团队在2025年发表于《Nature Methods》的一项研究中，提出了首个面向空间转录组的空间感知质控方法——SpotSweeper。这一工具不仅<span textstyle="">重新定义了什么是“异常数据点”，更首次引入了区域级伪差（regional artifacts）检测机制，可自动识别因渗透不均或取样损伤导致的大面积组织异常区域，从而为SRT数据分析提供了更精准的前处理手段</span>。</span></p><p data-tool="mdnice编辑器"><span leaf="" data-mpa-action-id="mcag8tmj15e7">本篇推文将结合原文图示，从方法原理、技术优势、应用实例与图表解读四大方面，带你深入理解SpotSweeper背后的空间生信逻辑，并探讨其在多种组织和空间平台中的适用性。</span></p></section><p data-tool="mdnice编辑器" mpa-font-style="mcafo22m15w3" data-mpa-action-id="mcafo22w1igx" data-pm-slice="0 0 []"><span leaf="" data-mpa-action-id="mcafmavp2hq"><span textstyle="">方法</span></span><span leaf="" data-mpa-action-id="mcafmavp2hq"><span textstyle="">论解析</span></span></p><p data-tool="mdnice编辑器"><span leaf="">SpotSweeper的核心思想是<span textstyle="">将每个测序点（spot）的质量评估限制在其空间邻域内，从而减少组织内本底生物异质性对QC的干扰</span>。具体地，<span textstyle="">对于每个spot，首先基于空间坐标选择其</span></span><span data-formula="k"><span data-formula="k"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 521 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g></g></svg></span></span><span leaf=""><span textstyle="">个最近邻（</span></span><span data-formula="k"><span data-formula="k"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 521 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g></g></svg></span></span><span leaf=""><span textstyle="">-NN），构建局部邻域。然后针对常用QC指标（如文库大小、检测到的基因数、线粒体基因比例等），计算稳健z-score：即用邻域中这些指标的中位数和MAD（中位数绝对偏差）进行归一化</span>。通过添加0.675的缩放系数使MAD可比于标准差，SpotSweeper得到的局部z-score与标准正态分布等价，可用统一阈值筛选。若某spot的z-score偏离均值超过3倍标准差（如文库大小偏小或线粒体比例偏大），则视为局部异常点待剔除。<span textstyle="">相比于全局阈值方法，这种基于邻域的计算能够自适应地控制各空间域间的自然差异，保留更多真实的高质量spots</span>。</span></p><section nodeleaf="" data-mpa-action-id="mcafxblm2bz" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXkvFiaxpmpZKJ4z0TJCHcyH4ibCB3sW7OK7lRgFXE3rD5LUl97QvhlCvA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0880503144654088" data-s="300,640" data-type="png" data-w="1590" type="block" data-imgfileid="100004179" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXkvFiaxpmpZKJ4z0TJCHcyH4ibCB3sW7OK7lRgFXE3rD5LUl97QvhlCvA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器" data-mpa-action-id="mcafps4khyw" data-pm-slice="0 0 []"><span mpa-font-style="mcafps461z5v"><span leaf="" data-mpa-action-id="mcafps46i6j"><span textstyle="">图1展示</span></span><span leaf="" data-mpa-action-id="mcafps46i6j"><span textstyle="">了SpotSweeper方法的整体流程</span>。图中(a)通过</span><span data-formula="k"><span data-formula="k"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 521 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g><g></g></svg></span></span><span leaf="" data-mpa-action-id="mcafps461trn">-NN邻域识别出低质量spot和区域伪差；与传统方法相比，SpotSweeper具有(b)对空间域差异不敏感、(c)保留更多高质量spot、(d)准确检测局部异常点和(e)可检测区域性损伤的优点。在识别区域伪差方面，SpotSweeper引入了<span textstyle="">多尺度方差模型</span>：<span textstyle="">对于每个spot，逐步计算多个不同邻域大小下</span></span><span leaf="" data-mpa-action-id="mcafps461trn"><span textstyle="">该点附近线粒体基因比例的方差，再通过稳健回归校正平均方差-均值关系，取回归残差作为校正后的局部方差。对所有尺度的局部方差进行主成分分析，再在前两主成分上采用K均值聚类，可有效将受损区域（如渗透不均导致的大片低信号区或组织损伤区）与正常组织区分开</span>。这种多尺度策略捕捉不同空间范围的伪差特征，显著增强了SpotSweeper识别区域性技术伪差的能力。</span></span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">技术对比</span></span></p><p data-tool="mdnice编辑器"><span leaf="">与常用的全局QC方法相比，SpotSweeper表现出明显优势。传统QC通常使用固定阈值或基于中位数绝对偏差(MAD)的全局阈值来筛选低质量点，<span textstyle="">但这些方法会忽略空间域间的生物学差异</span>，导致偏倚性剔除。<span textstyle="">例如在人脑皮层数据中，富细胞层（L2–L6）本底转录本丰富，而神经纤维层（L1、白质）天然转录本少、线粒体比例高。固定全局阈值会片面标记这些区域为低质量，剔除了大量有效数据</span>。图2中直观呈现了这一现象：面板B显示使用固定阈值方法时，低质spots集中分布于L1/WM等区域；而面板C（SpotSweeper结果）中，标记为低质量的spots遍布各层，更加均匀。</span></p><section nodeleaf="" data-mpa-action-id="mcafzjgv48n" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXjKGINIawQiboVCerM9crtVfo7YpPwxy6WruCumL7fwHEM3MNgB6Pedg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9233668341708543" data-s="300,640" data-type="png" data-w="1592" type="block" data-imgfileid="100004180" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXjKGINIawQiboVCerM9crtVfo7YpPwxy6WruCumL7fwHEM3MNgB6Pedg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">图2对比了SpotSweeper与传统QC在同一样本上的表现</span>。左图(a)为脑组织层次结构示意；(b-c)分图展示了检测到的基因数与筛除的低质量spot（红点）：采用固定阈值时(global)偏向标记L1/WM低信号区(b)，而SpotSweeper检测的是局部异常点(c)。随后的分布图(d-g)和箱线图(h,l)进一步显示：SpotSweeper通过基于局部z-score的归一化，使各层QC指标分布一致(见(i-k))，不同层间低质spots剔除率趋于一致。定量上，固定阈值方法导致L1、L3、WM剔除spots分别达到9.34%、4.70%和9.74%；而SpotSweeper对应剔除率仅为0.21%、0.28%和0.40%，极大地保留了原有高质量数据。此外，与MAD等方法相比，SpotSweeper同样显著降低了QC偏倚。这些结果表明，SpotSweeper的局部统计方法在控制不同组织区域差异方面更为稳健，有效提高了空间转录组QC的准确性。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">应用案例</span></span></p><p data-tool="mdnice编辑器"><span leaf="">SpotSweeper已在多种组织和技术平台的数据集中得到了验证，显示出良好的通用性。以人脑皮层（DLPFC）为例，SpotSweeper发现了Visium测序平台上一组始终低质量的spots：在三个独立数据集中，<span textstyle="">恰好相同6个位置的spots文库大小持续低于邻域水平</span>（负z-score），被反复标记为异常点（图3A-C）。进而分析发现，<span textstyle="">这6个spots对应的合成条形码序列存在高度同源的CGTGTA序列，这可能导致PCR扩增效率降低，从而形成系统性偏差。这一发现强调了空间条形码本身造成偏差的可能性，也展现了SpotSweeper发现平台性bias的能力</span>。</span></p><section nodeleaf="" data-mpa-action-id="mcag1hid1udu" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXY1oNl7o6dTutOU8OicyoMYhIb5ricbIWpXCoicWhMThe2JfRFoBduAGkA/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.815" data-s="300,640" data-type="png" data-w="1600" type="block" data-imgfileid="100004181" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXY1oNl7o6dTutOU8OicyoMYhIb5ricbIWpXCoicWhMThe2JfRFoBduAGkA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">图3显示了上述结果</span>：图中红点代表SpotSweeper检测的低质异常spots。面板a-c分别对应三种数据集（来源于人脑DLPFC不同研究），一致地标出相同6个编号的spots。面板d-f展示了这些spots的条形码序列比对和k-mer分析，进一步验证了它们在序列上与高文库size的spots有显著差异。这一案例说明，SpotSweeper不仅能识别常规QC中漏检的局部异常，还能帮助定位潜在的实验平台偏倚。</span></p><p data-tool="mdnice编辑器"><span leaf="">除脑组织外，SpotSweeper也适用于肿瘤样本及其它空间组学技术。例如作者分别在乳腺癌、卵巢癌等Visium数据、Slide-seqV2小鼠海马、Stereo-seq小鼠胚胎、MERFISH小鼠结肠和STARmap小鼠脑等多种公开数据上进行了测试。在这些不同组织和技术下，SpotSweeper均能自动剔除文库质量偏低的spost，同时保持各空间域间剔除率均衡。例如在癌组织样本中，SpotSweeper的局部z-score阈值判断避免了一刀切的偏差剔除，使得高表达区域和低表达区域被分别合理保留；在细胞图像技术中（如MERFISH），作者建议将单分子定位结果汇总为空间像素后再应用SpotSweeper以兼容该方法（虽未详细展示案例）。总体而言，SpotSweeper在多组织、多平台中均呈现出对区域差异鲁棒的QC效果，提升了下游聚类和差异表达分析的可靠性。</span></p><p data-tool="mdnice编辑器"><span leaf="">在上述应用中，SpotSweeper也揭示了两类空间性技术伪差：干点（dryspot）和hangnail（组织损伤）伪差。<span textstyle="">在Visium平台上，渗透剂覆盖不全会形成“干点”区域，表现为大片低文库大小区而线粒体比例并无异常</span>（图4C-E）。这些区域常被空间聚类算法单独归为一类，影响对真实组织结构（如脑皮层分层）的识别。相比之下，<span textstyle="">hangnail伪差源自组织取样损伤（如钻孔），在组织切片上肉眼可见缺损（图4H），但其表达指标与周围正常组织相似，仅表现为局部表达变异性降低</span>。<span textstyle="">传统方法难以区分这两者，但SpotSweeper通过基于多尺度方差的算法分别加以识别和剔除，显著改善了后续分析结果</span>（详见下文图示）。</span></p><section nodeleaf="" data-mpa-action-id="mcagcdvnb4" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXUnIzIV2pAGBhg60a4l8tUOb7OIoXLlSndvUL10D8Bm4BEgrnHoUkKA/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.0765432098765433" data-s="300,640" data-type="png" data-w="1620" type="block" data-imgfileid="100004182" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXUnIzIV2pAGBhg60a4l8tUOb7OIoXLlSndvUL10D8Bm4BEgrnHoUkKA/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">图4示意了这两类伪差的成因与表现</span>。左侧(a–e)描述“干点”伪差：由于渗透不均，一大片区域的文库大小（d）和检测基因数显著减小，而线粒体比率（e）则无明显变化；这样的区域在空间聚类中会独立成簇(f)，干扰真实分层。右侧(h–j)为“hangnail”伪差：组织钻孔损伤在图像中清晰可见(h)，但这些spots与周围组织相比其文库大小和线粒体比率并无大差异(i–j)，结果是在聚类分析中被错误归为正常层（此例中误入L6层k）。通过SpotSweeper对多尺度线粒体表达方差进行聚类，可以自动区分出这些区域，避免了误分类和数据偏差。</span></p><section nodeleaf="" data-mpa-action-id="mcag6vk124co" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXrOl5oSPvlBvUhsdrKoq00gOmmujO0ARq1ZLQRUIsTKJXLOnDoxUiamQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8171641791044776" data-s="300,640" data-type="png" data-w="1608" type="block" data-imgfileid="100004183" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJD4x6v1VE5hSq3arDqALTXrOl5oSPvlBvUhsdrKoq00gOmmujO0ARq1ZLQRUIsTKJXLOnDoxUiamQ/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">图5展示了SpotSweeper剔除干点和hangnail伪差的过程</span>。图中(a–d)为干点案例：原始点图(a)中红色标出的区域文库明显偏低；通过对文库大小与基因数的DBSCAN聚类(b)，成功将干点划分为单独簇(c)；移除这些点后，BayesSpace等空间聚类算法重新发现了本该被干点占据的一个真实皮层层(例中新增的Lx层)(d)。图(e–h)为hangnail案例：我们计算每个spot的多尺度线粒体比率方差并降维聚类，发现hangnail区域在第一主成分上显著偏离(e–f)，被自动归为异常簇(g)。去除此簇后，对L6特异基因的差异表达分析（h）排名显著提高，说明剔除了干扰性的组织缺损信号。综上所述，这两个案例验证了SpotSweeper在空间转录组数据中的实用性和普适性。</span></p></section><hr><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []" data-mpa-action-id="mcafmawdg8z"><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><p data-tool="mdnice编辑器"><span leaf="" data-mpa-action-id="mcafmavp16a7">参考资料：Totty *et al.*在2025年发表于《Nature Methods》的文章对SpotSweeper方法进行了详细描述；本分析结合其图示和数据结果进行了梳理和解读。相关应用数据来自多个公开数据集。</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/_2vOco6WGtBmkP4wAdJvHQ",target="_blank" rel="noopener noreferrer">原文链接</a>
