---
title: "速来围观！单细胞数据模拟神器！splatter包助你快速生成合成数据，轻松掌握分析流程！"
date: 2025-06-23T13:35:26Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
速来围观！单细胞数据模拟神器！splatter包助你快速生成合成数据，轻松掌握分析流程！ by R语言学徒
------
<div><p><span leaf=""><br></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.2222222222222222" data-s="300,640" data-type="jpeg" data-w="900" type="block" data-imgfileid="100012638" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUeRH9VLyWbQoJghgIrTRx383Ak7ibU8ltoFYv9E74BicnHHtASRb1mJJU3Arr9qX25DhJ5pErPgDPw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section><span></span></section><p><span leaf=""><br></span></p><p><span><span leaf=""><img data-ratio="0.22395833333333334" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7iamd0t6j28QeqGnLX58K9dkrKZBWVQ4u9icMXSwYWOHdX2UDd8KFPrQQ/640?wx_fmt=png" data-w="576" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7iamd0t6j28QeqGnLX58K9dkrKZBWVQ4u9icMXSwYWOHdX2UDd8KFPrQQ/640?wx_fmt=png"></span></span><span></span></p><p><span><span leaf=""><span textstyle="">同学们，今天小师妹要为大家介绍一款在单细胞RNA测序研究中不可或缺的神器——splatter包！作为Bioconductor生态系统中的重要成员，splatter能够快速生成高度仿真的单细胞RNA测序合成数据，帮助我们验证分析流程、测试算法性能。无论是探索细胞聚类、差异表达分析，还是评估批次效应校正方法，splatter都能为你提供高质量的基准数据集！</span></span></span><span><span leaf=""><span textstyle="">数据模拟对小师妹来说简直是手到擒来，如果同学们在分析中遇到任何难题，欢迎随时找我讨论哦！</span></span></span><span></span></p><p><span><span leaf=""><span textstyle="">在本次学习中，我们将从splatter包的安装开始，逐步掌握如何生成不同实验设计的合成数据，并进行基础的可视化分析。相信通过今天的学习，同学们能够熟练运用splatter构建自己的测试数据集，为单细胞分析方法开发打下坚实基础！现在就让小师妹带你进入合成数据的学习之旅吧～</span></span></span></p><p><span><span leaf=""><span textstyle="">本次介绍的R包在服务器上能更加流畅地运行，如果没有服务器，欢迎联系我们进行服务器租赁~需要示例数据及代码也可以找师妹获取哦</span></span></span></p><section><section><section><section><section><section><section><span leaf=""><img data-cropselx1="0" data-cropselx2="194" data-cropsely1="0" data-cropsely2="194" data-imgfileid="100011261" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="396" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><section><p><span><strong><span leaf="">定制生信分析</span></strong></span></p><p><span><strong><span leaf="">生信云服务器</span></strong></span></p></section></section></section></section></section></section></section><p><span leaf=""><br></span><page></page></p><p><span><span leaf=""><span textstyle="">splatter包介绍</span></span></span></p><p><span><span leaf=""><span textstyle="">splatter是Bioconductor平台专为单细胞RNA测序数据模拟设计的R包。它采用伽马-泊松分布模型生成高度逼真的表达矩阵，支持多种实验设计（包括时间序列、批次效应、差异表达等）。通过灵活的参数调节系统，用户可以控制基因数量、细胞数量、差异表达基因比例等关键特征。生成的SynthBenchmark数据集可无缝衔接scater、Seurat等分析流程，是方法学研究和教学演示的理想工具。</span></span></span></p><p><span><span leaf=""><span textstyle="">splatter包安装</span></span></span></p><p><span><span leaf=""><span textstyle="">通过BiocManager安装最新版本：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span>if</span><span> </span>(!<span>require</span>(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))          </span></code><code><span leaf="">    install.<span>packages</span>(<span>"BiocManager"</span>)          </span></code><code><span leaf=""><span>BiocManager</span>::<span>install</span>(<span>"splatter"</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">验证安装并查看版本：</span></span></span></p><section><ul><li><li></ul><pre data-lang="javascript"><code><span leaf=""><span>library</span>(splatter)          </span></code><code><span leaf=""><span>packageVersion</span>(<span>"splatter"</span>)</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7KhuGCtXQWnl2Mzq4gEFHnRdiaruTl8icaXD5iaxllxGF5DfQRntqqbAfA/640?wx_fmt=png" data-ratio="0.14053537284894838" data-w="1046" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7KhuGCtXQWnl2Mzq4gEFHnRdiaruTl8icaXD5iaxllxGF5DfQRntqqbAfA/640?wx_fmt=png"></span></span><page></page></p><p><span><span leaf=""><span textstyle="">若显示1.30.0及以上版本，说明安装成功。</span></span></span></p><p><span><span leaf=""><span textstyle="">使用splatter生成并分析合成数据</span></span></span></p><p><span><span leaf=""><span textstyle="">初始化参数设置：</span></span></span></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 初始化参数设置，包含1000个基因、200个细胞的基础参数对象</span></span></code><code><span leaf=""><span>params</span> &lt;- newSplatParams(nGenes = <span>1000</span>, batchCells = <span>200</span>)</span></code></pre></section><p><span><span leaf=""><span textstyle="">这里创建包含1000个基因、200个细胞的基础参数对象，后续所有模拟都将基于此配置。</span></span></span></p><p><span><span leaf=""><span textstyle="">模拟两组差异表达数据：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 模拟两组差异表达数据，设置20%的基因为差异表达基因</span></span></code><code><span leaf=""><span>sim</span>.data &lt;- splatSimulate(params, group.prob = c(<span>0</span>.<span>5</span>, <span>0</span>.<span>5</span>),          </span></code><code><span leaf="">                       <span>method</span> = <span>"groups"</span>, de.prob = <span>0</span>.<span>2</span>)</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7brZobtPZFgt93RlOPv5xIRdvgUWFhcNzTbFNrjg0viaCnXEbDFqGzkQ/640?wx_fmt=png" data-ratio="0.23166023166023167" data-w="1295" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7brZobtPZFgt93RlOPv5xIRdvgUWFhcNzTbFNrjg0viaCnXEbDFqGzkQ/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">生成包含两个细胞群体（各占50%）的数据集，设置20%的基因为差异表达基因。</span></span></span></p><p><span><span leaf=""><span textstyle="">查看数据结构：</span></span></span><page></page></p><section><ul><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>class</span>(sim.data)# 应显示SingleCellExperiment对象          </span></code><code><span leaf=""><span>colData</span>(sim.data)[<span>1</span>:<span>5</span>, ]# 查看前<span>5</span>个细胞的元数据</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7O79RsW1gZbTuziap1HVpVib4nGg1eZzLdBwWne0tvaZ1fpeKtmTrMicibQ/640?wx_fmt=png" data-ratio="0.07974137931034483" data-w="1392" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7O79RsW1gZbTuziap1HVpVib4nGg1eZzLdBwWne0tvaZ1fpeKtmTrMicibQ/640?wx_fmt=png"></span></span><span></span></p><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC77VkYQibhsZvFWJ8sNEctrU3o20mWgHB6Ud5GicwQTRv8jTjfBQPNluEg/640?wx_fmt=png" data-ratio="0.16754617414248021" data-w="1516" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC77VkYQibhsZvFWJ8sNEctrU3o20mWgHB6Ud5GicwQTRv8jTjfBQPNluEg/640?wx_fmt=png"></span></span><span></span></p><p><span><span leaf=""><span textstyle="">输出显示每个细胞的Group（群体归属）和Batch（批次信息）等元数据。</span></span></span></p><p><span><span leaf=""><span textstyle="">提取原始计数矩阵：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 提取原始计数矩阵，显示前5个基因在前3个细胞中的UMI计数</span></span></code><code><span leaf=""><span>count</span>.matrix &lt;- counts(sim.data)          </span></code><code><span leaf=""><span>count</span>.matrix[<span>1</span>:<span>5</span>, <span>1</span>:<span>3</span>]# 查看原始UMI计数矩阵</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7ns10Xt6jqTxhFul6wI0nYxrO7Zg02Brp4wubaDws6jpeZTq9yQ62Cw/640?wx_fmt=png" data-ratio="0.16798732171156894" data-w="1262" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7ns10Xt6jqTxhFul6wI0nYxrO7Zg02Brp4wubaDws6jpeZTq9yQ62Cw/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">显示前5个基因在前3个细胞中的原始UMI计数，验证数据格式正确性。</span></span></span></p><p><span><span leaf=""><span textstyle="">数据标准化处理：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span># 使用scater包对数据进行对数标准化处理</span></span></code><code><span leaf="">library(scater)          </span></code><code><span leaf="">sim.data &lt;- logNormCounts(sim.data)<span># 生成logcounts矩阵</span></span></code></pre></section><p><page></page></p><p><span><span leaf=""><span textstyle="">使用scater包进行对数标准化，生成logcounts矩阵供下游分析使用。</span></span></span></p><p><span><span leaf=""><span textstyle="">主成分分析（PCA）：</span></span></span></p><section><ul><li><li><li></ul><pre data-lang="kotlin"><code><span leaf=""># 进行主成分分析（PCA），并绘制PCA图</span></code><code><span leaf="">sim.<span>data</span> &lt;- runPCA(sim.<span>data</span>)          </span></code><code><span leaf="">plotPCA(sim.<span>data</span>, colour_by = <span>"Group"</span>)# 绘制PCA图，按群体分色</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7Z4WHfnMeDeQNEoERDuI3zRpMk2KefBib8BiaWadaWjVRUFfxO918SHzA/640?wx_fmt=jpeg" data-ratio="0.5" data-w="1250" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7Z4WHfnMeDeQNEoERDuI3zRpMk2KefBib8BiaWadaWjVRUFfxO918SHzA/640?wx_fmt=jpeg"></span></span></p><p><span><span leaf=""><span textstyle="">PCA图中可见两个细胞群体呈现明显分离，证明模拟的差异表达效果成功。</span></span></span></p><p><span><span leaf=""><span textstyle="">t-SNE可视化：</span></span></span></p><section><ul><li><li><li><li></ul><pre data-lang="kotlin"><code><span leaf=""># 使用t-SNE进行非线性降维，绘制t-SNE图</span></code><code><span leaf=""><span>set</span>.seed(<span>123</span>)          </span></code><code><span leaf="">sim.<span>data</span> &lt;- runTSNE(sim.<span>data</span>)          </span></code><code><span leaf="">plotTSNE(sim.<span>data</span>, colour_by = <span>"Group"</span>)# 绘制t-SNE图，按群体分色</span></code></pre></section><p><page></page></p><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7ybrCPWOty3slh0pE8icdIL7yUjC7H36SMghCAYa1KvphkKr9IP7libibg/640?wx_fmt=jpeg" data-ratio="0.5" data-w="1250" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7ybrCPWOty3slh0pE8icdIL7yUjC7H36SMghCAYa1KvphkKr9IP7libibg/640?wx_fmt=jpeg"></span></span></p><p><span><span leaf=""><span textstyle="">非线性降维结果进一步验证细胞群体的分离趋势，橙色与蓝色点分别代表两组细胞。</span></span></span></p><p><span><span leaf=""><span textstyle="">差异表达分析：</span></span></span></p><section><ul><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 使用scran包进行差异表达分析，查找标记基因</span></span></code><code><span leaf=""><span>library</span>(scran)          </span></code><code><span leaf=""><span>markers</span> &lt;- findMarkers(sim.data, groups = sim.data$Group)          </span></code><code><span leaf=""><span>top</span>.markers &lt;- markers[[<span>1</span>]]          </span></code><code><span leaf=""><span>top</span>.markers[<span>1</span>:<span>5</span>, <span>1</span>:<span>4</span>]# 输出排名前<span>5</span>的差异基因及其统计值</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7bkY9URbibK1tZapmkKaicK03siafbuURweeYpPibxKpNhUn4FZEcicySKoA/640?wx_fmt=png" data-ratio="0.15991620111731844" data-w="1432" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC7bkY9URbibK1tZapmkKaicK03siafbuURweeYpPibxKpNhUn4FZEcicySKoA/640?wx_fmt=png"></span></span></p><p><span><span leaf=""><span textstyle="">输出显示排名前5的差异基因及其p值、FDR和logFC值，可用于火山图绘制。</span></span></span><page></page></p><p><span><span leaf=""><span textstyle="">热图可视化标记基因：</span></span></span></p><section><ul><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 绘制热图展示前10个标记基因的表达差异</span></span></code><code><span leaf=""><span>top</span>.genes &lt;- rownames(top.markers)[<span>1</span>:<span>10</span>]          </span></code><code><span leaf=""><span>plotHeatmap</span>(sim.data, features = top.genes,          </span></code><code><span leaf="">           <span>colour_columns_by</span> = <span>"Group"</span>)# 绘制标记基因的热图</span></code></pre></section><p><span><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC74BhQcMNOIzYjflu0C4uLVL82qEY9vkTtX9tflxicib2CIblQm4GYUsCw/640?wx_fmt=jpeg" data-ratio="0.5" data-w="1250" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEVwU1fyGz7P1I0Dff0EUrC74BhQcMNOIzYjflu0C4uLVL82qEY9vkTtX9tflxicib2CIblQm4GYUsCw/640?wx_fmt=jpeg"></span></span></p><p><span><span leaf=""><span textstyle="">热图清晰展示前10个标记基因在两组细胞中的表达差异，从其分布状态中可以验证模拟数据的生物学合理性，说明splatter在模拟单细胞数据的强大能力。</span></span></span></p><p><span><span leaf=""><span textstyle="">总结</span></span></span></p><p><span><span leaf=""><span textstyle="">通过本次学习，我们掌握了使用splatter包生成合成单细胞数据的关键技能。从参数配置、数据模拟到可视化分析，splatter展现出强大的灵活性和仿真能力。生成的数据集可直接用于测试聚类算法、差异分析方法或机器学习模型，大幅降低方法开发的门槛。小师妹强烈推荐将splatter纳入你的生信工具库，相信它会在你的方法学研究道路上大放异彩！</span></span></span><page></page></p><p><span><p><span leaf=""><span textstyle=""> </span></span></p></span></p><p><span><span leaf=""><span textstyle="">同学们如果觉得自己写代码麻烦，可以体验一下我们的云生信小工具，只需输入数据，即可轻松生成所需图表。</span></span></span><span><span leaf=""><span textstyle="">立即访问云生信</span></span></span><span><span><span leaf=""><span textstyle="">（</span></span></span></span><span><span><span leaf=""><span textstyle="">http://www.biocloudservice.com/home.html</span></span></span></span><span><span><span leaf=""><span textstyle="">）</span></span></span></span><span></span><span><span leaf=""><span textstyle="">，开启便捷的生信之旅！</span></span></span></p><p><span leaf=""><br></span></p><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p><span leaf="">E</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">N</span></p></section></section><section><section powered-by="xiumi.us"><p><span leaf="">D</span></p></section></section><section><section powered-by="xiumi.us"><section><span leaf=""><br></span></section></section></section></section></section><p><span><span leaf="">如果您的时间和精力有限或者缺乏相关经验，并且对生信分析和服务器有所需要的话，我们非常乐意为您提供如下服务：思路评估、生信分析和方案设计以及服务器等，有意向的小伙伴欢迎咨询师妹哦！</span></span></p><section><section><section><section><section><section><section><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="396" data-cropselx1="0" data-cropselx2="219" data-cropsely1="0" data-cropsely2="219" data-imgfileid="100013742" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWesJCYlntv06OhltJriajm4LeGalupZW22ZNynYrOMW2MVzVNRghGJlq7GC8rj3ibl7m9cV4pTup3A/640?wx_fmt=png&amp;from=appmsg"></span></section></section></section><section><section><p><span leaf="">定制生信分析</span></p><p><span leaf="">课题思路设计</span></p><p><span leaf="">生信云服务器</span></p></section></section></section></section></section></section><section powered-by="xiumi.us"><p><span leaf=""><br></span></p><p><span leaf=""><br></span></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><p><strong><span leaf="">往期推荐</span></strong></p></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section powered-by="xiumi.us"><p><span leaf=""><br></span></p><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247490276&amp;idx=1&amp;sn=ec7fac6e48adeabefb732d2d1bf2e7fd&amp;scene=21#wechat_redirect" textvalue="史上最详细全面的GO，kegg富集分析绘图代码实操" data-itemshowtype="0" linktype="text" data-linktype="2">史上最详细全面的GO，kegg富集分析绘图代码实操</a></span></span></p></section><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247496402&amp;idx=1&amp;sn=5302213f9af40f81e73459ceeb946da8&amp;scene=21#wechat_redirect" textvalue="牛犇了！硕士一作发顶刊BMJ（IF=93.6）！GBD数据库果然不同凡响~" data-itemshowtype="0" linktype="text" data-linktype="2">牛犇了！硕士一作发顶刊BMJ（IF=93.6）！GBD数据库果然不同凡响~</a></span></span><span leaf=""><br></span></p><p><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247496729&amp;idx=1&amp;sn=6646c483fa6d93e891a21d9c2cae3585&amp;scene=21#wechat_redirect" textvalue="人心中的成见是一座大山！复旦大学最新NHANES研究：爱睡懒觉更有利健康！周末补觉1-2h，显著降低抑郁风险！" data-itemshowtype="0" linktype="text" data-linktype="2">人心中的成见是一座大山！复旦大学最新NHANES研究：爱睡懒觉更有利健康！周末补觉1-2h，显著降低抑郁风险！</a></span></span><span leaf=""><br></span><page></page></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pv-Agrnu1nwcC4nFqN4trg",target="_blank" rel="noopener noreferrer">原文链接</a>
