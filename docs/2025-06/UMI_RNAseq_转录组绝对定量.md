---
title: "UMI-RNAseq—转录组绝对定量"
date: 2025-06-17T08:13:02Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
UMI-RNAseq—转录组绝对定量 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6"><span leaf="">心之所向 步履不停</span></strong></p></section></section></section></section></section></section></section><p><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">UMI-RNAseq</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">UMI(Unique molecularidentifier)——特异性分子标签（UMI）为 8-10nt 的短序列，可看做“条形码”，在文库构建时通过连接接头引入UMI标签连接到cDNA分子中，标记原始样品中的每个分子，对同一来源扩增产物进行追踪和最终提取分组，用于排除 PCR 扩增偏好性和测序偏好性引入的定量偏差，便于获得足够的读数以进行分析。</span></p><p data-tool="mdnice编辑器"><span leaf="">UMI-RNAseq技术是利用高通量测序技术在文库构建时引入特异性分子标签UMI，通过计数 UMI 的个数，我们便可以对原始的 RNA 分子进行“绝对定量”。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHPJa8VoCW3oUMEReuqNT9f00gnegu4pdqn7G39N1iav4ib8PWHJ3NkDNA/640?wx_fmt=png&amp;from=appmsg" alt="UMI绝对定量示意图" data-ratio="0.37962962962962965" data-type="png" data-w="1080" data-imgfileid="100051375" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHPJa8VoCW3oUMEReuqNT9f00gnegu4pdqn7G39N1iav4ib8PWHJ3NkDNA/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">UMI绝对定量示意图</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">传统 RNA-seq 定量分析是存在一定缺陷的，不可避免的会有duplication的产生。Dup的产生固然有天然重复序列的原因，但更主要的是PCR扩增偏好性和不均匀性所致。从而导致定量与真实值存在偏差，为了纠正二代测序过程中带来的系统偏差，从而发展出了UMI-RNAseq。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">UMI-seq  优势与应用</span></span><span></span></h2><ul><li><section><strong><span leaf="">定量精准</span></strong><span leaf="">：添加UMI标签，可有效降低Duplication产生的影响，提高定量准确性</span></section></li><li><section><strong><span leaf="">RNA起始量低</span></strong><span leaf="">：UMI-small RNAseq低至200ng起始量；UMI-mRNAseq低至50ng起始量。</span></section></li><li><section><strong><span leaf="">低拷贝基因的鉴定</span></strong><span leaf="">：避免由于PCR扩增本身对低拷贝片段扩增不准确而造成对定量结果的影响。</span></section></li><li><section><strong><span leaf="">序列质量高</span></strong><span leaf="">：矫正扩增错误的碱基/SNP/Indel；准确识别重复类型/可变剪切；RNA编辑分析更准确</span></section></li></ul><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHAPul7V8Oy6hlIgLPCUN7RniaxVaGwEkicevyjmsWZuIhUdu1ogG5micuw/640?wx_fmt=png&amp;from=appmsg" alt="原理及优势" data-ratio="0.6194444444444445" data-type="png" data-w="1080" data-imgfileid="100051374" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHAPul7V8Oy6hlIgLPCUN7RniaxVaGwEkicevyjmsWZuIhUdu1ogG5micuw/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">原理及优势</span></figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">UMI-RNAseq 建库流程</span></span><span></span></h2><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH3lRZKOvfLN3WxRY4oNE17ttn4vAupXUnMK1cDWbIeztuAqMgPv9w0g/640?wx_fmt=png&amp;from=appmsg" alt="建库流程" data-ratio="1.125" data-type="png" data-w="1080" data-imgfileid="100051376" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH3lRZKOvfLN3WxRY4oNE17ttn4vAupXUnMK1cDWbIeztuAqMgPv9w0g/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">建库流程</span></figcaption></figure><ul><li><section><span leaf="">利用真核生物大部分mRNA都带有polyA尾的结构特征，通过Oligo(dT)磁珠富集带有polyA尾的mRNA;</span></section></li><li><section><span leaf="">加入片段化试剂（Fragmentation Buffer)将mRNA 随机打断成短片段；</span></section></li><li><section><span leaf="">以短片段为模板逆转录合成cDNA,之后进行cDNA末端修复、加A尾、并连接UMI标签和测序接头； 【</span><strong><span leaf="">关键点：UMI 在这一步被引入，每个cDNA分子理论上会连接上一个带有独特UMI序列的接头。</span></strong><span leaf="">】</span></section></li><li><section><span leaf="">最后进行PCR扩增并获得文库； 【最终的测序文库分子结构（从5'到3'端看其中一条链）大致为：</span><code><span leaf="">P5</span></code><span leaf=""> - </span><code><span leaf="">Rd1 SP</span></code><span leaf=""> - </span><code><span leaf="">UMI</span></code><span leaf=""> - </span><code><span leaf="">cDNA insert</span></code><span leaf=""> - </span><code><span leaf="">Rd2 SP</span></code><span leaf=""> - </span><code><span leaf="">index</span></code><span leaf=""> - </span><code><span leaf="">P7</span></code><span leaf="">。】</span></section></li><li><section><span leaf="">文库质检合格后采用illumina平台进行测序，测长通常为PE150。</span></section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">UMI-RNAseq 分析流程</span></span><span></span></h2><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHO4lKfETH36uJRePs7LU1ILVwXpE3alOJJYoYusPXcBdJdYvHU7eEOQ/640?wx_fmt=png&amp;from=appmsg" alt="分析流程" data-ratio="0.6138888888888889" data-type="png" data-w="1080" data-imgfileid="100051377" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHO4lKfETH36uJRePs7LU1ILVwXpE3alOJJYoYusPXcBdJdYvHU7eEOQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">分析流程</span></figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">定量流程</span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">首先是确定测序数据的文库信息，比如示例用到的文库是：</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHetZ77gngULNxvnyT22t4NFYxVarMGk6V7TTtfsnokzBRpGsEqn9BqA/640?wx_fmt=png&amp;from=appmsg" alt="文库信息示例" data-ratio="0.3472222222222222" data-type="png" data-w="1080" data-imgfileid="100051373" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHetZ77gngULNxvnyT22t4NFYxVarMGk6V7TTtfsnokzBRpGsEqn9BqA/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">文库信息示例</span></figcaption></figure><p data-tool="mdnice编辑器"><span leaf="">Read 2 的前 8 个碱基是 UMI，随后是 3 个碱基的连接子和 3 个碱基的非模板添加序列，之后才是真正的转录本序列。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH9T0PID53QRT8rbMOCicRvGj45kNyESOxj5dAcNPqx63lwFLnn7icshWQ/640?wx_fmt=png&amp;from=appmsg" alt="原始数据QC检查" data-ratio="0.649074074074074" data-type="png" data-w="1080" data-imgfileid="100051379" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH9T0PID53QRT8rbMOCicRvGj45kNyESOxj5dAcNPqx63lwFLnn7icshWQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">原始数据QC检查</span></figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">数据预处理</span></span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">提取8nt的UMI序列( umi_tools )</span></span><span></span></h4><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">vim st1_r2_8nt_extract.sh</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span leaf="">! /bin/bash -xe</span></span><span leaf=""><br></span><span><span leaf="">#</span></span><span leaf=""><br></span><span leaf="">biosoft=/home/username/miniconda3/envs/scRNA/bin/umi_tools</span><span leaf=""><br></span><span leaf="">project=/home/username/project/umi_rnaseq/r2_umi_8bp</span><span leaf=""><br></span><span leaf="">outdir=${project}/st1_extract</span><span leaf=""><br></span><span leaf="">Log=${project}/st0_log</span><span leaf=""><br></span><span leaf="">fq1=$1</span><span leaf=""><br></span><span leaf="">fq2=$2</span><span leaf=""><br></span><span leaf="">id=$3</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">if [ ! -d ${outdir} ];</span><span leaf=""><br></span><span leaf="">then mkdir -p ${outdir}</span><span leaf=""><br></span><span leaf="">fi</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">/usr/bin/time -v ${biosoft} extract --extract-method=string \</span><span leaf=""><br></span><span leaf="">--bc-pattern=NNNNNNNN \</span><span leaf=""><br></span><span leaf="">--stdin ${fq2} \</span><span leaf=""><br></span><span leaf="">--read2-in ${fq1} \</span><span leaf=""><br></span><span leaf="">--stdout ${outdir}/${id}_extract_2.fastq.gz \</span><span leaf=""><br></span><span leaf="">--read2-out ${outdir}/${id}_extract_1.fastq.gz 1&gt;${Log}/st1_${id}_extract.log  2&gt;&amp;1</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img alt="QC检查" data-imgfileid="100051380" data-ratio="0.6861111111111111" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH8vsjNIic1oKONXhznrardWovMtFBEhXA2BAfYpicavxj1kTNeKDZ4w3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH8vsjNIic1oKONXhznrardWovMtFBEhXA2BAfYpicavxj1kTNeKDZ4w3g/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">QC检查</span></figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">质控(trim_galore)</span></span><span></span></h4><p data-tool="mdnice编辑器"><span leaf="">使用trim_galore 去除R2的连接子和添加序列</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">vim st2_trim_cut6nt.sh</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span leaf="">! /bin/bash -xe</span></span><span leaf=""><br></span><span><span leaf="">#</span></span><span leaf=""><br></span><span leaf="">biosoft=/home/username/miniconda3/envs/RNAseq/bin/trim_galore</span><span leaf=""><br></span><span leaf="">project=/home/username/project/umi_rnaseq/r2_umi_8bp</span><span leaf=""><br></span><span leaf="">outdir=${project}/st2_clean_cut6nt_data</span><span leaf=""><br></span><span leaf="">Log=${project}/st0_log</span><span leaf=""><br></span><span leaf="">fq1=$1</span><span leaf=""><br></span><span leaf="">fq2=$2</span><span leaf=""><br></span><span leaf="">id=$3</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">if [ ! -d ${outdir} ];</span><span leaf=""><br></span><span leaf="">then mkdir -p ${outdir}</span><span leaf=""><br></span><span leaf="">fi</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">/usr/bin/time -v  ${biosoft} -q 28 --phred33 --length 30 --max_n 3 \</span><span leaf=""><br></span><span leaf="">        --stringency 3 --paired  --clip_R2 6 --gzip --cores 4 \</span><span leaf=""><br></span><span leaf="">        -o ${outdir} \</span><span leaf=""><br></span><span leaf="">        ${project}/st1_extract/${id}*.gz 1&gt;${Log}/st2_${id}_trim.log 2&gt;&amp;1</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">#</span></span><span><span><span leaf="">#参数释义</span></span></span><span leaf=""><br></span><span leaf="">--clip_R2 &lt;int&gt; #用于 双端测序（paired-end）的专用参数，作用是从 read2 的 5' 端（起始端） 剪切掉指定数量（&lt;int&gt;）的碱基。这是专门针对双端测序中 reads2 的建库引入序列的操作</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img alt="QC检查" data-imgfileid="100051381" data-ratio="0.7342592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHaJnSa60FpNaLEMJLq5k6DIv8qCOy8apicpvuHdQZXCZM98sLUK9Umicw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwHaJnSa60FpNaLEMJLq5k6DIv8qCOy8apicpvuHdQZXCZM98sLUK9Umicw/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">QC检查</span></figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">比对(hisat2)</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">vim st3_hisat2_cut6nt.sh</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span leaf="">! /bin/bash -xe</span></span><span leaf=""><br></span><span><span leaf="">#</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">biosoft=/home/username/miniconda3/envs/RNAseq/bin/hisat2</span><span leaf=""><br></span><span leaf="">index=/home/username/reference/human/GRCh38/hisat2_indx/GRCh38_genome</span><span leaf=""><br></span><span leaf="">project=/home/username/project/umi_rnaseq/r2_umi_8bp</span><span leaf=""><br></span><span leaf="">fqdir==${project}/st2_clean_cut6nt_data</span><span leaf=""><br></span><span leaf="">outdir=${project}/st3_hisat_cut6nt_outs</span><span leaf=""><br></span><span leaf="">Log=${project}/st0_log</span><span leaf=""><br></span><span leaf="">fq1=$1</span><span leaf=""><br></span><span leaf="">fq2=$2</span><span leaf=""><br></span><span leaf="">id=$3</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">if [ ! -d ${outdir} ];</span><span leaf=""><br></span><span leaf="">then mkdir -p ${outdir}</span><span leaf=""><br></span><span leaf="">fi</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">/usr/bin/time -v  ${biosoft}  -p 4  \</span><span leaf=""><br></span><span leaf="">-x  ${index} \</span><span leaf=""><br></span><span leaf="">-1 ${fq1} \</span><span leaf=""><br></span><span leaf="">-2 ${fq2}  2&gt;${Log}/st3_${id}_cut6nt_hisat2.log | samtools sort -@ 2 -o ${outdir}/${id}.sort.bam 1&gt;${Log}/st3_${id}_cut6nt_samsort.log 2&gt;&amp;1</span><span leaf=""><br></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">提交任务：</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#</span></span><span><span><span leaf="">#提交</span></span></span><span leaf=""><br></span><span leaf="">ls ${PWD}/{1..9}*1.fq.gz |paste - &lt;(ls ${PWD}/{1..9}*2.fq.gz) &lt;(ls {1..9}*1.fq.gz|cut -d "_" -f 1,2) &gt; ../st3_hisat2_cut6nt_config.txt</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">screen -r r2</span><span leaf=""><br></span><span leaf="">cat st3_hisat2_cut6nt_config.txt |xargs -iF -P 10 sh -c 'bash st3_hisat2_cut6nt.sh F'</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">比对结果</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">$</span></span><span><span leaf="">grep </span><span><span leaf="">"overall alignment"</span></span><span leaf=""> st3*cut6nt_hisat2.log</span></span><span leaf=""><br></span><span leaf="">st3_10_S31_cut6nt_hisat2.log:90.66% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_1_S22_cut6nt_hisat2.log:90.51% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_2_S23_cut6nt_hisat2.log:91.23% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_3_S24_cut6nt_hisat2.log:86.22% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_4_S25_cut6nt_hisat2.log:89.86% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_5_S26_cut6nt_hisat2.log:91.30% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_6_S27_cut6nt_hisat2.log:92.39% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_7_S28_cut6nt_hisat2.log:91.02% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_8_S29_cut6nt_hisat2.log:93.67% overall alignment rate</span><span leaf=""><br></span><span leaf="">st3_9_S30_cut6nt_hisat2.log:92.92% overall alignment rate</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span><span leaf="">#结果bam文件大小</span></span></span><span leaf=""><br></span><span><span leaf="">$</span></span><span><span leaf="">ls -lha *.bam |cut -d </span><span><span leaf="">" "</span></span><span leaf=""> -f 5-</span></span><span leaf=""><br></span><span leaf="">3.0G 4月  29 16:30 10_S31.sort.bam</span><span leaf=""><br></span><span leaf="">3.4G 4月  29 16:31 1_S22.sort.bam</span><span leaf=""><br></span><span leaf="">4.5G 4月  29 16:45 2_S23.sort.bam</span><span leaf=""><br></span><span leaf="">4.7G 4月  29 16:49 3_S24.sort.bam</span><span leaf=""><br></span><span leaf="">4.0G 4月  29 16:41 4_S25.sort.bam</span><span leaf=""><br></span><span leaf="">6.0G 4月  29 17:03 5_S26.sort.bam</span><span leaf=""><br></span><span leaf="">4.5G 4月  29 16:42 6_S27.sort.bam</span><span leaf=""><br></span><span leaf="">3.9G 4月  29 16:37 7_S28.sort.bam</span><span leaf=""><br></span><span leaf="">3.4G 4月  29 16:32 8_S29.sort.bam</span><span leaf=""><br></span><span leaf="">2.1G 4月  29 16:21 9_S30.sort.bam</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">umi 去重(umi_tools)</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">相比于Bulk转录组区别的</span><strong><span leaf="">关键步骤</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">vim st4_umi_cut6nt_dup.sh</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span leaf="">! /bin/bash -xe</span></span><span leaf=""><br></span><span><span leaf="">#</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">biosoft=/home/username/miniconda3/envs/scRNA/bin/umi_tools</span><span leaf=""><br></span><span leaf="">project=/home/username/project/umi_rnaseq/r2_umi_8bp</span><span leaf=""><br></span><span leaf="">bamdir=${project}/st3_hisat_cut6nt_outs</span><span leaf=""><br></span><span leaf="">outdir=${project}/st4_umi_cut6nt_dup</span><span leaf=""><br></span><span leaf="">Log=${project}/st0_log</span><span leaf=""><br></span><span leaf="">fq1=$1</span><span leaf=""><br></span><span leaf="">fq2=$2</span><span leaf=""><br></span><span leaf="">id=$3</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">if [ ! -d ${outdir} ];</span><span leaf=""><br></span><span leaf="">then mkdir -p ${outdir}</span><span leaf=""><br></span><span leaf="">fi</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">cd ${bamdir} &amp;&amp; samtools index ${id}.sort.bam</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">/usr/bin/time -v  ${biosoft} dedup \</span><span leaf=""><br></span><span leaf="">-I ${bamdir}/${id}.sort.bam \</span><span leaf=""><br></span><span leaf="">--paired --output-stats=deduplicated \</span><span leaf=""><br></span><span leaf="">-S ${outdir}/${id}_sort_dup.bam 1&gt;${Log}/st4_${id}_cut6nt_umidup.log 2&gt;&amp;1</span><span leaf=""><br></span><span><span leaf=""><br></span><span leaf="">#</span></span><span><span><span leaf="">#批量提交任务</span></span></span><span leaf=""><br></span><span leaf="">screen -r r2</span><span leaf=""><br></span><span leaf="">cat st3_hisat2_cut6nt_config.txt |xargs -iF -P 10 sh -c 'bash st4_umi_cut6nt_dup.sh F'</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">去重后文件大小</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">$</span></span><span><span leaf="">ls -lha *.bam |cut -d </span><span><span leaf="">" "</span></span><span leaf=""> -f 5-</span></span><span leaf=""><br></span><span leaf="">2.2G 4月  30 18:21 10_S31_sort_dup.bam</span><span leaf=""><br></span><span leaf="">2.5G 4月  30 18:22 1_S22_sort_dup.bam</span><span leaf=""><br></span><span leaf="">3.3G 4月  30 20:04 2_S23_sort_dup.bam</span><span leaf=""><br></span><span leaf="">3.1G 4月  30 20:28 3_S24_sort_dup.bam</span><span leaf=""><br></span><span leaf="">2.9G 4月  30 19:29 4_S25_sort_dup.bam</span><span leaf=""><br></span><span leaf="">4.3G 4月  30 20:59 5_S26_sort_dup.bam</span><span leaf=""><br></span><span leaf="">3.3G 4月  30 19:28 6_S27_sort_dup.bam</span><span leaf=""><br></span><span leaf="">2.9G 4月  30 18:56 7_S28_sort_dup.bam</span><span leaf=""><br></span><span leaf="">2.6G 4月  30 18:16 8_S29_sort_dup.bam</span><span leaf=""><br></span><span leaf="">1.7G 4月  30 17:43 9_S30_sort_dup.bam</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">单从文件大小来看，也可以确定处理前后发生了明显变化。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">定量(featureCounts)</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf=""><br></span><span leaf="">mkdir st5_r2_umi_count &amp;&amp; cd st5_r2_umi_count</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gtf='/home/username/reference/human/GRCh38/gencode.v44.annotation.gtf'</span><span leaf=""><br></span><span leaf="">ls -lha $gtf</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">featureCounts -T 5 -p -t exon -g gene_id -a $gtf -o r2_8bp_umi_id.txt ../st4_umi_cut6nt_dup/*.bam</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">至此上游定量流程就完成了。</span></p><hr><p data-tool="mdnice编辑器"><span leaf="">生物信息学上游分析必然绕不开服务器，如果你们实验室没有服务器以供练习，那么可以看一下我们提供的共享服务器，详见： <a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></p><figure data-tool="mdnice编辑器"><span leaf=""><img alt="还等什么呢，赶快扫描下面二维码添加微信抢购吧！" data-imgfileid="100051382" data-ratio="1.7777777777777777" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH1ibg6xpibWEB37M638ibLkN7Mw0GUetGn0aRPTk8P0WLq8zibVPiatxiaKIQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/iaRJcrq2Los9eB9TbHaczepib0fLaZEAwH1ibg6xpibWEB37M638ibLkN7Mw0GUetGn0aRPTk8P0WLq8zibVPiatxiaKIQ/640?wx_fmt=jpeg&amp;from=appmsg"></span><figcaption><span leaf="">还等什么呢，赶快扫描下面二维码添加微信抢购吧！</span></figcaption></figure><hr><p data-tool="mdnice编辑器"><span leaf="">参考链接</span></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">- https://mp.weixin.qq.com/s?__biz=MzIyMTI1NDU0Ng==&amp;mid=2247485063&amp;idx=1&amp;sn=263295d238f86b27ecb2238e6e27f6ae&amp;chksm=e83ec07adf49496cedc88272bca446decb092b04088b5c336858739e3768d9a4d83bf9f8e530&amp;token=1373935942&amp;lang=zh_CN</span><span><span leaf="">#rd)</span></span><span leaf=""><br></span><span leaf="">- https://mp.weixin.qq.com/s/NyUMI-2SWl3NwCgsS4yfBA</span><span leaf=""><br></span><span leaf="">- https://www.genechem.com.cn/proinfo/138.html</span><span leaf=""><br></span><span leaf="">- https://www.bilibili.com/video/BV1924y1F7cr/?spm_id_from=333.337.search-card.all.click&amp;vd_source=123365f2db254d22dab5943e8c83caf0</span><span leaf=""><br></span><span leaf="">- https://www.bilibili.com/video/BV1fjHXetESF/?spm_id_from=333.337.search-card.all.click&amp;vd_source=123365f2db254d22dab5943e8c83caf0</span><span leaf=""><br></span><span leaf="">- https://www.bilibili.com/video/BV1jK4y1u7P5/?spm_id_from=333.337.search-card.all.click&amp;vd_source=123365f2db254d22dab5943e8c83caf0</span><span leaf=""><br></span><span leaf="">- https://www.yunbios.net/UMI-RNA-seq.html</span><span><span leaf="">#</span></span></code></pre></section><p><span leaf=""><br></span></p><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><span leaf=""><br></span></section><section powered-by="xmyeditor.com" data-md5="8b46d"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-ratio="0.6940298507462687" data-type="gif" data-w="134" data-imgfileid="100043272" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></span></section><section powered-by="xmyeditor.com" data-md5="8b46d"><span leaf=""><br></span></section></section></section></section></section></section><p><span></span><span leaf=""><br></span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器"><span leaf="">文末友情宣传</span></h4><p data-tool="mdnice编辑器"><span leaf="">强烈建议你推荐给身边的</span><strong><span leaf="">博士后以及年轻生物学PI</span></strong><span leaf="">，多一点数据认知，让他们的科研上一个台阶：</span></p><ul></ul></section><ul><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课7月班" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">生信入门&amp;数据挖掘线上直播课7月班</span></a></span></p></li><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247530048&amp;idx=1&amp;sn=28aa7bbd5e00521f79e074496a5f5d66&amp;scene=21#wechat_redirect" textvalue="满足你生信分析计算需求的低价解决方案" data-itemshowtype="0" linktype="text" data-linktype="2">满足你生信分析计算需求的低价解决方案</a></span></p></li><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543278&amp;idx=1&amp;sn=35cbf5b0bea5576308176083ece073ac&amp;scene=21#wechat_redirect" textvalue="单细胞数据挖掘全国巡讲·上海专场" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞数据挖掘全国巡讲·上海专场</a></span></p></li><li><p><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543451&amp;idx=1&amp;sn=e3bf3f6bc2875d3d94de6759961a0c9e&amp;scene=21#wechat_redirect" textvalue="趁暑假学会Python，解锁单细胞数据的无限可能" data-itemshowtype="0" linktype="text" data-linktype="2">趁暑假学会Python，解锁单细胞数据的无限可能</a></span></p></li></ul><ul></ul><p><span leaf=""><br></span></p><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/OXWuQ_9pXTrDscAR4Thoog",target="_blank" rel="noopener noreferrer">原文链接</a>
