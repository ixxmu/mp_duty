---
title: "单细胞测序怎么用来筛靶基因与转录因子 (TFs) ，这篇文章NC提供了很好的方法教程"
date: 2025-06-12T02:12:35Z
draft: ["false"]
tags: [
  "fetched",
  "生信钱同学"
]
categories: ["Acdemic"]
---
单细胞测序怎么用来筛靶基因与转录因子 (TFs) ，这篇文章NC提供了很好的方法教程 by 生信钱同学
------
<div><h2 spellcheck="true" placeholder="标题 1" data-content-editable-leaf="true" data-pm-slice="0 0 []"><span data-token-index="0"><span data-pm-slice="0 0 []"><span leaf=""><span textstyle="">这篇文章能学到啥：这个代码用于分析基因表达数据，以使用线性回归模型确定靶基因与转录因子 (TFs) 之间的关系。该脚本能在不同水平上评估 TF 相互作用，并输出重要发现供进一步分析。</span></span></span></span></h2><section nodeleaf=""><img data-imgfileid="100010182" data-ratio="0.4358974358974359" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvWReSxbHPyia12heicVcb6shiawiamjS21OckiahlrnAqNe6xibBSG4Uz5Dbubknzwh5pCmr7Zj6LKoL3g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="468" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvWReSxbHPyia12heicVcb6shiawiamjS21OckiahlrnAqNe6xibBSG4Uz5Dbubknzwh5pCmr7Zj6LKoL3g/640?wx_fmt=png&amp;from=appmsg"></section><h2 spellcheck="true" placeholder="标题 1" data-content-editable-leaf="true" data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">哈佛团队开发快速诱导技术：4 天从干细胞生成小胶质细胞，为神经疾病研究提供了新方法</span></span></span></h2><p><span leaf="">2025 年 6 月 10 日，《自然・通讯》杂志发表了哈佛大学医学院 George M. Church 团队的一项突破性研究。</span><span data-token-index="1"><span leaf="">科学家们开发出一种迭代转录因子筛选技术，实现了在短短 4 天内将人类诱导多能干细胞（iPSC）高效分化为功能成熟的小胶质细胞样细胞。这一成果不仅将传统分化周期缩短了 80% 以上，滨海构建了小胶质细胞分化的因果基因调控网络，为阿尔茨海默病、肌萎缩侧索硬化症等神经退行性疾病的机制研究和药物开发提供了创新性的细胞模型。</span></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shAMqR2F4Qg3TJVv5OQnxu1H6DzPPZZhC2Rddsmsvyic5t5k2X3QgKKHA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.6231481481481481" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010174" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shAMqR2F4Qg3TJVv5OQnxu1H6DzPPZZhC2Rddsmsvyic5t5k2X3QgKKHA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf="">小胶质细胞作为中枢神经系统的 “免疫哨兵”，在大脑发育、神经稳态维持及阿尔茨海默病（AD）、帕金森病（PD）等疾病进程中扮演关键角色。然而，获取原代人类小胶质细胞需要脑活检，来源极为有限；</span><span data-token-index="1"><span leaf="">而传统 iPSC 分化方法依赖复杂的生长因子鸡尾酒和长达 30-74 天的诱导周期，且分化效率不足 5%。</span></span><span leaf="">需要找到正确的‘蓝图’—— 那些能精准驱动细胞命运转变的转录因子组合</span></p><p><span data-token-index="0"><span leaf="">研究团队首先构建了包含 1732 个人类转录因子的文库，通过生物信息学分析从文献和表观遗传数据中筛选出 40 个与小胶质细胞发育相关的候选转录因子。</span></span><span data-token-index="1"><span leaf="">利用 piggyBac 转座子系统，他们将每个转录因子插入带有 20 核苷酸条形码的诱导表达载体，实现了单细胞水平的转录因子表达追踪</span></span><span leaf="">。这种条形码技术就像给每个细胞装上了‘身份证’，让我们能在数万个细胞中精准定位哪些转录因子组合在发挥作用。</span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shGMCoNFjB8LWaVxF0Rjzw6e8rb2G2RYtiamrjOIbZEFElfMvUxg949KA/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.0888888888888888" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010175" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shGMCoNFjB8LWaVxF0Rjzw6e8rb2G2RYtiamrjOIbZEFElfMvUxg949KA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf="">两轮筛选锁定 “黄金六因子”，分化效率提升 20 倍</span></span></p><p><span data-token-index="0"><span leaf="">通过两轮迭代筛选，研究团队发现了一组 组合：SPI1、CEBPA、FLI1、MEF2C、CEBPB 和 IRF8。</span></span><span data-token-index="1"><span leaf="">首轮筛选中，SPI1（编码 PU.1 蛋白，已知小胶质细胞发育关键因子）、CEBPA（髓系分化调控因子）和 FLI1（与造血祖细胞发育相关）被筛出，但单独或三联组合只能诱导部分小胶质细胞标志物（如 CD11b + 细胞达 37%），关键趋化因子受体 CX3CR1 表达缺失。</span></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shCeM6dcybib6RicDicchvbJpVvzUta7WaGWCpNrcQD1SwiagxTdSwhc786A/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.135185185185185" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010176" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shCeM6dcybib6RicDicchvbJpVvzUta7WaGWCpNrcQD1SwiagxTdSwhc786A/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span leaf="">在第二轮筛选中，研究团队以三联组合为基础，通过比较转录组差异添加新的候选因子。</span><span data-token-index="1"><span leaf="">他们发现 MEF2C 能特异性激活 CX3CR1 表达，CEBPB 和 IRF8 则显著提升 P2RY12 和 TREM2 等核心标志物的表达水平。当六因子通过多顺反子载体以特定顺序（SPI1-FLI1-CEBPA-MEF2C-CEBPB-IRF8）诱导时，分化效率实现质的飞跃：4 天内 66% 的细胞表达 CD11b，93% 表达 P2RY12，16% 表达 CX3CR1，较传统方法提升近 20 倍。</span></span></p><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shPG0UEicnqpOIhtTgHGvtibicicRDpqx9KjXqWJxibEqtoenUTRQK0t3sV3w/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.05" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010177" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shPG0UEicnqpOIhtTgHGvtibicicRDpqx9KjXqWJxibEqtoenUTRQK0t3sV3w/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvWReSxbHPyia12heicVcb6shKRXOfzf8eInkaPngZsQZW7eFCp46j2ld73b7x3cIscCICfTLEaFvGQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7944444444444444" data-s="300,640" data-type="png" data-w="1080" type="block" data-imgfileid="100010173" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvWReSxbHPyia12heicVcb6shKRXOfzf8eInkaPngZsQZW7eFCp46j2ld73b7x3cIscCICfTLEaFvGQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shJfuPbU3voLYSp8CzXmj2UjwFicWgMNfzTpS51u5lcaQxFx53yraDfFw/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="1.112962962962963" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010178" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shJfuPbU3voLYSp8CzXmj2UjwFicWgMNfzTpS51u5lcaQxFx53yraDfFw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shgicEc3tTQ2ahF0RJYCQsz24OicSkEV3BicWjjbOGPoqLz3WEibShlJib0iaQ/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.8935185185185185" data-s="300,640" data-type="jpeg" data-w="1080" type="block" data-imgfileid="100010179" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvWReSxbHPyia12heicVcb6shgicEc3tTQ2ahF0RJYCQsz24OicSkEV3BicWjjbOGPoqLz3WEibShlJib0iaQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><section data-pm-slice="0 0 []"><section><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="生信钱同学云计算" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/WSicobplxKJnfBfE78nfcT75dyMrCMmRyHibYVwNsjOXKcbCatvCgOoWk82wO8wAibtWuTVOJh3oWUIaGj6G2ibzww/0?wx_fmt=png" data-signature="欢迎来到生信钱同学云计算平台服务号，本账号致力于为大家提供最便捷、最好用云计算平台，以及AI科研辅助产品，欢迎持续关注，我们后续将推出一些列高质量科研辅助工具。" data-id="Mzk3NTM1NTgzNA==" data-is_biz_ban="0" data-service_type="2" data-verify_status="0"></mp-common-profile></section><p data-pm-slice="0 0 []"><span data-pm-slice="0 0 []"><span leaf="">（800/年独享生信友好云服务器👆）</span></span></p><section data-pm-slice="0 0 []"><section><section><section><section data-role="title" data-tools="135编辑器" data-id="95707" data-pm-slice="0 0 []"><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_gif/2bvYMoCQeZdiaVjafQy1TPn3uKCGT7qruy86TWEbgNmJ0DjVaVbqTBSQJ7vvQ62HLFuVU9aS0Twf4qK7cib0srmQ/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" alt="图片" data-ratio="0.3525" data-type="gif" data-w="400" data-width="100%" data-imgfileid="100001227" src="https://mmbiz.qpic.cn/sz_mmbiz_gif/2bvYMoCQeZdiaVjafQy1TPn3uKCGT7qruy86TWEbgNmJ0DjVaVbqTBSQJ7vvQ62HLFuVU9aS0Twf4qK7cib0srmQ/640?wx_fmt=gif&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section></section></section><section><section data-cacheurl="" data-fail="0" data-lazy-bgimg="https://mmbiz.qpic.cn/sz_mmbiz_png/o6dficDtnSUQYBmTyJADgsick19ha11MAnuN8P0R3qx8kukicnicX8I4xsU68MfsGVoqOHkSYdJqTSdlJulLRbib5rA/640?wx_fmt=png&amp;from=appmsg" data-remoteid=""><section><section><p><span leaf=""><span textstyle="">生信钱同学团队提供生信便捷式“云服务器”、“数据分析”、“生信学习班”以及“生信交流群”等内容，有需要者可以加我：sx_qtx01</span></span></p></section></section><section><p><span leaf="">相关推文内容：</span></p><p><span leaf="">1.<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzk3NTM1NTgzNA==&amp;mid=2247483691&amp;idx=1&amp;sn=6df74111468228086d4b3f36111e9642&amp;scene=21#wechat_redirect" textvalue="代码更新了，想要跑通整套单细胞分析流程的，可以试试这个新的代码" data-itemshowtype="11" linktype="text" data-linktype="2">代码更新了，想要跑通整套单细胞分析流程的，可以试试这个新的代码</a><span textstyle="">（800💰/年独享云服务器）</span></span></p><p><span leaf="">2.<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" textvalue="不吹不黑，你想知道生信需要掌握哪些，光看这个大纲就会有不少收获" data-itemshowtype="0" linktype="text" data-linktype="2">不吹不黑，你想知道生信需要掌握哪些，光看这个大纲就会有不少收获</a><span textstyle="">（生信空间和单细胞学习班）</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247493783&amp;idx=1&amp;sn=aca0bda8459a3d0b68a7bce4cd9486d3&amp;scene=21#wechat_redirect" textvalue="课大幅度调整了，没服务器直接送——多组学与机器学习联合分析（机器学习分析代谢组、蛋白组、宏基因组、网络药理学、转录组）" data-itemshowtype="0" linktype="text" data-linktype="2">课大幅度调整了，没服务器直接送——多组学与机器学习联合分析（机器学习分析代谢组、蛋白组、宏基因组、网络药理学、转录组）</a><span textstyle="">（机器学习班）</span></span></p><p><span leaf="">3.<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247490275&amp;idx=1&amp;sn=200ccc0a415860f9d73b9068657096ff&amp;scene=21#wechat_redirect" textvalue="没有服务器，单细胞数据搞不定？我们目前做好了这些pipeline，可以帮你做" data-itemshowtype="0" linktype="text" data-linktype="2">没有服务器，单细胞数据搞不定？我们目前做好了这些pipeline，可以帮你做</a><span textstyle="">(数据分析)</span></span></p></section></section></section></section></section></section><p><span leaf=""><br></span></p><section data-role="outer" label="Powered by 135editor.com onekey" data-pm-slice="0 0 []"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p><span leaf=""><span textstyle="">Iterative transcription factor screening enables rapid generation of microglia-like cells from human iPSC. Nat Commun 16, 5136 (2025).</span></span></p><p data-brushtype="text" data-pm-slice="0 0 []"><strong><span leaf="">后苔↩️之前贴子的岸号即可霍得之前的</span></strong></p><p data-brushtype="text"><strong><strong><strong><strong data-pm-slice="0 0 []"><span leaf="">代码，今日关键词：250612</span></strong></strong></strong></strong></p></section></section></section></section></section></section></section><p><span leaf=""><span textstyle="">核心代码：</span></span><span leaf=""><span textstyle="">用生信确定靶基因与转录因子 (TFs) 之间的关系</span></span></p></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span leaf=""><span>#!/usr/bin/Rscript</span></span></code><code><span leaf=""><span>### 小胶质细胞分化相关基因调控网络分析脚本</span></span></code><code><span leaf=""><span>### 功能：基于迭代转录因子筛选数据，构建转录因子与靶基因的剂量效应模型</span></span></code><code><span leaf=""><span>### 引用文献关键内容：通过逐步回归构建TF-gene调控网络（段落1-104至1-106）</span></span></code><code><span leaf=""><span># --------------------------</span></span></code><code><span leaf=""><span># 1. 数据加载与预处理</span></span></code><code><span leaf=""><span># --------------------------</span></span></code><code><span leaf=""><span># 读取标准化转录因子表达矩阵（包含40个TF及靶基因表达数据）</span></span></code><code><span leaf=""><span># 矩阵结构：行=细胞样本，列=40个TF+1个靶基因</span></span></code><code><span leaf="">combined_matrix &lt;- readRDS(<span>"input_files/tf_allgenes_normalized_matrix_2020-01-10.rds"</span>)</span></code><code><span leaf=""><span># 读取SCTransform处理后的基因索引（用于指定分析的靶基因列表）</span></span></code><code><span leaf=""><span># 索引对应文献中筛选出的小胶质细胞相关基因（如CX3CR1、P2RY12等）</span></span></code><code><span leaf="">index &lt;- readRDS(<span>"SCT_genes_index.rds"</span>)</span></code><code><span leaf=""><span># --------------------------</span></span></code><code><span leaf=""><span># 2. 靶基因-转录因子剂量效应建模</span></span></code><code><span leaf=""><span># --------------------------</span></span></code><code><span leaf=""><span># 循环遍历每个靶基因（基于SCT_genes_index.rds索引）</span></span></code><code><span leaf=""><span>for</span> (i <span>in</span> index) {</span></code><code><span leaf="">  <span># 提取当前靶基因与40个TF的表达数据</span></span></code><code><span leaf="">  <span># 转置矩阵使行为样本，列为变量（40个TF+1个靶基因）</span></span></code><code><span leaf="">  mat_nor &lt;- t(combined_matrix[c(1:40, i),])  </span></code><code><span leaf="">  col_genename &lt;- colnames(mat_nor)[41]  <span># 获取当前靶基因名称</span></span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 重命名靶基因列为"gene1"以统一建模格式</span></span></code><code><span leaf="">  colnames(mat_nor)[41] &lt;- <span>"gene1"</span> </span></code><code><span leaf="">  mat_nor &lt;- as.data.frame(mat_nor)  <span># 转换为数据框便于建模</span></span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 2.1 四次方交互效应模型</span></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 构建包含TF四次方交互项的线性模型</span></span></code><code><span leaf="">  <span># 模型公式包含22个关键TF（对应文献中六因子组合及相关调控因子）</span></span></code><code><span leaf="">  fit4 &lt;- lm(gene1 ~ (tf_BHLHE41 + tf_CEBPA + tf_BATF + tf_TAL1 + tf_BATF3 +</span></code><code><span leaf="">                      tf_FOS + tf_MAFF + tf_MNDA + tf_SPI1 + tf_CEBPB +</span></code><code><span leaf="">                      tf_MAFB + tf_HCLS1 + tf_IRF8 + tf_EGR2 + tf_IRF1 +</span></code><code><span leaf="">                      tf_CIITA + tf_IFI16 + tf_MEF2C + tf_JUN + tf_IRF5 +</span></code><code><span leaf="">                      tf_ZFP36 + tf_JUNB)^4, </span></code><code><span leaf="">            data = mat_nor)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 提取模型系数与显著性检验结果</span></span></code><code><span leaf="">  gene1_lm_res_fit4 &lt;- data.frame(</span></code><code><span leaf="">    coefficients = summary(fit4)<span>$coefficients</span>[, 1],</span></code><code><span leaf="">    pvalue = summary(fit4)<span>$coefficients</span>[, 4]</span></code><code><span leaf="">  )</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 筛选p&lt;0.01的显著调控关系</span></span></code><code><span leaf="">  gene1_lm_res_sel_fit4 &lt;- subset(gene1_lm_res_fit4, pvalue &lt; 0.01)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 提取前23个TF的单因子效应（对应文献中核心TF组合）</span></span></code><code><span leaf="">  gene1_lm_res_single_fit4 &lt;- gene1_lm_res_fit4[1:23, ]</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 输出结果至文件（用于构建调控网络）</span></span></code><code><span leaf="">  write.table(gene1_lm_res_sel_fit4, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_fit4.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf="">  write.table(gene1_lm_res_single_fit4, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_singletf_fit4.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 2.2 三次方交互效应模型</span></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 构建包含TF三次方交互项的线性模型（降低模型复杂度）</span></span></code><code><span leaf="">  fit3 &lt;- lm(gene1 ~ (tf_BHLHE41 + tf_CEBPA + tf_BATF + tf_TAL1 + tf_BATF3 +</span></code><code><span leaf="">                      tf_FOS + tf_MAFF + tf_MNDA + tf_SPI1 + tf_CEBPB +</span></code><code><span leaf="">                      tf_MAFB + tf_HCLS1 + tf_IRF8 + tf_EGR2 + tf_IRF1 +</span></code><code><span leaf="">                      tf_CIITA + tf_IFI16 + tf_MEF2C + tf_JUN + tf_IRF5 +</span></code><code><span leaf="">                      tf_ZFP36 + tf_JUNB)^3, </span></code><code><span leaf="">            data = mat_nor)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 同理提取并输出模型结果</span></span></code><code><span leaf="">  gene1_lm_res_fit3 &lt;- data.frame(</span></code><code><span leaf="">    coefficients = summary(fit3)<span>$coefficients</span>[, 1],</span></code><code><span leaf="">    pvalue = summary(fit3)<span>$coefficients</span>[, 4]</span></code><code><span leaf="">  )</span></code><code><span leaf="">  gene1_lm_res_sel_fit3 &lt;- subset(gene1_lm_res_fit3, pvalue &lt; 0.01)</span></code><code><span leaf="">  gene1_lm_res_single_fit3 &lt;- gene1_lm_res_fit3[1:23, ]</span></code><code><span leaf=""><br></span></code><code><span leaf="">  write.table(gene1_lm_res_sel_fit3, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_fit3.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf="">  write.table(gene1_lm_res_single_fit3, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_singletf_fit3.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 2.3 二次方交互效应模型</span></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 构建包含TF二次方交互项的线性模型</span></span></code><code><span leaf="">  fit2 &lt;- lm(gene1 ~ (tf_BHLHE41 + tf_CEBPA + tf_BATF + tf_TAL1 + tf_BATF3 +</span></code><code><span leaf="">                      tf_FOS + tf_MAFF + tf_MNDA + tf_SPI1 + tf_CEBPB +</span></code><code><span leaf="">                      tf_MAFB + tf_HCLS1 + tf_IRF8 + tf_EGR2 + tf_IRF1 +</span></code><code><span leaf="">                      tf_CIITA + tf_IFI16 + tf_MEF2C + tf_JUN + tf_IRF5 +</span></code><code><span leaf="">                      tf_ZFP36 + tf_JUNB)^2, </span></code><code><span leaf="">            data = mat_nor)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 提取并输出模型结果</span></span></code><code><span leaf="">  gene1_lm_res_fit2 &lt;- data.frame(</span></code><code><span leaf="">    coefficients = summary(fit2)<span>$coefficients</span>[, 1],</span></code><code><span leaf="">    pvalue = summary(fit2)<span>$coefficients</span>[, 4]</span></code><code><span leaf="">  )</span></code><code><span leaf="">  gene1_lm_res_sel_fit2 &lt;- subset(gene1_lm_res_fit2, pvalue &lt; 0.01)</span></code><code><span leaf="">  gene1_lm_res_single_fit2 &lt;- gene1_lm_res_fit2[1:23, ]</span></code><code><span leaf=""><br></span></code><code><span leaf="">  write.table(gene1_lm_res_sel_fit2, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_fit2.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf="">  write.table(gene1_lm_res_single_fit2, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_singletf_fit2.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 2.4 单因子线性模型</span></span></code><code><span leaf="">  <span># --------------------------</span></span></code><code><span leaf="">  <span># 构建不包含交互项的单因子线性模型（对照模型）</span></span></code><code><span leaf="">  fit1 &lt;- lm(gene1 ~ tf_BHLHE41 + tf_CEBPA + tf_BATF + tf_TAL1 + tf_BATF3 +</span></code><code><span leaf="">              tf_FOS + tf_MAFF + tf_MNDA + tf_SPI1 + tf_CEBPB +</span></code><code><span leaf="">              tf_MAFB + tf_HCLS1 + tf_IRF8 + tf_EGR2 + tf_IRF1 +</span></code><code><span leaf="">              tf_CIITA + tf_IFI16 + tf_MEF2C + tf_JUN + tf_IRF5 +</span></code><code><span leaf="">              tf_ZFP36 + tf_JUNB, </span></code><code><span leaf="">            data = mat_nor)</span></code><code><span leaf=""><br></span></code><code><span leaf="">  <span># 提取并输出模型结果</span></span></code><code><span leaf="">  gene1_lm_res_fit1 &lt;- data.frame(</span></code><code><span leaf="">    coefficients = summary(fit1)<span>$coefficients</span>[, 1],</span></code><code><span leaf="">    pvalue = summary(fit1)<span>$coefficients</span>[, 4]</span></code><code><span leaf="">  )</span></code><code><span leaf="">  gene1_lm_res_sel_fit1 &lt;- subset(gene1_lm_res_fit1, pvalue &lt; 0.01)</span></code><code><span leaf="">  gene1_lm_res_single_fit1 &lt;- gene1_lm_res_fit1[1:23, ]</span></code><code><span leaf=""><br></span></code><code><span leaf="">  write.table(gene1_lm_res_sel_fit1, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_fit1.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf="">  write.table(gene1_lm_res_single_fit1, </span></code><code><span leaf="">              file = <span>paste</span>(<span>"output_files_3000/"</span>, col_genename, <span>"_lm_res_singletf_fit1.txt"</span>, sep = <span>""</span>),</span></code><code><span leaf="">              quote = F, sep = <span>"\t"</span>, row.names = T)</span></code><code><span leaf="">}</span></code></pre></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/sYfeUhhsDYQDhOAiFFGf5A",target="_blank" rel="noopener noreferrer">原文链接</a>
