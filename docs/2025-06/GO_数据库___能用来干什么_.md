---
title: "GO 数据库 - 能用来干什么？"
date: 2025-06-17T02:54:41Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
GO 数据库 - 能用来干什么？ by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">GO 数据库是用来</span><font><span leaf="">反映当前科学界对基因产物（如蛋白质、非编码 RNA、大分子复合物或简化的基因）功能的认识。GO 涵盖从分子活动到复杂细胞及生物体层面网络的整个生物系统层次，提供适用于整个生命树中所有基因产物的统一描述符。</span></font></p><p data-tool="mdnice编辑器"><font><span leaf="">所以 GO 数据库就存在两种文件信息：</span></font></p><ul><li><section><span leaf="">Gene ontology files</span></section></li><li><section><span leaf="">Annotations files</span></section></li></ul><p data-tool="mdnice编辑器"><code><span leaf="">Gene ontology files</span></code><span leaf=""> 里面的信息是规定的各种生物术语，这个文件是和物种没有关系的，知识规定了各种生物术语及不同生物术语间的关系。</span></p><p data-tool="mdnice编辑器"><code><span leaf="">Annttations files</span></code><span leaf=""> 是一个物种特异性文件，不同的物种的不同的基因对应一个和多个 GO 术语。通俗来说就是这个文件是注释不同物种的基因对应的生物术语。</span></p><p data-tool="mdnice编辑器"><span leaf="">因此将这两个文件信息联系起来就可以完成很多基因 GO 注释功能。</span></p><p data-tool="mdnice编辑器"><span leaf="">那么 GO 数据库能具体用来干什么呢？</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">GO 分类分析</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">groupGO</span></span><span></span></h3><blockquote><span></span><p><span leaf="">知道了基因 ID，最直接的就是看一下这个基因的都有哪些 GO 术语。</span><code><span leaf="">clusterProfiler</span></code><span leaf=""> 包提供函数 </span><code><span leaf="">groupGO</span></code><span leaf=""> 可以对基因在特定层级进行 GO 分类。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">GO 分类可能很难让人理解，但又不同于 GO 注释，可以这么详细的说明。</span></p><section><span leaf="">GO 是一个有向无环图（DAG），其中节点表示 GO term，边表示层级关系。每个 GO term 都位于某个层级，根节点是最顶层，随着层级增加，描述变得更具体。比如 GO:0016597</span><font><span leaf=""> 这么看就在第三层级中。</span></font></section><section nodeleaf=""><img data-imgfileid="100051368" data-ratio="0.9928741092636579" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZdeSYicvzov8UAibgjCQzR5cUtk4HRgHPxen42yIsqOZz3U7nDkCfbOiaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="842" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZdeSYicvzov8UAibgjCQzR5cUtk4HRgHPxen42yIsqOZz3U7nDkCfbOiaw/640?wx_fmt=png&amp;from=appmsg"></section><figure data-tool="mdnice编辑器"><span leaf=""><br></span></figure><section><span leaf="">但是</span><font><span leaf="">GO 术语在层级结构中并不占据严格固定的层级。由于 GO 是以图结构组织的，如果沿着图中的不同路径追踪，术语会出现在不同的"层级"上。当混合使用连接术语的不同关系时，这种情况尤为明显。比如这个 </span></font><code><span leaf="">[GO:0051348](https://www.ebi.ac.uk/QuickGO/term/GO:0051348)</span></code><font><span leaf="">可能距离根术语有 3、4 或 5 个层级。[</span></font><span leaf="">来源</span><font><span leaf="">]</span></font></section><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051345" data-ratio="0.8044692737430168" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZMXWCEBJxw8I2jVdsewtklS1soWVcFm0GzVUuzzfyqnIQvT4ogasmCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="716" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZMXWCEBJxw8I2jVdsewtklS1soWVcFm0GzVUuzzfyqnIQvT4ogasmCA/640?wx_fmt=png&amp;from=appmsg"></span></figure><section><font><span leaf="">clusterProfiler 会从 GO 本体结构的</span></font><strong><font><span leaf="">根节点</span></font></strong><font><span leaf="">（如 </span></font><code><span leaf="">GO:0008150</span></code><font><span leaf=""> 生物过程）开始，逐层向下遍历所有术语。算法会遍历整个 DAG，计算每个节点到根节点的</span></font><strong><font><span leaf="">最长路径长度</span></font></strong><font><span leaf="">（即层级深度）。</span></font></section><section><font><span leaf="">确定了不同术语所在的层级，就可以根据将基因分配给不同的术语，因此这里叫基因 GO 分类，因为是现有的 GO 术语，再有的基因，将基因分类给不同的 GO term。</span></font></section><section><font><span leaf="">所以就需要确定我们需要将基因分配给哪个水平的的 GO term。</span></font></section><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 加载包</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(clusterProfiler)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(org.Hs.eg.db)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf=""># 这里使用 DOSE 包中的数据，随机得到一些基因 ID 用于分析。</span></span><span leaf=""><br></span><span leaf="">data(geneList, package=</span><span><span leaf="">"DOSE"</span></span><span leaf="">)  </span><span><span leaf=""># 从 DOSE 包中加载示例数据集 geneList</span></span><span leaf=""><br></span><span leaf="">gene &lt;- names(geneList)[abs(geneList) &gt; </span><span><span leaf="">2</span></span><span leaf="">]  </span><span><span leaf=""># 筛选出 geneList 中绝对值大于 2 的基因名称</span></span><span leaf=""><br></span><span leaf="">head(gene)  </span><span><span leaf=""># 显示 gene 向量的前几个基因名称</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ggo &lt;- groupGO(gene     = gene,          </span><span><span leaf=""># 使用 groupGO 函数对 gene 向量进行 GO 分组分析</span></span><span leaf=""><br></span><span leaf="">               OrgDb    = org.Hs.eg.db,  </span><span><span leaf=""># 指定使用 org.Hs.eg.db 数据库，这里是人类基因数据库</span></span><span leaf=""><br></span><span leaf="">               ont      = </span><span><span leaf="">"MF"</span></span><span leaf="">,          </span><span><span leaf=""># 指定 GO 分类为分子功能（Molecular Function）</span></span><span leaf=""><br></span><span leaf="">               level    = </span><span><span leaf="">3</span></span><span leaf="">,             </span><span><span leaf=""># 设置分析的 GO 层级为 3</span></span><span leaf=""><br></span><span leaf="">               readable = </span><span><span leaf="">TRUE</span></span><span leaf="">)          </span><span><span leaf=""># 将基因 ID 转换为可读的基因名称</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">                   ID                               Description Count GeneRatio                                             geneID</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000146</span></span><span leaf=""> GO:</span><span><span leaf="">0000146</span></span><span leaf="">              microfilament motor activity     </span><span><span leaf="">1</span></span><span leaf="">     </span><span><span leaf="">1</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf="">                                              MYH11</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0003777</span></span><span leaf=""> GO:</span><span><span leaf="">0003777</span></span><span leaf="">                microtubule motor activity     </span><span><span leaf="">8</span></span><span leaf="">     </span><span><span leaf="">8</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf=""> KIF23/CENPE/KIF18A/KIF11/KIFC1/KIF18B/KIF20A/KIF4A</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0061791</span></span><span leaf=""> GO:</span><span><span leaf="">0061791</span></span><span leaf="">                     GTPase motor activity     </span><span><span leaf="">0</span></span><span leaf="">     </span><span><span leaf="">0</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf="">                                                   </span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0140605</span></span><span leaf=""> GO:</span><span><span leaf="">0140605</span></span><span leaf=""> proton motive force-driven motor activity     </span><span><span leaf="">0</span></span><span leaf="">     </span><span><span leaf="">0</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf="">                                                   </span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0004133</span></span><span leaf=""> GO:</span><span><span leaf="">0004133</span></span><span leaf="">      glycogen debranching enzyme activity     </span><span><span leaf="">0</span></span><span leaf="">     </span><span><span leaf="">0</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf="">                                                   </span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0009975</span></span><span leaf=""> GO:</span><span><span leaf="">0009975</span></span><span leaf="">                          cyclase activity     </span><span><span leaf="">0</span></span><span leaf="">     </span><span><span leaf="">0</span></span><span leaf="">/</span><span><span leaf="">207</span></span><span leaf=""> </span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">可以看到，在 MF 这一大类的 level 3 下，基因被分类给了不同的 term.</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">GO 过表达分析</span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">enrichGO</span></span><span></span></h3><blockquote><span></span><p><span leaf="">不同于单个基因，当有多个基因时，我们就可以知道，这些基因显著聚集在哪些条目中，然后就知道我们关注的基因集大多起到什么功能。基本原理是 </span><code><span leaf=""> 过表达分析 (over-representation analysis)</span></code><span leaf="">。</span><code><span leaf="">clusterProfiler</span></code><span leaf=""> 包提供函数 </span><code><span leaf="">enrichGO</span></code><span leaf=""> 可以对一组基因在进行 GO 过表达分析。</span></p></blockquote><p data-tool="mdnice编辑器"><span leaf="">这个分析不对 GO terms 进行层级划分，考虑到了所有相关的 GO 术语，</span><font><span leaf="">而不论它们在 GO 结构中的具体层级。</span></font></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ego &lt;- enrichGO(gene          = gene,          </span><span><span leaf=""># 使用 enrichGO 函数对 gene 向量进行 GO 富集分析</span></span><span leaf=""><br></span><span leaf="">                universe      = names(geneList), </span><span><span leaf=""># 指定背景基因集，通常是所有可能的基因</span></span><span leaf=""><br></span><span leaf="">                OrgDb         = org.Hs.eg.db,   </span><span><span leaf=""># 使用 org.Hs.eg.db 数据库进行基因注释</span></span><span leaf=""><br></span><span leaf="">                ont           = </span><span><span leaf="">"CC"</span></span><span leaf="">,           </span><span><span leaf=""># 指定 GO 分类为细胞组分（Cellular Component）</span></span><span leaf=""><br></span><span leaf="">                pAdjustMethod = </span><span><span leaf="">"BH"</span></span><span leaf="">,           </span><span><span leaf=""># 使用 Benjamini-Hochberg 方法调整 p 值</span></span><span leaf=""><br></span><span leaf="">                pvalueCutoff  = </span><span><span leaf="">0.01</span></span><span leaf="">,           </span><span><span leaf=""># 设置显著性检验的 p 值阈值</span></span><span leaf=""><br></span><span leaf="">                qvalueCutoff  = </span><span><span leaf="">0.05</span></span><span leaf="">,           </span><span><span leaf=""># 设置显著性检验的 q 值阈值</span></span><span leaf=""><br></span><span leaf="">                readable      = </span><span><span leaf="">TRUE</span></span><span leaf="">)           </span><span><span leaf=""># 将基因 ID 转换为可读的基因名称</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">head(ego)  </span><span><span leaf=""># 显示 GO 富集分析结果的前几行</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">                   ID                              Description GeneRatio   BgRatio RichFactor FoldEnrichment    zScore       pvalue     p.adjust       qvalue</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000775</span></span><span leaf=""> GO:</span><span><span leaf="">0000775</span></span><span leaf="">           chromosome, centromeric region    </span><span><span leaf="">21</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">196</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.10714286</span></span><span leaf="">       </span><span><span leaf="">6.343284</span></span><span><span leaf="">9.886623</span></span><span><span leaf="">1.422125e-11</span></span><span><span leaf="">4.024615e-09</span></span><span><span leaf="">3.637647e-09</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000779</span></span><span leaf=""> GO:</span><span><span leaf="">0000779</span></span><span leaf=""> condensed chromosome, centromeric region    </span><span><span leaf="">18</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">145</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.12413793</span></span><span leaf="">       </span><span><span leaf="">7.349460</span></span><span><span leaf="">10.082967</span></span><span><span leaf="">3.719635e-11</span></span><span><span leaf="">5.138722e-09</span></span><span><span leaf="">4.644633e-09</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0072686</span></span><span leaf=""> GO:</span><span><span leaf="">0072686</span></span><span leaf="">                          mitotic spindle    </span><span><span leaf="">18</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">153</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.11764706</span></span><span leaf="">       </span><span><span leaf="">6.965174</span></span><span><span leaf="">9.733841</span></span><span><span leaf="">9.226677e-11</span></span><span><span leaf="">5.138722e-09</span></span><span><span leaf="">4.644633e-09</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0005819</span></span><span leaf=""> GO:</span><span><span leaf="">0005819</span></span><span leaf="">                                  spindle    </span><span><span leaf="">26</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">339</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.07669617</span></span><span leaf="">       </span><span><span leaf="">4.540718</span></span><span><span leaf="">8.669068</span></span><span><span leaf="">9.727050e-11</span></span><span><span leaf="">5.138722e-09</span></span><span><span leaf="">4.644633e-09</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000793</span></span><span leaf=""> GO:</span><span><span leaf="">0000793</span></span><span leaf="">                     condensed chromosome    </span><span><span leaf="">21</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">217</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.09677419</span></span><span leaf="">       </span><span><span leaf="">5.729417</span></span><span><span leaf="">9.215931</span></span><span><span leaf="">9.895898e-11</span></span><span><span leaf="">5.138722e-09</span></span><span><span leaf="">4.644633e-09</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000776</span></span><span leaf=""> GO:</span><span><span leaf="">0000776</span></span><span leaf="">                              kinetochore    </span><span><span leaf="">17</span></span><span leaf="">/</span><span><span leaf="">201</span></span><span><span leaf="">136</span></span><span leaf="">/</span><span><span leaf="">11900</span></span><span><span leaf="">0.12500000</span></span><span leaf="">       </span><span><span leaf="">7.400498</span></span><span><span leaf="">9.839761</span></span><span><span leaf="">1.191495e-10</span></span><span><span leaf="">5.138722e-09</span></span><span><span leaf="">4.644633e-09</span></span><span leaf=""><br></span><span leaf="">                                                                                                                                                              geneID</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000775</span></span><span leaf="">                                CDCA8/CDC20/CENPE/NDC80/TOP2A/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/EZH2/TTK/NCAPG/AURKB/AURKA/CCNB1</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000779</span></span><span leaf="">                                                 CDC20/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/AURKA/CCNB1</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0072686</span></span><span leaf="">                                               KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/CDK1/MAD2L1/KIF18A/KIF11/TRAT1/AURKB/PRC1/KIFC1/KIF18B/AURKA</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0005819</span></span><span leaf=""> CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TRAT1/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000793</span></span><span leaf="">                               CDC20/CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/CHEK1/AURKA/CCNB1</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000776</span></span><span leaf="">                                                       CDC20/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/AURKA/CCNB1</span><span leaf=""><br></span><span leaf="">           Count</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000775</span></span><span leaf="">    </span><span><span leaf="">21</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000779</span></span><span leaf="">    </span><span><span leaf="">18</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0072686</span></span><span leaf="">    </span><span><span leaf="">18</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0005819</span></span><span leaf="">    </span><span><span leaf="">26</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000793</span></span><span leaf="">    </span><span><span leaf="">21</span></span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000776</span></span><span leaf="">    </span><span><span leaf="">17</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">可视化</span></span><span></span></h4><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">点图</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">dotplot(ego, showCategory=</span><span><span leaf="">15</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  ggview::canvas(</span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">"cm"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051347" data-ratio="1.0064020486555698" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZicvBnuH1QWJq2pnJzjYOUtRaoT46NKicvBFp0jL2V9MV1yPK4OEVym0A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="781" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZicvBnuH1QWJq2pnJzjYOUtRaoT46NKicvBFp0jL2V9MV1yPK4OEVym0A/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">柱状图</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">barplot(ego, showCategory=</span><span><span leaf="">15</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  ggview::canvas(</span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">"cm"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051348" data-ratio="1.0038461538461538" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZhYdu3oukFr9WXO5kiclFbRambmSuBQgjfibzfYlKI72sXEsSJh3yGU1Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="780" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZhYdu3oukFr9WXO5kiclFbRambmSuBQgjfibzfYlKI72sXEsSJh3yGU1Q/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">网络图</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cnetplot(ego, </span><span><span leaf="">5</span></span><span leaf="">, categorySize=</span><span><span leaf="">"pvalue"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051346" data-ratio="0.8514644351464435" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZxibF1uLpCEMDE8EGc5KLX7hWrNL61DINd2CT3fZWeXrMlr1oWs03rNw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="956" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZxibF1uLpCEMDE8EGc5KLX7hWrNL61DINd2CT3fZWeXrMlr1oWs03rNw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">有向无环图</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">goplot(ego, </span><span><span leaf="">20</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  ggview::canvas(</span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">20</span></span><span leaf="">, </span><span><span leaf="">"cm"</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051349" data-ratio="1.0025445292620865" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZwE2LMDO0Bo23EVsaqrNdkVFrMw1yZ7CQOTd8cPBia9OWib8P0sawjapA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="786" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZwE2LMDO0Bo23EVsaqrNdkVFrMw1yZ7CQOTd8cPBia9OWib8P0sawjapA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">拓展：</span></span><span></span></h5><p data-tool="mdnice编辑器"><span leaf="">GOplot: https://wencke.github.io/</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">GO 基因集富集分析</span></span><span></span></h2><blockquote><span></span><p><span leaf="">不同与 ORA 富集分析，</span><font><span leaf="">基因集富集分析（Gene Set Enrichment Analysis, GSEA）也是一种计算方法，用于确定预定义的基因集在不同的生物状态下是否具有显著的统计富集。</span></font></p></blockquote><p data-tool="mdnice编辑器"><font></font></p><p data-tool="mdnice编辑器"><strong><font><span leaf="">GSEA 的核心步骤：</span></font></strong></p><ol><li><section><strong><font><span leaf="">排序基因列表</span></font></strong><font><span leaf="">: 根据某种表型（如疾病 vs. 正常）的表达差异，将所有基因按某种统计量（如 t 值、fold change 等）排序。</span></font></section></li><li><section><strong><font><span leaf="">预定义基因集</span></font></strong><font><span leaf="">: 使用预先定义的基因集，这些基因集通常基于某些生物学特征、通路或功能。</span></font></section></li><li><section><strong><font><span leaf="">计算富集分数（Enrichment Score, ES）</span></font></strong><font><span leaf="">:</span></font></section></li></ol><ul><li><section><font><span leaf="">沿着排序的基因列表进行遍历，每遇到基因集中的基因时增加分数，未遇到时减少分数。</span></font></section></li><li><section><font><span leaf="">通过这种方式计算出每个基因集的富集分数，反映了基因集在排序列表中的分布是否偏向于列表的顶端或底端。</span></font></section></li></ul><li><section><strong><font><span leaf="">统计显著性评估</span></font></strong><font><span leaf="">:</span></font></section></li><ul><li><section><font><span leaf="">使用置换测试（permutation test）来评估富集分数的显著性，即通过随机打乱基因标签多次计算富集分数，生成一个随机分布。</span></font></section></li><li><section><font><span leaf="">计算实际富集分数在随机分布中的位置，以获得 p 值。</span></font></section></li></ul><li><section><strong><font><span leaf="">多重检验校正</span></font></strong><font><span leaf="">: 使用方法（如 FDR，False Discovery Rate）对多个基因集的显著性结果进行校正，以控制假阳性率。</span></font></section></li><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">gseGO</span></span><span></span></h3><blockquote><span></span><p><code><span leaf="">clusterProfiler</span></code><span leaf=""> 包提供函数 </span><code><span leaf="">gseGO</span></code><span leaf=""> 可以对一组基因在进行 GO </span><font><span leaf="">基因集富集分析</span></font><span leaf="">。基于上面的极少，这个函数使用的预定义基因集就是 GO 基因集。</span></p></blockquote><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">ego3 &lt;- gseGO(geneList     = geneList,     </span><span><span leaf=""># 使用 gseGO 函数对 geneList 进行基因集富集分析</span></span><span leaf=""><br></span><span leaf="">              OrgDb        = org.Hs.eg.db, </span><span><span leaf=""># 使用 org.Hs.eg.db 数据库进行基因注释</span></span><span leaf=""><br></span><span leaf="">              ont          = </span><span><span leaf="">"CC"</span></span><span leaf="">,         </span><span><span leaf=""># 指定 GO 分类为细胞组分（Cellular Component）</span></span><span leaf=""><br></span><span leaf="">              minGSSize    = </span><span><span leaf="">100</span></span><span leaf="">,          </span><span><span leaf=""># 设置基因集的最小大小为 100</span></span><span leaf=""><br></span><span leaf="">              maxGSSize    = </span><span><span leaf="">500</span></span><span leaf="">,          </span><span><span leaf=""># 设置基因集的最大大小为 500</span></span><span leaf=""><br></span><span leaf="">              pvalueCutoff = </span><span><span leaf="">0.05</span></span><span leaf="">,         </span><span><span leaf=""># 设置显著性检验的 p 值阈值</span></span><span leaf=""><br></span><span leaf="">              verbose      = </span><span><span leaf="">FALSE</span></span><span leaf="">)        </span><span><span leaf=""># 不显示详细的运行信息</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">head(ego3)  </span><span><span leaf=""># 显示基因集富集分析结果的前几行</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">                  ID                              Description setSize enrichmentScore      NES pvalue     p.adjust       qvalue rank                   leading_edge</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000779</span></span><span leaf=""> GO:</span><span><span leaf="">0000779</span></span><span leaf=""> condensed chromosome, centromeric region     </span><span><span leaf="">145</span></span><span leaf="">       </span><span><span leaf="">0.6279995</span></span><span><span leaf="">2.712231</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">798</span></span><span leaf="">  tags=</span><span><span leaf="">25</span></span><span leaf="">%, list=</span><span><span leaf="">6</span></span><span leaf="">%, signal=</span><span><span leaf="">24</span></span><span leaf="">%</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000775</span></span><span leaf=""> GO:</span><span><span leaf="">0000775</span></span><span leaf="">           chromosome, centromeric region     </span><span><span leaf="">196</span></span><span leaf="">       </span><span><span leaf="">0.5994778</span></span><span><span leaf="">2.666395</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">798</span></span><span leaf="">  tags=</span><span><span leaf="">22</span></span><span leaf="">%, list=</span><span><span leaf="">6</span></span><span leaf="">%, signal=</span><span><span leaf="">21</span></span><span leaf="">%</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000776</span></span><span leaf=""> GO:</span><span><span leaf="">0000776</span></span><span leaf="">                              kinetochore     </span><span><span leaf="">136</span></span><span leaf="">       </span><span><span leaf="">0.6204086</span></span><span><span leaf="">2.661122</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">767</span></span><span leaf="">  tags=</span><span><span leaf="">23</span></span><span leaf="">%, list=</span><span><span leaf="">6</span></span><span leaf="">%, signal=</span><span><span leaf="">22</span></span><span leaf="">%</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000228</span></span><span leaf=""> GO:</span><span><span leaf="">0000228</span></span><span leaf="">                       nuclear chromosome     </span><span><span leaf="">173</span></span><span leaf="">       </span><span><span leaf="">0.5897567</span></span><span><span leaf="">2.592932</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">1905</span></span><span leaf=""> tags=</span><span><span leaf="">34</span></span><span leaf="">%, list=</span><span><span leaf="">15</span></span><span leaf="">%, signal=</span><span><span leaf="">29</span></span><span leaf="">%</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0098687</span></span><span leaf=""> GO:</span><span><span leaf="">0098687</span></span><span leaf="">                       chromosomal region     </span><span><span leaf="">317</span></span><span leaf="">       </span><span><span leaf="">0.5412984</span></span><span><span leaf="">2.545717</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">1804</span></span><span leaf=""> tags=</span><span><span leaf="">28</span></span><span leaf="">%, list=</span><span><span leaf="">14</span></span><span leaf="">%, signal=</span><span><span leaf="">24</span></span><span leaf="">%</span><span leaf=""><br></span><span leaf="">GO:</span><span><span leaf="">0000793</span></span><span leaf=""> GO:</span><span><span leaf="">0000793</span></span><span leaf="">                     condensed chromosome     </span><span><span leaf="">217</span></span><span leaf="">       </span><span><span leaf="">0.5549135</span></span><span><span leaf="">2.502915</span></span><span><span leaf="">1e-10</span></span><span><span leaf="">1.390909e-09</span></span><span><span leaf="">8.899522e-10</span></span><span><span leaf="">919</span></span><span leaf="">  tags=</span><span><span leaf="">21</span></span><span leaf="">%, list=</span><span><span leaf="">7</span></span><span leaf="">%, signal=</span><span><span leaf="">20</span></span><span leaf="">%</span><span leaf=""><br></span></code></pre><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">可视化</span></span><span></span></h4><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">enrichplot</span></span><span></span></h5><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(enrichplot)</span><span leaf=""><br></span><span leaf="">gseaplot2(ego3, geneSetID = </span><span><span leaf="">1</span></span><span leaf="">, title = ego3$Description[</span><span><span leaf="">1</span></span><span leaf="">])</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051353" data-ratio="0.7901828681424446" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZpl41BKVT2TISvadSdQoKtybbTYg7KgkuyBFlIbLZlNAP81yWicCknvA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1039" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZpl41BKVT2TISvadSdQoKtybbTYg7KgkuyBFlIbLZlNAP81yWicCknvA/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">gseaplot2(ego3, geneSetID = </span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">3</span></span><span leaf="">,            </span><span><span leaf=""># 使用 gseaplot2 函数对 ego3 对象中的前 3 个基因集进行可视化</span></span><span leaf=""><br></span><span leaf="">          pvalue_table = </span><span><span leaf="">TRUE</span></span><span leaf="">,              </span><span><span leaf=""># 在图中显示 p 值表格</span></span><span leaf=""><br></span><span leaf="">          color = c(</span><span><span leaf="">"#E495A5"</span></span><span leaf="">, </span><span><span leaf="">"#86B875"</span></span><span leaf="">, </span><span><span leaf="">"#7DB0DD"</span></span><span leaf="">),  </span><span><span leaf=""># 为每个基因集指定颜色</span></span><span leaf=""><br></span><span leaf="">          ES_geom = </span><span><span leaf="">"dot"</span></span><span leaf="">)                  </span><span><span leaf=""># 使用点状图形展示富集分数（ES）</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051351" data-ratio="0.8038647342995169" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZP1x3rTuo0BkrZibeu0NHSGLEicT6VJWye08dHsoCno63EKMhwjmF7KOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1035" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZP1x3rTuo0BkrZibeu0NHSGLEicT6VJWye08dHsoCno63EKMhwjmF7KOg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h5 data-tool="mdnice编辑器"><span></span><span><span leaf="">aPEAR</span></span><span></span></h5><blockquote><span></span><p><font><span leaf="">aPEAR 包通过多种指标计算通路基因集间的相似性，检测通路聚类簇，并为其分配具有生物学意义的命名。</span></font></p></blockquote><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(aPEAR)</span><span leaf=""><br></span><span leaf="">enrichmentNetwork(ego@result,       </span><span><span leaf=""># 使用富集分析结果对象 ego 的结果槽进行网络可视化</span></span><span leaf=""><br></span><span leaf="">repelLabels = </span><span><span leaf="">T</span></span><span leaf="">,                    </span><span><span leaf=""># 设置为 TRUE，以避免标签重叠</span></span><span leaf=""><br></span><span leaf="">drawEllipses = </span><span><span leaf="">T</span></span><span leaf="">,                   </span><span><span leaf=""># 设置为 TRUE，以在节点周围绘制椭圆以帮助区分群组</span></span><span leaf=""><br></span><span leaf="">fontSize = </span><span><span leaf="">4</span></span><span leaf="">)                       </span><span><span leaf=""># 设置标签的字体大小为 4</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100051350" data-ratio="0.8276955602536998" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZ3r0T4xoyf9fA0Oraf4ibVLqtNXD7ibMnsVh2qoibjlfDLVrIO52VGmOtw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="946" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosibZDUI7I1JFalvxAKEiacpibZ3r0T4xoyf9fA0Oraf4ibVLqtNXD7ibMnsVh2qoibjlfDLVrIO52VGmOtw/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><section><span leaf=""><br></span></section><section><span leaf="">GO 数据库往期文章：</span></section><section><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247534919&amp;idx=1&amp;sn=e9f0e9d28278b58e71fda4bfff150f12&amp;scene=21#wechat_redirect" textvalue="GO 数据库" data-itemshowtype="0" linktype="text" data-linktype="2">GO 数据库</a></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7_Y7yYmzdCJaBS_UH10U8A",target="_blank" rel="noopener noreferrer">原文链接</a>
