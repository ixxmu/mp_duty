---
title: "è¿™ä¸ªé¢„å°æœ¬ç»ˆäºå‘è¡¨åœ¨Nat Geneticsäº†ï¼Œé¦–ç¯‡Visium HDç©ºé—´ç»„å­¦æ•°æ®ç»“æœï¼Œè¿™ä¸ªæŠ€æœ¯è¿˜å¾ˆå…·æœ‰å‘æ–‡ä¼˜åŠ¿ï¼Œæ™šäº†åˆè¢«å·æ²¡äº†"
date: 2025-06-05T16:14:42Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡é’±åŒå­¦"
]
categories: ["Acdemic"]
---
è¿™ä¸ªé¢„å°æœ¬ç»ˆäºå‘è¡¨åœ¨Nat Geneticsäº†ï¼Œé¦–ç¯‡Visium HDç©ºé—´ç»„å­¦æ•°æ®ç»“æœï¼Œè¿™ä¸ªæŠ€æœ¯è¿˜å¾ˆå…·æœ‰å‘æ–‡ä¼˜åŠ¿ï¼Œæ™šäº†åˆè¢«å·æ²¡äº† by ç”Ÿä¿¡é’±åŒå­¦
------
<div><p data-pm-slice="0 0 []"><span leaf=""><span textstyle="">è¿™ä¸ªæ–‡ç« å°±æ˜¯</span></span><span data-token-index="1"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"p","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"data-token-index":"1","class":"notion-enable-hover","style":"outline: 0px; box-sizing: border-box; isolation: auto; font-weight: 600; background: rgb(253, 235, 236);"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">10x G</span></span></span><span data-token-index="1"><span leaf="" data-pm-slice='1 1 ["para",{"tagName":"p","attributes":{"style":"margin-bottom: 0px;"},"namespaceURI":"http://www.w3.org/1999/xhtml"},"node",{"tagName":"span","attributes":{"data-token-index":"1","class":"notion-enable-hover","style":"outline: 0px; box-sizing: border-box; isolation: auto; font-weight: 600; background: rgb(253, 235, 236);"},"namespaceURI":"http://www.w3.org/1999/xhtml"}]'><span textstyle="">enomics å‡ºçš„äºšç»†èƒåˆ†è¾¨ç‡çš„ç©ºé—´è½¬å½•ç»„æŠ€æœ¯ï¼Œæƒ³å¿…å„ä¸ªå…¬å¸çš„é”€å”®ä¹Ÿéƒ½æ‰¾è¿‡å¤§å®¶æ¨é”€è¿‡<img data-ratio="1" data-src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/Yellowdog.png" data-w="20" src="https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/Yellowdog.png">ï¼Œå•¥éƒ½å¥½ï¼Œå°±æ˜¯è´µï¼Œä¸è¿‡å¬è¯´ï¼Œç°åœ¨å¥½åƒé™ä¸‹æ¥äº†ã€‚æ•°æ®åˆ†ææœ‰ä¸€å®šéš¾åº¦ï¼Œå¤§å®¶å¤„ç†ç©ºé—´ç»„å­¦æ•°æ®ï¼Œå­¦ä¹ ä¸‹ä»–ä»¬çš„ä»£ç ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</span></span></span></p><section nodeleaf=""><img data-imgfileid="100010115" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7PPaaEYXJUY2K9Y7tG8JRk8wia8nzjibQ8vCPLCmTia1nl2YiavRbliaicXKA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7PPaaEYXJUY2K9Y7tG8JRk8wia8nzjibQ8vCPLCmTia1nl2YiavRbliaicXKA/640?wx_fmt=jpeg&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">ä¸çŸ¥é“ä¸ºå•¥ï¼Œä»£ç æŒºå¤§çš„ï¼Œä¸‹äº†å¥½ä¹…ï¼Œéœ€è¦çš„è¯åå°å›å¤å³å¯ï¼š25</span><span textstyle="">0606</span></span></span></p><p data-pm-slice="0 0 []"><span data-token-index="0"><span leaf=""><span textstyle="">é«˜åˆ†è¾¨ç‡ç©ºé—´è½¬å½•ç»„æŠ€æœ¯æ­ç¤ºç»“ç›´è‚ ç™Œå…ç–«ç»†èƒäº’ä½œæ–°æœºåˆ¶</span></span></span></p><p><span leaf=""><span textstyle="">2025 å¹´ 4 æœˆ 15 æ—¥ï¼Œã€Šè‡ªç„¶ - é—ä¼ å­¦ã€‹æ‚å¿—å‘è¡¨äº†ä¸€é¡¹ç”±Â </span></span><span data-token-index="1"><span leaf=""><span textstyle="">10x Genomics ç§‘ç ”å›¢é˜Ÿä¸»å¯¼çš„é‡è¦ç ”ç©¶ã€‚è¯¥ç ”ç©¶é¦–æ¬¡è¿ç”¨é«˜åˆ†è¾¨ç‡ Visium HD ç©ºé—´è½¬å½•ç»„æŠ€æœ¯</span></span></span><span leaf=""><span textstyle="">ï¼Œå¯¹ç»“ç›´è‚ ç™Œï¼ˆCRCï¼‰è‚¿ç˜¤å¾®ç¯å¢ƒï¼ˆTMEï¼‰ä¸­çš„å…ç–«ç»†èƒç¾¤ä½“è¿›è¡Œäº†å…¨æ™¯å¼åˆ†æï¼Œåœ¨å•ç»†èƒå°ºåº¦ä¸Šæ­ç¤ºäº†è‚¿ç˜¤å…ç–«ç»†èƒçš„ç©ºé—´åˆ†å¸ƒè§„å¾‹åŠåŠŸèƒ½å¼‚è´¨æ€§ã€‚</span></span></p><section nodeleaf=""><img data-imgfileid="100010104" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7MMBecdgZN8JvVUiaViaKh0W7TxPEshib4iaRMO1U8OS3cGDapRqChYBOBQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7MMBecdgZN8JvVUiaViaKh0W7TxPEshib4iaRMO1U8OS3cGDapRqChYBOBQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">æŠ€æœ¯çªç ´ï¼šé«˜åˆ†è¾¨ç‡è§£æè‚¿ç˜¤å¾®ç¯å¢ƒ</span></span></span></p><p><span leaf=""><span textstyle="">ç»“ç›´è‚ ç™Œæ˜¯å…¨çƒå‘ç—…ç‡å’Œæ­»äº¡ç‡å‡ä½å±…å‰åˆ—çš„æ¶æ€§è‚¿ç˜¤ã€‚2020 å¹´ï¼Œå…¨çƒçº¦æœ‰ 90 ä¸‡äººæ­»äºç»“ç›´è‚ ç™Œï¼Œå ç™Œç—‡ç›¸å…³æ­»äº¡çš„ 9.4%ï¼Œä¸”é¢„è®¡åˆ° 2035 å¹´å…¶å‘ç—…ç‡å°†ç¿»å€ã€‚ä¼ ç»Ÿçš„ç»„ç»‡ç—…ç†å­¦å’ŒåŸºå› çªå˜åˆ†ææ–¹æ³•éš¾ä»¥å…¨é¢åˆ»ç”»è‚¿ç˜¤å¾®ç¯å¢ƒçš„å¤æ‚å¼‚è´¨æ€§ï¼Œè€Œå•ç»†èƒè½¬å½•ç»„æŠ€æœ¯è™½èƒ½è§£æç»†èƒç±»å‹ï¼Œå´ç¼ºä¹ç©ºé—´ä½ç½®ä¿¡æ¯ã€‚</span></span></p><p><span data-token-index="0"><span leaf=""><span textstyle="">Visium HD æŠ€æœ¯åœ¨ 6.5Ã—6.5 æ¯«ç±³çš„æ•è·åŒºåŸŸå†…é›†æˆäº†çº¦ 1100 ä¸‡ä¸ª 2 å¾®ç±³çš„è¿ç»­æ¡å½¢ç ç‰¹å¾ï¼Œç›¸æ¯”ä¼ ç»Ÿ Visium v2 æŠ€æœ¯ 55 å¾®ç±³çš„æ•è·ç‚¹ï¼Œåˆ†è¾¨ç‡æå‡äº† 27 å€ã€‚</span></span></span><span data-token-index="1"><span leaf=""><span textstyle="">ç ”ç©¶äººå‘˜å¯¹ 5 ä¾‹ç»“ç›´è‚ ç™Œæ‚£è€…çš„ç¦å°”é©¬æ—å›ºå®šçŸ³èœ¡åŒ…åŸ‹ï¼ˆFFPEï¼‰æ ·æœ¬è¿›è¡Œåˆ†æï¼Œå‘ç° Visium HD ä¸ä»…ä¿æŒäº†ä¸ Visium v2 ç›¸å½“çš„æ£€æµ‹çµæ•åº¦ï¼ˆåŸºå› è¡¨è¾¾ç›¸å…³æ€§ RÂ²=0.82ï¼‰ï¼Œè¿˜å°†éç‰¹å¼‚æ€§ç»“åˆç‡ä» 4.13% é™è‡³ 0.70%ï¼Œå®ç°äº† mRNA åˆ†å­ 98.3%-99% çš„ç²¾å‡†å®šä½ã€‚</span></span></span></p><section nodeleaf=""><img data-imgfileid="100010106" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7FOxkRKF0nlDPTqBzLqB1wQFbTj161cIpAndkl5icIibPhzbibHeRGiaUGg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7FOxkRKF0nlDPTqBzLqB1wQFbTj161cIpAndkl5icIibPhzbibHeRGiaUGg/640?wx_fmt=jpeg&amp;from=appmsg"></section><p><span data-token-index="0"><span leaf=""><span textstyle="">å…³é”®å‘ç°ï¼šå·¨å™¬ç»†èƒäºšç¾¤çš„åŒé‡è§’è‰²</span></span></span></p><p><span leaf=""><span textstyle="">é€šè¿‡å¯¹è‚¿ç˜¤è¾¹ç•Œ 50 å¾®ç±³èŒƒå›´å†…çš„ç»†èƒè¿›è¡Œæ·±åº¦åˆ†æï¼Œç ”ç©¶å›¢é˜Ÿå‘ç°å·¨å™¬ç»†èƒæ˜¯è‚¿ç˜¤å‘¨è¾¹æœ€ä¸°å¯Œçš„å…ç–«ç»†èƒç±»å‹ã€‚è¿›ä¸€æ­¥ç ”ç©¶æ­ç¤ºï¼Œè¿™äº›å·¨å™¬ç»†èƒå¯åˆ†ä¸ºä¸¤ç§å…·æœ‰ç‹¬ç‰¹è½¬å½•ç»„ç‰¹å¾çš„äºšç¾¤ï¼š</span></span><span data-token-index="1"><span leaf=""><span textstyle="">SELENOP + å·¨å™¬ç»†èƒå’Œ SPP1 + å·¨å™¬ç»†èƒï¼Œå®ƒä»¬åœ¨è‚¿ç˜¤å¾®ç¯å¢ƒä¸­å æ®ä¸åŒçš„ç©ºé—´ç”Ÿæ€ä½ã€‚</span></span></span></p><section nodeleaf=""><img data-imgfileid="100010107" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7jcm5aiaiajCIicOxs2lZpo2WsKCSGseHusTwUvBwoot5QtKwZnbW7Uqgw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7jcm5aiaiajCIicOxs2lZpo2WsKCSGseHusTwUvBwoot5QtKwZnbW7Uqgw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010100" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU76wqjVQjSmRbV2snRwHJbiaqBg8YRBWl81rbUkk8s0qkch5HMZgeswNw/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU76wqjVQjSmRbV2snRwHJbiaqBg8YRBWl81rbUkk8s0qkch5HMZgeswNw/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010108" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7m9icad9uL25uTN09iaYY2iaB5CXdnzJBBlP2QtOMFgzeicFxW1A2jmJOQQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7m9icad9uL25uTN09iaYY2iaB5CXdnzJBBlP2QtOMFgzeicFxW1A2jmJOQQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010101" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mUzNzXF2gk5F89oojh5HRLNLMHrWjbHfo7ibzFrcyuKL5xKN4TBcQog/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mUzNzXF2gk5F89oojh5HRLNLMHrWjbHfo7ibzFrcyuKL5xKN4TBcQog/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010109" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mbw6bg99G15sUHoFKvytZXxAia8swbuh2Y0U7EIme52lYhaCuic41GzQ/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mbw6bg99G15sUHoFKvytZXxAia8swbuh2Y0U7EIme52lYhaCuic41GzQ/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010102" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7UNibmUhw41YGTEsmOUZRZCrsXALjWJOjYwd5ZcL8mq2aVqB0w0RFl2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7UNibmUhw41YGTEsmOUZRZCrsXALjWJOjYwd5ZcL8mq2aVqB0w0RFl2w/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010110" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7ErGAyls4STBoys2eDOxNibvjo5Pe3Iw55xWVXl7cXDFhCkqQI7k1Pyw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7ErGAyls4STBoys2eDOxNibvjo5Pe3Iw55xWVXl7cXDFhCkqQI7k1Pyw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010103" data-ratio="0.3232662192393736" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7Ln74v5DL5Mn510EgNmQiaoZHZoSaZs5hrKYk3ScUHrXOlzxiaIyibIROQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1788" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7Ln74v5DL5Mn510EgNmQiaoZHZoSaZs5hrKYk3ScUHrXOlzxiaIyibIROQ/640?wx_fmt=png&amp;from=appmsg"></section><section nodeleaf=""><img data-imgfileid="100010112" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mmsjfKAhtVUPr4z2p5ZfLJgpqPEx7sUj4E9sbojPWytY9QLVm7stcw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7mmsjfKAhtVUPr4z2p5ZfLJgpqPEx7sUj4E9sbojPWytY9QLVm7stcw/640?wx_fmt=jpeg&amp;from=appmsg"></section><section data-pm-slice="0 0 []"><span leaf=""><span textstyle="">å¦‚ä¸‹å›¾ç‰‡å‡ç”±æˆ‘ä»¬800/å¹´çš„ç‹¬äº«ç”Ÿä¿¡äº‘æœåŠ¡å™¨ç”»å‡ºï¼Œå¸¦æœ‰rootæƒé™ï¼ˆé¢„è£…2ä¸‡ä¸ªåŒ…+SCPå•ç»†èƒç”Ÿä¿¡ç¯å¢ƒï¼Œåç»­æœ‰å•¥å¥½ç”¨çš„ç¯å¢ƒï¼Œæˆ‘ä»¬ä¼šç»§ç»­è£…ï¼‰ï¼Œéœ€è¦ç”»å›¾è¯•è¯•çš„å¯ä»¥å…</span></span><span data-pm-slice="0 0 []"><span leaf=""><span textstyle="">ğŸ’°é¢†æµ‹è¯•å·ï¼š</span></span></span></section><section><span data-pm-slice="0 0 []"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247493682&amp;idx=1&amp;sn=b3a6a9bc2bc6dd8a028c81a0fb593852&amp;scene=21#wechat_redirect" textvalue="å½“å‰æœåŠ¡å™¨ä¸å¥½ç”¨ï¼Œå’±å°±è‡ªå·±é€ ï¼Œæˆ‘ä»¬ä¸€å®šè¦è®©å¤§å®¶ç”Ÿä¿¡å­¦ä¹ çš„é—¨æ§›é™åˆ°æœ€ä½" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">å½“å‰æœåŠ¡å™¨ä¸å¥½ç”¨ï¼Œå’±å°±è‡ªå·±é€ ï¼Œæˆ‘ä»¬ä¸€å®šè¦è®©å¤§å®¶ç”Ÿä¿¡å­¦ä¹ çš„é—¨æ§›é™åˆ°æœ€ä½</span></a></span></span></section><section><a href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247493704&amp;idx=1&amp;sn=2a5dd7a5135e43618590bf1343f58915&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFuMytQquQl3vTaLfchic6cQibTqGymQSuDCTIxcibMLRZFYA94CYV0p4oyVIgJQx5YZIfkEjVY8RzibJw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img alt="å›¾ç‰‡" data-imgfileid="100010053" data-ratio="0.39351851851851855" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFuMytQquQl3vTaLfchic6cQibTqGymQSuDCTIxcibMLRZFYA94CYV0p4oyVIgJQx5YZIfkEjVY8RzibJw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFuMytQquQl3vTaLfchic6cQibTqGymQSuDCTIxcibMLRZFYA94CYV0p4oyVIgJQx5YZIfkEjVY8RzibJw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></span></a></section><section><span leaf=""><span textstyle="">å¯¹æœåŠ¡å™¨æˆ–ç”Ÿä¿¡äº¤æµç¾¤æ„Ÿå…´è¶£çš„å¯ä»¥è”ç³»å°åŠ©æ‰‹:</span><span textstyle="">sx_qtx01</span></span></section><section nodeleaf=""><img data-imgfileid="100010116" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7ibicyiaMTRh6paPcRibIM3Z8TZRt3qicdfobrnBJMicSF6YJCCdF5UQlma4g/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="block" src="https://mmbiz.qpic.cn/mmbiz_jpg/7At0Eia3NQFvZPDJHQBTdUk9gcJ9bwKU7ibicyiaMTRh6paPcRibIM3Z8TZRt3qicdfobrnBJMicSF6YJCCdF5UQlma4g/640?wx_fmt=jpeg&amp;from=appmsg"></section><section data-pm-slice="0 0 []"><span leaf=""><span textstyle="">æˆ‘ä»¬ä¸Šæ¸¸æ•°æ®åˆ†æäº¤ä»˜çš„ç»“æœè¿˜æœ‰ä¸€ä¸ªé•¿çš„ç»†åŒ–çš„ç»“æœæ–‡ä»¶ç»“æ„ç›®å½•è§£è¯»(å¤ªé•¿äº†ï¼Œè¿™é‡Œå°±ä¸å±•ç¤ºäº†)ï¼Œæƒ³äº†è§£çš„å¯ä»¥è”ç³»å°åŠ©æ‰‹vxï¼Œå‘ç»™å¤§å®¶ï¼Œæœ‰åˆ†æéœ€æ±‚çš„å¯ä»¥äº†è§£ä¸‹æ–¹åˆ†æå†…å®¹</span></span></section><section data-pm-slice="0 0 []"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484782&amp;idx=1&amp;sn=52ea346598a0021cf991e2ad95e8c8f9&amp;scene=21#wechat_redirect" textvalue="æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿçœ‹çœ‹æˆ‘ä»¬åšå‡ºæ¥çš„ç»“æœåŒ…å«å•¥ï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿçœ‹çœ‹æˆ‘ä»¬åšå‡ºæ¥çš„ç»“æœåŒ…å«å•¥ï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš</span></a></span></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009996" data-ratio="1.1962962962962962" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFu8pxJcmw3iaXQXEC4KDC3EoYtPLHicI4rcMuiaDpTqVsbuJtft0wMYbwnud5ZLwOCbicJkW2fkLg19Zw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFu8pxJcmw3iaXQXEC4KDC3EoYtPLHicI4rcMuiaDpTqVsbuJtft0wMYbwnud5ZLwOCbicJkW2fkLg19Zw/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100009997" data-ratio="0.40370370370370373" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFu8pxJcmw3iaXQXEC4KDC3EoDz2HB75iab1mygibwWUgonqMicIdg7qvlwu8YmL9JTdJbTxEQmicGRO73A/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/7At0Eia3NQFu8pxJcmw3iaXQXEC4KDC3EoDz2HB75iab1mygibwWUgonqMicIdg7qvlwu8YmL9JTdJbTxEQmicGRO73A/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section nodeleaf=""><img alt="å›¾ç‰‡" data-imgfileid="100001128" data-ratio="0.5824074074074074" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZfw9RDKh2ZJoDhQur5WHY3CdSxovEs3Yvnhvjr4N82KksAqM2DPjZdv8nKqxhmvzsg6ibGrAICRaIA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;watermark=1&amp;tp=webp" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/sz_mmbiz_png/2bvYMoCQeZfw9RDKh2ZJoDhQur5WHY3CdSxovEs3Yvnhvjr4N82KksAqM2DPjZdv8nKqxhmvzsg6ibGrAICRaIA/640?wx_fmt=png&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;watermark=1&amp;tp=webp"></section><section data-role="outer" label="Powered by 135editor.com onekey" data-pm-slice="0 0 []"><section><section data-bdopacity="20%"><section data-bdopacity="40%"><section data-bdopacity="60%"><section data-bdopacity="80%"><section data-bgopacity="90%"><p data-brushtype="text"><strong><strong><span data-pm-slice="0 0 []"><span leaf=""><span textstyle="">Oliveira, M.F.d., Romero, J.P., Chung, M. et al. High-definition spatial transcriptomic profiling of immune cell populations in colorectal cancer. Nat Genet (2025).</span></span></span></strong></strong></p><p data-brushtype="text" data-pm-slice="0 0 []"><strong><strong><strong><span leaf="">åè‹”â†©ï¸ä¹‹å‰è´´å­çš„å²¸å·å³å¯éœå¾—ä¹‹å‰çš„</span></strong></strong></strong></p><p data-brushtype="text"><strong><strong><strong><strong data-pm-slice="0 0 []"><span leaf="">ä»£ç ï¼Œä»Šæ—¥å…³é”®è¯ï¼š250606</span></strong></strong></strong></strong></p></section></section></section></section></section></section></section><section data-pm-slice="0 0 []"><section><strong><strong><strong><span leaf=""><span textstyle="">åŸºç¡€ã€å•ç»†èƒã€ç©ºé—´å„ä¸“é¢˜ç­ï¼Œæƒ³ç³»ç»Ÿæ€§å­¦ä¹ å¯ä»¥çœ‹ä¸‹è¿™ä¸ªğŸ‘‡</span></span></strong></strong></strong><span><span leaf=""><br></span></span></section><section><span leaf=""><br></span></section><section><span><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" textvalue="ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">ä¸å¹ä¸é»‘ï¼Œä½ æƒ³çŸ¥é“ç”Ÿä¿¡éœ€è¦æŒæ¡å“ªäº›ï¼Œå…‰çœ‹è¿™ä¸ªå¤§çº²å°±ä¼šæœ‰ä¸å°‘æ”¶è·</span></a></span><strong><span><span leaf=""><br></span><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MjcyMDk3Mg==&amp;mid=2247484123&amp;idx=1&amp;sn=a6cce80b4de771525c511d4bbceb0952&amp;scene=21#wechat_redirect" imgurl="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" linktype="image" tab="innerlink" data-itemshowtype="0" target="_blank" data-linktype="1"><span><img alt="å›¾ç‰‡" data-ratio="0.5990740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/2bvYMoCQeZd3cBr0oJmbLRP3hro4cE7hU3SBHytR7jQJz1YsVTvUPLgr6Tlot0ZfRePIBTZcvv86JzYO2tNSTg/640?wx_fmt=jpeg&amp;from=appmsg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1&amp;tp=webp"></span></a></span></strong></span></section></section><p><span><strong><span><span leaf=""><span textstyle="">æœ‰å•ç»†èƒæ•°æ®åˆ†æéœ€æ±‚çš„å¯ä»¥çœ‹</span></span><strong><strong><span leaf=""><span textstyle="">ğŸ‘‡è¿™ä¸ªæ–‡ç« </span></span></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span><strong><strong></strong></strong></span></strong><strong><strong><strong><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247490275&amp;idx=1&amp;sn=200ccc0a415860f9d73b9068657096ff&amp;scene=21#wechat_redirect" textvalue="æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">æ²¡æœ‰æœåŠ¡å™¨ï¼Œå•ç»†èƒæ•°æ®æä¸å®šï¼Ÿæˆ‘ä»¬ç›®å‰åšå¥½äº†è¿™äº›pipelineï¼Œå¯ä»¥å¸®ä½ åš</span></a><span textstyle="">ï¼ˆè¿‘æœŸåˆæ·»åŠ äº†21 å¹´å‘è¡¨åœ¨äº† Cellä¸Šé¢çš„å•ç»†èƒè½¬å½•ç»„åˆ†æä»£è°¢çš„åˆ†æâ€”â€”compassï¼‰</span></span></strong></strong></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf=""><br></span></strong></strong></strong></span></strong></span></p><p><span><strong><span><strong><strong><strong><span leaf=""><span textstyle="">æˆ‘ä»¬ç›®å‰ä¸»è¦çš„åˆ†æå†…å®¹çœ‹ğŸ‘‡ï¼ˆè¿™æ¬¡çš„æ˜¯å¯¹ä¸Šæ¬¡å†…å®¹çš„è¡¥å…… scBCRå’Œ sc-TCRäº†ï¼‰</span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkwMzY2NjkwNg==&amp;mid=2247492253&amp;idx=1&amp;sn=da8477aa80c485e7cfd12862047cd30b&amp;scene=21#wechat_redirect" textvalue="é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš" data-itemshowtype="0" linktype="text" data-linktype="2"><span textstyle="">é¡¶åˆŠç”¨å•¥åˆ†æï¼Œå’±ä»¬å°±ç”¨å•¥ï¼Œå®Œå…¨æŒ‰ç…§ä»–ä»¬çš„åš</span></a></span></strong></strong></strong></span></strong></span></p><section><span leaf=""><span textstyle="">Figure3ä»£ç </span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span leaf=""><span># -----------------------------------------------------------------------------</span></span></code><code><span leaf=""><span># Visium HD ç©ºé—´è½¬å½•ç»„æ•°æ®åˆ†æä¸Figure 3å¯è§†åŒ–</span></span></code><code><span leaf=""><span># åŠŸèƒ½ï¼šæ•´åˆå¤šæ ·æœ¬Visium HDæ•°æ®ï¼Œè¿›è¡Œç»†èƒç±»å‹æ³¨é‡Šä¸ç©ºé—´å¯è§†åŒ–</span></span></code><code><span leaf=""><span># -----------------------------------------------------------------------------</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 1. ç¯å¢ƒå‡†å¤‡ä¸æ•°æ®åŠ è½½</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span>library</span>(Seurat) Â  Â  Â  Â  Â  Â Â <span># å•ç»†èƒæ•°æ®åˆ†ææ ¸å¿ƒåŒ…ï¼Œç”¨äºåˆ›å»ºå’Œåˆ†æSeuratå¯¹è±¡</span></span></code><code><span leaf=""><span>library</span>(scattermore) Â  Â  Â  Â <span># é«˜æ•ˆç»˜åˆ¶å¤§è§„æ¨¡æ•£ç‚¹å›¾ï¼Œä¼˜åŒ–å¯è§†åŒ–æ€§èƒ½</span></span></code><code><span leaf=""><span>library</span>(tidyverse) Â  Â  Â  Â  Â <span># åŒ…å«dplyrã€ggplot2ç­‰å·¥å…·ï¼Œç”¨äºæ•°æ®å¤„ç†å’Œç»˜å›¾</span></span></code><code><span leaf=""><span>library</span>(data.table) Â  Â  Â  Â Â <span># é«˜æ•ˆå¤„ç†å¤§æ•°æ®é›†ï¼Œæ”¯æŒå¿«é€Ÿæ•°æ®æ“ä½œ</span></span></code><code><span leaf=""><span>library</span>(wesanderson) Â  Â  Â  Â <span># æä¾›ç”µå½±ä¸»é¢˜é…è‰²æ–¹æ¡ˆï¼Œç”¨äºç¾è§‚çš„å¯è§†åŒ–</span></span></code><code><span leaf=""><span>library</span>(patchwork) Â  Â  Â  Â  Â <span># æ‹¼æ¥å¤šä¸ªggplotå›¾å½¢ï¼Œç”Ÿæˆå¤åˆå›¾è¡¨</span></span></code><code><span leaf=""><span>library</span>(RColorBrewer) Â  Â  Â Â <span># æä¾›ä¸°å¯Œçš„é¢œè‰²æ–¹æ¡ˆï¼Œæ”¯æŒè‡ªå®šä¹‰é…è‰²</span></span></code><code><span leaf=""><span>library</span>(furrr) Â  Â  Â  Â  Â  Â  Â <span># å®ç°å¹¶è¡Œè®¡ç®—ï¼ŒåŠ é€Ÿå¾ªç¯æ“ä½œ</span></span></code><code><span leaf=""><span>library</span>(paletteer) Â  Â  Â  Â  Â <span># ç®¡ç†å’Œè°ƒç”¨å„ç§è°ƒè‰²æ¿ï¼Œç»Ÿä¸€å¯è§†åŒ–é£æ ¼</span></span></code><code><span leaf=""><span>library</span>(arrow) Â  Â  Â  Â  Â  Â  Â <span># é«˜æ•ˆå¤„ç†å¤§æ•°æ®æ–‡ä»¶ï¼Œæ”¯æŒå¿«é€Ÿè¯»å–HDF5ç­‰æ ¼å¼</span></span></code><code><span leaf=""><span>library</span>(pheatmap) Â  Â  Â  Â  Â Â <span># ç»˜åˆ¶çƒ­å›¾ï¼Œç”¨äºåŸºå› è¡¨è¾¾æ¨¡å¼å±•ç¤º</span></span></code><code><span leaf=""><span>library</span>(distances) Â  Â  Â  Â  Â <span># è®¡ç®—ç»†èƒé—´è·ç¦»ï¼Œæ”¯æŒèšç±»å’Œé™ç»´åˆ†æ</span></span></code><code><span leaf=""><span># è®¾ç½®æœªæ¥å¯¹è±¡çš„æœ€å¤§å†…å­˜ï¼ˆ1000GBï¼‰ï¼Œé¿å…å¤§æ•°æ®å¤„ç†æ—¶å†…å­˜ä¸è¶³</span></span></code><code><span leaf=""><span>options</span>(future.globals.maxSize =Â <span>1000</span>Â *Â <span>1024</span>^<span>2</span>)</span></code><code><span leaf=""><span># åŠ è½½è‡ªå®šä¹‰è¾…åŠ©å‡½æ•°ï¼ŒåŒ…å«é¡¹ç›®ç‰¹å®šçš„æ•°æ®å¤„ç†å’Œå¯è§†åŒ–å‡½æ•°</span></span></code><code><span leaf=""><span>source</span>(<span>"~/Methods/AuxFunctions.R"</span>)</span></code><code><span leaf=""><span># å®šä¹‰æ ·æœ¬ä¿¡æ¯è¡¨ï¼šåŒ…å«æ ·æœ¬åç§°ã€H5æ•°æ®è·¯å¾„å’Œåå·ç§¯ç»“æœè·¯å¾„</span></span></code><code><span leaf="">SampleInfo &lt;- data.<span>frame</span>(</span></code><code><span leaf="">Â  Sample =Â <span>c</span>(<span>"P1CRC"</span>,Â <span>"P2CRC"</span>,Â <span>"P5CRC"</span>),</span></code><code><span leaf="">Â  H5 =Â <span>c</span>(</span></code><code><span leaf="">Â  Â Â <span>"~/VisiumHD/PatientCRC1/outs/binned_outputs/square_008um/filtered_feature_bc_matrix.h5"</span>,</span></code><code><span leaf="">Â  Â Â <span>"~/VisiumHD/PatientCRC2/outs/binned_outputs/square_008um/filtered_feature_bc_matrix.h5"</span>,</span></code><code><span leaf="">Â  Â Â <span>"~/VisiumHD/PatientCRC5/outs/binned_outputs/square_008um/filtered_feature_bc_matrix.h5"</span></span></code><code><span leaf="">Â  ),</span></code><code><span leaf="">Â  Deconv =Â <span>c</span>(</span></code><code><span leaf="">Â  Â Â <span>"~/MetaData/DeconvolutionResults_P1CRC.csv.gz"</span>,</span></code><code><span leaf="">Â  Â Â <span>"~/MetaData/DeconvolutionResults_P2CRC.csv.gz"</span>,</span></code><code><span leaf="">Â  Â Â <span>"~/MetaData/DeconvolutionResults_P5CRC.csv.gz"</span></span></code><code><span leaf="">Â  )</span></code><code><span leaf="">)</span></code><code><span leaf=""><span># åˆå§‹åŒ–å…ƒæ•°æ®å’Œè¡¨è¾¾çŸ©é˜µåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨å¤šä¸ªæ ·æœ¬çš„æ•°æ®</span></span></code><code><span leaf="">MetaData &lt;-Â <span>vector</span>(<span>"list"</span>, length =Â <span>nrow</span>(SampleInfo))</span></code><code><span leaf="">Matrices &lt;-Â <span>vector</span>(<span>"list"</span>, length =Â <span>nrow</span>(SampleInfo))</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 2. å¤šæ ·æœ¬æ•°æ®è¯»å–ä¸åˆå¹¶</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span>for</span>(jj inÂ <span>1</span>:<span>nrow</span>(SampleInfo)) {</span></code><code><span leaf="">Â Â <span># è¯»å–10x Genomicsæ ¼å¼çš„H5è¡¨è¾¾çŸ©é˜µ</span></span></code><code><span leaf="">Â  MatData &lt;-Â <span>open_matrix_10x_hdf5</span>(path = SampleInfo<span>$H5</span>[jj])</span></code><code><span leaf="">Â Â <span># å°†çŸ©é˜µå†™å…¥å½“å‰ç›®å½•ï¼Œä¾¿äºåç»­å¤„ç†</span></span></code><code><span leaf="">Â Â <span>write_matrix_dir</span>(mat = MatData, dir =Â <span>getwd</span>(), overwrite =Â <span>TRUE</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># é‡æ–°æ‰“å¼€çŸ©é˜µæ•°æ®ï¼Œç¡®ä¿æ ¼å¼ç»Ÿä¸€</span></span></code><code><span leaf="">Â  mat &lt;-Â <span>open_matrix_dir</span>(dir = PathX)</span></code><code><span leaf="">Â Â <span># ä¸ºåˆ—åæ·»åŠ æ ·æœ¬åç¼€ï¼Œé¿å…å¤šæ ·æœ¬åˆå¹¶æ—¶æ¡å½¢ç é‡å¤</span></span></code><code><span leaf="">Â Â <span>colnames</span>(mat) &lt;-Â <span>paste0</span>(<span>colnames</span>(mat),Â <span>"_"</span>, SampleInfo<span>$Sample</span>[jj])</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># è¯»å–åŸºå› æ³¨é‡Šä¿¡æ¯ï¼ˆç‰¹å¾è¡¨ï¼‰</span></span></code><code><span leaf="">Â  Genes &lt;- read.<span>delim</span>(</span></code><code><span leaf="">Â  Â  file =Â <span>"~/VisiumHD/PatientCRC1/outs/binned_outputs/square_008um/filtered_feature_bc_matrix/features.tsv.gz"</span>,</span></code><code><span leaf="">Â  Â  sep =Â <span>"\t"</span>, header =Â <span>FALSE</span></span></code><code><span leaf="">Â  )</span></code><code><span leaf="">Â Â <span># è®¾ç½®åŸºå› åä¸ºå”¯ä¸€æ ‡è¯†ï¼ˆå¤„ç†å¯èƒ½çš„é‡å¤åŸºå› åï¼‰</span></span></code><code><span leaf="">Â Â <span>rownames</span>(mat) &lt;- make.<span>unique</span>(Genes<span>$V2</span>[<span>match</span>(<span>rownames</span>(mat), Genes<span>$V1</span>)])</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># å°†å½“å‰æ ·æœ¬çš„çŸ©é˜µå­˜å…¥åˆ—è¡¨</span></span></code><code><span leaf="">Â  Matrices[[jj]] &lt;- mat</span></code><code><span leaf="">}</span></code><code><span leaf=""><span># å‘½åçŸ©é˜µåˆ—è¡¨ï¼Œä¾¿äºåç»­å¼•ç”¨</span></span></code><code><span leaf=""><span>names</span>(Matrices) &lt;-Â <span>c</span>(<span>"P1CRC"</span>,Â <span>"P2CRC"</span>,Â <span>"P5CRC"</span>)</span></code><code><span leaf=""><span># åˆ›å»ºSeuratå¯¹è±¡å¹¶åˆå¹¶å¤šæ ·æœ¬è¡¨è¾¾çŸ©é˜µ</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>CreateSeuratObject</span>(counts = Matrices, meta.data = MetaData)</span></code><code><span leaf=""><span># åˆå¹¶ä¸åŒå±‚çš„è¡¨è¾¾æ•°æ®ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>JoinLayers</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 3. åå·ç§¯ç»“æœæ•´åˆä¸ç»†èƒç±»å‹æ³¨é‡Š</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># åŠ è½½æ¯ä¸ªæ ·æœ¬çš„åå·ç§¯ç»“æœï¼ˆç»†èƒç±»å‹æ³¨é‡Šï¼‰</span></span></code><code><span leaf="">AllDeconvolution &lt;-Â <span>vector</span>(<span>"list"</span>, length =Â <span>nrow</span>(SampleInfo))</span></code><code><span leaf=""><span>for</span>(jj inÂ <span>1</span>:<span>nrow</span>(SampleInfo)) {</span></code><code><span leaf="">Â  DecTmp &lt;- read.<span>delim</span>(SampleInfo<span>$Deconv</span>[jj], sep =Â <span>","</span>, na.omit =Â <span>TRUE</span>)</span></code><code><span leaf="">Â Â <span># ä¸ºæ¡å½¢ç æ·»åŠ æ ·æœ¬åç¼€ï¼Œä¸Seuratå¯¹è±¡çš„åˆ—ååŒ¹é…</span></span></code><code><span leaf="">Â  DecTmp<span>$barcode</span>Â &lt;-Â <span>paste0</span>(DecTmp<span>$barcode</span>,Â <span>"_"</span>, SampleInfo<span>$Sample</span>[jj])</span></code><code><span leaf="">Â  AllDeconvolution[[jj]] &lt;- DecTmp</span></code><code><span leaf="">}</span></code><code><span leaf=""><span># åˆå¹¶æ‰€æœ‰æ ·æœ¬çš„åå·ç§¯ç»“æœï¼Œå½¢æˆç»Ÿä¸€çš„æ³¨é‡Šè¡¨</span></span></code><code><span leaf="">AllDeconvolution &lt;-Â <span>Reduce</span>(rbind, AllDeconvolution)</span></code><code><span leaf=""><span># å°†åå·ç§¯ç»“æœæ˜ å°„åˆ°Seuratå¯¹è±¡çš„å…ƒæ•°æ®ä¸­</span></span></code><code><span leaf="">merged.<span>object</span><span>$DeconvolutionClass</span>Â &lt;- AllDeconvolution<span>$DeconvolutionClass</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>colnames</span>(merged.<span>object</span>), AllDeconvolution<span>$barcode</span>)</span></code><code><span leaf="">]</span></code><code><span leaf="">merged.<span>object</span><span>$DeconvolutionLabel1</span>Â &lt;- AllDeconvolution<span>$DeconvolutionLabel1</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>colnames</span>(merged.<span>object</span>), AllDeconvolution<span>$barcode</span>)</span></code><code><span leaf="">]</span></code><code><span leaf="">merged.<span>object</span><span>$DeconvolutionLabel2</span>Â &lt;- AllDeconvolution<span>$DeconvolutionLabel2</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>colnames</span>(merged.<span>object</span>), AllDeconvolution<span>$barcode</span>)</span></code><code><span leaf="">]</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 4. æ•°æ®é™ç»´ä¸èšç±»åˆ†æï¼ˆSketchæ–¹æ³•ï¼‰</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># æ ‡å‡†åŒ–æ•°æ®ï¼Œä¸ºåç»­åˆ†æåšå‡†å¤‡</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>NormalizeData</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># è¯†åˆ«é«˜å˜åŸºå› ï¼ˆHVGsï¼‰ï¼Œå‡å°‘åç»­åˆ†æç»´åº¦</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>FindVariableFeatures</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># ä½¿ç”¨Sketchæ–¹æ³•é™ç»´ï¼Œå‡å°‘è®¡ç®—é‡ï¼ˆé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ï¼‰</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>SketchData</span>(</span></code><code><span leaf="">Â Â <span>object</span>Â = merged.<span>object</span>,</span></code><code><span leaf="">Â  ncells =Â <span>240000</span>,</span></code><code><span leaf="">Â  method =Â <span>"LeverageScore"</span>,</span></code><code><span leaf="">Â  sketched.assay =Â <span>"sketch"</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><span># è®¾ç½®é»˜è®¤åˆ†æå¯¹è±¡ä¸ºSketchæ•°æ®ï¼Œä¸“æ³¨äºé™ç»´å­é›†</span></span></code><code><span leaf=""><span>DefaultAssay</span>(merged.<span>object</span>) &lt;-Â <span>"sketch"</span></span></code><code><span leaf=""><span># åœ¨Sketchæ•°æ®ä¸Šå†æ¬¡è¯†åˆ«é«˜å˜åŸºå› ï¼Œä¼˜åŒ–ç‰¹å¾é€‰æ‹©</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>FindVariableFeatures</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># æ ‡å‡†åŒ–å’Œç¼©æ”¾æ•°æ®ï¼Œç¡®ä¿ç‰¹å¾å¯æ¯”æ€§</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>ScaleData</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ï¼Œæå–ä¸»è¦å˜å¼‚ç»´åº¦</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>RunPCA</span>(merged.<span>object</span>)</span></code><code><span leaf=""><span># åŸºäºPCAç»“æœå¯»æ‰¾é‚»å±…ç»†èƒï¼Œæ„å»ºç»†èƒé—´å…³ç³»å›¾</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>FindNeighbors</span>(merged.<span>object</span>, dims =Â <span>1</span>:<span>20</span>)</span></code><code><span leaf=""><span># å›¾èšç±»åˆ†æï¼Œè¯†åˆ«ç»†èƒç¾¤ï¼ˆåˆ†è¾¨ç‡0.8ï¼‰</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>FindClusters</span>(merged.<span>object</span>, resolution =Â <span>0.8</span>)</span></code><code><span leaf=""><span># æ‰§è¡ŒUMAPé™ç»´ï¼Œç”¨äºå¯è§†åŒ–é«˜ç»´æ•°æ®ï¼ˆè¿”å›æ¨¡å‹ç”¨äºæŠ•å½±ï¼‰</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>RunUMAP</span>(merged.<span>object</span>, dims =Â <span>1</span>:<span>20</span>,Â <span>return</span>.model =Â <span>TRUE</span>)</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 5. ç»†èƒç±»å‹æ³¨é‡Šï¼ˆLevel 1ï¼šä¸»è¦ç»†èƒç±»å‹ï¼‰</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># æ‰‹åŠ¨å®šä¹‰Level 1çš„ç»†èƒç±»å‹æ ‡ç­¾ï¼Œå¯¹åº”èšç±»ç»“æœ</span></span></code><code><span leaf="">IdentsLvl1 &lt;-Â <span>c</span>(</span></code><code><span leaf="">Â Â <span>"Tumor"</span>,Â <span>"Intestinal Epithelial"</span>,Â <span>"Endothelial"</span>,Â <span>"Smooth Muscle"</span>,Â <span>"Tumor"</span>,Â <span>"Tumor"</span>,Â <span>"T cells"</span>,</span></code><code><span leaf="">Â Â <span>"Fibroblast"</span>,Â <span>"B cells"</span>,Â <span>"Myeloid"</span>,Â <span>"Fibroblast"</span>,Â <span>"Tumor"</span>,Â <span>"Unknown"</span>,Â <span>"Intestinal Epithelial"</span>,Â <span>"Fibroblast"</span>,</span></code><code><span leaf="">Â Â <span>"Unknown"</span>,Â <span>"Myeloid"</span>,Â <span>"B cells"</span>,Â <span>"Tumor"</span>,Â <span>"Tumor"</span>,Â <span>"Neuronal"</span>,Â <span>"Tumor"</span>,Â <span>"Unknown"</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><span># å°†èšç±»ç»“æœæ˜ å°„åˆ°Level 1æ ‡ç­¾ï¼ˆ+1æ˜¯å› ä¸ºRç´¢å¼•ä»1å¼€å§‹ï¼‰</span></span></code><code><span leaf="">merged.<span>object</span><span>$Level1</span>Â &lt;- IdentsLvl1[<span>as</span>.<span>numeric</span>(<span>as</span>.<span>vector</span>(merged.<span>object</span><span>$seurat_clusters</span>)) +Â <span>1</span>]</span></code><code><span leaf=""><span># è½¬æ¢ä¸ºå› å­ç±»å‹å¹¶æ’åºï¼Œç¡®ä¿å¯è§†åŒ–é¡ºåºä¸€è‡´</span></span></code><code><span leaf="">merged.<span>object</span><span>$Level1</span>Â &lt;-Â <span>factor</span>(merged.<span>object</span><span>$Level1</span>, levels =Â <span>sort</span>(<span>unique</span>(merged.<span>object</span><span>$Level1</span>)))</span></code><code><span leaf=""><span># è®¾ç½®å½“å‰æ ‡è¯†ä¸ºLevel 1æ ‡ç­¾ï¼Œä¾¿äºåç»­åˆ†æ</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>SetIdent</span>(merged.<span>object</span>, value =Â <span>"Level1"</span>)</span></code><code><span leaf=""><span># å¯»æ‰¾æ‰€æœ‰Level 1ç»†èƒç±»å‹çš„æ ‡è®°åŸºå› ï¼ˆåªä¿ç•™ä¸Šè°ƒåŸºå› ï¼‰</span></span></code><code><span leaf="">Mks &lt;-Â <span>FindAllMarkers</span>(</span></code><code><span leaf="">Â  merged.<span>object</span>,</span></code><code><span leaf="">Â  logfc.threshold =Â <span>0.2</span>,</span></code><code><span leaf="">Â  min.diff.pct =Â <span>0.2</span>,</span></code><code><span leaf="">Â  only.pos =Â <span>TRUE</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><span># ç­›é€‰æ˜¾è‘—å·®å¼‚åŸºå› ï¼ˆFDRæ ¡æ­£åpå€¼&lt;0.05ï¼‰</span></span></code><code><span leaf="">Mks &lt;- Mks[Mks<span>$p_val_adj</span>Â &lt;Â <span>0.05</span>, ]</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 6. ç»†èƒç±»å‹ç»†åˆ†ï¼ˆLevel 2ï¼šç»†èƒäºšå‹ï¼‰</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># åˆå§‹åŒ–Level 2æ ‡è®°åŸºå› å’Œå…ƒæ•°æ®åˆ—è¡¨</span></span></code><code><span leaf="">MarkersSubcluster &lt;-Â <span>vector</span>(<span>"list"</span>, length =Â <span>length</span>(IdentsLvl1))</span></code><code><span leaf=""><span>names</span>(MarkersSubcluster) &lt;- IdentsLvl1</span></code><code><span leaf="">MetaDataSubClusters &lt;-Â <span>vector</span>(<span>"list"</span>, length =Â <span>length</span>(IdentsLvl1))</span></code><code><span leaf=""><span>names</span>(MetaDataSubClusters) &lt;- IdentsLvl1</span></code><code><span leaf=""><span># å¯¹æ¯ä¸ªLevel 1ç»†èƒç±»å‹è¿›è¡Œç»†åˆ†èšç±»</span></span></code><code><span leaf=""><span>for</span>(ClusterID inÂ <span>levels</span>(merged.<span>object</span><span>$Level1</span>)) {</span></code><code><span leaf="">Â Â <span>message</span>(ClusterID) Â <span># è¾“å‡ºå½“å‰å¤„ç†çš„ç»†èƒç±»å‹ï¼Œä¾¿äºè¿½è¸ªè¿›åº¦</span></span></code><code><span leaf="">Â Â <span># å­é›†å½“å‰Level 1ç»†èƒç±»å‹ï¼Œä¸“æ³¨äºç»†åˆ†åˆ†æ</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>subset</span>(merged.<span>object</span>, idents = ClusterID)</span></code><code><span leaf="">Â Â <span># è¯†åˆ«é«˜å˜åŸºå› ï¼Œä¸ºç»†åˆ†èšç±»åšå‡†å¤‡</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>FindVariableFeatures</span>(Subset)</span></code><code><span leaf="">Â Â <span># æ ‡å‡†åŒ–å’Œç¼©æ”¾æ•°æ®</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>ScaleData</span>(Subset)</span></code><code><span leaf="">Â Â <span># ä¸»æˆåˆ†åˆ†æï¼Œæå–ç»†åˆ†ç»´åº¦</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>RunPCA</span>(Subset)</span></code><code><span leaf="">Â Â <span># å¯»æ‰¾é‚»å±…ç»†èƒï¼ˆä½¿ç”¨25ä¸ªä¸»æˆåˆ†ï¼Œé«˜äºLevel 1åˆ†æï¼‰</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>FindNeighbors</span>(Subset, dims =Â <span>1</span>:<span>25</span>)</span></code><code><span leaf="">Â Â <span># ç»†åˆ†èšç±»ï¼ˆåˆ†è¾¨ç‡0.1ï¼Œä½äºLevel 1ï¼Œè·å¾—æ›´ç»†çš„äºšå‹ï¼‰</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>FindClusters</span>(Subset, resolution =Â <span>0.1</span>)</span></code><code><span leaf="">Â Â <span># ç”ŸæˆLevel 2æ ‡ç­¾ï¼ˆæ ¼å¼ï¼šLevel1åç§°_èšç±»ç¼–å·ï¼‰</span></span></code><code><span leaf="">Â  Subset<span>$Level2</span>Â &lt;-Â <span>paste0</span>(<span>gsub</span>(<span>" "</span>,Â <span>""</span>, ClusterID),Â <span>"_"</span>, Subset<span>$seurat_clusters</span>)</span></code><code><span leaf="">Â Â <span># è®¾ç½®å½“å‰æ ‡è¯†ä¸ºLevel 2æ ‡ç­¾ï¼Œä¾¿äºåç»­æ ‡è®°åŸºå› åˆ†æ</span></span></code><code><span leaf="">Â  Subset &lt;-Â <span>SetIdent</span>(Subset, value =Â <span>"Level2"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># å­˜å‚¨å½“å‰ç»†èƒç±»å‹çš„å…ƒæ•°æ®</span></span></code><code><span leaf="">Â  MetaDataSubClusters[[ClusterID]] &lt;- Subset@meta.data</span></code><code><span leaf=""><br></span></code><code><span leaf="">Â Â <span># å¯»æ‰¾Level 2ç»†åˆ†ç¾¤çš„æ ‡è®°åŸºå› ï¼ˆæ”¾å®½é˜ˆå€¼ï¼Œæ•æ‰ç»†å¾®å·®å¼‚ï¼‰</span></span></code><code><span leaf="">Â  SubMks &lt;-Â <span>FindAllMarkers</span>(</span></code><code><span leaf="">Â  Â  Subset,</span></code><code><span leaf="">Â  Â  min.diff.pct =Â <span>0.1</span>,</span></code><code><span leaf="">Â  Â  logfc.threshold =Â <span>0.1</span>,</span></code><code><span leaf="">Â  Â  only.pos =Â <span>TRUE</span></span></code><code><span leaf="">Â  )</span></code><code><span leaf="">Â Â <span># ç­›é€‰æ˜¾è‘—å·®å¼‚åŸºå› </span></span></code><code><span leaf="">Â  SubMks &lt;- SubMks[SubMks<span>$p_val_adj</span>Â &lt;Â <span>0.05</span>, ]</span></code><code><span leaf="">Â  MarkersSubcluster[[ClusterID]] &lt;- SubMks</span></code><code><span leaf="">}</span></code><code><span leaf=""><span># åˆå¹¶æ‰€æœ‰Level 2æ ‡è®°åŸºå› å’Œå…ƒæ•°æ®ï¼Œå½¢æˆç»Ÿä¸€æ•°æ®é›†</span></span></code><code><span leaf="">MarkersSubcluster &lt;-Â <span>do</span>.<span>call</span>(rbind, MarkersSubcluster)</span></code><code><span leaf="">MetaDataSubClusters &lt;-Â <span>do</span>.<span>call</span>(rbind, MetaDataSubClusters)</span></code><code><span leaf=""><span># ä»æ¡å½¢ç ä¸­æå–æ ·æœ¬ä¿¡æ¯ï¼Œä¾¿äºåç»­æ˜ å°„</span></span></code><code><span leaf="">MetaDataSubClusters<span>$Barcode</span>Â &lt;-Â <span>sapply</span>(</span></code><code><span leaf="">Â Â <span>strsplit</span>(<span>rownames</span>(MetaDataSubClusters),Â <span>"[.]"</span>),</span></code><code><span leaf="">Â  function(X) {Â <span>return</span>(X[<span>2</span>]) }</span></code><code><span leaf="">)</span></code><code><span leaf=""><span># å®šä¹‰Level 2çš„ç»†èƒç±»å‹æ ‡ç­¾ï¼ˆæŒ‰ç”Ÿç‰©å­¦æ„ä¹‰æ’åºï¼‰</span></span></code><code><span leaf="">IdentsLevel2 &lt;-Â <span>c</span>(</span></code><code><span leaf="">Â Â <span>"Bcells_0"</span>,Â <span>"Bcells_1"</span>,Â <span>"Bcells_2"</span>,Â <span>"Bcells_3"</span>,Â <span>"Bcells_4"</span>,</span></code><code><span leaf="">Â Â <span>"Endothelial_0"</span>,Â <span>"Endothelial_1"</span>,Â <span>"Endothelial_2"</span>,Â <span>"Endothelial_3"</span>,</span></code><code><span leaf="">Â Â <span>"Fibroblast_0"</span>,Â <span>"Fibroblast_1"</span>,Â <span>"Fibroblast_2"</span>,</span></code><code><span leaf="">Â Â <span>"IntestinalEpithelial_0"</span>,Â <span>"IntestinalEpithelial_1"</span>,Â <span>"IntestinalEpithelial_2"</span>,Â <span>"IntestinalEpithelial_3"</span>,Â <span>"IntestinalEpithelial_4"</span>,Â <span>"IntestinalEpithelial_5"</span>,</span></code><code><span leaf="">Â Â <span>"Myeloid_0"</span>,Â <span>"Myeloid_1"</span>,Â <span>"Myeloid_2"</span>,</span></code><code><span leaf="">Â Â <span>"Neuronal_0"</span>,Â <span>"Neuronal_1"</span>,</span></code><code><span leaf="">Â Â <span>"SmoothMuscle_0"</span>,Â <span>"SmoothMuscle_1"</span>,Â <span>"SmoothMuscle_2"</span>,Â <span>"SmoothMuscle_3"</span>,Â <span>"SmoothMuscle_4"</span>,</span></code><code><span leaf="">Â Â <span>"Tcells_0"</span>,Â <span>"Tcells_1"</span>,Â <span>"Tcells_2"</span>,Â <span>"Tcells_3"</span>,</span></code><code><span leaf="">Â Â <span>"Tumor_0"</span>,Â <span>"Tumor_1"</span>,Â <span>"Tumor_2"</span>,Â <span>"Tumor_3"</span>,</span></code><code><span leaf="">Â Â <span>"Unknown_0"</span>,Â <span>"Unknown_1"</span>,Â <span>"Unknown_2"</span>,Â <span>"Unknown_3"</span>,Â <span>"Unknown_4"</span>,Â <span>"Unknown_5"</span>,Â <span>"Unknown_6"</span></span></code><code><span leaf="">)</span></code><code><span leaf=""><span># è½¬æ¢ä¸ºå› å­ç±»å‹å¹¶æ’åºï¼Œç¡®ä¿å¯è§†åŒ–ä¸€è‡´æ€§</span></span></code><code><span leaf="">MetaDataSubClusters<span>$Level2</span>Â &lt;-Â <span>factor</span>(MetaDataSubClusters<span>$Level2</span>, levels = IdentsLevel2)</span></code><code><span leaf="">MarkersSubcluster<span>$cluster</span>Â &lt;-Â <span>factor</span>(MarkersSubcluster<span>$cluster</span>, levels = IdentsLevel2)</span></code><code><span leaf=""><span># å°†Level 2æ ‡ç­¾æ˜ å°„åˆ°Seuratå¯¹è±¡çš„å…ƒæ•°æ®ä¸­</span></span></code><code><span leaf="">merged.<span>object</span><span>$Level2</span>Â &lt;- MetaDataSubClusters<span>$Level2</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>colnames</span>(merged.<span>object</span>), MetaDataSubClusters<span>$Barcode</span>)</span></code><code><span leaf="">]</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 7. æ•°æ®æŠ•å½±ä¸å¯è§†åŒ–å‡†å¤‡</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># å°†Sketchæ•°æ®çš„é™ç»´ç»“æœæŠ•å½±åˆ°å…¨æ•°æ®é›†ï¼Œå®ç°é«˜æ•ˆåˆ†æ</span></span></code><code><span leaf="">merged.<span>object</span>Â &lt;-Â <span>Seurat</span>:::<span>ProjectData</span>(</span></code><code><span leaf="">Â Â <span>object</span>Â = merged.<span>object</span>,</span></code><code><span leaf="">Â  assay =Â <span>"RNA"</span>,</span></code><code><span leaf="">Â  full.reduction =Â <span>"pca.full"</span>,</span></code><code><span leaf="">Â  sketched.assay =Â <span>"sketch"</span>,</span></code><code><span leaf="">Â  sketched.reduction =Â <span>"pca"</span>,</span></code><code><span leaf="">Â  umap.model =Â <span>"umap"</span>,</span></code><code><span leaf="">Â  dims =Â <span>1</span>:<span>50</span>,</span></code><code><span leaf="">Â  refdata =Â <span>list</span>(L1 =Â <span>"Level1"</span>, L2 =Â <span>"Level2"</span>)</span></code><code><span leaf="">)</span></code><code><span leaf=""><span># è®¡ç®—Level 2å’ŒLevel 1æ ‡ç­¾çš„UMAPåæ ‡ä¸­ä½æ•°ï¼Œç”¨äºæ ‡ç­¾å®šä½</span></span></code><code><span leaf="">LabelsL2 &lt;- MetaData.merged %&gt;%Â <span>group_by</span>(L2) %&gt;%Â <span>summarise</span>(X =Â <span>median</span>(fullumap_1), Y =Â <span>median</span>(fullumap_2))</span></code><code><span leaf="">LabelsL1 &lt;- MetaData.merged %&gt;%Â <span>group_by</span>(L1) %&gt;%Â <span>summarise</span>(X =Â <span>median</span>(fullumap_1), Y =Â <span>median</span>(fullumap_2))</span></code><code><span leaf=""><span># åˆ›å»ºLevel 1ç»†èƒç±»å‹çš„é¢œè‰²è°ƒè‰²æ¿ï¼ˆåŸºäºggsciåŒ…ï¼‰</span></span></code><code><span leaf="">MetaData.merged<span>$L1</span>Â &lt;-Â <span>factor</span>(MetaData.merged<span>$L1</span>, levels =Â <span>sort</span>(<span>unique</span>(MetaData.merged<span>$L1</span>)))</span></code><code><span leaf="">ColsL1 &lt;- paletteer::<span>paletteer_d</span>(<span>"ggsci::category10_d3"</span>)[<span>1</span>:<span>length</span>(<span>levels</span>(MetaData.merged<span>$L1</span>))]</span></code><code><span leaf=""><span>names</span>(ColsL1) &lt;-Â <span>levels</span>(MetaData.merged<span>$L1</span>)</span></code><code><span leaf=""><span># è‡ªå®šä¹‰éƒ¨åˆ†ç»†èƒç±»å‹é¢œè‰²ï¼Œå¢å¼ºå¯è§†åŒ–è¾¨è¯†åº¦</span></span></code><code><span leaf="">ColsL1[<span>"T cells"</span>] &lt;-Â <span>"#8C564BFF"</span></span></code><code><span leaf="">ColsL1[<span>"Neuronal"</span>] &lt;-Â <span>"#7F7F7FFF"</span></span></code><code><span leaf=""><span># åˆ›å»ºLevel 2ç»†èƒäºšå‹çš„é¢œè‰²è°ƒè‰²æ¿</span></span></code><code><span leaf="">MetaData.merged<span>$L2</span>Â &lt;-Â <span>factor</span>(MetaData.merged<span>$L2</span>, levels =Â <span>sort</span>(<span>unique</span>(MetaData.merged<span>$L2</span>)))</span></code><code><span leaf="">ColsL2 &lt;- paletteer::<span>paletteer_d</span>(<span>"ggsci::default_igv"</span>)[<span>1</span>:<span>length</span>(<span>levels</span>(MetaData.merged<span>$L2</span>))]</span></code><code><span leaf=""><span>names</span>(ColsL2) &lt;-Â <span>levels</span>(MetaData.merged<span>$L2</span>)</span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># 8. ç©ºé—´å¯è§†åŒ–ï¼ˆFigure 3A-Bï¼‰</span></span></code><code><span leaf=""><span># ---------------------------</span></span></code><code><span leaf=""><span># ä»¥P1CRCæ ·æœ¬ä¸ºä¾‹è¿›è¡Œç©ºé—´ç»˜å›¾</span></span></code><code><span leaf="">Patient &lt;-Â <span>"P1CRC"</span></span></code><code><span leaf=""><span># æŒ‰æ ·æœ¬åˆ†å‰²å…ƒæ•°æ®</span></span></code><code><span leaf="">BarcodeData &lt;-Â <span>split</span>(MetaData.merged, MetaData.merged<span>$Patient</span>)</span></code><code><span leaf="">BarcodeData &lt;- BarcodeData[[Patient]]</span></code><code><span leaf=""><span># ç”Ÿæˆæ ·æœ¬æ•°æ®æ¡†ï¼ˆåŒ…å«ç©ºé—´åæ ‡å’Œç»†èƒç±»å‹ï¼‰</span></span></code><code><span leaf="">DF &lt;-Â <span>GenerateSampleData</span>(<span>"~/VisiumHD/PatientCRC1/outs/"</span>)<span>$bcs</span></span></code><code><span leaf=""><span># å°†ç»†èƒç±»å‹æ ‡ç­¾æ˜ å°„åˆ°ç©ºé—´æ•°æ®</span></span></code><code><span leaf="">DF<span>$Level1</span>Â &lt;- BarcodeData<span>$L1</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>paste0</span>(DF<span>$barcode</span>,Â <span>paste0</span>(<span>"_"</span>, Patient)),Â <span>rownames</span>(BarcodeData))</span></code><code><span leaf="">]</span></code><code><span leaf="">DF<span>$Level1</span>Â &lt;-Â <span>factor</span>(DF<span>$Level1</span>, levels =Â <span>sort</span>(<span>unique</span>(DF<span>$Level1</span>)))</span></code><code><span leaf="">DF<span>$Level2</span>Â &lt;- BarcodeData<span>$L2</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>paste0</span>(DF<span>$barcode</span>,Â <span>paste0</span>(<span>"_"</span>, Patient)),Â <span>rownames</span>(BarcodeData))</span></code><code><span leaf="">]</span></code><code><span leaf="">DF<span>$Level2</span>Â &lt;-Â <span>factor</span>(DF<span>$Level2</span>, levels =Â <span>sort</span>(<span>unique</span>(DF<span>$Level2</span>)))</span></code><code><span leaf="">DF<span>$DeconvolutionClass</span>Â &lt;- BarcodeData<span>$DeconvolutionClass</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>paste0</span>(DF<span>$barcode</span>,Â <span>paste0</span>(<span>"_"</span>, Patient)),Â <span>rownames</span>(BarcodeData))</span></code><code><span leaf="">]</span></code><code><span leaf="">DF<span>$DeconvolutionL1</span>Â &lt;- BarcodeData<span>$DeconvolutionLabel1</span>[</span></code><code><span leaf="">Â Â <span>match</span>(<span>paste0</span>(DF<span>$barcode</span>,Â <span>paste0</span>(<span>"_"</span>, Patient)),Â <span>rownames</span>(Bar</span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dRtKfcX4NZ8Ks6SgEh6ozA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
