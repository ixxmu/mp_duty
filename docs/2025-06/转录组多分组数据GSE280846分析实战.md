---
title: "è½¬å½•ç»„å¤šåˆ†ç»„æ•°æ®GSE280846åˆ†æå®æˆ˜"
date: 2025-06-15T02:48:56Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ¼«æ¼«å­¦"
]
categories: ["Acdemic"]
---
è½¬å½•ç»„å¤šåˆ†ç»„æ•°æ®GSE280846åˆ†æå®æˆ˜ by ç”Ÿä¿¡æ¼«æ¼«å­¦
------
<div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">å†™åœ¨å¼€å¤´</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä¸Šä¸€æœŸæ¨æ–‡æ ¹æ®å°æ´è€å¸ˆçš„æ•™ç¨‹æ•´ç†äº†â€”â€”<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247494409&amp;idx=1&amp;sn=1f8ab2e34277988348ea6f9a33ccb765&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">è½¬å½•ç»„å¤šåˆ†ç»„æ•°æ®åˆ†ææµç¨‹è§£æ</a>ï¼Œé‚£è¿™ä¸€æœŸå°±æ‰¾ä¸ªæ•°æ®å®é™…ç»ƒä¹ ä¸€ä¸‹ï¼Œçœ‹çœ‹åˆ†æè¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">ç”¨åˆ°çš„ç»ƒä¹ æ•°æ®æ˜¯ï¼š</span><code><span leaf="">GSE280846</span></code><span leaf="">ï¼Œä¹‹å‰å­¦å‘˜æ¨èç»™æˆ‘ä½†æ˜¯æ‹–åˆ°ç°åœ¨è¿˜æ²¡è·‘å®Œhhhh</span></strong></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010829" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicxZmic352LCkfVY20SU7Nh43Nqib6UI2dFiaGVGVk0uIibAWlJtboZCHdqg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicxZmic352LCkfVY20SU7Nh43Nqib6UI2dFiaGVGVk0uIibAWlJtboZCHdqg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">GSE280846æ•°æ®ç®€ä»‹</span></span><span></span></h3><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç ”ç©¶æ–¹æ³•</span></span><span></span></h4><ul><li><section><span leaf="">ä½¿ç”¨å…‰å‡è¡€æ³•è¯±å¯¼8-10å‘¨é¾„çš„é›„æ€§Trem2é‡ç”Ÿå‹ï¼ˆWTï¼‰æˆ–æ•²é™¤å‹ï¼ˆKOï¼‰å°é¼ ï¼ˆC57Bl6èƒŒæ™¯ï¼‰å‘ç”Ÿä¸­é£ã€‚</span></section></li><li><section><span leaf="">é€šè¿‡è…¹è…”æ³¨å°„50 mg/kgçš„ç«ç‘°çº¢Bï¼Œéšåç”¨525 nmæ³¢é•¿ã€125 mWåŠŸç‡çš„æ¿€å…‰ç…§å°„ç‰¹å®šçš®å±‚åŒºåŸŸè¯±å¯¼ä¸­é£ã€‚</span></section></li><li><section><span leaf="">çš®å±‚æŸä¼¤åŒºåŸŸé™åˆ¶åœ¨ä»¥é¡¶éª¨å‰2 mmã€ä¾§å‘2 mmä¸ºä¸­å¿ƒçš„3 mmç›´å¾„åœ†å†…ã€‚</span></section></li><li><section><span leaf="">åœ¨æŸä¼¤å7å¤©ï¼Œå¯¹å°é¼ è¿›è¡ŒçŒæ³¨ï¼Œå…¶å¤§è„‘ç”¨TTCæŸ“è‰²ä»¥ç²¾ç¡®åˆ†ç¦»æ¢—æ­»æ ¸å¿ƒï¼ˆIï¼‰ã€æ¢—æ­»å‘¨å›´åŒºï¼ˆPï¼‰å’Œå¯¹ä¾§åŒºåŸŸï¼ˆCï¼‰ã€‚</span></section></li></ul><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">å…±è®¡æ˜¯18ä¸ªæ ·å“</span></strong></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010827" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicOibjnIQFZ0QyoqdayhaBsxGPhFpQic6jWiaTsSiaQvKyvTxevObxibqwwdg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicOibjnIQFZ0QyoqdayhaBsxGPhFpQic6jWiaTsSiaQvKyvTxevObxibqwwdg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æä¾›äº†</span><code><span leaf="">raw_counts.txt.gz</span></code><span leaf="">æ•°æ®æ–‡ä»¶ï¼Œç›´æ¥ç‚¹å‡»httpä¸‹è½½åˆ°æœ¬åœ°å³å¯</span></strong></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010830" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDciczKN6diaCp9XDHyIiaLtJ4OzuYTbAC0wQdIRVwvrmXJwkTgb6ym9nzfIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDciczKN6diaCp9XDHyIiaLtJ4OzuYTbAC0wQdIRVwvrmXJwkTgb6ym9nzfIg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">æ•°æ®è¯»å–å’Œæ•´ç†</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">é¦–å…ˆå°†æ•°æ®è¯»å–è¿›æ¥ï¼Œå¹¶ä¸”åˆ é™¤æ‰ä¸éœ€è¦çš„è¡Œï¼Œå°†åŸºå› åè®¾ç½®ä¸ºè¡Œå</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#è¯»å–æ•°æ®å¹¶æ•´ç†</span></span><br><span leaf="">rm(list = ls())</span><br><span leaf="">proj =Â </span><span><span leaf="">"GSE280846"</span></span><br><br><span leaf="">dat = read.delim(</span><span><span leaf="">"GSE280846_raw_counts.txt.gz"</span></span><span leaf="">,</span><br><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â header = T,row.names = 1)</span><br><br><span leaf="">library(tibble)</span><br><span leaf="">rownames(dat) = dat[,2]</span><br><br><span leaf="">dat = dat[,-c(1,2)]</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img alt="è¯»å–æ—¶" data-imgfileid="100010828" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic6UfmYeT6RW1oI8RSVcEwHFcMlLAfMDrq9T17YJIY58KF0ibZz536j9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic6UfmYeT6RW1oI8RSVcEwHFcMlLAfMDrq9T17YJIY58KF0ibZz536j9w/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">è¯»å–æ—¶</span></figcaption></figure><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img alt="æ•´ç†å" data-imgfileid="100010831" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicge7rMwx2lIWFPrxM8gsCOF0QuVXWB32jpD9uRXo4NiaJBDK3KQqG9OQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicge7rMwx2lIWFPrxM8gsCOF0QuVXWB32jpD9uRXo4NiaJBDK3KQqG9OQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">æ•´ç†å</span></figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">è¿‡æ»¤åŸºå› </span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#è¿‡æ»¤åŸºå› </span></span><br><span leaf="">dim(dat)</span><br><span leaf="">exp = dat[apply(dat, 1,Â </span><span><span leaf="">function</span></span><span leaf="">(x) sum(x &gt; 0) &gt; 0.5*ncol(dat)), ]</span><br><span leaf="">dim(exp)</span><br><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010834" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicTyNgibvnh8MXWK2pKRsP7tEKwoj6YwzqT0Bv9QpoXq8dQ4vIaeP7ZKA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicTyNgibvnh8MXWK2pKRsP7tEKwoj6YwzqT0Bv9QpoXq8dQ4vIaeP7ZKA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æŠ¥é”™å°tips</span></span><span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æƒ³å¿…å¤§å®¶åº”è¯¥ä¹Ÿçœ‹å‡ºæ¥äº†ï¼Œä»Šå¤©çš„æ•°æ®å…¶å®å’Œä¸Šä¸€æœŸæ¨æ–‡çš„æ•°æ®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå®ƒä¸æ˜¯æ•´æ•°å€¼ï¼</span></strong></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ‰€ä»¥åº”è¯¥éœ€è¦æå‰å–æ•´çš„ï¼Œè™½ç„¶å°è°¢æ˜¯åœ¨åé¢åˆ†æçš„è¿‡ç¨‹ä¸­æ‰çªç„¶å‘ç°ï¼</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æŠ¥é”™ä¿¡æ¯ï¼š</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; dds &lt;- DESeqDataSetFromMatrix(</span><br><span leaf="">+ Â  countData = exp,</span><br><span leaf="">+ Â  colData = coldata,</span><br><span leaf="">+ Â  design= ~ condition)</span><br><span leaf="">ErrorÂ </span><span><span leaf="">in</span></span><span leaf="">Â DESeqDataSet(se, design = design, ignoreRank) :Â </span><br><span leaf="">Â  some valuesÂ </span><span><span leaf="">in</span></span><span leaf="">Â assay are not integers</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010833" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicia9y30f9H1OLdyXK4tX3ysyMANoKNpLXl5WINxHEIOpKvxOaIHHf5rw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicia9y30f9H1OLdyXK4tX3ysyMANoKNpLXl5WINxHEIOpKvxOaIHHf5rw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">åæ­£é—®é¢˜æ˜¯è¿™ä¹ˆä¸ªé—®é¢˜ï¼Œå¤„ç†çš„æ–¹æ³•å°±æ˜¯å¯ä»¥å–æ•´æˆ–è€…ç›´æ¥å°†æ•°æ®å˜æˆæ•´æ•°å‹ï¼Œæˆ‘é‡‡ç”¨äº†roundå‡½æ•°å–æ•´</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">exp &lt;- round(exp) Â </span><span><span leaf=""># å››èˆäº”å…¥åˆ°æœ€è¿‘çš„æ•´æ•°</span></span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010835" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicRQGdljOWRCuDGtDBhKcPJlnPs7PSVC95fgAgfjpibrcOHJkfqp8w3icw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicRQGdljOWRCuDGtDBhKcPJlnPs7PSVC95fgAgfjpibrcOHJkfqp8w3icw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">ä¸‹è½½ä¸´åºŠä¿¡æ¯æ•´ç†åˆ†ç»„</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">ä½¿ç”¨</span><code><span leaf="">tinyarray</span></code><span leaf="">åŒ…ä¸­çš„</span><code><span leaf="">geo_download</span></code><span leaf="">ç›´æ¥ä¸‹è½½å³å¯</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">library(tinyarray)</span><br><span leaf="">pd = geo_download(</span><span><span leaf="">"GSE280846"</span></span><span leaf="">,colon_remove = T)</span><span><span leaf="">$pd</span></span><br><br><span leaf="">pd</span><span><span leaf="">$description</span></span><span leaf="">Â %</span><span><span leaf="">in</span></span><span leaf="">% colnames(exp)</span><br><br><span leaf="">exp = exp[,match(pd</span><span><span leaf="">$description</span></span><span leaf="">,colnames(exp))]Â </span><span><span leaf="">#è°ƒæ•´è¡¨è¾¾çŸ©é˜µå’Œä¸´åºŠä¿¡æ¯é¡ºåºä¸€è‡´</span></span><br><span leaf="">identical(colnames(exp),pd</span><span><span leaf="">$description</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010832" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic96IkTxJ7EKITBibR9TvKXJMDGIfKL3A9UvkItXvHLZ9mrE39ibEaxicCw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic96IkTxJ7EKITBibR9TvKXJMDGIfKL3A9UvkItXvHLZ9mrE39ibEaxicCw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æ•´ç†åˆ†ç»„ä¿¡æ¯</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#æå–æ•°æ®åŠæ•´ç†åˆ†ç»„ä¿¡æ¯</span></span><br><span leaf="">exp &lt;- exp[,c(1:3,7:9,13:15)]</span><br><span leaf="">colnames(exp)</span><br><span leaf="">library(stringr)</span><br><span leaf="">Group = str_remove_all(colnames(exp),</span><span><span leaf="">"\\d"</span></span><span leaf="">)</span><br><span leaf="">Group = factor(Group,levels = c(</span><span><span leaf="">"KO_C"</span></span><span leaf="">,</span><span><span leaf="">"KO_I"</span></span><span leaf="">,</span><span><span leaf="">"KO_P"</span></span><span leaf="">))</span><br><span leaf="">Group</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010836" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicdibicm8JcdFFcUEn30sNGgkMKFM9EdIn4o0pxcnKBn45eypRgO4tNgOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicdibicm8JcdFFcUEn30sNGgkMKFM9EdIn4o0pxcnKBn45eypRgO4tNgOg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">å› ä¸ºæ²¡æœ‰ä»”ç»†æ‹œè¯»æ–‡çŒ®ï¼Œæ‰€ä»¥å°±æŒ‰ç…§ç›¸åº”çš„åˆ†ç»„è¿›è¡Œæ’åºï¼Œå°†é‡ç”Ÿå‹ï¼ˆWTï¼‰å’Œæ•²é™¤å‹ï¼ˆKOï¼‰æŒ‰ç…§ä¸‰ä¸ªé‡‡æ ·éƒ¨ä½è¿›è¡Œæ•´ç†ã€‚</span></strong></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">Deseq2å·®å¼‚åˆ†æ</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">åœ¨è¿™é‡Œå› ä¸ºåˆ†ç»„è¾ƒå¤šï¼Œæ‰€ä»¥ç»ƒä¹ çš„æ—¶å€™åªå¯¹æ•²é™¤å‹ï¼ˆKOï¼‰æŒ‰ç…§ä¸‰ä¸ªé‡‡æ ·éƒ¨ä½è¿›è¡Œäº†å·®å¼‚åˆ†æ</span></strong></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#Deseq2å·®å¼‚åˆ†æ----</span></span><br><span leaf="">library(DESeq2)</span><br><span leaf="">coldata = data.frame(row.names = colnames(exp),</span><br><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â condition = Group)</span><br><br><span leaf="">dds &lt;- DESeqDataSetFromMatrix(</span><br><span leaf="">Â  countData = exp,</span><br><span leaf="">Â  colData = coldata,</span><br><span leaf="">Â  design= ~ condition)</span><br><br><span leaf="">dds &lt;- DESeq(dds)</span><br><span leaf="">px = levels(Group);px</span><br><br><span leaf="">res &lt;- list(</span><br><span leaf="">Â  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[2], px[1])),</span><br><span leaf="">Â  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[3], px[1])),</span><br><span leaf="">Â  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[3], px[2]))</span><br><span leaf="">)</span><br><br><span leaf="">names(res) = c(paste0(px[2],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[1]),</span><br><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â paste0(px[3],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[1]),</span><br><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â paste0(px[3],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[2]))</span><br><br><br><span><span leaf="">#æ ‡è®°æ¯ä¸ªåŸºå› æ˜¯ä¸Šè°ƒè¿˜æ˜¯ä¸‹è°ƒ</span></span><br><span leaf="">logFC_t = 1</span><br><span leaf="">p_t = 0.05</span><br><br><span leaf="">library(dplyr)</span><br><span leaf="">res2 = lapply(res,Â </span><span><span leaf="">function</span></span><span leaf="">(x){</span><br><span leaf="">Â  deg = as.data.frame(x)</span><br><span leaf="">Â  deg = na.omit(deg)</span><br><span leaf="">Â  k1 = (deg</span><span><span leaf="">$padj</span></span><span leaf="">Â &lt; p_t)&amp;(deg</span><span><span leaf="">$log2FoldChange</span></span><span leaf="">Â &lt; -logFC_t)</span><br><span leaf="">Â  k2 = (deg</span><span><span leaf="">$padj</span></span><span leaf="">Â &lt; p_t)&amp;(deg</span><span><span leaf="">$log2FoldChange</span></span><span leaf="">Â &gt; logFC_t)</span><br><span leaf="">Â  deg = mutate(deg,change = ifelse(k1,</span><span><span leaf="">"DOWN"</span></span><span leaf="">,ifelse(k2,</span><span><span leaf="">"UP"</span></span><span leaf="">,</span><span><span leaf="">"NOT"</span></span><span leaf="">)))</span><br><span leaf="">Â Â </span><span><span leaf="">print</span></span><span leaf="">(table(deg</span><span><span leaf="">$change</span></span><span leaf="">))</span><br><span leaf="">Â Â </span><span><span leaf="">return</span></span><span leaf="">(deg)</span><br><span leaf="">})</span><br><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">çœ‹èµ·æ¥</span><code><span leaf="">KO_P_vs_KO_C</span></code><span leaf="">çš„ç»“æœæœ‰ç‚¹ç‚¹ä¸ä¸€æ ·ï¼Œä¸‹è°ƒåŸºå› çš„æ•°é‡è¾ƒå°‘ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºé˜ˆå€¼çš„åŸå› </span></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010838" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic3Q5TKrnNNFjHjPEvTRBdfLMNosfX9O5ka69WnwdED4OMNwkx5AqBEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic3Q5TKrnNNFjHjPEvTRBdfLMNosfX9O5ka69WnwdED4OMNwkx5AqBEw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">pcaå›¾ã€ç«å±±å›¾å’Œçƒ­å›¾</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#ç«å±±å›¾å’Œçƒ­å›¾----</span></span><br><span leaf="">library(ggplot2)</span><br><span leaf="">library(tinyarray)</span><br><span leaf="">exp[1:4,1:4]</span><br><br><span><span leaf=""># cpm å»é™¤æ–‡åº“å¤§å°çš„å½±å“</span></span><br><span leaf="">dat = log2(edgeR::cpm(exp)+1)</span><br><br><span><span leaf=""># æ‰“å¼€ PDF å›¾å½¢è®¾å¤‡</span></span><br><span leaf="">pdf(</span><span><span leaf="">"pca_plot.pdf"</span></span><span leaf="">, width = 8, height = 6)</span><br><br><span><span leaf=""># ç»˜åˆ¶ PCA å›¾</span></span><br><span leaf="">pca.plot &lt;- draw_pca(dat, Group)</span><br><span><span leaf="">print</span></span><span leaf="">(pca.plot) Â </span><span><span leaf=""># ç¡®ä¿å›¾å½¢è¢«ç»˜åˆ¶åˆ°è®¾å¤‡ä¸Š</span></span><br><br><span><span leaf=""># å…³é—­å›¾å½¢è®¾å¤‡</span></span><br><span leaf="">dev.off()</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010839" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicPZ4GzeVmAOpwmVPNGfBADHPYFib6friaalT5pDgBqLry0R9chqh9geqA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicPZ4GzeVmAOpwmVPNGfBADHPYFib6friaalT5pDgBqLry0R9chqh9geqA/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cg1 = rownames(res2[[1]])[res2[[1]]</span><span><span leaf="">$change</span></span><span leaf="">Â !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><br><span leaf="">cg2 = rownames(res2[[2]])[res2[[2]]</span><span><span leaf="">$change</span></span><span leaf="">Â !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><span leaf="">cg3 = rownames(res2[[3]])[res2[[3]]</span><span><span leaf="">$change</span></span><span leaf="">Â !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><span leaf="">h1 = draw_heatmap(dat[cg1,],Group,cluster_cols = F)</span><br><span leaf="">h2 = draw_heatmap(dat[cg2,],Group,cluster_cols = F)</span><br><span leaf="">h3 = draw_heatmap(dat[cg3,],Group,cluster_cols = F)</span><br><span leaf="">v1 = draw_volcano(res2[[1]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[1])</span><br><span leaf="">v2 = draw_volcano(res2[[2]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[2])</span><br><span leaf="">v3 = draw_volcano(res2[[3]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[3])</span><br><span leaf="">library(patchwork)</span><br><span leaf="">p &lt;- (h1 + h2 + h3) / (v1 + v2 + v3) +</span><br><span leaf="">Â  plot_layout(guides =Â </span><span><span leaf="">'collect'</span></span><span leaf="">) &amp;theme(legend.position =Â </span><span><span leaf="">"none"</span></span><span leaf="">);p</span><br><br><span leaf="">ggsave(</span><span><span leaf="">"final_plot.png"</span></span><span leaf="">, plot = p, width = 15, height = 10, units =Â </span><span><span leaf="">"in"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010841" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicHZia5I0UR0WlMMaeEYAiaKE5dq0OuTnyTLIjDKKvMCXCqClasg52us8w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicHZia5I0UR0WlMMaeEYAiaKE5dq0OuTnyTLIjDKKvMCXCqClasg52us8w/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">å–å…¨éƒ¨å·®å¼‚åŸºå› è¿›è¡Œå¯Œé›†åˆ†æ</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#å¯Œé›†åˆ†æ----</span></span><br><span leaf="">library(clusterProfiler)</span><br><span leaf="">library(org.Hs.eg.db)</span><br><span><span leaf="">#Täº¤é›†ï¼ŒFåˆé›†</span></span><br><span><span leaf="">if</span></span><span leaf="">(F){</span><br><span leaf="">Â Â </span><span><span leaf="">#genes = tinyarray::intersect_all(cg1,cg2,cg3)</span></span><br><span leaf="">Â  genes = tinyarray::intersect_all(cg1,cg2,cg3)</span><br><span leaf="">}</span><span><span leaf="">else</span></span><span leaf="">{</span><br><span leaf="">Â  genes = tinyarray::union_all(cg1,cg2,cg3)</span><br><span leaf="">}</span><br><br><span leaf="">head(genes)</span><br><br><span><span leaf="">#æœ‰å¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜æŠ¥é”™</span></span><br><span leaf="">g = quick_enrich(genes,destdir = tempdir(),species =Â </span><span><span leaf="">"mouse"</span></span><span leaf="">)</span><br><br><span leaf="">names(g)</span><br><br><span leaf="">g[[1]][1:4,1:4]</span><br><br><span leaf="">library(patchwork)</span><br><span leaf="">g[[3]]+g[[4]]</span><br><br><span leaf="">ggplot2::ggsave(</span><span><span leaf="">"enrich.png"</span></span><span leaf="">,width = 12,height = 7)</span><br><br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-imgfileid="100010840" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic4TtZZmZq6JpRmb6kZgzQAY9un9SVDN6FTicXdTHnkM9ib3wiaxWPgeGCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic4TtZZmZq6JpRmb6kZgzQAY9un9SVDN6FTicXdTHnkM9ib3wiaxWPgeGCA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">ç»“å°¾å°æ„Ÿæ‚Ÿ</span></span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">å…¶å®æ•™ç¨‹ç¤ºä¾‹æ•°æ®è‚¯å®šæ˜¯å¾ˆå®¹æ˜“èƒ½è·‘é€šçš„ï¼Œä½†æ˜¯å®é™…åˆ†æä¸­ï¼Œä¸åŒçš„æ•°æ®ä¼šæœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œè™½ç„¶åˆ†ææµç¨‹æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ•°æ®æ˜¯ä¸ä¸€æ ·çš„</span></strong></p><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">æ¯”å¦‚è¿™ä¸ªæ•°æ®å°±è¦å–æ•´ï¼Œä»¥åŠè°ƒæ•´åˆé€‚çš„é˜ˆå€¼ï¼åæ­£å°±æ˜¯ç†è§£åˆ†æçš„æµç¨‹å’Œä»£ç ï¼Œç„¶åå…·ä½“æ•°æ®å…·ä½“åˆ†æï¼</span></strong></p><p data-tool="mdniceç¼–è¾‘å™¨"><strong><span leaf="">å­¦ä¹ èµ„æ–™ğŸ’¾ï¼š</span></strong></p><ol><li><section><span leaf="">ç”Ÿæ–°æŠ€èƒ½æ ‘æ•°æ®æŒ–æ˜è¯¾ç¨‹â€”â€”<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">ç”Ÿä¿¡å…¥é—¨&amp;æ•°æ®æŒ–æ˜çº¿ä¸Šç›´æ’­è¯¾7æœˆç­</a></span></section></li><li><section><span leaf="">å‚è€ƒä¹¦ç±ğŸ“šâ€”â€”ã€ŠRè¯­è¨€æ•°æ®å¯è§†åŒ–ä¸ç»Ÿè®¡åŸºç¡€ã€‹</span></section></li></ol></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/h8klcixxL9qPkUYqSIVudQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
