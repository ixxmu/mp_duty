---
title: "转录组多分组数据GSE280846分析实战"
date: 2025-06-15T02:48:56Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
转录组多分组数据GSE280846分析实战 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">写在开头</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">上一期推文根据小洁老师的教程整理了——<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247494409&amp;idx=1&amp;sn=1f8ab2e34277988348ea6f9a33ccb765&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">转录组多分组数据分析流程解析</a>，那这一期就找个数据实际练习一下，看看分析过程中有没有什么需要注意的</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">用到的练习数据是：</span><code><span leaf="">GSE280846</span></code><span leaf="">，之前学员推荐给我但是拖到现在还没跑完hhhh</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010829" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicxZmic352LCkfVY20SU7Nh43Nqib6UI2dFiaGVGVk0uIibAWlJtboZCHdqg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicxZmic352LCkfVY20SU7Nh43Nqib6UI2dFiaGVGVk0uIibAWlJtboZCHdqg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">GSE280846数据简介</span></span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">研究方法</span></span><span></span></h4><ul><li><section><span leaf="">使用光凝血法诱导8-10周龄的雄性Trem2野生型（WT）或敲除型（KO）小鼠（C57Bl6背景）发生中风。</span></section></li><li><section><span leaf="">通过腹腔注射50 mg/kg的玫瑰红B，随后用525 nm波长、125 mW功率的激光照射特定皮层区域诱导中风。</span></section></li><li><section><span leaf="">皮层损伤区域限制在以顶骨前2 mm、侧向2 mm为中心的3 mm直径圆内。</span></section></li><li><section><span leaf="">在损伤后7天，对小鼠进行灌注，其大脑用TTC染色以精确分离梗死核心（I）、梗死周围区（P）和对侧区域（C）。</span></section></li></ul><p data-tool="mdnice编辑器"><strong><span leaf="">共计是18个样品</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010827" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicOibjnIQFZ0QyoqdayhaBsxGPhFpQic6jWiaTsSiaQvKyvTxevObxibqwwdg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicOibjnIQFZ0QyoqdayhaBsxGPhFpQic6jWiaTsSiaQvKyvTxevObxibqwwdg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">提供了</span><code><span leaf="">raw_counts.txt.gz</span></code><span leaf="">数据文件，直接点击http下载到本地即可</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010830" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDciczKN6diaCp9XDHyIiaLtJ4OzuYTbAC0wQdIRVwvrmXJwkTgb6ym9nzfIg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDciczKN6diaCp9XDHyIiaLtJ4OzuYTbAC0wQdIRVwvrmXJwkTgb6ym9nzfIg/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">数据读取和整理</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">首先将数据读取进来，并且删除掉不需要的行，将基因名设置为行名</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#读取数据并整理</span></span><br><span leaf="">rm(list = ls())</span><br><span leaf="">proj = </span><span><span leaf="">"GSE280846"</span></span><br><br><span leaf="">dat = read.delim(</span><span><span leaf="">"GSE280846_raw_counts.txt.gz"</span></span><span leaf="">,</span><br><span leaf="">                 header = T,row.names = 1)</span><br><br><span leaf="">library(tibble)</span><br><span leaf="">rownames(dat) = dat[,2]</span><br><br><span leaf="">dat = dat[,-c(1,2)]</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img alt="读取时" data-imgfileid="100010828" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic6UfmYeT6RW1oI8RSVcEwHFcMlLAfMDrq9T17YJIY58KF0ibZz536j9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic6UfmYeT6RW1oI8RSVcEwHFcMlLAfMDrq9T17YJIY58KF0ibZz536j9w/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">读取时</span></figcaption></figure><figure data-tool="mdnice编辑器"><span leaf=""><img alt="整理后" data-imgfileid="100010831" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicge7rMwx2lIWFPrxM8gsCOF0QuVXWB32jpD9uRXo4NiaJBDK3KQqG9OQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicge7rMwx2lIWFPrxM8gsCOF0QuVXWB32jpD9uRXo4NiaJBDK3KQqG9OQ/640?wx_fmt=png&amp;from=appmsg"></span><figcaption><span leaf="">整理后</span></figcaption></figure><p data-tool="mdnice编辑器"><strong><span leaf="">过滤基因</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#过滤基因</span></span><br><span leaf="">dim(dat)</span><br><span leaf="">exp = dat[apply(dat, 1, </span><span><span leaf="">function</span></span><span leaf="">(x) sum(x &gt; 0) &gt; 0.5*ncol(dat)), ]</span><br><span leaf="">dim(exp)</span><br><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010834" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicTyNgibvnh8MXWK2pKRsP7tEKwoj6YwzqT0Bv9QpoXq8dQ4vIaeP7ZKA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicTyNgibvnh8MXWK2pKRsP7tEKwoj6YwzqT0Bv9QpoXq8dQ4vIaeP7ZKA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h4 data-tool="mdnice编辑器"><span></span><span><span leaf="">报错小tips</span></span><span></span></h4><p data-tool="mdnice编辑器"><strong><span leaf="">想必大家应该也看出来了，今天的数据其实和上一期推文的数据有点不一样，它不是整数值！</span></strong></p><p data-tool="mdnice编辑器"><span leaf="">所以应该需要提前取整的，虽然小谢是在后面分析的过程中才突然发现！</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">报错信息：</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">&gt; dds &lt;- DESeqDataSetFromMatrix(</span><br><span leaf="">+   countData = exp,</span><br><span leaf="">+   colData = coldata,</span><br><span leaf="">+   design= ~ condition)</span><br><span leaf="">Error </span><span><span leaf="">in</span></span><span leaf=""> DESeqDataSet(se, design = design, ignoreRank) : </span><br><span leaf="">  some values </span><span><span leaf="">in</span></span><span leaf=""> assay are not integers</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010833" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicia9y30f9H1OLdyXK4tX3ysyMANoKNpLXl5WINxHEIOpKvxOaIHHf5rw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicia9y30f9H1OLdyXK4tX3ysyMANoKNpLXl5WINxHEIOpKvxOaIHHf5rw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">反正问题是这么个问题，处理的方法就是可以取整或者直接将数据变成整数型，我采用了round函数取整</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">exp &lt;- round(exp)  </span><span><span leaf=""># 四舍五入到最近的整数</span></span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010835" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicRQGdljOWRCuDGtDBhKcPJlnPs7PSVC95fgAgfjpibrcOHJkfqp8w3icw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicRQGdljOWRCuDGtDBhKcPJlnPs7PSVC95fgAgfjpibrcOHJkfqp8w3icw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">下载临床信息整理分组</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">使用</span><code><span leaf="">tinyarray</span></code><span leaf="">包中的</span><code><span leaf="">geo_download</span></code><span leaf="">直接下载即可</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">library(tinyarray)</span><br><span leaf="">pd = geo_download(</span><span><span leaf="">"GSE280846"</span></span><span leaf="">,colon_remove = T)</span><span><span leaf="">$pd</span></span><br><br><span leaf="">pd</span><span><span leaf="">$description</span></span><span leaf=""> %</span><span><span leaf="">in</span></span><span leaf="">% colnames(exp)</span><br><br><span leaf="">exp = exp[,match(pd</span><span><span leaf="">$description</span></span><span leaf="">,colnames(exp))] </span><span><span leaf="">#调整表达矩阵和临床信息顺序一致</span></span><br><span leaf="">identical(colnames(exp),pd</span><span><span leaf="">$description</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010832" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic96IkTxJ7EKITBibR9TvKXJMDGIfKL3A9UvkItXvHLZ9mrE39ibEaxicCw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic96IkTxJ7EKITBibR9TvKXJMDGIfKL3A9UvkItXvHLZ9mrE39ibEaxicCw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">整理分组信息</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#提取数据及整理分组信息</span></span><br><span leaf="">exp &lt;- exp[,c(1:3,7:9,13:15)]</span><br><span leaf="">colnames(exp)</span><br><span leaf="">library(stringr)</span><br><span leaf="">Group = str_remove_all(colnames(exp),</span><span><span leaf="">"\\d"</span></span><span leaf="">)</span><br><span leaf="">Group = factor(Group,levels = c(</span><span><span leaf="">"KO_C"</span></span><span leaf="">,</span><span><span leaf="">"KO_I"</span></span><span leaf="">,</span><span><span leaf="">"KO_P"</span></span><span leaf="">))</span><br><span leaf="">Group</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010836" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicdibicm8JcdFFcUEn30sNGgkMKFM9EdIn4o0pxcnKBn45eypRgO4tNgOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicdibicm8JcdFFcUEn30sNGgkMKFM9EdIn4o0pxcnKBn45eypRgO4tNgOg/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><strong><span leaf="">因为没有仔细拜读文献，所以就按照相应的分组进行排序，将野生型（WT）和敲除型（KO）按照三个采样部位进行整理。</span></strong></p><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">Deseq2差异分析</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">在这里因为分组较多，所以练习的时候只对敲除型（KO）按照三个采样部位进行了差异分析</span></strong></p><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#Deseq2差异分析----</span></span><br><span leaf="">library(DESeq2)</span><br><span leaf="">coldata = data.frame(row.names = colnames(exp),</span><br><span leaf="">                     condition = Group)</span><br><br><span leaf="">dds &lt;- DESeqDataSetFromMatrix(</span><br><span leaf="">  countData = exp,</span><br><span leaf="">  colData = coldata,</span><br><span leaf="">  design= ~ condition)</span><br><br><span leaf="">dds &lt;- DESeq(dds)</span><br><span leaf="">px = levels(Group);px</span><br><br><span leaf="">res &lt;- list(</span><br><span leaf="">  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[2], px[1])),</span><br><span leaf="">  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[3], px[1])),</span><br><span leaf="">  results(dds, contrast = c(</span><span><span leaf="">"condition"</span></span><span leaf="">, px[3], px[2]))</span><br><span leaf="">)</span><br><br><span leaf="">names(res) = c(paste0(px[2],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[1]),</span><br><span leaf="">               paste0(px[3],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[1]),</span><br><span leaf="">               paste0(px[3],</span><span><span leaf="">"_vs_"</span></span><span leaf="">,px[2]))</span><br><br><br><span><span leaf="">#标记每个基因是上调还是下调</span></span><br><span leaf="">logFC_t = 1</span><br><span leaf="">p_t = 0.05</span><br><br><span leaf="">library(dplyr)</span><br><span leaf="">res2 = lapply(res, </span><span><span leaf="">function</span></span><span leaf="">(x){</span><br><span leaf="">  deg = as.data.frame(x)</span><br><span leaf="">  deg = na.omit(deg)</span><br><span leaf="">  k1 = (deg</span><span><span leaf="">$padj</span></span><span leaf=""> &lt; p_t)&amp;(deg</span><span><span leaf="">$log2FoldChange</span></span><span leaf=""> &lt; -logFC_t)</span><br><span leaf="">  k2 = (deg</span><span><span leaf="">$padj</span></span><span leaf=""> &lt; p_t)&amp;(deg</span><span><span leaf="">$log2FoldChange</span></span><span leaf=""> &gt; logFC_t)</span><br><span leaf="">  deg = mutate(deg,change = ifelse(k1,</span><span><span leaf="">"DOWN"</span></span><span leaf="">,ifelse(k2,</span><span><span leaf="">"UP"</span></span><span leaf="">,</span><span><span leaf="">"NOT"</span></span><span leaf="">)))</span><br><span leaf="">  </span><span><span leaf="">print</span></span><span leaf="">(table(deg</span><span><span leaf="">$change</span></span><span leaf="">))</span><br><span leaf="">  </span><span><span leaf="">return</span></span><span leaf="">(deg)</span><br><span leaf="">})</span><br><br></code></pre><p data-tool="mdnice编辑器"><span leaf="">看起来</span><code><span leaf="">KO_P_vs_KO_C</span></code><span leaf="">的结果有点点不一样，下调基因的数量较少，大概是因为阈值的原因</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010838" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic3Q5TKrnNNFjHjPEvTRBdfLMNosfX9O5ka69WnwdED4OMNwkx5AqBEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic3Q5TKrnNNFjHjPEvTRBdfLMNosfX9O5ka69WnwdED4OMNwkx5AqBEw/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">pca图、火山图和热图</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#火山图和热图----</span></span><br><span leaf="">library(ggplot2)</span><br><span leaf="">library(tinyarray)</span><br><span leaf="">exp[1:4,1:4]</span><br><br><span><span leaf=""># cpm 去除文库大小的影响</span></span><br><span leaf="">dat = log2(edgeR::cpm(exp)+1)</span><br><br><span><span leaf=""># 打开 PDF 图形设备</span></span><br><span leaf="">pdf(</span><span><span leaf="">"pca_plot.pdf"</span></span><span leaf="">, width = 8, height = 6)</span><br><br><span><span leaf=""># 绘制 PCA 图</span></span><br><span leaf="">pca.plot &lt;- draw_pca(dat, Group)</span><br><span><span leaf="">print</span></span><span leaf="">(pca.plot)  </span><span><span leaf=""># 确保图形被绘制到设备上</span></span><br><br><span><span leaf=""># 关闭图形设备</span></span><br><span leaf="">dev.off()</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010839" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicPZ4GzeVmAOpwmVPNGfBADHPYFib6friaalT5pDgBqLry0R9chqh9geqA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicPZ4GzeVmAOpwmVPNGfBADHPYFib6friaalT5pDgBqLry0R9chqh9geqA/640?wx_fmt=png&amp;from=appmsg"></span></figure><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cg1 = rownames(res2[[1]])[res2[[1]]</span><span><span leaf="">$change</span></span><span leaf=""> !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><br><span leaf="">cg2 = rownames(res2[[2]])[res2[[2]]</span><span><span leaf="">$change</span></span><span leaf=""> !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><span leaf="">cg3 = rownames(res2[[3]])[res2[[3]]</span><span><span leaf="">$change</span></span><span leaf=""> !=</span><span><span leaf="">"NOT"</span></span><span leaf="">]</span><br><span leaf="">h1 = draw_heatmap(dat[cg1,],Group,cluster_cols = F)</span><br><span leaf="">h2 = draw_heatmap(dat[cg2,],Group,cluster_cols = F)</span><br><span leaf="">h3 = draw_heatmap(dat[cg3,],Group,cluster_cols = F)</span><br><span leaf="">v1 = draw_volcano(res2[[1]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[1])</span><br><span leaf="">v2 = draw_volcano(res2[[2]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[2])</span><br><span leaf="">v3 = draw_volcano(res2[[3]],pkg = 1,logFC_cutoff = logFC_t,adjust = T,lab = names(res)[3])</span><br><span leaf="">library(patchwork)</span><br><span leaf="">p &lt;- (h1 + h2 + h3) / (v1 + v2 + v3) +</span><br><span leaf="">  plot_layout(guides = </span><span><span leaf="">'collect'</span></span><span leaf="">) &amp;theme(legend.position = </span><span><span leaf="">"none"</span></span><span leaf="">);p</span><br><br><span leaf="">ggsave(</span><span><span leaf="">"final_plot.png"</span></span><span leaf="">, plot = p, width = 15, height = 10, units = </span><span><span leaf="">"in"</span></span><span leaf="">)</span><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010841" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicHZia5I0UR0WlMMaeEYAiaKE5dq0OuTnyTLIjDKKvMCXCqClasg52us8w/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YdmYqpdReOzn140Q8IIDcicHZia5I0UR0WlMMaeEYAiaKE5dq0OuTnyTLIjDKKvMCXCqClasg52us8w/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">取全部差异基因进行富集分析</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">#富集分析----</span></span><br><span leaf="">library(clusterProfiler)</span><br><span leaf="">library(org.Hs.eg.db)</span><br><span><span leaf="">#T交集，F合集</span></span><br><span><span leaf="">if</span></span><span leaf="">(F){</span><br><span leaf="">  </span><span><span leaf="">#genes = tinyarray::intersect_all(cg1,cg2,cg3)</span></span><br><span leaf="">  genes = tinyarray::intersect_all(cg1,cg2,cg3)</span><br><span leaf="">}</span><span><span leaf="">else</span></span><span leaf="">{</span><br><span leaf="">  genes = tinyarray::union_all(cg1,cg2,cg3)</span><br><span leaf="">}</span><br><br><span leaf="">head(genes)</span><br><br><span><span leaf="">#有可能因为网络问题报错</span></span><br><span leaf="">g = quick_enrich(genes,destdir = tempdir(),species = </span><span><span leaf="">"mouse"</span></span><span leaf="">)</span><br><br><span leaf="">names(g)</span><br><br><span leaf="">g[[1]][1:4,1:4]</span><br><br><span leaf="">library(patchwork)</span><br><span leaf="">g[[3]]+g[[4]]</span><br><br><span leaf="">ggplot2::ggsave(</span><span><span leaf="">"enrich.png"</span></span><span leaf="">,width = 12,height = 7)</span><br><br></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100010840" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic4TtZZmZq6JpRmb6kZgzQAY9un9SVDN6FTicXdTHnkM9ib3wiaxWPgeGCA/640?wx_fmt=png&amp;from=appmsg" data-type="png" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YdmYqpdReOzn140Q8IIDcic4TtZZmZq6JpRmb6kZgzQAY9un9SVDN6FTicXdTHnkM9ib3wiaxWPgeGCA/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><span></span><span><span leaf="">结尾小感悟</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">其实教程示例数据肯定是很容易能跑通的，但是实际分析中，不同的数据会有不同的处理方式，虽然分析流程是一样的，但是数据是不一样的</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">比如这个数据就要取整，以及调整合适的阈值！反正就是理解分析的流程和代码，然后具体数据具体分析！</span></strong></p><p data-tool="mdnice编辑器"><strong><span leaf="">学习资料💾：</span></strong></p><ol><li><section><span leaf="">生新技能树数据挖掘课程——<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247543316&amp;idx=1&amp;sn=c8569d0d202077108063c17964e8c128&amp;scene=21#wechat_redirect" textvalue="" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课7月班</a></span></section></li><li><section><span leaf="">参考书籍📚——《R语言数据可视化与统计基础》</span></section></li></ol></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/h8klcixxL9qPkUYqSIVudQ",target="_blank" rel="noopener noreferrer">原文链接</a>
