---
title: "基于GRN与细胞相互作用的单细胞多组学模拟器｜scMultiSim"
date: 2025-06-01T02:29:54Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞训练营"
]
categories: ["Acdemic"]
---
基于GRN与细胞相互作用的单细胞多组学模拟器｜scMultiSim by 单细胞训练营
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []" data-mpa-action-id="mbcez3923gn"><p data-tool="mdnice编辑器"><span leaf="">scMultiSim 是一款最新的单细胞模拟工具，它可以<span textstyle="">从头生成包含基因表达、染色质可及性、RNA 速度和空间位置等多组学信息的数据，同时在模拟过程中显式考虑细胞身份、基因调控网络（GRN）和细胞-细胞相互作用（CCI）等多种生物学因素</span>。图1给出了 scMultiSim 的总体架构和流程示意：用户以一个分化树（描述细胞类型间分化关系）作为基本输入，再辅以可选的真实 GRN 和细胞互作信息，通过参数化的方式生成模拟数据。左侧面板 (a) 显示输入、输出和使用场景：最基本的输入是一棵细胞分化树，用于确定输出中细胞群的轨迹或簇结构；用户可提供真实的 GRN 和 CCI 信息，并通过调整模型参数来控制各生物学因素对模拟结果的影响。右侧面板 (b) 展示了模拟流程：首先基于 CIF（Cell Identity Factors）和 RIV（Region Identity Vectors）生成 scATAC-seq 数据，以及基于 CIF、GIV（Gene Identity Vectors）和 scATAC 数据构建 scRNA-seq 的动力学参数；随后，若需输出 RNA 速度（velocity），则使用完整的动力学模型模拟未切割（unspliced）和已切割（spliced）的 mRNA 表达，否则可使用等价的 Beta-泊松模型以提高效率。随后通过迭代考虑时间和空间信息，将 CCI 效应加入细胞状态转变过程（图1b(viii)），最后向模拟的真计数加入技术噪声和批次效应得到观测计数。scMultiSim 输出包含细胞群身份、RNA 速度、GRN 和 CCI 真值，以及染色质可及性与转录组数据的对应关系。这使得在一个数据集中即可评估多种下游任务，包括聚类/轨迹推断、多模态/多批次数据整合、RNA 速度估计、GRN 推断和 CCI 推断等。由于支持用户自定义每个因素的影响强度，scMultiSim 能够在可控条件下对各种算法进行综合基准测试，其应用场景远超现有模拟工具。</span></p><section nodeleaf="" data-mpa-action-id="mbc6djxl1f1t" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNeVfydydTYS1boPrmtia6Z5ia5ERrJMcqGJ5DNiafPbiacLQVM00oWricpTg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.975609756097561" data-s="300,640" data-type="png" data-w="1394" type="block" data-imgfileid="100003844" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNeVfydydTYS1boPrmtia6Z5ia5ERrJMcqGJ5DNiafPbiacLQVM00oWricpTg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器" mpa-font-style="mbcdjbeqdtr" data-mpa-action-id="mbcdjbff20sl" data-pm-slice="0 0 []"><span leaf=""><span textstyle=""> 图1. scMultiSim 模型的总体示意图</span>。左 (a) 为输入与输出示意：最基本的输入是细胞分化树（控制输出中细胞状态轨迹或簇结构），可选提供真实基因调控网络 (GRN) 和细胞-细胞相互作用 (CCI) 信息，并通过参数调节各生物学因素影响。中 (b) 为模拟流程：首先使用 CIF、RIV 生成 scATAC-seq 数据；然后结合 GIV、CIF 和区域-基因映射矩阵构造 scRNA-seq 的动力学参数；接着在需要 RNA 速度时采用完整动力学模型，否则使用 Beta-泊松模型生成基因表达；多步迭代中加入 CCI 影响；最后向真计数添加技术噪声和批次效应得到观测数据。</span></p><p data-tool="mdnice编辑器" mpa-font-style="mbcdlqrz1gh8" data-mpa-action-id="mbcdlqsmai9" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">模型设计与生成原理</span></span></p><p data-tool="mdnice编辑器"><span leaf="">scMultiSim 的核心设计基于 CIF/GIV 框架：<span textstyle="">每个细胞拥有一个一维的 Cell Identity Factors (CIF) 向量，表示细胞的外在状态（如细胞类型、处理条件等）；每个基因对应一个 Gene Identity Vectors (GIV) 向量，表示不同 CIF 因素对该基因表达的敏感程度。将 CIF 矩阵与 GIV 矩阵相乘即可得到“细胞×基因”的动力学参数矩阵，其中不同区段可分别编码细胞身份、GRN 影响和 CCI 作用等不同生物因素</span>。此外，引入了 Region Identity Vectors (RIV) 来模拟染色质区域：类似地将 CIF 与 RIV 相乘生成一个非真实比例的 scATAC-seq 数据矩阵，再通过秩变换和高斯噪声校正使其分布近似真实数据。在这一过程中，基于用户提供的 GRN 结构（TF－目标基因关系）和配体-受体对列表，模型可自动生成 TF–基因调控、区域–基因关联等映射矩阵，使得生成的 scATAC-seq 数据与 scRNA-seq 数据保持一致性。</span></p><p data-tool="mdnice编辑器"><span leaf="">在基因表达模拟方面，scMultiSim 延续 SymSim的动力学模型思想：每个基因在每个细胞中可在“打开/关闭”状态间切换，涉及参数</span><span data-formula="k_{on}"><span data-formula="k_{on}"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 1371.2 851.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="TeXAtom" transform="translate(554,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(485,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></g></g><g></g></svg></span></span><span leaf="">（打开速率）、</span><span data-formula="k_{off}"><span data-formula="k_{off}"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 1724.8 989" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="TeXAtom" transform="translate(554,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(485,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(1035,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></g></g><g></g></svg></span></span><span leaf="">（关闭速率）和转录率</span><span data-formula="r"><span data-formula="r"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -442 451 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g></g></svg></span></span><span leaf=""> 。scMultiSim 首先根据 CIF/GIV（加上 RIV 调整）计算得到这些参数的值，因而每个参数同时反映了细胞身份、染色质可及性、基因调控网络和细胞互作等四个生物因素。然后，scMultiSim 提供两种模拟模式：若开启 RNA 速度模拟，则使用完整动力学模型逐步模拟从祖先细胞到叶细胞的基因表达动态，可直接输出真实的 spliced/unspliced mRNA 计数和速度向量；否则为提高运算速度，可使用 Beta-泊松模型（等价于动力学方程组的稳态解）直接一次性采样出每个基因的表达量。模拟结束后，即可得到包含真实基因表达计数、RNA 速度和其它层次信息的细胞表达矩阵。</span></p><section nodeleaf="" data-mpa-action-id="mbceqne023iw" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNY8zicxGgQtnterngRHTQWt2etCt6UKzIAia00ibVZAribX5ulPjlHWoSJg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.9344729344729344" data-s="300,640" data-type="png" data-w="1404" type="block" data-imgfileid="100003848" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNY8zicxGgQtnterngRHTQWt2etCt6UKzIAia00ibVZAribX5ulPjlHWoSJg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">图2. scMultiSim 中 CIF 和 GIV 的构造示意以及模拟数据示例</span>。 (a) CIF 和 GIV 矩阵示意：通过将 CIF（代表细胞异质性的矩阵）与 GIV（代表基因水平调控的矩阵）相乘，得到每个动力学参数的“细胞×基因”矩阵。CIF/GIV 均被分段，每段编码一种生物因素；例如图中用不同颜色区分了细胞身份、GRN 和 CCI 等。 (b) scMultiSim 提供了三种预定义的分化树结构（Phyla1：线性；Phyla3/Phyla5：具有3或5个叶的分支结构），用于生成相应的细胞群落落。 (c–d) 基于同一个数据集 MT3a（遵循图中 Phyla3 结构）生成的模拟数据在 t-SNE 空间中的可视化：左图为 scRNA-seq 数据，右图为对应的 scATAC-seq 数据，可见两种数据的一致群聚趋势。 (e–f) 参数灵敏度分析示例：改变调控效应强度 </span><span mpa-font-style="mbcecq8115en"><span data-formula="\alpha"><span data-formula="\alpha"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -442 640 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></g></g></g><g></g></svg></span></span><span leaf="">（e）或 ATAC 影响参数 </span><span data-formula="\rho"><span data-formula="\rho"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -442 517 658" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70C" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"></path></g></g></g><g></g></svg></span></span><span leaf="" data-mpa-action-id="mbcecq81z6z">（f）后，不同细胞群体间的相关性指标发生变化。 (g–h) 添加技术噪声前后的表达和 RNA 速度示意：图 (g) 为加入批次效应后的模拟观测基因表达，(h) 为模拟数据中的真实 spliced/unspliced 计数及其 RNA 速度（红色箭头指示分化方向）。通过这些演示可见，scMultiSim 在多模态数据生成上可以灵活再现复杂的群体结构与技术干扰。</span></span></p><p data-tool="mdnice编辑器"><span leaf="">细胞-细胞相互作用 (CCI) 的模拟涉及在空间网格上排列细胞并定义邻接规则：scMultiSim 将细胞依照2D网格随机排布（可按同类细胞邻近概率 </span><span data-formula="\phi"><span data-formula="\phi"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -694 596 899" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g></g></g><g></g></svg></span></span><span leaf=""> 调节聚簇程度），每个细胞至多与一定范围内的近邻发生作用。具体地，<span textstyle="">为模拟配体-受体相互作用，定义一个预置的配体-受体数据库矩阵 </span></span><span data-formula="M"><span data-formula="M"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -683 1051 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g><g></g></svg></span></span><span leaf=""><span textstyle="">，其中每一行对应一个配体-受体对及其作用强度。对每一对细胞类型 </span></span><span data-formula="(P,Q)"><span data-formula="(P,Q)"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -750 2764.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(1140,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1584.7,0)"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g><g data-mml-node="mo" transform="translate(2375.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g><g></g></svg></span></span><span leaf=""><span textstyle="">，从 </span></span><span data-formula="M"><span data-formula="M"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -683 1051 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g></g></g><g></g></svg></span></span><span leaf=""><span textstyle=""> 中采样得到该类型对之间可能的相互作用</span>；对于相邻细胞对，若其类型为 </span><span data-formula="P"><span data-formula="P"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -683 751 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g></g></g><g></g></svg></span></span><span leaf=""> 和 </span><span data-formula="Q"><span data-formula="Q"><svg xmlns="http://www.w3.org/2000/svg" role="img" focusable="false" viewbox="0 -704 791 898" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D444" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path></g></g></g><g></g></svg></span></span><span leaf="">，则按照对应关系确定这两个细胞间的具体相互作用；用户也可进一步指定各细胞对使用哪些配体-受体子集。在实际模拟过程中，每个细胞还维护一组 “ligand-CIF/GIV” 向量来累积来自邻居的配体表达影响，其计算方式类似于 TF-CIF。通过这种方式，scMultiSim 能在基因表达参数中内隐地引入细胞互作效应。图3中就展示了模拟效果：可见在 GRN 的驱动下，同一转录因子调控的基因群表现出较高的表达相关性（图3b）；在空间上，相邻细胞若存在 CCI，其基因表达相关性显著高于无 CCI 的邻居对（图3e）；通过调整同类型细胞的邻近概率参数，可使同类细胞聚集或分散（图3f）。这一切均与模型设计意图吻合：例如图3c所示，当基因19 的染色质区域闭合时，其作为转录因子的表达显著下降，从而影响其靶基因20的表达。</span></p><section nodeleaf="" data-mpa-action-id="mbceswssni7" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNcDBoweOMOo5CgRiasN4o6iaD7OVt6QG4B1a9fdJRw9jpibLo67oibxZrzg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8567335243553008" data-s="300,640" data-type="png" data-w="1396" type="block" data-imgfileid="100003849" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNcDBoweOMOo5CgRiasN4o6iaD7OVt6QG4B1a9fdJRw9jpibLo67oibxZrzg/640?wx_fmt=png&amp;from=appmsg"></section><p data-pm-slice="0 0 []"><span data-mpa-action-id="mbcez383222h"><b><span leaf=""><span textstyle="">图3.</span></span></b></span><span leaf=""><span textstyle=""> scMultiSim 利用基因调控网络（GRN）和细胞互作网络（CCI）驱动单细胞多组学数据模拟。</span>(a)</span><span leaf=""> 展示了用于生成主要模拟数据集的 GRN 和 CCI 网络结构。红色节点表示转录因子（TF）基因，绿色节点为配体基因；绿色连边表示模拟 CCI 时引入的配体–受体作用对。该网络结构用于定义 TF 与靶基因、配体与受体间的调控关系，是后续模拟的基础。(b)</span><span leaf=""> 为模拟数据集 MT3a 的基因模块相关性热图（共 500 基因、500 细胞，使用 Phyla3 拓扑结构，CIF 标准差 σ = 0.1）。左侧与上方的颜色标记代表对应基因的调控 TF。可以看到同一个 TF 所调控的基因往往具有更高的表达相关性，并在热图中聚为一个模块，验证了 GRN 对表达的有效建模。(c)</span><span leaf=""> 展示 TF–靶基因对（基因19–基因20）在特定细胞系谱路径（Phyla3 中 4–5–3 路径）上的表达情况（取对数转化后）。TF 与靶基因的表达之间呈正相关趋势。图中还加入了 TF 基因19的染色质可及性（由其两个染色质区域的平均值计算得出），可以看到当区域关闭时，TF 表达显著下降，从而影响下游靶基因的表达。(d)</span><span leaf=""> 模拟细胞的空间分布图，每种颜色代表一个细胞类型。箭头表示存在 CCI，即某个配体–受体对（此处为基因101–基因2）在两细胞之间作用。可见大多数 CCI 发生在不同类型细胞之间（默认行为），模拟符合现实中细胞间通讯的空间选择性特征。(e)</span><span leaf=""> 展示细胞对之间的表达相关性比较：①有 CCI 的相邻细胞对，②无 CCI 的相邻细胞对，③非邻近细胞对。结果表明，有 CCI 的细胞对其表达相关性更高（n = 6），说明 CCI 被成功嵌入表达模型并对表达产生实际影响。(f)</span><span leaf=""> 空间变量基因（SVG）模拟示例：上图为人工设定的空间层状区域真值，下图为两个 SVG 表达图谱。左图中，模拟基因在指定区域内高表达，其他区域低表达；右图中，表达沿水平方向逐渐增强。数据来自数据集 D，显示 scMultiSim 可支持表达强度受空间位置调控的模拟任务。(g)</span><span leaf="" data-mpa-action-id="mbcez3831smc"> scMultiSim 与真实 10x Multiome PBMC 数据集的比较。模拟数据与真实数据在多个统计特征上（例如基因表达水平分布、基因间相关性、基因–可及性一致性等）高度一致（细胞数 n = 2,939，基因数 n = 1,000）。图中为箱线图和小提琴图，中央线为中位数，箱体为上下四分位数，须表示 1.5×IQR 范围，验证模拟数据的现实性与可用性。</span></p><p data-pm-slice="0 0 []"><span data-mpa-action-id="mbcev3v9122c"><b><span leaf=""><br></span></b></span></p><p data-tool="mdnice编辑器" mpa-font-style="mbceddwq22ay" data-mpa-action-id="mbceddx71uci" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">数据模拟流程与应用</span></span></p><p data-tool="mdnice编辑器"><span leaf="">scMultiSim 的数据模拟流程包括以下主要步骤：首先，<span textstyle="">用户提供一个细胞分化树（可用 Newick 格式），定义细胞类型或状态沿时间的演化关系。这棵“骨架树”决定了模拟中各细胞群落的连续或离散结构</span>；scMultiSim 也允许用户<span textstyle="">通过调整差异 CIF 的数量来控制轨迹的清晰度</span>。接下来构建 GRN 网络：<span textstyle="">用户可以直接输入TF–基因调控列表，或只输入GRN让程序自动生成相应的位点-基因和 TF-位点矩阵</span>（用户可指定每个基因对应的调控区域数目分布）。一旦 GRN 确定，程序根据 CIF/GIV 和染色质 RIV 生成一系列动力学参数矩阵，用于后续的基因表达模拟。然后根据指定模式产生 scATAC-seq 和 scRNA-seq 数据：<span textstyle="">生成 scATAC-seq 数据时，先用随机采样的 RIV 和 CIF 相乘得到一个原始可及性矩阵，再通过秩变换拟合真实 ATAC 数据分布并加噪声校正；生成 scRNA-seq 数据时，则使用上述得到的动力学参数——在RNA速度模式下逐步仿真整个细胞系谱（得到真实的 spliced/unspliced 计数和速度向量），或采用 Beta-泊松模型直接采样出最终的基因表达量。在模拟中，模型还根据配体-受体关系和空间邻接规则插入细胞-细胞相互作用，使得最终每个细胞都拥有一个固定的空间坐标并根据定义的 CCI 规律影响其基因表达（该过程由 Ligand-CIF/GIV 等概念实现）</span>。最终，scMultiSim 输出的模拟数据包括真实的基因表达计数、RNA 速度、群集标签、GRN/CCI 真值及空间坐标等信息，用户可根据需求加入不同批次效应或技术偏差。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">利用模拟数据可以进行多种下游任务的评估和验证</span>。图4展示了 scMultiSim 生成的数据如何用于评测多模态数据整合方法（即 Mosaic 整合）：图4a说明了测试方案，只对部分批次的数据进行交互标注；图4b为某个模拟数据集 MT10a 的 t-SNE 可视化，各细胞按类型和批次着色；图4c 汇总了几种整合方法在不同场景下的评价指标（ARI、NMI 代表保持细胞群体结构的能力，图连通度和批次 ASW 代表批次混合效果）。结果表明，在所有指标上 UINMF 方法表现最佳，Seurat-bridge 与 Cobolt 在细胞识别和批次混合上各有优势；同时我们发现，当批次间可共用数据量较少或细胞分布更加连续时，ARI 和 NMI 会下降（连续数据群体往往更难准确分群）。<span textstyle="">借助 scMultiSim，可快速比较不同整合算法在设定条件下的性能</span>，为算法开发和应用提供定量依据。类似地，scMultiSim 数据也可用于评估基因调控网络推断和细胞互作推断方法：</span></p><section nodeleaf="" data-mpa-action-id="mbcephql1bs1" data-pm-slice="0 0 []"><img data-src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNtokOpnnHSgaBXAFN7CjQzlBmibK2nwYVhCywO0Xrb5fc31KeB0IoPibg/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.806312769010043" data-s="300,640" data-type="png" data-w="1394" type="block" data-imgfileid="100003847" src="https://mmbiz.qpic.cn/mmbiz_png/LjkGSkc5VwJUkhAmnv1pmoGldthAwSUNtokOpnnHSgaBXAFN7CjQzlBmibK2nwYVhCywO0Xrb5fc31KeB0IoPibg/640?wx_fmt=png&amp;from=appmsg"></section><p data-tool="mdnice编辑器" mpa-font-style="mbceourc16bm" data-mpa-action-id="mbceourzoiz" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">图4. Mosaic 多模态数据整合方法的基准测试示例</span>。（a）整合任务示意：三个批次矩阵中，仅批次1与3有细胞类型注释（粉色和蓝色矩阵），其他为待整合（如图左）。（b）数据集 MT10a 的t-SNE可视化，不同颜色表示细胞类型（组）和批次。（c）各整合方法在不同设置下的评价结果。横轴为不同合并场景，纵轴为指标值（ARI、NMI 越高表示群体保持越好；图连通度、批次 ASW 越高表示批次混合越好）。可以看到 UINMF 在四项指标上均居领先 ￼；随着可共用数据量减少（用于注释的批次数量变少）或细胞分布越连续，ARI/NMI 分数会相应降低 ￼，这符合直觉。scMultiSim 使我们能够在可控条件下比较不同算法的表现，为多组学整合方法开发提供定量基准。 </span></p><p data-tool="mdnice编辑器"><span leaf="">相比其他主流单细胞模拟工具，<span textstyle="">scMultiSim 的特色在于多模态与可解释性</span>。例如，SymSim 之类的模拟器主要针对单一 scRNA-seq 数据生成，侧重模拟数据的多级噪声（技术误差、细胞内异质性等），并提供细胞身份与基因身份的真值；dyngen 是一个多模态模拟器，能够在设定的 GRN 驱动下生成带有真实 RNA 速度的转录组数据；scDesign3 则是一款参考真实数据的统计模拟器，可生成包括蛋白质、甲基化和空间信息等多种组学数据。与这些工具相比，<span textstyle="">scMultiSim 从零开始合成数据的同时，还将所有生物因素通过参数化明确建模，因此其模拟结果具有高度可定制性和可解释性</span>。例如，我们可通过调整 CIF 标准差控制细胞群内异质程度，通过改变配体-受体的参数控制 CCI 强度；所有这些参数意义清晰，便于用户精确调节。此外，<span textstyle="">scMultiSim 直接输出 GRN 和 CCI 的groudtruth，这使得其模拟数据可同时用于多种分析任务的综合基准测试</span>，而 dyngen 等现有工具本身不支持细胞间互作或多批次效应（dyngen 本身不生成 CCI 信息）。总体上，scMultiSim 在功能覆盖面和模拟复杂度上更为丰富，但<span textstyle="">也要求用户理解和配置更多参数</span>；而参考数据驱动的模拟器（如 scDesign3）则依赖真实数据统计特征，更适合快速生成与已知数据集相似的样本。</span></p><p data-tool="mdnice编辑器" mpa-font-style="mbcejqofj92" data-mpa-action-id="mbcejqp31lt7" data-pm-slice="0 0 []"><span leaf=""><span textstyle="">研究者视角：总结与展望</span></span></p><p data-tool="mdnice编辑器"><span leaf="">从用户角度看，scMultiSim 提供了灵活而透明的模拟流程：用户只需准备一棵简单的分化树（Newick 文件）作为输入，不必为细胞轨迹构建复杂的先验网络；程序内置了默认参数和真实数据对应的参数集，便于快速入门和实验复现。各个参数具有明确的生物学含义，使用者可以根据需要控制每种因素的强度，例如<span textstyle="">调节 CCI 强度参数、细胞类型亲和度等，定制所需的数据特点</span>。优势方面，scMultiSim 最大的亮点在于其可将多种生物学效应编码到同一个模拟模型中，联合生成的多组学数据提供了单组学无法比拟的信息量。这对于开发新的多组学分析方法具有重要意义：例如其耦合的输出可以帮助设计需要联合考虑转录组与表观基因组的算法，提高多模态信息的利用效率。scMultiSim 的这种“多因子联合模拟”使其成为目前最多功能的单细胞模拟器之一，可用于前所未有的多种基准测试任务。</span></p><p data-tool="mdnice编辑器"><span leaf="">当然，scMultiSim 也存在一些局限。作为一种去新 (de novo) 模拟工具，它只能建模我们已知并明确设计的生物机制，无法捕捉所有真实生物过程的细节；模拟结果需要结合实际数据验证其合理性。同时，高度参数化的模型对用户来说学习成本更高——尽管参数可解释，但调整众多参数以复现特定真实数据的难度也较大。scMultiSim 的开发者也指出，模拟结果应作为算法开发的“概念验证”，还需在真实数据上进一步检验结果的通用性。未来展望上，scMultiSim 的框架高度可扩展，例如可以进一步支持细胞-类型特异的 GRN 动态、或者使 scATAC-seq 和 scRNA-seq 遵循不同的分化轨迹；也可加入更多组学类型（如蛋白质丰度）的模拟。总体而言，scMultiSim 在单细胞多组学模拟领域迈出了重要的一步，将有助于推动新算法的发展和验证。其作者总结认为，<span textstyle="">耦合的多组学输出为算法</span>提供了更丰富的信息，为单细胞多组学与空间数据方法开发提供了强有力的基准。我们期待未来社区基于 scMultiSim 进行更多探索，在优势互补的同时不断完善模拟工具的功能和实用性。</span></p></section><hr><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf="">参考文献: 文中所引用内容均来源于 Hechen Li 等人 2025 年发表的Nature Methods 文章及其补充材料。其</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/lr77gwPgs8rYClrJvB2VKQ",target="_blank" rel="noopener noreferrer">原文链接</a>
