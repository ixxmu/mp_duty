---
title: "UCSCXena æ•°æ®åº“"
date: 2025-06-02T14:45:41Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡èœé¸Ÿå›¢"
]
categories: ["Acdemic"]
---
UCSCXena æ•°æ®åº“ by ç”Ÿä¿¡èœé¸Ÿå›¢
------
<div><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ‰è¿™ä¹ˆä¸€ä¸ªæ•°æ®åº“æŠŠå¤šç§çš„æ•°æ®éƒ½æ•´åˆåœ¨äº†ä¸€èµ·ï¼Œå¹¶ä¸”è¿›è¡Œäº†ç›¸åº”çš„æ•´åˆã€‚é‚£å°±æ˜¯ï¼šUCSC Xenaï¼š https://xena.ucsc.edu/</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æåˆ° UCSC Xena æ•°æ®åº“ï¼Œå°±å¿…é¡»å…ˆè¯´ä¸€ä¸‹ TCGA æ•°æ®å’Œ GTEx æ•°æ®ã€‚TCGA æ”¶å½•äº†å¤§é‡çš„ç™Œç—‡æ•°æ®ï¼Œä½†æ­£å¸¸æ ·æœ¬å¾ˆå°‘ï¼Œæœ‰äº›ç»„ç»‡ç”šè‡³ä¸€ä¸ªæ ·æœ¬éƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ GTEx æ•°æ®å¼¥è¡¥äº†è¿™ä¸€ç‚¹ï¼ŒåŒ…å«çº¦æ¥è‡ª 1000 åå¥åº·æˆå¹´ä¸ªä½“ 54 ä¸ªéç—…å˜ç»„ç»‡éƒ¨ä½çš„å…¨åŸºå› ä¿¡æ¯ã€‚ä½†æ˜¯ä¸€ä¸ªä¸ªæ•°æ®åº“å»ä¸‹è½½å¤ªéº»çƒ¦ï¼ŒUSCS Xena æ•°æ®åº“å°±æ•´åˆäº†å¤šä¸ªæ•°æ®åº“ï¼Œå…¶ä¸­å°±åŒ…æ‹¬è¿™ä¸¤ä¸ªæ•°æ®ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">å®˜ç½‘ä¹Ÿè´´å¿ƒçš„ç»™äº†ä»‹ç»ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">https://ucsc-xena.gitbook.io/project</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ€å¥½çš„æ•™ç¨‹æ˜¯å®˜ç½‘ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªç½‘ç«™çš„å¸®åŠ©é¡µé¢ï¼ˆhttps://ucsc-xena.gitbook.io/projectï¼‰æ˜¯æˆ‘çœ‹åˆ°çš„æœ€æ¸…æ™°çš„ã€‚å®Œå…¨ä¸ç”¨æˆ‘å†ç”»è›‡æ·»è¶³ã€‚æˆ‘åªç®€å•è¯´ä¸€ä¸‹æ•°æ®ç»“æ„å§ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">æ•°æ®é›†</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æˆªè‡³ç›®å‰ï¼ŒUCSC Xena æ•°æ®åº“æœ‰ 256 ä¸ª é˜Ÿåˆ—ï¼Œ2315 ä¸ªæ•°æ®é›†ã€‚è¿™äº›æ•°æ®æ¥ç»„äºä¸åŒçš„æ•°æ®ä¸­å¿ƒå’Œå¹³å°ã€‚</span></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibg4xDroj62OxusVZM5rQLldzcpqXZvrOM0fuEl55rdmI5yX3y5yibVwjg/640?wx_fmt=png&amp;from=appmsg" data-ratio="1.3064066852367688" data-type="png" data-w="359" data-imgfileid="100051177" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibg4xDroj62OxusVZM5rQLldzcpqXZvrOM0fuEl55rdmI5yX3y5yibVwjg/640?wx_fmt=png&amp;from=appmsg"></span></figure><ol><li><section><strong><font><span leaf="">Active Data Hubs</span></font></strong><font><span leaf="">: è¿™æ˜¯ä¸€ä¸ªæ€»ç§°ï¼ŒæŒ‡çš„æ˜¯å½“å‰å¯ç”¨çš„æ•°æ®ä¸­å¿ƒæˆ–å¹³å°ã€‚</span></font></section></li><li><section><strong><font><span leaf="">My computer hub</span></font></strong><font><span leaf="">: è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°æ•°æ®ä¸­å¿ƒï¼Œé€šå¸¸ç”¨äºå­˜å‚¨å’Œç®¡ç†ç”¨æˆ·åœ¨è‡ªå·±è®¡ç®—æœºä¸Šçš„æ•°æ®ã€‚</span></font></section></li><li><section><strong><font><span leaf="">UCSC Public Hub</span></font></strong><font><span leaf="">: ç”±åŠ å·å¤§å­¦åœ£å…‹é²å…¹åˆ†æ ¡æä¾›çš„å…¬å…±æ•°æ®ä¸­å¿ƒï¼Œæä¾›å„ç§åŸºå› ç»„æ•°æ®é›†ã€‚</span></font></section></li><li><section><strong><font><span leaf="">TCGA Hub</span></font></strong><font><span leaf="">: ä»£è¡¨ç™Œç—‡åŸºå› ç»„å›¾è°±ï¼ˆThe Cancer Genome Atlasï¼‰é¡¹ç›®çš„æ•°æ®ï¼ŒåŒ…å«å¤§é‡ç™Œç—‡åŸºå› ç»„æ•°æ®ã€‚</span></font></section></li><li><section><strong><font><span leaf="">Pan-Cancer Atlas Hub</span></font></strong><font><span leaf="">: æä¾›è·¨å¤šç§ç™Œç—‡ç±»å‹çš„ç»¼åˆåŸºå› ç»„æ•°æ®åˆ†æã€‚</span></font></section></li><li><section><strong><font><span leaf="">ICGC Hub</span></font></strong><font><span leaf="">: å›½é™…ç™Œç—‡åŸºå› ç»„è”ç›Ÿï¼ˆInternational Cancer Genome Consortiumï¼‰çš„æ•°æ®ä¸­å¿ƒï¼Œæä¾›å…¨çƒèŒƒå›´å†…çš„ç™Œç—‡åŸºå› ç»„æ•°æ®ã€‚</span></font></section></li><li><section><strong><font><span leaf="">PCAWG Hub</span></font></strong><font><span leaf="">: æ³›ç™Œåˆ†æå·¥ä½œç»„ï¼ˆPan-Cancer Analysis of Whole Genomesï¼‰çš„æ•°æ®ä¸­å¿ƒï¼Œä¸“æ³¨äºå…¨åŸºå› ç»„çš„ç™Œç—‡åˆ†æã€‚</span></font></section></li><li><section><strong><font><span leaf="">UCSC Toil RNA-seq Recompute</span></font></strong><font><span leaf="">: æä¾›ä½¿ç”¨UCSC Toilå¹³å°é‡æ–°è®¡ç®—çš„RNA-seqæ•°æ®ã€‚</span></font></section></li><li><section><strong><font><span leaf="">Treehouse Hub</span></font></strong><font><span leaf="">: ä¸“æ³¨äºå„¿ç«¥ç™Œç—‡çš„åŸºå› ç»„æ•°æ®åˆ†æå¹³å°ã€‚</span></font></section></li><li><section><strong><font><span leaf="">GDC Hub</span></font></strong><font><span leaf="">: ç™Œç—‡åŸºå› ç»„æ•°æ®å…±äº«ä¸­å¿ƒï¼ˆGenomic Data Commonsï¼‰çš„æ•°æ®ä¸­å¿ƒï¼Œæä¾›ç™Œç—‡ç›¸å…³çš„åŸºå› ç»„æ•°æ®ã€‚</span></font></section></li><li><section><strong><font><span leaf="">ATAC-seq Hub</span></font></strong><font><span leaf="">: æä¾›ATAC-seqæ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºåˆ†ææŸ“è‰²è´¨å¯åŠæ€§çš„æŠ€æœ¯ã€‚</span></font></section></li><li><section><strong><font><span leaf="">Kids First Hub</span></font></strong><font><span leaf="">: ä¸“æ³¨äºå„¿ç«¥å¥åº·å’Œç–¾ç—…çš„åŸºå› ç»„æ•°æ®ä¸­å¿ƒã€‚</span></font></section></li><li><section><strong><font><span leaf="">Jupyter Notebook</span></font></strong><font><span leaf="">: ä¸€ç§äº¤äº’å¼è®¡ç®—ç¯å¢ƒï¼Œå¸¸ç”¨äºæ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€‚</span></font></section></li></ol><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¯”å¦‚æˆ‘æƒ³ä¸‹è½½ GTEX çš„æ•°æ®ï¼š</span></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgSHet9horGsFdsyqHo1Q5Jc73Ah6FsrmLSWa6LXfjp9VLd9Kpj0dsFw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.41388888888888886" data-type="png" data-w="1080" data-imgfileid="100051180" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgSHet9horGsFdsyqHo1Q5Jc73Ah6FsrmLSWa6LXfjp9VLd9Kpj0dsFw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¥ç€æˆ‘ä»¬çœ‹ TPM è¡¨è¾¾</span><code><span leaf=""><br></span></code></p><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgmoaL92GgIjmP22NCvwGLN7BBlOuyLmFia7z442WLw4AAv4codXOMsHw/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.38425925925925924" data-type="png" data-w="1080" data-imgfileid="100051179" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgmoaL92GgIjmP22NCvwGLN7BBlOuyLmFia7z442WLw4AAv4codXOMsHw/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æœ‰æ•°æ®çš„ä¸‹è½½é“¾æ¥å¯ä»¥è‡ªå·±ä¸‹è½½ã€‚ç›´æ¥åœ¨ç½‘é¡µä¸‹è½½ä¹Ÿå¾ˆæ–¹ä¾¿çš„ã€‚</span></p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">UCSCXenaTools åŸºæœ¬ä½¿ç”¨</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">UCSCXenaTools æ˜¯ä¸€ä¸ª R åŒ…ï¼Œå¯ä»¥åœ¨ R ä¸­ç›´æ¥ä¸‹è½½ UCSCXena æ•°æ®ã€‚ä¸»è¦ åŒ…å« generate ã€ filter ã€ query ã€ download å’Œ prepare äº”ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«ç”± XenaGenerate ã€ XenaFilter ã€ XenaQuery ã€ XenaDownload å’Œ XenaPrepare å‡½æ•°å®ç°ã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">æ¯”å¦‚ä¸‹è½½ GTEX æ•°æ®ï¼š</span></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(tidyverse) Â </span><span><span leaf=""># åŠ è½½ tidyverse åŒ…ï¼Œç”¨äºæ•°æ®å¤„ç†</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(UCSCXenaTools) Â </span><span><span leaf=""># åŠ è½½ UCSCXenaTools åŒ…ï¼Œç”¨äºè®¿é—® UCSC Xena æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">data(XenaData) Â </span><span><span leaf=""># åŠ è½½å†…ç½®çš„ XenaData æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">head(XenaData) Â </span><span><span leaf=""># æŸ¥çœ‹ XenaData æ•°æ®é›†çš„å‰å‡ è¡Œ</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">xe &lt;- XenaData %&gt;%</span><span leaf=""><br></span><span leaf="">Â  filter(XenaCohorts ==Â </span><span><span leaf="">"GTEX"</span></span><span leaf="">) Â </span><span><span leaf=""># ç­›é€‰å‡º GTEX é˜Ÿåˆ—çš„æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">cli &lt;- XenaGenerate(xe) %&gt;% Â </span><span><span leaf=""># ç”Ÿæˆ XenaHub å¯¹è±¡</span></span><span leaf=""><br></span><span leaf="">Â  XenaFilter(filterDatasets =Â </span><span><span leaf="">"GTEX_phenotype"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># è¿‡æ»¤å‡º GTEX è¡¨å‹æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">Â  XenaQuery() %&gt;% Â </span><span><span leaf=""># æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">Â  XenaDownload(destdir =Â </span><span><span leaf="">"./"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># ä¸‹è½½æ•°æ®åˆ°å½“å‰ç›®å½•</span></span><span leaf=""><br></span><span leaf="">Â  XenaPrepare() Â </span><span><span leaf=""># å‡†å¤‡ä¸‹è½½çš„æ•°æ®ä»¥ä¾¿åœ¨ R ä¸­ä½¿ç”¨</span></span><span leaf=""><br></span></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç”Ÿå­˜åˆ†æ</span></span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨"><span leaf="">ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªåŒ…ä¸‹è½½ TCGA è¡¨è¾¾æ•°æ®å’Œä¸´åºŠæ•°æ®ï¼Œç„¶åè¿›è¡Œç”Ÿå­˜åˆ†æã€‚</span></p><p data-tool="mdniceç¼–è¾‘å™¨"><font><span leaf="">æ¯”å¦‚ç”Ÿå­˜åˆ†æï¼Œå®˜æ–¹æä¾›äº†å®Œæ•´ä»£ç ï¼Œæˆ‘è¿™é‡Œåªåšä¸€äº›å®ç”¨ä¼˜åŒ–ã€‚</span></font><font><span leaf="">https://shixiangwang.github.io/home/en/post/ucscxenatools-201908/</span></font></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åŠ è½½åŒ…</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(tidyverse)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(UCSCXenaTools)</span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸‹è½½æ•°æ®</span></span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">data(XenaData) Â </span><span><span leaf=""># åŠ è½½ XenaData æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">head(XenaData) Â </span><span><span leaf=""># æ˜¾ç¤º XenaData æ•°æ®é›†çš„å‰å‡ è¡Œ</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">project &lt;-Â </span><span><span leaf="">"PAAD"</span></span><span leaf="">Â Â </span><span><span leaf=""># è®¾ç½®é¡¹ç›®å˜é‡ä¸º "PAAD ğŸŒŸğŸŒŸ</span></span><span leaf=""><br></span><span leaf="">cohort &lt;- XenaData %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  filter(XenaHostNames ==Â </span><span><span leaf="">"tcgaHub"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># è¿‡æ»¤å‡ºæ¥è‡ª TCGA Hub çš„æ•°æ®</span></span><span leaf=""><br></span><span leaf="">Â  XenaScan(project) Â </span><span><span leaf=""># æ‰«æå¹¶é€‰æ‹©ä¸é¡¹ç›® "PAAD" ç›¸å…³çš„é˜Ÿåˆ—</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸‹è½½ä¸´åºŠæ•°æ®é›†</span></span><span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">cli_query &lt;- cohort %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  filter(DataSubtype ==Â </span><span><span leaf="">"phenotype"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># é€‰æ‹©ä¸´åºŠæ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">Â  XenaGenerate() %&gt;% Â </span><span><span leaf=""># ç”Ÿæˆä¸€ä¸ª XenaHub å¯¹è±¡</span></span><span leaf=""><br></span><span leaf="">Â  XenaQuery() %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  XenaDownload() Â </span><span><span leaf=""># ä¸‹è½½æŸ¥è¯¢çš„æ•°æ®</span></span><span leaf=""><br></span><span leaf="">cli &lt;- XenaPrepare(cli_query) Â </span><span><span leaf=""># å‡†å¤‡ä¸‹è½½çš„æ•°æ®</span></span><span leaf=""><br></span><span leaf="">cli &lt;- cli$PAAD_survival.txt Â </span><span><span leaf=""># æå– PAAD ç”Ÿå­˜æ•°æ®é›†</span></span><span leaf=""><br></span><span leaf="">head(cli) Â </span><span><span leaf=""># æ˜¾ç¤ºç”Ÿå­˜æ•°æ®é›†çš„å‰å‡ è¡Œ</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ä¸‹è½½åŸºå› è¡¨è¾¾æ•°æ®</span></span><span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">SYMBOL &lt;-Â </span><span><span leaf="">"TP53"</span></span><span leaf="">Â Â </span><span><span leaf=""># è®¾ç½®åŸºå› ç¬¦å·ä¸º "TP53"</span></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">ge &lt;- cohort %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  filter(DataSubtype ==Â </span><span><span leaf="">"gene expression RNAseq"</span></span><span leaf="">,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â Label ==Â </span><span><span leaf="">"IlluminaHiSeq"</span></span><span leaf="">) Â </span><span><span leaf=""># é€‰æ‹©åŸºå› è¡¨è¾¾ RNAseq æ•°æ®é›†ï¼Œä½¿ç”¨ IlluminaHiSeq å¹³å°</span></span><span leaf=""><br></span><span leaf="">ge</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">gene &lt;- fetch_dense_values(host = ge$XenaHosts,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â dataset = ge$XenaDatasets,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â identifiers = SYMBOL,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â use_probeMap =Â </span><span><span leaf="">TRUE</span></span><span leaf="">) %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  .[</span><span><span leaf="">1</span></span><span leaf="">, ] Â </span><span><span leaf=""># è·å– TP53 åŸºå› çš„è¡¨è¾¾å€¼ï¼Œå¹¶æå–ç¬¬ä¸€è¡Œæ•°æ®</span></span><span leaf=""><br></span><span leaf="">head(gene) Â </span><span><span leaf=""># æ˜¾ç¤ºåŸºå› è¡¨è¾¾æ•°æ®çš„å‰å‡ è¡Œ</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">åˆå¹¶æ•°æ®ä¸ç”Ÿå­˜ä¿¡æ¯</span></span><span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">merged_data &lt;- tibble(sample = names(gene),Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gene_expression = as.numeric(gene)) %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  left_join(cli, by =Â </span><span><span leaf="">"sample"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># å°†åŸºå› è¡¨è¾¾æ•°æ®ä¸ä¸´åºŠæ•°æ®åˆå¹¶</span></span><span leaf=""><br></span><span leaf="">Â  filter(substr(sample,Â </span><span><span leaf="">14</span></span><span leaf="">,Â </span><span><span leaf="">15</span></span><span leaf="">) ==Â </span><span><span leaf="">"01"</span></span><span leaf="">) %&gt;% Â </span><span><span leaf=""># ä»…ä¿ç•™ 'Primary Tumor' æ ·æœ¬,ä¹Ÿå¯ä»¥éƒ½ä¿ç•™ï¼ˆç®—ç­›é€‰æ­¥éª¤å§ï¼‰</span></span><span leaf=""><br></span><span leaf="">Â  dplyr::select(sample, gene_expression, OS.time, OS) %&gt;% Â </span><span><span leaf=""># é€‰æ‹©ç›¸å…³åˆ—</span></span><span leaf=""><br></span><span leaf="">Â  rename(time = OS.time,Â </span><span leaf=""><br></span><span leaf="">Â  Â  Â  Â  Â status = OS) Â </span><span><span leaf=""># é‡å‘½åç”Ÿå­˜æ—¶é—´å’ŒçŠ¶æ€åˆ—</span></span><span leaf=""><br></span><span leaf="">head(merged_data) Â </span><span><span leaf=""># æ˜¾ç¤ºåˆå¹¶æ•°æ®çš„å‰å‡ è¡Œ</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç”Ÿå­˜åˆ†æ</span></span><span></span></h3><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">Coxæ¯”ä¾‹é£é™©æ¨¡å‹</span></span><span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">fit &lt;- coxph(Surv(time, status) ~ gene_expression, data = merged_data) Â </span><span><span leaf=""># ä½¿ç”¨ Cox æ¯”ä¾‹é£é™©æ¨¡å‹æ‹ŸåˆåŸºå› è¡¨è¾¾ä¸ç”Ÿå­˜æ•°æ®</span></span><span leaf=""><br></span><span leaf="">fit Â </span><span><span leaf=""># è¾“å‡ºæ¨¡å‹ç»“æœ</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span><span leaf="">ç”Ÿå­˜æ›²çº¿</span></span><span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span data-cacheurl="" data-remoteid=""></span><code><span leaf="">merged_data &lt;- merged_data %&gt;%Â </span><span leaf=""><br></span><span leaf="">Â  mutate(group = case_when(</span><span leaf=""><br></span><span leaf="">Â  Â  gene_expression &gt; quantile(gene_expression,Â </span><span><span leaf="">0.5</span></span><span leaf="">) ~ paste0(SYMBOL,Â </span><span><span leaf="">"_High"</span></span><span leaf="">), Â </span><span><span leaf=""># åŸºå› è¡¨è¾¾å€¼é«˜äºä¸­ä½æ•°çš„æ ·æœ¬åˆ†ä¸º "TP53_High" ç»„</span></span><span leaf=""><br></span><span leaf="">Â  Â  gene_expression &lt; quantile(gene_expression,Â </span><span><span leaf="">0.5</span></span><span leaf="">) ~ paste0(SYMBOL,Â </span><span><span leaf="">"_Low"</span></span><span leaf="">), Â Â </span><span><span leaf=""># åŸºå› è¡¨è¾¾å€¼ä½äºä¸­ä½æ•°çš„æ ·æœ¬åˆ†ä¸º "TP53_Low" ç»„</span></span><span leaf=""><br></span><span leaf="">Â  Â Â </span><span><span leaf="">TRUE</span></span><span leaf="">Â ~Â </span><span><span leaf="">NA_character_</span></span><span leaf=""><br></span><span leaf="">Â  ))</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">fit &lt;- survfit(Surv(time, status) ~ group, data = merged_data) Â </span><span><span leaf=""># ä½¿ç”¨ç”Ÿå­˜åˆ†ææ‹Ÿåˆåˆ†ç»„æ•°æ®</span></span><span leaf=""><br></span><span leaf="">ggsurvplot(fit, pval =Â </span><span><span leaf="">TRUE</span></span><span leaf="">) Â </span><span><span leaf=""># ç»˜åˆ¶ç”Ÿå­˜æ›²çº¿å¹¶æ˜¾ç¤º p å€¼</span></span><span leaf=""><br></span></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgOlwupbV0VgL2Yy30LiaAWTG632SlQAIZI1qRGUaVKvpyFWb1m1kKF7A/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6759259259259259" data-type="png" data-w="1080" data-imgfileid="100051178" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2LosicmPUnrJQOj4vCzBBHaZiaibgOlwupbV0VgL2Yy30LiaAWTG632SlQAIZI1qRGUaVKvpyFWb1m1kKF7A/640?wx_fmt=png&amp;from=appmsg"></span></figure></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/TbCSJB5rgy2MUbSznOg_QA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
