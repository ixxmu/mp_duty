---
title: "SCI 复现 | 分组散点矩阵+相关性网络图"
date: 2025-06-08T14:30:58Z
draft: ["false"]
tags: [
  "fetched",
  "MsTt笔记"
]
categories: ["Acdemic"]
---
SCI 复现 | 分组散点矩阵+相关性网络图 by MsTt笔记
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="MsTt笔记" data-from="1" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKJLwvM2QW48QKCicY8yHrEfwZA1qzJqmnSDuICrXOZEk6YYntc7QSLbdwg12uibFOEziaEVEXhEJQ4vQ/0?wx_fmt=png" data-signature="1:1复现顶刊绘图" data-id="MzkxNDcwNzY2NQ==" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><p data-tool="mdnice编辑器" data-pm-slice="0 0 []"><span leaf="">请尊重原创劳动成果🙏</span></p><p><span><span leaf="">未经允许，不得转载，不可抄袭！</span></span></p><p data-tool="mdnice编辑器"><span leaf="">今天来复现 </span><strong><span leaf="">New Phytologist</span></strong><span leaf=""> 文章中 (Shengnan Pan et al. Leaf stomatal configuration and photosynthetic traits jointly affect leaf water use efficiency in forests along climate gradients. New Phytologist (2024). https://doi.org/10.1111/nph.20100) 的 Fig.3</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">原图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100001352" data-ratio="0.6628748707342296" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jy5xghOIIIP7rWsZ0E8pwYs9IkZxCEwuRefmnwINRcwQXFYKxHmQ7vA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="967" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jy5xghOIIIP7rWsZ0E8pwYs9IkZxCEwuRefmnwINRcwQXFYKxHmQ7vA/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf="">分组散点矩阵图（右上）：</span></p><ul><li><section><span leaf="">用于展示5个叶片特性之间的成对比较</span></section></li><li><section><span leaf="">颜色代表不同的森林生态系统</span></section></li><li><section><span leaf="">形状表示叶片习性（落叶或常绿）</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf="">相关性网络图（左下）：</span></p><ul><li><section><span leaf="">显示了5个叶片特性与3个生理指标之间的相关性</span></section></li><li><section><span leaf="">实线表示显著相关，虚线表示不显著相关</span></section></li><li><section><span leaf="">蓝色线条代表正相关，红色线条代表负相关</span></section></li></ul><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">二者结合：</span>散点矩阵侧重变量间的分布模式，网络图突出统计关系，两者结合同时提供数据分布模式和统计结论。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span></h2><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100001353" data-ratio="0.6780383795309168" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jLKIUU9tiaFKeyeNxwuDqSaZ59QEVfPL1nnRGWxYdAYqxLEqHTmFOhfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="938" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jLKIUU9tiaFKeyeNxwuDqSaZ59QEVfPL1nnRGWxYdAYqxLEqHTmFOhfg/640?wx_fmt=png&amp;from=appmsg"></span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">更多变量相关性分析，可参考：</span></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247484694&amp;idx=1&amp;sn=d7c882daf03fde0f773f62fcfc8aa12b&amp;scene=21#wechat_redirect" textvalue="SCI 复现 | 相关性矩阵图(相关系数+散点图+对角直方图)" data-itemshowtype="0" linktype="text" data-linktype="2">SCI 复现 | 相关性矩阵图(相关系数+散点图+对角直方图)</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247484489&amp;idx=1&amp;sn=acb7e4629d8f3cc3ab06322e1b0c13dc&amp;scene=21#wechat_redirect" textvalue="顶刊复现 | 一维/二维/多维变量间的相关性热图" data-itemshowtype="0" linktype="text" data-linktype="2">顶刊复现 | 一维/二维/多维变量间的相关性热图</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247483799&amp;idx=1&amp;sn=8b2059d3ed7463af1d6ea2c619f4169d&amp;scene=21#wechat_redirect" textvalue="Nature 复现 | 被导师夸的相关性热图" data-itemshowtype="0" linktype="text" data-linktype="2">Nature 复现 | 被导师夸的相关性热图</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247483962&amp;idx=1&amp;sn=0926c7fac7319a671e276733af64cd35&amp;scene=21#wechat_redirect" textvalue="Nature 复现 | 被导师夸的变量之间的关系图" data-itemshowtype="0" linktype="text" data-linktype="2">Nature 复现 | 被导师夸的变量之间的关系图</a>（R版）</span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzkxNDcwNzY2NQ==&amp;mid=2247484054&amp;idx=1&amp;sn=b556cf7ecb622b6007a9112cc2f05013&amp;scene=21#wechat_redirect" textvalue="Nature 复现| 如何全方位呈现两个变量之间的关系" data-itemshowtype="0" linktype="text" data-linktype="2">Nature 复现| 如何全方位呈现两个变量之间的关系</a>（Python版）</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">加载包，读入数据</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 加载必要的包</span></span></code><code><span leaf=""><span>library</span>(tidyverse)</span></code><code><span leaf=""><span>library</span>(readxl)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 读入数据</span></span></code><code><span leaf=""><span>data</span> &lt;- read_xlsx(<span>"data.xlsx"</span>)</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span># 定义颜色和形状</span></span></code><code><span leaf=""><span>my_color</span> &lt;- c(<span>"#2d7977"</span>, <span>"#95dddc"</span>, <span>"#f4a98c"</span>, <span>"#cd0000"</span>)</span></code><code><span leaf=""><span>my_shape</span> &lt;- c(<span>19</span>, <span>17</span>)   # 实心圆形(<span>19</span>)和实心三角形(<span>17</span>)</span></code></pre></section><p data-tool="mdnice编辑器"><span leaf="">读入数据，定义好散点图的颜色和形状。</span></p><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">此绘图数据为模拟数据，无实际意义，如需文末可以自助获取。</span></span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">分组散点矩阵图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span># 生成分组散点图矩阵图</span></span></code><code><span leaf=""><span>p_matrix</span> &lt;- ggpairs(data = data, columns = <span>2</span>:<span>6</span>,   # 选择需要画散点分布图的变量</span></code><code><span leaf="">                    <span>lower</span> = list(continuous = wrap(custom_point)), </span></code><code><span leaf="">                    <span>diag</span> = list(continuous = wrap(custom_diagAxis, labelSize = <span>3</span>)),</span></code><code><span leaf="">                    <span>upper</span> = list(continuous = <span>"blank"</span>)) +</span></code><code><span leaf="">  <span>theme_test</span>() +</span></code><code><span leaf="">  <span>theme</span>(strip.text = element_blank(),</span></code><code><span leaf="">        <span>axis</span>.text = element_text(size = <span>10</span>, color = <span>"black"</span>))</span></code><code><span leaf=""><br></span></code><code><span leaf=""><span>p_matrix</span></span></code></pre></section><ul><li><section><span leaf="">自定义</span><code><span leaf="">custom_point()</span></code><span leaf="">函数用于绘制分组散点图+回归线</span></section></li><li><section><span leaf="">自定义</span><code><span leaf="">custom_diagAxis()</span></code><span leaf="">函数用于绘制矩阵图对角线，只显示变量名</span></section></li><li><section><span leaf="">使用</span><code><span leaf="">ggpairs()</span></code><span leaf="">函数创建矩阵：</span></section></li><ul><li><section><code><span leaf="">columns=2:6</span></code><span leaf="">：使用数据框的第2到6列</span></section></li><li><section><code><span leaf="">lower/diag/upper</span></code><span leaf="">分别控制矩阵的下三角、对角线和上三角</span></section></li><li><section><code><span leaf="">wrap()</span></code><span leaf="">函数用于将自定义函数适配到GGally框架</span></section></li></ul></ul><section><span leaf=""><br></span></section><section nodeleaf=""><img data-imgfileid="100001354" data-ratio="0.9166666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jRAT9n0KYXhVvia1rn0MhgSAXczxSAibEnDXMicgAQLEn6HD3km8CJOelg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jRAT9n0KYXhVvia1rn0MhgSAXczxSAibEnDXMicgAQLEn6HD3km8CJOelg/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">相关性网络图</span></span></h2><section><ul><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span leaf=""><span>p_corr</span> &lt;- qcorrplot(rcorr(as.matrix(data[, <span>2</span>:<span>6</span>])), type = <span>"lower"</span>) +</span></code><code><span leaf="">  <span>geom_couple</span>(data = results, aes(linetype = p_value, color = r_value, size = abs(r)),  </span></code><code><span leaf="">              <span>node</span>.shape = <span>21</span>, node.size = <span>2</span>, node.colour = <span>"grey30"</span>, node.fill = <span>"grey"</span>,</span></code><code><span leaf="">              <span>curvature</span> = <span>0</span>.<span>1</span>) +</span></code><code><span leaf="">  <span>scale_size_continuous</span>(range = c(<span>0</span>.<span>3</span>, <span>1</span>), guide = <span>"none"</span>)+ </span></code><code><span leaf="">  <span>scale_colour_manual</span>(values=c(<span>"#fe0108"</span>,<span>"#2e4fdb"</span>)) +</span></code><code><span leaf="">  <span>guides</span>(color = guide_legend(title = expression(<span>"Pearson's"</span> ~ italic(<span>"r"</span>)),</span></code><code><span leaf="">                             <span>order</span> = <span>1</span>),</span></code><code><span leaf="">         <span>linetype</span> = guide_legend(title = expression(italic(<span>"P"</span>)~<span>"value"</span>), </span></code><code><span leaf="">                               <span>order</span> = <span>2</span>))</span></code><code><span leaf=""><span>p_corr</span></span></code></pre></section><ul><li><section><span leaf="">计算所有性状-变量组合的相关性</span></section></li><li><section><span leaf="">使用</span><code><span leaf="">qcorrplot()</span></code><span leaf="">创建基础相关性热图</span></section></li><li><section><span leaf="">使用</span><code><span leaf="">geom_couple()</span></code><span leaf="">添加变量间的连接线</span></section></li></ul><section><span leaf=""><br></span></section><section nodeleaf=""><img data-imgfileid="100001355" data-ratio="0.4852240228789323" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jxKp5nZ0aKKdDscS94ykTKEeq27HZJaPicZaQ3tsgsgpViad95VW0wMdA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1049" type="block" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jxKp5nZ0aKKdDscS94ykTKEeq27HZJaPicZaQ3tsgsgpViad95VW0wMdA/640?wx_fmt=png&amp;from=appmsg"></section><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">组合图形</span></span></h2><p data-tool="mdnice编辑器"><span leaf="">使用AI工具，将散点矩阵和相关性网络图组合在一起（</span><span leaf="">模拟数据，无实际意义，趋势与原图不同</span><span leaf="">）。</span></p><p data-tool="mdnice编辑器"><span leaf=""><img data-imgfileid="100001356" data-ratio="0.6780383795309168" data-src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jLKIUU9tiaFKeyeNxwuDqSaZ59QEVfPL1nnRGWxYdAYqxLEqHTmFOhfg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="938" src="https://mmbiz.qpic.cn/mmbiz_png/mEOTibibBIwKIicTutWic04KshJBCLFKVr3jLKIUU9tiaFKeyeNxwuDqSaZ59QEVfPL1nnRGWxYdAYqxLEqHTmFOhfg/640?wx_fmt=png&amp;from=appmsg"></span></p><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf=""><span textstyle="">获取以 RProject 形式保存的</span></span><strong><span leaf=""><span textstyle="">绘图代码+注释+数据模板</span></span></strong><span leaf=""><span textstyle="">，后台回复关键词: </span></span><strong><em><span leaf=""><span textstyle="">250608_corr-link_ggpair</span></span></em></strong></p></section><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="adfc64b1-bfd1-4712-8aa0-57704552a76b" data-pid="101_14835066"></mp-common-cpsad></section><p data-tool="mdnice编辑器"><span leaf=""><br></span></p><section nodeleaf=""><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-cpsversion="v120" data-goodssouce="1" data-traceid="932d1890-3e69-419d-b614-be6535050c89" data-pid="101_14324026"></mp-common-cpsad></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/BeBVV6H8gq7uJDB-r3h6xQ",target="_blank" rel="noopener noreferrer">原文链接</a>
