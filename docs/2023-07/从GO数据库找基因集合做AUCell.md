---
title: "ä»GOæ•°æ®åº“æ‰¾åŸºå› é›†åˆåšAUCell"
date: 2023-07-05T14:00:53Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ˜Ÿçƒ"
]
categories: ["Acdemic"]
---
ä»GOæ•°æ®åº“æ‰¾åŸºå› é›†åˆåšAUCell by ç”Ÿä¿¡æ˜Ÿçƒ
------
<div><p data-mpa-powered-by="yiban.io"><span>â€</span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span>Â ä»Šå¤©æ˜¯ç”Ÿä¿¡æ˜Ÿçƒé™ªä½ çš„<span><strong>ç¬¬916å¤©</strong></span></span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></p><hr><section><span><span>Â  Â </span><span>å¤§ç¥ä¸€å¥è¯ï¼Œèœé¸Ÿè·‘åŠå¹´ã€‚æˆ‘ä¸æ˜¯å¤§ç¥ï¼Œä½†æˆ‘å¯ä»¥ç¼©çŸ­ä½ èµ°å¼¯è·¯çš„åŠå¹´~</span></span></section><section><span>Â  Â å°±åƒæ­Œå„¿å”±çš„é‚£æ ·ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¯¥å¾€å“ªå„¿èµ°ï¼Œå°±ç•™åœ¨è¿™å­¦ç‚¹ç”Ÿä¿¡å¥½ä¸å¥½~</span></section><section><span>Â  Â è¿™é‡Œæœ‰è±†è±†å’ŒèŠ±èŠ±çš„å­¦ä¹ å†ç¨‹ï¼Œä»æ–°æ‰‹åˆ°è¿›é˜¶ï¼Œç”Ÿä¿¡è·¯ä¸Šæœ‰ä½ æœ‰æˆ‘ï¼</span></section><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>1.æå–æŒ‡å®šGOtermçš„åŸºå› </span><span><span> </span></span></h4><blockquote data-tool="mdniceç¼–è¾‘å™¨"><p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7606976/</p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨è¿™ç¯‡æ–‡ç« é‡Œæåˆ°ï¼ŒReactive oxygen species (ROS) æ´»æ€§æ°§ç›¸å…³çš„17ä¸ªGOæ¡ç›®,å¯ä»¥æŠŠè¿™äº›åŸºå› æå–å‡ºæ¥ã€‚ä½¿ç”¨msigdbråŒ…æå®šã€‚Data_Sheet_2.XLSXæ˜¯æ–‡ç« çš„é™„ä»¶</p><blockquote data-tool="mdniceç¼–è¾‘å™¨"><p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7606976/bin/Data_Sheet_2.XLSX</p></blockquote><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>rm(listÂ =Â ls())<br>library(tidyverse)<br>datÂ =Â rio::import(<span>"Data_Sheet_2.XLSX"</span>)<br>gÂ =Â dat[-1,1]<br>g<br><br><span>##Â Â [1]Â "GO_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â [2]Â "GO_REACTIVE_OXYGEN_SPECIES_METABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â [3]Â "GO_POSITIVE_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"</span><br><span>##Â Â [4]Â "GO_NEGATIVE_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"</span><br><span>##Â Â [5]Â "GO_NEGATIVE_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_METABOLIC_PROCESS"Â Â Â </span><br><span>##Â Â [6]Â "GO_POSITIVE_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_METABOLIC_PROCESS"Â Â Â </span><br><span>##Â Â [7]Â "GO_MITOCHONDRIAL_ELECTRON_TRANSPORT_CYTOCHROME_C_TO_OXYGEN"Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â [8]Â "GO_SUPEROXIDE_GENERATING_NADPH_OXIDASE_ACTIVITY"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â [9]Â "GO_HYDROGEN_PEROXIDE_METABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [10]Â "GO_HYDROGEN_PEROXIDE_CATABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [11]Â "GO_PENTOSE_METABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [12]Â "GO_RESPONSE_TO_REACTIVE_OXYGEN_SPECIES"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [13]Â "GO_REGULATION_OF_RESPONSE_TO_REACTIVE_OXYGEN_SPECIES"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [14]Â "GO_CELLULAR_RESPONSE_TO_REACTIVE_OXYGEN_SPECIES"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [15]Â "GO_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"Â Â Â Â Â Â Â Â Â </span><br><span>##Â [16]Â "GO_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_METABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [17]Â "GO_NEGATIVE_REGULATION_OF_RESPONSE_TO_REACTIVE_OXYGEN_SPECIES"</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">17æ¡termğŸ‘†</p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>2.ä»msigdbræŸ¥æ‰¾è¿™äº›term</span><span><span> </span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(msigdbr)<br>GO_dfÂ =Â msigdbr(speciesÂ =Â <span>"HomoÂ sapiens"</span>,categoryÂ =Â <span>"C5"</span>)Â %&gt;%Â <br>Â Â dplyr::select(gene_symbol,gs_name,gs_subcat)<br><br>dim(GO_df)<br><br><span>##Â [1]Â 1424471Â Â Â Â Â Â Â 3</span><br><br>table(GO_df<span>$gs_subcat</span>)<br><br><span>##Â </span><br><span>##Â Â GO:BPÂ Â GO:CCÂ Â GO:MFÂ Â Â Â HPOÂ </span><br><span>##Â 721379Â 115769Â 122674Â 464649</span><br><br>GO_dfÂ =Â GO_df[GO_df<span>$gs_subcat</span>!=<span>"HPO"</span>,]<br><br>table(gÂ %<span>in</span>%Â GO_df<span>$gs_name</span>)<br><br><span>##Â </span><br><span>##Â FALSEÂ </span><br><span>##Â Â Â Â 17</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">å…¨éƒ¨åŒ¹é…å¤±è´¥å•¦ï¼Ÿ</p><p data-tool="mdniceç¼–è¾‘å™¨">å…¶å®æ˜¯å› ä¸ºå‰ç¼€ä¸åŒ</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>head(GO_df<span>$gs_name</span>,3)<br><br><span>##Â [1]Â "GOBP_10_FORMYLTETRAHYDROFOLATE_METABOLIC_PROCESS"</span><br><span>##Â [2]Â "GOBP_10_FORMYLTETRAHYDROFOLATE_METABOLIC_PROCESS"</span><br><span>##Â [3]Â "GOBP_10_FORMYLTETRAHYDROFOLATE_METABOLIC_PROCESS"</span><br><br>head(g,3)<br><br><span>##Â [1]Â "GO_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [2]Â "GO_REACTIVE_OXYGEN_SPECIES_METABOLIC_PROCESS"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [3]Â "GO_POSITIVE_REGULATION_OF_REACTIVE_OXYGEN_SPECIES_BIOSYNTHETIC_PROCESS"</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æŠŠå‰ç¼€å»æ‰æ¥åŒ¹é…ï¼Œé¡ºä¾¿æŠŠå¤§å†™å˜æˆå°å†™ï¼Œå˜å¾—æ˜“è¯»ä¸€ç‚¹ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>snÂ =Â GO_df<span>$gs_name</span>Â %&gt;%<br>Â Â str_to_lower()%&gt;%<br>Â Â str_replace(<span>"_"</span>,<span>"///"</span>)Â %&gt;%<br>Â Â str_split(<span>"///"</span>,simplifyÂ =Â T)%&gt;%<br>Â Â .[,2]Â %&gt;%<br>Â Â str_replace_all(<span>"_"</span>,<span>"Â "</span>)<br>head(sn)<br><br><span>##Â [1]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><span>##Â [2]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><span>##Â [3]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><span>##Â [4]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><span>##Â [5]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><span>##Â [6]Â "10Â formyltetrahydrofolateÂ metabolicÂ process"</span><br><br>GO_dfÂ =Â mutate(GO_df,short_nameÂ =Â sn)<br><br>gÂ =Â str_to_lower(g)%&gt;%<br>Â Â str_replace(<span>"_"</span>,<span>"///"</span>)Â %&gt;%<br>Â Â str_split(<span>"///"</span>,simplifyÂ =Â T)%&gt;%<br>Â Â .[,2]Â %&gt;%<br>Â Â str_replace_all(<span>"_"</span>,<span>"Â "</span>)<br>head(g)<br><br><span>##Â [1]Â "reactiveÂ oxygenÂ speciesÂ biosyntheticÂ process"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [2]Â "reactiveÂ oxygenÂ speciesÂ metabolicÂ process"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â [3]Â "positiveÂ regulationÂ ofÂ reactiveÂ oxygenÂ speciesÂ biosyntheticÂ process"</span><br><span>##Â [4]Â "negativeÂ regulationÂ ofÂ reactiveÂ oxygenÂ speciesÂ biosyntheticÂ process"</span><br><span>##Â [5]Â "negativeÂ regulationÂ ofÂ reactiveÂ oxygenÂ speciesÂ metabolicÂ process"Â Â Â </span><br><span>##Â [6]Â "positiveÂ regulationÂ ofÂ reactiveÂ oxygenÂ speciesÂ metabolicÂ process"</span><br><br>table(gÂ %<span>in</span>%Â GO_df<span>$short_name</span>)<br><br><span>##Â </span><br><span>##Â FALSEÂ Â TRUEÂ </span><br><span>##Â Â Â Â Â 1Â Â Â Â 16</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»è¿‡æ•°æ®æ¡†æœç´¢ï¼Œå‘ç°åŒ¹é…ä¸ä¸Šçš„é‚£ä¸ªå…¶å®æ˜¯å› ä¸ºå°‘äº†ä¿©ç©ºæ ¼ã€‚ã€‚ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æ‰€ä»¥ç›´æ¥æ”¹ä¸€ä¸‹å°±å¥½ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">â€œsuperoxide generating nadph oxidase activityâ€</p><p data-tool="mdniceç¼–è¾‘å™¨">â€œsuperoxide generating nad p h oxidase activityâ€</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>g[!(gÂ %<span>in</span>%Â GO_df<span>$short_name</span>)]Â =Â <span>"superoxideÂ generatingÂ nadÂ pÂ hÂ oxidaseÂ activity"</span><br>table(gÂ %<span>in</span>%Â GO_df<span>$short_name</span>)<br><br><span>##Â </span><br><span>##Â TRUEÂ </span><br><span>##Â Â Â 17</span><br><br>rosgeneÂ =Â GO_dfÂ %&gt;%<br>Â Â filter(short_nameÂ %<span>in</span>%Â g)Â %&gt;%<br>Â Â pull(gene_symbol)Â %&gt;%<br>Â Â unique()<br>length(rosgene)<br><br><span>##Â [1]Â 402</span><br></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>2.AUCell</span><span><span> </span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9897923/ç”¨è¿™ä¸ªæ–‡ç« é‡Œçš„æ–¹æ³•ï¼Œå°†å•ç»†èƒäºšç¾¤çš„markeråŸºå› ä¸rosç›¸å…³åŸºå› å–äº¤é›†ï¼Œç”¨ä½œAUCellçš„åŸºå› é›†</p><blockquote data-tool="mdniceç¼–è¾‘å™¨"><p>The intersection of marker genes was selected based on strong population specificity (adj_p &lt; 0.05 &amp; |avg_log2FoldChange| &gt; 1.5 &amp; pct.1 &gt; 0.5 &amp; pct.2 &lt; 0.5) from each cell subgroup and factors related to OS responses.</p></blockquote><p data-tool="mdniceç¼–è¾‘å™¨">sce.allæ˜¯seurat+singleRå¾—å‡ºçš„å¯¹è±¡ï¼Œmarkersæ˜¯findallmarkerså¾—åˆ°çš„æ•°æ®æ¡†ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>load(<span>"sce.all.Rdata"</span>)<br>load(<span>"makers.Rdata"</span>)<br>kÂ =Â markers<span>$p_val_adj</span>Â &lt;Â 0.05Â &amp;Â <br>Â Â abs(markers<span>$avg_log2FC</span>)Â &gt;Â 1.5Â &amp;Â <br>Â Â markers<span>$pct</span>.1Â &gt;Â 0.5Â &amp;Â <br>Â Â markers<span>$pct</span>.2Â &lt;Â 0.5<br>table(k)<br><br><span>##Â k</span><br><span>##Â FALSEÂ Â TRUEÂ </span><br><span>##Â 13100Â Â 1483</span><br><br>giÂ =Â intersect(markers[k,<span>"gene"</span>],rosgene)Â <br>giÂ =Â factor(gi,levelsÂ =Â gi)<br>library(Seurat)<br>DotPlot(sce.all,featuresÂ =Â gi,colsÂ =Â <span>"RdYlBu"</span>,<br>Â Â Â Â Â Â Â Â group.byÂ =Â <span>"RNA_snn_res.0.5"</span>)+RotatedAxis()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVobYtBfaghPQjZ8QDZGpIQs0ae4LJuq2Kp6Ljr6GN283qwM74ibL7cwiaA/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVobYtBfaghPQjZ8QDZGpIQs0ae4LJuq2Kp6Ljr6GN283qwM74ibL7cwiaA/640?wx_fmt=jpeg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">AUCellç”¨äºè®¡ç®—æ¯ä¸ªç»†èƒä¸­ç‰¹å®šåŸºå› é›†çš„æ´»æ€§ç¨‹åº¦ã€‚ç”¨ä¸Šé¢çš„giä½œä¸ºåŸºå› é›†æ¥è®¡ç®—ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">AUCellçš„ä¸‰ä¸ªæ­¥éª¤:</p><p data-tool="mdniceç¼–è¾‘å™¨">Build the rankingsï¼šçŸ©é˜µä¸­çš„æ¯ä¸ªç»†èƒé‡Œï¼Œç»™åŸºå› è¿›è¡Œæ’åº</p><p data-tool="mdniceç¼–è¾‘å™¨">Calculate the Area Under the Curve (AUC)ï¼šè®¡ç®—æ¯ä¸ªç»†èƒçš„AUCå€¼</p><p data-tool="mdniceç¼–è¾‘å™¨">Set the assignment thresholdsï¼šè®¡ç®—æ´»æ€§åŒºåˆ†çš„é˜ˆå€¼</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(GSEABase)<br>geneSetsÂ &lt;-Â GeneSet(as.character(gi),Â setName=<span>"ROS"</span>)<br>geneSets<br><br><span>##Â setName:Â ROSÂ </span><br><span>##Â geneIds:Â ACP5,Â SOD3,Â ...,Â PMAIP1Â (total:Â 32)</span><br><span>##Â geneIdType:Â Null</span><br><span>##Â collectionType:Â NullÂ </span><br><span>##Â details:Â useÂ 'details(object)'</span><br><br>library(AUCell)<br>exprMatrixÂ =Â sce.all@assays<span>$RNA</span>@data<br>cells_rankingsÂ &lt;-Â AUCell_buildRankings(exprMatrix)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoCSc9mlcEsvAiaSkPAFRdsNVPGffVuRZsqs6PqOeA2kaH14ohyppTL2w/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoCSc9mlcEsvAiaSkPAFRdsNVPGffVuRZsqs6PqOeA2kaH14ohyppTL2w/640?wx_fmt=jpeg"></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code><span>##Â Â minÂ Â Â 1%Â Â Â 5%Â Â 10%Â Â 50%Â 100%Â </span><br><span>##Â Â 474Â Â 716Â Â 794Â Â 859Â 1409Â 5996</span><br><br>cells_AUCÂ &lt;-Â AUCell_calcAUC(geneSets,Â cells_rankings)<br>set.seed(333)<br>cells_assignmentÂ &lt;-Â AUCell_exploreThresholds(cells_AUC,Â plotHist=TRUE,Â assign=TRUE)Â <br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVohOTQPZicAqNyCkYEGENH884D82Sp8bUia9ndyS2uYEcCiaiaafAuZPMBWg/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVohOTQPZicAqNyCkYEGENH884D82Sp8bUia9ndyS2uYEcCiaiaafAuZPMBWg/640?wx_fmt=jpeg"></figure><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>auc_thrÂ =Â cells_assignment<span>$ROS</span><span>$aucThr</span><span>$selected</span><br>auc_thr<br><br><span>##Â Â Â Â Â Â Â L_k2Â </span><br><span>##Â 0.07917315</span><br></code></pre><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>3.FeaturePlotå¯è§†åŒ–</span><span><span> </span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨">æ ‡å‡†ç‰ˆï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(Seurat)<br>aÂ =Â as.numeric(getAUC(cells_AUC))<br>sce.all<span>$auc_score</span>Â =Â a<br>FeaturePlot(sce.all,featuresÂ =Â <span>"auc_score"</span>)Â <br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoxibqCZY3EHgFULl7lpCv2HKx6ZDDfxxN8ic1I3SqeftJuYk75GQh4K1A/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoxibqCZY3EHgFULl7lpCv2HKx6ZDDfxxN8ic1I3SqeftJuYk75GQh4K1A/640?wx_fmt=jpeg"></figure><p data-tool="mdniceç¼–è¾‘å™¨">å®šåˆ¶ç‰ˆï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>dat&lt;-Â data.frame(sce.all@meta.data,Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sce.all@reductions<span>$umap</span>@cell.embeddings,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sce.all@active.ident)<br>colnames(dat)[ncol(dat)]Â =Â <span>"seurat_annotation"</span><br>class_avgÂ &lt;-Â datÂ %&gt;%<br>Â Â group_by(seurat_annotation)Â %&gt;%<br>Â Â summarise(<br>Â Â Â Â UMAP_1Â =Â median(UMAP_1),<br>Â Â Â Â UMAP_2Â =Â median(UMAP_2)<br>Â Â )<br><br>library(ggpubr)<br>ggplot(dat,Â aes(UMAP_1,Â UMAP_2))Â Â +<br>Â Â geom_point(aes(colourÂ Â =Â auc_score))Â +Â viridis::scale_color_viridis(option=<span>"A"</span>)Â +<br>Â Â ggrepel::geom_label_repel(aes(labelÂ =Â seurat_annotation),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â dataÂ =Â class_avg,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â label.sizeÂ =Â 0,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â segment.colorÂ =Â NA)+<br>Â Â theme(legend.positionÂ =Â <span>"none"</span>)Â +Â theme_bw()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVo31FkpyFFs308j2YcgiaAoALeiaoAVUrG77wIthnrLda4pqgC8ZPsYyRg/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVo31FkpyFFs308j2YcgiaAoALeiaoAVUrG77wIthnrLda4pqgC8ZPsYyRg/640?wx_fmt=jpeg"></figure><p>https://www.jianshu.com/p/2fb20f44da67</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>dat<span>$auc_group</span>Â =Â ifelse(dat<span>$auc_score</span>&gt;auc_thr,<span>"active"</span>,<span>"non_active"</span>)</code></pre><hr><h4 data-tool="mdniceç¼–è¾‘å™¨"><span>4.æ´»è·ƒå’Œä¸æ´»è·ƒç»„çš„ç»†èƒæ¯”ä¾‹æ¡å½¢å›¾</span><span><span> </span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>ggplot(dat,aes(auc_group,fillÂ =Â seurat_annotation))+<br>Â Â geom_bar(positionÂ =Â <span>"fill"</span>,Â alphaÂ =Â 0.9)+<br>Â Â scale_fill_brewer(paletteÂ =Â <span>"Set1"</span>)+<br>Â Â theme_classic()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoVanmcEowzycc7nFJ2TGibsPeDx20Xp07sCibr95045jx6RMjomol8nYg/640?wx_fmt=jpeg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHomrTsZSemUEfJ373JnKJVoVanmcEowzycc7nFJ2TGibsPeDx20Xp07sCibr95045jx6RMjomol8nYg/640?wx_fmt=jpeg"><span></span></figure></section><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><figure data-tool="mdniceç¼–è¾‘å™¨"></figure></section><section><blockquote><section><span>å¦‚æœå› ä¸ºä»£ç çœ‹ä¸æ‡‚ï¼Œè€Œè·Ÿä¸ä¸Šæ­£æ–‡çš„èŠ‚å¥ï¼Œå¯ä»¥æ¥æ‰¾æˆ‘ï¼Œç³»ç»Ÿå­¦ä¹ ã€‚æˆ‘çš„</span><span>è¯¾ç¨‹éƒ½æ˜¯å¾ªç¯å¼€è¯¾ã€‚</span><span>ä¸‹ä¸€æœŸçš„æ—¶é—´ï¼Œç‚¹è¿›å»å’¨è¯¢å¾®ä¿¡å’¯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247493194&amp;idx=1&amp;sn=5ddfe9dc5c0096c64364fbcd824fa4e6&amp;chksm=fdfbae08ca8c271eb1808717502255c15754e35832f04d374cf7e6bd25783407fa1f80a35fc1&amp;scene=21#wechat_redirect" textvalue="æ–°çš„ä¸€å¹´ï¼Œä½ è¦ä¸è¦æ¥æ‰¾æˆ‘ä»¬å­¦ä¹ â€ç”Ÿä¿¡" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">æ–°çš„ä¸€å¹´ï¼Œä½ è¦ä¸è¦æ¥æ‰¾æˆ‘<span>â€</span>ä»¬å­¦ä¹ ç”Ÿä¿¡</a><br></section></blockquote></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/s2hDgR3X78OWqAnsfy6kDQ",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
