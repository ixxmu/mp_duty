---
title: "æŠŠæ˜¾è‘—æ€§æ·»åŠ ç»™ç©æ˜ç™½"
date: 2023-08-25T08:55:13Z
draft: ["false"]
tags: [
  "fetched",
  "ç”Ÿä¿¡æ˜Ÿçƒ"
]
categories: ["Acdemic"]
---
æŠŠæ˜¾è‘—æ€§æ·»åŠ ç»™ç©æ˜ç™½ by ç”Ÿä¿¡æ˜Ÿçƒ
------
<div><section data-mpa-powered-by="yiban.io"><span>â€</span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span>Â ä»Šå¤©æ˜¯ç”Ÿä¿¡æ˜Ÿçƒé™ªä½ çš„<span><strong>ç¬¬925å¤©</strong></span></span><img data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></section><hr><section><span><span>Â  Â </span><span>å¤§ç¥ä¸€å¥è¯ï¼Œèœé¸Ÿè·‘åŠå¹´ã€‚æˆ‘ä¸æ˜¯å¤§ç¥ï¼Œä½†æˆ‘å¯ä»¥ç¼©çŸ­ä½ èµ°å¼¯è·¯çš„åŠå¹´~</span></span></section><section><span>Â  Â å°±åƒæ­Œå„¿å”±çš„é‚£æ ·ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¯¥å¾€å“ªå„¿èµ°ï¼Œå°±ç•™åœ¨è¿™å­¦ç‚¹ç”Ÿä¿¡å¥½ä¸å¥½~</span></section><p><span>Â  Â è¿™é‡Œæœ‰è±†è±†å’ŒèŠ±èŠ±çš„å­¦ä¹ å†ç¨‹ï¼Œä»æ–°æ‰‹åˆ°è¿›é˜¶ï¼Œç”Ÿä¿¡è·¯ä¸Šæœ‰ä½ æœ‰æˆ‘ï¼</span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><span>æœ€è¿‘å‘ç°ç®€ä¹¦ä¸Šä¼ å›¾ç‰‡çš„åŠŸèƒ½ã€‚ã€‚ã€‚å¤±çµäº†ã€‚å¯èƒ½è·ç¦»å€’é—­åˆè¿‘äº†ä¸€æ­¥ã€‚</span></p><p><img data-galleryid="" data-ratio="0.5314814814814814" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuJhE3ibUhZEgSOvBTYOTYYSIIFhtk6qX0t9drU8QcOXicxaRSQtiapQ20w/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuJhE3ibUhZEgSOvBTYOTYYSIIFhtk6qX0t9drU8QcOXicxaRSQtiapQ20w/640?wx_fmt=png"></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><br></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>1.ç¼–ç¤ºä¾‹æ•°æ®</span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>set.seed(10086)<br>expÂ =Â matrix(rnorm(480,meanÂ =Â 6),ncolÂ =Â 120)<br>expÂ =Â round(exp,2)<br>rownames(exp)Â =Â paste0(<span>"gene"</span>,1:4)<br>colnames(exp)Â =Â paste0(<span>"test"</span>,1:120)<br>exp[,50:80]Â =Â exp[,50:80]+2<br>exp[,90:120]Â =Â exp[,90:120]+4<br>exp[1:4,1:4]<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">åˆ°è¿™ä¸€æ­¥ï¼Œæ‹¿åˆ°äº†ä¸€ä¸ªç¼–çš„è¡¨è¾¾çŸ©é˜µã€‚</p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>2.æ ¼å¼è½¬æ¢</span><span></span></h3><p data-tool="mdniceç¼–è¾‘å™¨">è¡¨è¾¾çŸ©é˜µè¦ç”»ggplot2ç®±çº¿å›¾ï¼Œè‚¯å®šæ˜¯è¦å…ˆè½¬å˜æ ¼å¼çš„ï¼Œå¦åˆ™ggplot2ä»£ç æ— æ³•ä¸‹æ‰‹å†™ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(tidyr)<br>library(tibble)<br>library(dplyr)<br>datÂ =Â t(exp)Â %&gt;%Â <br>Â Â as.data.frame()Â %&gt;%Â <br>Â Â rownames_to_column()Â %&gt;%Â <br>Â Â mutate(groupÂ =Â rep(c(<span>"control"</span>,<span>"treat1"</span>,<span>"treat2"</span>),eachÂ =Â 40))<br><br>pdatÂ =Â dat%&gt;%Â <br>Â Â pivot_longer(colsÂ =Â starts_with(<span>"gene"</span>),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â names_toÂ =Â <span>"gene"</span>,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â values_toÂ =Â <span>"value"</span>)<br>head(pdat)<br></code></pre><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>3.ç”»ç®±çº¿å›¾</span><span></span></h3><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(ggplot2)<br>p1Â =Â ggplot(pdat,Â aes(y=value,Â x=gene))+<br>Â Â geom_boxplot(aes(fill=group),outlier.shapeÂ =Â NA)+<br>Â Â theme_bw()+<br>Â Â scale_fill_manual(valuesÂ =Â c(<span>"#2fa1dd"</span>,Â <span>"#f87669"</span>,Â <span>"#e6b707"</span>))<br>p1<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbumS8IpdP3aibSRDlFkrgJwuKz7oySezeRevpRtT3MFjBkI51XOJuFLiag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbumS8IpdP3aibSRDlFkrgJwuKz7oySezeRevpRtT3MFjBkI51XOJuFLiag/640?wx_fmt=png"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuX8YadicibUia6YVe8bgIVYoib7f5KBhpzXU6u2Rr3G0SPsnYHfTO6lDicjg/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuX8YadicibUia6YVe8bgIVYoib7f5KBhpzXU6u2Rr3G0SPsnYHfTO6lDicjg/640?wx_fmt=png"></p><h3 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>4.åŠ æ˜¾è‘—æ€§æ ‡è®°</span><span></span></h3><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>4.1ä¹ ä»¥ä¸ºå¸¸ç‰ˆ</span><span><span> </span></span></h4><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(ggpubr)<br>p1Â +Â <br>Â Â stat_compare_means(aes(groupÂ =Â group,Â labelÂ =Â after_stat(p.signif)),methodÂ =Â <span>"wilcox.test"</span>)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbulwe23ShbDnhEC2SAvMevG1iczSGfsXmrTC32yB0Mvy5YF8SI0hWX3ug/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbulwe23ShbDnhEC2SAvMevG1iczSGfsXmrTC32yB0Mvy5YF8SI0hWX3ug/640?wx_fmt=png"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuzb6nRysGyibRGHgjghYzQXJBlicu2O4Jo67bSXicDjcfcibatXicEZCQqGA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuzb6nRysGyibRGHgjghYzQXJBlicu2O4Jo67bSXicDjcfcibatXicEZCQqGA/640?wx_fmt=png">è¿™ä¸ªè¶…çº§ç®€å•ï¼Œä½†æ˜¾è‘—æ€§ç»Ÿä¸€åœ¨å¤´é¡¶ä¸Šï¼Œç„¶åä¹Ÿä¸æ”¯æŒæ¯ä¸ªåŸºå› åœ¨ä¸¤ä¸¤åˆ†ç»„ä¸­çš„æ˜¾è‘—æ€§å•ç‹¬è®¡ç®—ã€‚</p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>4.2 é”™è½æœ‰è‡´ç‰ˆ</span><span><span> </span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨">ç”¨rstatixé‡Œçš„å‡½æ•°è®¡ç®—å‡ºæ˜¾è‘—æ€§å’Œæ·»åŠ æ˜¾è‘—æ€§çš„æ¨ªçºµåæ ‡ä½ç½®ï¼Œå†ç”¨stat_pvalue_manualæ·»åŠ ä¸Šå»ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>library(rstatix)<br>stat.testÂ &lt;-Â pdatÂ %&gt;%Â <br>Â Â group_by(gene)Â %&gt;%Â <br>Â Â wilcox_test(valueÂ ~Â group)Â %&gt;%<br>Â Â adjust_pvalue()Â %&gt;%Â <br>Â Â add_significance(<span>"p.adj"</span>)Â %&gt;%Â <br>Â Â add_xy_position(x=<span>"gene"</span>)<br>p1Â +Â stat_pvalue_manual(stat.test,labelÂ =Â <span>"p.adj.signif"</span>,hide.nsÂ =Â F,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tip.lengthÂ =Â 0.01)<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuyrqeToIEFRKqwE3C3BzEHb313WSYFTH5ib909pCb2XicLUaWzMG3Ekag/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuyrqeToIEFRKqwE3C3BzEHb313WSYFTH5ib909pCb2XicLUaWzMG3Ekag/640?wx_fmt=png"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuHbCOAVYmgQwEicvWdosZ4xZNafcrBc25w2E5jsWNb7LiaeI8Ie4Cviajw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbuHbCOAVYmgQwEicvWdosZ4xZNafcrBc25w2E5jsWNb7LiaeI8Ie4Cviajw/640?wx_fmt=png"></p><h4 data-tool="mdniceç¼–è¾‘å™¨"><span><span> </span></span><span><span> </span>4.3 æ‰‹åŠ¨æ·»åŠ ç‰ˆ</span><span><span> </span></span></h4><p data-tool="mdniceç¼–è¾‘å™¨">ä¾‹å¦‚ä¸Šæ¬¡ç”»çš„<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247493702&amp;idx=1&amp;sn=fac8689b99aa40b90378307d1b5456b4&amp;chksm=fdfba004ca8c29120b262a1342865c0d42ce86d4bcc5475c7ede1918c10b5e7ebe77ddf4b027&amp;scene=21#wechat_redirect" textvalue="AUCå€¼æŸ±çŠ¶å›¾" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>AUCå€¼æŸ±çŠ¶å›¾</strong></a>ï¼Œå®ƒçš„çºµåæ ‡å’Œè¯¯å·®æ£’ä¸æ˜¯ç”»å›¾æ—¶è®¡ç®—å‡ºæ¥çš„ï¼Œè€Œæ˜¯æ‹¿äº†ç°æˆçš„æ•°å€¼æ¥ç”»ï¼Œå°±æ— æ³•ç”¨ä¸Šé¢çš„æ–¹æ³•è®¡ç®—ã€‚å¦‚æœèƒ½è‡ªè¡Œç”¨å…¶ä»–æ–¹æ³•è®¡ç®—å‡ºç»„é—´æ¯”è¾ƒçš„æ˜¾è‘—æ€§å¦‚ä½•ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">è¿™é‡Œçš„datsæ•°æ®æ¥è‡ªç‚¹ä»–ğŸ‘‰<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247493702&amp;idx=1&amp;sn=fac8689b99aa40b90378307d1b5456b4&amp;chksm=fdfba004ca8c29120b262a1342865c0d42ce86d4bcc5475c7ede1918c10b5e7ebe77ddf4b027&amp;scene=21#wechat_redirect" textvalue="AUCå€¼æŸ±çŠ¶å›¾" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>AUCå€¼æŸ±çŠ¶å›¾</strong></a></p><pre data-tool="mdniceç¼–è¾‘å™¨"><span></span><code>rm(listÂ =Â ls())<br>load(<span>"dats.Rdata"</span>)<br>pÂ =Â ggplot(dats,Â aes(xÂ =Â category,Â yÂ =Â y,Â fillÂ =Â x))Â +<br>Â Â geom_bar(<span>stat</span>Â =Â <span>"identity"</span>,Â positionÂ =Â <span>"dodge"</span>)Â +<br>Â Â geom_text(aes(labelÂ =Â round(y,2)),Â vjustÂ =Â 4,Â sizeÂ =Â 3,<br>Â Â Â Â Â Â Â Â Â Â Â Â positionÂ =Â position_dodge(widthÂ =Â 0.9))Â +<br>Â Â geom_errorbar(aes(yminÂ =Â min,Â ymaxÂ =Â max),Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â widthÂ =Â 0.2,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â positionÂ =Â position_dodge(widthÂ =Â 0.9))Â +<br>Â Â scale_fill_manual(valuesÂ =Â c(<span>"#2fa1dd"</span>,Â <span>"#f87669"</span>,Â <span>"#e6b707"</span>))+<br>Â Â theme_bw()<br>p<br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbukicPBGws3VPcktX5HCia8xgAO2Sc77DDvGApvickmXwkLF1oaUaSWUdkw/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbukicPBGws3VPcktX5HCia8xgAO2Sc77DDvGApvickmXwkLF1oaUaSWUdkw/640?wx_fmt=png"><img data-ratio="0.7138888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbujQlfR6sxHmOg3jDllrcxdrF1MlibibI9vZtjtEAM1y9YhdEYxunnRNicA/640?wx_fmt=png" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqMEVlBZlDqT1icPCqUCiarbujQlfR6sxHmOg3jDllrcxdrF1MlibibI9vZtjtEAM1y9YhdEYxunnRNicA/640?wx_fmt=png"></p></section></section><p><span></span></p><section><blockquote><section><span>å¦‚æœå› ä¸ºä»£ç çœ‹ä¸æ‡‚ï¼Œè€Œè·Ÿä¸ä¸Šæ­£æ–‡çš„èŠ‚å¥ï¼Œå¯ä»¥æ¥æ‰¾æˆ‘ï¼Œç›¸å½“äºæ¥ä¸€ä¸ªæ–°æ‰‹ä¿æŠ¤æœŸã€‚æˆ‘çš„</span><span>è¯¾ç¨‹éƒ½æ˜¯å¾ªç¯å¼€è¯¾ã€‚</span><span>ä¸‹ä¸€æœŸçš„æ—¶é—´ï¼Œç‚¹è¿›å»å’¨è¯¢å¾®ä¿¡å’¯</span><br></section><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247493441&amp;idx=1&amp;sn=95e2cc24fda53117ae312d6644c1b221&amp;chksm=fdfbaf03ca8c2615d80969e56cf8863219c0afd2efd0dca01b907a3c815b73ef9f77d90bdb0c&amp;scene=21#wechat_redirect" textvalue="æ–°çš„ä¸€å¹´ï¼Œä½ è¦ä¸è¦æ¥æ‰¾æˆ‘â€ä»¬å­¦â€ä¹ ç”Ÿä¿¡" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">æ‰¾æˆ‘ä»¬å­¦ä¹ ç”Ÿä¿¡</a></section></blockquote></section><section><section><br></section></section><section><br></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/d7fnlFwA-s0Ck8woAJHbuw",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
