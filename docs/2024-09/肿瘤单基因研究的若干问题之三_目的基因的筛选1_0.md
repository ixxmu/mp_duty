---
title: "肿瘤单基因研究的若干问题之三：目的基因的筛选1.0"
date: 2024-09-21T15:07:44Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
肿瘤单基因研究的若干问题之三：目的基因的筛选1.0 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkzMjY4NDc5OQ==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/icChUoP0cEfWlsicwfD6TDoB0D4adYdoI5rpekOgL0YjwwCicTJRWPP1Rr3DI9ZwcBZpyVUct0K8nNE5HVwzryrFg/0?wx_fmt=png" data-nickname="Investigator进修录" data-alias="" data-signature="医学科研笔记，分享生信/临床数据挖掘及分析技巧，R语言入门及绘图，解读生信/临床/基础医学文献" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><h3 data-tool="mdnice编辑器"><span></span><span>前言</span><span></span></h3><p data-tool="mdnice编辑器">Hello小伙伴们大家好！临床菜鸟刚刚上路，本着菜就多练的原则，几乎住在了科室。<img data-imgfileid="100000333" data-ratio="0.6361111111111111" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icChUoP0cEfX7DMY5WI7Kjk1E2UZMTWDZawHWNW724A8MqEM99GicCxtkLfeK8Cob7JWQjoZfW2Gnded8KnUZZmw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icChUoP0cEfX7DMY5WI7Kjk1E2UZMTWDZawHWNW724A8MqEM99GicCxtkLfeK8Cob7JWQjoZfW2Gnded8KnUZZmw/640?wx_fmt=jpeg&amp;from=appmsg"><br></p><p data-tool="mdnice编辑器">医疗同行应该都知道了三明医改五年内全国推行的消息，不知是喜还是忧？</p><p data-tool="mdnice编辑器">无论怎样，我们还是要做好自己，要么努力提升职业技能，好好学临床+科研；要么提前规划改行；要么准备雅思托福考试。</p><p data-tool="mdnice编辑器">总之，我们能做的就是无条件相信国家，然后做好自己。</p><p data-tool="mdnice编辑器">好了，不制造焦虑了。</p><p data-tool="mdnice编辑器">言归正传，开始我们今天的话题：如何筛选目的基因？</p><p data-tool="mdnice编辑器">如果你身处大佬课题组，大概率在硕博入学前课题就固定了（有目的基因）那么恭喜你，可以暂时划过本期推文了（后期将单出一期有目的基因的推文，大佬课题组的也可以忽略）。</p><p data-tool="mdnice编辑器">如果是一般的课题组，或是 放养课题组，抑或是 没有课题组，那么本期推文或许适合你和我一起来探讨。目的基因的筛选，从测序数据入手，或许你可以这样做。。。</p><h4 data-tool="mdnice编辑器"><span></span><span>1.从基因表达与预后入手</span><span></span></h4><p data-tool="mdnice编辑器">如果没有目的基因，最简单粗暴的方式就是通过差异基因分析和生存分析筛选目的基因。表达与预后的问题前两期已经和大家聊过。虽然，但是，，，还是推荐大家首选在肿瘤中高表达且是预后危险因素的基因进行研究。</p><p data-tool="mdnice编辑器">在进行差异基因分析时，有几个常用的R包，它们分别是DESeq2、edgeR和limma。以下是关于这些R包的一些信息：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>DESeq2</strong>：这是一个基于负二项式分布的差异表达分析工具，适用于RNA-seq数据。它通过估计样本之间的大小差异来标准化计数数据，并使用局部回归来估计分散度。DESeq2可以处理批次效应和样本间的差异性。安装DESeq2的代码如下：</p><pre><span></span><code><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))<br>    install.packages(<span>"BiocManager"</span>)<br>BiocManager::install(<span>"DESeq2"</span>)<br></code></pre></section></li><li><section><p><strong>edgeR</strong>：edgeR也是一个用于RNA-seq数据差异表达分析的R包，它使用经验贝叶斯方法来估计差异表达。edgeR适合于比较小的样本集，并且可以处理技术重复。安装edgeR的代码如下：</p><pre><span></span><code>BiocManager::install(<span>"edgeR"</span>)<br></code></pre></section></li><li><section><p><strong>limma</strong>：limma包提供了用于微阵列和RNA-seq数据的线性模型和统计测试。它使用Bayesian方法来估计差异表达，并且可以用于处理大规模的基因表达数据。limma还支持voom变换，这是一种用于改善计数数据的统计方法。安装limma的代码如下：</p><pre><span></span><code>BiocManager::install(<span>"limma"</span>)<br></code></pre></section></li></ol><p data-tool="mdnice编辑器">这些R包都有各自的优势和特点，选择哪个包取决于数据类型、样本大小和研究目的。在使用这些工具之前，需要准备好表达矩阵和分组信息，然后按照各自的流程进行分析。分析结果通常包括差异表达基因列表、统计显著性和差异倍数等。</p><p data-tool="mdnice编辑器">在使用这些R包时，可以参考相应的用户指南和文献，以确保分析的正确性和结果的可解释性。此外，还可以使用其他工具和R包，如pheatmap、ggplot2等，来进行结果的可视化和进一步分析。</p><p data-tool="mdnice编辑器">具体的分析代码，微信搜一搜一大堆，在这里就不罗列了。</p><p data-tool="mdnice编辑器">那么生存分析（KM/COX）的批量筛选，可以在差异表达基因的基础上进行，下面的代码还是很好用的：</p><pre data-tool="mdnice编辑器"><span></span><code>library(limma)<br>library(survival)<br><br>pFilter=0.05                         <br>expFile=<span>"diffGeneExp.txt"</span>            <br>cliFile=<span>"time.txt"</span>     <br>setwd(<span>""</span>)    <br>rt=read.table(expFile, header=T, sep=<span>"\t"</span>, check.names=F)<br>rt=as.matrix(rt)<br>rownames(rt)=rt[,1]<br>exp=rt[,2:ncol(rt)]<br>dimnames=list(rownames(exp), colnames(exp))<br>data=matrix(as.numeric(as.matrix(exp)), nrow=nrow(exp), dimnames=dimnames)<br>data=avereps(data)<br>data=data[rowMeans(data)&gt;0,]<br>data=t(data)<br>cli=read.table(cliFile, header=T, sep=<span>"\t"</span>, check.names=F, row.names=1)<br>cli<span>$futime</span>=cli<span>$futime</span>/365<br>sameSample=intersect(row.names(data), row.names(cli))<br>data=data[sameSample,,drop=F]<br>cli=cli[sameSample,,drop=F]<br>rt=cbind(cli, data)<br><br>outTab=data.frame()<br><span>for</span>(gene <span>in</span> colnames(rt[,3:ncol(rt)])){<br> <span>if</span>(sd(rt[,gene])&lt;0.1){next}<br> group=ifelse(rt[,gene]&lt;=median(rt[,gene]), <span>"low"</span>, <span>"high"</span>)<br> <br>    <span>#km</span><br> diff=survdiff(Surv(futime, fustat) ~group, data=rt)<br> pValue=1-pchisq(diff<span>$chisq</span>,df=1)<br> <br> <span>#cox</span><br> cox=coxph(Surv(futime, fustat) ~ rt[,gene], data = rt)<br> coxSummary=summary(cox)<br> coxP=coxSummary<span>$coefficients</span>[,<span>"Pr(&gt;|z|)"</span>]<br><br> <span>if</span>((pValue&lt;pFilter) &amp; (coxP&lt;pFilter)){<br>     outTab=rbind(outTab,<br>                  cbind(gene=gene,<br>                        KM=pValue,<br>                        HR=coxSummary<span>$conf</span>.int[,<span>"exp(coef)"</span>],<br>                        HR.95L=coxSummary<span>$conf</span>.int[,<span>"lower .95"</span>],<br>                        HR.95H=coxSummary<span>$conf</span>.int[,<span>"upper .95"</span>],<br>                  coxPvalue=coxP) )<br> }<br>}<br><br>outTab=outTab[order(as.numeric(as.vector(outTab[,<span>"KM"</span>]))),]<br>write.table(outTab, file=<span>"survival.txt"</span>, sep=<span>"\t"</span>, row.names=F, quote=F)<br></code></pre><p data-tool="mdnice编辑器">由于上述方法简单粗暴，我们在具体执行时，可能会面临以下问题：一是筛到的基因太多；二是筛到的基因太少。对于这两个问题，应该如何解决，最终顺利筛选到你心仪的基因？后期我们会专门出一期推文。同时也欢迎大家给我们私信或留言讨论。</p><h4 data-tool="mdnice编辑器"><span></span><span>2. 从基因集入手</span><span></span></h4><p data-tool="mdnice编辑器">如果课题组有固定的研究方向，或者你有感兴趣的研究方向，或者想追热门，那么可以从某一大方向入手。如表观遗传？代谢？程序性细胞死亡？免疫？等等等等</p><p data-tool="mdnice编辑器">逐渐缩小范围：以程序性细胞死亡（<a href="https://mp.weixin.qq.com/s?__biz=MzkzMjY4NDc5OQ==&amp;mid=2247483814&amp;idx=1&amp;sn=54d6ee2e0e2b74acc167b88b54ea7e3d&amp;scene=21#wechat_redirect" data-linktype="2">https://mp.weixin.qq.com/s/SlESiT9PSbD_eHKI7AngEQ</a>）为例，其下包括：细胞凋亡（Apoptosis）、坏死性凋亡 (Necroptosis)、细胞焦亡（Pyroptosis）、铁死亡（Ferroptosis）、PARP1依赖的死亡（Parthanatos）、内亡或者侵入性细胞死亡（Entotic cell death）、依赖中性粒细胞外诱捕网的死亡（Netotic cell death）、溶酶体依赖性细胞死亡（LCD），、自噬依赖性细胞死亡（ADCD）、免疫原性细胞死亡（immunogenic cell death，ICD）、铜死亡（Cuprotosis）、双硫死亡（Disulfidptosis）......</p><p data-tool="mdnice编辑器">选定了方向之后，就要筛选该方向的相关基因，那么就要先获取下载基因集。基因集的下载方式有很多，主要有以下几种:</p><p data-tool="mdnice编辑器">1.专用数据库搜索：比如你对铁死亡感兴趣，可以去铁死亡数据库下载基因集，FerrDb数据库（http://www.zhounan.org/ferrdb/current/）于2020年1月份发布，目前更新至2.0版本，数据库发布时整合了Pubmed中784篇铁死亡相关研究文献数据，提供253个铁死亡调节因子、111个铁死亡标志基因和95个铁死亡相关疾病信息，其中铁死亡调节因子包含108个铁死亡驱动基因和69个铁死亡抑制基因，以及35个铁死亡诱导剂和41个铁死亡抑制剂。如果对线粒体感兴趣，可以去专门收录线粒体相关基因标签的数据库——MitoCarta3.0（https://www.broadinstitute.org/mitocarta/mitocarta30-inventory-mammalian-mitochondrial-proteins-and-pathways）。</p><p data-tool="mdnice编辑器">2.如果没有特定的基因集数据库，可以使用多个通用数据库和工具，以下是一些常用的资源：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>MSigDB (Molecular Signatures Database)</strong>: 提供了大量注释的基因集，用于基因集富集分析（GSEA）。这些基因集可以根据不同的生物学主题进行分类，如Hallmark基因集、KEGG通路、GO术语等。MSigDB 官网</p></section></li><li><section><p><strong>GeneCards</strong>: 一个全面的基因信息数据库，提供基因的基本信息、功能、表达数据以及与疾病的关系。GeneCards 官网</p></section></li><li><section><p><strong>KEGG (Kyoto Encyclopedia of Genes and Genomes)</strong>: 一个集成的数据库资源，用于理解生物系统的高级功能和用途，特别是大规模分子数据集。KEGG 官网</p></section></li><li><section><p><strong>Reactome</strong>: 提供人类生物过程的详细路径信息，包括代谢通路、信号传导等。Reactome 官网</p></section></li><li><section><p><strong>Gene Ontology (GO)</strong>: 提供基因和基因产品的标准化描述，包括生物过程、分子功能和细胞组分。GO 官网</p></section></li><li><section><p><strong>NCBI (National Center for Biotechnology Information)</strong>: 提供多种基因相关信息，包括基因序列、基因表达数据等。NCBI GEO 官网</p></section></li><li><section><p><strong>CNGBdb (China National GeneBank DataBase)</strong>: 提供生物大数据共享和应用服务的平台，包括多个科学数据库。CNGBdb 官网</p></section></li><li><section><p><strong>Bio-db Search 2.0</strong>: 提供多种生物数据库的搜索，包括蛋白质、基因、代谢通路等。Bio-db Search 官网</p></section></li><li><section><p><strong>OmicShare Tools</strong>: 提供多种生物信息学分析工具，包括KEGG富集分析、GO富集分析等。OmicShare Tools 官网</p></section></li></ol><p data-tool="mdnice编辑器">使用这些数据库和工具时，你可以通过关键词搜索、基因ID、基因列表或特定生物学过程来查找相关的基因集。这些资源对于理解基因功能、进行基因表达分析和研究基因调控网络非常有用。</p><p data-tool="mdnice编辑器">3.此外，你还可以通过检索文献，收集大量的基因，列出自己收集的基因集。</p><p data-tool="mdnice编辑器">有了特定的基因集，也就有了目标基因范围，筛选基因的时候也就更加得心应手。</p><h4 data-tool="mdnice编辑器"><span></span><span>结语</span><span></span></h4><p data-tool="mdnice编辑器">目的基因的筛选，是一个简单且复杂的问题，有很长的故事要讲（主要是最近时间有限）。所以本期推文的题目是“目的基因的筛选1.0”，今天就先到这里，朋友们咱们目的基因的筛选2.0，3.0，4.0......见！！！</p></section><section><p><br></p><section data-style-type="5" data-tools="新媒体排版" data-id="2440476"><section><section><section><section><img data-imgfileid="100041898" data-ratio="0.9495798319327731" data-src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif" data-type="gif" data-w="119" data-width="100%" src="https://mmbiz.qpic.cn/mmbiz_gif/09gp6SvPE04j3m2v7Hr889icHUyibTOHs8YuUibicl7ibRD0ZwG5pDTjBluRreZvuib1o3BibvLkicYhnA4YW7dQsjn0cA/640?wx_fmt=gif"></section><section data-brushtype="text">往期回顾</section><section><br></section></section></section></section><section><section data-autoskip="1"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525506&amp;idx=1&amp;sn=e33ff4584ea77df2cf4e292a28e8a760&amp;chksm=ea1c6200dd6beb16e9266604c28ae7fef34713d07e53f6ff7a6c2757025d1d6af46d78c7bc3e&amp;scene=21#wechat_redirect" textvalue="话十九 | 单细胞多组学应用T2T参考基因组的时机" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">话十九 | 单细胞多组学应用T2T参考基因组的时机</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525413&amp;idx=1&amp;sn=ef18252218b800d08df29f7b31b46abd&amp;chksm=ea1c62a7dd6bebb145da8d2a4c6f46f3963b062795e4cb6739314d11d850fa3209b189be3cf4&amp;scene=21#wechat_redirect" textvalue="使用ggplot2美化Dotplot结果" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">使用ggplot2美化Dotplot结果</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525412&amp;idx=1&amp;sn=b255d191d7257a3d548dacded1129738&amp;chksm=ea1c62a6dd6bebb0fdf0be5808cb414027c239896077638c547006a101d88a3d260987824d8f&amp;scene=21#wechat_redirect" textvalue="患者来源的微器官球(MOS)使临床精确肿瘤学成为可能" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">患者来源的微器官球(MOS)使临床精确肿瘤学成为可能</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525411&amp;idx=1&amp;sn=6fe186e465d63fc1e192a9d3db194a28&amp;chksm=ea1c62a1dd6bebb702a3e6bfe3dd86a69c25338bb2b420ef467fc054e561877766b6c4e2f422&amp;scene=21#wechat_redirect" textvalue="SGS单细胞与空间组数据可视化教程合集" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">SGS单细胞与空间组数据可视化教程合集</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247524975&amp;idx=1&amp;sn=0e1b2bc1cbe937fbe9d5c7b1148bcc7c&amp;chksm=ea1c64eddd6bedfbf93db3f730e1ed42c384d6225b7564b57fd214f6a280a9f64548f0910a5a&amp;scene=21#wechat_redirect" textvalue="胃癌单细胞数据集GSE163558复现(十二)：细胞通讯" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">胃癌单细胞数据集GSE163558复现(十二)：细胞通讯</a><br></p></section></section><hr><p><br></p></section><section data-style-type="5" data-tools="新媒体排版" data-id="2440475"><hr><p><br></p><hr><section><p>如果你对单细胞转录组研究感兴趣，但又不知道如何入门，也许你可以关注一下下面的课程<span></span></p><p><br></p><ul><li><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525508&amp;idx=2&amp;sn=77bfcda1b845598acebb5ae95c49a064&amp;chksm=ea1c6206dd6beb103a3cf043904c8f4870ae3724e386024e1245c29b0b6afb0305b558088cad&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课10月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信入门&amp;数据挖掘线上直播课10月班</a><br></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><span>时隔5年，我们的生信技能树VIP学徒继续招生啦</span></a><br></p></li><li><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247520120&amp;idx=1&amp;sn=ad91a187458eb591129d3d366bfccf71&amp;chksm=ea1c89fadd6b00ec227d9588dadf672e1eb88d0449d500602d61f155023ee5721facdc9a5b57&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1"><span>2024的共享服务器交个朋友福利价仍然是800</span></a><span></span></p></li></ul><p><img data-imgfileid="100041899" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif" data-type="gif" data-w="240" src="https://mmbiz.qpic.cn/mmbiz_gif/4TKeL1ZejtlKxOib5kmKX6ic6eX0w0WK5jvhtz9yBRsO3OI4yr6S5iaLNM7AbAeuPDHXMvDdur2DRz9wyiax4lEviag/640?wx_fmt=gif"><br></p><p><img data-ratio="0.05278592375366569" data-src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg" data-type="other" data-w="341" data-imgfileid="100041897" src="https://mmbiz.qpic.cn/mmbiz/4TKeL1Zejtlq03ZOSZiaTlic1MxgdKiaxTbOZ7ZSe0Xx1Ca8xF3L6Nyj1FYUajtYrSmRIHyZVSsAve0EAvEicZONpg/640?wx_fmt=jpeg"></p><p><strong><span>看完记得顺手点个</span></strong><span><strong><span>“在看”</span></strong></span><strong><span>哦！</span></strong></p></section><section><section data-id="93668"><section><section data-width="95%"><section><section><section data-width="38%"><section><section data-tools="135编辑器" data-id="93668"><section><section data-width="95%"><section><section><section data-width="61.8%"><section><section><section><p><br></p><span><strong data-burshtype="text"><img data-copyright="0" data-cropselx1="0" data-cropselx2="109" data-cropsely1="0" data-cropsely2="109" data-imgfileid="100041900" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg" data-type="other" data-w="258" title="qrcode_for_gh_5a3c482ed99f_1280.jpg" src="https://mmbiz.qpic.cn/mmbiz/siaia0BDGJdjRMGrkqo64BGKecYk4akuHpGHVQs7FeOpY7eWbIPGC1tRw5Tw0oEPmx053mR9FTVerWvhuZchIpZw/640?wx_fmt=jpeg"><strong data-burshtype="text">生物</strong><strong data-burshtype="text"> | 单细胞 | 转录组丨资料</strong></strong></span></section><section><span><strong data-burshtype="text">每天都精彩</strong></span></section></section></section><section><section><section><section><section><section><p><span>长按扫码可关注</span></p></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/mBVfFlruNMLY1ZrpxQ4jQQ",target="_blank" rel="noopener noreferrer">原文链接</a>
