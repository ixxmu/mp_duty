---
title: "bulk层面的癌症和癌旁的表达量差异主要是因为？"
date: 2024-09-20T00:08:24Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
bulk层面的癌症和癌旁的表达量差异主要是因为？ by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>前面我们探索了：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533814&amp;idx=1&amp;sn=b80a8259229099658b7c19f77b929779&amp;chksm=9b4b044dac3c8d5bd35c957d9044afa6631857e1ed141f77af7a5bdc76ee0f1557762641ea16&amp;scene=21#wechat_redirect" textvalue="癌症和癌旁的差异基因能在单细胞层面区分上皮细胞的恶性与否吗" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">癌症和癌旁的差异基因能在单细胞层面区分上皮细胞的恶性与否吗</a>，是直接使用了作者给出来了的基因列表。具体方法学是：去tcga数据库里面定位到胃癌的转录组测序数据集，<span><strong>然后根据分组做癌症和癌旁的差异分析后，拿到上下调各自的top50基因列表。</strong></span></p></blockquote><p data-tool="mdnice编辑器">实际上，如果是为了拿到bulk层面的癌症和癌旁的表达量，有非常多的选择，不仅仅是去tcga数据库里面定位到胃癌的转录组测序数据集，<strong>可以是geo数据库的转录组测序，也可以是geo数据库的表达量芯片数据集，</strong>都是bulk层面的。在<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533814&amp;idx=1&amp;sn=b80a8259229099658b7c19f77b929779&amp;chksm=9b4b044dac3c8d5bd35c957d9044afa6631857e1ed141f77af7a5bdc76ee0f1557762641ea16&amp;scene=21#wechat_redirect" textvalue="癌症和癌旁的差异基因能在单细胞层面区分上皮细胞的恶性与否吗" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">癌症和癌旁的差异基因能在单细胞层面区分上皮细胞的恶性与否吗</a> 我们就举例了一个RRA算法，它汇总了9个不同的表达量芯片数据集，都是胃癌和癌旁的差异分析。</p><h3 data-tool="mdnice编辑器"><span></span><span>任意的单个表达量芯片的癌症和癌旁差异分析都是不够的</span><span></span></h3><p data-tool="mdnice编辑器">我们这里拿GSE54129作为案例，是很清晰的两分组（癌症和癌旁）：</p><ul data-tool="mdnice编辑器"><li><section>Tumor samples from 111 patients with gastric cancer underwent subtotal gastrectomy.</section></li><li><section>Biopsy Normal gastric mucosa got from 21 volunteer who underwent gastroscopy for health examination.</section></li></ul><p data-tool="mdnice编辑器">常规差异分析的质量控制和上下调基因火山图和热图如下所示：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100050136" data-ratio="0.7925925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZ2WYeI5ia8zdaQcoZQYC14VZTS1RH02t5F14N0VIibShk5OoGCvbtiaYBQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZ2WYeI5ia8zdaQcoZQYC14VZTS1RH02t5F14N0VIibShk5OoGCvbtiaYBQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">统计学显著的基因，上下调各自都有一千多，可以去富集分析到go和kegg数据库，<span><strong>其中上调基因主要是 "Focal adhesion" 和 "ECM-receptor interaction" ：</strong></span></p><pre data-tool="mdnice编辑器"><span></span><code> cut -d<span>","</span> -f 5-8 KEGG_up.csv|head<br><span>"Description"</span>,<span>"GeneRatio"</span>,<span>"BgRatio"</span>,<span>"pvalue"</span><br><span>"Cytoskeleton in muscle cells"</span>,<span>"59/580"</span>,<span>"232/8844"</span>,2.0201262697303e-20<br><span>"Focal adhesion"</span>,<span>"50/580"</span>,<span>"203/8844"</span>,8.10067899795885e-17<br><span>"Complement and coagulation cascades"</span>,<span>"27/580"</span>,<span>"88/8844"</span>,4.73686044082476e-12<br><span>"AGE-RAGE signaling pathway in diabetic complications"</span>,<span>"28/580"</span>,<span>"101/8844"</span>,2.89660862481335e-11<br><span>"Amoebiasis"</span>,<span>"28/580"</span>,<span>"103/8844"</span>,4.83942103773697e-11<br><span>"Malaria"</span>,<span>"19/580"</span>,<span>"50/8844"</span>,1.10389658171616e-10<br><span>"Proteoglycans in cancer"</span>,<span>"40/580"</span>,<span>"204/8844"</span>,2.43683140328288e-10<br><span>"ECM-receptor interaction"</span>,<span>"25/580"</span>,<span>"89/8844"</span>,2.48239238345182e-10<br><span>"Rheumatoid arthritis"</span>,<span>"25/580"</span>,<span>"94/8844"</span>,8.87473649832924e-10<br></code></pre><p data-tool="mdnice编辑器">我们可以问一下人工智能大模型：<span><strong>做癌症和癌旁组织的表达量芯片的差异分析，上下调基因可能的来源是什么？</strong></span></p><p data-tool="mdnice编辑器">在进行癌症与癌旁组织表达量芯片的差异分析时，上下调基因可能来源于多种生物学机制：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>基因突变</strong>：癌症基因组中的突变可以导致某些基因的表达水平发生改变。这些突变可能包括点突变、基因扩增或缺失等 。</p></section></li><li><section><p><strong>表观遗传调控</strong>：DNA甲基化和组蛋白修饰等表观遗传学改变可以影响基因的表达。例如，CpG岛的高甲基化可能导致肿瘤抑制基因的沉默，而低甲基化可能与癌基因的激活有关 。</p></section></li><li><section><p><strong>异常的信号传导途径</strong>：在癌症中，细胞信号传导途径常常发生异常，导致某些基因的表达水平上调或下调。例如，PI3K/AKT信号通路的激活可能促进肿瘤细胞的增殖和存活 。</p></section></li><li><section><p><strong>肿瘤微环境的影响</strong>：肿瘤微环境中的细胞和细胞外基质可以分泌多种因子，这些因子通过旁分泌或自分泌的方式影响癌细胞的基因表达 。</p></section></li><li><section><p><strong>代谢重编程</strong>：癌细胞常常经历代谢重编程，以满足其快速增殖的能量和生物合成需求。这种代谢变化可能影响特定基因的表达 。</p></section></li><li><section><p><strong>基因融合</strong>：某些染色体易位事件导致基因融合，形成新的融合蛋白，这些融合蛋白可能具有异常的活性，从而影响基因表达 。</p></section></li><li><section><p><strong>非编码RNA的调控</strong>：长链非编码RNA、miRNA等非编码RNA分子通过多种机制调控基因表达，包括与靶mRNA的结合导致降解或阻止翻译等 。</p></section></li></ol><p data-tool="mdnice编辑器">通过差异分析，研究者可以识别在癌症组织中特异性表达的基因，这些基因可能在肿瘤的发生、发展、转移和预后中发挥重要作用。进一步的研究可以探索这些差异表达基因的功能，为癌症的诊断和治疗提供潜在的靶点。</p><p data-tool="mdnice编辑器"><span><strong>因为我们的差异分析结果里面上调基因主要是 "Focal adhesion" 和 "ECM-receptor interaction" 这两个生物学功能，所以我们可以合理的猜测，是这两个通路对应的单细胞亚群比例在癌症样品的上升。</strong></span>如果胃癌相对于正常的胃组织来说大量浸润了内皮细胞和成纤维细胞，那么这两个单细胞亚群的特异性基因当然是会体现出来bulk层面的癌症和癌旁的表达量。</p><p data-tool="mdnice编辑器">当然了，也有可能是这两个通路的恶性失调，同样的，我们可以问一下人工智能大模型：<span><strong>我们的上下调基因如何区分它的来源呢，是细胞比例改变导致的，还是恶性通路的激活呢？</strong></span></p><p data-tool="mdnice编辑器">在肿瘤微环境中，上下调基因的来源可能由多种因素导致，包括细胞比例的改变和恶性通路的激活。为了区分这些基因的来源，可以采用以下方法：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>单细胞转录组测序</strong>：通过单细胞技术，比如单细胞RNA测序（scRNA-seq），可以揭示肿瘤微环境中不同细胞类型的特定基因表达模式，<strong>包括肿瘤细胞、成纤维细胞、免疫细胞和血管内皮细胞等 。</strong></p></section></li><li><section><p><strong>基因集分析</strong>：基于肿瘤微环境相关的基因集构建预后预测模型，可以识别与疾病结局和治疗反应相关的基因。例如，<strong>使用CIBERSORT和ESTIMATE计算免疫评分和基质评分，鉴定与免疫反应相关的基因 。</strong></p></section></li><li><section><p><strong>多平台分析</strong>：结合scRNA-seq和T细胞受体（TCR）序列测序，可以构建高分辨率的免疫细胞转录组图谱，<strong>进一步分析肿瘤微环境中免疫细胞表型的影响因素 。</strong></p></section></li><li><section><p><strong>基因组拷贝数变异分析</strong>：通过单细胞基因组测序，可以识别肿瘤微环境中细胞的基因组拷贝数变异（SCNAs），<strong>这些变异可能影响基因表达，并与肿瘤的进展和转移情况有关 。</strong></p></section></li></ol><p data-tool="mdnice编辑器">综合上述方法，研究者可以更准确地识别和区分肿瘤微环境中上下调基因的具体来源，为肿瘤治疗提供更深入的理解和更精确的靶点。</p><h3 data-tool="mdnice编辑器"><span></span><span>拿上面的上下调差异基因列表去单细胞层面打分</span><span></span></h3><p data-tool="mdnice编辑器">我们这里使用这个胃癌单细胞数据集GSE163558，我做了解读，详见 ：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533053&amp;idx=1&amp;sn=bd155638b280e875dcae14622198b65b&amp;scene=21#wechat_redirect" data-linktype="2">单细胞转录组降维聚类分群过滤基因和过滤细胞的区别</a> 。而且前面已经是完成了降维聚类分群，在<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533061&amp;idx=1&amp;sn=de67737df31c0302667d9c7a75214415&amp;scene=21#wechat_redirect" data-linktype="2">学习单细胞亚群命名的层次结构</a> 演示了一个降维聚类分群结果，就有了  2-harmony/sce.all_int.rds 文件，以及对应的 phe.Rdata 注释信息。</p><p data-tool="mdnice编辑器">而且我在前面的 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533529&amp;idx=1&amp;sn=6c050003bd24d8aa372bc42e515dbfe9&amp;scene=21#wechat_redirect" data-linktype="2">走inferCNV流程的时候只需要针对上皮细胞即可</a>和<a href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533528&amp;idx=1&amp;sn=c731c51a3478151b7eaa040b4ad19e44&amp;chksm=9b4b0363ac3c8a751f4636764e1a1c23fea8ff87a88692fb057605ff8f6beee7f7bb1cd49de3&amp;scene=21#wechat_redirect" data-linktype="2">上皮细胞里面混入了淋巴系和髓系免疫细胞呢</a> 做好了上皮细胞的细分，也给出来了针对不同单细胞亚群的特异性基因进行go和kegg数据库注释的方法，如下所示可以看到我们的第一层次降维聚类分群是合理的。<strong>成纤维单细胞亚群的top100的特异性基因确实是会富集到 "Focal adhesion" 和 "ECM-receptor interaction" 。而我们前面的芯片表达量差异分析的癌症里面的上调基因也是富集到 "Focal adhesion" 和 "ECM-receptor interaction" 通路。</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100050137" data-ratio="0.8314814814814815" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZdRGaicc0ONlnDJERGiaY0wdaBdf7X49nNUlSvGKe2dRbGnZdReODSofg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZdRGaicc0ONlnDJERGiaY0wdaBdf7X49nNUlSvGKe2dRbGnZdReODSofg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br>getwd()<br><span>source</span>(<span>'../scRNA_scripts/lib.R'</span>)<br>sce.all.int = readRDS(<span>'../2-harmony/sce.all_int.rds'</span>) <br>load(<span>'../phe.Rdata'</span>)<br>sce.all.int@meta.data  = phe  <br>scRNA = subset(sce.all.int,downsample=<span>50</span>) <br>load(<span>'../GSE54129-anno_DEG.Rdata'</span>)<br> down=DEG$name[head(order(DEG$logFC),<span>50</span>)];<br> up=DEG$name[tail(order(DEG$logFC),<span>50</span>)]<br><br> gene_vector=list(up=up,down=down) <br>sc_dataset &lt;- Seurat::AddModuleScore(scRNA, <br>                                   features = gene_vector)  <br>p1=VlnPlot(sc_dataset, features = <span>'Cluster1'</span>, <br>        group.by = <span>"celltype"</span>,pt.size = <span>0</span> ) + NoLegend() <br>p2=VlnPlot(sc_dataset, features = <span>'Cluster2'</span>, <br>        group.by = <span>"celltype"</span>,pt.size = <span>0</span> ) + NoLegend()<br>p1/p2<br>ggsave(<span>'AddModuleScore-VlnPlot-top50-GSE54129-anno_DEG.pdf'</span>,<br>       width = <span>7</span>,height = <span>10</span>) <br></code></pre><p data-tool="mdnice编辑器">可以很明显的看到<strong>这个<span>GSE54129数据集的表达量差异分析后的</span>上调基因列表主要是在内皮细胞和成纤维细胞里面的高表达量</strong>，而下调基因反而是在上皮细胞打分比较高：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100050135" data-ratio="1.1324074074074073" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZULLF8IF1XpOqhe9vX93gaP0KyU3vVHtbuEauhXxcwyTicTI88y1S6pA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyRVeckKeRGkgCIPrINASeZULLF8IF1XpOqhe9vX93gaP0KyU3vVHtbuEauhXxcwyTicTI88y1S6pA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>上下调差异基因列表去单细胞各个亚群特异性基因交集</span><span></span></h3><p data-tool="mdnice编辑器">这个时候仍然是载入我们的每个单细胞亚群的top100基因，然后载入芯片表达量的差异分析上下调基因列表，然后做交集：</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>'../check-by-celltype/qc-_marker_cosg.Rdata'</span>) <br>head(marker_cosg)<br> symbols_list &lt;-  as.list(as.data.frame(apply(marker_cosg$names,<span>2</span>,head,<span>100</span>)))<br> symbols_list<br> <span>source</span>(<span>'../com_go_kegg_ReactomePA_human.R'</span>)<br><span>#source('../com_go_kegg_ReactomePA_mice.R')</span><br>com_go_kegg_ReactomePA_human(symbols_list, pro=<span>'b'</span> )<br>setwd(<span>'../'</span>)<br><br><br>up=read.table(<span>'../../GSE54129/gastric-vs-normal/gene_up.txt'</span>)[,<span>1</span>]<br>down=read.table(<span>'../../GSE54129/gastric-vs-normal/gene_down.txt'</span>)[,<span>1</span>]<br><br>do.call(rbind,<br>        lapply(names(symbols_list), <span>function</span>(i){<br>          x=symbols_list[[i]]<br>          <span>return</span>(c(i,<br>            length(x),length(up),length(down),<br>            length(intersect(x,up)),length(intersect(x,down))<br>          ))<br>        }))<br><br></code></pre><p data-tool="mdnice编辑器">可以看到的是，<strong>确实是表达量差异里面，上调的基因主要是跟内皮细胞和成纤维有交集，然后下调基因主要是在上皮细胞的特异性基因里面</strong>：</p><pre data-tool="mdnice编辑器"><span></span><code>     [,1]          [,2]  [,3]   [,4]   [,5] [,6]<br> [1,] <span>"neutrophils"</span> <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"35"</span> <span>"7"</span> <br> [2,] <span>"Tcells"</span>      <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"9"</span>  <span>"2"</span> <br> [3,] <span>"epi"</span>         <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"4"</span>  <span>"48"</span><br> [4,] <span>"Bcells"</span>      <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"20"</span> <span>"5"</span> <br> [5,] <span>"mac"</span>         <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"52"</span> <span>"2"</span> <br> [6,] <span>"mast"</span>        <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"6"</span>  <span>"5"</span> <br> [7,] <span>"endo"</span>        <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"33"</span> <span>"2"</span> <br> [8,] <span>"cycle"</span>       <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"1"</span>  <span>"2"</span> <br> [9,] <span>"plasma"</span>      <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"2"</span>  <span>"4"</span> <br>[10,] <span>"fibro"</span>       <span>"100"</span> <span>"1083"</span> <span>"1048"</span> <span>"80"</span> <span>"0"</span> <br></code></pre><p data-tool="mdnice编辑器">是不是蛮有意思的， <span><strong>这里面的生物学故事很多，但是绝大部分人没办法去理解。</strong></span></p><h3 data-tool="mdnice编辑器"><span></span><span><strong>肿瘤的hallmark有哪些，精简一下列表即可</strong></span><span></span></h3><p data-tool="mdnice编辑器">肿瘤的标志性特征（Hallmarks of Cancer）是一系列生物学过程，这些过程共同促进了肿瘤的发生和发展。根据Douglas Hanahan和Robert A. Weinberg的经典综述，这些特征不断更新以反映癌症研究的最新进展。以下是癌症的标志性特征的精简列表：</p><ol data-tool="mdnice编辑器"><li><section><strong>自给自足的生长信号</strong>：肿瘤细胞能够独立于正常调控机制，自主产生生长信号。</section></li><li><section><strong>对生长抑制信号不敏感</strong>：肿瘤细胞对正常抑制生长的信号不反应。</section></li><li><section><strong>逃避凋亡</strong>：肿瘤细胞能够规避程序性细胞死亡。</section></li><li><section><strong>无限的复制潜力</strong>：肿瘤细胞获得持续分裂的能力。</section></li><li><section><strong>持续的血管生成</strong>：肿瘤能够促进新血管的形成，以支持其生长。</section></li><li><section><strong>组织侵袭和转移</strong>：肿瘤细胞具有侵袭周围组织和远处转移的能力。</section></li><li><section><strong>细胞能量代谢的失控</strong>：肿瘤细胞改变其代谢途径以支持快速增长。</section></li><li><section><strong>逃避免疫清除</strong>：肿瘤细胞能够逃避免疫系统的监视和清除。</section></li><li><section><strong>肿瘤促炎症作用</strong>：肿瘤细胞能够产生和响应炎症信号，促进肿瘤生长。</section></li><li><section><strong>基因组的不稳定性和突变</strong>：肿瘤细胞具有较高的基因组不稳定性，导致频繁的突变。</section></li><li><section><strong>非突变表观遗传重编程</strong>：肿瘤细胞通过表观遗传改变来调节基因表达。</section></li><li><section><strong>多态性的微生物组</strong>：肿瘤细胞与体内的微生物组相互作用，影响肿瘤发展。</section></li><li><section><strong>解锁表型可塑性</strong>：肿瘤细胞表现出高度的可塑性，能够适应不同的环境条件。</section></li><li><section><strong>衰老细胞</strong>：肿瘤微环境中的衰老细胞可能影响肿瘤的发展和治疗响应。</section></li></ol><p data-tool="mdnice编辑器">这些特征不仅涵盖了肿瘤细胞的生物学特性，还包括了肿瘤与宿主环境的相互作用，为癌症的诊断、治疗和研究提供了重要信息。</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p><br></p><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。 <strong> </strong></span></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/vsueelTQPtdqLOKKKvsbSw",target="_blank" rel="noopener noreferrer">原文链接</a>
