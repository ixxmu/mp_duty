---
title: "SeqKit — 超快速的 FASTA和FASTQ 文件操作工具包"
date: 2024-09-24T14:27:21Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
SeqKit — 超快速的 FASTA和FASTQ 文件操作工具包 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6">工欲善其事必先利其器</strong></p></section></section></section></section></section></section></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>SeqKit</span><span></span></h2><p data-tool="mdnice编辑器">SeqKit 是沈伟（重庆医科大学附属第二医院）老师开发的一个跨平台且极速的生物信息分析工具，专为处理 FASTA/Q 文件而设计。它提供了一系列命令行工具和 API 接口，可以进行序列文件格式转换、序列处理和分析、序列统计等操作。其特性包括不限于：</p><ol data-tool="mdnice编辑器"><li><section><strong>易于安装和使用</strong>：提供一键式安装和静态链接的执行文件，无需任何配置，即可直接运行。</section></li><li><section><strong>高性能</strong>：针对大规模数据进行了优化，执行速度快，处理能力强。</section></li><li><section><strong>多功能</strong>：涵盖38个子命令，满足多种生物信息学需求。</section></li><li><section><strong>兼容性强</strong>：支持各种操作系统和压缩格式，并能轻松融入工作流中。</section></li><li><section><strong>跨平台</strong>：支持 Windows、Linux 和 macOS 系统。</section></li><li><section><strong>无依赖关系</strong>：无需安装额外的依赖软件即可使用。</section></li><li><section><strong>支持多种格式</strong>：支持读取和写入包括 GZIP、XZ、ZSTD 和 BZIP2 在内的多种压缩格式文件。</section></li></ol><ul data-tool="mdnice编辑器"><li><section>编程语言：GO</section></li><li><section>Github：https://github.com/shenwei356/seqkit</section></li><li><section>文档：https://bioinf.shenwei.me/seqkit/</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>发表文献</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p><strong>题目</strong>：SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation<br><strong>期刊</strong>：PLoS ONE<br><strong>日期</strong>：2016年10月5日<br><strong>作者&amp;单位</strong>：沈伟 &amp; 陆军军医大学<br><strong>DOI</strong>：https://doi.org/10.1371/journal.pone.0163962</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100044040" data-ratio="0.8351851851851851" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SLKBrbia7uxHJ8XUpVr2cWRWNI3gwVLWOzqFAXLLAF92VBFh4AZ9A5Ng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SLKBrbia7uxHJ8XUpVr2cWRWNI3gwVLWOzqFAXLLAF92VBFh4AZ9A5Ng/640?wx_fmt=png&amp;from=appmsg"><figcaption>文献</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>如何安装</span><span></span></h2><p data-tool="mdnice编辑器">软件提供多种安装方式，安装非常简便。详见：https://bioinf.shenwei.me/seqkit/download/</p><h3 data-tool="mdnice编辑器"><span></span><span>二进制安装</span><span></span></h3><p data-tool="mdnice编辑器">下载对应系统的压缩文件，解压即可使用</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span>https://github.com/shenwei356/seqkit/releases/download/v2.8.2/seqkit_darwin_arm64.tar.gz</span><br><br>wget -c http://app.shenwei.me/data/seqkit/seqkit_linux_amd64.tar.gz<br>tar -xf seqkit_linux_amd64.tar.gz <br><br>./seqkit<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044039" data-ratio="0.6185185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SEUy3xtnjibystkzXmicAQtL5FkHz7BeA6PVJY02EYyic70VCwECrWljMA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SEUy3xtnjibystkzXmicAQtL5FkHz7BeA6PVJY02EYyic70VCwECrWljMA/640?wx_fmt=png&amp;from=appmsg"><figcaption>安装记录</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>conda 安装</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>conda activate RNAseq<br>conda install seqkit<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044038" data-ratio="0.28425925925925927" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7S0cKkSwMgN0oia9fsAOl0Vxa8ibMUFW7epibvT5ib4J4auC8yY8ibhEpXycg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7S0cKkSwMgN0oia9fsAOl0Vxa8ibMUFW7epibvT5ib4J4auC8yY8ibhEpXycg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>功能简介</span><span></span></h2><p data-tool="mdnice编辑器">SeqKit 提供了一系列强大的子命令，用于高效地处理和分析基因序列。例如提取或过滤序列、获取简单统计信息、定位子序列、序列搜索和位置查找、移除重复序列、拆分文件等。它的使用非常灵活，通过子命令的组合使用，用户可以根据需要实现复杂的数据处理任务。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044042" data-ratio="0.6583333333333333" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SpLQ5yXWAGuDWC7YaDKZCRD16EhBcYnicaOiatia0MbPMFPslsrE9f7gAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SpLQ5yXWAGuDWC7YaDKZCRD16EhBcYnicaOiatia0MbPMFPslsrE9f7gAQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>子命令功能</figcaption></figure><h2 data-tool="mdnice编辑器"><span></span><span>一个简单示例</span><span></span></h2><p data-tool="mdnice编辑器">假设现在我们有一个样本的fastq1和fastq2，如果数据没保存好，发生了部分损坏，很不幸有没有备份数据。此时我们只能尽量恢复能用的数据。对于这个需求，我们该如何解决？</p><h3 data-tool="mdnice编辑器"><span></span><span>如果不使用seqkit</span><span></span></h3><p data-tool="mdnice编辑器">参考 <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247514176&amp;idx=1&amp;sn=34936085f870821374bff303461a2ae3&amp;scene=21#wechat_redirect" data-linktype="2">抢救你破碎的测序数据</a>。首先我们定位到出错的行，然后截取正确的行。</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span>#取出第三行</span></span><br>awk 'NR%4==3 {print NR " " $0}' Cko1_R2.fq &gt; ./test/row3_Cko1_R2.fq.txt<br><span>#</span><span><span>#判断第三行是不是正常？</span></span><br>head row3_Cko1_R2.fq.txt |cut -d " " -f 2<br><span><br>#</span><span><span>#取出第三行不正常的序列</span></span><br>awk '$2 !="+" {print $0}' row3_Cko1_R2.fq.txt &gt; err_row3_Cko2_R1.fq.txt<br><span><br>#</span><span><span>#查看开始出错的行</span></span><br>head -n 1 err_row3_Cko1_R2.fq.txt <br><span><br>#</span><span><span>#保留正确的行号，出错的行减去3(理论上是，但是还需要查看一下原始数据，或者保险起见，可以多截取一部分)，就是需要保留的</span></span><br>head -n 1 err_row3_Cko1_R2.fq.txt |awk '{print $1-7}' <br>87508348<br><span><br>#</span><span><span>#截取正确的reads</span></span><br>head -n 87508348 Cko1_R1.fq|pigz -p 4 &gt;./test/Cko1_1.fastq.gz<br>head -n 87508348 Cko1_R2.fq|pigz -p 4 &gt;./test/Cko1_2.fastq.gz<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044041" data-ratio="0.712037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SaAkVcNNILcVreUnDqiaMcukbfwPSfp5x3Gs6bX96zZX8gFEYAeYsTXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SaAkVcNNILcVreUnDqiaMcukbfwPSfp5x3Gs6bX96zZX8gFEYAeYsTXg/640?wx_fmt=png&amp;from=appmsg"><figcaption>截取正确的行</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>使用seqkit</span><span></span></h3><p data-tool="mdnice编辑器">如果了解seqkit的子命令，那么这个需求实现起来就很简单。只需要两个子命令。</p><p data-tool="mdnice编辑器"><code>sana</code> ：恢复格式错误的fastq文件</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span>Cko1_R2.fq.gz 是损坏的fastq文件</span><br><br>seqkit sana -j 4 ../Cko1_R1.fq -o rescued_Cko1_R1.fq  2&gt;err1.log<br>seqkit sana -j 4 ../Cko1_R2.fq -o rescued_Cko1_R2.fq  2&gt;err.log<br>seqkit sana -j 4 ../Cko1_R2.fq.gz -o rescued_Cko1_R2.fq.gz  2&gt;err2.log<br></code></pre><pre data-tool="mdnice编辑器"><span></span><code>ls -lha rescued_Cko1_R* |cut -d " " -f 5-<br>9.2G 9月  24 17:09 rescued_Cko1_R1.fq<br>7.6G 9月  24 16:25 rescued_Cko1_R2.fq<br>1.7G 9月  24 17:17 rescued_Cko1_R2.fq.gz<br><br>$wc -l err* rescued_Cko1_R*<br>          1 err1.log<br>   14404520 err.log<br>  106861528 rescued_Cko1_R1.fq<br>   87508348 rescued_Cko1_R2.fq<br>   <br>$zcat rescued_Cko1_R2.fq.gz|wc -l<br>87508348<br></code></pre><p data-tool="mdnice编辑器">又因为fq1，fq2文件reads数如果不一致，后续分析会报错</p><p data-tool="mdnice编辑器"><code>pair</code>: 匹配两对fastq文件中的成对reads</p><pre data-tool="mdnice编辑器"><span></span><code>seqkit pair -j 4  -1 rescued_Cko1_R1.fq -2 rescued_Cko1_R2.fq -O pair_out<br></code></pre><p data-tool="mdnice编辑器">查看结果</p><pre data-tool="mdnice编辑器"><span></span><code>$cd pair_out/<br><br>$ls -lha *.fq |cut -d " " -f 5-<br>7.6G 9月  24 17:51 rescued_Cko1_R1.fq<br>7.6G 9月  24 17:51 rescued_Cko1_R2.fq<br><br>$wc -l *.fq<br>   87508348 rescued_Cko1_R1.fq<br>   87508348 rescued_Cko1_R2.fq<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>stats 对比结果</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>seqkit stats Cko1_2.fastq.gz <br>seqkit stats Cko1_1.fastq.gz<br><br>seqkit stats rescued_Cko1_R2.fq <br>seqkit stats rescued_Cko1_R1.fq <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044047" data-ratio="0.39814814814814814" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SmtiaBESuZibycAZbGMibgCD1icExZia70HlvVbicgOrwkiaJPo66cm8tdES8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los83DMX9xrk03FGpicORibdq7SmtiaBESuZibycAZbGMibgCD1icExZia70HlvVbicgOrwkiaJPo66cm8tdES8Q/640?wx_fmt=png&amp;from=appmsg"><figcaption>两次结果对比</figcaption></figure><blockquote data-tool="mdnice编辑器"><span></span><p>更多用法示例见：</p><ul><li><section>https://bioinf.shenwei.me/seqkit/faq/</section></li></ul><p>注：对于大多数命令来说，使用四个线程已经足够快了，其中 FASTA/Q 读写是 性能瓶颈，使用更多线程不会提高速度。</p></blockquote></section><p><br></p><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section><section powered-by="xmyeditor.com" data-md5="8b46d"><img data-imgfileid="100044037" data-ratio="0.6940298507462687" data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" data-type="gif" data-w="134" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section></section></section></section></section></section><p><span></span><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533791&amp;idx=1&amp;sn=ff5e109daa321a13ba17f7ce1fabc799&amp;chksm=9b4b0464ac3c8d72ef76621230dd46e00712513637d4606895867abb7762d4032b65b085a3bd&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课10月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><strong>生信入门&amp;数据挖掘线上直播课10月班</strong></a><strong>，你的生物信息学入门课</strong></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>时隔5年，我们的生信技能树VIP学徒继续招生啦</strong></a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;chksm=9b4b2f10ac3ca606c1c4bac8cf112bb9b0f18e3c4262f5f2b8c0dba3bfedf2ba201507247005&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>2024的共享服务器交个朋友福利价仍然是800</strong></a></section><p><br></p></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/7HfI8JqJ3XyJB4aoAdIkzQ",target="_blank" rel="noopener noreferrer">原文链接</a>
