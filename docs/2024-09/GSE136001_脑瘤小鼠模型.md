---
title: "GSE136001-脑瘤小鼠模型"
date: 2024-09-13T03:53:46Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
GSE136001-脑瘤小鼠模型 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>直播简介</span><span></span></h3><p data-tool="mdnice编辑器">小谢又来整理直播预告啦，不知不觉<strong>单细胞文献阅读笔记整理到70篇咯，确实是记录了小谢的学习成长经历啦</strong>。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005686" data-ratio="1.278115501519757" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MyjSy9NSSeeX4sicbRce2jO0cAkAZzOjXU3kQQR6mthhxWom1npia649g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="658" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MyjSy9NSSeeX4sicbRce2jO0cAkAZzOjXU3kQQR6mthhxWom1npia649g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">那今天要分享的正好是第70篇文献， 那下午一起来学习一下叭！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005684" data-ratio="1.3375" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MKiczFJxbSmialdS0d5LViaHfcAYWNibP8Ewicibh30WQ9WX4P24OyrLWX7VA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="400" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MKiczFJxbSmialdS0d5LViaHfcAYWNibP8Ewicibh30WQ9WX4P24OyrLWX7VA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">对了对了，<strong>上个月在南京开了线下课，这个月底生信技能树在广州有线下课哦，主要也是单细胞数据挖掘内容，广州的朋友们可以约着见一见啦！</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005687" data-ratio="0.4444444444444444" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MbgIjka6sErFffP0nr5rkLtOn7X76U8KmeQwkdzwP1S5OT4h3ciblSww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MbgIjka6sErFffP0nr5rkLtOn7X76U8KmeQwkdzwP1S5OT4h3ciblSww/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533462&amp;idx=1&amp;sn=db7335a759233b4cea8b56c394e4171e&amp;scene=21#wechat_redirect" data-linktype="2">千呼万唤，让我们广州线下约起</a></p><h2 data-tool="mdnice编辑器"><span></span><span>文章概述</span><span></span></h2><p data-tool="mdnice编辑器"><strong>文章标题：</strong>《Single-cell RNA sequencing reveals functional heterogeneity of glioma-associated brain macrophages》</p><p data-tool="mdnice编辑器"><strong>发表日期和杂志：</strong>2021年发表在Nature Communications上</p><p data-tool="mdnice编辑器"><strong>在线阅读链接：</strong>https://doi.org/10.1073/pnas.1908576116</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>单细胞实验设计及数据详情</span><span></span></h3><p data-tool="mdnice编辑器"><strong>单细胞实验设计：</strong></p><p data-tool="mdnice编辑器">通过单细胞RNA测序（scRNA-seq）技术，分析了在雄性和雌性小鼠中生长的实验性GL261胶质瘤中的GAMs，揭示了小胶质细胞（MG）、单核细胞/巨噬细胞（Mo/MΦ）和CNS BAMs的不同转录程序。</p><p data-tool="mdnice编辑器"><strong>实验模型：</strong></p><p data-tool="mdnice编辑器">采用了<strong>小鼠同种异体GL261胶质瘤模型</strong>，因为GL261细胞建立的肿瘤能够重现人类胶质母细胞瘤（GBM）的许多特征，并且经常用于胶质瘤免疫学、免疫疗法和临床前研究。</p><p data-tool="mdnice编辑器"><strong>4组单细胞RNA测序分析：</strong></p><ul data-tool="mdnice编辑器"><li><section>雌性对照（未植入肿瘤的小鼠,2个样本）</section></li><li><section>雌性肿瘤（植入肿瘤后14天的小鼠，2个样本）</section></li><li><section>雄性对照（未植入肿瘤的小鼠,2个样本）</section></li><li><section>雄性肿瘤（植入肿瘤后14天的小鼠，2个样本）</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100005685" data-ratio="0.18191108840061318" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981Msibicn6SspDTQKOKpcwjJhTFOtttkmYcB0fia3Qic72gbQVfHUhgkibb76Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1957" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981Msibicn6SspDTQKOKpcwjJhTFOtttkmYcB0fia3Qic72gbQVfHUhgkibb76Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>数据链接是</strong>：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE136001</p><p data-tool="mdnice编辑器"><strong>单细胞样品详情</strong>：</p><pre data-tool="mdnice编辑器"><span></span><code>GSM4039241 F-ctrl-1<br>GSM4039242 F-ctrl-2<br>GSM4039243 F-tumor-1<br>GSM4039244 F-tumor-2<br>GSM4039245 M-ctrl-1<br>GSM4039246 M-ctrl-2<br>GSM4039247 M-tumor-1<br>GSM4039248 M-tumor-2<br><br></code></pre><p data-tool="mdnice编辑器"><strong>数据情况：</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005688" data-ratio="0.9755849440488301" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MAXr06bszibNNk7UqQ3Lq1pqF32c5ZnRPletrEY4FBhtBRM1ATvBUwuQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="983" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MAXr06bszibNNk7UqQ3Lq1pqF32c5ZnRPletrEY4FBhtBRM1ATvBUwuQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>提供的是10X标准格式的三文件，使用Read10X()函数读取，然后创建seurat对象进行后续的降维聚类分群</strong></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>数据读取及降维聚类分群</span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span>1. 数据读取及多样品合并</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>#数据读取</span><br>dir=<span>'GSE136001_RAW/outputs/'</span><br>samples=list.files( dir )<br>samples <br>sceList = lapply(samples,<span>function</span>(pro){ <br>  <span># pro=samples[1] </span><br>  <span>print</span>(pro)  <br>  sce =CreateSeuratObject(counts =  Read10X (file.path(dir,pro )) ,<br>                          project =  pro  ,<br>                          min.cells = 5,<br>                          min.features = 300 )<br>  <span>return</span>(sce)<br>}) <br>do.call(rbind,lapply(sceList, dim))<br>sce.all=merge(x=sceList[[1]],<br>              y=sceList[ -1 ],<br>              add.cell.ids = samples  ) <br>names(sce.all@assays<span>$RNA</span>@layers)<br>sce.all[[<span>"RNA"</span>]]<span>$counts</span><br><br><span># Alternate accessor function with the same result</span><br>LayerData(sce.all, assay = <span>"RNA"</span>, layer = <span>"counts"</span>)<br>sce.all &lt;- JoinLayers(sce.all)<br>dim(sce.all[[<span>"RNA"</span>]]<span>$counts</span> )<br> <br>as.data.frame(sce.all@assays<span>$RNA</span><span>$counts</span>[1:10, 1:2])<br>head(sce.all@meta.data, 10)<br>table(sce.all<span>$orig</span>.ident)<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>2. 质控+降维聚类分群</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code><span>###### step2: QC质控 ######</span><br>dir.create(<span>"./1-QC"</span>)<br>setwd(<span>"./1-QC"</span>)<br><span># 如果过滤的太狠，就需要去修改这个过滤代码</span><br><span>source</span>(<span>'../scRNA_scripts/qc.R'</span>)<br>sce.all.filt = basic_qc(sce.all)<br><span>print</span>(dim(sce.all))<br><span>print</span>(dim(sce.all.filt))<br>setwd(<span>'../'</span>)<br>sp=<span>'mouse'</span><br>getwd()<br><br><span>###### step3: harmony整合多个单细胞样品 ######</span><br> <br><span>if</span>(T){<br>  dir.create(<span>"2-harmony"</span>)<br>  getwd()<br>  setwd(<span>"2-harmony"</span>)<br>  <span>source</span>(<span>'../scRNA_scripts/harmony.R'</span>)<br>  <span># 默认 ScaleData 没有添加"nCount_RNA", "nFeature_RNA"</span><br>  <span># 默认的</span><br>  sce.all.int = run_harmony(sce.all.filt)<br>  setwd(<span>'../'</span>)<br>  <br>}<br><br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span></span><span>细胞亚群注释</span><span></span></h3><p data-tool="mdnice编辑器">之前有整理分享过<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247487506&amp;idx=1&amp;sn=2200b05e0fa78421fcbcc939e2e5db62&amp;scene=21#wechat_redirect" data-linktype="2">单细胞亚群注释三种方法汇总</a>以及<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247487609&amp;idx=1&amp;sn=8d2c4b12caf84c7749f71a511d534b74&amp;scene=21#wechat_redirect" data-linktype="2">基于文章metadata信息注释亚群</a></p><p data-tool="mdnice编辑器">其实如果平常我们看到文献里面有详细的分群及marker基因，也可以收集整理下来。<strong>比如这篇文章是小鼠的脑部组织，就可以参考另外一篇文章的分群情况进行注释</strong>（下期可以一起来看看这篇参考的文章hhh）</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005689" data-ratio="0.5527099463966647" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MuRb5q20lcqDVkE4X16WH1wp4N1QRggRc2eBcbslhlSxiaZa0fyn3WDA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1679" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MuRb5q20lcqDVkE4X16WH1wp4N1QRggRc2eBcbslhlSxiaZa0fyn3WDA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100005692" data-ratio="0.5866583541147132" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YiawicEib5JflP3JibrjSV981Mgx6aziadgszAqMcmHBbfA1ZwgUxvTvoJUP4dysUEa4q5ia4OiaChDfdZw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1604" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/icQem1PXnP9YiawicEib5JflP3JibrjSV981Mgx6aziadgszAqMcmHBbfA1ZwgUxvTvoJUP4dysUEa4q5ia4OiaChDfdZw/640?wx_fmt=jpeg&amp;from=appmsg"><figcaption>分群及Marker基因</figcaption></figure><h4 data-tool="mdnice编辑器"><span></span><span>1. 选择不同分辨率可视化常见marker基因</span><span></span></h4><p data-tool="mdnice编辑器">通常选择0.1和0.8的分辨率进行可视化</p><pre data-tool="mdnice编辑器"><span></span><code><span>###### step4:  看标记基因库 ######</span><br><span># 原则上分辨率是需要自己肉眼判断，取决于个人经验</span><br><span># 为了省力，我们直接看  0.1和0.8即可</span><br><br>table(Idents(sce.all.int))<br>table(sce.all.int<span>$seurat_clusters</span>)<br>table(sce.all.int<span>$RNA_snn_res</span>.0.1) <br>table(sce.all.int<span>$RNA_snn_res</span>.0.8) <br><br>getwd()<br>dir.create(<span>'check-by-0.1'</span>)<br>setwd(<span>'check-by-0.1'</span>)<br>sel.clust = <span>"RNA_snn_res.0.1"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>dir.create(<span>'check-by-0.8'</span>)<br>setwd(<span>'check-by-0.8'</span>)<br>sel.clust = <span>"RNA_snn_res.0.8"</span><br>sce.all.int &lt;- SetIdent(sce.all.int, value = sel.clust)<br>table(sce.all.int@active.ident) <br><span>source</span>(<span>'../scRNA_scripts/check-all-markers.R'</span>)<br>setwd(<span>'../'</span>) <br>getwd()<br><br>last_markers_to_check<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005693" data-ratio="0.9260143198090692" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MViciazS8fiaibrYvDq5XMYb7I9STApAS95k8LN2ZeNvshcD17houjrKa7A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MViciazS8fiaibrYvDq5XMYb7I9STApAS95k8LN2ZeNvshcD17houjrKa7A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">因为是<strong>小鼠，所以显示的基因会是第一个字母大小，别的是小写的情况</strong>。我们在最开始进行check.all.marker之前，记得要使用**sp='mouse'**指定物种</p><h4 data-tool="mdnice编辑器"><span></span><span>2. 加载可视化文章提供的注释信息</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>data &lt;- read.csv(<span>"./GSE162610.csv"</span>)<br>head(data)<br>data<span>$Keygene</span> &lt;- str_to_title(data<span>$gene</span>)<br>selected_genes = split(data<span>$Keygene</span>,data<span>$celltype</span>)<br>selected_genes<br>p3 &lt;- DotPlot(object = sce.all.int, features = selected_genes, <br>              group.by = <span>'RNA_snn_res.0.8'</span>,assay = <span>"RNA"</span>) +<br>  theme(axis.text.x = element_text(angle = 55, vjust = 0.5, hjust=0.5)<br>  )+theme(<br>    strip.text= element_text(angle = 55, vjust = 0.5, hjust=0.5)<br>  )<br>p3<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005691" data-ratio="0.8281117696867062" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981Mx4xNh8ibWVVHJIKEficsQYaUC533H0XUnOc1ANpibtFOb6SdNtwUC1JJA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1181" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981Mx4xNh8ibWVVHJIKEficsQYaUC533H0XUnOc1ANpibtFOb6SdNtwUC1JJA/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>3. 结合进行注释</span><span></span></h4><p data-tool="mdnice编辑器">使用check.all.marker对不同分辨率下的细胞亚群进行marker基因可视化之后，会得到一系列的结果，通常我们会先看<strong>last_markers_and_umap</strong>的结果图，但并不意味着别的重要</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005690" data-ratio="0.6358792184724689" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M1nEZeCu0YN52NToZQG9Jstku465PFqCqViblwcHwrIvia4AkxOJBia5jg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1126" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M1nEZeCu0YN52NToZQG9Jstku465PFqCqViblwcHwrIvia4AkxOJBia5jg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">比如我们<strong>基于last_markers_and_umap和文献的marker基因，有16、17这两个细胞亚群没办法直接注释出来，没有很明显高亮的基因</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005698" data-ratio="0.92442322991249" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M9nxpohHf08xAetNED18W7oicfWc1NB5IIz1v2ffypCc05EgaaX7UfXA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M9nxpohHf08xAetNED18W7oicfWc1NB5IIz1v2ffypCc05EgaaX7UfXA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100005696" data-ratio="0.792156862745098" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MzC7JswhO3zzjTjTnxotDYLoibthB4qebOpKWheqJsiaqJ4j7yZTP4DOg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1785" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MzC7JswhO3zzjTjTnxotDYLoibthB4qebOpKWheqJsiaqJ4j7yZTP4DOg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">这时候就需要去仔细看看别的结果，然后去命名。从髓系以及T细胞的marker基因结果中可以<strong>推断16为DC，17为NK</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100005694" data-ratio="0.45790128577353795" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M0WCzkrRZyvVU6Wu69oTBibibqJms0WE9bxBQt2327Z8lQyHUMIYpvguw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2411" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M0WCzkrRZyvVU6Wu69oTBibibqJms0WE9bxBQt2327Z8lQyHUMIYpvguw/640?wx_fmt=png&amp;from=appmsg"><figcaption>myeloids_markers</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100005695" data-ratio="0.9218500797448166" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M56dMAktvEZfhicwHykTAhNouPkqPk6gncH9LFcR3dQyvzxUAlORfAUQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1254" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981M56dMAktvEZfhicwHykTAhNouPkqPk6gncH9LFcR3dQyvzxUAlORfAUQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>Tcells_markers</figcaption></figure><p data-tool="mdnice编辑器"><strong>给细胞亚群命名</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>if</span>(T){<br>  sce.all.int <br>  <span>#定义细胞亚群        </span><br>  celltype=data.frame(ClusterID=0:20,<br>                      celltype=0:20) <br>  <span>#定义细胞亚群</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 18  ),2]=<span>'Bcells'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 12  ),2]=<span>'Tcells'</span><br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 20  ),2]=<span>'endo'</span>   <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 19 ),2]=<span>'Neutrophil'</span> <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 16 ),2]=<span>'DC'</span> <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 17 ),2]=<span>'NK'</span>  <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 0:4,6,7,9,10,15  ),2]=<span>'Microglia'</span> <br>  <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 5,11,13 ),2]=<span>'mono'</span>   <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 8 ),2]=<span>'Mac'</span>  <br>  celltype[celltype<span>$ClusterID</span> %<span>in</span>% c( 14 ),2]=<span>'Astrocyte'</span>  <br>  <br>  head(celltype)<br>  celltype<br>  table(celltype<span>$celltype</span>)<br>  sce.all.int@meta.data<span>$celltype</span> = <span>"NA"</span><br>  <br>  <span>for</span>(i <span>in</span> 1:nrow(celltype)){<br>    sce.all.int@meta.data[<span>which</span>(sce.all.int@meta.data<span>$RNA_snn_res</span>.0.8 == celltype<span>$ClusterID</span>[i]),<span>'celltype'</span>] &lt;- celltype<span>$celltype</span>[i]}<br>  Idents(sce.all.int)=sce.all.int<span>$celltype</span><br>  <br><br>}<br><br></code></pre><p data-tool="mdnice编辑器"><strong>可视化注释结果</strong></p><pre data-tool="mdnice编辑器"><span></span><code>library(tidydr)<br><br>DimPlot(sce.all.int, reduction = <span>"umap"</span>,raster = F,<br>        label = T,repel = T,cols = mycolors)  +<br>  theme_dr(xlength = 0.22, ylength = 0.22, arrow = grid::arrow(length = unit(0.15, <span>"inches"</span>), <span>type</span> = <span>"closed"</span>))+<br>  theme(panel.grid = element_blank())<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100005697" data-ratio="0.8235779060181369" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MSxQnZ7nHF0ClgIexlIOwsJMCXBM40wjS5QcvVUGqgv6d3RPyaos7ibA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1213" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9YiawicEib5JflP3JibrjSV981MSxQnZ7nHF0ClgIexlIOwsJMCXBM40wjS5QcvVUGqgv6d3RPyaos7ibA/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/itIsDI6muLuWrtkFa1PckA",target="_blank" rel="noopener noreferrer">原文链接</a>
