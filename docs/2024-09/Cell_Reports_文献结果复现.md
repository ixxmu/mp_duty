---
title: "Cell Reports 文献结果复现"
date: 2024-09-11T05:45:34Z
draft: ["false"]
tags: [
  "fetched",
  "老俊俊的生信笔记"
]
categories: ["Acdemic"]
---
Cell Reports 文献结果复现 by 老俊俊的生信笔记
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><section><mp-common-profile data-pluginname="mpprofile" data-id="MzkyMTI1MTYxNA==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usezgsqIGqjITSMggCTSoViaYeoKe2xoZr1IIvNJoztibQxibYHLDDoiabwAc6Ggws3Tvdo8EPss2nLgaVQ/0?wx_fmt=png" data-nickname="老俊俊的生信笔记" data-alias="JunJunLab" data-signature="老俊俊的生信技能和知识分享,我不是巨人,但你可以站在我的肩膀上更进一步!" data-from="0" data-is_biz_ban="0"></mp-common-profile></section></section><section><mp-common-clmusic data-pluginname="insertaudio" type="1" music_name="%E8%B0%81%E6%98%8E%E6%B5%AA%E5%AD%90%E5%BF%83" albumurl="http://wx.y.gtimg.cn/music/photo_new/T002R500x500M000003mwGsZ4OHBk4_4.jpg" singer="王杰" duration="301000" username="" music_source="1" is_vip="1" listenid="78221634042953856"></mp-common-clmusic></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>引言</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>摘要：</strong> 这项研究调查了泛素结合酶 Rad6 在调节氧化应激期间翻译的作用。研究人员使用核糖体测序(Ribo-seq)和 RNA 测序来表征野生型(WT)和 <strong>rad6Δ</strong> 酵母细胞在氧化应激条件下的翻译景观。他们发现,氧化应激会导致核糖体在特定的氨基酸序列上暂停,特别是那些含有 <strong>异亮氨酸-脯氨酸(XIP)序列的序列</strong>, 这种情况需要 Rad6 的参与。这种 "<strong>氧化还原暂停</strong>" 特征在缺乏 Rad6 的情况下基本消失,表明 Rad6 介导的 <strong>泛素化</strong> 是这种翻译调节所需的。进一步分析表明,Rad6 影响翻译的方式独立于核糖体相关质量控制(RQC)通路,并导致整合应激反应(ISR)通路的激活发生变化。总的来说,这项研究揭示了 Rad6 如何在应对氧化应激时重塑翻译景观的关键机制。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031204" data-ratio="0.7722513089005235" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NPDq2y8fOGO88pOFENUZFEFatj5Oib5K5CT2U9IUsdLjEQS4iaRfk7vsw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="764" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NPDq2y8fOGO88pOFENUZFEFatj5Oib5K5CT2U9IUsdLjEQS4iaRfk7vsw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>机制图：</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031207" data-ratio="0.36827195467422097" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NqicuyodbwmJiaFLCkmo8Ijib87AXUsctyskAiax5ArKfdgWqKkRwOBwk0Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1059" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NqicuyodbwmJiaFLCkmo8Ijib87AXUsctyskAiax5ArKfdgWqKkRwOBwk0Q/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>我们尝试分析一下这篇文章的数据。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><pre data-tool="mdnice编辑器"><span></span><code><span># install.packages("devtools")</span><br>devtools::install_github(<span>"junjunlab/RiboProfiler"</span>)<br><br><span># or</span><br>remotes::install_github(<span>"junjunlab/RiboProfiler"</span>)<br><br><span>library</span>(RiboProfiler)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>下载数据</span><span></span></h2><p data-tool="mdnice编辑器">直接 <strong>ascp</strong> 下载，下载后修改一下文件名称，<strong>sra-exploer</strong> 下载一下放后台就行了：</p><pre data-tool="mdnice编辑器"><span></span><code>#!/usr/bin/env bash<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR236/023/SRR23617123/SRR23617123.fastq.gz . &amp;&amp; mv SRR23617123.fastq.gz SRR23617123_GSM7062915_SUB280_WT_rep1_SM061F_Saccharomyces_cerevisiae_OTHER.fastq.gz<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR236/021/SRR23617121/SRR23617121.fastq.gz . &amp;&amp; mv SRR23617121.fastq.gz SRR23617121_GSM7062917_SUB280_WT_peroxide_rep1_SM062F_Saccharomyces_cerevisiae_OTHER.fastq.gz<br>ascp -QT -l 300m -P33001 -i $HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:vol1/fastq/SRR236/020/SRR23617120/SRR23617120.fastq.gz . &amp;&amp; mv SRR23617120.fastq.gz SRR23617120_GSM7062918_SUB280_WT_peroxide_rep2_SM072F_Saccharomyces_cerevisiae_OTHER.fastq.gz<br>...<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>去接头</span><span></span></h2><p data-tool="mdnice编辑器">文章上游数据处理部分：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031206" data-ratio="0.22990492653414002" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NRLrxnaITWzqwxnAWTkDFkQ0s0AT1P6vv5slichibkyicxnyPqGbXmetdQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1157" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NRLrxnaITWzqwxnAWTkDFkQ0s0AT1P6vv5slichibkyicxnyPqGbXmetdQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">他这里是含有 <strong>UMI</strong> 序列的，文章没有给代码，找了该作者以前发的文章才了解测序结构：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031205" data-ratio="0.6208791208791209" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NVCepXib6fxUpQicCxxXJuZ7purlf5GdFuG1OwicBvS3qEnYgkAS567mYA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1274" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NVCepXib6fxUpQicCxxXJuZ7purlf5GdFuG1OwicBvS3qEnYgkAS567mYA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031203" data-ratio="0.544054747647562" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N8gwxnxTkE8c9ic8ZQPHemAxiaHxJlrIKKLrRxiau1Y6xpagYDh3giazEkg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1169" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N8gwxnxTkE8c9ic8ZQPHemAxiaHxJlrIKKLrRxiau1Y6xpagYDh3giazEkg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">下面是文章里提供的信息：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031210" data-ratio="0.43558282208588955" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N6fB8RE8bQswDTAA68HILkoarcSYRE8pR14FqjnWa5H6XD6hpicNj8lw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1141" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N6fB8RE8bQswDTAA68HILkoarcSYRE8pR14FqjnWa5H6XD6hpicNj8lw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>注意作者上传 GEO 里面是这样描写的，注意红框内容：</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031208" data-ratio="0.4331140350877193" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NoOQz9iaplJdficJkPRN2mvqdvxTUibCh9U5oJqRO9ySBbJ0JewvIkSd9w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="912" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NoOQz9iaplJdficJkPRN2mvqdvxTUibCh9U5oJqRO9ySBbJ0JewvIkSd9w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">接着就可以去接头了：</p><pre data-tool="mdnice编辑器"><span></span><code>for i in SUB280_WT_rep1_F SUB280_WT_rep2_F SUB280_WT_peroxide_rep1_F SUB280_WT_peroxide_rep2_F SUB280_rad6_rep1_F SUB280_rad6_rep2_F SUB280_rad6_peroxide_rep1_F SUB280_rad6_peroxide_rep2_F SUB280_hel2_F SUB280_hel2_peroxide_F SUB280_rad6_RAD6_F SUB280_rad6_RAD6_peroxide_F SUB280_rad6_RAD6_C88A_F SUB280_rad6_RAD6_C88A_peroxide_F S288C_WT_F S288C_WT_peroxide_F S288C_rad6_F S288C_rad6_peroxide_F SUB280_WT_rep1_Fd SUB280_WT_rep2_Fd SUB280_WT_peroxide_rep1_Fd SUB280_WT_peroxide_rep2_Fd SUB280_rad6_Fd SUB280_rad6_peroxide_Fd<br>do<br>        cutadapt -j 20 -u 2 -u -5 -o ./${i}_trim.fq.gz ../1.raw-data/${i}.fastq.gz<br>done<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>去除 rRNA</span><span></span></h2><p data-tool="mdnice编辑器">去 NCBI 等相关网站下载酵母的 <strong>rRNA</strong> 序列，然后用 <strong>bowtie2</strong> 建索引，然后就可以去除了：</p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span> trim rRNA</span><br>for i in SUB280_WT_rep1_F SUB280_WT_rep2_F SUB280_WT_peroxide_rep1_F SUB280_WT_peroxide_rep2_F SUB280_rad6_rep1_F SUB280_rad6_rep2_F SUB280_rad6_peroxide_rep1_F SUB280_rad6_peroxide_rep2_F SUB280_hel2_F SUB280_hel2_peroxide_F SUB280_rad6_RAD6_F SUB280_rad6_RAD6_peroxide_F SUB280_rad6_RAD6_C88A_F SUB280_rad6_RAD6_C88A_peroxide_F S288C_WT_F S288C_WT_peroxide_F S288C_rad6_F S288C_rad6_peroxide_F SUB280_WT_rep1_Fd SUB280_WT_rep2_Fd SUB280_WT_peroxide_rep1_Fd SUB280_WT_peroxide_rep2_Fd SUB280_rad6_Fd SUB280_rad6_peroxide_Fd<br>do<br>        bowtie2 -p 20 -x ../../index-data/sac-rRNA-index/Saccharomyces-cerevisiae-rRNA \<br>                --un-gz ${i}.rmrRNA.fq.gz \<br>                -U ../2.trim-data/${i}_trim.fq.gz \<br>                -S ./null<br>done<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>比对到基因组</span><span></span></h2><p data-tool="mdnice编辑器">去 <strong>ensembl</strong> 网站下载酵母的基因组和注释文件建立索引：</p><pre data-tool="mdnice编辑器"><span></span><code>STAR --runThreadN 15 \<br>     --runMode genomeGenerate \<br>     --genomeDir sac-star-genome-index/ \<br>     --genomeFastaFiles ./Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa \<br>     --sjdbGTFfile Saccharomyces_cerevisiae.R64-1-1.112.gtf<br></code></pre><p data-tool="mdnice编辑器">你也可以去专门酵母的网站（ <strong>https://www.yeastgenome.org/</strong> ）：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031212" data-ratio="0.4507429829389103" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NKovictKu3hgtKFFfTYVsSxoEHNx7CYFpTR9SjBkydsQFeWtiarbG16Ng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1817" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NKovictKu3hgtKFFfTYVsSxoEHNx7CYFpTR9SjBkydsQFeWtiarbG16Ng/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">选择 <strong>download</strong>：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031211" data-ratio="0.4411764705882353" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NSa9W2uKCOEHZGrMDtyOlS6LNkuibgsN0dsnUxONbRusa1rZSiaueiagyg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1700" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NSa9W2uKCOEHZGrMDtyOlS6LNkuibgsN0dsnUxONbRusa1rZSiaueiagyg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>比对：</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span> map to genome</span><br>for i in SUB280_WT_rep1_F SUB280_WT_rep2_F SUB280_WT_peroxide_rep1_F SUB280_WT_peroxide_rep2_F SUB280_rad6_rep1_F SUB280_rad6_rep2_F SUB280_rad6_peroxide_rep1_F SUB280_rad6_peroxide_rep2_F SUB280_hel2_F SUB280_hel2_peroxide_F SUB280_rad6_RAD6_F SUB280_rad6_RAD6_peroxide_F SUB280_rad6_RAD6_C88A_F SUB280_rad6_RAD6_C88A_peroxide_F S288C_WT_F S288C_WT_peroxide_F S288C_rad6_F S288C_rad6_peroxide_F SUB280_WT_rep1_Fd SUB280_WT_rep2_Fd SUB280_WT_peroxide_rep1_Fd SUB280_WT_peroxide_rep2_Fd SUB280_rad6_Fd SUB280_rad6_peroxide_Fd<br>do<br>        STAR --runThreadN 20 \<br>         --outFilterType Normal \<br>         --alignEndsType EndToEnd \<br>         --outFilterMismatchNmax 1 \<br>         --outFilterMultimapNmax 1 \<br>         --genomeDir ../../index-data/sac-star-genome-index \<br>         --readFilesCommand gunzip -c \<br>         --readFilesIn ../3.rmrRNA-data/${i}.rmrRNA.fq.gz \<br>         --outFileNamePrefix ./${i} \<br>         --outSAMtype BAM SortedByCoordinate \<br>         --quantMode GeneCounts \<br>         --outSAMattributes All<br>done<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>riboseq 质量控制分析</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>和我们之前介绍的 <a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514724&amp;idx=1&amp;sn=ffa1b198b257bbf52bc489b5dd42f1ea&amp;chksm=c1848015f6f309037000d72fed4718195be97c6e6e7b45e0d1b8c06690465b4c90ba3c90c890&amp;token=1671225249&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Ribo-SEQ 数据质量评估</a> 一样，好的数据质量才好往下进行分析。整体上看，这篇文章的测序质量还是非常不错的，非常符合 <strong>ribo-seq</strong> 的特征指标。</p></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>准备注释文件</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>酵母<strong>UTR</strong>很少，对 <strong>CDS</strong> 两端延长 <strong>50nt</strong> 的长度作为 <strong>UTR</strong>：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># devtools::install_github("junjunlab/RiboProfiler",force = T)</span><br><br><span>library</span>(RiboProfiler)<br><br><span># ==============================================================================</span><br><span># 1_prepare gene annotation file</span><br><span># ==============================================================================</span><br>pre_longest_trans_info(gtf_file = <span>"../../index-data/Saccharomyces_cerevisiae.R64-1-1.112.gtf"</span>,<br>                       out_file = <span>"longest_info.txt"</span>)<br><br><span># extend CDS</span><br>df_extend &lt;- gene_anno_extend(longest_trans_file = <span>"longest_info.txt"</span>,<br>                              upstream_extend = <span>50</span>,<br>                              downstream_extend = <span>50</span>,<br>                              output_file = <span>"longest_info_extend.txt"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>获得质控数据</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这里我们保持和文章一致，使用 <strong>read 的 3‘end</strong> 来进行分析，因为文章测了 <strong>monosome（单核糖体）</strong> 和 <strong>disome（二核糖体）</strong> 两种测序，我们把数据分开来保存一下：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># ==============================================================================</span><br><span># 2_prepare Ribo QC data</span><br><span># ==============================================================================</span><br>bam_file = list.files(<span>"../4.map-data/"</span>,pattern = <span>".bam$"</span>,full.names = <span>TRUE</span>)<br>bam_file<br><br>sample_name &lt;- sapply(strsplit(list.files(<span>"../4.map-data/"</span>,pattern = <span>".bam$"</span>),<br>                               split = <span>"Aligned.sortedByCoord.out.bam"</span>), <span>"["</span>,<span>1</span>)<br>sample_name<br><span># [1] "S288C_rad6_F"                     "S288C_rad6_peroxide_F"</span><br><span># [3] "S288C_WT_F"                       "S288C_WT_peroxide_F"</span><br><span># [5] "SUB280_hel2_F"                    "SUB280_hel2_peroxide_F"</span><br><span>...</span><br><br><span># error files</span><br><span># 16 "SUB280_rad6_rep2_F" 21 "SUB280_WT_rep1_F"</span><br><br><span># perform QC analysis</span><br>pre_qc_data(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>            bam_file = bam_file,<br>            out_file = paste(sample_name,<span>".qc.txt"</span>,sep = <span>""</span>),<br>            mapping_type = <span>"genome"</span>,<br>            assignType = <span>"end3"</span>,<br>            seq_type = <span>"singleEnd"</span>)<br><br><span># load qc data</span><br>qc_df &lt;- load_qc_data()<br><br>qc_df$length &lt;- factor(qc_df$length)<br><br><span># filter monosome and disome</span><br>disome &lt;- qc_df %&gt;%<br>  dplyr::filter(endsWith(sample,<span>"_Fd"</span>))<br><br><span># save data</span><br>save(disome,file = <span>"disome.rda"</span>)<br><br>monosome &lt;- qc_df %&gt;%<br>  dplyr::filter(!endsWith(sample,<span>"_Fd"</span>))<br><br><span># save data</span><br>save(monosome,file = <span>"monosome.rda"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>质控指标</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>monosome</strong> 和 <strong>disome</strong> 的我们都看看：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># length distribution 8x20</span><br>qc_plot(qc_data = monosome,type = <span>"length"</span>,<br>        facet_wrap_list = list(ncol = <span>6</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031209" data-ratio="0.36895963615690736" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N9A80cyVpVSXkGuibrmogrvPKDe398niaucPhDuPhFyf9TV5mibmQyaTww/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1759" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N9A80cyVpVSXkGuibrmogrvPKDe398niaucPhDuPhFyf9TV5mibmQyaTww/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 5x12</span><br>qc_plot(qc_data = disome,type = <span>"length"</span>,<br>        facet_wrap_list = list(ncol = <span>3</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031215" data-ratio="0.4259763851044505" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NTFuCLia4Uj69abwzZVgB6IOquQn3dnicXgcdb322zLAo6v000A4qMPwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1101" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NTFuCLia4Uj69abwzZVgB6IOquQn3dnicXgcdb322zLAo6v000A4qMPwA/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># length with frame 8x20</span><br>qc_plot(qc_data = monosome,<br>        type = <span>"length_frame"</span>,<br>        facet_wrap_list = list(ncol = <span>6</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031214" data-ratio="0.40370370370370373" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NmNgibBibzoEF5AwbuVkgosx41L5swTUkQGsHeBHbOPK3zic85nu7rQJnw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1620" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NmNgibBibzoEF5AwbuVkgosx41L5swTUkQGsHeBHbOPK3zic85nu7rQJnw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 5x12</span><br>qc_plot(qc_data = disome,<br>        type = <span>"length_frame"</span>,<br>        facet_wrap_list = list(ncol = <span>3</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031217" data-ratio="0.4232394366197183" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NwjNOsjhDV9LQwdkXnC3Mjb28FNx41wYvvwZHpT7HNHEiaFdYfE9iblRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1420" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NwjNOsjhDV9LQwdkXnC3Mjb28FNx41wYvvwZHpT7HNHEiaFdYfE9iblRQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># region features 10x20</span><br>qc_plot(qc_data = monosome,<br>        type = <span>"feature"</span>,<br>        facet_wrap_list = list(ncol = <span>6</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031216" data-ratio="0.5049180327868853" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NcneJ0OLicN5khoOAibw6lm4pPhbuRFYA2TN4exsZ8X8ibBg2tUcEULAiaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1220" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NcneJ0OLicN5khoOAibw6lm4pPhbuRFYA2TN4exsZ8X8ibBg2tUcEULAiaA/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 5x20</span><br>qc_plot(qc_data = disome,<br>        type = <span>"feature"</span>,<br>        facet_wrap_list = list(ncol = <span>6</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031213" data-ratio="0.26557377049180325" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N87ibK8wJQAO6rQCicWyianLIY1n66UMCA70zMht7C4GpCMiaYZmBd3aRBA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1220" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N87ibK8wJQAO6rQCicWyianLIY1n66UMCA70zMht7C4GpCMiaYZmBd3aRBA/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># relative to start/stop site 8x20</span><br>rel_to_start_stop(qc_data = monosome,<br>                  type = <span>"relst"</span>,<br>                  facet_wrap_list = list(ncol = <span>6</span>,scales = <span>"free"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031221" data-ratio="0.407521578298397" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbWNOVB3pbRZhB6500l7F6s3D1EISB0RkX87yicj0pNotS52SneOiaryQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1622" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbWNOVB3pbRZhB6500l7F6s3D1EISB0RkX87yicj0pNotS52SneOiaryQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 5x12</span><br>rel_to_start_stop(qc_data = disome,<br>                  type = <span>"relst"</span>,<br>                  dist_range = c(-<span>50</span>,<span>250</span>),<br>                  facet_wrap_list = list(ncol = <span>3</span>,scales = <span>"free"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031218" data-ratio="0.42495479204339964" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NrJmeHWKJ7JdeBJzqsELmA3F690pc5mHOSn4uKFxo4ZeQtz0eGaiaaSg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1106" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NrJmeHWKJ7JdeBJzqsELmA3F690pc5mHOSn4uKFxo4ZeQtz0eGaiaaSg/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 8x20</span><br>rel_to_start_stop(qc_data = monosome,<br>                  type = <span>"relsp"</span>,<br>                  facet_wrap_list = list(ncol = <span>6</span>,scales = <span>"free"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031220" data-ratio="0.41551020408163264" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaBMQ6IyqjH1TKeqRPcfgg6zS99lCJODLyts1hTVQhUpwdsbgxHAibPQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1225" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaBMQ6IyqjH1TKeqRPcfgg6zS99lCJODLyts1hTVQhUpwdsbgxHAibPQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># 5x12</span><br>rel_to_start_stop(qc_data = disome,<br>                  type = <span>"relsp"</span>,<br>                  dist_range = c(-<span>250</span>,<span>50</span>),<br>                  facet_wrap_list = list(ncol = <span>3</span>,scales = <span>"free"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031219" data-ratio="0.42818181818181816" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NfRSak3Le0ficSNhnofV6UdiaAXCrEficQoVdNU9u2WuW2CUU854HxVicag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1100" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NfRSak3Le0ficSNhnofV6UdiaAXCrEficQoVdNU9u2WuW2CUU854HxVicag/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>offset 检测</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p>看看不同长度片段的 offset 情况：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code><span># ==============================================================================</span><br><span># offset check</span><br><span># ==============================================================================</span><br><span># offset check</span><br>offset_momo &lt;- PsiteOffsetCheck(qc_data = monosome,<br>                                relative_distance = c(-<span>25</span>,<span>25</span>),<br>                                read_length = c(<span>25</span>,<span>34</span>))<br>offset_momo$plot<br>offset_momo$summary_offset<br><span>#                               sample                                readLengths                                    Offsets</span><br><span># 1                       S288C_rad6_F     25, 26, 27, 28, 29, 30, 31, 32, 33, 34     15, 15, 15, 15, 15, 15, 15, 21, 23, 25</span><br><span># 11             S288C_rad6_peroxide_F     25, 26, 27, 28, 29, 30, 31, 32, 33, 34     15, 15, 15, 15, 15, 15, 25, 17, 23, 25</span><br><span># 21                        S288C_WT_F     25, 26, 27, 28, 29, 30, 31, 32, 33, 34     15, 15, 15, 15, 15, 15, 25, 21, 23, 25</span><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031222" data-ratio="0.26059564719358536" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NicefGibxur0584eS1icS1QPIz0aJcOpngO4OUn4jGPqpRqEW5a8RY7tlQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1746" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NicefGibxur0584eS1icS1QPIz0aJcOpngO4OUn4jGPqpRqEW5a8RY7tlQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>offset_disome &lt;- PsiteOffsetCheck(qc_data = disome,<br>                                  relative_distance = c(-<span>10</span>,<span>70</span>),<br>                                  read_length = c(<span>57</span>,<span>63</span>))<br>offset_disome$plot<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031227" data-ratio="0.4083469721767594" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NnZtqHsxiaKmpbfIRv53Ioz7EIcchwTDfIwIDqjW19647BgxLDYT3icRw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1222" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NnZtqHsxiaKmpbfIRv53Ioz7EIcchwTDfIwIDqjW19647BgxLDYT3icRw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>计算校正和标准化的数据</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>根据文章说明，对特定长度的 <strong>reads</strong> 保留分析，使用 <strong>15nt</strong> 的 <strong>offset</strong> 来校正：</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031226" data-ratio="0.21450858034321374" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N5sjn33XBOkVMAj6LYOuByQcwAnG5DicL1sFMPoX8nSTq8sEItBiaLBgQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1282" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N5sjn33XBOkVMAj6LYOuByQcwAnG5DicL1sFMPoX8nSTq8sEItBiaLBgQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># ==============================================================================</span><br>offset_momo &lt;- PsiteOffsetCheck(qc_data = monosome,<br>                                relative_distance = c(-<span>25</span>,<span>25</span>),<br>                                read_length = c(<span>25</span>,<span>34</span>))<br><br>offset_momo_shift &lt;- offset_momo$summary_offset<br>offset_momo_shift$Offsets &lt;- c(<span>"15,15,15,15,15,15,15,15,15,15"</span>)<br><br><span># adjust offset</span><br>adjusted_offset_mono &lt;- adjust_offset(offset_df = offset_momo_shift,<br>                                      qc_df = monosome)<br><br><span># get normalized data</span><br>mono_norm_df &lt;- get_nomalized_counts(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                                     qc_df = adjusted_offset_mono,<br>                                     exclude_upstreamCodon = <span>5</span>,<br>                                     exclude_downstreamCodon = <span>5</span>)<br><br><span># save data</span><br>save(mono_norm_df,file = <span>"mono_norm_df.rda"</span>)<br><br><span># ==============================================================================</span><br><span># ajust offset with reads for disosome</span><br>load(<span>"disome.rda"</span>)<br><br>offset_disome &lt;- PsiteOffsetCheck(qc_data = disome,<br>                                  relative_distance = c(-<span>10</span>,<span>70</span>),<br>                                  read_length = c(<span>57</span>,<span>63</span>))<br><br>offset_disome_shift &lt;- offset_disome$summary_offset<br>offset_disome_shift$Offsets &lt;- c(<span>"15,15,15,15,15,15,15"</span>)<br><br><span># adjust offset</span><br>adjusted_offset_diso &lt;- adjust_offset(offset_df = offset_disome_shift,<br>                                      qc_df = disome)<br><br><br><span># get normalized data</span><br>diso_norm_df &lt;- get_nomalized_counts(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                                     qc_df = adjusted_offset_diso,<br>                                     exclude_upstreamCodon = <span>5</span>,<br>                                     exclude_downstreamCodon = <span>5</span>)<br><br><span># save data</span><br>save(diso_norm_df,file = <span>"diso_norm_df.rda"</span>)<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>metagene plot</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>作者发现缺失 <strong>RAD6</strong> 以后在氧化应激的条件下并不明显影响核糖体在<strong>UTR</strong> 区域的堆积。文章里的图可以看到 <strong>reads</strong> 应该是没有 <strong>shift</strong> 的，所以应该用没有 <strong>shift</strong> 的数据来分析。</p></blockquote><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>Because oxidative stress induced by peroxide was previouslyassociated with increased translation of 5' and 3' untranslatedregions (UTRs),7,13 we tested whether Rad6 impacts translationoutside of main open reading frames. Metagene analysis, performed by averaging data from genes aligned by their start orstop codons, showed modest changes in the occupancy of 5’and 3‘ UTRs with peroxide treatment in WT cells, as expected(Figures S1F–S1G). The absence of Rad6 did not affect thesetrends (Figures S1F–S1G), suggesting that Rad6 does notstrongly impact translation of UTRs under oxidative stress</strong></p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031224" data-ratio="0.614321608040201" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NAFmJz6v7iaLhw4weibRMeXd6TLqV0MEl8hiaTyfS305jMtiaCRCcpwBhIw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="796" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NAFmJz6v7iaLhw4weibRMeXd6TLqV0MEl8hiaTyfS305jMtiaCRCcpwBhIw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>此外计算 ribosome occupancy 的时候需要排除前后 15nt 的影响,所以参数 exclude_upstreamCodon 和 exclude_downstreamCodon 设置为 3：</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031223" data-ratio="0.1830065359477124" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N9YQDR3FkMakzv1pqriaE2Q9oVsTJkhOpKg3WjLn3Degz0wwcXAbO4Jg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1071" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N9YQDR3FkMakzv1pqriaE2Q9oVsTJkhOpKg3WjLn3Degz0wwcXAbO4Jg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">计算：</p><pre data-tool="mdnice编辑器"><span></span><code>qc_df &lt;- load_qc_data()<br><br><span># filter monosome and disome</span><br>mono &lt;- qc_df %&gt;%<br>  dplyr::filter(sample %<span>in</span>% c(<span>"SUB280_WT_rep1_F"</span>,<span>"SUB280_WT_rep2_F"</span>,<br>                              <span>"SUB280_WT_peroxide_rep1_F"</span>,<span>"SUB280_WT_peroxide_rep2_F"</span>,<br>                              <span>"SUB280_rad6_rep1_F"</span>,<span>"SUB280_rad6_rep2_F"</span>,<br>                              <span>"SUB280_rad6_peroxide_rep1_F"</span>,<span>"SUB280_rad6_peroxide_rep2_F"</span>)) %&gt;%<br>  dplyr::filter(length %<span>in</span>% <span>25</span>:<span>34</span>)<br><br><span># get normalized data</span><br>mono_norm_df &lt;- get_nomalized_counts(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                                     qc_df = mono,<br>                                     exclude_upstreamCodon = <span>3</span>,<br>                                     exclude_downstreamCodon = <span>3</span>)<br><br><span># add group name</span><br>mono_norm_df &lt;- mono_norm_df %&gt;%<br>  dplyr::mutate(group = dplyr::case_when(sample %<span>in</span>% c(<span>"SUB280_WT_rep1_F"</span>,<span>"SUB280_WT_rep2_F"</span>) ~ <span>"WT"</span>,<br>                                        sample %<span>in</span>% c(<span>"SUB280_WT_peroxide_rep1_F"</span>,<span>"SUB280_WT_peroxide_rep2_F"</span>) ~ <span>"WT_peroxide"</span>,<br>                                        sample %<span>in</span>% c(<span>"SUB280_rad6_rep1_F"</span>,<span>"SUB280_rad6_rep2_F"</span>) ~ <span>"Δrad6"</span>,<br>                                        sample %<span>in</span>% c(<span>"SUB280_rad6_peroxide_rep1_F"</span>,<span>"SUB280_rad6_peroxide_rep2_F"</span>) ~ <span>"Δrad6_peroxide"</span>))<br><br>save(mono_norm_df,file = <span>"mono_norm_df_noshift.rda"</span>)<br>load(<span>"mono_norm_df_noshift.rda"</span>)<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>relative to start codon</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># plot WT WT_peroxide 3x6</span><br>metagene_plot(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>              normed_file = mono_norm_df %&gt;%<br>                dplyr::filter(group %<span>in</span>% c(<span>"WT"</span>,<span>"WT_peroxide"</span>)),<br>              min_counts = <span>64</span>,<br>              min_cds_length = <span>600</span>,<br>              relative_distance = c(-<span>20</span>,<span>80</span>),<br>              collapse = <span>T</span>,<br>              mode = <span>"nt"</span>) +<br>  ggplot2::scale_color_manual(values = c(<span>"WT"</span> = <span>"black"</span>,<span>"WT_peroxide"</span> = <span>"#0099CC"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031225" data-ratio="0.5155195681511471" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9Nk4ug6M4SdLTxicY34sRffNFXzO6RUHPiaM5G1ltW2VG4hFVbOxuAoVwA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="741" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9Nk4ug6M4SdLTxicY34sRffNFXzO6RUHPiaM5G1ltW2VG4hFVbOxuAoVwA/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code><span># plot Δrad6 Δrad6_peroxide 3x6</span><br>metagene_plot(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>              normed_file = mono_norm_df %&gt;%<br>                dplyr::filter(group %<span>in</span>% c(<span>"Δrad6"</span>,<span>"Δrad6_peroxide"</span>)),<br>              min_counts = <span>64</span>,<br>              min_cds_length = <span>600</span>,<br>              relative_distance = c(-<span>20</span>,<span>80</span>),<br>              collapse = <span>T</span>,<br>              mode = <span>"nt"</span>) +<br>  ggplot2::scale_color_manual(values = c(<span>"Δrad6"</span> = <span>"black"</span>,<span>"Δrad6_peroxide"</span> = <span>"#993399"</span>))<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031229" data-ratio="0.5204918032786885" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NdwBJXvPyOuOyjh1LbQiaSIoLfqQpxShq7dPwqg1xDZCytd0nyiaKs0yg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="732" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NdwBJXvPyOuOyjh1LbQiaSIoLfqQpxShq7dPwqg1xDZCytd0nyiaKs0yg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>relative to stop codon</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>metagene_plot(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>              normed_file = mono_norm_df %&gt;%<br>                dplyr::filter(group %<span>in</span>% c(<span>"WT"</span>,<span>"WT_peroxide"</span>)),<br>              min_counts = <span>64</span>,<br>              min_cds_length = <span>600</span>,<br>              type = <span>"sp"</span>,<br>              relative_distance = c(-<span>60</span>,<span>40</span>),<br>              collapse = <span>T</span>,<br>              mode = <span>"nt"</span>) +<br>  ggplot2::scale_color_manual(values = c(<span>"WT"</span> = <span>"black"</span>,<span>"WT_peroxide"</span> = <span>"#0099CC"</span>)) +<br>  ggplot2::ylim(<span>0</span>,<span>15</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031230" data-ratio="0.5181208053691275" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbszGfboaQ0TCmic4sn0kE40icY8VwcJibEiaxCCTak1ibgnRnxoaKicyAK0Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="745" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbszGfboaQ0TCmic4sn0kE40icY8VwcJibEiaxCCTak1ibgnRnxoaKicyAK0Q/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>metagene_plot(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>              normed_file = mono_norm_df %&gt;%<br>                dplyr::filter(group %<span>in</span>% c(<span>"Δrad6"</span>,<span>"Δrad6_peroxide"</span>)),<br>              min_counts = <span>64</span>,<br>              min_cds_length = <span>600</span>,<br>              type = <span>"sp"</span>,<br>              relative_distance = c(-<span>60</span>,<span>40</span>),<br>              collapse = <span>T</span>,<br>              mode = <span>"nt"</span>) +<br>  ggplot2::scale_color_manual(values = c(<span>"Δrad6"</span> = <span>"black"</span>,<span>"Δrad6_peroxide"</span> = <span>"#993399"</span>)) +<br>  ggplot2::ylim(<span>0</span>,<span>15</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031232" data-ratio="0.5278154681139756" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NqPmSd3CWe4hgW5utbWTeymYibBCiakLfbibmYp7ZxbunlnWFQGwib74l4g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="737" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NqPmSd3CWe4hgW5utbWTeymYibBCiakLfbibmYp7ZxbunlnWFQGwib74l4g/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>gene track plot</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>作者发现在 <strong>RAD6</strong> 缺失后，氧化应激下在某些特定三肽基序 <strong>XIP</strong> 位点的核糖体停滞现象发生了丢失，文章举例了 <strong>SKI2 和 PCF11 两个基因</strong>，图里标注了暂停的基序：</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031231" data-ratio="0.39332365747460085" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NrUKvV54aBV3xqAYMhOJ2S21yibHacAN54QEu8KQj2axg4auvSQQtm8Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="689" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NrUKvV54aBV3xqAYMhOJ2S21yibHacAN54QEu8KQj2axg4auvSQQtm8Q/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031228" data-ratio="0.53" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NPXTDDIUtNbFuAsygIFasSmibrKpicVLAeJ2uDYkh2lTO1a5N0u40g5fw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="500" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NPXTDDIUtNbFuAsygIFasSmibrKpicVLAeJ2uDYkh2lTO1a5N0u40g5fw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>track plot：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"mono_norm_df.rda"</span>)<br><br><span># filter samples</span><br>track_data &lt;- mono_norm_df %&gt;%<br>  dplyr::filter(sample %<span>in</span>% c(<span>"SUB280_WT_peroxide_rep1_F"</span>,<span>"SUB280_WT_peroxide_rep2_F"</span>,<br>                              <span>"SUB280_rad6_peroxide_rep1_F"</span>,<span>"SUB280_rad6_peroxide_rep2_F"</span>))<br><br>track_df &lt;- get_track_df(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                         select_gene = c(<span>"SKI2"</span>,<span>"PCF11"</span>),<br>                         normed_file = track_data)<br><br><span># 5x10</span><br>track_plot(signal_data = track_df,<br>           show_ribo_only = <span>T</span>,<br>           gene_anno = <span>"longest_info_extend.txt"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031236" data-ratio="0.6015200868621065" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N4v31RgIicvaBOx3ZZVn3x5TlhxdroJn9Cek3m7PPvicR27aHsqLEFFgw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="921" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N4v31RgIicvaBOx3ZZVn3x5TlhxdroJn9Cek3m7PPvicR27aHsqLEFFgw/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>我们可以检查一下最高的位置处的基序：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>tmp &lt;- track_df %&gt;% dplyr::filter(gene_name == <span>"PCF11"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031234" data-ratio="0.3350189633375474" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NIdEeLYq3s92n27JLZjFI5vBk9j5cVj1E9UXl6lB9be3ibBFa3TWVicdA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="791" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NIdEeLYq3s92n27JLZjFI5vBk9j5cVj1E9UXl6lB9be3ibBFa3TWVicdA/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>最高的位置处为 <strong>1140</strong> 位置，<strong>减去 50nt 5’UTR</strong>，然后 <strong>除以 3</strong> 等于 <strong>364</strong> 处的 <strong>codon</strong>，<strong>然后加上末尾 8 个空字符，最终是 372</strong>，可以看到刚好是 <strong>KIP</strong> 的 <strong>I</strong> 基序处：</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031235" data-ratio="0.21253731343283583" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NePFQpPz3BheeL6ichyxs38DJMmVfiaS0qMgsyIoSAiaiaJhrcXRLRmBdsg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1675" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NePFQpPz3BheeL6ichyxs38DJMmVfiaS0qMgsyIoSAiaiaJhrcXRLRmBdsg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>tri amino acid pause score</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这里我尝试使用之前的方式来计算 <a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514539&amp;idx=1&amp;sn=cc75df14200d88888cb0608cb4593105&amp;chksm=c18483daf6f30acc5b35e760bac97ae82aed5379bdb8685ada3aaff5ec1e6bc8c77a559c9595&amp;token=1671225249&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">计算 Ribosome 距离二肽/三肽基序距离的密度</a> 发现结果和文章相差还挺大的，仔细看了文章，发现算的方法不一样，只能自己按照文章的思路计算看看了。思路大概是先计算每个位置处的 <strong>rpm</strong>，然后计算这个位置上下游 <strong>50nt</strong> 左右的 <strong>average reads</strong>，这个位置处相邻的 <strong>EPA</strong> 位置所代表的基序就是 <strong>pause score</strong>。然后筛选次数大于 <strong>100</strong> 次的来分析，去除噪音。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031233" data-ratio="0.7069351230425056" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NicSvKAU6ck2BTM4SL2iaJjGMSPaL7x7V5Zz5FXzz9NNQKjCGxInuvNNw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="447" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NicSvKAU6ck2BTM4SL2iaJjGMSPaL7x7V5Zz5FXzz9NNQKjCGxInuvNNw/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><strong>(D) Schematics for calculation of pause score, computed by dividing reads at a motif by the average reads in a window around the motif of interest (±50 nt). We calculated pause score at tri-amino acid motifs that map to the ribosomal E (penultimate position of the nascent peptide), P, and A sites.</strong></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100031237" data-ratio="0.116" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NDnpDHAZnpcAuvQGm5v6XZj1zGrmwMsO8F108Wn2302AiaS6yyxsLpJQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1250" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NDnpDHAZnpcAuvQGm5v6XZj1zGrmwMsO8F108Wn2302AiaS6yyxsLpJQ/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031238" data-ratio="0.14399363564041368" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NNLkNLbQt70GT2JztAIp6RgfFogQc8d6nGk7NRu3XibdMJNcibeXYEs5Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1257" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NNLkNLbQt70GT2JztAIp6RgfFogQc8d6nGk7NRu3XibdMJNcibeXYEs5Q/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p>这也是文章的第一张主图，通过 <strong>Ribo-seq</strong> 测序发现缺失 <strong>RAD6</strong> 后，在某些 <strong>XIP</strong> 基序氧化应激条件下的核糖体停滞现象消失或者明显减弱了。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031242" data-ratio="0.39497907949790795" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NgYRrOXKNPYZ1G21uvLLADMJu1odh2onVJ94asuhbWsB5r5qqJAa4Nw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1195" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NgYRrOXKNPYZ1G21uvLLADMJu1odh2onVJ94asuhbWsB5r5qqJAa4Nw/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">大概是这样的：</p><pre data-tool="mdnice编辑器"><span></span><code><span>###########################################################################################</span><br><span># 4_get motif pause score in window</span><br><span>###########################################################################################</span><br>pause_score = {}<br><span>with</span> open(input_file,<span>'r'</span>) <span>as</span> input:<br>    <span>for</span> line <span>in</span> input:<br>        _,_,_,_,_,_,trans_pos,trans_id,counts,_,_,exp = line.split()<br>        utr5,cds,_ = gene_info[trans_id]<br>        cds_pos = int(trans_pos) - utr5<br><br>        <span># exclude first and last 50nt</span><br>        <span>if</span> cds_pos &gt;= window + <span>1</span> <span>and</span> cds_pos &lt;= cds - window:<br>            nt_exp = exp_whole_trans[trans_id]<br>            window_exp = nt_exp[(cds_pos - window - <span>1</span>):(cds_pos + window)]<br><br>            <span># normalize average reads in window</span><br>            average_mean = sum(window_exp)/(window + window + <span>1</span>)<br>            normalized_window_exp = [i/average_mean <span>for</span> i <span>in</span> window_exp]<br><br>            <span># get EPA tri amino acid score</span><br>            average_sum_epa = sum(normalized_window_exp[(window - <span>3</span> - <span>1</span>):(window + <span>5</span>)])<br><br>            <span># calculate codon position and get tri-amino acid motif</span><br>            <span>if</span> cds_pos%<span>3</span> == <span>0</span>:<br>                codon_pos = int(cds_pos/<span>3</span>)<br>            <span>else</span>:<br>                codon_pos = cds_pos//<span>3</span> + <span>1</span><br><br>            motif = amino.fetch(trans_id,(codon_pos - <span>1</span>,codon_pos + <span>1</span>))<br><br>            <span># save in dict</span><br>            <span>if</span> motif <span>in</span> pause_score:<br>                tmp_exp,tmp_count = pause_score[motif]<br>                pause_score[motif] = [average_sum_epa + tmp_exp,tmp_count + <span>1</span>]<br>            <span>else</span>:<br>                pause_score[motif] = [average_sum_epa,<span>1</span>]<br></code></pre><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">准备氨基酸序列：</p><pre data-tool="mdnice编辑器"><span></span><code><span># ==============================================================================</span><br><span># get sequence</span><br><span># ==============================================================================</span><br><span>library</span>(RiboProfiler)<br><br><span># extract amino acids sequnce</span><br>FetchSequence(gene_file = <span>"longest_info.txt"</span>,<br>              genome_file = <span>"Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa"</span>,<br>              output_file = <span>"sac_amino_acid.fa"</span>,<br>              type = <span>"cds"</span>,<br>              coding_type = <span>"AA"</span>)<br><span># extract cds sequnce</span><br>FetchSequence(gene_file = <span>"longest_info.txt"</span>,<br>              genome_file = <span>"Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa"</span>,<br>              output_file = <span>"sac_cds.fa"</span>,<br>              type = <span>"cds"</span>,<br>              coding_type = <span>"NT"</span>)<br></code></pre><p data-tool="mdnice编辑器">然后我们使用 <strong>peptide_motif_score2</strong> 函数来计算：</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"mono_norm_df.rda"</span>)<br><br>unique(mono_norm_df$sample)<br><br><span># filter samples</span><br>ft_data &lt;- mono_norm_df %&gt;%<br>  dplyr::filter(sample %<span>in</span>% c(<span>"SUB280_WT_rep1_F"</span>,<span>"SUB280_WT_rep2_F"</span>,<br>                              <span>"SUB280_WT_peroxide_rep1_F"</span>,<span>"SUB280_WT_peroxide_rep2_F"</span>,<br>                              <span>"SUB280_rad6_rep1_F"</span>,<span>"SUB280_rad6_rep2_F"</span>,<br>                              <span>"SUB280_rad6_peroxide_rep1_F"</span>,<span>"SUB280_rad6_peroxide_rep2_F"</span>,<br>                              <span>"SUB280_rad6_RAD6_F"</span>,<span>"SUB280_rad6_RAD6_peroxide_F"</span>,<br>                              <span>"SUB280_rad6_RAD6_C88A_F"</span>,<span>"SUB280_rad6_RAD6_C88A_peroxide_F"</span>,<br>                              <span>"S288C_WT_F"</span>,<span>"S288C_WT_peroxide_F"</span>,<br>                              <span>"S288C_rad6_F"</span>,<span>"S288C_rad6_peroxide_F"</span>))<br><br><span># calculate pause score for motif</span><br>peptide_motif_score2(amino_file = <span>"sac_amino_acid.fa"</span>,<br>                     normed_exp_file = ft_data,<br>                     longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                     norm_type = <span>"normed_count"</span>,<br>                     window = <span>50</span>,<br>                     occurrence_threshold = <span>100</span>)<br><span># S288C_rad6_F has been processed!</span><br><span># S288C_rad6_peroxide_F has been processed!</span><br><span>...</span><br></code></pre><p data-tool="mdnice编辑器">然后绘图可视化（<strong>感觉没有文章里的那么明显和点那么分散</strong>）：</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br><span>library</span>(patchwork)<br><br>p1 &lt;-<br>triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_WT_rep1_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_WT_rep2_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_WT_peroxide_rep1_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_WT_peroxide_rep2_F_tripeptide_occupancy.txt"</span>),<br>                     sample_name = c(<span>"WT-rep1"</span>,<span>"WT-rep2"</span>,<span>"WT-peroxide-rep1"</span>,<span>"WT-peroxide-rep2"</span>),<br>                     group_name = c(<span>"WT"</span>,<span>"WT"</span>,<span>"WT + peroxide"</span>,<span>"WT + peroxide"</span>),<br>                     mark_motif = c(<span>"KIP"</span>,<span>"MIP"</span>,<span>"QIP"</span>,<span>"KIH"</span>,<span>"EIH"</span>,<br>                                    <span>"RKK"</span>,<span>"PPD"</span>,<span>"PPE"</span>),<br>                     pcol = <span>"#0099CC"</span>,<br>                     mark_color = <span>"black"</span>)<br><br><br>p2 &lt;-<br>triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_rad6_rep1_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_rad6_rep2_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_rad6_peroxide_rep1_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_rad6_peroxide_rep2_F_tripeptide_occupancy.txt"</span>),<br>                     sample_name = c(<span>"rad6-rep1"</span>,<span>"rad6-rep2"</span>,<span>"rad6-peroxide-rep1"</span>,<span>"rad6-peroxide-rep2"</span>),<br>                     group_name = c(<span>"rad6"</span>,<span>"rad6"</span>,<span>"rad6 + peroxide"</span>,<span>"rad6 + peroxide"</span>),<br>                     mark_motif = c(<span>"KIP"</span>,<span>"MIP"</span>,<span>"QIP"</span>,<span>"KIH"</span>,<span>"EIH"</span>,<br>                                    <span>"RKK"</span>,<span>"PPD"</span>,<span>"PPE"</span>),<br>                     pcol = <span>"#993399"</span>,<br>                     mark_color = <span>"black"</span>)<br><br><span># 4x8</span><br>p1 | p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031240" data-ratio="0.5081466395112016" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NDXTdM6AItQDAjgCZ2fQJmptGIrrgAlCm1FiaICjRSHDIiaBIRnXAKwRw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="982" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NDXTdM6AItQDAjgCZ2fQJmptGIrrgAlCm1FiaICjRSHDIiaBIRnXAKwRw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>回补型</span><span></span></h3><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>RAD6</strong> 是泛素连接酶，为了验证氧化应激下的核糖体暂停是否与它的泛素连接功能相关，作者对 <strong>RAD6</strong> 泛素功能区域进行了突变，发现在缺失的条件下，只有回补野生型的 <strong>RAD6 而非突变型</strong> 才能恢复氧化应激导致的核糖体停滞现象。作者还在不同菌种（<strong>S288C</strong>）同样发现了类似的现象，表面现象的普适性。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031239" data-ratio="0.4003139717425432" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NHZRg4Hr45dyhyOlRrHDUTibzfNia7xNDmka3QpKlCxTFYg97BSxpUoGA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="637" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NHZRg4Hr45dyhyOlRrHDUTibzfNia7xNDmka3QpKlCxTFYg97BSxpUoGA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031241" data-ratio="0.3192156862745098" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NMHqia1LibvAE4ibiapNhxungnqOEQNJxMIv9yJBzC36z4gfS7yrMOZNjAw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1275" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NMHqia1LibvAE4ibiapNhxungnqOEQNJxMIv9yJBzC36z4gfS7yrMOZNjAw/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;-<br>  triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_rad6_RAD6_F_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_rad6_RAD6_peroxide_F_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"rad6_RAD6"</span>,<span>"rad6_RAD6_peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>),<br>                       pcol = <span>"#003366"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><br>p2 &lt;-<br>  triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_rad6_RAD6_C88A_F_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_rad6_RAD6_C88A_peroxide_F_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"rad6_RAD6_C88A"</span>,<span>"rad6_RAD6_C88A_peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>),<br>                       pcol = <span>"#993399"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><span># 4x8</span><br>p1 | p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031244" data-ratio="0.5112016293279023" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NRFGSypT6SrfDcF7tibVsBefAIwwqXqS6fCLXiaQkVDaLhvM0nTNG8PhA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="982" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NRFGSypT6SrfDcF7tibVsBefAIwwqXqS6fCLXiaQkVDaLhvM0nTNG8PhA/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>D 图在 S288C 里标记了 Pro 氨基酸结尾的基序（即 A 位点）橙色点，自定义一下绘图函数：</strong></p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>triAmino_scater_plot2 &lt;- <span>function</span>(occupancy_file = <span>NULL</span>,<br>                                 sample_name = <span>NULL</span>,<br>                                 group_name = <span>NULL</span>,<br>                                 mark_motif = <span>NULL</span>,<br>                                 pcol = <span>"grey"</span>,<br>                                 mark_color = <span>"orange"</span>){<br>  <span>...</span><br>  df_plot_pro &lt;- df_plot_wide %&gt;%<br>    dplyr::filter(endsWith(motif,<span>"P"</span>))<br><br>  <span># plot</span><br>  ggplot(df_plot_wide) +<br>    <span>...</span><br>    geom_point(data = df_plot_pro,aes(x = .data[[var[<span>1</span>]]],y = .data[[var[<span>2</span>]]]),<br>               color = <span>"orange"</span>) +<br>    <span>...</span><br><br>}<br><br>p1 &lt;-<br>  triAmino_scater_plot2(occupancy_file = c(<span>"normalized_count_data/S288C_WT_F_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/S288C_WT_peroxide_F_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"S288C_WT"</span>,<span>"S288C_WT_peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>),<br>                       pcol = <span>"#3399CC"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><br>p2 &lt;-<br>  triAmino_scater_plot2(occupancy_file = c(<span>"normalized_count_data/S288C_rad6_F_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/S288C_rad6_peroxide_F_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"S288C_rad6"</span>,<span>"S288C_rad6_peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>),<br>                       pcol = <span>"#FF33CC"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><span># 4x8</span><br>p1 | p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031243" data-ratio="0.5121951219512195" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbfibIVh2W53bd6YvzjSn55PJgqiaL5LQvKlRT1dYo451vfZYiaRnpEJ6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="984" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NbfibIVh2W53bd6YvzjSn55PJgqiaL5LQvKlRT1dYo451vfZYiaRnpEJ6Q/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>relative distance to tri-peptide motif</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>作者发现 <strong>PA</strong> 位点主要是 <strong>异亮氨酸-脯氨酸</strong>，<strong>E</strong> 位点则不保守，所以定义了 <strong>XIP</strong> 基序，<strong>X</strong> 为任意氨基酸。然后分析了 <strong>reads</strong> 在 <strong>XIP</strong> 富集的富集情况，包括野生型，RAD6 缺失型，及回补 RAD6 和突变的 RAD6 的分析。观察图形可以发现，<strong>reads</strong> 也是没有经过 <strong>offset</strong> 校正的，分析的时候要注意一下。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031247" data-ratio="0.31750465549348234" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N1qRQQSpHp6SvBors7OuxV28ewYWBYed9jK6ibEueuiaspGU8owVpfzOQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1074" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N1qRQQSpHp6SvBors7OuxV28ewYWBYed9jK6ibEueuiaspGU8owVpfzOQ/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031245" data-ratio="0.518913676042677" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NXiaNBvialvOVC6LK4A2rgQoTeupastDNllreDS7qQDSaHMMcQYAdy1yQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1031" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NXiaNBvialvOVC6LK4A2rgQoTeupastDNllreDS7qQDSaHMMcQYAdy1yQ/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">对数据进行标准化：</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"monosome.rda"</span>)<br><br>monosome &lt;- monosome %&gt;%<br>  dplyr::mutate(length = as.numeric(as.character(length))) %&gt;%<br>  dplyr::filter(length %<span>in</span>% <span>25</span>:<span>34</span>)<br><br><span># get normalized data</span><br>mono_norm_df &lt;- get_nomalized_counts(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                                     qc_df = monosome,<br>                                     exclude_upstreamCodon = <span>5</span>,<br>                                     exclude_downstreamCodon = <span>5</span>)<br></code></pre><blockquote data-tool="mdnice编辑器"><span>❝</span><p>计算 <strong>reads</strong> 和 <strong>XIP</strong> 的相对距离，注意 <strong>X</strong> 是任意氨基酸，但是我们也不能写 20 种分别去寻找然后整合数据，这时候可以使用正则表达式的通配符，指定 <strong>motif = ".IP"</strong> 即可匹配到所有类型的 <strong>IP</strong> 结尾的基序：</p></blockquote><pre data-tool="mdnice编辑器"><span></span><code>rel_dist_motif(amino_file = <span>"sac_amino_acid.fa"</span>,<br>               longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>               normed_file = mono_norm_df %&gt;%<br>                 dplyr::filter(sample %<span>in</span>% c(<span>"SUB280_WT_rep1_F"</span>,<span>"SUB280_WT_rep2_F"</span>,<br>                                             <span>"SUB280_WT_peroxide_rep1_F"</span>,<span>"SUB280_WT_peroxide_rep2_F"</span>,<br>                                             <span>"SUB280_rad6_rep1_F"</span>,<span>"SUB280_rad6_rep2_F"</span>,<br>                                             <span>"SUB280_rad6_peroxide_rep1_F"</span>,<span>"SUB280_rad6_peroxide_rep2_F"</span>,<br>                                             <span>"SUB280_rad6_RAD6_F"</span>,<span>"SUB280_rad6_RAD6_peroxide_F"</span>,<br>                                             <span>"SUB280_rad6_RAD6_C88A_F"</span>,<span>"SUB280_rad6_RAD6_C88A_peroxide_F"</span>)),<br>               min_counts = <span>64</span>,<br>               motif = <span>".IP"</span>,<br>               upstream = -<span>50</span>,<br>               downstream = <span>50</span>)<br></code></pre><p data-tool="mdnice编辑器"><strong>拿到数据了就可以绘图可视化了：</strong></p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br><span>library</span>(patchwork)<br><br>p1 &lt;-<br>rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_WT_rep1_F_.IP_motif_occupancy.txt"</span>,<br>                                             <span>"relative_distance_motif/SUB280_WT_rep2_F_.IP_motif_occupancy.txt"</span>,<br>                                             <span>"relative_distance_motif/SUB280_WT_peroxide_rep1_F_.IP_motif_occupancy.txt"</span>,<br>                                             <span>"relative_distance_motif/SUB280_WT_peroxide_rep2_F_.IP_motif_occupancy.txt"</span>),<br>                    sample_name = c(<span>"WT-rep1"</span>,<span>"WT-rep2"</span>,<br>                                    <span>"WT-peroxide-rep1"</span>,<span>"WT-peroxide-rep2"</span>),<br>                    group_name = c(<span>"WT"</span>,<span>"WT"</span>,<span>"WT + peroxide"</span>,<span>"WT + peroxide"</span>),<br>                    motif = <span>"XIP"</span>,<br>                    site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"WT"</span> = <span>"black"</span>,<span>"WT + peroxide"</span> = <span>"#3399CC"</span>))<br><br>p2 &lt;-<br>  rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_rad6_rep1_F_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_rep2_F_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_peroxide_rep1_F_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_peroxide_rep2_F_.IP_motif_occupancy.txt"</span>),<br>                      sample_name = c(<span>"rad6-rep1"</span>,<span>"rad6-rep2"</span>,<br>                                      <span>"rad6-peroxide-rep1"</span>,<span>"rad6-peroxide-rep2"</span>),<br>                      group_name = c(<span>"rad6"</span>,<span>"rad6"</span>,<span>"rad6 + peroxide"</span>,<span>"rad6 + peroxide"</span>),<br>                      motif = <span>"XIP"</span>,<br>                      site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"rad6"</span> = <span>"black"</span>,<span>"rad6 + peroxide"</span> = <span>"#FF33CC"</span>)) +<br>  ylim(<span>0</span>,<span>10</span>)<br><br>p1 / p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031246" data-ratio="0.7240977881257276" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaeWQ4XykriaH6yewIGacvZQicXBdge3HNicosyhzTVNic5SLg3rHH9ibBDA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="859" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaeWQ4XykriaH6yewIGacvZQicXBdge3HNicosyhzTVNic5SLg3rHH9ibBDA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>看看回补野生型和突变型 RAD6 的情况：</strong></p><pre data-tool="mdnice编辑器"><span></span><code>p1 &lt;-<br>  rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_rad6_RAD6_F_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_RAD6_peroxide_F_.IP_motif_occupancy.txt"</span>),<br>                      sample_name = c(<span>"rad6_RAD6"</span>,<span>"rad6_RAD6_peroxide"</span>),<br>                      motif = <span>"XIP"</span>,<br>                      site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"rad6_RAD6"</span> = <span>"black"</span>,<span>"rad6_RAD6_peroxide"</span> = <span>"#3399CC"</span>)) +<br>  ylim(<span>0</span>,<span>8</span>)<br><br>p2 &lt;-<br>  rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_rad6_RAD6_C88A_F_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_RAD6_C88A_peroxide_F_.IP_motif_occupancy.txt"</span>),<br>                      sample_name = c(<span>"rad6_RAD6_C88A"</span>,<span>"rad6_RAD6_C88A_peroxide"</span>),<br>                      motif = <span>"XIP"</span>,<br>                      site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"rad6_RAD6_C88A"</span> = <span>"black"</span>,<span>"rad6_RAD6_C88A_peroxide"</span> = <span>"#FF33CC"</span>)) +<br>  ylim(<span>0</span>,<span>8</span>)<br><br>p1 / p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031249" data-ratio="0.7200929152148664" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaZId8w4S1nwHo0EiaZZjUe13Utq2EJh36cCCsE4UNLxStQsbt6Xaib7g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="861" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NiaZId8w4S1nwHo0EiaZZjUe13Utq2EJh36cCCsE4UNLxStQsbt6Xaib7g/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>motif logo</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>文章第一张主图对氧化应激处理上升的 motif 还进行了可视化，使用的是 <strong>pLogo（https://plogo.uconn.edu/#）</strong> 工具，作者图注里写了选择 <strong>1.5</strong> 倍的，然后输入 <strong>foreground</strong> 和 <strong>backgroud</strong> 可视化。这里我们的复现结果和文章还是有区别的，这里就不分析了，注意介绍一下怎么使用。进入网页后你可以选择上传的 <strong>foreground</strong> 和 <strong>backgroud</strong> 序列，中间部分有简短的操作教程，点击 <strong>generate pLogo</strong> 即可生成图形。</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031250" data-ratio="0.6130268199233716" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NL3VcxcjmhJhjFGIct92iaILZ6lFS82AIq8Ue65QDxGMWricjbFVvgDzQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1044" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NL3VcxcjmhJhjFGIct92iaILZ6lFS82AIq8Ue65QDxGMWricjbFVvgDzQ/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100031252" data-ratio="0.7403846153846154" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9Nb2dm4cUIKreG0zL1YqoCS4Oo2yfjVwgkGlxcrfhnzYcB3Yrx9D4avA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1144" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9Nb2dm4cUIKreG0zL1YqoCS4Oo2yfjVwgkGlxcrfhnzYcB3Yrx9D4avA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>disome-seq analysis</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p>前面的分析都是基于 <strong>monsome</strong> 的，作者还测了 <strong>disome</strong> 的数据，同样的方法我们也来分析看看。先看看文章为什么要做这个东西。<strong>之前的研究表明,E3 泛素连接酶 Hel2 可以通过泛素化碰撞的核糖体来触发 RQC 通路,从而促进核糖体的解离和重新利用。作者进一步在 hel2Δ 突变株中进行了 Ribo-seq 实验,发现在氧化应激条件下,XIP 序列的"氧化应激诱导的核糖体暂停"现象仍然存在。这表明,Rad6 介导的核糖体暂停并不依赖于 RQC 通路,而是通过一种独立的机制来调控转录过程。</strong></p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100031251" data-ratio="0.6019417475728155" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N3oVaIpxeOibtJxia3lnWkeooX5N73ibyVicUpRnXlCkyibp3qD0yv2oLAaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1030" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N3oVaIpxeOibtJxia3lnWkeooX5N73ibyVicUpRnXlCkyibp3qD0yv2oLAaw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>注意左下那个图还是 monosome 的，做了一个 hel2 缺失的实验。</strong></p><h3 data-tool="mdnice编辑器"><span></span><span>Δhel2 pause score</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span># hel2 monosome data</span><br>load(<span>"mono_norm_df.rda"</span>)<br><br><span># filter samples</span><br>ft_data &lt;- mono_norm_df %&gt;%<br>  dplyr::filter(sample %<span>in</span>% c(<span>"SUB280_hel2_F"</span>,<span>"SUB280_hel2_peroxide_F"</span>))<br><br><span># calculate pause score for motif</span><br>peptide_motif_score2(amino_file = <span>"sac_amino_acid.fa"</span>,<br>                     normed_exp_file = ft_data,<br>                     longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                     norm_type = <span>"normed_count"</span>,<br>                     window = <span>50</span>,<br>                     occurrence_threshold = <span>100</span>)<br><span># SUB280_hel2_F has been processed!</span><br><span># SUB280_hel2_peroxide_F has been processed!</span><br><br><span># plot</span><br>triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_hel2_F_tripeptide_occupancy.txt"</span>,<br>                                        <span>"normalized_count_data/SUB280_hel2_peroxide_F_tripeptide_occupancy.txt"</span>),<br>                     sample_name = c(<span>"hel2"</span>,<span>"hel2_peroxide"</span>),<br>                     mark_motif = c(<span>"KIP"</span>,<span>"MIP"</span>,<span>"QIP"</span>,<span>"KIH"</span>,<span>"EIH"</span>,<span>"RKK"</span>,<span>"PPD"</span>,<span>"PPE"</span>),<br>                     pcol = <span>"#006600"</span>,<br>                     mark_color = <span>"black"</span>)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031248" data-ratio="0.998" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NC6MDAO1Tlb3ARTBO3TUNOpr06GZibDtgk9PKw0Zg9CKPKgWgicUn7mZw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="500" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NC6MDAO1Tlb3ARTBO3TUNOpr06GZibDtgk9PKw0Zg9CKPKgWgicUn7mZw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>disome-seq pause score</span><span></span></h3><p data-tool="mdnice编辑器">先计算 <strong>pause score</strong>：</p><pre data-tool="mdnice编辑器"><span></span><code>load(<span>"diso_norm_df.rda"</span>)<br><br>unique(diso_norm_df$sample)<br><br><span># calculate pause score for motif</span><br>peptide_motif_score2(amino_file = <span>"sac_amino_acid.fa"</span>,<br>                     normed_exp_file = diso_norm_df,<br>                     longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                     norm_type = <span>"normed_count"</span>,<br>                     window = <span>50</span>,<br>                     occurrence_threshold = <span>100</span>)<br></code></pre><p data-tool="mdnice编辑器">然后绘图，可以看到有些基序没有找到：</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br><span>library</span>(patchwork)<br><br>p1 &lt;-<br>  triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_WT_rep1_Fd_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_WT_rep2_Fd_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_WT_peroxide_rep1_Fd_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_WT_peroxide_rep2_Fd_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"WT-rep1"</span>,<span>"WT-rep2"</span>,<span>"WT-peroxide-rep1"</span>,<span>"WT-peroxide-rep2"</span>),<br>                       group_name = c(<span>"WT"</span>,<span>"WT"</span>,<span>"WT + peroxide"</span>,<span>"WT + peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>,<span>"MIP"</span>,<span>"QIP"</span>,<span>"KIH"</span>,<span>"EIH"</span>,<span>"RKK"</span>,<span>"PPD"</span>,<span>"PPE"</span>),<br>                       pcol = <span>"#0099CC"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><br>p2 &lt;-<br>  triAmino_scater_plot(occupancy_file = c(<span>"normalized_count_data/SUB280_rad6_Fd_tripeptide_occupancy.txt"</span>,<br>                                          <span>"normalized_count_data/SUB280_rad6_peroxide_Fd_tripeptide_occupancy.txt"</span>),<br>                       sample_name = c(<span>"rad6"</span>,<span>"rad6_peroxide"</span>),<br>                       mark_motif = c(<span>"KIP"</span>,<span>"MIP"</span>,<span>"QIP"</span>,<span>"KIH"</span>,<span>"EIH"</span>,<span>"RKK"</span>,<span>"PPD"</span>,<span>"PPE"</span>),<br>                       pcol = <span>"#9933CC"</span>,<br>                       mark_color = <span>"black"</span>)<br><br><span># 4x8</span><br>p1 | p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031255" data-ratio="0.5154004106776181" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N3YicQszGNyS4Wf1fias8nFSwJtab6p3SMCHUPbswk9RoxRfuqSepnviaw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="974" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N3YicQszGNyS4Wf1fias8nFSwJtab6p3SMCHUPbswk9RoxRfuqSepnviaw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>relative to XIP motif</span><span></span></h3><p data-tool="mdnice编辑器">计算：</p><pre data-tool="mdnice编辑器"><span></span><code><span># relative distance</span><br>load(<span>"disome.rda"</span>)<br><br>disome &lt;- disome %&gt;%<br>  dplyr::mutate(length = as.numeric(as.character(length))) %&gt;%<br>  dplyr::filter(length %<span>in</span>% <span>57</span>:<span>63</span>)<br><br><span># get normalized data</span><br>disome_norm_df &lt;- get_nomalized_counts(longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>                                       qc_df = disome,<br>                                       exclude_upstreamCodon = <span>5</span>,<br>                                       exclude_downstreamCodon = <span>5</span>)<br><br><span># calculate relative distance density</span><br>rel_dist_motif(amino_file = <span>"sac_amino_acid.fa"</span>,<br>               longest_trans_file = <span>"longest_info_extend.txt"</span>,<br>               normed_file = disome_norm_df,<br>               min_counts = <span>64</span>,<br>               motif = <span>".IP"</span>,<br>               upstream = -<span>50</span>,<br>               downstream = <span>50</span>)<br></code></pre><p data-tool="mdnice编辑器">绘图：</p><pre data-tool="mdnice编辑器"><span></span><code><span># plot</span><br><span>library</span>(patchwork)<br><br>p1 &lt;-<br>  rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_WT_rep1_Fd_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_WT_rep2_Fd_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_WT_peroxide_rep1_Fd_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_WT_peroxide_rep2_Fd_.IP_motif_occupancy.txt"</span>),<br>                      sample_name = c(<span>"WT-rep1"</span>,<span>"WT-rep2"</span>,<br>                                      <span>"WT-peroxide-rep1"</span>,<span>"WT-peroxide-rep2"</span>),<br>                      group_name = c(<span>"WT"</span>,<span>"WT"</span>,<span>"WT + peroxide"</span>,<span>"WT + peroxide"</span>),<br>                      motif = <span>"XIP"</span>,<br>                      site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"WT"</span> = <span>"black"</span>,<span>"WT + peroxide"</span> = <span>"#3399CC"</span>)) +<br>  labs(title = <span>"Disome seq"</span>)<br><br>p2 &lt;-<br>  rel_dist_motif_plot(motif_occupancy_file = c(<span>"relative_distance_motif/SUB280_rad6_Fd_.IP_motif_occupancy.txt"</span>,<br>                                               <span>"relative_distance_motif/SUB280_rad6_peroxide_Fd_.IP_motif_occupancy.txt"</span>),<br>                      sample_name = c(<span>"rad6"</span>,<span>"rad6-peroxide"</span>),<br>                      motif = <span>"XIP"</span>,<br>                      site = <span>"3' end"</span>) +<br>  scale_color_manual(values = c(<span>"rad6"</span> = <span>"black"</span>,<span>"rad6-peroxide"</span> = <span>"#FF33CC"</span>)) +<br>  labs(title = <span>"Disome seq"</span>) +<br>  ylim(<span>0</span>,<span>13</span>)<br><br><span># 5X7</span><br>p1 / p2<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100031257" data-ratio="0.7254672897196262" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N12qiczWVy8iay6kSic1RMeU2pn0PB61gAVfqQF4otujMuhmQZhflrM68g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="856" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9N12qiczWVy8iay6kSic1RMeU2pn0PB61gAVfqQF4otujMuhmQZhflrM68g/640?wx_fmt=png&amp;from=appmsg"></figure><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>最后就差不多结束了，有些地方其实并不是那么满意。</strong></p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>结尾</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong>路漫漫其修远兮,吾将上下而求索。</strong></p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">欢迎加入生信交流群。加我微信我也拉你进 <strong>微信群聊</strong> <strong>老俊俊生信交流群</strong> <strong>(微信交流群需收取 20 元入群费用,一旦交费,拒不退还!(防止骗子和便于管理))</strong> 。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100031256" data-ratio="0.6083707025411061" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NYy2qjBAugyJedMQ39ViaiaZrRXxBscvLIpxZ3JSgoQnDzRFCmA27b6QQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="669" src="https://mmbiz.qpic.cn/sz_mmbiz_png/G5jjcE4usexcoC8nL4fKD0jfibnS0be9NYy2qjBAugyJedMQ39ViaiaZrRXxBscvLIpxZ3JSgoQnDzRFCmA27b6QQ/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器"><strong></strong></p><center data-tool="mdnice编辑器"><strong> 往期回顾目录</strong></center><blockquote data-tool="mdnice编辑器"><span>❝</span><p><strong></strong></p><center><strong><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514724&amp;idx=1&amp;sn=ffa1b198b257bbf52bc489b5dd42f1ea&amp;chksm=c1848015f6f309037000d72fed4718195be97c6e6e7b45e0d1b8c06690465b4c90ba3c90c890&amp;token=1671225249&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Ribo-SEQ 数据质量评估</a></strong></center><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514686&amp;idx=1&amp;sn=850aa948716473b22d345d5f7ce1fc59&amp;chksm=c184804ff6f3095999a5b868dd9198db79a0063d4e8045a98a0c670e714d0b187b636cefcb05&amp;token=1985571830&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">寻找核糖体暂停位点</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514577&amp;idx=1&amp;sn=c1588b243a5600de9745c8b8b00e5288&amp;chksm=c18483a0f6f30ab6c0a81f8139ef6cbe1bfedc8144c53adffd9f61b2dcc7b89d186ad1ac1cc8&amp;token=1985571830&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Molecular Cell 文章结果复现（终）</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514539&amp;idx=1&amp;sn=cc75df14200d88888cb0608cb4593105&amp;chksm=c18483daf6f30acc5b35e760bac97ae82aed5379bdb8685ada3aaff5ec1e6bc8c77a559c9595&amp;token=1281308534&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">计算 Ribosome 距离二肽/三肽基序距离的密度</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514511&amp;idx=1&amp;sn=60509453e63d2659e4b728e33795fedc&amp;chksm=c18483fef6f30ae8ebba89897bdcbd5d15de10fe9131eb9d14689635e5c617aa65eba8404017&amp;token=1519752094&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">怎么给书籍插入参考文献</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514492&amp;idx=1&amp;sn=a23e705c9ce6412033056c162ba1f513&amp;chksm=c184830df6f30a1be8b6fa9fefa846ff7e19836f2069f24761e440f9ee0320a6a0c8cca49ef3&amp;token=1519752094&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Ribo-seq 核糖体去除新方法？</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514475&amp;idx=1&amp;sn=2de16f76c92493bae019affe1119673d&amp;chksm=c184831af6f30a0c07a80a8e5e6b1885c0151cb465254322391dd1ffe823ad2673df70434589&amp;token=1519752094&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Molecular Cell 文章部分结果复现(续)</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514430&amp;idx=1&amp;sn=a04b166f24c17f225ee887247090e4eb&amp;chksm=c184834ff6f30a591e4cd7d0fa40174e458babe656f689279ae78963dc671f635a8b86a10835&amp;token=1698951491&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">Molecular Cell 文章部分结果复现</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514370&amp;idx=1&amp;sn=156f2fa314f498a749aabeeb8604d7d9&amp;chksm=c1848373f6f30a65ca990dfea862b54041fb6f2d0aa5c25dc1b1073d4008918c9a5e8b14f964&amp;token=920737487&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">提取最长转录本信息+exon 序列+CDS 序列+氨基酸序列</a></center></strong><strong><center><a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI1MTYxNA==&amp;mid=2247514340&amp;idx=1&amp;sn=3ad6754b293f99787d9b009c239f1191&amp;chksm=c1848295f6f30b83a2595f08e428c7bc0021fbc907ca70ed230c84ea58e5c883cce1f057d00d&amp;token=920737487&amp;lang=zh_CN&amp;scene=21#wechat_redirect" data-linktype="2">检测 Ribo-SEQ 中的 offset</a></center></strong><p><br></p></blockquote></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/YgWr5yxxcJurmcZ0gkgSBA",target="_blank" rel="noopener noreferrer">原文链接</a>
