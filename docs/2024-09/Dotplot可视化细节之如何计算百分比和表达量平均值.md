---
title: "Dotplot可视化细节之如何计算百分比和表达量平均值"
date: 2024-09-11T03:24:38Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
Dotplot可视化细节之如何计算百分比和表达量平均值 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>前情提要</span><span></span></h3><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>单细胞数据分析里面最基础的就是降维聚类分群，参考前面的例子：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247497956&amp;idx=1&amp;sn=5d4deb7cf7b7848b3e2273cbd663bb6a&amp;scene=21#wechat_redirect" data-linktype="2">人人都能学会的单细胞聚类分群注释</a>  ，这个大家基本上问题不大了，使用seurat标准流程即可，不过它默认出图并不好看，详见以前我们做的投票：<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247500816&amp;idx=1&amp;sn=25568540a54d63225def0804c05025f8&amp;scene=21#wechat_redirect" data-linktype="2">可视化单细胞亚群的标记基因的5个方法</a>，<span>下面的5个基础函数相信大家都是已经烂熟于心了：</span></p></blockquote><ul data-tool="mdnice编辑器"><li><section>VlnPlot(pbmc, features = c("MS4A1", "CD79A"))</section></li><li><section>FeaturePlot(pbmc, features = c("MS4A1", "CD79A"))</section></li><li><section>RidgePlot(pbmc, features = c("MS4A1", "CD79A"), ncol = 1)</section></li><li><section>DotPlot(pbmc, features = unique(features)) + RotatedAxis()</section></li><li><section>DoHeatmap(subset(pbmc, downsample = 100), features = features, size = 3)</section></li></ul></section><p data-tool="mdnice编辑器">上几期的推文给大家分享了我对于<strong>用热图可视化及美化marker基因的内容</strong></p><ul data-tool="mdnice编辑器"><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247524659&amp;idx=1&amp;sn=bbbefc21979ceda1068c6828ca013f5d&amp;scene=21#wechat_redirect" data-linktype="2">Doheatmap常用参数及美化</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247524964&amp;idx=1&amp;sn=2bffeb7a2f159f3595461f1fe108cd9f&amp;scene=21#wechat_redirect" data-linktype="2">使用Complexheatmap美化热图</a></section></li><li><section><a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247525098&amp;idx=1&amp;sn=41d110317b7a6803f3fef9f0c5011855&amp;scene=21#wechat_redirect" data-linktype="2">Scillus包美化热图</a></section></li></ul><p data-tool="mdnice编辑器">接下来一起来了解一下<strong>Dotplot可视化Marker基因</strong>吧。</p><h3 data-tool="mdnice编辑器"><span></span><span></span><span>Dotplot结果图解析</span><span></span></h3><p data-tool="mdnice编辑器"><strong>在进行细胞亚群注释的时候，可以使用Dotplot可视化收集整理的基因集，来辅助我们进行细胞亚群的判断</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100041630" data-ratio="0.9863013698630136" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mMHy51PmKqnZ56347FLX6mRiaDhphXhx4kn9nvicjBTQccG6aF7XQ6Zhg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="657" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mMHy51PmKqnZ56347FLX6mRiaDhphXhx4kn9nvicjBTQccG6aF7XQ6Zhg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">（PS : 可以看到我们收集整理的基因的特异性都非常好，绝大部分都有单细胞亚群的排他性 ，<strong>比如9群是CPA3代表的mast细胞，它在mast亚群里面的几乎是百分百表达，但是在其他亚群都是不表达！</strong>）</p><p data-tool="mdnice编辑器">如果关注单个基因的话，也可以<strong>只查看单个基因在不同亚群的表达情况</strong>，在<a href="https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&amp;mid=2247524345&amp;idx=1&amp;sn=a15d036d655dda2296ef1ba02b16a7eb&amp;scene=21#wechat_redirect" data-linktype="2">单细胞水平看指定基因的表达量差异情况</a>分享的文章中就有对某个基因进行可视化展示</p><pre data-tool="mdnice编辑器"><span></span><code>DotPlot(sce.all.int, features = c(<span>"MTIF2"</span>), group.by = <span>"celltype"</span>) <br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041633" data-ratio="0.9862804878048781" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mQ36goYlqibaUTmQfpPFWicwWgmhDa7UtcUDPUWg3iclCygDnn1K3QhpAA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="656" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mQ36goYlqibaUTmQfpPFWicwWgmhDa7UtcUDPUWg3iclCygDnn1K3QhpAA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">（PS ; 因为<span>MTIF2</span>这个基因并不是已知的各个单细胞亚群特征基因，所以可以看到它很难有排他性，而且它即使是在肝细胞里面也就是30%的表达比例，只不过是<span><strong>肉眼看起来好像是跟前面的百分比一样的效果，所以大家务必注意图例！</strong></span>）<br></p><p data-tool="mdnice编辑器">Dotplot结果图上会展示出来<strong>Average Expressed以及Percent Expressed</strong>，及<strong>基因的平均表达量（点的颜色）以及表达的百分比（点的大小）</strong></p><p data-tool="mdnice编辑器"><strong>通过将绘图结果保存为一个变量，可以看到里面的保存的用于画图的数值</strong></p><pre data-tool="mdnice编辑器"><span></span><code>p = DotPlot(sce.all.int, features = c(<span>"MTIF2"</span>), group.by = <span>"celltype"</span>) <br><br>View(p)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041631" data-ratio="0.5472222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m8fSicAabKF7NtxPjGWuhJtgcdOia2J5FK00JXE9GdyQBTkVjDfW1HhOA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m8fSicAabKF7NtxPjGWuhJtgcdOia2J5FK00JXE9GdyQBTkVjDfW1HhOA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">其中<strong>data</strong>数据中就包含了<code>Average Expressed、Percent Expressed以及Average Expressed scaled</code></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100041629" data-ratio="0.5356643356643357" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m9bM8awalpKm9LCFJ1y1jTNkDZnCPialgAyYRd8yDl00gntXrrtxClRQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="715" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m9bM8awalpKm9LCFJ1y1jTNkDZnCPialgAyYRd8yDl00gntXrrtxClRQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">在推文<a href="https://mp.weixin.qq.com/s?__biz=MzIwOTgxNTA0Mg==&amp;mid=2247483936&amp;idx=1&amp;sn=abe4e56b1e58c8b391c8349e2d94af99&amp;scene=21#wechat_redirect" data-linktype="2">务为有补于世 | 单细胞之DotPlot的表达量哪来的？</a>整理了<strong>平均表达量Average Expressed</strong>的计算方法</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100041632" data-ratio="0.884393063583815" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mBuegrdB8mfUuzHrWicNMKwOMhaoGzock6icm18qwDSNn6qWdoyaliacpw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1038" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mBuegrdB8mfUuzHrWicNMKwOMhaoGzock6icm18qwDSNn6qWdoyaliacpw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>1. 简单尝试计算平均表达量-Average Expressed：查看B细胞亚群里面MTIF2基因的平均表达量</strong></p><p data-tool="mdnice编辑器">取出B细胞亚群，获取B细胞亚群里面MTIF2基因原始表达矩阵，计算平均表达量</p><pre data-tool="mdnice编辑器"><span></span><code><span>#average expressed</span><br><br>sce.B = sce.all.int[, sce.all.int<span>$celltype</span> %<span>in</span>% c( <span>'Bcell'</span>)]<br><br>gene_expression &lt;- sce.B[[<span>"RNA"</span>]]<span>$counts</span>[<span>"MTIF2"</span>, ]<br><br><span># 计算平均表达量，忽略NA值</span><br>average_expression &lt;- mean(gene_expression/sce.B<span>$nCount_RNA</span>*10000, na.rm = TRUE)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041636" data-ratio="0.1843220338983051" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4myZpCa0SmLgXDcBFHDPQiaeGcOBEoTib1AFFfkibuqtVzB4hs2a0Zt0gAg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="472" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4myZpCa0SmLgXDcBFHDPQiaeGcOBEoTib1AFFfkibuqtVzB4hs2a0Zt0gAg/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100041635" data-ratio="0.10849056603773585" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4micKnkLsCicAQticFz1gyYggAWQbQMcuygGSovx8TcQ2icfbS2jhKegicSAg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="636" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4micKnkLsCicAQticFz1gyYggAWQbQMcuygGSovx8TcQ2icfbS2jhKegicSAg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>2. 计算基因在不同亚群里面的表达百分比Percent Expressed</strong></p><p data-tool="mdnice编辑器">统计并整理基因在不同细胞亚群的表达与否情况，然后计算表达数量占全部细胞亚群数量的百分比</p><pre data-tool="mdnice编辑器"><span></span><code><span>#pct.express计算方式</span><br>MTIF2 = sce.all.int@assays<span>$RNA</span><span>$data</span>[<span>"MTIF2"</span>,]&gt;0<br><br>t(table(MTIF2,sce.all.int<span>$celltype</span>))<br><br>data &lt;- data.frame(<br>  CellType = c(<span>"Bcell"</span>, <span>"cycle"</span>, <span>"endothelial"</span>, <span>"epithelial"</span>, <span>"hepatocytes"</span>, <span>"macrophages"</span>, <span>"mast"</span>, <span>"myeloids"</span>, <span>"myofibroblasts"</span>, <span>"Tcell"</span>),<br>  MTIF2_FALSE = c(3053, 1810, 3609, 1975, 6294, 5509, 186, 10335, 1131, 7414),<br>  MTIF2_TRUE = c(355, 411, 448, 446, 3040, 1154, 7, 1370, 144, 503)<br>)<br><br><span># 计算每个细胞亚群中总细胞数</span><br>data<span>$TotalCells</span> &lt;- data<span>$MTIF2_FALSE</span> + data<span>$MTIF2_TRUE</span><br><br><span># 计算每个细胞亚群中MTIF2的表达占比，并添加到data表格中</span><br>data<span>$PercentExpressed</span> &lt;- (data<span>$MTIF2_TRUE</span> / data<span>$TotalCells</span>)*100<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041638" data-ratio="0.5355648535564853" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mnzM5JfX3ycXTkcGib87qp98iavmk1u9EF3UicIAHFIpSHuN3A4emnBUYA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="717" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mnzM5JfX3ycXTkcGib87qp98iavmk1u9EF3UicIAHFIpSHuN3A4emnBUYA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100041637" data-ratio="0.5591549295774648" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mJ4nInFgibiaB98ZOiaoJgxZ9HEttDxxrFr5T4Z0xs0cXS2OYqiaiawSIySg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="710" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mJ4nInFgibiaB98ZOiaoJgxZ9HEttDxxrFr5T4Z0xs0cXS2OYqiaiawSIySg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">在<strong>画图展示的labels中，x轴是我们选择展示的基因，y轴identity是细胞亚群，点的大小是由pct.exp决定的，颜色是由avg.exp.scaled决定的</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100041634" data-ratio="0.3067669172932331" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mmOf0StZiaKyuibbsEwq3iaRXs1vF8nUNyy06W62iaoKk0od3f5lDxEvGng/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="665" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mmOf0StZiaKyuibbsEwq3iaRXs1vF8nUNyy06W62iaoKk0od3f5lDxEvGng/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>关于avg.exp.scaled的计算没有去尝试，大家感兴趣的可以看一下Dotplot函数的具体计算方式</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100041643" data-ratio="0.6768518518518518" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mlhVEI8LRYpxUAobpQ4Wyw98YqxUmpGYDNOIWTK5DNXePy7tI6JGdQA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mlhVEI8LRYpxUAobpQ4Wyw98YqxUmpGYDNOIWTK5DNXePy7tI6JGdQA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>Dotplot常用参数</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100041640" data-ratio="1.268018018018018" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mBoiaejvFExzWMXsbpuJ6VfkB050J6azicDHGhqOdbItliaHTNGRib4aYVw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="444" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mBoiaejvFExzWMXsbpuJ6VfkB050J6azicDHGhqOdbItliaHTNGRib4aYVw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">除了<strong>输入数据（object）、基因集（features）以及分组信息（group.by）和分割参数（split.by）</strong>这些常用参数外，还有一些和<strong>点的颜色大小以及scale范围相关的参数</strong></p><h4 data-tool="mdnice编辑器"><span></span><span>点的颜色及缩放大小</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section><p><code>cols: </code>绘图颜色——可以是RColorBrewer包中的调色板名称，也可以是自定义的渐变的两种颜色，或者是定义多个渐变的三种以上颜色（如果设置了split.by）。</p></section></li><li><section><p><code>col.min:</code> 缩放后平均表达的颜色最小阈值。</p></section></li><li><section><p><code>col.max:</code> 缩放后平均表达的颜色最大阈值。</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100041641" data-ratio="0.8780487804878049" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mYa5nxJy3CEDE0FVOjjmCvQZUruFwtDyib0lqQ7Ts2kCfPY4JlPrwFHw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="287" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mYa5nxJy3CEDE0FVOjjmCvQZUruFwtDyib0lqQ7Ts2kCfPY4JlPrwFHw/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><code>dot.min:</code> <strong>绘制最小点的细胞分数（默认为0）</strong>,所有表达给定基因的细胞组少于此分数的将不绘制点。</section></li><li><section><code>dot.scale:</code> <strong>气泡大小的缩放比例</strong>，类似于cex参数，默认是6，可以通过这个参数调节各个气泡大小之间差异程度</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100041639" data-ratio="0.781021897810219" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4miaiceZo5fBNxmKIVODGtfIsWAhPBsZSMpVS4TwrwouD3WFdAEFBbZdqg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="274" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4miaiceZo5fBNxmKIVODGtfIsWAhPBsZSMpVS4TwrwouD3WFdAEFBbZdqg/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><code>scale:</code> 确定数据是否缩放，TRUE为默认。</section></li><li><section><code>scale.by:</code> 通过'size'或'radius'两种方式缩放点的大小，默认为"radius"。</section></li><li><section><code>scale.min:</code> 设置缩放的下限，使用NA为默认值。</section></li><li><section><code>scale.max:</code> 设置缩放的上限，使用NA为默认值。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span></span><span>使用默认参数绘图</span><span></span></h3><p data-tool="mdnice编辑器">具体绘图及美化还是使用pbmc-3k的注释分群后的示例数据，使用<code>FindAllMarkers</code>查找并获取top5的Marker基因进行可视化</p><pre data-tool="mdnice编辑器"><span></span><code><span>#top5 marker基因获取</span><br><br>pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE, min.pct = 0.25,  logfc.threshold = 0.25, verbose = FALSE)<br><br>top5 = pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(n = 5, wt = avg_log2FC)<br><br>g = unique(top5<span>$gene</span>)<br></code></pre><p data-tool="mdnice编辑器">可以先看看<strong>直接使用默认参数，不调节展示的情况</strong></p><pre data-tool="mdnice编辑器"><span></span><code>DotPlot(pbmc, features = g)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041642" data-ratio="0.8212962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m1XvpnibxicwaCIl6skZCEAwQLkic8oNsGeTjZHLbEP82NibZmibNhGmW07Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4m1XvpnibxicwaCIl6skZCEAwQLkic8oNsGeTjZHLbEP82NibZmibNhGmW07Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以看到<strong>features展示列全部挤在了一起，不便于阅读</strong>。所以可以对<strong>采用参数倾斜展示基因，或者将基因和细胞亚群调换位置</strong></p><p data-tool="mdnice编辑器"><strong>1. 调节features的排列角度</strong></p><pre data-tool="mdnice编辑器"><span></span><code>DotPlot(pbmc, features = g) + RotatedAxis()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041647" data-ratio="0.7972222222222223" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mrP3gibVTXk3QRP4JtqRMGIUTOlS09iamJUzDUiccqQUZkgiajqQxYXH47g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mrP3gibVTXk3QRP4JtqRMGIUTOlS09iamJUzDUiccqQUZkgiajqQxYXH47g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>2.将features和identity调换位置</strong></p><pre data-tool="mdnice编辑器"><span></span><code>DotPlot(pbmc, features = g) + coord_flip()+ RotatedAxis()<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100041648" data-ratio="0.8009259259259259" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mhGCfCafn4ZAULvM9wFNuxHgACHBOshmJ86AhzKqPboPt06DT8iaUKKA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjQQfy5XSJ7qJPqwoVAQ0A4mhGCfCafn4ZAULvM9wFNuxHgACHBOshmJ86AhzKqPboPt06DT8iaUKKA/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>小结</span><span></span></h3><p data-tool="mdnice编辑器">这期简单了解了一下Dotplot展示的<strong>Average Expressed以及Percent Expressed</strong>计算方式，以及<strong>Dotplot常用参数</strong></p><p data-tool="mdnice编辑器">最后简单的使用默认参数展示了top5的marker基因，使用<strong>参数倾斜展示基因，或者将基因和细胞亚群调换位置</strong>对结果图进行简单的调整</p><p data-tool="mdnice编辑器">Dotplot可调节的点还有很多，下期一起来了解一下<strong>基于Dotplot函数可视化的美化（以及它的多种变形操作，比如下面的图E就可以直接使用上面的dotplot函数的数据  ）</strong></p></section><p><img data-galleryid="" data-imgfileid="100041662" data-ratio="0.45092592592592595" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRyeAoV8Vz53e4AjP6YKsMzQDmv3ypJEehIQfcgoMZSYibMicPEA2tXuqBVowDwB6u1SYiaibSUZAZV2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRyeAoV8Vz53e4AjP6YKsMzQDmv3ypJEehIQfcgoMZSYibMicPEA2tXuqBVowDwB6u1SYiaibSUZAZV2w/640?wx_fmt=png&amp;from=appmsg"></p><h3 data-tool="mdnice编辑器"><span>文末友情宣传</span></h3><p data-tool="mdnice编辑器"><strong>如果你也想做单细胞转录组数据分析，最好是有自己的计算机资源哦，比如我们的<a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a>，而且还需要有基本的生物信息学基础，也可以看看我们的<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247533462&amp;idx=1&amp;sn=db7335a759233b4cea8b56c394e4171e&amp;chksm=9b4b032dac3c8a3b3cec594bf475a12f6feec734d27c216a59d06f48164eaf04ea26e6e6746e&amp;scene=21#wechat_redirect" textvalue="生物信息学‍马拉松授课" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生物信息学马拉松授课</a>，你的生物信息学入门课。</strong></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/J7YwIcVuUVgaJJVh290yug",target="_blank" rel="noopener noreferrer">原文链接</a>
