---
title: "NCBI官方真核生物全基因组注释流程首次开源！尝鲜体验踩坑贴奉上~"
date: 2024-09-26T07:09:13Z
draft: ["false"]
tags: [
  "fetched",
  "生信媛"
]
categories: ["Acdemic"]
---
NCBI官方真核生物全基因组注释流程首次开源！尝鲜体验踩坑贴奉上~ by 生信媛
------
<div><section data-tool="markdown编辑器" data-website="https://markdown.com.cn/editor"><blockquote data-tool="markdown.com.cn编辑器"><p><strong>萌哥碎碎念：</strong></p><p>NCBI的官方注释流程一直都是出了名的效果拔群准确度极高，但可惜一直都是非开源的，看到这么好用的工具却用不到自己的项目里，心里可太刺挠了。</p><p>终于！最近NCBI开源了他们的流程，下面的内容由小伙伴<strong>阿良</strong>供稿~大家如果有好的稿子也可以投稿给我呀~</p></blockquote><h2 data-tool="markdown.com.cn编辑器"><span></span><span>项目地址：</span><span></span><span> </span></h2><ul data-tool="markdown.com.cn编辑器"><li><section>https://github.com/ncbi/egapx</section></li></ul><p data-tool="markdown.com.cn编辑器"><strong>Eukaryotic Genome Annotation Pipeline - External (EGAPx)</strong></p><h2 data-tool="markdown.com.cn编辑器"><span></span><span>使用体验</span><span></span><span> </span></h2><blockquote data-tool="markdown.com.cn编辑器"><p>总的使用感受：最好能找到国外的好友帮忙，因为下载依赖文件时，网络速度是个问题。</p></blockquote><h2 data-tool="markdown.com.cn编辑器"><span></span><span>运行说明</span><span></span><span> </span></h2><p data-tool="markdown.com.cn编辑器"><strong>本文采用singularity镜像方式运行，以示例数据为例。</strong></p><blockquote data-tool="markdown.com.cn编辑器"><p><strong>原因：</strong>采用singularity镜像可以避免aws S3部分的设置（这里会要求你开通亚马逊帐号）。</p><p>整个流程要先配置nextflow，可以参考：</p><p>https://www.nextflow.io/docs/latest/install.html</p></blockquote><h2 data-tool="markdown.com.cn编辑器"><span></span><span>软件安装</span><span></span><span> </span></h2><h3 data-tool="markdown.com.cn编辑器"><span></span><span>1. 先安装nextflow</span><span></span></h3><p data-tool="markdown.com.cn编辑器">默认你已经装了java, 没安装的话记得安装。</p><section><ul><li><li><li><li></ul><pre data-lang=""><code><span>curl -s https://get.nextflow.io | bash</span></code><code><span>chmod +x nextflow</span></code><code><span>sudo mv nextflow /usr/local/bin</span></code><code><span>nextflow info</span></code></pre></section><p data-tool="markdown.com.cn编辑器">如果你没有sudo权限，试试在conda环境下安装nextflow后运行。</p><h3 data-tool="markdown.com.cn编辑器"><span></span><span>2. 下载singularity镜像</span><span></span></h3><p data-tool="markdown.com.cn编辑器">可直接跳到github页面offline mode部分。</p><p data-tool="markdown.com.cn编辑器">选择适合的方式获得镜像（考验你的网络）</p><section><ul><li></ul><pre data-lang=""><code><span>singularity pull docker://ncbi/egapx:0.2-alpha</span></code></pre></section><h3 data-tool="markdown.com.cn编辑器"><span></span><span>3. 下载本地缓存文件</span><span></span></h3><p data-tool="markdown.com.cn编辑器">下载“<strong>一些</strong>”注释所需要的文件（考验你网速的时刻到了）</p><section><ul><li><li><li></ul><pre data-lang=""><code><span>git clone https://github.com/ncbi/egapx.git</span></code><code><span>cd egapx</span></code><code><span>python3 ui/egapx.py -dl -lc ../local_cache</span></code></pre></section><h3 data-tool="markdown.com.cn编辑器"><span></span><span>4. 下载示例数据</span><span></span></h3><p data-tool="markdown.com.cn编辑器">下载3中的缓存文件的同时，下载示例所需数据</p><section><ul><li><li><li><li><li></ul><pre data-lang=""><code><span># 方法不限，能下载下来数据就行</span></code><code><span>prefetch SRR8506572</span></code><code><span>prefetch SRR9005248</span></code><code><span>fasterq-dump --skip-technical --threads 6 --split-files --seq-defline "&gt;\$ac.\$si.\$ri" --fasta -O sradir/  ./SRR8506572</span></code><code><span>fasterq-dump --skip-technical --threads 6 --split-files --seq-defline "&gt;\$ac.\$si.\$ri" --fasta -O sradir/  ./SRR9005248</span></code></pre></section><h3 data-tool="markdown.com.cn编辑器"><span></span><span>5. 修改示例数据的配置文件内容</span><span></span></h3><section><ul><li></ul><pre data-lang=""><code><span>vim examples/input_D_farinae_small.yaml</span></code></pre></section><h3 data-tool="markdown.com.cn编辑器"><span></span><span>6. 避坑指南 <strong>（本文最重要的地方）</strong></span><span></span></h3><p data-tool="markdown.com.cn编辑器"><code>biowulf_cluster.config</code>默认的是NIH的biowulf集群，配置文件虽然已经设好，但我无法选用，因此放弃。考虑到自己用的本地singularity镜像，因此在后续命令中采用<code>-e singularity</code>参数。</p><p data-tool="markdown.com.cn编辑器"><strong>避坑点</strong>：直接使用会在运行过程中再次下载singularity镜像，既浪费了前面已下好的，又会因为网络问题失败。所以记得修改<code>egapx_config/singularity.config</code>文件：</p><section><ul><li><li></ul><pre data-lang=""><code><span>echo "process.container = '/path_to_/egapx_0.2-alpha.sif'" &gt;&gt; egapx_config/singularity_config</span></code><code><span>#或者直接vim编辑 egapx_config/singularity_config文件</span></code></pre></section><h3 data-tool="markdown.com.cn编辑器"><span></span><span>7. 开始运行示例数据</span><span></span></h3><section><ul><li></ul><pre data-lang=""><code><span>ui/egapx.py examples/input_D_farinae_small.yaml -e singularity -w dfs_work -o dfs_out -lc ../local_cache</span></code></pre></section><p data-tool="markdown.com.cn编辑器">目前正常运行中！有后续再更新~<img data-imgfileid="100000650" data-ratio="0.8001998001998002" data-type="other" data-w="1001" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/IasV9nWZS0etmFk4Ez7Lg8aCJP7K9Sb0bFbgQTZNLSKwp6uXraz79CsuCN6Aib9zAxicbddeKfMEfFYTGTsMy2tg/640?wx_fmt=other&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_jpg/IasV9nWZS0etmFk4Ez7Lg8aCJP7K9Sb0bFbgQTZNLSKwp6uXraz79CsuCN6Aib9zAxicbddeKfMEfFYTGTsMy2tg/640?wx_fmt=other&amp;from=appmsg"></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/qczzk8cki-TCbytdeNd-iw",target="_blank" rel="noopener noreferrer">原文链接</a>
