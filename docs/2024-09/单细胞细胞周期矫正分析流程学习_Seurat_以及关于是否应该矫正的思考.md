---
title: "单细胞细胞周期矫正分析流程学习(Seurat)以及关于是否应该矫正的思考"
date: 2024-09-08T15:32:55Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
单细胞细胞周期矫正分析流程学习(Seurat)以及关于是否应该矫正的思考 by 生信方舟
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">单细胞细胞周期矫正的目的从宽泛的角度来说是因为它可以<strong>消除由于细胞周期阶段不同而导致的基因表达异质性</strong>。在单细胞数据中，不同细胞可能处于不同的细胞周期阶段(如G1、S、G2或M期)，这些阶段会影响细胞的基因表达模式，尤其是那些与细胞周期密切相关的基因。如果不进行细胞周期矫正，这些周期性变化的基因可能会误导后续的数据分析，如聚类和差异表达分析，导致分析结果不能准确反映细胞的生物学状态和异质性。</p><p data-tool="mdnice编辑器">但这个时候问题就来了，如果可以消除由于细胞周期阶段不同而导致的基因表达异质性，<strong>那么换句话来说是不是也就可能消除了本身的生物学差异，而这种差异也许是研究者正是所想要研究的呢</strong>？</p><p data-tool="mdnice编辑器"><strong>笔者认为正确也不一定正确，这需要依情况而定。</strong></p><p data-tool="mdnice编辑器">我们在做单细胞分析的时候是需要根据样本的"特征"(这里可以泛指是各种重要的且表达有差异的基因)去对数据做分析。那么<strong>如何更好的去找出这些特征基因且必须把一些表达有差异但其实是没有意义的基因给筛去</strong>？在刚开始的质控环节就已经开始了，比如限制线粒体基因的百分比，nCount和nFeature的值等等。</p><p data-tool="mdnice编辑器">在单细胞时代之下数据的分辨率已经达到了细胞级，不同细胞应看做不同的样本，那么它们之间是存在极大异质性的。<strong>这种异质性从表象上都可归类于生物学差异，但更深层次的，研究者真正想要知道是生物学差异背后的样本之间的功能差异</strong>！</p><p data-tool="mdnice编辑器">而<strong>细胞周期既可以看做是生物学上的混杂因素</strong>(<strong>不同细胞的细胞周期情况在取样的那一瞬间就已经被定格了，而他们的周期情况绝对是不可能完全一样的</strong>)，也可以在控制大部分混杂因素(控制变量这件事要完美是不可能的)后的后续分析中<strong>认为是功能上的差异</strong>(<strong>不同处理下，细胞周期通路在实验组和对照组之间存在的差异</strong>)。如果说是生物学的差异，<strong>我们就需要在正式分析之前就要进行矫正，尽量减少这种生物学差异导致的影响</strong>！</p><p data-tool="mdnice编辑器">但这里还有一个问题，<strong>细胞周期的影响真的那么大吗</strong>？<strong>是的，在既往的文献中(见参考资料)已经明确提到了细胞周期这个生物学差异会导致很大的异质性</strong>，从笔者的理解来看，这种<strong>异质性可能会掩盖功能学上的差异</strong>！(这个掩盖可以解释为<strong>由于细胞周期导致的生物学误差过大之后，其他非细胞周期相关的功能学差异反而显得没那么有差异了</strong>..)</p><p data-tool="mdnice编辑器">当然，我们还是要依情况而定，如果<strong>研究方向就是跟细胞周期有直接且密切关系的，那就不可以去矫正这个因素</strong>了，比如现在热门—衰老/干细胞(涉及静息态等情况？这块不太懂)等相关的研究。如果是<strong>非直接关系的，应当要去矫正</strong>，换个角度去想，<strong>如果一个矫正能把"所谓的差异"给矫正没了，那请问这个"差异"到底真有那么大的研究价值吗</strong>？</p><h4 data-tool="mdnice编辑器"><span></span>步骤流程<span></span></h4><h5 data-tool="mdnice编辑器"><span></span>1、导入<span></span></h5><p data-tool="mdnice编辑器">sce.all是已经做过质量控制之后的数据</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>sce &lt;- qread(<span>"./Data.qs"</span>)<br><br>dim(sce.all)<br></code></pre><h5 data-tool="mdnice编辑器"><span></span>2、细胞周期分析<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code><span># 标准化数据</span><br>sce &lt;- NormalizeData(sce, <br>                     normalization.method = <span>"LogNormalize"</span>, <br>                     scale.factor = <span>10000</span>)<br><br><span># 找到高变基因</span><br>sce &lt;- FindVariableFeatures(sce, selection.method = <span>"vst"</span>)<br><br><span># ScaleData数据</span><br>all.genes &lt;- rownames(sce)<br>sce &lt;- ScaleData(sce,features = all.genes)<br><br><span># s和g2m期基因和数据集的基因取交集</span><br>s.genes &lt;- intersect(cc.genes$s.genes,rownames(sce))<br>g2m.genes &lt;- intersect(cc.genes$g2m.genes,rownames(sce))<br><br><span># 细胞周期分析</span><br>sce &lt;- CellCycleScoring(sce,<br>                        s.features = s.genes,<br>                        g2m.features = g2m.genes,<br>                        set.ident = <span>T</span>)<br><span># PCA可视化                       </span><br>sce &lt;- RunPCA(sce,features = c(s.genes,g2m.genes))<br>PCAPlot(sce,group.by = <span>"Phase"</span>)<br><span># S.Score评分</span><br>p1 = VlnPlot(ch1,<span>"S.Score"</span>,pt.size = <span>0</span>,group.by = <span>"Phase"</span>);p1<br><span># G2M.Score评分</span><br>p2 = VlnPlot(ch1,<span>"G2M.Score"</span>,pt.size = <span>0</span>,group.by = <span>"Phase"</span>);p2<br>wrap_plots(p1,p2,nrow = <span>1</span>) <br>ggsave(<span>"Cell_cycle_analysis.png"</span>,width = <span>18</span>,height = <span>6</span>,dpi = <span>300</span>)<br></code></pre><p data-tool="mdnice编辑器">这张图主要看数据是不是集中在0的附近，从图片看还是比较集中的。<img data-imgfileid="100001676" data-ratio="0.3333333333333333" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEDSDjpGfiba1kkPPTvyovOybxcwCXSGFGRkQQicbiaia14P3aCYuBnOKuQ8Y8UM9gTh0dShBWIgmicdXg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEDSDjpGfiba1kkPPTvyovOybxcwCXSGFGRkQQicbiaia14P3aCYuBnOKuQ8Y8UM9gTh0dShBWIgmicdXg/640?wx_fmt=png&amp;from=appmsg">下图是官网上的示例数据，左边是正常的，右边是不正常的！如果出现右边这样的就一定需要矫正哦~<img data-imgfileid="100001675" data-ratio="0.7133333333333334" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEDSDjpGfiba1kkPPTvyovOyHO0nT1JlEibiba4iaxg2Z5TFESaiczSy4mbEk76aqPKlPtwkFcBSibuYnTA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEDSDjpGfiba1kkPPTvyovOyHO0nT1JlEibiba4iaxg2Z5TFESaiczSy4mbEk76aqPKlPtwkFcBSibuYnTA/640?wx_fmt=png&amp;from=appmsg"></p><h5 data-tool="mdnice编辑器"><span></span>3、矫正之后检查数据<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code><span># 根据上面的结果决定是否要去矫正</span><br><span># 重新ScaleData这次用S.Score/G2M.Score数据去矫正</span><br>sce &lt;- ScaleData(sce,<br>                 vars.to.regress = c(<span>"S.Score"</span>, <span>"G2M.Score"</span>), <br>                 features = all.genes)<br><span># check一下</span><br><span># PCA可视化                       </span><br>sce &lt;- RunPCA(sce,features = c(s.genes,g2m.genes))<br>PCAPlot(sce,group.by = <span>"Phase"</span>)<br><span># S.Score评分</span><br>p1 = VlnPlot(ch1,<span>"S.Score"</span>,pt.size = <span>0</span>,group.by = <span>"Phase"</span>);p1<br><span># G2M.Score评分</span><br>p2 = VlnPlot(ch1,<span>"G2M.Score"</span>,pt.size = <span>0</span>,group.by = <span>"Phase"</span>);p2<br>wrap_plots(p1,p2,nrow = <span>1</span>) <br>ggsave(<span>"Cell_cycle_analysis_after.png"</span>,width = <span>18</span>,height = <span>6</span>,dpi = <span>300</span>)<br></code></pre><p data-tool="mdnice编辑器">关键代码是 sce &lt;- ScaleData(sce,vars.to.<strong>regress = c("S.Score", "G2M.Score")</strong>, features = all.genes)。</p><p data-tool="mdnice编辑器">其他接下来就是常规流程了，harmony整合，注释等等。</p><h4 data-tool="mdnice编辑器"><span></span>参考资料：<span></span></h4><p data-tool="mdnice编辑器">1、Seurat ：https://satijalab.org/seurat/articles/cell_cycle_vignette</p><p data-tool="mdnice编辑器">2、A single-cell resolution map of mouse hematopoietic stem and progenitor cell differentiation. Blood. 2016 Aug 25;128(8):e20-31.</p><p data-tool="mdnice编辑器">3、Complex Analysis of Single-Cell RNA Sequencing Data. Biochemistry (Mosc). 2023 Feb;88(2):231-252.</p><p data-tool="mdnice编辑器">4、Single-cell RNA-seq reveals changes in cell cycle and differentiation programs upon aging of hematopoietic stem cells. Genome Res. 2015 Dec;25(12):1860-72. doi: 10.1101/gr.192237.115</p><p data-tool="mdnice编辑器">5、生信星球：https://mp.weixin.qq.com/s/bJ0tNj4w5p4R1MX5RHG9Ng</p><p data-tool="mdnice编辑器">6、观科研：https://mp.weixin.qq.com/s/4KtwcV_eJnkdLfO47Yo_XA</p><p data-tool="mdnice编辑器">7、Top生物信息：https://mp.weixin.qq.com/s/tjP4sOXxGswxU8aOY00rjg</p><p data-tool="mdnice编辑器">8、老俊俊的生信笔记：https://mp.weixin.qq.com/s/i5ByW8L_X759hVoAYCWEsg</p><p data-tool="mdnice编辑器">9、生信百宝箱：https://mp.weixin.qq.com/s/kgNUodM18cCUls7ZQXYgEQ</p><p data-tool="mdnice编辑器"><strong>致谢</strong>：感谢曾老师、小洁老师以及生信技能树团队全体成员。</p><p data-tool="mdnice编辑器"><strong>注</strong>：若对内容有疑惑或者有发现明确错误的朋友，请联系后台(欢迎交流)。更多内容可关注公众号：<strong>生信方舟</strong></p><span>- END -</span></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/mlAhviD-7cyi891Xob1x3A",target="_blank" rel="noopener noreferrer">原文链接</a>
