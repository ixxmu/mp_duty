---
title: "不同单细胞群相关性分析：提示亚群之间具有相关性"
date: 2024-09-06T10:14:45Z
draft: ["false"]
tags: [
  "fetched",
  "生信小博士"
]
categories: ["Acdemic"]
---
不同单细胞群相关性分析：提示亚群之间具有相关性 by 生信小博士
------
<div><p><span><strong>文献里常遇到这种相关性热图：</strong><strong><img data-imgfileid="100004023" data-ratio="0.7240740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Sks4BzGvcmcviah5Mpvx967mA2EMOoX3uVOiajxJcdmQTbPIMXP7A08Lwj1gwHHvq6oMhyGzedk8ns9A/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Sks4BzGvcmcviah5Mpvx967mA2EMOoX3uVOiajxJcdmQTbPIMXP7A08Lwj1gwHHvq6oMhyGzedk8ns9A/640?wx_fmt=other&amp;from=appmsg"></strong></span></p><p>Immunophenotyping of COVID-19 and influenza highlights the role of type I interferons in development of severe COVID-19</p><section><br></section><p><img data-imgfileid="100004024" data-ratio="0.6623093681917211" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Sks4BzGvcmcviah5Mpvx967mAaxxj8H94NZqyrVVUpYgQeCiaaW1HAdPaAJm5jZjiaItnjUYj8LUlic7mg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="918" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/xVhD7345Sks4BzGvcmcviah5Mpvx967mAaxxj8H94NZqyrVVUpYgQeCiaaW1HAdPaAJm5jZjiaItnjUYj8LUlic7mg/640?wx_fmt=other&amp;from=appmsg"></p><p>Single-Cell Reconstruction of Progression Trajectory Reveals Intervention Principles in Pathological Cardiac Hypertrophy</p><section><br></section><section><br></section><blockquote data-type="2" data-url="" data-author-name="" data-content-utf8-length="115" data-source-title=""><section><section>相关性热图是一种在单细胞数据分析中常用的可视化工具，用于展示不同细胞群之间的相似性或差异性。在单细胞RNA测序(scRNA-seq)数据中，相关性热图可以帮助研究者识别具有相似表达模式的细胞群体，从而揭示细胞亚群的功能和发育轨迹。</section></section></blockquote><p><br></p><section><span></span></section><section><span>在构建相关性热图时，通常会使用皮尔森相关系数(Pearson correlation coefficient)或斯皮尔曼等级相关系数(Spearman's rank correlation coefficient)来量化细胞群之间的相关性</span><span><strong>。皮尔森相关系数用于测量两个连续变量之间的线性关系，其值介于-1和1之间，值越接近1或-1表示相关性越强，值为0表示没有线性相关性。</strong></span><span>斯皮尔曼等级相关系数是一种非参数方法，用于评估两个变量的等级顺序之间的相关性，适用于不满足正态分布的数据或有序分类变量。</span></section><section><span>在实际操作中，可以使用生物信息学工具和编程语言（如R语言）来生成相关性热图。例如，Seurat包中的相关性分析和热图绘制功能可以帮助研究者从单细胞数据中提取有意义的生物学信息。使用Seurat进行相关性分析时，可以选择标准差最大的基因来计算相关性，然后使用pheatmap包来绘制热图。此外，Scanpy也是一个流行的Python库，用于单细胞数据分析，它提供了简单易用的相关性热图绘制方法。</span></section><section><span>在解释相关性热图时，需要注意颜色的深浅代表了相关性的强度，而聚类树形图可以显示不同样本或细胞群的聚类关系。通过这种方式，研究者可以识别出具有相似基因表达模式的细胞群体，进而推断它们的生物学功能和相互作用。</span></section><section><br></section><section><span><strong><span>R语言实现</span></strong></span></section><section><span>使用R从Seurat对象中提取标准差最大的top基因计算相关性，用pheatmap画图。</span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>#2在seurat_v5文件夹下安装v5---</span></code><code><span>.libPaths(</span></code><code><span>  c(</span></code><code><span>    # '/home/rootyll/seurat_v5/',</span></code><code><span>    "/usr/local/lib/R/site-library",</span></code><code><span>    "/usr/lib/R/site-library",</span></code><code><span>    "/usr/lib/R/library"</span></code><code><span>  )</span></code><code><span>)</span></code><code><span>library(Seurat)</span></code><code><span>library(dplyr)</span></code><code><span><br></span></code><code><span><br></span></code><code><span>path="~/zxxxx/sepsis_celltype_correlation"</span></code><code><span>dir.create(path ,recursive = TRUE)</span></code><code><span>setwd(path)</span></code><code><span><br></span></code><code><span><br></span></code><code><span>load('../sepsis_cluster_merge.rds')</span></code><code><span>pbmc=All.merge</span></code><code><span>DimPlot(pbmc,label = TRUE,split.by = "stim")</span></code><code><span>head(pbmc@meta.data)</span></code><code><span><br></span></code><code><span><br></span></code><code><span><br></span></code><code><span>#all----</span></code><code><span>library(Seurat)</span></code><code><span><br></span></code><code><span>av &lt;-AverageExpression(pbmc,</span></code><code><span>                       group.by = "cell.type",</span></code><code><span>                       assays = "RNA")</span></code><code><span>av=av[[1]]</span></code><code><span>head(av)</span></code><code><span><br></span></code><code><span>#选出标准差最大的1000个基因</span></code><code><span>cg=names(tail(sort(apply(av, 1, sd)),1000))</span></code><code><span># #查看这1000个基因在各细胞群中的表达矩阵</span></code><code><span># View(av[cg,])</span></code><code><span># #查看细胞群的相关性矩阵</span></code><code><span># View(cor(av[cg,],method = 'spearman'))</span></code><code><span>#pheatmap绘制热图</span></code><code><span>pheatmap::pheatmap(cor(av[cg,],method = 'spearman')) #默认是Pearson</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100004025" data-ratio="0.8347578347578347" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks4BzGvcmcviah5Mpvx967mA5C1CLyHbse48XwOxQ5GMQZ5Hzvz8ibPIqCE9zKrrqGp7uMDjh6n8qmg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="702" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks4BzGvcmcviah5Mpvx967mA5C1CLyHbse48XwOxQ5GMQZ5Hzvz8ibPIqCE9zKrrqGp7uMDjh6n8qmg/640?wx_fmt=png&amp;from=appmsg"></p><p><span><strong>可以选择想要的组别<br></strong></span></p><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="makefile"><code><span>#cont----</span></code><code><span>pbmc=All.merge[,grepl("Con",All.merge$stim)]</span></code><code><span><br></span></code><code><span>av &lt;-AverageExpression(pbmc,</span></code><code><span>                       group.by = "cell.type",</span></code><code><span>                       assays = "RNA")</span></code><code><span>av=av[[1]]</span></code><code><span>head(av)</span></code><code><span><br></span></code><code><span>#选出标准差最大的1000个基因</span></code><code><span>cg=names(tail(sort(apply(av, 1, sd)),1000))</span></code><code><span># #查看这1000个基因在各细胞群中的表达矩阵</span></code><code><span># View(av[cg,])</span></code><code><span># #查看细胞群的相关性矩阵</span></code><code><span># View(cor(av[cg,],method = 'spearman'))</span></code><code><span># #pheatmap绘制热图</span></code><code><span>pheatmap::pheatmap(cor(av[cg,],method = 'spearman')) #默认是Pearson</span></code><code><span><br></span></code></pre></section><p><img data-galleryid="" data-imgfileid="100004026" data-ratio="0.8541666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks4BzGvcmcviah5Mpvx967mAF23Ua2ExQykibrTgxlHTmQVhVBCicKictqPlX1xCGojiad5r19LYKYrx2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="384" src="https://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks4BzGvcmcviah5Mpvx967mAF23Ua2ExQykibrTgxlHTmQVhVBCicKictqPlX1xCGojiad5r19LYKYrx2w/640?wx_fmt=png&amp;from=appmsg"></p><p>使用scanpy更简单</p><section><ul><li><li><li><li><li><li></ul><pre data-lang="typescript"><code><span>import scanpy as sc</span></code><code><span>adata = sc.datasets.pbmc68k_reduced()</span></code><code><span>sc.tl.dendrogram(adata, 'bulk_labels')</span></code><code><span>#sc.pl.dendrogram(adata, 'bulk_labels')</span></code><code><span>sc.pl.correlation_matrix(adata, 'bulk_labels', figsize=(5,3.5))</span></code><code><span><br></span></code></pre></section><h4><strong><span><br></span></strong></h4><h4><strong><span>相关性分析方法</span></strong></h4><p><span>多种相关性分析方法都可以探究变量之间的关系。这些方法各有特点，适用于不同的数据类型和研究场景。</span></p><ol><li><p><span>皮尔逊相关系数（Pearson Correlation）</span></p></li></ol><ul><li><p><span>这是一种衡量两个连续变量线性相关程度的参数检验方法。</span></p></li><li><p><span>其值域在-1到1之间，值越接近±1表示变量间的线性关系越强，而接近0则意味着线性关系较弱。</span></p></li><li><p><span>适用于两个变量均为正态分布的情况，可以直观地显示变量之间的正相关或负相关关系。</span></p></li></ul><li><p><span>斯皮尔曼等级相关系数（Spearman's Rank Correlation）</span></p></li><ul><li><p><span>这是一种非参数方法，通过比较变量的等级（或秩次）而不是实际值来评估它们之间的相关性。</span></p></li><li><p><span>适用于不满足正态分布假设的数据，或者当变量是有序分类而非连续数据时。</span></p></li><li><p><span>这种方法对异常值具有较强的鲁棒性，因为它不依赖于数据的具体数值。</span></p></li></ul><li><p><span>肯德尔等级相关系数（Kendall's Tau Correlation）</span></p></li><ul><li><p><span>另一种非参数相关性检验，用于衡量两个变量的等级顺序之间的关联。</span></p></li><li><p><span>它考虑了成对观测值之间的一致性和不一致性，适用于样本量较小或数据含有异质性的情况。</span></p></li></ul><li><p><span>其他相关性分析方法</span></p></li><ul><li><p><span>除了上述方法，还有诸如卡方检验（Chi-squared Test）和费舍尔精确检验（Fisher's Exact Test）等，这些方法主要用于分类变量之间的相关性分析。</span></p></li><li><p><span>卡方检验可以评估两个分类变量是否独立，而费舍尔精确检验则用于小样本数据的相关性分析。</span></p></li></ul><p><span>在实际应用中，选择哪种相关性分析方法取决于数据的特性、分布情况以及研究目的。正确选择和应用这些方法，可以帮助研究者更准确地理解和解释变量之间的关系。</span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg2NDcxMzYwNg==" data-headimg="http://mmbiz.qpic.cn/sz_mmbiz_png/xVhD7345Sks7JhVxUX46ZKxPSob6ptqIZgnIEnHOn5VMwCX8sN6MQy1Pq4XXFEOJ6grAmsoQugyCDKOZictDBHA/0?wx_fmt=png" data-nickname="生信小博士" data-alias="bioinformatics_Dr" data-signature="【生物信息学】R语言开始，学习生信。Seurat，单细胞测序，空间转录组。 Python，scanpy，cell2location。资料分享" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><section><ul><li></ul><pre data-lang="javascript"><code><span>参考：https:<span>//www.jianshu.com/p/d3786239f60e</span></span></code></pre></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pvbac1nczqN08-HCZbgqNA",target="_blank" rel="noopener noreferrer">原文链接</a>
