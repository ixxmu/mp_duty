---
title: "DeepVelo: 颠覆传统的单细胞速率分析——基于神经常微分方程的深度学习"
date: 2024-09-26T05:42:17Z
draft: ["false"]
tags: [
  "fetched",
  "生信宝库"
]
categories: ["Acdemic"]
---
DeepVelo: 颠覆传统的单细胞速率分析——基于神经常微分方程的深度学习 by 生信宝库
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>研究背景</span><span></span></h2><p data-tool="mdnice编辑器">单细胞测序技术（scRNA-seq）使我们能捕捉单个细胞的基因表达谱和RNA速度，从而为解析细胞状态转变背后的调控级联提供重要线索，这有助于研究者深入解析胚胎发育、组织再生以及肿瘤发生等关键生物学过程中的细胞状态转变。然而，scRNA-seq 只能呈现基因表达的“静态快照”，难以连续追踪相同细胞的转录组动态变化。因此，RNA velocity应运而生，但其只能在数小时的时间尺度上预测细胞未来的状态。为了解决RNA速度在时间范围预测上的局限性，科学家们开发了基于线性常微分方程（ODE）和稀疏近似的模型，试图预测细胞状态在更长时间段内的连续演变。然而，这些模型难以捕捉基因表达过程中潜在的非线性动态变化。</p><p data-tool="mdnice编辑器">常微分方程（ODE）：是描述系统状态随时间连续变化的数学模型。ODE 的形式为 dy/dt=f(y,t)，表示系统的状态 y随时间 t 的变化速率由一个函数 f 来决定。神经常微分方程（Neural Ordinary Differential Equations, Neural ODEs）则通过神经网络来表示常微分方程中的函数 f(y,t)，从而通过模拟系统在连续时间中的动态变化来预测输出。</p><p data-tool="mdnice编辑器">2022年 Sci Adi 杂志刊登了一篇文章“DeepVelo: Single-cell transcriptomic deep velocity field learning with neural ordinary differential equations”的研究文章。该研究开发了一种新的RNA速度预测方法DeepVelo。DeepVelo 使用变分自编码器（VAE）来预测基因表达的变化速率，并将其嵌入到常微分方程（ODE） 中，来模拟单个细胞内基因表达随时间的连续变化。这种方法能够捕捉复杂的非线性基因相互作用，从而对细胞未来状态的预测更加准确。其实我们最近也介绍了另一个同名的软件：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI4MjY5ODI1Nw==&amp;mid=2247492304&amp;idx=1&amp;sn=7a51433570a8927c9afe2f0367003517&amp;chksm=eb9755aedce0dcb8bae7222f0a6b7a99af527d34ac623e4fc478a4eec5cca70ab62330a8e8e6&amp;scene=21#wechat_redirect" textvalue="Genome Biology | 突破RNA速率分析新高度：DeepVelo如何征服多谱系数据" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Genome Biology | 突破RNA速率分析新高度：DeepVelo如何征服多谱系数据</a>，后面我们会专门出一期推文对这两种软件进行比较，敬请期待！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008694" data-ratio="0.562037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuauwUQZ3Uoib2lA2QdYXEFA6a47kqePzzhGotdw398RabG99BAXNauIEw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuauwUQZ3Uoib2lA2QdYXEFA6a47kqePzzhGotdw398RabG99BAXNauIEw/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>研究结果</span><span></span></h2><h4 data-tool="mdnice编辑器"><span></span><span>1.  使用神经ODE构建单细胞轨迹分析的通用框架</span><span></span></h4><p data-tool="mdnice编辑器">DeepVelo框架有两个主要步骤：推断基因相互作用和预测细胞的连续变化。第一步：DeepVelo将单细胞的基因表达与其随时间的变化联系起来。传统方法通常假设基因的相互作用是线性的，而DeepVelo引入了变分自编码器（VAE）模型fA，来捕捉复杂的非线性基因调控关系。通过这种方式，fA能够从任何细胞状态（无论是否有实际测量数据）直接估计基因表达的变化。第二步：给定一个接近实际数据的初始基因表达状态，可以与任何黑箱常微分方程（ODE）求解器进行数值积分（比如欧拉法）来计算未来（或过去）的基因表达状态。例如，在时间t=0时，基因表达状态是x0，我们可以通过计算 x1, x2,… 依次预测接下来的基因表达状态，最终绘制出细胞的发育轨迹。此外，使用不同的初始状态，我们可以推断出不同细胞状态的未来变化。</p><p data-tool="mdnice编辑器">在本篇文章中，研究者探索了DeepVelo在单细胞RNA测序数据分析中的三个主要应用：</p><ol data-tool="mdnice编辑器"><li><section>通过将动力学外推到样本外细胞，模拟并去噪发育轨迹；</section></li><li><section>通过沿着模拟轨迹跟踪基因表达变化，评估细胞状态的不稳定性；</section></li><li><section>通过计算机模拟研究，以探讨初始基因表达条件的扰动如何影响细胞分化的命运。</section></li></ol><p data-tool="mdnice编辑器">下面分别从这三个方面展开介绍：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008693" data-ratio="0.850925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaVYRZzG5loqvfib5iaUjWY8T5IGQz5lfYzG5Xw8qMwAOyOpxHTicjAzhIA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaVYRZzG5loqvfib5iaUjWY8T5IGQz5lfYzG5Xw8qMwAOyOpxHTicjAzhIA/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span><span>1.1、模拟并去噪后构建细胞发育轨迹</span><span></span></h5><p data-tool="mdnice编辑器">为了评估DeepVelo能否从稀疏且有噪声的单细胞RNA测序数据中找出动态变化，研究者使用了一个来自小鼠胰腺发育的数据集。结果表明，使用神经ODE来描述和分析细胞发育过程中基因表达变化的动态，可以对数据获得新的见解，并进一步帮助我们理解胰腺的发育过程。</p><p data-tool="mdnice编辑器">研究者首先用DeepVelo训练了胰腺发育过程中的细胞状态和RNA 速度（基因表达随时间的变化）并模拟了一个假设性的细胞发育轨迹。通过向现有细胞的基因表达状态添加噪声来模拟样本外细胞，从而表示数据中先前不存在的细胞状态。将样本外细胞作为起点，用DeepVelo进行计算，预测了这个细胞未来的发育轨迹：从内分泌前体细胞，逐渐发育成前内分泌细胞，最后变成β细胞。研究利用数学模型计算细胞状态的变化，发现基因表达变化快的地方，细胞状态之间的距离比较大；变化慢的地方，细胞状态之间就比较密集。在训练过程中，DeepVelo 的模型会自动调整，确保在它的嵌入空间中，相似的细胞状态和速度信息被紧密地表示在一起。训练完成后，这个嵌入空间就可以用来更好地解释基因表达和发育过程。相比于只考虑基因表达的嵌入，这种结合了RNA 速度信息的模型能更清晰地展示细胞的发育轨迹。例如，在胰腺的发育过程中，可以观察到细胞是如何从起点状态（比如导管细胞）逐渐发育到终点状态（比如α细胞和β细胞）。这些信息能够帮助我们评估DeepVelo对新细胞发育轨迹的预测是否准确。</p><p data-tool="mdnice编辑器">简而言之，DeepVelo不仅能够模拟细胞的发育轨迹，还可以预测那些未在原始数据中出现的新细胞的未来发育过程。通过结合基因表达和RNA速度信息，DeepVelo能够更加全面地捕捉发育中的动态变化。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008691" data-ratio="0.27870370370370373" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua0645ia8FMgqic5z3YVbIWBgqylM3vNEiazC27bdkzC5ab2gYDic0HTrnlw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua0645ia8FMgqic5z3YVbIWBgqylM3vNEiazC27bdkzC5ab2gYDic0HTrnlw/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span><span>1.2、评估细胞状态的不稳定性</span><span></span></h5><p data-tool="mdnice编辑器">研究人员通过DeepVelo模拟了单细胞在时间维度上的动态变化，重点分析了细胞在发育过程中稳定与不稳定的固定点。稳定表示细胞在基因表达上不容易发生变化，而不稳定意味着细胞容易受到基因表达变化的影响。由于scVelo只能捕捉瞬时变化，DeepVelo通过生成假设的时间轨迹，可以更好地预测细胞未来的变化趋势。为了评估细胞状态的未来不稳定性，研究人员引入了细胞临界指数（CCI），这是一种通过累积Kullback-Leibler (KL) 散度计算的指标，用于表示每个时间点之间的基因表达分布差异。简单来说，CCI评估了细胞在发育轨迹中从当前状态到终末状态演变过程中，基因表达变化的幅度。CCI越高，说明细胞基因表达变化越剧烈，状态越不稳定；相反，CCI越低则表示细胞状态较为稳定。</p><p data-tool="mdnice编辑器">研究发现，内分泌祖细胞在发育过程中具有较高的临界性，意味着其处于不稳定的转折点，容易发生命运承诺或不可逆转的变化（指细胞在这一阶段会做出不可逆的分化决定）；相比之下，导管细胞和分化的内分泌细胞具有较低的临界性，状态相对稳定。CCI不仅揭示了类似于经典Waddington景观的细胞发育的拓扑结构，还与一些关键基因（如Neurog3和ATP1b1）的表达高度相关，进一步证明CCI可以作为衡量单细胞状态不稳定性的有效指标，并为理解发育过程中关键细胞状态的相对时序提供了新的视角。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008692" data-ratio="0.4740740740740741" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua07F98LqrVoUdIytrzuu0E8wDHRnSib9Bob4KK4rAqUenaDhagBqpyEA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua07F98LqrVoUdIytrzuu0E8wDHRnSib9Bob4KK4rAqUenaDhagBqpyEA/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span><span>1.3、模拟扰动研究</span><span></span></h5><p data-tool="mdnice编辑器">研究人员通过体外计算模拟扰动探究了胰腺内分泌细胞发育过程中的关键基因及其对细胞分化的影响。使用前内分泌细胞（n=592）作为初始条件，并利用K最近邻分类器分析内分泌前体细胞的命运分化，模拟发现细胞在发育过程中分化为α细胞和β细胞的比例为1:1.57，类似于小鼠胰腺中α和β细胞的比例，表明β细胞是更强的终末状态。通过对不同分化命运的前体细胞进行基因表达差异分析，研究人员识别出一些关键驱动基因，推测这些基因在分化路径中发挥重要作用。为了验证这一点，他们模拟了每次激活一个与α细胞相关的差异表达基因，结果发现部分基因的激活显著增加了α细胞的分化比例。这表明，即使是基因表达上的微小扰动，也能显著影响细胞的分化方向，导致不同的发育结果。整体而言，这项研究揭示了胰腺细胞发育具有类似混沌系统的特性，表明细胞在发育早期的基因表达状态可以决定其最终命运，且小幅度的初始变化可能带来显著改变的下游分化结果。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008695" data-ratio="0.275" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaHicyz76GkWUHHlDp94EceMMn1Nso99kOvOqFTkChPr1XkNDUHoVfsZg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaHicyz76GkWUHHlDp94EceMMn1Nso99kOvOqFTkChPr1XkNDUHoVfsZg/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>2.  探索控制发育中的小鼠齿状回的神经ODEs</span><span></span></h4><p data-tool="mdnice编辑器">此外，该研究还评估了DeepVelo在不同组织、发育时间尺度和技术平台下揭示scRNA-seq数据集动态特征的能力。通过对小鼠齿状回发育中的scRNA-seq数据进行分析，研究团队利用DeepVelo模拟了细胞的发育轨迹，并计算了细胞的CCI。结果表明，关键基因（如IGFBPL-1和GRM5）与CCI高度相关，影响了细胞命运的选择。通过体外模拟扰动实验，研究进一步确定了发育驱动基因，如Runx1t1和Prox1，这些基因影响了颗粒细胞和锥体神经元的发育路径。总体而言，研究表明DeepVelo可以有效识别不同发育阶段的关键基因，并为低成本地发现发育驱动基因提供了一种新的方法。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008699" data-ratio="1.0185185185185186" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaPibkZuXVdVSJ9FscUTtibZsAQsf7OOIYmUhJEm300yJyZcVicjjDZqaKQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvuaPibkZuXVdVSJ9FscUTtibZsAQsf7OOIYmUhJEm300yJyZcVicjjDZqaKQ/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>3.  制定描述小鼠新皮层在多个胚胎发育天数中的神经ODEs</span><span></span></h4><p data-tool="mdnice编辑器">研究者进一步评估了DeepVelo能否模拟更复杂的生物发育过程中不同细胞的动态变化。研究分析了小鼠新皮层在胚胎发育第14、15、16和17天的scRNA-seq数据。经过批次校正和速度场学习后，模拟了一个中间祖细胞（IP）的发育轨迹，显示出该细胞从IP转变为迁移神经元（MN），最终发育为皮质下神经元（CFN）。IP向MN转变的速度较快，表明其基因表达发生了更广泛的变化。通过分析细胞临界性指数（CCI），研究发现IP和MN具有较高的临界性，而顶端祖细胞（AP）则具有较低的临界性，这表明AP更倾向于自我更新，而IP预先设定为神经分化。DeepVelo还揭示了MN向内端脑神经元（ITN）和CFN分化的分支动态。通过扰动与ITN命运相关的基因表达，ITN的比例增加了10%，表明DeepVelo可以准确学习小鼠新皮层多个胚胎发育天中的基因表达动态，并识别在发育过程中起关键作用的驱动基因。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100008701" data-ratio="0.7444444444444445" data-src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua9XOzDjyv2Wtg9Swtowhxl2DjzVJiaCkE5Jib2f6iaEbSfz0xHOgChZticg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7ffOAexSkccU4H5VKk3ibvua9XOzDjyv2Wtg9Swtowhxl2DjzVJiaCkE5Jib2f6iaEbSfz0xHOgChZticg/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>4.  用逆行轨迹重建基因共表达网络</span><span></span></h4><p data-tool="mdnice编辑器">基因共表达网络用于连接未知功能的基因与生物过程，识别转录调控关系，并优先选择遗传疾病的候选基因。单细胞RNA测序（scRNA-seq）因其单细胞分辨率和细胞类型特异性，适合解析这些网络，但由于数据稀疏性和噪声，检测基因相关性具有计算挑战性。为此，提出使用DeepVelo的去噪变分自编码器（VAE）减少这些问题。通过逆转发育轨迹，逆向轨迹反映了终末细胞类型中的基因动态。基准测试结果显示，逆行轨迹中的去噪动态细胞形成的功能性基因模块在细胞类型特异性GO术语上的富集程度提高了至少两个数量级。因此，DeepVelo能够有效地解析与发育轨迹相关的基因调控网络，显著提升单细胞基因共表达网络中的信噪比。</p><h4 data-tool="mdnice编辑器"><span></span><span>5.  DeepVelo与现有方法的比较</span><span></span></h4><p data-tool="mdnice编辑器">DeepVelo在质上区别于现有的基于常微分方程（ODE）的调控网络推断软件，它不仅能够处理高维数据并扩展到大量变量，还通过神经网络捕捉潜在的非线性基因交互，这比线性ODE和其他方法更适合建模复杂的生物过程。与线性方法和SparseVFC方法相比，DeepVelo在RNA速度预测中表现更为准确，误差减少了至少50%。此外，DeepVelo在运行时间和内存使用上也可以通过GPU加速，并且使用RNA速度作为时间度量，比传统的伪时间方法更具时间分辨率。</p><h2 data-tool="mdnice编辑器"><span></span><span>Whipple点评：</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>总体而言，该研究开发了一种基于神经常微分方程的计算框架——DeepVelo，区别于以往的“静态快照”，它能够从单细胞RNA测序数据中建模连续时间的转录动力学。DeepVelo 在解析调控轨迹、突出关键细胞状态以及优先识别发育驱动基因方面展现了强大潜力。值得一提的是，DeepVelo 能有效解析与发育轨迹相关的基因调控网络，这为研究细胞动态发育轨迹提供了一个极具价值的工具，在单细胞测序数据的应用中具有广泛前景。</p></blockquote><p data-tool="mdnice编辑器">全文链接：https://pubmed.ncbi.nlm.nih.gov/36449617/</p><p><img data-imgfileid="100008705" data-ratio="1" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg" data-type="jpeg" data-w="344" src="https://mmbiz.qpic.cn/mmbiz_jpg/GL6g5Y3aR7eUr3zZytdDPl7kPJBscWxTDlwbSxRjmMoYpSCSmlGicFibnLH3pvictSibFwekOaooibv9Ria0zSCrC2icg/640?wx_fmt=jpeg"></p><h3 data-tool="mdnice编辑器"><span>关注公众号，下回更新不迷路</span></h3><section><br></section><section><mp-common-profile data-pluginname="mpprofile" data-weui-theme="light" data-id="MzI4MjY5ODI1Nw==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/GL6g5Y3aR7f0yanILMQZCnw1duTMROQRvgDqVjlYcrljTRy1E4ZLppLG6zicdd3h0IwjLpxnum1V5KsowibJM1sw/0?wx_fmt=png" data-nickname="生信宝库" data-alias="sxbk2020" data-signature="本公众号只用于生信知识的收集与传播，以及生信人之间互相交流和学习，不会涉及任何商业利益。本公众号各小编平时忙于科研，更新文章较其它同类型公众号较慢，但保持宁缺毋滥的本心，只更新对大家有用的推文。" data-from="2" data-is_biz_ban="0"></mp-common-profile></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/1SOPXoFulr_P0s3bkBxDQA",target="_blank" rel="noopener noreferrer">原文链接</a>
