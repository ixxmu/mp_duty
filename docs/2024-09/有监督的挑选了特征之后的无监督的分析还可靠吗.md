---
title: "有监督的挑选了特征之后的无监督的分析还可靠吗"
date: 2024-09-12T01:40:06Z
draft: ["false"]
tags: [
  "fetched",
  "生信技能树"
]
categories: ["Acdemic"]
---
有监督的挑选了特征之后的无监督的分析还可靠吗 by 生信技能树
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">层次聚类（Hierarchical Clustering）和主成分分析（PCA）都是无监督学习方法，它们可以用来探索样品之间的关系，而不需要预先定义的类别或标签 ，其中：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>层次聚类（Hierarchical Clustering）</strong>：</p></section></li></ol><ul><li><section>层次聚类是一种聚类算法，通过构建一个多层次的嵌套聚类树来组织数据。</section></li><li><section>它不需要预先指定聚类的数量，而是生成一个聚类树（树状图或dendrogram），可以从中选择不同的切割点来得到不同数量的聚类。</section></li><li><section>层次聚类可以是凝聚的（从单个样本开始，逐步合并聚类）或分裂的（从所有样本作为一个聚类开始，逐步分割）。</section></li></ul><li><section><p><strong>主成分分析（PCA）</strong>：</p></section></li><ul><li><section>PCA是一种降维技术，通过线性变换将数据投影到较低维度的空间，同时尽可能保留原始数据的变异性。</section></li><li><section>它通过找到数据中方差最大的方向（主成分），并将数据投影到这些方向上，从而揭示样品之间的结构关系。</section></li><li><section>PCA通常用于数据可视化和预处理，帮助识别数据中的模式和结构。</section></li></ul><p data-tool="mdnice编辑器">这两种方法在生物信息学、基因表达分析、图像处理等领域有广泛的应用。层次聚类更多地用于探索样品的分类和分组，而PCA则常用于数据的可视化和预处理，以便于进一步分析。在实际应用中，这两种方法可以结合使用，先通过PCA降维以减少计算复杂性，然后使用层次聚类来探索样品之间的关系。</p><p data-tool="mdnice编辑器">既然这两个分析都是无监督的， 所以理论上我们应该是针对整个表达量矩阵进行分析，也有时候我们会对表达量矩阵进行简单的过滤，<strong> 但是这个操作仍然是无偏倚的。比如过滤那些在所有的样品都不表达的基因或者都低表达量基因，或者按照表达量的sd或者mad排序后选择top的基因即可</strong>，以下是一些常见的过滤原因和策略的解释 ：</p><ol data-tool="mdnice编辑器"><li><section><p><strong>移除不表达的基因</strong>：</p></section></li></ol><ul><li><section>这些基因在所有样品中的表达量都很低或为零，表明它们在实验条件下可能不活跃或不相关，因此可能不会对研究结果产生显著影响。</section></li></ul><li><section><p><strong>移除低表达量基因</strong>：</p></section></li><ul><li><section>低表达量基因可能受到技术噪声的影响较大，导致分析结果的假阳性率增加。过滤这些基因可以减少噪声，提高数据的信噪比。</section></li></ul><li><section><p><strong>基于表达量的方差（SD）或绝对偏差（MAD）</strong>：</p></section></li><ul><li><section>基因表达量的方差或绝对偏差可以反映基因表达在不同样品间的变异性。选择变异性大的基因可能更有可能揭示生物学上重要的变化。</section></li></ul><li><section><p><strong>选择表达量排名靠前的基因</strong>：</p></section></li><ul><li><section>选择表达量排名靠前的基因（例如，表达量最高的基因）可以专注于那些在细胞中活跃并且可能对生物学过程有重要贡献的基因。</section></li></ul><li><section><p><strong>提高统计分析的统计能力</strong>：</p></section></li><ul><li><section>过滤掉不相关或低质量的数据可以减少数据集的复杂性，使得统计分析更加集中于那些更有可能产生显著结果的基因。</section></li></ul><li><section><p><strong>减少计算资源的消耗</strong>：</p></section></li><ul><li><section>过滤掉一部分基因可以减少数据集的大小，从而减少计算资源的消耗，加快分析速度。</section></li></ul><li><section><p><strong>专注于生物学意义</strong>：</p></section></li><ul><li><section>通过过滤，研究者可以专注于那些最有可能与研究假设相关的基因，从而提高发现生物学意义的可能性。</section></li></ul><li><section><p><strong>数据预处理</strong>：</p></section></li><ul><li><section>在某些情况下，过滤是数据预处理的一部分，有助于标准化数据并为后续的高级分析（如聚类、差异表达分析等）做准备。</section></li></ul><p data-tool="mdnice编辑器">需要注意的是，过滤策略应该根据研究目的、数据特性和生物学假设来定制。<span><strong>过度过滤可能会导致重要信息的丢失，而过滤不足则可能包含过多的噪声</strong></span>。因此，在过滤之前，研究者应该仔细考虑过滤标准和预期的分析目标。</p><p data-tool="mdnice编辑器">但是不能是有监督的挑选特征，比如这个文献，题目为“Revealing the transcriptional heterogeneity of organ-specific metastasis in human gastric cancer using single-cell RNA Sequencing”。<strong>这个胃癌单细胞数据集GSE163558的如下所示样品相关性热图就有瑕疵了，因为作者是挑选了差异表达基因的矩阵进行层次聚类相关性热图：</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100049860" data-ratio="0.7231481481481481" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyt0ib2dmzuhyr9tJhzdRCx5PdxZ7cqXUzrMxPGpoMVE2GXx9Cb0LtSOhA9N14TlMPE8Gs6U5F8bRg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyt0ib2dmzuhyr9tJhzdRCx5PdxZ7cqXUzrMxPGpoMVE2GXx9Cb0LtSOhA9N14TlMPE8Gs6U5F8bRg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">作者使用上面的图确实是想说明作者自己的胃部正常组织样品是跟2020的那个CCR文章里面的胃部正常组织样品的3个样品的相似性要高于作者自己的非胃部正常组织样品的。</p><p data-tool="mdnice编辑器">但是作者作者是挑选了差异表达基因，就是胃部正常组织样品去跟胃癌组织样品的表达量差异，这样的话当然是作者自己的胃部正常组织样品是跟2020的那个CCR文章里面的胃部正常组织样品的3个样品的相似性要高于作者自己的非胃部正常组织样品的。</p><h3 data-tool="mdnice编辑器"><span></span><span>可以同时量化不同样品的不同单细胞亚群的相关性</span><span></span></h3><p data-tool="mdnice编辑器">使用如下所示的代码：</p><pre data-tool="mdnice编辑器"><span></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>)<br><br><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><span>library</span>(clustree)<br><span>library</span>(cowplot)<br><span>library</span>(dplyr)<br><span>library</span>(stringr)<br><span>library</span>(ggsci) <br><span>library</span>(patchwork) <br><span>library</span>(ggsci)<br><span>library</span>(ggpubr)<br><span>library</span>(RColorBrewer) <br>sce.all = readRDS(<span>'./2-harmony/sce.all_int.rds'</span>)<br>sp=<span>'human'</span> <br>load(<span>'./phe.Rdata'</span>) <br>identical(rownames(phe) , colnames(sce.all))<br>sce.all@meta.data = phe<br>sel.clust = <span>"celltype"</span><br>sce.all &lt;- SetIdent(sce.all, value = sel.clust)<br>table(sce.all@active.ident) <br>DimPlot(sce.all)  <br><span># v4 是 AverageExpression</span><br>av &lt;-AggregateExpression(sce.all ,<br>                         group.by = c(<span>"orig.ident"</span>,<span>"celltype"</span>),<br>                         assays = <span>"RNA"</span>) <br>av=as.data.frame(av[[<span>1</span>]])<br>head(av) <span># 可以看到是整数矩阵</span><br><span>#write.csv(av,file = 'AverageExpression-0.8.csv')</span><br>cg=names(tail(sort(apply(log(av+<span>1</span>), <span>1</span>, sd)),<span>1000</span>)) <br>df =cor(as.matrix(log(av[cg,]+<span>1</span>)))<br>ac=as.data.frame(str_split(colnames(df),<span>'_'</span>,simplify = <span>T</span>))<br>rownames(ac)=colnames(df)<br>pheatmap::pheatmap(df ,<br>                   show_colnames = <span>F</span>,show_rownames = <span>F</span>,<br>                   annotation_col = ac,<br>                   filename = <span>'cor_celltype-vs-orig.ident.pdf'</span> ) <br>dev.off()<br>save(av,file = <span>'av_for_pseudobulks.Rdata'</span>) <br></code></pre><p data-tool="mdnice编辑器">得到如下所示的层次聚类的样品相关性热图：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100049861" data-ratio="1.038888888888889" data-src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyt0ib2dmzuhyr9tJhzdRCx5M2E9aOnE2wj4Xy2zhUiaRibe0Ye6T5yiaGoItoI0Zbbsbj7aG7bVUO8OA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/cZNhZQ6j4wyt0ib2dmzuhyr9tJhzdRCx5M2E9aOnE2wj4Xy2zhUiaRibe0Ye6T5yiaGoItoI0Zbbsbj7aG7bVUO8OA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以很明显的可以看到不同样品的同一个单细胞亚群还是会优先聚集到一起的。这个也是符合生物学常识的，肿瘤微环境里面的3大亚群，就是上皮细胞和免疫细胞，以及间质细胞。绝大部分文章都是抓住免疫细胞亚群进行细分，包括淋巴系（T,B,NK细胞）和髓系（单核，树突，巨噬，粒细胞）的两大类作为第二次细分亚群。但是也有不少文章是抓住stromal 里面的 fibro 和endo进行细分，并且编造生物学故事的。</p><p data-tool="mdnice编辑器"><strong>不同的样品虽然是有生物学来源差异，不足以让一个t细胞去跟上皮细胞更加相似的。除非它们都处于某种生物学状态，比如细胞增殖，或者说它们都有双细胞的特性等等。</strong></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span>写在文末</span></h3></section><p>如果你也想做单细胞转录组数据分析，<span>最好是有自己的计算机资源哦，比如我们的</span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;scene=21#wechat_redirect" data-linktype="2">2024的共享服务器交个朋友福利价仍然是800</a><span>，而且还需要有基本的生物信息学基础，也可以看看我们的</span><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531929&amp;idx=1&amp;sn=f6f16b7bf6b907360d6d0052e3d10cf6&amp;chksm=9b4b3d22ac3cb434b6aa7753a4cf0f266578147ccf10b49cc834e46af578ee6de99be0accb30&amp;scene=21#wechat_redirect" textvalue="生物信息学马拉‍松授课（买一得五）" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">生物信息学马拉松授课（买一得五）</a><span> ，你的生物信息学入门课。 </span></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/G1IMM1yZnxpeEYvWhBUsbw",target="_blank" rel="noopener noreferrer">原文链接</a>
