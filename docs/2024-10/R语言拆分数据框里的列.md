---
title: "R语言拆分数据框里的列"
date: 2024-10-05T09:12:41Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
R语言拆分数据框里的列 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><h2 data-tool="mdnice编辑器"><span></span><span>应用场景</span><span></span><span> </span></h2><p data-tool="mdnice编辑器">用emapper去做功能注释，gene id 和对应的GO格式如下</p><pre data-tool="mdnice编辑器"><span></span><code>gene01 GO:001,GO002<br>gene02 GO:001,GO002,GO003<br></code></pre><p data-tool="mdnice编辑器">需要把这个格式转换成下面的格式</p><pre data-tool="mdnice编辑器"><span></span><code>gene01 GO:001<br>gene01 GO:002<br>gene02 GO:001<br>gene02 GO:002<br>gene02 GO:003<br></code></pre><p data-tool="mdnice编辑器">一个思路是把第二列进行拆分，然后，款格式转换为长格式然后再去除缺失值就行了</p><p data-tool="mdnice编辑器">拆分列的话可以用separate这个函数，但是这个函数需要指定拆分以后得列的名子，如果数据少还好说，但是数据多的话不知道会拆分出多少列</p><p data-tool="mdnice编辑器">还有一种办法是借助nest()函数</p><h2 data-tool="mdnice编辑器"><span></span><span>示例代码如下</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>data.frame(gene_id=c("gene01","gene02"),<br>           go=c("GO:001,GO:002","GO:001,GO:002,GO:003")) %&gt;% <br>  nest(.by="gene_id") %&gt;% <br>  mutate(newcol=map(data,function(x){str_split(x,pattern=",",simplify = TRUE) %&gt;% as.data.frame()})) %&gt;% <br>  unnest(newcol)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014403" data-ratio="0.21616358325219084" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4Egw4icnXgWXM0F4Uicu2UtR0SOhPgdBXzqzDyN9QXJgkPiaK4pJVl6swY90wZFmJ11laZHsrbbBQBQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1027" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4Egw4icnXgWXM0F4Uicu2UtR0SOhPgdBXzqzDyN9QXJgkPiaK4pJVl6swY90wZFmJ11laZHsrbbBQBQ/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><span></span><code>data.frame(gene_id=c("gene01","gene02"),<br>           go=c("GO:001,GO:002","GO:001,GO:002,GO:003")) %&gt;% <br>  nest(.by="gene_id") %&gt;% <br>  mutate(newcol=map(data,function(x){str_split(x,pattern=",",simplify = TRUE) %&gt;% as.data.frame()})) %&gt;% <br>  unnest(newcol) %&gt;% <br>  dplyr::select(-data) %&gt;% <br>  pivot_longer(!gene_id) %&gt;% <br>  na.omit() %&gt;% <br>  dplyr::select(-name)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014404" data-ratio="0.425531914893617" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4Egw4icnXgWXM0F4Uicu2UtRSkX7HMLeQ84ibsnsJQNlZz94mHB4MxHibnLFmvdb6PzfNbqzq5Eia0gzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="940" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk4Egw4icnXgWXM0F4Uicu2UtRSkX7HMLeQ84ibsnsJQNlZz94mHB4MxHibnLFmvdb6PzfNbqzq5Eia0gzg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/gbIecLLUrM93348_5Rf5jg",target="_blank" rel="noopener noreferrer">原文链接</a>
