---
title: "monocle2拟时序分析 笔记"
date: 2024-10-16T02:01:27Z
draft: ["false"]
tags: [
  "fetched",
  "生信漫漫学"
]
categories: ["Acdemic"]
---
monocle2拟时序分析 笔记 by 生信漫漫学
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span></span><span>写在开头</span><span></span></h3><p data-tool="mdnice编辑器"><strong>叮！笔记整理第二弹——monocle2拟时序分析，还是一样的，前辈们已经整理了太多有用的资料，我就浅浅汇总摘抄一下叭！</strong></p><p data-tool="mdnice编辑器"><strong>本来前段时间整理学徒笔记的时候，就整理了一篇非常详细的拟时序分析相关的推文——<a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247489687&amp;idx=1&amp;sn=ff452636abb2044d0e509cff7a411403&amp;scene=21#wechat_redirect" data-linktype="2">单细胞测序—拟时序分析综合</a>，仔细读完之后发现是拟时序分析高级版hhh</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006512" data-ratio="0.487962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqicDodOK7bkibN546UXvbX4uVluLPwfiaq5G5RNpOJLxg2JuJMHAs34AA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqicDodOK7bkibN546UXvbX4uVluLPwfiaq5G5RNpOJLxg2JuJMHAs34AA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>所以又搜罗了一批推文，进行了阅读整理与汇总，本着独乐乐不如众乐乐的原则分享给大家！</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006510" data-ratio="0.4740740740740741" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtLSZB9WLicSR0H0rOga4qQ4MJ3wYicY5s9u3WQ2EJ33jiaFbDyna34dFRg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtLSZB9WLicSR0H0rOga4qQ4MJ3wYicY5s9u3WQ2EJ33jiaFbDyna34dFRg/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>背景知识</span><span></span></h2><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzkzNzQxMjQ4MA==&amp;mid=2247496625&amp;idx=1&amp;sn=1f30ac4d4b7bda7721e8f2fe7fa4fec6&amp;scene=21#wechat_redirect" data-linktype="2">单细胞组学 | 第28期. 拟时序分析，看这里！</a></span><span></span></h4><blockquote data-tool="mdnice编辑器"><span></span><p>拟时序分析（Pseudotime Analysis），又称细胞轨迹分析（Cell Trajectory Analysis），是一种在单细胞转录组学中常用的方法，通过对细胞在特定生物过程中的转录组数据进行排序，推断其发展或变化的时间顺序。</p></blockquote><p data-tool="mdnice编辑器">尽管单细胞数据通常是静态的（在一个时间点采集），<strong>拟时序分析通过基因表达的变化模式来重建细胞的发育轨迹或动态过程，从而模拟细胞随时间推移的变化，揭示细胞在不同状态下的演变路径和关键转折点。</strong></p><p data-tool="mdnice编辑器"><strong><span>拟时序分析的主要目的包括：</span></strong></p><p data-tool="mdnice编辑器"><span>1. 推断细胞的发育阶段：</span>通过分析基因表达变化，将处于不同分化阶段的细胞排序，模拟出一个拟时间轴。</p><p data-tool="mdnice编辑器"><span>2. 识别关键的基因调控事件：</span>通过比较不同拟时间阶段的细胞，识别在特定转折点上调或下调的基因，找出与细胞分化或功能转换相关的关键分子。</p><p data-tool="mdnice编辑器"><span>3. 推断细胞状态转换：</span>分析细胞从一种状态向另一种状态过渡的动态变化，尤其在干细胞分化或疾病模型中应用广泛。</p><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAwMzIzOTk5OQ==&amp;mid=2247519064&amp;idx=1&amp;sn=173948cb696c7d33b90cd21b28986777&amp;scene=21#wechat_redirect" data-linktype="2">拟时序分析神包—monocle的三篇《Nature》</a>——文献集锦及简单解读</span><span></span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100006508" data-ratio="1.2132196162046909" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtanFzsooFKnNP2KlJuSrvricwicUXceFakiaswKZs9KxMoJWxh44I3Bvvg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="469" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtanFzsooFKnNP2KlJuSrvricwicUXceFakiaswKZs9KxMoJWxh44I3Bvvg/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span><span>拟时序一本通系列</span></span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528633&amp;idx=1&amp;sn=4a0b154bdc8ac4797c3d00f08f0eeeab&amp;scene=21#wechat_redirect" textvalue="‍为什么做拟时序（拟时序一本通01）‍" linktype="text" imgurl="" imgdata="null" tab="innerlink" data-linktype="2">为什么做拟时序（拟时序一本通01）</a></span><span></span></h4><h4 data-tool="mdnice编辑器"><span></span><span>有了差异分析还不够？</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section><p>可以针对均一性比较好的亚群细化后的不同编号的亚群进行算法层面的特异性基因或者通路，但是特异性基因靠的是差异分析，是不同细胞亚群直接的差异分析，它这个<strong>差异分析的单位是细胞亚群而不是具体的每个细胞本身</strong>。</p></section></li><li><section><p>单细胞转录组的优点应该是到单细胞分辨率，但是<strong>绝大部分的分析其实是仅仅是到了细胞亚群的分辨率</strong>，两个细胞亚群之间肯定是有各自的差异基因列表，但是因为这些细胞亚群是来自于一个均一性比较好的亚群所以 它们其实细化的时候很难有绝对的分界线，或者说它们之间就算是有分界线这个分界线也是可以打破的。</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006511" data-ratio="1.086896551724138" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtZicvcgkrPL0pmESc2nFSxEtueVPvKR298WksLyDAarMnz6ricM1icgOvQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="725" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtZicvcgkrPL0pmESc2nFSxEtueVPvKR298WksLyDAarMnz6ricM1icgOvQ/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section>简单的差异分析是计算出来具体的基因在不同细胞亚群的变化倍数，统计学指标即可。</section></li><li><section>而要<strong>展示差异分析的细节，就不能是以细胞亚群为单位，而需要具体到每个细胞本身，去看看具体的基因是如何在这两个单细胞亚群的具体的细胞之间慢慢的变化</strong>。</section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span>monocle2的拟时序分析</span><span></span></h4><p data-tool="mdnice编辑器">基于前面的CD14和CD16的单核细胞两个细胞亚群上面的组成的对象，使用monocle2做拟时序分析</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006509" data-ratio="0.7974137931034483" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtImxPeiaMyL5pTTQn0WblhIe9l8arQILWFL4vvytgooPibnq19swSM08Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="696" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtImxPeiaMyL5pTTQn0WblhIe9l8arQILWFL4vvytgooPibnq19swSM08Q/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section>拟时序分析后产生的  Pseudotime 和State</section></li><li><section>拟时序的算法层面来说，是CD16的单核细胞慢慢演变成为了两种截然不同的CD14的单核细胞</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006515" data-ratio="0.6339393939393939" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtPjlM7nibfxTD0Gcy0VVnLY7ib7akFO2iaibJe0sXmABKOicVTVPn6klwlSw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtPjlM7nibfxTD0Gcy0VVnLY7ib7akFO2iaibJe0sXmABKOicVTVPn6klwlSw/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section><p>这个演变的顺序其实可以认为颠倒过来的，<strong>因为算法推断其实没办法知道发育顺序，仅仅是有有一些基因验证拟时序在变化。</strong>我们可以有很多进一步的分析的可能性，就需要熟练的掌握拟时序分析后针对每个细胞 产生的  Pseudotime数值和State分组</p></section></li><li><section><p>时序分析后针对每个细胞 产生的  Pseudotime数值和State分组  对象回帖到常规的Seurat的降维聚类分群流程里面去可视化</p></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006516" data-ratio="1.0773263433813893" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtYuxaoECxwtmURmK2hZ95X01sicZHicCaViaa7tIntv2GVFquUEmGYE3Gg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="763" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtYuxaoECxwtmURmK2hZ95X01sicZHicCaViaa7tIntv2GVFquUEmGYE3Gg/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>拟时序分析是否足够？</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section><p><strong>拟时序分析是常规差异分析的很好的补充，把分辨率从细胞亚群为单位提高到了具体的单个细胞本身</strong>，因为每个细胞都有自己的唯一的  Pseudotime数值，根据这个数值就可以对细胞进行排序啦</p></section></li><li><section><p>但是这个算法本身也是不够的，它得到的  Pseudotime数值是大小的排序是可以反过来的，这个时候<strong>需要一些先验知识的辅助</strong>，比如某些基因是已知的的顺序变化趋势。</p></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528643&amp;idx=1&amp;sn=f1ac855d3ac817ca3cef585ec019ebc0&amp;scene=21#wechat_redirect" data-linktype="2">拟时序的正确姿势（拟时序一本通02）</a></span><span></span></h4><h4 data-tool="mdnice编辑器"><span></span><span>正确的拟时序应用</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>提取里面的T细胞进行细分亚群就有CD4,CD8等完全不一样的子集，然后是针对CD8这个t细胞亚群继续细分成为了两个亚群</section></li><li><section>作者依据monocle2的拟时序结果把两个细胞亚群的具体的细胞排序后就可以展示了cytotoxic genes or exhausted genes</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006517" data-ratio="1.1440501043841336" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Ytjex3Q7diaC2opictU7jibmgoibpiaicG2xE7obSfmn4kRtzZdbcT30AEhBrw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="479" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Ytjex3Q7diaC2opictU7jibmgoibpiaicG2xE7obSfmn4kRtzZdbcT30AEhBrw/640?wx_fmt=png&amp;from=appmsg"></figure><h4 data-tool="mdnice编辑器"><span></span><span>错误的拟时序分析例子</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>文献进行了第一层次降维聚类分群后，并没有然后的生物学背景，就一股脑的<strong>把全部的肺癌肿瘤微环境里面的免疫细胞和间质细胞都拿去了拟时序</strong></section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006514" data-ratio="1.0678787878787879" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtNfibBlK9EWPX1KQ4bCyFb3rnGuoicDaPOiaUtCANsibWRibQ8JdmoqseuhA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtNfibBlK9EWPX1KQ4bCyFb3rnGuoicDaPOiaUtCANsibWRibQ8JdmoqseuhA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>拿到了算法层面的每个细胞的拟时序分析后产生的  Pseudotime 和State，但是也很难去做生物学描述</strong>。</p><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528673&amp;idx=1&amp;sn=80a9dcfb6504fe30016af4f3d2475f6a&amp;scene=21#wechat_redirect" data-linktype="2">拟时序的多种算法大比拼（拟时序一本通03）</a></span><span></span></h4><h4 data-tool="mdnice编辑器"><span></span><span>2016的综述对比10款算法软件</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>《<strong>Computational methods for trajectory inference from single-cell transcriptomics</strong>》，文章对比10款算法软件并且列出来了各自的优缺点</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006513" data-ratio="0.47515151515151516" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Yt8ZmrAUyyDUBNwFAXP0Hwa8WgRXLibFlARAymUc1AEIibibO1tDzXIzo6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Yt8ZmrAUyyDUBNwFAXP0Hwa8WgRXLibFlARAymUc1AEIibibO1tDzXIzo6Q/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section>首先区分成为了两个流派，就是专注于<strong>做Linear trajectories 的，以及可以做branched trajectories</strong>的。</section></li><li><section>软件算法都包含了两个步骤，就是<strong>降维（Dimensionality reduction）和轨迹构建（Trajectory modelling）</strong>，这两个步骤的不同算法的组合就确定了不同的软件</section></li><li><section><strong>monocle2做拟时序就是independent component analysis (ICA）的降维处理，配合  a minimal spanning tree (MST) 的构建拟时序关系算法。</strong></section></li></ul><h4 data-tool="mdnice编辑器"><span></span><span>2019的综述对比45款算法软件</span><span></span></h4><ul data-tool="mdnice编辑器"><li><section>文章是：《A comparison of single-cell trajectory inference methods》</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>拟时序分析基本分析及结果解读</span><span></span></h2><h4 data-tool="mdnice编辑器"><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=Mzk0MzY1MDI4Mg==&amp;mid=2247484677&amp;idx=1&amp;sn=4f9f5c508f6ccfe1ef63410e3dcda6a0&amp;scene=21#wechat_redirect" data-linktype="2">单细胞专题 | 拟时序分析——monocle2(1)</a></span><span></span></h4><blockquote data-tool="mdnice编辑器"><span></span><p>单细胞轨迹分析是研究生物体内单个细胞之间的差异和相似性、以及它们如何发育成为不同的类型和功能的一种重要工具</p></blockquote><h4 data-tool="mdnice编辑器"><span></span><span>分析流程</span><span></span></h4><p data-tool="mdnice编辑器"><strong>代码详情——SLE中step7.monocle2</strong></p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006522" data-ratio="0.5838218053927315" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtSgIvCLb74hicSESSLuMUTHey8YPD9rahtBo5AU1gvWEn5WSJlmqV8iag/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="853" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtSgIvCLb74hicSESSLuMUTHey8YPD9rahtBo5AU1gvWEn5WSJlmqV8iag/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span><span>创建CellDataSet对象</span><span></span></h5><p data-tool="mdnice编辑器"><span>构建CellDataSet对象需要三个文件：</span><strong>基因表达矩阵(原始count矩阵)、基因信息文件和表型信息文件</strong></p><pre data-tool="mdnice编辑器"><span></span><code>## 2. 构建monocle2需要的对象  ----<br>#选择需要构建细胞分化轨迹的细胞类型（subset提取感兴趣的名字，上面已经准备好名字了）<br>expr_matrix=seurat@assays$RNA$counts#使用counts表达值<br>sample_sheet&lt;-seurat@meta.data#将实验信息赋值新变量<br>gene_annotation=data.frame(gene_short_name=rownames(seurat))#构建一个含有基因名字的数据框<br>rownames(gene_annotation)=rownames(seurat)#将上述数据框的行名赋值基因名字<br><br>pd &lt;- new("AnnotatedDataFrame", data = sample_sheet)#将实验信息变量转化为monocel可以接收的对象<br>fd &lt;- new("AnnotatedDataFrame", data = gene_annotation)#将基因注释变量转化为monocle可以接收的对象<br>cds &lt;- newCellDataSet(expr_matrix, phenoData = pd, featureData = fd,<br>                      expressionFamily=negbinomial.size())#创建一个monocle的对象<br><br></code></pre><h5 data-tool="mdnice编辑器"><span></span><span>数据预处理</span><span></span></h5><p data-tool="mdnice编辑器">估计size factor和离散度，这一步是为后续的差异分析做铺垫</p><pre data-tool="mdnice编辑器"><span></span><code>cds &lt;- estimateSizeFactors(cds) #估计细胞的大小因子，以校正不同细胞的RNA测序深度<br>cds &lt;- estimateDispersions(cds) #估计基因的离散度，以确定哪些基因的表达变化最大<br><br></code></pre><h5 data-tool="mdnice编辑器"><span></span><span>关键基因筛选</span><span></span></h5><p data-tool="mdnice编辑器"><span>在发育过程中，细胞不断经历着动态的变化，这些变化体现在细胞在不同状态下所表达的基因集合的差异性。Monocle工具通过分析细胞内基因表达谱的相似性及其在时间上的连续性，来构建细胞发育的动态轨</span><span>迹。</span></p><p data-tool="mdnice编辑器"><span>在此过程中，首先需要筛选出合适的基因，这可以通过三种不同的策略来实现，以确保所选基因能够准确反映细胞的发育状态：</span></p><p data-tool="mdnice编辑器"><span>1）挑选细胞间高度离散的基因</span></p><p data-tool="mdnice编辑器"><span>2）挑选在指定类型间差异表达的基因</span></p><p data-tool="mdnice编辑器"><span>3）根据已知标记基因对细胞进行排序</span></p><pre data-tool="mdnice编辑器"><span></span><code># 第一步: 挑选合适的基因. 有多个方法，<br># 例如提供已知的基因集，这里选取前面的统计学显著的差异基因列表<br>ordering_genes &lt;- row.names (subset(diff_test_res, qval &lt; 0.01))<br>ordering_genes<br>cds &lt;- setOrderingFilter(cds, ordering_genes) #设置排序的基因集合<br>plot_ordering_genes(cds)<br></code></pre><h5 data-tool="mdnice编辑器"><span></span><span>基于关键基因降维</span><span></span></h5><pre data-tool="mdnice编辑器"><span></span><code># 第二步: 降维。降维的目的是为了更好的展示数据。函数里提供了很多种方法,<br># 不同方法的最后展示的图都不太一样, 其中“DDRTree”是Monocle2使用的默认方法<br>cds &lt;- reduceDimension(cds, <br>                       max_components = 2, # 降维后的维度<br>                       num_dim = 6, <br>                       reduction_method = 'DDRTree', <br>                       residualModelFormulaStr = "~orig.ident", #去除样本影响<br>                       verbose = F)<br></code></pre><h5 data-tool="mdnice编辑器"><span></span><span>对细胞进行排序及可视化</span><span></span></h5><pre data-tool="mdnice编辑器"><span></span><code># 第三步: 对细胞进行排序<br>cds &lt;- orderCells(cds)<br># 最后两个可视化函数，对结果进行可视化<br>plot_cell_trajectory(cds, color_by = "Cluster")<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100006521" data-ratio="0.6836363636363636" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YttmK6QnHkwfesoeTAO3MvDLk5H2tUFTCV9EJNzabWB6SAxX2lTicq0og/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YttmK6QnHkwfesoeTAO3MvDLk5H2tUFTCV9EJNzabWB6SAxX2lTicq0og/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>每个点代表一个细胞，而Pseudotime则表示该细胞在模拟发育过程中的时间点，数值越小意味着该细胞处于发育的早期阶段，数值越大则表明该细胞接近发育的末端。</strong></p><h3 data-tool="mdnice编辑器"><span></span><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531593&amp;idx=2&amp;sn=72c68ca9fa323c5123f0cb7ba31df59e&amp;scene=21#wechat_redirect" data-linktype="2">monocle单样本拟时序分析</a></span><span></span></h3><h4 data-tool="mdnice编辑器"><span></span><span>背景知识</span><span></span></h4><p data-tool="mdnice编辑器">做拟时序分析是为了探索自己感兴趣的几种细胞之间的发育关系，一般不是用全部类型的细胞来做的。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006520" data-ratio="0.7355491329479769" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtafQgoh8MKNtfOMNGNMmJvq8qLiaQPD7aIhNbWmQVy3cTfG1RibBauXsQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="692" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtafQgoh8MKNtfOMNGNMmJvq8qLiaQPD7aIhNbWmQVy3cTfG1RibBauXsQ/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247531593&amp;idx=3&amp;sn=6bef9d2db93e755cfb9bf390e44285e4&amp;scene=21#wechat_redirect" data-linktype="2">monocle多样本拟时序分析</a></span><span></span></h3><p data-tool="mdnice编辑器"><strong>多样品的时候如何注意个体差异因素</strong></p><h5 data-tool="mdnice编辑器"><span></span><span>构建细胞发育轨迹</span><span></span></h5><p data-tool="mdnice编辑器">选择基因有不同的策略，比如</p><ul data-tool="mdnice编辑器"><li><section>1.使用seurat给出的高变化基因</section></li><li><section>2.按照平均表达量大于某个数字(比如0.1，官网用的是这个)的基因</section></li><li><section>3.使用不同细胞类型之间的差异基因，differentialGeneTest计算。我们默认使用的是最后一个策略。</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006518" data-ratio="1.2521008403361344" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtkMCIfgpU1qVrUkPhibVBNaDdzt4XonFibq5m4meMPNia2YM34bzZKzwzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="476" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtkMCIfgpU1qVrUkPhibVBNaDdzt4XonFibq5m4meMPNia2YM34bzZKzwzg/640?wx_fmt=png&amp;from=appmsg"></figure><h5 data-tool="mdnice编辑器"><span></span><span>可视化展示</span><span></span></h5><ol data-tool="mdnice编辑器"><li><section>发育轨迹图</section></li></ol><figure data-tool="mdnice编辑器"><img data-imgfileid="100006519" data-ratio="0.9979508196721312" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Ytr34HKL13xzG2OUBWasaWbj3gqWml3CbqERUdqKz5edSVlCwBsWLZ8A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="488" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Ytr34HKL13xzG2OUBWasaWbj3gqWml3CbqERUdqKz5edSVlCwBsWLZ8A/640?wx_fmt=png&amp;from=appmsg"></figure><ul data-tool="mdnice编辑器"><li><section>以orig.ident着色可以看出，不同样本中的细胞基本是均匀分布在轨迹上的，说明前面的代码很好的去除了样本间的批次效应</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100006525" data-ratio="0.713939393939394" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Yt4yaKqibib36r127Q4Z7JeDUFzLbg4P4r0CbzOE2V0SgBvNd15PLC9TqA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4Yt4yaKqibib36r127Q4Z7JeDUFzLbg4P4r0CbzOE2V0SgBvNd15PLC9TqA/640?wx_fmt=png&amp;from=appmsg"></figure><ol start="2" data-tool="mdnice编辑器"><li><section>经典的拟时序热图</section></li></ol><p data-tool="mdnice编辑器">展示了一些基因是如何随着时间轨迹的变化而渐变的，这个渐变不同于findmarkers，是体现变化过程的，而不是直接给出差异表达的基因。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006526" data-ratio="0.713939393939394" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtxmZibbEwpeGa0IH3cIqH7Bwibaj3z4t3kA1kQuKrb3x1ibzEYrSnay1sw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="825" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtxmZibbEwpeGa0IH3cIqH7Bwibaj3z4t3kA1kQuKrb3x1ibzEYrSnay1sw/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span></span><span>拟时序高级分析代码解析</span><span></span></h3><figure data-tool="mdnice编辑器"><img data-imgfileid="100006524" data-ratio="0.34101941747572817" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqyE9WgpztSTPBBEMzQuY3xpbKyD3wbRp4UcEFuBgLVRK8ibpfx2zlxw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="824" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqyE9WgpztSTPBBEMzQuY3xpbKyD3wbRp4UcEFuBgLVRK8ibpfx2zlxw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><a href="https://mp.weixin.qq.com/s?__biz=MzkxOTI0Mjc3Mw==&amp;mid=2247489687&amp;idx=1&amp;sn=ff452636abb2044d0e509cff7a411403&amp;scene=21#wechat_redirect" data-linktype="2">单细胞测序—拟时序分析综合</a>——因为是学徒整理的比较详细的代码及基础知识解析笔记，所以看原推文即可，就没有重新归纳整理。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100006527" data-ratio="0.487962962962963" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqicDodOK7bkibN546UXvbX4uVluLPwfiaq5G5RNpOJLxg2JuJMHAs34AA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/icQem1PXnP9afzick7XZjyMEpxChROK4YtqicDodOK7bkibN546UXvbX4uVluLPwfiaq5G5RNpOJLxg2JuJMHAs34AA/640?wx_fmt=png&amp;from=appmsg"></figure></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/pgSQV2nXgnyVyOapJf_cYw",target="_blank" rel="noopener noreferrer">原文链接</a>
