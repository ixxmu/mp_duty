---
title: "R高级绘图 | 不用 Cytoscape 也能绘制精美的蛋白互作（PPI）网络图啦！| STRING 网站 + R 代码"
date: 2024-10-03T00:51:58Z
draft: ["false"]
tags: [
  "fetched",
  "生信小白要知道"
]
categories: ["Acdemic"]
---
R高级绘图 | 不用 Cytoscape 也能绘制精美的蛋白互作（PPI）网络图啦！| STRING 网站 + R 代码 by 生信小白要知道
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">看我看我嘿嘿嘿！<br></p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg5NjE1NTc1OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLpicdicvWNnpcaTbejCVgKe4FsicHqo48FOkqJTkziaengudibCF8AW86uyjgee0pxhmhM8JoylYDkSXug/0?wx_fmt=png" data-nickname="生信小白要知道" data-alias="Bioidiot" data-signature="主打小白保姆级教程，因为自己淋过雨，所以想给大家撑把伞！ 记录从小白到现在小灰的过程，希望以后可以成为小黑！" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><blockquote data-tool="mdnice编辑器"><span></span><p>在进行 PPI 网络图绘制时，我们通常会将 <strong>STRING 网站与 Cytoscape 软件</strong>结合使用。但是经常有小伙伴们苦恼，不太会用 Cytoscape 软件进行处理可咋整呐！之前我也吭哧吭哧学了点 Cytoscape，后来偶然的一个机会，我发现可以<strong>直接用 R 处理</strong>！！！图图也很漂亮的！当然，可能不如 Cytoscape 功能那么强大哈哈哈哈哈哈！但是对于咱们日常简单的图图处理来说是完全足够的！而且简单易学！这不，今天我就分享给大家！希望对大家有所帮助！！！</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100004552" data-ratio="1.0185185185185186" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswo2aicvke64lP2JDwNfZBvbP6khu3YVD4fpfQ9NJicSaAhJt5s7Ssxm5g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswo2aicvke64lP2JDwNfZBvbP6khu3YVD4fpfQ9NJicSaAhJt5s7Ssxm5g/640?wx_fmt=png&amp;from=appmsg"></figure><hr data-tool="mdnice编辑器"><ul data-tool="mdnice编辑器"><li><section><section><span>如果小伙伴们有需求的话，可以加入我们的交流群：</span><a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247487413&amp;idx=1&amp;sn=747e60197c594360abe79830480c5413&amp;scene=21#wechat_redirect" data-linktype="2"><span>一定要知道 | 永久免费的环境友好型生信学习交流群又双叒叕来啦！| 伴随不定期群友好物分享</span></a><span>！在这里，你可以稍有克制地畅所欲言！</span></section></section></li><li><section><section><span>超级建议大家在入群前或入群后可以看一下这个：</span><a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247486350&amp;idx=1&amp;sn=066dedbe912676f5c508b179167084a0&amp;scene=21#wechat_redirect" data-linktype="2"><span>干货满满 | 给生信小白的入门小建议 | 掏心掏肺版</span></a><span>！绝对干货满满！让你不虚此看！</span></section></section></li><li><section><section><span>如果有需要个性化定制分析服务的小伙伴，可以看看这里：</span><a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247486984&amp;idx=1&amp;sn=b00b48d15e2e19e206803d3e14f05d23&amp;scene=21#wechat_redirect" data-linktype="2"><span>你要的个性化生信分析服务今天正式开启啦！定制你的专属解决方案！全程1v1答疑！</span></a><span>！绝对包你满意！</span></section></section></li></ul><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">啊，这波好像不需要什么原理介绍哈（有需要咱们后期专门安排一期），主要是为了分享<strong>如何 R 直出图</strong>哈哈哈哈哈哈哈哈，那咱们，直接开始？好！开始！！！</p><blockquote data-tool="mdnice编辑器"><span></span><p>今天用到的数据，我已经上传到了GitHub，大家可以在公众号后台回复<code>PPI</code>，即可获得存放这些数据的链接（其中还包括之前在<a href="https://mp.weixin.qq.com/s?__biz=Mzg5NjE1NTc1OA==&amp;mid=2247485603&amp;idx=1&amp;sn=355722febb4d4fa8bd83eeb5d2a53df4&amp;scene=21#wechat_redirect" data-linktype="2">看完还不会来揍/找我 | 差异分析三巨头 —— DESeq2、edgeR 和 limma 包 | 附完整代码 + 注释</a>中得到的结果，用来标注上下调基因）。不过我在分享过程中也会把每一步的输入数据和输出结果进行展示，大家可以作为参考并调整自己的数据格式，然后直接用自己的数据跑，也是没有任何问题的！</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>STRING 网站</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>STRING 介绍</span><span></span></h3><p data-tool="mdnice编辑器">官网：https://cn.string-db.org/</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100004554" data-ratio="0.5722222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswHpeec5O7KUBn4NAicjlxSgMv5HLcIZm3xwGK6jwbMW05slKibN77LG0A/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswHpeec5O7KUBn4NAicjlxSgMv5HLcIZm3xwGK6jwbMW05slKibN77LG0A/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">哎！抱歉！这里不想介绍了！感觉详细介绍一下，这篇分享就重点偏移啦！咱们下次再详细介绍 STRING 数据库好不好！好！！！嘿嘿嘿，谢谢大家支持！！！</p><h3 data-tool="mdnice编辑器"><span></span><span>STRING 使用</span><span></span></h3><p data-tool="mdnice编辑器">通过上面的介绍，咱们可以知道 STRING 网站的输入数据是基因列表，大家一定有自己的数据哈哈哈哈哈哈哈，直接用就好啦！我这里的话，就用之前差异分析得到的数据啦，顺便自己编造了一个基因列表哈哈哈哈哈哈（数据到用时方恨少呐，准备分享的时候，才发现自己想要找个合适的基因列表还蛮不容易的哈哈哈哈哈哈哈）！</p><pre data-tool="mdnice编辑器"><span></span><code><span>############################## PPI 网络 ##################################</span><br><br><span># 数据准备，这里我用了我自己随便搞的 gene list，标注上下调基因用到了之前在差异分析中得到的结果，有需要的小伙伴们可以按提示获取（见上文）！</span><br><span># 大家也可以直接使用自己的 gene list 去 string 进行分析！</span><br><br><span># 这是我的 gene list</span><br>gene_list &lt;- read.table(<span>"./data/gene_list.txt"</span>)<br>gene_list<br><span>#           V1</span><br><span># 1      ADH1B</span><br><span># 2     ADIPOQ</span><br><span># 3    ANGPTL7</span><br><span># 4       APOB</span><br><span># 5       AQP7</span><br><span># 6     ATP1A2</span><br><span># 7  C14orf180</span><br><span># 8        CA4</span><br><span># 9    CD300LG</span><br><span># 10    CHRDL1</span><br><span># 11     CIDEA</span><br><span># 12     CIDEC</span><br><span># 13   COL11A1</span><br><span># 14   COL10A1</span><br><span># 15      DLK1</span><br><span># 16     FABP4</span><br><span># 17     GLYAT</span><br><span># 18      GPD1</span><br><span># 19      IBSP</span><br><span># 20      MMP1</span><br><span># 21     MMP11</span><br><span># 22     MMP13</span><br><span># 23      PCK1</span><br><span># 24     PLIN1</span><br><span># 25     PLIN4</span><br><span># 26      RBP4</span><br><br><span># 这个用来后续标注上下调基因，其实没有这个也是可以的，无非就是图图上不标注上下调信息而已嘛，看大家需求啦！</span><br>load(<span>"./data/DEG_limma_voom.Rdata"</span>)<br>head(DEG_limma_voom)<br><span>#             logFC    AveExpr         t       P.Value     adj.P.Val        B</span><br><span># FIGF    -5.984847 -0.7193930 -51.67041 1.843289e-309 4.938355e-305 698.5939</span><br><span># CA4     -6.844833 -2.5701167 -44.96985 3.340380e-261 4.474605e-257 587.5876</span><br><span># PAMR1   -3.989305  2.3605059 -44.85958 2.161519e-260 1.665003e-256 585.9261</span><br><span># LYVE1   -4.786578  1.3531474 -44.85132 2.485914e-260 1.665003e-256 585.7724</span><br><span># CD300LG -6.537456 -0.0898487 -43.57667 6.384798e-251 3.421102e-247 564.1320</span><br><span># SDPR    -4.600471  2.7186631 -43.38389 1.712581e-249 7.646961e-246 560.8745</span><br></code></pre><p data-tool="mdnice编辑器">现在咱们进入 STRING 网站（https://cn.string-db.org/），直接把上面的基因列表复制进去就好啦！记得选择<code>Multiple proteins</code>（<span>红色框框</span>），因为咱们是多个嘛！然后把复制的基因列表粘贴到<span>绿色框框</span>部分就好啦！然后点击<code>SEARCH</code>（<span>橙色箭头</span>）！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100004555" data-ratio="0.5712962962962963" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswWmft0WDog0OEiaNkhvrBg3XuRHusyGeibibumAXOvZgqVbLbWoBZ9W32w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswWmft0WDog0OEiaNkhvrBg3XuRHusyGeibibumAXOvZgqVbLbWoBZ9W32w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">铛铛铛铛！出现这个页面！咱们点击<code>CONTINUE</code>！继续！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100004556" data-ratio="0.562037037037037" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFsw7EM75qpcm7k80Y87RRiciaceDL1EvDcpUbB24JT1j4OaW3Le65ib8ibU2w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFsw7EM75qpcm7k80Y87RRiciaceDL1EvDcpUbB24JT1j4OaW3Le65ib8ibU2w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">！初步的 PPI 网络图来咯！！！</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100004553" data-ratio="0.8574074074074074" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswYzjicBKGHTMib3bkQW9TYEtSV3JsiaFFwwibia24j1E6mm6CHsltrg4VNWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswYzjicBKGHTMib3bkQW9TYEtSV3JsiaFFwwibia24j1E6mm6CHsltrg4VNWg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">现在咱们就得到经典的 PPI 网络图啦！其实咱们还可以各种调整，通过下面的<code>Settings</code>。</p><p data-tool="mdnice编辑器">咱们这里简单介绍一下网络视图下方的这几个选项，下次再详细介绍嘿嘿嘿！</p><ul data-tool="mdnice编辑器"><li><section><strong>Legend（图例）：</strong>这个选项展示了网络图中使用的各种符号、颜色和线条的含义。图例帮助我们理解不同类型的蛋白质相互作用（如实验验证的相互作用、数据库中已知的相互作用、预测的相互作用等），以及蛋白质节点的属性（如节点颜色代表的功能类别）。</section></li><li><section><strong>Settings（设置）：</strong>在这个选项中，我们可以调整网络图的显示参数。例如，可以选择显示或隐藏不同类型的相互作用，调整相互作用的置信度阈值，改变网络图的布局，或者自定义图形的外观（如节点和边的颜色、大小等）。</section></li><li><section><strong>Analysis（分析）：</strong>该选项提供了一系列分析工具，用于深入分析所选的蛋白质网络。我们可以执行功能富集分析、路径分析、聚类分析等。这些分析帮助我们理解网络中蛋白质的生物学意义、共同参与的生物过程以及潜在的功能模块。</section></li><li><section><strong>Exports（导出）：</strong>这个选项允许我们将当前的网络图或分析结果导出为不同的文件格式，例如图片格式（PNG、SVG等）或文本格式（TSV、Excel等）。这使得我们能够将数据用于报告、演示或进一步的分析。</section></li><li><section><strong>Clusters（聚类）：</strong>该选项显示了STRING自动识别出的蛋白质聚类模块。这些聚类通常代表蛋白质间的紧密相互作用群组，可能参与相同的生物学过程或功能路径。我们可以通过这一功能识别和分析网络中的功能模块。</section></li><li><section><strong>More（更多）：</strong>这个选项通常用于显示更多的细节或选项。当点击“More”时，可能会展开隐藏的内容，如额外的分析工具、数据视图、设置选项或附加的蛋白质相互作用信息。它帮助我们访问更深入的功能或查看更详细的结果。</section></li><li><section><strong>Less（更少）：</strong>这个选项与“More”相反，用于折叠或隐藏不必要的细节。当点击“Less”时，已经展开的额外信息或选项会被收起，使界面更简洁。这对于简化视图、减少干扰信息非常有用，尤其是在我们不需要查看所有详细内容时。</section></li></ul><p data-tool="mdnice编辑器">我们导出需要的文件，点击<code>Exports</code>，然后点击下面的<code>as tabular text output:download</code>，上面那个是简略版的，咱不要！然后咱们就可以得到文件<code>string_interactions.tsv</code>。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100004560" data-ratio="0.42592592592592593" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswCKMiaeuCBL5vp5Mjflo7abyLdyxMHJvb5xnXbpouGWnEN5y2cibxsibsQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswCKMiaeuCBL5vp5Mjflo7abyLdyxMHJvb5xnXbpouGWnEN5y2cibxsibsQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">接下来！咱们不需要 Cytoscape，直接打开你的 RStudio！开工！</p><h2 data-tool="mdnice编辑器"><span></span><span>R 代码直接处理</span><span></span></h2><p data-tool="mdnice编辑器">STRING 处理结束，咱们开始画图图啦！</p><pre data-tool="mdnice编辑器"><span></span><code><br><span>##################### STRING 处理结束，开始画图图啦！###########################</span><br><br><span># 首先加载我们需要的包包，没有安装的小伙伴们记得安装一下哟！</span><br><span>library</span>(igraph)<br><br><span># 读取从 STRING 得到的蛋白互作数据</span><br>links &lt;- read.delim(<span>"./data/string_interactions.tsv"</span>)<br><br><span># 构建无向图，仅选择节点列和边权重列</span><br>network &lt;- graph_from_data_frame(d = links[, c(<span>1</span>, <span>2</span>, <span>13</span>)], directed = <span>FALSE</span>)<br><br><span># 计算节点的度数（连接数量）</span><br>deg &lt;- degree(network, mode = <span>"all"</span>)<br><br><span># 提取唯一的基因列表</span><br>genes &lt;- unique(links$X.node1) %&gt;% as.data.frame()<br>colnames(genes) &lt;- <span>"gene"</span><br><br><span># 筛选出与基因列表匹配的差异表达基因</span><br>DEG_filtered &lt;- DEG_limma_voom %&gt;%<br>  filter(rownames(DEG_limma_voom) %<span>in</span>% genes$gene) %&gt;%<br>  mutate(gene = rownames(.)) %&gt;%<br>  select(gene, logFC)<br><br><span># 结合基因列表与 DEG 数据，基于 logFC 值分组（上下调）</span><br>nodes &lt;- genes %&gt;%<br>  inner_join(DEG_filtered, by = <span>"gene"</span>) %&gt;%<br>  mutate(group = ifelse(logFC &gt; <span>0</span>, <span>"up"</span>, <span>"down"</span>))<br><br><span># 使用新的节点数据构建网络图</span><br>network &lt;- graph_from_data_frame(d = links, vertices = nodes, directed = <span>FALSE</span>)<br><br><span># 为节点分配颜色，基于分组信息</span><br>my_color &lt;- c(<span>"#66C2A5"</span>, <span>"#FC8D62"</span>, <span>"#8DA0CB"</span>)[as.numeric(as.factor(V(network)$group))]<br><br><span># 保存网络图为 PDF 文件</span><br>pdf(file = <span>"./figure/ppi_network.pdf"</span>, width = <span>8</span>, height = <span>8</span>)<br><br><span># 设置图形参数并绘制网络图</span><br>par(bg = <span>"white"</span>, mar = c(<span>0</span>, <span>0</span>, <span>0</span>, <span>0</span>))<br><br>plot(network, <br>     vertex.size = deg,  <span># 根据度数调整节点大小</span><br>     layout = layout.circle,  <span># 使用圆形布局</span><br>     vertex.color = my_color,  <span># 节点颜色</span><br>     vertex.label.cex = <span>0.9</span>,  <span># 标签字体大小</span><br>     vertex.label.color = <span>"black"</span>,  <span># 标签颜色</span><br>     vertex.frame.color = <span>"transparent"</span>,  <span># 节点边框颜色</span><br>     edge.width = E(network)$combined_score * <span>3</span>,  <span># 边宽度</span><br>     edge.curved = <span>0.3</span>)  <span># 边的弯曲程度</span><br><br><span># 添加图例，显示基因分组信息</span><br>legend(x = <span>1</span>, y = <span>1</span>, <br>       legend = unique(V(network)$group), <br>       col = unique(my_color), <br>       bty = <span>"n"</span>,  <span># 无边框</span><br>       pch = <span>20</span>,  <span># 点形状</span><br>       pt.cex = <span>3</span>,  <span># 点大小</span><br>       cex = <span>0.8</span>,  <span># 文本大小</span><br>       text.col = <span>"black"</span>,  <span># 文本颜色</span><br>       horiz = <span>FALSE</span>,  <span># 垂直排列图例</span><br>       y.intersp = <span>1.5</span>)  <span># 图例项间距</span><br><br><span># 关闭设备，完成 PDF 文件保存</span><br>dev.off()<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100004561" data-ratio="0.9435185185185185" data-src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswBxe8KuyY8dbNktu3ExUKBy4u0qzdfkonWz3aSmQYqT9cAzJZtd8ia5g/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLq0EQiaIiaCyrOCOepqmZvFswBxe8KuyY8dbNktu3ExUKBy4u0qzdfkonWz3aSmQYqT9cAzJZtd8ia5g/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">(o゜▽゜)o☆[BINGO!]</p><p data-tool="mdnice编辑器">搞定！</p><h2 data-tool="mdnice编辑器"><span></span><span>文末碎碎念</span><span></span></h2><p data-tool="mdnice编辑器">那今天的分享就到这里啦！我们下期再见哟！</p><p data-tool="mdnice编辑器">最后顺便给自己推荐一下嘿嘿嘿！</p><p data-tool="mdnice编辑器">如果我的分享对你有用的话，欢迎<strong>关注点赞在看转发分享</strong>阿巴阿巴阿巴阿巴巴巴！这可是我的第一原动力！</p><p data-tool="mdnice编辑器">蟹蟹你们的喜欢和支持！！！</p></section><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg5NjE1NTc1OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/QQjtfWKmicLpicdicvWNnpcaTbejCVgKe4FsicHqo48FOkqJTkziaengudibCF8AW86uyjgee0pxhmhM8JoylYDkSXug/0?wx_fmt=png" data-nickname="生信小白要知道" data-alias="Bioidiot" data-signature="主打小白保姆级教程，因为自己淋过雨，所以想给大家撑把伞！ 记录从小白到现在小灰的过程，希望以后可以成为小黑！" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/O9SeQRurWxQ-5ByvhgBMDA",target="_blank" rel="noopener noreferrer">原文链接</a>
