---
title: "Trinity — 无参转录组从头组装"
date: 2024-10-01T13:31:08Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
Trinity — 无参转录组从头组装 by 生信菜鸟团
------
<div><section data-md5="d93a6" act="xmy"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><section data-md5="d93a6"><p data-md5="d93a6"><strong data-md5="d93a6">工欲善其事必先利其器</strong></p></section></section></section></section></section></section></section><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>Trinity</span><span></span></h2><p data-tool="mdnice编辑器">Trinity是由Broad 研究所和希伯来大学联合开发的一种利用RNA-seq数据进行高效、稳健地从头组装转录本的方法，包含三个独立的软件模块：</p><ol data-tool="mdnice编辑器"><li><section>Inchworm （虫）（C++）</section></li></ol><ul><li><section>将 reads切为 k-mers (k bp长度的短片段)</section></li><li><section>利用Overlap关系对k-mers进行延伸 (贪婪算法)</section></li><li><section>输出所有的序列 (“contigs”)</section></li></ul><li><section>Chrysalis （蛹）（C++）</section></li><ul><li><section>聚类所有相似区域大于k-1bp的 contigs</section></li><li><section>构图 (区分不同的 “components”)</section></li><li><section>将reads比对回 components，进行验证</section></li></ul><li><section>Butterfly （蝶）（Java）</section></li><ul><li><section>拆分graph 为线性序列</section></li><li><section>使用reads以及 pairs关系消除错误序列 Trinity组装依据的算法是de Bruijn Graph,即从打断的文库中提取一定长度的K-mer，然后根据k-1错位相似的方法拼接组装的可能路径，最终确定完整的参考组装转录组。</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100044185" data-ratio="0.8935185185185185" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleNzM4rmrTHUTVEtJhpmyt3O8ETYHc3pT4mU4Bhn8byAgW8ic3PBRibElg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleNzM4rmrTHUTVEtJhpmyt3O8ETYHc3pT4mU4Bhn8byAgW8ic3PBRibElg/640?wx_fmt=png&amp;from=appmsg"><figcaption>Trinity示意图</figcaption></figure><p data-tool="mdnice编辑器">主要编程语言：Perl<br>GItHub：https://github.com/trinityrnaseq/trinityrnaseq<br>文档：https://github.com/trinityrnaseq/trinityrnaseq/wiki</p><h2 data-tool="mdnice编辑器"><span></span><span>发表文章</span><span></span></h2><blockquote data-tool="mdnice编辑器"><span></span><p><strong>题目</strong>：Full-length transcriptome assembly from RNA-Seq data without a reference genome<br><strong>期刊</strong>:  Nature Biotechnology<br><strong>日期</strong>：2011年5月15日<br><strong>作者&amp;单位</strong>：Manfred G Grabherr, Brian J Haas and Moran Yassour &amp; Broad Institute of Massachusetts Institute of Technology and Harvard<br><strong>DOI</strong>：https://doi.org/10.1038/nbt.1883</p></blockquote><figure data-tool="mdnice编辑器"><img data-imgfileid="100044183" data-ratio="0.6111111111111112" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleR2IMkLysswouia4nUm160RGvme0dm0JO0otichfWiaickgvket6B1e5ejA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleR2IMkLysswouia4nUm160RGvme0dm0JO0otichfWiaickgvket6B1e5ejA/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>如何安装</span><span></span></h2><p data-tool="mdnice编辑器">详见：https://github.com/trinityrnaseq/trinityrnaseq/wiki/Installing-Trinity</p><h3 data-tool="mdnice编辑器"><span></span><span>conda 安装</span><span></span></h3><p data-tool="mdnice编辑器">推荐使用conda安装，可以自动解决一系列依赖软件的安装.</p><pre data-tool="mdnice编辑器"><span></span><code>conda create -n  noref_rnaseq<br>conda activate noref_rnaseq<br><span>#</span><span>conda install trinity</span><br>mamba install trinity<br>conda install rsem<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044182" data-ratio="0.27314814814814814" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llenT3jibk4LvZB8JdFQbR8w1ux6APMrcDwrN9Ve243yVHQBaIecpKQuQA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llenT3jibk4LvZB8JdFQbR8w1ux6APMrcDwrN9Ve243yVHQBaIecpKQuQA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">可以使用conda直接安装，但是需要注意的一点是，可能是所需依赖太多，我用conda安装命令尝试安装了多次都是失败，这时候可以换用mamba试试，同样的镜像，使用<code>mamab</code> 很快就安装好了 。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044181" data-ratio="0.4962962962962963" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llehadWVBnovPNbWA1khlMcCoXPV6xic9vLwvElRiasZKylrn57WQmKqqNA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llehadWVBnovPNbWA1khlMcCoXPV6xic9vLwvElRiasZKylrn57WQmKqqNA/640?wx_fmt=png&amp;from=appmsg"></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044184" data-ratio="0.5092592592592593" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleADLyJntlTQwKasxpUXRibdcNyNrFuHPvH18WEnGOxkb7q0voEI9ze3A/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleADLyJntlTQwKasxpUXRibdcNyNrFuHPvH18WEnGOxkb7q0voEI9ze3A/640?wx_fmt=png&amp;from=appmsg"></figure><h3 data-tool="mdnice编辑器"><span></span><span>singularity 调用</span><span></span></h3><p data-tool="mdnice编辑器">如果服务器有配置singularity，也可以使用singularity调用Trinity。如果不了解singularity的可以参考：<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247520902&amp;idx=1&amp;sn=5cd0cebfac7196f97384a54cdf918a0f&amp;chksm=fa4557bbcd32deadbd7ade85724b9217919c5261281e56f7aa0677038bd8ece5d9597600cca4&amp;scene=21#wechat_redirect" textvalue=" Singularity — 生信流程搭建好帮手" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Singularity — 生信流程搭建好帮手</a></p><p data-tool="mdnice编辑器">下载singularity镜像文件（https://data.broadinstitute.org/Trinity/TRINITY_SINGULARITY/）</p><pre data-tool="mdnice编辑器"><span></span><code>wget -c https://data.broadinstitute.org/Trinity/TRINITY_SINGULARITY/trinityrnaseq.v2.15.1.simg<br><span><br>#</span><span>文件大小</span><br>2.6G 2月   6  2023 trinityrnaseq.v2.15.1.simg<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p>硬件要求注意：基本建议是每 ~1M  Illumina reads 对 ，有 ~1G RAM，还可能需要数百 GB 的可用磁盘空间，并且可以在运行期间生成数千个中间文件。最好有一个临时工作区，并有足够的磁盘空间在任务执行期间使用。</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>最小化使用</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>Trinity 组装</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span>基本</span><br>Trinity --seqType fq --max_memory 50G \<br>         --left reads_1.fq.gz  --right reads_2.fq.gz --CPU 6<br><span><br>#</span><span> 使用 singularity</span><br>singularity exec -e Trinity.simg  Trinity \<br>          --seqType fq \<br>          --left `pwd`/reads_1.fq.gz  \<br>          --right `pwd`/reads_2.fq.gz \<br>          --max_memory 1G --CPU 4 \<br>          --output `pwd`/trinity_out_dir<br><br><br>--seqType #输入文件类型<br>--CPU #设置程序调用的CPU数,默认2<br>--max_memory #设置程序可使用的最大内存<br>--left #双端测序的左端，eg:reads_1.fq.gz ；如果有多个文件，可以使用逗号(,)分隔<br>--right #双端测序的右端，eg:reads_2.fq.gz ；如果有多个文件，可以使用逗号(,)分隔<br>--single #单端测序数据<br>--samples_file #制表符分隔的文本文件。如果文件过多，可以将信息写入samples文件中<br>--monitoring #统计资源使用情况<br>--output #设置输出文件目录。默认是在工作目录创建'trinity_out_dir'文件夹。注意自定义目录的时候，目录命名必须包含"trinity"<br>--SS_lib_type #链特异性数据需要设置的参数<br></code></pre><blockquote data-tool="mdnice编辑器"><span></span><p>注：如果你有特别大的 RNA-Seq 数据集，涉及数亿到数十亿的reads，就需要开启 silico normalizatio （计算机模拟归一化），能有效减少trinity运行时间。（现在新版本是默认开启状态）</p><p>目前版本，运行Trinity 除了生成 <code>Trinity.fasta</code>，还直接生成了salmon定量的结果</p></blockquote><h3 data-tool="mdnice编辑器"><span></span><span>定量</span><span></span></h3><p data-tool="mdnice编辑器">不管是否采用基于比对的估计，首次运行的时候都需要采用 <code>--prep_reference</code> 构建索引。</p><h4 data-tool="mdnice编辑器"><span></span><span>基于比对的丰度估计——RSEM</span><span></span></h4><pre data-tool="mdnice编辑器"><span></span><code>align_and_estimate_abundance.pl \<br>--transcripts unigene1.fasta --seqType fq \<br>--left reads_1.fq.gz --right reads_2.fq.gz \<br>--est_method RSEM --aln_method bowtie2 --trinity_mode --prep_reference \<br>--output_dir trinity_RSEM_out_dir<br><br>--transcripts #转录本fasta文件<br>--seqType #指定输入数据类型<br>--est_method  #选择丰度估计方法；基于比对的方法，eg：RSEM ；非比对的方法，eg:kallisto 、salmon<br>--aln_method #用于指定比对的方法， bowtie|bowtie2 <br>--thread_count #设置调用的线程数<br>--trinity_mode #启用Trinity模式，工具会自动生成`gene_trans_map`（一个包含“基因(tab)转录本”标识符的文件）并使用它<br>--prep_reference #构建索引。进行基于比对的方法（如RSEM）时，需先准备参考序列的索引<br></code></pre><h4 data-tool="mdnice编辑器"><span></span><span>无比对的丰度估计</span><span></span></h4><p data-tool="mdnice编辑器">使用kallisto 或者 salmon 。这两个软件前面我们也介绍过：</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247524156&amp;idx=1&amp;sn=518b3445a6ceab425602b37b949e7da6&amp;chksm=fa455a01cd32d317f142d9bfc316cfe7555cc35e986db0535da171fc68ae5d496e344c67a1c7&amp;scene=21#wechat_redirect" textvalue="Kallisto — 基于伪比对的转录本定量" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Kallisto — 基于伪比对的转录本定量</a>  </p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247521604&amp;idx=1&amp;sn=d3365ce5a897c3874077e4fb2e9b50b7&amp;chksm=fa455079cd32d96fb8dd2c86988d0bad9e5f74f9f4b33d1aabd168d03d1cc19525a634b2be31&amp;scene=21#wechat_redirect" textvalue="Salmon — 兼具高效、精准及偏差感知的RNA-seq定量工具" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">Salmon — 兼具高效、精准及偏差感知的RNA-seq定量工具</a></p><pre data-tool="mdnice编辑器"><span></span><code><span>#</span><span><span>#kallisto</span></span><br>align_and_estimate_abundance.pl \<br>--transcripts Trinity.fasta --seqType fq \<br>--left reads_1.fq --right reads_2.fq \<br>--est_method kallisto --trinity_mode --prep_reference \<br>--output_dir kallisto_quant<br><span><br>#</span><span><span>#合并所有样本kallisto的结果，生成定量矩阵文件</span></span><br>abundance_estimates_to_matrix.pl --est_method kallisto \<br>    --gene_trans_map Trinity.fasta.gene_trans_map \<br>    --out_prefix kallisto \<br>    --name_sample_by_basedir \<br>     sampleA/abundance.tsv \<br>     sampleB/abundance.tsv <br><span> <br>#</span><span><span>#salmon</span></span><br>align_and_estimate_abundance.pl \<br>--transcripts Trinity.fasta --seqType fq \<br>--left reads_1.fq --right reads_2.fq  \<br>--est_method salmon --trinity_mode --prep_reference \<br>--output_dir salmon_quant<br><span><br>#</span><span><span>#合并所有样本salmon的结果，生成定量矩阵文件</span></span><br>find . -maxdepth 2 -name "quant.sf" | tee salmon.quant_files.txt<br><br>abundance_estimates_to_matrix.pl --est_method salmon \<br>      --gene_trans_map trinity_out_dir.Trinity.fasta.gene_trans_map \<br>      --quant_files salmon.quant_files.txt \<br>      --name_sample_by_basedir<br><br>--gene_trans_map #指定一个基因到转录本的映射文件。这个文件的每一行是一个基因和转录本的对应关系。如果你只对转录本层面的估计感兴趣，可以指定`'none'`，跳过基因汇总<br>--name_sample_by_basedir #这个选项会将样本列名设置为目录名称而不是文件名称。适合当文件名称相同时用目录名称来区分不同样本。<br>--quant_files #一个包含所有丰度估计结果文件路径的列表文件，每一行是一个丰度估计结果文件的路径。使用该参数避免在命令行中手动列出每个文件路径。<br></code></pre><h2 data-tool="mdnice编辑器"><span></span><span>实例演示</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>运行Trinity</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>fq1=~/project/FL8/st1_data/C1_1.fq.gz<br>fq2=~/project/FL8/st1_data/C1_2.fq.gz<br>outdir=~/trinity_test/trinity_out_dir<br><br>/usr/bin/time -v Trinity --seqType fq --max_memory 50G \<br>         --left ${fq1}  --right ${fq2} \<br>         --CPU 6 --monitoring \<br>         --output ${outdir}<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044187" data-ratio="0.48333333333333334" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleTsZibSTnAyukZCbkbaoxEQqECh3HPvYF0tYhXyZapDlXf3ltqS5Hzdw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleTsZibSTnAyukZCbkbaoxEQqECh3HPvYF0tYhXyZapDlXf3ltqS5Hzdw/640?wx_fmt=png&amp;from=appmsg"><figcaption>部分日志</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044186" data-ratio="0.11296296296296296" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleeGkE3iaUOXKz5f3sKgDBDvZeMiawPTKDIraU8CBQUIpkXzHNqLibfoKwQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleeGkE3iaUOXKz5f3sKgDBDvZeMiawPTKDIraU8CBQUIpkXzHNqLibfoKwQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>结果文件</figcaption></figure><p data-tool="mdnice编辑器">Trinity 完成后，它将创建一个 <code>trinity_out_dir</code> ，和输出 <code>trinity_out_dir.Trinity.fasta</code>  、<code>trinity_out_dir.Trinity.fasta.gene_trans_map</code>  (或基于您指定的输出目录的前缀）。</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044189" data-ratio="0.47314814814814815" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleGkSV7QhE985YkFcD44922EfQwKAWQDIgqDF0e2FVsbAvSwBB7NufibA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleGkSV7QhE985YkFcD44922EfQwKAWQDIgqDF0e2FVsbAvSwBB7NufibA/640?wx_fmt=png&amp;from=appmsg"><figcaption>trinity_out_dir.Trinity.fasta</figcaption></figure><p data-tool="mdnice编辑器">序列编号规则。序列编号编码了 Trinity 的 “基因” 和 “转录本” 信息。因为一次 Trinity 运行涉及许多读段簇，每个读段簇都是单独组装的，并且由于 “基因” 编号在给定的已处理读段簇中是唯一的，所以 “基因” 标识符应被视为读段簇和相应基因标识符的组合，以”TRINITY_DN6201_c0_g1_i1“  为例：</p><ul data-tool="mdnice编辑器"><li><section><code>DN</code>通常代表de novo组装编号。<code>6201</code>是该特定组装单元的唯一编号。它表示这是组装过程中发现的第10个独立的基因簇（或组装单元）</section></li><li><section><code>c0</code>表示组件编号（component number）。每个组件代表一个可能属于同一个基因的序列集合。<code>c0</code>表示这是该基因簇中的第0号组件。组件是基于组装过程中读段的重叠关系定义的。</section></li><li><section><code>g1</code>代表基因编号（gene number）。在组件内，Trinity会将可能代表同一基因的序列分组，<code>g1</code>表示这是组件<code>c0</code>中的第1个基因。</section></li><li><section><code>i1</code>表示转录本编号（isoform number）。对于每个基因，Trinity可能会找到多个不同的转录本（即不同的mRNA异构体）。<code>i1</code>表示这是基因<code>g1</code>中的第1个转录本。</section></li></ul><p data-tool="mdnice编辑器">所以 ”TRINITY_DN6201_c0_g1_i1“  表示 Trinity 读段簇为 “TRINITY_DN6201_c0”，基因是 “g1”，转录本是 “i1”。</p><p data-tool="mdnice编辑器"><code>trinity_out_dir.Trinity.fasta.gene_trans_map</code>  文件是基因ID和转录本ID的对应关系</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044188" data-ratio="0.4287037037037037" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleWSsuvJBrpiaOLhcURBjHIqCibibeDZv0H60cnlv0tSj6vrZWlvbYibhLcQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleWSsuvJBrpiaOLhcURBjHIqCibibeDZv0H60cnlv0tSj6vrZWlvbYibhLcQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>trinity_out_dir.Trinity.fasta.gene_trans_map</figcaption></figure><p data-tool="mdnice编辑器">trinity_out_dir 目录包含以下内容：</p><pre data-tool="mdnice编辑器"><span></span><code><span>$</span><span>tree -L 1</span><br>.<br>├── both.fa<br>├── both.fa.ok<br>├── both.fa.read_count<br>├── chrysalis<br>├── inchworm.DS.fa<br>├── inchworm.DS.fa.finished<br>├── inchworm.kmer_count<br>├── insilico_read_normalization<br>├── jellyfish.kmers.25.asm.fa<br>├── jellyfish.kmers.25.asm.fa.histo<br>├── left.fa.ok<br>├── partitioned_reads.files.list<br>├── partitioned_reads.files.list.ok<br>├── pipeliner.932460.cmds<br>├── read_partitions<br>├── recursive_trinity.cmds<br>├── recursive_trinity.cmds.completed<br>├── recursive_trinity.cmds.ok<br>├── right.fa.ok<br>├── __salmon_filt.chkpts<br>├── salmon_outdir<br>├── scaffolding_entries.sam<br>├── Trinity.timing<br>├── Trinity.tmp.fasta<br>└── Trinity.tmp.fasta.salmon.idx<br><br>6 directories, 19 files<br></code></pre><h3 data-tool="mdnice编辑器"><span></span><span>RSEM 定量</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>align_and_estimate_abundance.pl \<br>--transcripts Trinity.fasta --seqType fq \<br>--left reads_1.fq.gz --right reads_2.fq.gz \<br>--est_method RSEM --aln_method bowtie2 --trinity_mode --prep_reference \<br>--output_dir trinity_RSEM_out_dir<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044190" data-ratio="0.48333333333333334" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llek2kW4awN6WNuKJQKMQ1sJIJIalMkMjQrLHVrO1K8KjFd8AqSDf7NEA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llek2kW4awN6WNuKJQKMQ1sJIJIalMkMjQrLHVrO1K8KjFd8AqSDf7NEA/640?wx_fmt=png&amp;from=appmsg"><figcaption>日志</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044193" data-ratio="0.7314814814814815" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleAV3XafYsXSRGOHibibRIdBXeYneDdia72V7y7AOqvYtVibia346n1dn9KNw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleAV3XafYsXSRGOHibibRIdBXeYneDdia72V7y7AOqvYtVibia346n1dn9KNw/640?wx_fmt=png&amp;from=appmsg"><figcaption>输出文件</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044191" data-ratio="0.26666666666666666" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llen6fl6rECXk23a5RM9KXOPsIribCK9XgYJ3MjWIicbAyT9Ucurdic5pSDA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llen6fl6rECXk23a5RM9KXOPsIribCK9XgYJ3MjWIicbAyT9Ucurdic5pSDA/640?wx_fmt=png&amp;from=appmsg"><figcaption>trinity_RSEM_out_dir</figcaption></figure><p data-tool="mdnice编辑器">RSEM 计算生成两个包含丰度估计信息的主要输出文件：<code>RSEM.isoforms.results</code> 和 <code>RSEM.genes.results</code>  、每列内容如下：</p><ul data-tool="mdnice编辑器"><li><section>transcript_id ：转录本的唯一标识符</section></li><li><section>gene_id  ：基因的唯一标识符</section></li><li><section>length ：该基因或转录本的总长度，以碱基对（bp）为单位</section></li><li><section>effective_length：有效长度，即经过校正后可以用于定量分析的序列长度</section></li><li><section>expected_count：期望读段数，即RSEM估计的在该基因或转录本上比对到的读段数量。这个值并不等同于原始的比对读段数，而是经过算法校正后的结果。</section></li><li><section>TPM：标准化后的表达值，表示每百万个读段中有多少读段映射到该转录本。</section></li><li><section>FPKM：标准化的表达量单位，表示每千碱基转录本每百万个比对读段中的片段数。</section></li><li><section>IsoPct：表示该转录本在其所属基因的所有转录本中所占的百分比。它反映了该转录本在所有该基因转录本中的丰度比例。</section></li></ul><figure data-tool="mdnice编辑器"><img data-imgfileid="100044194" data-ratio="0.2388888888888889" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleE18oue4U1dbkxMysfOhsaKeHw7tKHm8DrC8eqHCfqgBjTXu4SmsdfA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleE18oue4U1dbkxMysfOhsaKeHw7tKHm8DrC8eqHCfqgBjTXu4SmsdfA/640?wx_fmt=png&amp;from=appmsg"><figcaption>RSEM.isoforms.results</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044192" data-ratio="0.24722222222222223" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llev6t3LkP2NGr4AUibIsILevwgB7JHJkY3icib28sqXlnQz15jH9B9UCVdA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8llev6t3LkP2NGr4AUibIsILevwgB7JHJkY3icib28sqXlnQz15jH9B9UCVdA/640?wx_fmt=png&amp;from=appmsg"><figcaption>RSEM.genes.results</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>kallisto 定量</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>fasta=~/trinity_test/trinity_out_dir.Trinity.fasta<br>fq1=~/project/FL8/st1_data/C1_1.fq.gz<br>fq2=~/project/FL8/st1_data/C1_2.fq.gz<br>outdir=~/trinity_test/kallisto_quant<br><br>align_and_estimate_abundance.pl \<br>--transcripts trinity_out_dir.Trinity.fasta --seqType fq \<br>--left ${fq1} --right ${fq2} \<br>--est_method kallisto --trinity_mode --prep_reference \<br>--output_dir ${outdir}<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044195" data-ratio="0.8148148148148148" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleia7pL2bY8yCQQh5Dph8u1aoaf5ibs7RvDbAJCr4hZicN5lPKr5q0e2AHw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleia7pL2bY8yCQQh5Dph8u1aoaf5ibs7RvDbAJCr4hZicN5lPKr5q0e2AHw/640?wx_fmt=png&amp;from=appmsg"><figcaption>部分日志</figcaption></figure><p data-tool="mdnice编辑器">结果文件</p><pre data-tool="mdnice编辑器"><span></span><code>904K 10月  1 19:11 abundance.h5<br>3.4M 10月  1 19:11 abundance.tsv<br>1.9M 10月  1 19:11 abundance.tsv.genes<br> 526 10月  1 19:11 run_info.json<br></code></pre><p data-tool="mdnice编辑器">转录本ID定量结果</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044198" data-ratio="0.3453703703703704" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleBpe9WIeTuehFYP8DFvkxTLeo8PuMG8gzxQ1zb2EZFFTs4ibdxmyfQ6Q/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleBpe9WIeTuehFYP8DFvkxTLeo8PuMG8gzxQ1zb2EZFFTs4ibdxmyfQ6Q/640?wx_fmt=png&amp;from=appmsg"><figcaption>转录本ID定量结果</figcaption></figure><figure data-tool="mdnice编辑器"><img data-imgfileid="100044197" data-ratio="0.3731481481481482" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleYNiaR8XDib1ZR5YbwlmmRcpaXxGPNyz3WIpvlOn7GTO9Gpl7bhaehiajw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleYNiaR8XDib1ZR5YbwlmmRcpaXxGPNyz3WIpvlOn7GTO9Gpl7bhaehiajw/640?wx_fmt=png&amp;from=appmsg"><figcaption>基因ID定量结果</figcaption></figure><h3 data-tool="mdnice编辑器"><span></span><span>salmon 定量</span><span></span></h3><pre data-tool="mdnice编辑器"><span></span><code>fasta=~/trinity_test/trinity_out_dir.Trinity.fasta<br>fq1=~/project/FL8/st1_data/C1_1.fq.gz<br>fq2=~/project/FL8/st1_data/C1_2.fq.gz<br>outdir=~/trinity_test/salmon_quant<br><br>align_and_estimate_abundance.pl \<br>--transcripts trinity_out_dir.Trinity.fasta --seqType fq \<br>--left ${fq1} --right ${fq2} \<br>--est_method salmon --trinity_mode --prep_reference \<br>--output_dir ${outdir}<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100044200" data-ratio="0.6574074074074074" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lle5rRpmOCUia1Siagia969dYAjL7NShibQibltoeD6ibRHkZuDwF7rUHDS0Xbw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lle5rRpmOCUia1Siagia969dYAjL7NShibQibltoeD6ibRHkZuDwF7rUHDS0Xbw/640?wx_fmt=png&amp;from=appmsg"><figcaption>部分日志</figcaption></figure><p data-tool="mdnice编辑器">结果文件</p><pre data-tool="mdnice编辑器"><span></span><code>4.0K 10月  1 19:23 aux_info<br> 401 10月  1 19:23 cmd_info.json<br> 625 10月  1 19:23 lib_format_counts.json<br>4.0K 10月  1 19:23 libParams<br>4.0K 10月  1 19:20 logs<br>3.7M 10月  1 19:23 quant.sf<br>1.9M 10月  1 19:23 quant.sf.genes<br></code></pre><p data-tool="mdnice编辑器">转录本ID定量结果</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044199" data-ratio="0.31851851851851853" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lle4o4lA4ss2vDnDic2BshRrMic2l9jwicuWOhia3L2BXjKmCKoZJANibmibvvQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lle4o4lA4ss2vDnDic2BshRrMic2l9jwicuWOhia3L2BXjKmCKoZJANibmibvvQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>转录本ID定量结果</figcaption></figure><p data-tool="mdnice编辑器">基因ID定量结果</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100044196" data-ratio="0.41574074074074074" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleyJ4QHZyIYvxLzRedvHOrUphqI8iapsrLCvLc8U0QC762HvyyTWXMsoQ/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los8otCcW8omQW9tQoGnia8lleyJ4QHZyIYvxLzRedvHOrUphqI8iapsrLCvLc8U0QC762HvyyTWXMsoQ/640?wx_fmt=png&amp;from=appmsg"><figcaption>基因ID定量结果</figcaption></figure><blockquote data-tool="mdnice编辑器"><span></span><p>更多用法见：https://github.com/trinityrnaseq/trinityrnaseq/wiki</p></blockquote><hr data-tool="mdnice编辑器"><p data-tool="mdnice编辑器">参考：</p><ul data-tool="mdnice编辑器"><li><section>https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Transcript-Quantification#rsem-output</section></li><li><section>https://www.bioinfo-scrounger.com/archives/241/</section></li><li><section>https://chenhongyubio.github.io/2020/08/11/%E6%97%A0%E5%8F%82%E8%BD%AC%E5%BD%95%E7%BB%84%E6%8B%BC%E6%8E%A5/</section></li></ul></section><p><br></p><section><section act="xmy"><section data-id="123409" data-type="lspecial02,lspecial04" powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section><section powered-by="xmyeditor.com" data-md5="8b46d"><img data-imgfileid="100044180" data-ratio="0.6940298507462687" data-type="gif" data-w="134" data-src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp" src="https://mmbiz.qpic.cn/mmbiz_gif/iaRJcrq2LosibrvQnXTV3PMktpwwmDsjia2JG4e3ibpLQ1G6M4nktW4PiaiaKfnpiaRmNbTT6St7QLfzAMAomKgWxQ4kA/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1&amp;tp=webp"></section><section powered-by="xmyeditor.com" data-md5="8b46d"><br></section></section></section></section></section></section><p><span></span><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h4 data-tool="mdnice编辑器">文末友情宣传</h4><p data-tool="mdnice编辑器">强烈建议你推荐给身边的<strong>博士后以及年轻生物学PI</strong>，多一点数据认知，让他们的科研上一个台阶：</p><ul data-tool="mdnice编辑器"><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzMTEwODk0Ng==&amp;mid=2247517148&amp;idx=1&amp;sn=9a7c501ad1b59208323dcdf9d7b3b4eb&amp;chksm=fa4546e1cd32cff7468ab31799baba767fba7aa2290e30734cf3d45d9ba8cdf4d97e275f8a19&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课10月班" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2"><strong>生信入门&amp;数据挖掘线上直播课10月班</strong></a><strong>，你的生物信息学入门课</strong></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247524148&amp;idx=1&amp;sn=7806da6feb41a36493c519c1cfc1d3ac&amp;chksm=9b4bdf8fac3c569960369602f1ef26639cb366b250f233b2297d1f059471c0458335bfc0b829&amp;scene=21#wechat_redirect" textvalue="时隔5年，我们的生信技能树VIP学徒继续招生啦" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>时隔5年，我们的生信技能树VIP学徒继续招生啦</strong></a><br></section></li><li><section><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247528363&amp;idx=1&amp;sn=5e02f3e9b2e148191e23ebc2c0d780e7&amp;chksm=9b4b2f10ac3ca606c1c4bac8cf112bb9b0f18e3c4262f5f2b8c0dba3bfedf2ba201507247005&amp;scene=21#wechat_redirect" textvalue="2024的共享服务器交个朋友福利价仍然是800" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1"><strong>2024的共享服务器交个朋友福利价仍然是800</strong></a><span></span></section></li></ul></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/Wp4GiKnAN6rOh5JhlOe0IA",target="_blank" rel="noopener noreferrer">原文链接</a>
