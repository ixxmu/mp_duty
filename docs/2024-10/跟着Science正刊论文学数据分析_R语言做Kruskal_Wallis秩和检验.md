---
title: "跟着Science正刊论文学数据分析:R语言做Kruskal-Wallis秩和检验"
date: 2024-10-19T11:49:55Z
draft: ["false"]
tags: [
  "fetched",
  "小明的数据分析笔记本"
]
categories: ["Acdemic"]
---
跟着Science正刊论文学数据分析:R语言做Kruskal-Wallis秩和检验 by 小明的数据分析笔记本
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-mpa-powered-by="yiban.io"><p data-tool="mdnice编辑器"><strong>首先推荐一本算法相关的书</strong></p><p data-tool="mdnice编辑器"><br></p><section><mp-common-cpsad data-pluginname="mpcps" data-templateid="card" data-traceid="e5f5be23-51d6-4d95-883b-8dd921e3ed10" data-goodssouce="1" data-pid="101_14292931" data-appuin="3277471712" data-cpsversion="v112"></mp-common-cpsad></section></section><p><br></p><p>推荐的理由：没有太复杂的数学公式，都是一些简单的小例子，配有一些有趣的插图。涉及到的算法有排序、递归、哈希表、动态规划等等，内容还挺多的。动态规划在生物信息学的序列比对中是非常常用的算法。闲来无事时可以拿出来翻翻。<br></p><p><br></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span>论文</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><span></span><h1><span></span><span><span>Reconstruction of the human amylase locus reveals ancient duplications seeding modern-day variation</span></span><span></span></h1></blockquote><p data-tool="mdnice编辑器">https://www.science.org/doi/10.1126/science.adn0609</p><p data-tool="mdnice编辑器">论文作者的推特 https://x.com/evobioclio</p><p data-tool="mdnice编辑器">之前做过估计基因拷贝数，但是审稿人对估计的准确性一直提出问题，最后也没有给出太好的回复。想看一下这篇论文里具体是怎么研究基因拷贝数的。论文的内容很长，估计需要看好长时间。看的过程中争取把能复现的部分都记录下来。</p><p data-tool="mdnice编辑器">还有一篇今年发的Nature论文也是研究这个基因位点</p><p data-tool="mdnice编辑器">https://www.nature.com/articles/s41586-024-07911-1</p><blockquote data-tool="mdnice编辑器"><span></span><h1><span></span><span><span>Recurrent evolution and selection shape structural diversity at the amylase locus</span></span><span></span></h1></blockquote><p data-tool="mdnice编辑器">这个论文也好好看看</p><p data-tool="mdnice编辑器">今天的推文是记录 Kruskal-Wallis秩和检验</p><p data-tool="mdnice编辑器">论文里写</p><blockquote data-tool="mdnice编辑器"><span></span><p>To evaluate whether the AMY1 gene copy numbers exhibit population-specific patterns, we performed Kruskal-Wallis rank sum test using the copy number information</p></blockquote><h2 data-tool="mdnice编辑器"><span></span><span>Kruskal-Wallis秩和检验 主要作用</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>This non-parametric test was used to determine if there are statistically significant differences between the medians of three or more independent groups</p></blockquote><p data-tool="mdnice编辑器">非参数检验，检验3组或者更多组的中位数是否有显著的差异</p><h2 data-tool="mdnice编辑器"><span></span><span>优势</span><span></span><span> </span></h2><blockquote data-tool="mdnice编辑器"><span></span><p>We chose this test due to its robustness in handling non-normally distributed data</p></blockquote><p data-tool="mdnice编辑器">在处理非正态分布数据时具有稳健性。</p><p data-tool="mdnice编辑器">之前有一篇推文介绍过这个统计检验方法</p><p data-tool="mdnice编辑器"><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzI3NzQ3MTcxMg==&amp;mid=2247496483&amp;idx=1&amp;sn=1cc15529174f76c1092fd510300b5e1c&amp;chksm=eb677bacdc10f2ba4b8a68cdaa74c40fb350da4ab67aee9e541131456165f436a8f77f009ce3&amp;scene=21#wechat_redirect" textvalue="跟着Nature Genetics学作图：R语言ggplot2箱线图展示不同类别基因家族核苷酸多样性" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">跟着Nature Genetics学作图：R语言ggplot2箱线图展示不同类别基因家族核苷酸多样性</a><br></p><h2 data-tool="mdnice编辑器"><span></span><span>代码</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(tidyverse)<br>library(readxl)<br><br>dat&lt;-read_excel("D:/R_4_1_0_working_directory/env001/2024.data/20241018/science.adn0609_tables_s1_to_s15.xlsx",<br>           sheet = "S3",<br>           skip = 3)<br><br>dat %&gt;% pull(SuperPopulation) %&gt;% <br>  table()<br><br>kruskal.test(`AMY1 Copy Number`~SuperPopulation,<br>             data = dat)<br><br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014433" data-ratio="0.4917293233082707" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskaubvKwv7Tms61WqjsNcZDgV6N96ziaryMeO98J0uSpeFnrbUe4VFESg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="665" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskaubvKwv7Tms61WqjsNcZDgV6N96ziaryMeO98J0uSpeFnrbUe4VFESg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">这里总共5组数据，Kruskal-Wallis秩和检验 给出一个P值，想看下两两之间的差异用 Nemenyi test</p><p data-tool="mdnice编辑器">代码</p><pre data-tool="mdnice编辑器"><span></span><code>dat %&gt;% <br>  mutate(SuperPopulation=factor(SuperPopulation)) -&gt; dat<br><br>PMCMRplus::kwAllPairsNemenyiTest(`AMY1 Copy Number`~SuperPopulation,<br>                                 data = dat)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014432" data-ratio="0.44878048780487806" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskMNQ63fJg2VrZEkfmuOjUBErDRhC8PA2btdJcF4s0GIyRJ1MiaoFxv6Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1025" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskMNQ63fJg2VrZEkfmuOjUBErDRhC8PA2btdJcF4s0GIyRJ1MiaoFxv6Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">下三角矩阵对应的应该是P值</p><h2 data-tool="mdnice编辑器"><span></span><span>画个云雨图</span><span></span><span> </span></h2><pre data-tool="mdnice编辑器"><span></span><code>library(smplot2)<br>ggplot(dat, aes(x = SuperPopulation, y = `AMY1 Copy Number`, fill = SuperPopulation)) + <br>  sm_raincloud() +<br>  theme(text = element_text(size = 13),<br>        axis.text.x = element_text(angle=0,hjust=0.5,vjust=1))+<br>  labs(x=NULL,y=NULL)<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100014434" data-ratio="0.42407407407407405" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskv5etmL9V3gUe2VaV8FY3ZHrjeUxwPAOAy2mqBfvZpPd1MsoPicexlxw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/t1wZDoUyFk7jqfibGf01sPagzmprVqaskv5etmL9V3gUe2VaV8FY3ZHrjeUxwPAOAy2mqBfvZpPd1MsoPicexlxw/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>欢迎大家关注我的公众号</strong></p><p data-tool="mdnice编辑器"><strong>小明的数据分析笔记本</strong></p><section><mp-common-profile data-pluginname="mpprofile" data-id="MzI3NzQ3MTcxMg==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/t1wZDoUyFk5t1sOnM0iabvBhnfIj5YpyqrMib0E1MGCd9ibcYxaOPZd0GWhQBDvK2BPEwsicQxd6y5MHLfphnwHnow/0?wx_fmt=png" data-nickname="小明的数据分析笔记本" data-alias="" data-signature="分享R语言和python在生物信息领域做数据分析和数据可视化的简单小例子；偶尔会分享一些组学数据处理相关的内容" data-from="0" data-is_biz_ban="0"></mp-common-profile></section><p data-tool="mdnice编辑器"><strong></strong></p><blockquote data-tool="mdnice编辑器"><span></span><p>小明的数据分析笔记本 公众号 主要分享：1、R语言和python做数据分析和数据可视化的简单小例子；2、园艺植物相关转录组学、基因组学、群体遗传学文献阅读笔记；3、生物信息学入门学习资料及自己的学习笔记！</p></blockquote></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/z-4MJUclrv_5TbBVSrpMHA",target="_blank" rel="noopener noreferrer">原文链接</a>
