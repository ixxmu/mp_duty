---
title: "miRNA分析流程学习(一)/TCGAmiRNA数据下载"
date: 2024-10-27T23:43:09Z
draft: ["false"]
tags: [
  "fetched",
  "生信方舟"
]
categories: ["Acdemic"]
---
miRNA分析流程学习(一)/TCGAmiRNA数据下载 by 生信方舟
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><p data-tool="mdnice编辑器">miRNA（microRNA） 是一种小的非编码 RNA 分子，通常由 20 到 24 个核苷酸组成。miRNA 主要存在于动植物中，并在基因表达调控中起到关键作用。它们通过与特定的信使 RNA（mRNA）分子结合来抑制基因表达，通常通过抑制翻译或促进 mRNA 的降解。</p><p data-tool="mdnice编辑器"><strong>miRNA 的特征和功能</strong></p><ol data-tool="mdnice编辑器"><li><section>基因表达调控：miRNA 不直接编码蛋白质，而是通过调节蛋白质编码基因的表达来发挥作用。典型的调控方式是通过与靶 mRNA 配对，然后抑制其翻译或促使其降解。</section></li><li><section>产生与加工：miRNA 通常由较长的初始转录本（称为 pri-miRNA）加工而来。pri-miRNA 在细胞核中由 Drosha 酶加工成较短的 pre-miRNA，然后被运送到细胞质中。在细胞质中，Dicer 酶进一步加工 pre-miRNA，将其切割成成熟的双链 miRNA。其中一条链（称为“引导链”）会与 RNA 诱导沉默复合体（RISC） 结合，另一条链（称为“乘客链”）通常会被降解。</section></li><li><section>靶标结合与功能：miRNA 通过其引导链的 种子序列（位于 miRNA 的 5' 端，通常为第 2 到第 8 位核苷酸）与靶 mRNA 的 3' 非翻译区（3' UTR） 结合。这种结合可以导致 mRNA 的翻译抑制或直接降解，从而减少特定蛋白质的产生。</section></li></ol><p data-tool="mdnice编辑器"><strong>miRNA 的生物学意义</strong></p><ol data-tool="mdnice编辑器"><li><section>发育调控：miRNA 在胚胎发育、细胞分化和器官形成中扮演重要角色。</section></li><li><section>细胞周期与凋亡：miRNA 参与调控细胞的增殖、分化和凋亡，维持细胞稳态。</section></li><li><section>癌症：miRNA 在肿瘤发生和发展中起到关键作用。某些 miRNA 可以作为癌基因（促进癌症的 miRNA）或抑癌基因（抑制癌症的 miRNA）。</section></li><li><section>免疫反应：miRNA 调节免疫系统的功能，影响炎症反应和免疫调节。</section></li></ol><p data-tool="mdnice编辑器"><strong>miRNA 的应用</strong></p><ol data-tool="mdnice编辑器"><li><section>生物标志物：由于 miRNA 在不同疾病状态下的表达差异，它们可以作为疾病诊断和预后的生物标志物。例如，在一些癌症中，特定 miRNA 的表达上调或下调与疾病进展相关。</section></li><li><section>治疗靶标：miRNA 的调节功能使它们成为潜在的药物靶标。通过抑制有害的 miRNA 或补充缺失的 miRNA，可以开发新的治疗方法。一些 miRNA 模拟物和反义 oligonucleotide（anti-miRNA） 已经在临床试验中。</section></li><li><section>基因功能研究：miRNA 是研究基因功能和信号通路的重要工具，帮助揭示复杂的基因调控网络。</section></li></ol><p data-tool="mdnice编辑器">笔者能力有限，详细的miRNA知识就不再赘述了，感兴趣的小伙伴可以去读一读参考资料中的综述~</p><p data-tool="mdnice编辑器"><strong>miRNA数据库</strong></p><p data-tool="mdnice编辑器">关于miRNA的数据库有很多，以下是几个比较重要的：</p><p data-tool="mdnice编辑器">1、miRBase：这个数据库是所有想做miRNA分析的研究者一定绕不开的工具<img data-imgfileid="100002705" data-ratio="0.49944994499449946" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddV3rnkU9hO0LclSFFp0ic1ADBo7AtFbTdGAMZX6Qb2icGhw44Mvic7DC1Pg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="909" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddV3rnkU9hO0LclSFFp0ic1ADBo7AtFbTdGAMZX6Qb2icGhw44Mvic7DC1Pg/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">2、MicroRNAdb<img data-imgfileid="100002706" data-ratio="0.376" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddVcB23ib3ibDmkKr6p5GMCqaBU1Tsib4weguPLBibfBh9AuMpZpZRy97oeXQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="750" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddVcB23ib3ibDmkKr6p5GMCqaBU1Tsib4weguPLBibfBh9AuMpZpZRy97oeXQ/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">3、miRTarBase<img data-imgfileid="100002707" data-ratio="0.6280864197530864" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddVjpfoaPUxlN6FojscgqzAsD88vtqyss0R6o74xxcPHkJj4ia3o0zPichA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="648" src="https://mmbiz.qpic.cn/sz_mmbiz_png/0SOG4MpDAyEPReusWpRAXsdGesJictddVjpfoaPUxlN6FojscgqzAsD88vtqyss0R6o74xxcPHkJj4ia3o0zPichA/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器">4、除此之外还有很多，比如：psRNATARGET，MicroRNAdb，miRWalk，TarBase，miRGator，CoGemiR，PolymiRTS，PicTar等。</p><h4 data-tool="mdnice编辑器"><span></span>TCGA-miRNA数据下载<span></span></h4><p data-tool="mdnice编辑器">正式分析之前还需要获取miRNA的数据，其中最常用的数据库一定是TCGA了, 因此我们先从这个数据库开始。</p><p data-tool="mdnice编辑器">对于来自TCGA数据库的数据，有一个好用的下载工具就是TCGAbiolinks，它可以帮助我们方便的获取到TCGA中的数据。</p><h5 data-tool="mdnice编辑器"><span></span>1.导入<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>rm(list = ls())<br><span>library</span>(TCGAbiolinks)<br><span>library</span>(qs)<br><span>library</span>(BiocParallel)<br>register(MulticoreParam(workers = <span>8</span>, progressbar = <span>TRUE</span>)) <br><br><span># 查看TCGA中33种癌症的简称</span><br><span>library</span>(TCGAbiolinks)<br><br>projects &lt;- TCGAbiolinks::getGDCprojects()$project_id <span>##获取癌症名字</span><br>projects &lt;- projects[grepl(<span>'^TCGA'</span>, projects, perl=<span>TRUE</span>)]<br>projects<br><span>#  [1] "TCGA-PCPG" "TCGA-THYM" "TCGA-PAAD" "TCGA-STAD" "TCGA-TGCT" "TCGA-SARC" "TCGA-PRAD" "TCGA-READ" "TCGA-UCS"  "TCGA-UVM" </span><br><span># [11] "TCGA-KICH" "TCGA-HNSC" "TCGA-LUAD" "TCGA-LIHC" "TCGA-LUSC" "TCGA-MESO" "TCGA-LAML" "TCGA-LGG"  "TCGA-KIRP" "TCGA-KIRC"</span><br><span># [21] "TCGA-ACC"  "TCGA-BLCA" "TCGA-DLBC" "TCGA-CHOL" "TCGA-CESC" "TCGA-COAD" "TCGA-BRCA" "TCGA-ESCA" "TCGA-GBM"  "TCGA-OV"  </span><br><span># [31] "TCGA-THCA" "TCGA-SKCM" "TCGA-UCEC"</span><br><br>TCGAbiolinks:::getProjectSummary(<span>"TCGA-HNSC"</span>)<br><span># $file_count</span><br><span># [1] 29489</span><br><span># </span><br><span># $data_categories</span><br><span>#    file_count case_count                data_category</span><br><span># 1        8330        528  Simple Nucleotide Variation</span><br><span># 2        4595        528             Sequencing Reads</span><br><span># 3        2858        528                  Biospecimen</span><br><span># 4        1103        528                     Clinical</span><br><span># 5        5925        526        Copy Number Variation</span><br><span># 6        2270        528      Transcriptome Profiling</span><br><span># 7        1740        528              DNA Methylation</span><br><span># 8         354        354           Proteome Profiling</span><br><span># 9          50         24 Somatic Structural Variation</span><br><span># 10       2264        521         Structural Variation</span><br><span># </span><br><span># $case_count</span><br><span># [1] 528</span><br><span># </span><br><span># $file_size</span><br><span># [1] 3.019863e+14</span><br></code></pre><h5 data-tool="mdnice编辑器"><span></span>2.TCGA-miRNA数据下载<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>proj &lt;- <span>"TCGA-HNSC"</span><br><span># 单独下载</span><br>query &lt;- GDCquery(project = proj,<br>                  data.category = <span>"Transcriptome Profiling"</span>,<br>                  data.type = <span>"miRNA Expression Quantification"</span>,<br>                  workflow.type = <span>"BCGSC miRNA Profiling"</span> <br>)<br>GDCdownload(query)<br>GDCprepare(query,save = <span>T</span>,save.filename = paste0(project,<span>"_miRNA.Rdata"</span>))<br><br><span># 批量下载数据</span><br>sapply(projects, <span>function</span>(project){<br>  <br>  query &lt;- GDCquery(project = project,<br>                    data.category = <span>"Transcriptome Profiling"</span>,<br>                    data.type = <span>"miRNA Expression Quantification"</span><br>                    )<br>  <br>  GDCdownload(query)<br>  <br>  GDCprepare(query, save = <span>T</span>,save.filename = paste0(project,<span>"_miRNA.Rdata"</span>))<br>  <br>})<br></code></pre><h5 data-tool="mdnice编辑器"><span></span>3.数据处理及保存<span></span></h5><pre data-tool="mdnice编辑器"><span></span><code>load(paste0(proj,<span>"_miRNA.Rdata"</span>))<br>head(data)[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>#       miRNA_ID read_count_TCGA-BA-6871-01A-11R-1872-13 reads_per_million_miRNA_mapped_TCGA-BA-6871-01A-11R-1872-13</span><br><span># 1 hsa-let-7a-1                                   39430                                                    8590.708</span><br><span># 2 hsa-let-7a-2                                   39178                                                    8535.804</span><br><span># 3 hsa-let-7a-3                                   39394                                                    8582.864</span><br><span># 4   hsa-let-7b                                   65142                                                   14192.642</span><br><span>#   cross-mapped_TCGA-BA-6871-01A-11R-1872-13</span><br><span># 1                                         N</span><br><span># 2                                         Y</span><br><span># 3                                         N</span><br><span># 4                                         N</span><br><br><span># 把列名中含有count的数据提取出来</span><br>rownames(data) &lt;- data$miRNA_ID<br>col &lt;- grepl(<span>"count"</span>, colnames(data))<br>miRNA_count &lt;- data[,col]<br>colnames(miRNA_count) &lt;- sub(<span>"read_count_"</span>,<span>""</span>,colnames(miRNA_count))  <span># gsub是去除所有匹配的字符</span><br>head(miRNA_count)[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br><span>#              TCGA-BA-6871-01A-11R-1872-13 TCGA-CN-6024-01A-11R-1685-13 TCGA-IQ-7631-01A-11R-2080-13</span><br><span># hsa-let-7a-1                        39430                        37356                        78370</span><br><span># hsa-let-7a-2                        39178                        37111                        78621</span><br><span># hsa-let-7a-3                        39394                        37080                        79843</span><br><span># hsa-let-7b                          65142                        65155                       193506</span><br><span>#              TCGA-CV-7406-01A-11R-2080-13</span><br><span># hsa-let-7a-1                        43002</span><br><span># hsa-let-7a-2                        42954</span><br><span># hsa-let-7a-3                        43141</span><br><span># hsa-let-7b                          78858</span><br>save(miRNA_count,file = paste0(proj,<span>"_miRNA_count.Rdata"</span>))<br></code></pre><h4 data-tool="mdnice编辑器"><span></span>参考资料：<span></span></h4><ol data-tool="mdnice编辑器"><li><section>MicroRNA profiling: approaches and considerations. Nat Rev Genet. 2012 Apr 18;13(5):358-69.</section></li><li><section>microRNA functions. Annu Rev Cell Dev Biol. 2007:23:175-205.</section></li><li><section>miRBase数据库：https://www.mirbase.org/</section></li><li><section>TCGAbiolinks:https://bioconductor.org/packages/devel/bioc/vignettes/TCGAbiolinks/inst/doc/index.html  https://bioconductor.org/packages/release/bioc/html/TCGAbiolinks.html</section></li><li><section>GDCquery: https://rdrr.io/bioc/TCGAbiolinks/man/GDCquery.html</section></li><li><section>生信技能树时间线：https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=MzAxMDkxODM1Ng==&amp;scene=24&amp;album_id=2201138830328528899&amp;count=3&amp;uin=&amp;key=&amp;devicetype=iMac+Mac14%2C7+OSX+OSX+14.6.1+build(23G93)&amp;version=13080810&amp;lang=zh_CN&amp;nettype=WIFI&amp;ascene=0&amp;fontScale=100</section></li><li><section>生信技能树B站视频：https://www.bilibili.com/video/BV1zK411n7qr/?vd_source=3a13860df939bc922ad1fd6099e42c1d</section></li><li><section>生信技能树：https://mp.weixin.qq.com/s/847Zc6QbU44LSL3l_STSpg  https://mp.weixin.qq.com/s/USc_aUA_loFLLljXzbmpFg</section></li><li><section>生信星球：https://www.jianshu.com/p/59e179212bdc</section></li><li><section>佳奥：https://www.jianshu.com/p/b7cbf0cb78ae</section></li><li><section>医学和生信笔记：https://zhuanlan.zhihu.com/p/556196846</section></li><li><section>叶子的数据科技专栏：https://cloud.tencent.com/developer/article/2245363</section></li></ol><p data-tool="mdnice编辑器"><strong>致谢</strong>：感谢曾老师以及生信技能树团队全体成员。</p><p data-tool="mdnice编辑器"><strong>注</strong>：若对内容有疑惑或者有发现明确错误的朋友，请联系后台(欢迎交流)。更多内容可关注公众号：<strong>生信方舟</strong></p><span>- END -</span></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/l2eOdrqgM64ZVPX77XWmdw",target="_blank" rel="noopener noreferrer">原文链接</a>
