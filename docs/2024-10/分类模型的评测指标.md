---
title: "分类模型的评测指标"
date: 2024-10-03T09:40:03Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
分类模型的评测指标 by 生信星球
------
<div><p><img data-imgfileid="100012345" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-imgfileid="100012344" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第1000天</strong></span></span><img data-imgfileid="100012343" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></p><hr><p><span><span>   </span></span></p><section><blockquote><p><span>公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。</span><span>我的课程都是循环开课，</span><span>点进去咨询微信↓</span><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247496032&amp;idx=1&amp;sn=e84ffce4f05b6f4318b95f170642d702&amp;chksm=fdfbb922ca8c30344c47b39529a16280bacb23c83e35a18f63e158f4e664ef94b5eee0e3fff8&amp;scene=21#wechat_redirect" textvalue="‍生信分析直播课程‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信分析直播课程</a>(每月初开一期，春节休一个月)</p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494919&amp;idx=2&amp;sn=967d8dcf0f9a22047ae0bd442b9d4ee6&amp;chksm=fdfba545ca8c2c5396c3fb5caa93a5d30336626533fcac074abd7683e8d536cb2dcae31d6e7a&amp;scene=21#wechat_redirect" textvalue="生信新手保护‍学习‍小组" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信新手保护学习小组</a>（每月两期）</p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;chksm=fdfba53eca8c2c286522b2accc0d4cb9dda7cd9a5b36695e66d393abb5bff396d6bcaa4c9cb8&amp;scene=21#wechat_redirect" textvalue="单细胞陪伴学习小组内测完成，长期招生中" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">单细胞陪伴学习小组</a>（每月两期)<strong></strong></p></blockquote></section><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><p data-tool="mdnice编辑器">评估准确率并不适用于所有的情况。</p><h3 data-tool="mdnice编辑器"><span></span><span>分类不平衡的数据不能只计算准确率</span><span></span></h3><p data-tool="mdnice编辑器">假如构建一个预测银行交易是否为欺诈的模型，99%是合法交易，1%是欺诈，那么可以构建一个模型，预测所有交易都是合法交易，正确率高达99%。</p><p data-tool="mdnice编辑器">但是，它无法真正预测欺诈，未能达到建模的初衷。所以需要采用不同的方法来评估模型的性能。</p><h3 data-tool="mdnice编辑器"><span></span><span>那还有什么其他的指标可以用呢？</span><span></span></h3><p data-tool="mdnice编辑器">接下来要迎接一串名词的暴击：</p><ul data-tool="mdnice编辑器"><li><section>混淆矩阵</section></li><li><section>准确率</section></li><li><section>精确度</section></li><li><section>召回率</section></li><li><section>F1分数</section></li></ul><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>混淆矩阵和它的小伙伴们</span><span><span> </span></span></h4><figure data-tool="mdnice编辑器"><img data-imgfileid="100012472" data-ratio="0.27314814814814814" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSndictJzyHWWBia5Vn3JVfzG413c9mnKn6mzHmYiaXcCwqtOOl3rfHB52w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSndictJzyHWWBia5Vn3JVfzG413c9mnKn6mzHmYiaXcCwqtOOl3rfHB52w/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">直观的理解一下，假如我们做的分类模型是诊断模型，0是没病，1是有病。那么：</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012470" data-ratio="0.45235069885641677" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSaADtOGwHQT0icQbdo4x9M6YYlTiaKrTsaKaTSc9RKhqacc9HCCKoYJeA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="787" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSaADtOGwHQT0icQbdo4x9M6YYlTiaKrTsaKaTSc9RKhqacc9HCCKoYJeA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">感兴趣的类别（欺诈/有病）是阳性。从混淆矩阵中可以计算多个统计量：</p><p data-tool="mdnice编辑器"><strong>准确率</strong>：正确预测的次数/总预测次数</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012469" data-ratio="0.3081180811808118" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSwCHVxK5fxcNhOg2z9DiaEdO4DKhn6RFM9BI1evFZicMJIndmNvCDMI7Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="542" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSwCHVxK5fxcNhOg2z9DiaEdO4DKhn6RFM9BI1evFZicMJIndmNvCDMI7Q/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>精确度(precision)</strong>：TP/TP+FP，高精确度意味着较低的误报率(把合法交易说成欺诈就是误报)</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012468" data-ratio="0.16621983914209115" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSIdtzicq6FgyPvYJxw48wGrBqXojkvOuRSrBKj2gkIo6gpVpejSGa4iaA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="746" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSIdtzicq6FgyPvYJxw48wGrBqXojkvOuRSrBKj2gkIo6gpVpejSGa4iaA/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>召回率(recall)</strong>: TP/TP+FN, 高召回率意味着较低的假阴性率(把欺诈说成合法交易就是假阴性)</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012471" data-ratio="0.23647604327666152" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSfXJSLwvibJ57iblddto0BsicDrTFbBFgZMMGPp4bVVphIueESjaG7ibfAQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="647" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSfXJSLwvibJ57iblddto0BsicDrTFbBFgZMMGPp4bVVphIueESjaG7ibfAQ/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器"><strong>F1 score</strong> :综合考虑精确度和召回率</p><figure data-tool="mdnice编辑器"><img data-imgfileid="100012473" data-ratio="0.18106995884773663" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSglicRSCbeADcroCZxby8ZJlAd2cTJdWyShLj3RCY5BSiay4KPicOd6EWg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="486" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSglicRSCbeADcroCZxby8ZJlAd2cTJdWyShLj3RCY5BSiay4KPicOd6EWg/640?wx_fmt=png&amp;from=appmsg"></figure><p data-tool="mdnice编辑器">依然使用前面的建模数据，构建KNN分类模型</p><pre data-tool="mdnice编辑器"><code><span>import</span> pandas <span>as</span> pd<br><span>import</span> numpy <span>as</span> np<br>churn_df = pd.read_csv(<span>"Discriminant-analysis-churn-dataset.csv"</span>)<br>churn_df<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100012474" data-ratio="0.14907407407407408" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSibia5bHu9XQD6iao6Hq3PQOiaDv6eo0GbgrWP7lrLIIbXwJcKRGYic7t08Q/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHoUF1GbZIbqdBNZmjIjrlxSibia5bHu9XQD6iao6Hq3PQOiaDv6eo0GbgrWP7lrLIIbXwJcKRGYic7t08Q/640?wx_fmt=png&amp;from=appmsg"></figure><pre data-tool="mdnice编辑器"><code>X = churn_df[[<span>"total_day_charge"</span>, <span>"total_eve_charge"</span>]].values<br>y = churn_df[<span>"churn"</span>].values<br>print(X.shape, y.shape)<br></code></pre><pre data-tool="mdnice编辑器"><code>(5000, 2) (5000,)<br></code></pre><p data-tool="mdnice编辑器">confusion_matrix 函数可以计算混淆矩阵，而classification_report函数可以计算其他指标。</p><pre data-tool="mdnice编辑器"><code><span>from</span> sklearn.metrics <span>import</span> classification_report, confusion_matrix <br><span>from</span> sklearn.neighbors <span>import</span> KNeighborsClassifier<br><span>from</span> sklearn.model_selection <span>import</span> train_test_split <br>knn = KNeighborsClassifier(n_neighbors=<span>7</span>) <br>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span>0.4</span>,  <br>random_state=<span>42</span>)  <br>knn.fit(X_train, y_train) <br>y_pred = knn.predict(X_test)<br>print(confusion_matrix(y_test, y_pred))<br><span>## [[1677   50]</span><br><span>##  [ 185   88]]</span><br></code></pre><pre data-tool="mdnice编辑器"><code>print(classification_report(y_test, y_pred))<br></code></pre><pre data-tool="mdnice编辑器"><code><br>              precision    recall  f1-score   support<br><br>           0       0.90      0.97      0.93      1727<br>           1       0.64      0.32      0.43       273<br><br>    accuracy                           0.88      2000<br>   macro avg       0.77      0.65      0.68      2000<br>weighted avg       0.86      0.88      0.87      2000<br></code></pre><p data-tool="mdnice编辑器">这个报告按照类别计算了刚才提到的几项指标，0对应的一行就是以0为阳性，1对应的一行就是以1为阳性，我们应该看的是1对应的那一行。</p><p data-tool="mdnice编辑器">support是每个类别都有多少样本。</p><p data-tool="mdnice编辑器">最后三行是各个指标计算结果的平均值，宏平均和加权平均（最后一列除外）。</p></section><section><br></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/WYAUXXWXYoew_xKk-3U_4A",target="_blank" rel="noopener noreferrer">原文链接</a>
