---
title: "富集的物种不是人咋整啊"
date: 2024-10-15T04:11:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
富集的物种不是人咋整啊 by 生信星球
------
<div><p><img data-imgfileid="100012345" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><img data-imgfileid="100012344" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLPukRHCbicy4pNKeEv9qd7aWSfsx7roib2od3xPrRPicw3a0kbn0uQ6JmQ/640?wx_fmt=png"><span> 今天是生信星球陪你的<span><strong>第1008天</strong></span></span><img data-imgfileid="100012343" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-type="png" data-w="64" width="20px" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"></p><hr><p><span><span>   </span></span></p><section><blockquote><p><span>公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。</span><span>我的课程都是循环开课，</span><span>点进去咨询微信↓</span><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247496032&amp;idx=1&amp;sn=e84ffce4f05b6f4318b95f170642d702&amp;chksm=fdfbb922ca8c30344c47b39529a16280bacb23c83e35a18f63e158f4e664ef94b5eee0e3fff8&amp;scene=21#wechat_redirect" textvalue="‍生信分析直播课程‍" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2">生信分析直播课程</a>(每月初开一期，春节休一个月)</p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247494919&amp;idx=2&amp;sn=967d8dcf0f9a22047ae0bd442b9d4ee6&amp;chksm=fdfba545ca8c2c5396c3fb5caa93a5d30336626533fcac074abd7683e8d536cb2dcae31d6e7a&amp;scene=21#wechat_redirect" textvalue="生信新手保护‍学习‍小组" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">生信新手保护学习小组</a>（每月两期）</p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247495036&amp;idx=1&amp;sn=fe8bab2c3d21e7b0a919ad4f1641ca9c&amp;chksm=fdfba53eca8c2c286522b2accc0d4cb9dda7cd9a5b36695e66d393abb5bff396d6bcaa4c9cb8&amp;scene=21#wechat_redirect" textvalue="单细胞陪伴学习小组内测完成，长期招生中" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">单细胞陪伴学习小组</a>（每月两期)<strong></strong></p></blockquote></section><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com"><section>比如拟南芥啊。小鼠啊。这里的genes就是前面分析的差异基因（symbol）。</section><pre data-tool="mdnice编辑器"><section>rm(list = ls())<br>library(clusterProfiler)<br>library(org.At.tair.db)<br>library(stringr)<br>library(ggplot2)<br>load(<span>"genes.Rdata"</span>)<br>head(genes)<br></section></pre><pre data-tool="mdnice编辑器"><section><span>## [1] "ATBCA3"      "BCA3"        "AtWSCP"      "Kunitz-PI;1" "BCAT6"      </span><br><span>## [6] "OSR1"</span><br></section></pre><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>1.ID转换</span><span><span> </span></span></h4><section>首先是要转换ID,拟南芥是要TAIR id来做富集分析。怎么知道的呢？如果拿ENTRIZID来做，会收到这样式的报错信息： </section><img data-imgfileid="100012630" data-ratio="0.26143024618991795" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYk2BpmiaJiah1Wd6slSRibVf8pV2S3hfwdq2HLmyjmro910l5NSILcKUpg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="853" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYk2BpmiaJiah1Wd6slSRibVf8pV2S3hfwdq2HLmyjmro910l5NSILcKUpg/640?wx_fmt=other&amp;from=appmsg"><section>那我们就知道应该用AT开头的ID了。那是啥ID呢，查查呗。</section><section><figure data-tool="mdnice编辑器"><img data-imgfileid="100012629" data-ratio="0.4482758620689655" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYyyH6eob2RHYMmuKJX4xEKnp5k1nAvYA75xBKEB4pMia3P52oRtKxgZA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="609" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYyyH6eob2RHYMmuKJX4xEKnp5k1nAvYA75xBKEB4pMia3P52oRtKxgZA/640?wx_fmt=other&amp;from=appmsg"></figure></section><pre data-tool="mdnice编辑器"><section>x = bitr(genes,fromType = <span>"SYMBOL"</span>,toType = <span>"TAIR"</span>,<br>         OrgDb = <span>"org.At.tair.db"</span>)<br>head(x)<br></section></pre><pre data-tool="mdnice编辑器"><section><span>##        SYMBOL      TAIR</span><br><span>## 1      ATBCA3 AT1G23730</span><br><span>## 2        BCA3 AT1G23730</span><br><span>## 3      AtWSCP AT1G72290</span><br><span>## 4 Kunitz-PI;1 AT1G72290</span><br><span>## 5       BCAT6 AT1G50110</span><br><span>## 6        OSR1 AT2G41230</span><br></section></pre><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>2.做KEGG富集</span><span><span> </span></span></h4><pre data-tool="mdnice编辑器"><section>ekk &lt;- enrichKEGG(gene = x<span>$TAIR</span>,organism = <span>'ath'</span>)<br>ekk &lt;- setReadable(ekk,OrgDb = org.At.tair.db,keyType = <span>"TAIR"</span>)<br><span>#如果ekk是空的，这句就会报错，因为没富集到任何通路。</span><br><span># 条带图画一下</span><br>barplot(ekk)<br></section></pre><section><figure data-tool="mdnice编辑器"><img data-imgfileid="100012632" data-ratio="1.1425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYEKru8VTMQsoXYSSzuicB6TwcPlAib7NjoQ8MTzedF8n3aY1licmxtqOEQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYEKru8VTMQsoXYSSzuicB6TwcPlAib7NjoQ8MTzedF8n3aY1licmxtqOEQ/640?wx_fmt=other&amp;from=appmsg"></figure></section><section>发现纵坐标有多余的东西，可以在enrichResult对象里面删掉。</section><section>代码里的两个斜杠代表括号就是括号本身，不加两个斜杠就会被当作正则表达式的括号，它另有含义。</section><pre data-tool="mdnice编辑器"><section>ekk@result<span>$Description</span> =  str_remove(ekk@result<span>$Description</span>,<span>" - Arabidopsis thaliana \\(thale cress\\)"</span>)<br>barplot(ekk)<br></section></pre><section><figure data-tool="mdnice编辑器"><img data-imgfileid="100012631" data-ratio="1.1425925925925926" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYZp6nPBdTTkRGZ0kcf8AwALR8xDLlrjqI2JM7I7DGGMdrmNxNWsUl5Q/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYZp6nPBdTTkRGZ0kcf8AwALR8xDLlrjqI2JM7I7DGGMdrmNxNWsUl5Q/640?wx_fmt=other&amp;from=appmsg"></figure></section><section>改完再画,这回好咯</section><h4 data-tool="mdnice编辑器"><span><span> </span></span><span><span> </span>3.GO富集分析</span><span><span> </span></span></h4><section>就比较简单，指定一下keyType参数即可</section><pre data-tool="mdnice编辑器"><section>ego &lt;- enrichGO(gene = genes,OrgDb= org.At.tair.db,<br>                keyType = <span>"SYMBOL"</span>,<br>                ont = <span>"ALL"</span>)<br>barplot(ego, split = <span>"ONTOLOGY"</span>) + <br>  facet_grid(ONTOLOGY ~ ., space = <span>"free_y"</span>,scales = <span>"free_y"</span>) <br></section></pre><section><figure data-tool="mdnice编辑器"><img data-imgfileid="100012633" data-ratio="1.2861111111111112" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYygLjkhmY72941zVfDicTvQ5jM8vOaTnutZN7wA5gmccic2a3Mt90PDdA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/8oKPbJgbBHpNruR9DLxcuiaYuSwaryxaYygLjkhmY72941zVfDicTvQ5jM8vOaTnutZN7wA5gmccic2a3Mt90PDdA/640?wx_fmt=other&amp;from=appmsg"></figure></section><section><br></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/VwwYOiiyrgDfPwKbfw6iWw",target="_blank" rel="noopener noreferrer">原文链接</a>
