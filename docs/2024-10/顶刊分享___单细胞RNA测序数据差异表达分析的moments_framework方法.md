---
title: "顶刊分享---单细胞RNA测序数据差异表达分析的moments framework方法"
date: 2024-10-28T23:08:55Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞空间交响乐"
]
categories: ["Acdemic"]
---
顶刊分享---单细胞RNA测序数据差异表达分析的moments framework方法 by 单细胞空间交响乐
------
<div><h4 data-line="0">作者，Evil Genius</h4><h4 data-line="2">大家找准一个方向，好好钻研，<span>任何方向做到极致，都是顶刊。</span></h4><h4 data-line="4">今日参考文献</h4><p><img data-imgfileid="100009736" data-ratio="1.1908333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDLeReicTKNqKmiaazP16UN3s7AgZKttRMJwuglG1VNAv4GACZVUVzESrg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDLeReicTKNqKmiaazP16UN3s7AgZKttRMJwuglG1VNAv4GACZVUVzESrg/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="7">知识积累</h4><h6 data-line="8"><strong><span>单细胞RNA测序（scRNA-seq）数据的差异表达分析是表征实验因素如何影响基因表达分布的核心。</span></strong>然而，区分细胞-细胞变异的生物和技术来源以及评估细胞组之间定量比较的统计意义仍然具有挑战性。</h6><h6 data-line="9"><strong><span>基因表达本质上是由细胞的遗传结构及其环境相互作用决定的，由于内在噪声（源于mRNA转录和降解）和与细胞特定状态相关的外在噪声，基因表达可能会出现波动。</span></strong>虽然遗传和环境显著影响细胞群体的表达变异性，但随机转录噪声也会影响细胞对扰动的反应，以及细胞的发育和分化。表征确定性和随机因素如何共同影响基因表达的分布，对于理解转录控制是如何建立、维持和可能被破坏的至关重要。这些见解可以阐明基因型-表型关系尚未完全解释的现象的潜在机制，如不稳定、不完全外显性和可变表达性。</h6><h6 data-line="10">基因表达在细胞群体中的分布主要是由其均值和方差以及相关的衍生测量来表征的组成表达管家基因，经历转录和降解恒定速率，<strong><span>预测符合泊松分布。</span></strong></h6><h6 data-line="11"><strong><span>相关基因的表达受到类似的顺式调控元件的调控，这些顺式调控元件与一组在“开”和“关”状态之间循环的转录因子相互作用直到最近，研究基因表达的分布，特别是多基因的联合分布，</span></strong>在技术上一直具有挑战性，并且主要是在可以进行基因改造的模式生物中进行的。</h6><h6 data-line="12">单细胞RNA测序（scRNA-seq）已经成为一种系统和有效的方法，用于分析细胞转录组的实验因素，包括细胞外刺激，遗传扰动和自然遗传变异。理论上，<strong><span>对scRNA-seq数据的分析可以揭示确定性和随机因素如何共同塑造基因表达的分布。</span></strong>然而，仍然需要差分分析方法来比较细胞组之间的分布参数，包括平均值、变异性和基因相关性。</h6><h4 data-line="14">结果1、scRNA-seq统计模型</h4><p><img data-imgfileid="100009738" data-ratio="1.2775" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDVkBRr9icECicNJ3lOQsKVCaziaojHD9UsUkWg3G6Bqqiamt1QdGQR3GEgA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDVkBRr9icECicNJ3lOQsKVCaziaojHD9UsUkWg3G6Bqqiamt1QdGQR3GEgA/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="17">结果2、在模拟和真实数据上的性能</h4><h6 data-line="18">与现有的DM、DV和DC方法相比，Memento实现假设检验的计算速度快了几个数量级，可以扩展到数百万个细胞</h6><h6 data-line="19">校准良好的测试统计，促进了scRNA-seq数据的假设检验，可扩展到包含数百万细胞的级别。</h6><p><img data-imgfileid="100009737" data-ratio="1.2825" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDdgpAjYhyw8P5M8bt8ABRPLdpeCpibicjKHV2eeLHfJ6QTofYh6m0jO2A/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDdgpAjYhyw8P5M8bt8ABRPLdpeCpibicjKHV2eeLHfJ6QTofYh6m0jO2A/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="22">结果3、对外源性干扰素反应的差异变异和基因相关性</h4><h6 data-line="23">虽然IFNs是促进抗病毒免疫的有效细胞因子，但它们也在炎症和自身免疫性疾病的发病机制中发挥作用它们的作用是通过自分泌和旁分泌信号诱导基因表达；然而，受刺激细胞中转录组反应的异质性在很大程度上仍未被探索。</h6><h6 data-line="24">在IFN存在和不存在的情况下决定细胞行为的复杂调控相互作用，为细胞如何调节其转录组对环境线索的反应提供了新的视角。</h6><p><img data-imgfileid="100009739" data-ratio="1.1283333333333334" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDPQZ8epOtibdEFicamqbSkUEUyJBrCqtBKavqH10WDOXdXgdgC3EEuRKg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDPQZ8epOtibdEFicamqbSkUEUyJBrCqtBKavqH10WDOXdXgdgC3EEuRKg/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="27">结果4、受干扰的CD4+ T细胞的差异表达分析映射了T细胞激活中的基因调控网络</h4><p><img data-imgfileid="100009740" data-ratio="1.5129870129870129" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDwSpZ2Na36SKBicJA25W0vpmX4ja5ciaBV7MDKkKJ0ZSzTSIyUtJLcAgA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1078" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDwSpZ2Na36SKBicJA25W0vpmX4ja5ciaBV7MDKkKJ0ZSzTSIyUtJLcAgA/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="30">结果5、群体尺度scRNA-seq的遗传分析</h4><h6 data-line="31">越来越多的scRNA-seq数据集在群体规模上的可用性为绘制与特定细胞类型中近端基因（cis）表达分布变化相关的遗传变异铺平了道路。</h6><h6 data-line="32">Memento作为群体规模scRNA-seq数据遗传分析的可扩展方法，为识别cis- eqtl提供了更高的统计能力，并引入了绘制vQTLs和cQTLs的能力。这些进展不仅改善了疾病关联的精细定位，而且揭示了遗传变异调节基因表达的新机制。</h6><p><img data-imgfileid="100009745" data-ratio="1.29" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDWn1bwaWWsh8zib7KhGZGI0qzE1BJfaDPs8qWic8cszT60mZjhDtN4smg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDWn1bwaWWsh8zib7KhGZGI0qzE1BJfaDPs8qWic8cszT60mZjhDtN4smg/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="35">结果6、跨细胞类型、个体和疾病状态的普查级差异表达分析</h4><p><img data-imgfileid="100009743" data-ratio="0.8260381593714927" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDIDHVgat8YglW2uUf7Cy7GrcxjnaCNsfnNpxvf9wGrGROYKjia1foPyQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="891" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDIDHVgat8YglW2uUf7Cy7GrcxjnaCNsfnNpxvf9wGrGROYKjia1foPyQ/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="38">最后来看一个示例代码，以细胞类型差异基因分析为例</h4><pre><code><span>import</span> scanpy <span>as</span> sc<br><span>import</span> seaborn <span>as</span> sns<br><span>import</span> pandas <span>as</span> pd<br><span>import</span> matplotlib.pyplot <span>as</span> plt<br><span>import</span> numpy <span>as</span> np<br><span>import</span> scipy.stats <span>as</span> stats<br><span>from</span> pybedtools <span>import</span> BedTool<br><span>import</span> pickle <span>as</span> pkl<br>%matplotlib inline<br><span>import</span> itertools<br>pd.set_option(<span>'display.max_columns'</span>, <span>None</span>)<br>pd.set_option(<span>'display.max_rows'</span>, <span>500</span>)<br><br><span>import</span> sys<br>sys.path.append(<span>'/home/ssm-user/Github/scrna-parameter-estimation/dist/memento-0.0.6-py3.8.egg'</span>)<br>sys.path.append(<span>'/home/ssm-user/Github/misc-seq/miscseq'</span>)<br><span>import</span> encode<br><span>import</span> memento<br><br>data_path = <span>'/data_volume/memento/demux/'</span><br><span># fig_path = '/data/home/Github/scrna-parameter-estimation/figures/fig6/'</span><br><br><span>import</span> matplotlib<br>matplotlib.rcParams[<span>'pdf.fonttype'</span>] = <span>42</span><br>matplotlib.rcParams[<span>'ps.fonttype'</span>] = <span>42</span><br><br><span>import</span> matplotlib.pylab <span>as</span> pylab<br>params = {<span>'legend.fontsize'</span>: <span>'medium'</span>,<br>         <span>'axes.labelsize'</span>: <span>'medium'</span>,<br>         <span>'axes.titlesize'</span>:<span>'medium'</span>,<br>         <span>'figure.titlesize'</span>:<span>'medium'</span>,<br>         <span>'xtick.labelsize'</span>:<span>'small'</span>,<br>         <span>'ytick.labelsize'</span>:<span>'small'</span>}<br>pylab.rcParams.update(params)<br></code></pre><h4 data-line="76">读取数据</h4><pre><code>cts = [<span>'CD4 T cells'</span>,  <span>'CD14+ Monocytes'</span>, <span>'FCGR3A+ Monocytes'</span>, <span>'NK cells'</span>,<span>'CD8 T cells'</span>, <span>'B cells'</span>, <span>'Dendritic cells'</span>, <span>'Megakaryocytes'</span>]<br>label_converter = dict(zip(cts, [<span>'Th'</span>, <span>'cM'</span>, <span>'ncM'</span>, <span>'NK'</span>, <span>'Tc'</span>, <span>'B'</span>, <span>'DC'</span>, <span>'Mega'</span>]))<br><br><span><span>def</span> <span>simplify_name</span><span>(name)</span>:</span><br>    <span>return</span> name.split(<span>'.'</span>)[<span>0</span>]<br><br>adata = sc.read(data_path + <span>'interferon_filtered.h5ad'</span>)<br>adata = adata[(adata.obs.multiplets == <span>'singlet'</span>) &amp; (adata.obs.cell != <span>'nan'</span>), :].copy()<br>adata.X = adata.X.astype(np.int64)<br><br><span># temp_adata = adata.copy()</span><br><span># temp_adata = temp_adata[temp_adata.obs.cell == ct].copy()</span><br>norm_adata = adata.copy()<br>sc.pp.normalize_total(norm_adata, target_sum=<span>1e4</span>)<br><span># sc.pp.log1p(norm_adata)</span><br><br>adata.obs[<span>'ct'</span>] = adata.obs[<span>'cell'</span>].apply(<span>lambda</span> x: label_converter[x])<br>adata.obs[<span>'cell_type'</span>] = (adata.obs[<span>'cell'</span>].astype(str) + <span>' - '</span> + adata.obs[<span>'stim'</span>].astype(str)).astype(<span>'category'</span>)<br><br>sc.pl.tsne(adata, color=<span>'cell_type'</span>)<br></code></pre><p><img data-imgfileid="100009742" data-ratio="0.3632538569424965" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDb4dnVG9ZT7AWQD62ChYbfTKxxvkxgyhnibDm47e1KmOeKuQLBD7h30Q/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="713" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDb4dnVG9ZT7AWQD62ChYbfTKxxvkxgyhnibDm47e1KmOeKuQLBD7h30Q/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="101">read TF</h4><pre><code><span>with</span> open(data_path + <span>'all_highcount_tfs.pkl'</span>, <span>'rb'</span>) <span>as</span> f:<br>    tfs = pkl.load(f)<br><br>tf_df = pd.read_csv(<span>'../ifn_hbec/version3/baseline/human_tf.txt'</span>, sep=<span>'\t'</span>)<br>tf_list = tf_df[<span>'Symbol'</span>].tolist()<br>tf_list += [<span>'CIITA'</span>, <span>'NLRC5'</span>]<br><span>####Select control cells</span><br>cts = [<span>'Th'</span>, <span>'cM'</span>]<br><br>ctrl_adata = adata[<br>    adata.obs[<span>'ct'</span>].isin(cts) &amp; \<br>    adata.obs[<span>'stim'</span>].isin([<span>'ctrl'</span>])].copy().copy()<br><br><span>####Setup memento</span><br>ctrl_adata.obs[<span>'q'</span>] = <span>0.07</span><br><br>ctrl_adata.X = ctrl_adata.X.astype(float)<br><br>memento.setup_memento(ctrl_adata, q_column=<span>'q'</span>, trim_percent=<span>0.1</span>, filter_mean_thresh=<span>0.07</span>)<br></code></pre><h4 data-line="123">Get highly expressed TFs</h4><h4 data-line="124">Test pairs of these highly expressed genes</h4><pre><code>simplified_cts = [<span>'T'</span>, <span>'B'</span>, <span>'M'</span>]<br><span>for</span> ct in [<span>'Th'</span>]:<br>    <span>print</span>(ct)<br>    <br>    labeled_ctrl_adata = ctrl_adata.copy().copy()<br>    labeled_ctrl_adata.obs[<span>'is_ct'</span>] = labeled_ctrl_adata.obs[<span>'ct'</span>].str.contains(ct).astype(int)<br>    <br>    memento.create_groups(labeled_ctrl_adata, label_columns=[<span>'is_ct'</span>, <span>'ind'</span>, <span>'ct'</span>])<br>    <br>    memento.compute_1d_moments(labeled_ctrl_adata, min_perc_group=<span>.7</span>)<br>    <br>    available_tfs = set(tf_list) &amp; set(labeled_ctrl_adata.<span>var</span>.index)<br>    available_genes = set(labeled_ctrl_adata.<span>var</span>.index)<br>    <span>print</span>(len(available_tfs),labeled_ctrl_adata.shape)<br>    memento.compute_2d_moments(labeled_ctrl_adata, <span>list</span>(itertools.product(available_tfs, available_genes)))<br>    <br><span>#     memento.compute_2d_moments(labeled_ctrl_adata, list(itertools.combinations(available_genes, 2)))</span><br>    <br>    <br>    candidates = memento.get_2d_moments(labeled_ctrl_adata, groupby=<span>'is_ct'</span>).query(<span>'is_ct_1 &gt; 0.15 | is_ct_0 &gt; 0.15'</span>)<br>    <span>print</span>(candidates.shape)<br>    memento.compute_2d_moments(labeled_ctrl_adata, <span>list</span>(zip(candidates[<span>'gene_1'</span>], candidates[<span>'gene_2'</span>])))<br>    <br>    memento.ht_2d_moments( <br>        labeled_ctrl_adata, <br>        formula_like=<span>'1 + is_ct + ind'</span>,<br>        treatment_col=<span>'is_ct'</span>, <br>        num_boot=<span>10000</span>, <br>        verbose=<span>1</span>,<br>        num_cpus=<span>94</span>,<br>        resampling=<span>'permutation'</span>,<br>        approx=<span>False</span>)<br>    labeled_ctrl_adata.write(data_path + <span>'coex_markers/Th_vs_cM.h5ad'</span>.format(ct))<br><span>####heatmap</span><br>ht_result_all = []<br><span>for</span> ct in [<span>'Th_vs_cM'</span>]:<br>    result = sc.read(data_path + <span>'coex_markers/{}.h5ad'</span>.format(ct))<br>    ht_result = memento.get_2d_ht_result(result)<br>    ht_result[<span>'corr_fdr'</span>] = memento.util._fdrcorrect(ht_result[<span>'corr_pval'</span>])<br>    ht_result[<span>'ct'</span>] = ct<br>    ht_result_all.append(ht_result)<br>ht_result_all = pd.concat(ht_result_all)<br>ht_result_all[<span>'sign'</span>] = ht_result_all[<span>'corr_coef'</span>] &gt; <span>0</span><br>sig_df = ht_result_all.query(<span>'corr_fdr &lt; 0.1'</span>)<br>pairs = sig_df[[<span>'gene_1'</span>, <span>'gene_2'</span>]].drop_duplicates()<br><br>labeled_ctrl_adata = ctrl_adata.copy().copy()<br>memento.create_groups(labeled_ctrl_adata, label_columns=[<span>'ct'</span>, <span>'ind'</span>])<br>memento.compute_1d_moments(labeled_ctrl_adata, min_perc_group=<span>.7</span>)<br>memento.compute_2d_moments(labeled_ctrl_adata, <span>list</span>(zip(ht_result_all[<span>'gene_1'</span>], ht_result_all[<span>'gene_2'</span>])))<br><br>corr_df = memento.get_2d_moments(labeled_ctrl_adata, groupby=<span>'ct'</span>)<br><br>heatmap = corr_df.query(<span>'gene_1 == "TCF25"'</span>)<span>#[['ct_cM', 'ct_Th']]</span><br>heatmap.index = heatmap[<span>'gene_2'</span>]<br>heatmap = heatmap[[<span>'ct_cM'</span>, <span>'ct_Th'</span>]]<br><br>sns.clustermap(heatmap, cmap=<span>'viridis'</span>)<br></code></pre><p><img data-imgfileid="100009744" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDgKPTwaOb2eXEG5ALhk18jdh8Zorb90ic8A0TVm9icFvU8R6JyfYwtOhw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="712" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDgKPTwaOb2eXEG5ALhk18jdh8Zorb90ic8A0TVm9icFvU8R6JyfYwtOhw/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>subsets = {}<br><span>for</span> tf <span>in</span> ht_result_all.gene_1.drop_duplicates():<br>    <br>    subset = ht_result_all.query(<span>'gene_1 == "{}"'</span>.format(tf)).copy()<br>    subset[<span>'corr_fdr'</span>] = memento.util._fdrcorrect(subset[<span>'corr_pval'</span>])<br>    <br>    <span># Pick some highly correlated genes that don't change</span><br>    subset_1 = subset.query(<span>'corr_pval &gt; 0.9'</span>).head(<span>25</span>)<br>    subset_1[<span>'type'</span>] = <span>'both'</span><br>    subset_2 = subset.query(<span>'corr_fdr &lt; 0.1 &amp; corr_coef &gt; 0'</span>).sort_values(<span>'corr_pval'</span>).head(<span>25</span>)<br>    subset_2[<span>'type'</span>] = <span>'T'</span><br>    subset_3 = subset.query(<span>'corr_fdr &lt; 0.1 &amp; corr_coef &lt; 0'</span>).sort_values(<span>'corr_pval'</span>).head(<span>25</span>)<br>    subset_3[<span>'type'</span>] = <span>'M'</span><br>    <br>    subsets[tf] = pd.concat([subset_2, subset_1, subset_3])<br><br>heatmap = subsets[<span>'SUB1'</span>].merge(corr_df)<br>heatmap.index = heatmap[<span>'gene_2'</span>]<br>heatmap = heatmap[[<span>'ct_cM'</span>, <span>'ct_Th'</span>]]<br><br>tf = <span>'CEBPB'</span><br>heatmap = subsets[tf].merge(corr_df)<br>heatmap.index = heatmap[<span>'gene_2'</span>]<br>heatmap = heatmap[[<span>'ct_cM'</span>, <span>'ct_Th'</span>]]<br><br>plt.figure(figsize=(<span>2</span>,<span>6</span>))<br><span>import</span> matplotlib.pylab <span>as</span> pylab<br>params = {<span>'legend.fontsize'</span>: <span>'medium'</span>,<br>         <span>'axes.labelsize'</span>: <span>'medium'</span>,<br>         <span>'axes.titlesize'</span>:<span>'medium'</span>,<br>         <span>'figure.titlesize'</span>:<span>'medium'</span>,<br>         <span>'xtick.labelsize'</span>:<span>'small'</span>,<br>         <span>'ytick.labelsize'</span>:<span>'xx-small'</span>}<br>pylab.rcParams.update(params)<br>sns.heatmap(heatmap, cmap=<span>'viridis'</span>, yticklabels=<span>False</span>)<br>plt.ylabel(<span>'Genes (correlation)'</span>); plt.title(tf)<br>plt.savefig(<span>'{}_heatmap.png'</span>.format(tf), dpi=<span>800</span>, bbox_inches=<span>'tight'</span>)<br></code></pre><p><img data-imgfileid="100009741" data-ratio="2.3870967741935485" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDD7Agb7kJBfH7WqvegXOK7QvVXEvU7eNWTLIFjCqfPTmztVbvKmJR0A/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="155" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDD7Agb7kJBfH7WqvegXOK7QvVXEvU7eNWTLIFjCqfPTmztVbvKmJR0A/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>ct = <span>'Th_tf'</span><br>result = sc.read(data_path + <span>'coex_markers/{}.h5ad'</span>.format(ct))<br>ht_result = memento.get_2d_ht_result(result)<br>ht_result[<span>'corr_fdr'</span>] = memento.util._fdrcorrect(ht_result[<span>'corr_pval'</span>])<br><br>moments = memento.get_2d_moments(result, groupby=<span>'is_ct'</span>)<br>moments_1d = memento.get_1d_moments(result, groupby=<span>'ct'</span>)<br>merged = moments.merge(ht_result, on=[<span>'gene_1'</span>, <span>'gene_2'</span>])<br><br>merged.query(<span>'corr_fdr &lt; 0.1 &amp; is_ct_0 &lt; 0.2'</span>).sort_values(<span>'is_ct_1'</span>)<br></code></pre><p><img data-imgfileid="100009750" data-ratio="0.672992700729927" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDic2OKdicjua3dx4V5uHP1XMhVThW8nqbNibWcjJ6mMV8pJYOHhQNXKZjg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="685" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDic2OKdicjua3dx4V5uHP1XMhVThW8nqbNibWcjJ6mMV8pJYOHhQNXKZjg/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>merged[<span>'sign'</span>] = merged[<span>'corr_coef'</span>]&gt;0<br><br>merged.query(<span>'corr_fdr &lt; 0.1'</span>).groupby(<span>'gene_1'</span>).agg({<span>'sign'</span>:[<span>'count'</span>, <span>'mean'</span>]})<br></code></pre><p><img data-imgfileid="100009747" data-ratio="2.878504672897196" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDGnRXjHAQoM6d6txrQle8Sibk413gunJMJsYGVKns5YXBQwTXn7omibkA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="214" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDGnRXjHAQoM6d6txrQle8Sibk413gunJMJsYGVKns5YXBQwTXn7omibkA/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>moments_1d[0].query(<span>'gene == "IRF1"'</span>)<br></code></pre><p><img data-imgfileid="100009746" data-ratio="0.2679245283018868" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDxVM9SUPSUe6EiaoxKNeRdkOIWH3PrTDpoia5LfaRia10GibnUibyfhNjunA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="265" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDxVM9SUPSUe6EiaoxKNeRdkOIWH3PrTDpoia5LfaRia10GibnUibyfhNjunA/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>moments.query(<span>'gene_2 == "ATF4"'</span>)<br><br>merged[<span>'sign'</span>] = merged[<span>'corr_coef'</span>] &gt; 0<br>hit_tfs = merged.query(<span>'corr_fdr &lt; 0.1'</span>).gene_1.value_counts()<br>hit_tfs = hit_tfs[hit_tfs &gt; 25].index.tolist()<br><br><span>print</span>(merged.query(<span>'corr_fdr &lt; 0.1 &amp; gene_1 in @hit_tfs'</span>).groupby(<span>'gene_1'</span>).sign.mean().sort_values())<br>gene_1<br>YBX1       0.000000<br>HMGB1      0.009174<br>ZFP36L2    0.027027<br>LYAR       0.040000<br>BCLAF1     0.507463<br>SUB1       0.520833<br>ZNF24      0.590909<br>CNBP       0.634921<br>LRRFIP1    0.666667<br>GPBP1      0.682927<br>ELF1       0.758621<br>ZNF394     0.769231<br>SFPQ       0.894737<br>NFE2L2     0.909091<br>CREM       0.938776<br>HBP1       0.950820<br>DNAJC2     0.966292<br>KLF6       0.973684<br>ATF4       0.975155<br>JUNB       0.987013<br>SON        0.991071<br>JUN        1.000000<br>IRF1       1.000000<br>Name: sign, dtype: float64<br></code></pre><pre><code>tf = <span>'GPBP1'</span><br>heatmap = merged.query(<span>'gene_1 == "{}"'</span>.format(tf))<br>sns.clustermap(heatmap[[<span>'is_ct_0'</span>, <span>'is_ct_1'</span>]], cmap=<span>'viridis'</span>)<br></code></pre><p><img data-imgfileid="100009749" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDNviafHX0r7G2NvhOd9ZVpBa5fv7VnbiaVGibmmUTXthTYOZNRvxSyt7rg/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="712" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDNviafHX0r7G2NvhOd9ZVpBa5fv7VnbiaVGibmmUTXthTYOZNRvxSyt7rg/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>merged<br><br>heatmap = pd.DataFrame()<br><br>ct = <span>'Th'</span><br>result = sc.read(data_path + <span>'coex_markers/{}.h5ad'</span>.format(ct))<br>ht_result = memento.get_2d_ht_result(result)<br>ht_result[<span>'corr_fdr'</span>] = memento.util._fdrcorrect(ht_result[<span>'corr_pval'</span>])<br><br>moments = memento.get_2d_moments(result, groupby=<span>'is_ct'</span>)<br>merged = moments.merge(ht_result, on=[<span>'gene_1'</span>, <span>'gene_2'</span>])<br><br>merged.query(<span>'corr_fdr &lt; 0.1 &amp; (is_ct_0 &lt; 0.1 | is_ct_1 &lt; 0.1)'</span>)<br></code></pre><p><img data-imgfileid="100009748" data-ratio="0.40242057488653554" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDtbOAqARfya3XnTfvW1doLjqG6qphfmDDXqUvngbFHyP84iaBHULibHKQ/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="661" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDtbOAqARfya3XnTfvW1doLjqG6qphfmDDXqUvngbFHyP84iaBHULibHKQ/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code><span><span>def</span> <span>plot_microscopy</span><span>(X, c1, c2, s=<span>5</span>, q_up=<span>.95</span>, q_doawn=<span>0.1</span>, min_val=<span>0.1</span>, alpha=<span>0.1</span>, xlim=None, ylim=None, remove_axis=True)</span>:</span><br>    <br>    N = X.shape[<span>0</span>]<br>    <br>    c1 = np.clip(c1, a_min=np.quantile(c1, q_down), a_max=np.quantile(c1, q_up))<br>    c2 = np.clip(c2, a_min=np.quantile(c2, q_down), a_max=np.quantile(c2, q_up))<br><br>    c1 = (c1 - c1.min())/(c1.max()-c1.min())<br>    c2 = (c2 - c2.min())/(c2.max()-c2.min())<br>    <br>    c1 = np.clip(c1, a_min=min_val, a_max=<span>1</span>)<br>    c2 = np.clip(c2, a_min=min_val, a_max=<span>1</span>)<br>    <br>    plt.subplot(<span>1</span>, <span>3</span>, <span>1</span>); plt.scatter(X[:, <span>0</span>], X[:, <span>1</span>], c=np.vstack([c1, np.zeros(N), np.zeros(N)]).T, s=s, alpha=alpha)<br>    plt.gca().set_facecolor((<span>0</span>, <span>0</span>, <span>0</span>))<br>    <span>if</span> remove_axis:<br>        plt.xticks([]); plt.yticks([])<br>    <span>if</span> xlim <span>is</span> <span>not</span> <span>None</span> <span>and</span> ylim <span>is</span> <span>not</span> <span>None</span>:<br>        plt.xlim(xlim); plt.ylim(ylim);<br>        <br>    plt.subplot(<span>1</span>, <span>3</span>, <span>2</span>); plt.scatter(X[:, <span>0</span>], X[:, <span>1</span>], c=np.vstack([np.zeros(N), c2, np.zeros(N)]).T, s=s, alpha=alpha)<br>    plt.gca().set_facecolor((<span>0</span>, <span>0</span>, <span>0</span>))<br>    <span>if</span> remove_axis:<br>        plt.xticks([]); plt.yticks([])<br>    <span>if</span> xlim <span>is</span> <span>not</span> <span>None</span> <span>and</span> ylim <span>is</span> <span>not</span> <span>None</span>:<br>        plt.xlim(xlim); plt.ylim(ylim);<br>        <br>    plt.subplot(<span>1</span>, <span>3</span>, <span>3</span>); plt.scatter(X[:, <span>0</span>], X[:, <span>1</span>], c=np.vstack([c1, c2, np.zeros(N)]).T, s=s, alpha=alpha)<br>    plt.gca().set_facecolor((<span>0</span>, <span>0</span>, <span>0</span>))<br>    <span>if</span> xlim <span>is</span> <span>not</span> <span>None</span> <span>and</span> ylim <span>is</span> <span>not</span> <span>None</span>:<br>        plt.xlim(xlim); plt.ylim(ylim);<br>    <span>if</span> remove_axis:<br>        plt.xticks([]); plt.yticks([])<br>    <br><span><span>def</span> <span>get_ct_ind_corr</span><span>(adata, gene_1, gene_2)</span>:</span><br>    <br>    adata_temp = adata.copy()<br>    scmemo.create_groups(adata_temp, label_columns=[<span>'cell'</span>, <span>'stim'</span>,<span>'ind'</span>], inplace=<span>True</span>)<br>    scmemo.compute_1d_moments(<br>        adata_temp, inplace=<span>True</span>, filter_genes=<span>False</span>, <br>        residual_var=<span>True</span>, use_n_umi=<span>False</span>, filter_mean_thresh=<span>0.125</span>, <br>        min_perc_group=<span>0.99</span>)<br>    scmemo.compute_2d_moments(adata_temp, [gene_1], [gene_2])<br>    df_list = []<br>    <span>for</span> group <span>in</span> adata_temp.uns[<span>'scmemo'</span>][<span>'groups'</span>]:<br>        _, ct, stim, ind = group.split(<span>'^'</span>)<br>        <span>if</span> ct <span>not</span> <span>in</span> cts:<br>            <span>continue</span><br>        df_list.append((label_converter[ct], stim,ind,adata_temp.uns[<span>'scmemo'</span>][<span>'2d_moments'</span>][group][<span>'corr'</span>][<span>0</span>][<span>0</span>]))<br>    df = pd.DataFrame(df_list, columns=[<span>'ct'</span>, <span>'stim'</span>,<span>'ind'</span>, <span>'corr'</span>]).sort_values(<span>'ct'</span>)<br>    df[<span>'corr'</span>] = df[<span>'corr'</span>].apply(<span>lambda</span> x: np.nan <span>if</span> abs(x) &gt; <span>1</span> <span>else</span> x)<br>    <br>    <span>return</span> df<br>    <br><br>imp.reload(hypothesis_test)<br>imp.reload(bootstrap)<br>imp.reload(scmemo)<br>imp.reload(estimator)<br><br>adata_dict = {}<br><span>for</span> ct <span>in</span> cts:<br>    print(<span>'Processing'</span>, ct)<br>    adata_ct =  adata[adata.obs.stim == <span>'ctrl'</span>].copy()<br><span>#     adata_ct.obs['cell'] = np.random.choice(adata_ct.obs['cell'], adata_ct.shape[0], replace=False)</span><br>    adata_ct.obs[<span>'ct'</span>] = adata_ct.obs[<span>'cell'</span>].apply( <span>lambda</span> x: int(x == ct))<span># adata_ct.obs['stim'] = np.random.choice(adata_ct.obs['stim'], adata_ct.shape[0])</span><br>    scmemo.create_groups(adata_ct, label_columns=[<span>'ct'</span>, <span>'cell'</span> ,<span>'ind'</span>], inplace=<span>True</span>)<br><br>    scmemo.compute_1d_moments(<br>        adata_ct, inplace=<span>True</span>, filter_genes=<span>True</span>, <br>        residual_var=<span>True</span>, use_n_umi=<span>False</span>, filter_mean_thresh=<span>0.25</span>, <br>        min_perc_group=<span>0.99</span>)<br>    print(<span>'Size of data'</span>, adata_ct.shape)<br><br>    available_tfs = list(set(tfs) &amp; set(adata_ct.var.index.tolist()))<br>    target_genes = adata_ct.var.index.tolist()<br>    target_genes = [gene <span>for</span> gene <span>in</span> target_genes <span>if</span> gene[:<span>2</span>] != <span>'RP'</span> <span>and</span> gene[:<span>3</span>] != <span>'HLA'</span>]<br>    <span># target_genes = np.random.choice(target_genes, 50)</span><br>    print(<span>'TF list length'</span>, len(available_tfs))<br>    print(<span>'target gene length'</span>, len(target_genes))<br>    scmemo.compute_2d_moments(adata_ct, target_genes, target_genes)<br>    <br>    scmemo.ht_2d_moments(adata_ct, formula_like=<span>'1 + ct'</span>, cov_column=<span>'ct'</span>, num_boot=<span>5000</span>, num_cpus=<span>6</span>)<br>    adata_ct.write(data_path + <span>'result_2d/ct_specific_{}_05292020.h5ad'</span>.format(label_converter[ct]))<br>    <br>    adata_dict[ct] = adata_ct.copy()<br><br>adata_dict = {}<br><span>for</span> ct <span>in</span> cts:<br>    adata_dict[ct] = sc.read(data_path + <span>'result_2d/ct_specific_{}_05292020.h5ad'</span>.format(label_converter[ct]))<br><br><span><span>def</span> <span>get_2d_ht_result</span><span>(adata)</span>:</span><br>    <br>    result_df = pd.DataFrame(<br>        itertools.product(<br>            adata.uns[<span>'scmemo'</span>][<span>'2d_moments'</span>][<span>'gene_1'</span>],<br>            adata.uns[<span>'scmemo'</span>][<span>'2d_moments'</span>][<span>'gene_2'</span>]),<br>        columns=[<span>'gene_1'</span>, <span>'gene_2'</span>])<br>    result_df[<span>'corr_coef'</span>] = adata.uns[<span>'scmemo'</span>][<span>'2d_ht'</span>][<span>'corr_coef'</span>].ravel()<br>    result_df[<span>'corr_pval'</span>] = adata.uns[<span>'scmemo'</span>][<span>'2d_ht'</span>][<span>'corr_asl'</span>].ravel()<br>    result_df[<span>'corr_fdr'</span>] = util._fdrcorrect(result_df[<span>'corr_pval'</span>].values)<br>    <br>    <span>return</span> result_df<br><br><span>for</span> ct <span>in</span> cts:<br>    print(ct)<br>    print(get_2d_ht_result(adata_dict[ct]).query(<span>'corr_fdr &lt; 0.15'</span>).shape)<br><br>df = scmemo.get_2d_ht_result(adata_dict[<span>'CD4 T cells'</span>])<br>df.query(<span>'corr_fdr &lt; 0.2'</span>).sort_values(<span>'corr_coef'</span>)<span>#.head(20)</span><br><br><span># EEF1A1    EEF1D</span><br><br>plt.figure(figsize=(<span>2</span>, <span>2</span>))<br>gene_1, gene_2 = <span>'FTH1'</span>, <span>'TMSB4X'</span><br>plot_df = get_ct_ind_corr(adata_ct, gene_1, gene_2).query(<span>'ct in ["B","Th","cM","ncM"]'</span>)<br>sns.boxplot(x=<span>'ct'</span>, y=<span>'corr'</span>,<br>    data=plot_df, <br>    palette=<span>'Set2'</span>)<br>sns.stripplot(x=<span>'ct'</span>, y=<span>'corr'</span>,<br>    data=plot_df, <br>    palette=<span>'Set2'</span>, linewidth=<span>2</span>)<br>plt.ylabel(<span>'FTH1 and TMSB4X\ncorrelation'</span>)<br>plt.xlabel(<span>'cell type'</span>)<br><span># plt.title('Correlation\nbetween\nFTH1 and TMSB4X')</span><br>plt.savefig(fig_path + <span>'fth1_tmsb4x.pdf'</span>, bbox_inches=<span>'tight'</span>)<br></code></pre><p><img data-imgfileid="100009754" data-ratio="0.8571428571428571" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDiaU7zd3rvVxP3Or0tmPdL4PCmkefBt439iadbibFicDL3kqrcxXicZqXu1w/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="182" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDiaU7zd3rvVxP3Or0tmPdL4PCmkefBt439iadbibFicDL3kqrcxXicZqXu1w/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>norm_adata = adata.copy()<br>sc.pp.normalize_total(norm_adata, target_sum=<span>1e4</span>)<br><span># sc.pp.log1p(norm_adata)</span><br><br>plt.figure(figsize=(<span>15</span>, <span>5</span>))<br>plot_ct = <span>'CD14+ Monocytes'</span><br>dat = norm_adata[(norm_adata.obs.stim == <span>'ctrl'</span>)]<br>plot_microscopy(<br>    X=dat.obsm[<span>'X_tsne'</span>],<br>    c1=dat[:,gene_1].X.todense().A1,<br>    c2=dat[:,gene_2].X.todense().A1,<br>    s=<span>1</span>,<br>    q_down=<span>0.0</span>,<br>    q_up=<span>0.9</span>, <br>    alpha=<span>0.5</span>,<br>    remove_axis=<span>True</span>)<br></code></pre><p><img data-imgfileid="100009755" data-ratio="0.3414918414918415" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrD7zriarEw9QZQs0ofcUtFhiaLx1PF8pyM1zsuSnn1IjRlAu3nOybRSz7w/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="858" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrD7zriarEw9QZQs0ofcUtFhiaLx1PF8pyM1zsuSnn1IjRlAu3nOybRSz7w/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>plt.figure(figsize=(<span>5</span>, <span>1</span>))<br>plot_ct = <span>'CD14+ Monocytes'</span><br>dat = norm_adata[(norm_adata.obs.stim == <span>'ctrl'</span>) &amp; (norm_adata.obs.cell == plot_ct)]<br>plot_microscopy(<br>    X=dat.obsm[<span>'X_tsne'</span>],<br>    c1=dat[:,gene_1].X.todense().A1,<br>    c2=dat[:,gene_2].X.todense().A1,<br>    s=<span>1</span>,<br>    q_down=<span>0.5</span>,<br>    q_up=<span>0.9</span>, <br>    alpha=<span>0.5</span>,<br>    remove_axis=<span>True</span>,<br>    xlim=(<span>-40</span>, <span>-5</span>),ylim=(<span>2</span>, <span>37</span>))<br>plt.savefig(fig_path + <span>'fth1_tmsb4x_cd14.pdf'</span>, bbox_inches=<span>'tight'</span>)<br></code></pre><p><img data-imgfileid="100009752" data-ratio="0.25" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDZp0Epia4L9bicZO11O5Te6B8CPuXIxtpYvwTQNUOcF6MhMy43kESaQTA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="300" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDZp0Epia4L9bicZO11O5Te6B8CPuXIxtpYvwTQNUOcF6MhMy43kESaQTA/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>plt.figure(figsize=(<span>5</span>, <span>1</span>))<br>plot_ct = <span>'CD4 T cells'</span><br>dat = norm_adata[(norm_adata.obs.stim == <span>'ctrl'</span>) &amp; (norm_adata.obs.cell == plot_ct)]<br>plot_microscopy(<br>    X=dat.obsm[<span>'X_tsne'</span>],<br>    c1=dat[:,gene_1].X.todense().A1,<br>    c2=dat[:,gene_2].X.todense().A1,<br>    s=<span>1</span>,<br>    q_down=<span>0.5</span>,<br>    q_up=<span>0.9</span>, <br>    alpha=<span>0.5</span>,<br>    remove_axis=<span>True</span>,<br>    xlim=(<span>-25</span>, <span>25</span>),ylim=(<span>-40</span>, <span>0</span>))<br>plt.savefig(fig_path + <span>'fth1_tmsb4x_cd4.pdf'</span>, bbox_inches=<span>'tight'</span>)<br></code></pre><p><img data-imgfileid="100009753" data-ratio="0.25" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDH1uMOQx8sibs1ZIz38y1kta9goDI0BYdJJS55YibZENcaSUI0g1ibbPaA/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="300" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDH1uMOQx8sibs1ZIz38y1kta9goDI0BYdJJS55YibZENcaSUI0g1ibbPaA/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="492">Scratch</h4><pre><code>norm_adata = adata.copy()<br>sc.pp.normalize_total(norm_adata, target_sum=1e4)<br>sc.pp.log1p(norm_adata)<br></code></pre><pre><code>sc.pl.tsne(norm_adata, color=[<span>'PPBP'</span>, <span>'PF4'</span>])<br></code></pre><p><img data-imgfileid="100009756" data-ratio="0.3279503105590062" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDTicrsHc6xcLjeThwpUichibj8tMc5d9ibapRxs95D5yPIAoJCTMUnP0bdw/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="805" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDTicrsHc6xcLjeThwpUichibj8tMc5d9ibapRxs95D5yPIAoJCTMUnP0bdw/640?wx_fmt=other&amp;from=appmsg"><br></p><pre><code>sc.pl.tsne(norm_adata, color=[<span>'FTH1'</span>, <span>'TMSB4X'</span>, <span>'cell'</span>])<br></code></pre><p><img data-imgfileid="100009757" data-ratio="0.19916666666666666" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDEE6GCrTsCFOUTwmOJ1JwLuUBldTkMmbRQRmrkperiasC5wcM34bv4ug/640?wx_fmt=other&amp;from=appmsg" data-type="other" data-w="1200" src="https://mmbiz.qpic.cn/mmbiz_jpg/srXAibe95MmkFelfIzcgRQ4uiaLUAN0WrDEE6GCrTsCFOUTwmOJ1JwLuUBldTkMmbRQRmrkperiasC5wcM34bv4ug/640?wx_fmt=other&amp;from=appmsg"><br></p><h4 data-line="510">全部教程在https://github.com/yelabucsf/scrna-parameter-estimation</h4><h4 data-line="512">生活很好，有你更好</h4><section><mp-common-cpsad data-pluginname="mpcps" data-templateid="list" data-traceid="1243d34a-b144-4eb6-9bb4-02466ce20792" data-goodssouce="1" data-pid="100_623672075180" data-appuin="3860655629" data-cpsversion="v112"></mp-common-cpsad></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/DrSeSNR02J4MAH6pi0g9Rg",target="_blank" rel="noopener noreferrer">原文链接</a>
