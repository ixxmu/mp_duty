---
title: "蛋白酶作用模式难理解？proteasy包，让复杂的酶切数据变简单！"
date: 2024-10-22T13:09:51Z
draft: ["false"]
tags: [
  "fetched",
  "R语言学徒"
]
categories: ["Acdemic"]
---
蛋白酶作用模式难理解？proteasy包，让复杂的酶切数据变简单！ by R语言学徒
------
<div><p><img data-galleryid="" data-imgfileid="100007793" data-ratio="0.2222222222222222" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUckerRictfTicSHoNskkHZjoa7nSeGI9ticg8pf3FOEkewHQTNLbNhdKK36fxBPpNLzVm0W8LjZYKEg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEUckerRictfTicSHoNskkHZjoa7nSeGI9ticg8pf3FOEkewHQTNLbNhdKK36fxBPpNLzVm0W8LjZYKEg/640?wx_fmt=png&amp;from=appmsg"></p><section><span>嘿科研小伙伴们！你是否曾在研究蛋白质水解过程中感到迷茫？是否在寻找一种方法来分析那些复杂的酶切数据？别担心，小师妹今天就要给大家带来一个激动人心的生物信息学工具——proteasy包。</span></section><section><span>在这个领域里，</span><span>蛋白酶（</span><span>protease</span><span>）</span><span>的切割作用对许多重要的生理过程都有着深远的影响，而proteasy包正是为了帮助我们更好地理解和分析这些过程而设计的。它能够让我们轻松地从MEROPS数据库中提取信息，识别特定底物的潜在酶切位点，并对这些位点进行详细的分析。</span></section><section><span>现在，就让我们一起来学习如何使用proteasy包，让它成为我们研究过程中的得力助手。</span><span>注意哦，</span><span>这个R包操作占用内存比较大，建议使用服务器哦，欢迎联系</span><span>小师妹</span><span>租赁性价比高的服务器~</span></section><section><span>准备好了吗？让我们开始这段精彩的探索之旅，一起揭开蛋白质酶切的神秘面纱！</span><span>如果有任何疑问，小师妹随时在这里为你解答哦！</span></section><p><img data-galleryid="" data-imgfileid="100010620" data-ratio="0.40384615384615385" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVDagCIeNyZsic6S7lx4rzUTQHKrupNGC9txh0bNkgM0nGD9e0HiapUMsTs1CRibaia5DMRSkMPrKpfOw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="572" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEVDagCIeNyZsic6S7lx4rzUTQHKrupNGC9txh0bNkgM0nGD9e0HiapUMsTs1CRibaia5DMRSkMPrKpfOw/640?wx_fmt=png&amp;from=appmsg"></p><section><span></span></section><section><span>首先，让我们安装</span><span>和加载</span><span>proteasy包：</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="php"><code><span><span>if</span> (!requireNamespace(<span>"BiocManager"</span>, quietly = <span>TRUE</span>))</span></code><code><span>   install.packages(<span>"BiocManager"</span>)</span></code><code><span>BiocManager::install(<span>"proteasy"</span>)</span></code><code><span>library(<span>"proteasy"</span>)</span></code></pre></section><section><span>一、使用方法</span><span></span></section><section><span><span> </span></span><span>1. </span><span>根据底物查找蛋白酶</span></section><section><span>想要快速识别可能切割特定底物的蛋白酶吗？小师妹来教你用`searchSubstrate`函数。这个函数能帮我们从MEROPS数据库中检索记录的蛋白酶。</span>    <page></page></section><section><span>简单两步，轻松查找：</span></section><section><span>（1） 获取蛋白酶列表</span></section><section><span>设置`summarize<span> </span>= TRUE`，函数会返回一个列表，包含所有已知能切割特定底物的、经过审核的蛋白酶。</span></section><section><span><span></span></span></section><section><ul><li></ul><pre data-lang="objectivec"><code><span>searchSubstrate(protein = <span>"P01042"</span>, summarize = <span>TRUE</span>)</span></code></pre></section><section><span><img data-imgfileid="100011075" data-ratio="0.05632411067193676" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4kazK7KIyFWrpWv1ibKaRWNJToVwKbBicryuSSwnL6PyW7Q4bsWtIZFeg/640?wx_fmt=png" data-type="png" data-w="1012" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4kazK7KIyFWrpWv1ibKaRWNJToVwKbBicryuSSwnL6PyW7Q4bsWtIZFeg/640?wx_fmt=png"></span><span></span></section><section><span>（2） 获取详细切割事件</span></section><section><span>设置`summarize</span><span> </span><span>= FALSE`，函数会返回一个详细的数据表，展示每个切割事件的信息。</span></section><section><ul><li></ul><pre data-lang="objectivec"><code><span>searchSubstrate(protein = <span>"P01042"</span>, summarize = <span>FALSE</span>) |&gt; head()</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011077" data-ratio="0.25633528265107214" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4eiaES5ooXyqEtGyfr4mcABjzEFtBZ53Fs4aXvWH7KaQiaIeHJWWxdIlQ/640?wx_fmt=png" data-type="png" data-w="1026" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4eiaES5ooXyqEtGyfr4mcABjzEFtBZ53Fs4aXvWH7KaQiaIeHJWWxdIlQ/640?wx_fmt=png"></span><span></span></section><section><span>处理多个底物？没问题！</span></section><section><span>没错，</span><span>这个函数还能同时处理多个底物，帮你一次性获取所有相关蛋白酶的信息。</span></section><section><ul><li></ul><pre data-lang="objectivec"><code><span>searchSubstrate(protein = c(<span>"P01042"</span>, <span>"P02461"</span>), summarize = <span>FALSE</span>) |&gt; tail()</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011076" data-ratio="0.2502406159769009" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4rrD1eiaj9fgutYJibFZhmsUia3l4nbP8YruVltNcNSHuNibHOg75uibEWBw/640?wx_fmt=png" data-type="png" data-w="1039" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4rrD1eiaj9fgutYJibFZhmsUia3l4nbP8YruVltNcNSHuNibHOg75uibEWBw/640?wx_fmt=png"></span><span></span></section><section><span>通过这种方式，我们不仅能够了解哪些蛋白酶可能参与了特定底物的切割，还能深入了解每一次切割事件的具体细节。这对于研究蛋白酶的功能和它们在生物体内的调控机制来说，是非常有价值的信息。</span></section><section><span>2.<span></span></span><span>根据蛋白酶查找底物</span></section><section><span>如果你想知道某个特定的蛋白酶能够切割哪些底物，`searchProtease`函数就是为你准备的。这个函数能够帮你找出特定蛋白酶的所有已知切割底物。下面，我们将以基质金属蛋白酶-12（MMP-12，P39900）为例，演示如何使用这个函数。</span></section><section><span>只需设置`summarize = TRUE`，函数就会返回一个向量，列出MMP-12能够切割的所有底物。</span></section><section><ul><li></ul><pre data-lang="objectivec"><code><span>searchProtease(protein = <span>"P39900"</span>, summarize = <span>TRUE</span>)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011079" data-ratio="0.06352459016393443" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4SibGoPZ1TqoUseIrP2AWv2oOVAaej8qhXTP8uthIyp41o5FHwNZwmCQ/640?wx_fmt=png" data-type="png" data-w="976" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4SibGoPZ1TqoUseIrP2AWv2oOVAaej8qhXTP8uthIyp41o5FHwNZwmCQ/640?wx_fmt=png"></span><span></span></section><section><span>如果你想要更详细的信息，比如每次切割的具体位置和类型，只需将`summarize`设置为`FALSE`，函数就会返回一个包含这些详细信息的数据表。</span></section><section><ul><li></ul><pre data-lang="objectivec"><code><span>searchProtease(protein = <span>"P39900"</span>, summarize = <span>FALSE</span>) |&gt; head()</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011078" data-ratio="0.25588235294117645" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE429s9g57a8hLpZps8KNJK80x9hp0GS3VbC13JwoOWLAMygHiczrU17Eg/640?wx_fmt=png" data-type="png" data-w="1020" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE429s9g57a8hLpZps8KNJK80x9hp0GS3VbC13JwoOWLAMygHiczrU17Eg/640?wx_fmt=png"></span><span></span></section><section><span>通过这个功能，我们可以深入了解特定蛋白酶如何影响各种底物，这对于研究蛋白酶的功能和它们在疾病中的作用尤为重要。小师妹提醒你，这个工具非常实用，无论你是研究特定蛋白酶还是探索蛋白酶的潜在底物，都能派上大用场哦</span></section><section><span>3.<span></span></span><span>为切割的肽段寻找可能的蛋白酶</span></section><section><span></span></section><section><span>当你手头有一堆切割后的肽段，而你想知道哪些蛋白酶可能是“幕后黑手”时，`findProtease`函数就能大显身手了。这个函数会自动将肽段序列映射到完整的蛋白序列上，并获取肽段的起始和终止位置。然后，它会在MEROPS数据库中搜索这些位置，返回所有匹配的蛋白酶。</span></section><section><page></page></section><section><span>步骤一：准备数据</span></section><section><span>首先，</span><span>我们</span><span>需要准备一个包含UniProt ID和相应肽段序列的向量。</span></section><section><span></span></section><section><ul><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>protein</span> &lt;- c(<span>"P02671"</span>, <span>"P02671"</span>, <span>"P68871"</span>, <span>"P01011"</span>, <span>"P68133"</span>, <span>"P02461"</span>, <span>"P0DJI8"</span>, <span>"P0DJI8"</span>, <span>"P0DJI8"</span>)</span></code><code><span>peptide &lt;- c(<span>"FEEVSGNVSPGTR"</span>, <span>"FVSETESR"</span>, <span>"LLVVYPW"</span>, <span>"ITLLSAL"</span>, <span>"DSYVGDEAQS"</span>, <span>"AGGFAPYYG"</span>, <span>"FFSFLGEAFDGAR"</span>, <span>"EANYIGSDKY"</span>, <span>"GGVWAAEAISDAR"</span>)</span></code><code><span><span># 或者直接加载小师妹准备的数据哦~</span></span></code><code><span><span>#protein1 &lt;- read.csv("protein.csv", header = TRUE, stringsAsFactors = FALSE)[,1]</span></span></code><code><span><span>#peptide1 &lt;- read.csv("peptide.csv", header = TRUE, stringsAsFactors = FALSE)[,1]</span></span></code></pre></section><section><span>步骤二：自动映射和搜索</span></section><section><span>使用`findProtease`函数，如果未指定肽段的起始和终止位置，函数将自动通过匹配完整蛋白序列来确定这些值。</span></section><section><ul><li></ul><pre data-lang="xml"><code><span>res <span>&lt;<span>-</span> <span>findProtease</span>(<span>protein</span> = <span>protein,</span> <span>peptide</span> = <span>peptide,</span> <span>organism</span> = <span>"Homo sapiens"</span>)</span></span></code></pre></section><section><span>步骤三：查看结果</span></section><section><span>我们</span><span>可以用三种方式查看结果：</span></section><section><span></span></section><section><ul><li></ul><pre data-lang="bash"><code><span>substrates(res) |&gt; head() <span># 显示输入序列的数据</span></span></code></pre></section><section><span></span><page></page></section><section><span><img data-imgfileid="100011084" data-ratio="0.5734200743494424" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4pvqNVK96TJiapqH8XvRdcoULuqZNnLThMr9FEMxBRicUM518448iamU1w/640?wx_fmt=png" data-type="png" data-w="1076" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4pvqNVK96TJiapqH8XvRdcoULuqZNnLThMr9FEMxBRicUM518448iamU1w/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li></ul><pre data-lang="bash"><code><span>proteases(res) |&gt; head() <span># 显示可能切割该蛋白的已知蛋白酶</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011080" data-ratio="0.3751891074130106" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4SRgmSa4DGjc6etuibp9kQF9icdE2PV1v3xsIwyJdibXiavkhb8licichDqmw/640?wx_fmt=png" data-type="png" data-w="661" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4SRgmSa4DGjc6etuibp9kQF9icdE2PV1v3xsIwyJdibXiavkhb8licichDqmw/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li></ul><pre data-lang="bash"><code><span>cleavages(res) |&gt; head() <span># 显示相关的蛋白水解事件的详细信息</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011083" data-ratio="0.15011547344110854" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4F2Zsscgdl6bhvvo8iaMwiavlAvkM0BAG16aMLxD7o6e203OqsbufHpvg/640?wx_fmt=png" data-type="png" data-w="866" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4F2Zsscgdl6bhvvo8iaMwiavlAvkM0BAG16aMLxD7o6e203OqsbufHpvg/640?wx_fmt=png"></span></section><section><span>除了上面三个步骤，我们还可以进行一些</span><span>额外分析：</span></section><section><span></span></section><section><ul><li><li><li></ul><pre data-lang="ruby"><code><span><span># 了解经过审核的蛋白酶在N端和C端的切割事件比例：</span></span></code><code><span>cl &lt;- cleavages(res)[<span>`Protease status`</span> == <span>"reviewed"</span>]</span></code><code><span>cl$`Cleaved terminus<span>` |&gt; table() |&gt; prop.table() |&gt; round(digits = 2)</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011081" data-ratio="0.109375" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4bHHuzSCSdILrtSzZSACEibdvGtG0DPGibzJYfBiaef9IJQPoCTDytdLpQ/640?wx_fmt=png" data-type="png" data-w="512" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4bHHuzSCSdILrtSzZSACEibdvGtG0DPGibzJYfBiaef9IJQPoCTDytdLpQ/640?wx_fmt=png"></span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="shell"><code><span><span>#</span> 检查切割的氨基酸分布情况：</span></code><code><span><span>cl$</span>`Cleaved residue` |&gt; table() |&gt; barplot(cex.names = 2)    </span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011082" data-ratio="0.5968992248062015" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4La8D4NiabLFBibGSVXJh3DrQTibcJMLhwOk5OOwb5bibxuG8rJ7qPDVaPg/640?wx_fmt=png" data-type="png" data-w="387" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4La8D4NiabLFBibGSVXJh3DrQTibcJMLhwOk5OOwb5bibxuG8rJ7qPDVaPg/640?wx_fmt=png"></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="cs"><code><span><span># 查找涉及最多切割事件的蛋白酶：</span></span></code><code><span>cl[!duplicated(Peptide), .(count = .N), <span>by</span> = `Protease (Uniprot)`]</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011087" data-ratio="0.20202020202020202" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4f9CBcZT5iagsGZxOrVoXDHOHTORjj71eoiaSQpv8SZdeaSMuJSyxEQAw/640?wx_fmt=png" data-type="png" data-w="495" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4f9CBcZT5iagsGZxOrVoXDHOHTORjj71eoiaSQpv8SZdeaSMuJSyxEQAw/640?wx_fmt=png"></span><span></span></section><section><span>注意哦，</span><span>如果你指定了起始和终止位置，函数将不会自动查找指定蛋白/肽段的序列数据，这意味着底物的序列细节将不可用。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span>cl_by_pos</span> <span>&lt;- findProtease(</span></span></code><code><span>  <span>protein</span> = <span>"P02671",</span></span></code><code><span>  <span>peptide</span> = <span>"FEEVSGNVSPGTR",</span></span></code><code><span>  <span>start_pos</span> = <span>413,</span></span></code><code><span>  <span>end_pos</span> = <span>425)</span></span></code><code><span><span>substrates(cl_by_pos)</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011086" data-ratio="0.06548279689234185" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE44QGZ7evfth4b2F8AicbYJyRAvMrCTbcs6OQePOHMjqvZX7Ujg6PuN6g/640?wx_fmt=png" data-type="png" data-w="901" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE44QGZ7evfth4b2F8AicbYJyRAvMrCTbcs6OQePOHMjqvZX7Ujg6PuN6g/640?wx_fmt=png"></span><span></span></section><section><span>通过这种方式，</span><span>我们</span><span>可以深入了解蛋白酶如何作用于特定的肽段，为研究蛋白酶的功能和调控机制提供了有力的工具。</span></section><section><span>4.<span></span></span><span>在MEROPS中查找蛋白酶详情</span></section><section><span>如果你想要直接在MEROPS数据库中查看某个蛋白酶的详细信息，可以使用`browseProtease`函数。这个函数接受一个UniProt或MEROPS的ID，并在网页浏览器中打开对应的MEROPS摘要页面。</span><page></page></section><section><ul><li></ul><pre data-lang="bash"><code><span>browseProtease(<span>"P07339"</span>, keytype = <span>"UniprotID"</span>) <span># （打开网页浏览器）</span></span></code></pre></section><section><span></span><span></span></section><section><span>在MEROPS数据库中指定蛋白酶的详细页面，</span><span>我们</span><span>可以找到关于该蛋白酶的更多数据，包括它的分类、底物、抑制剂以及相关的文献信息。小师妹提醒你，虽然这个函数很方便，但记得在有网络连接的情况下使用哦！</span></section><p><strong><span><span>本篇文章文章所使用的代码、示例数据或基因集等，关注公众号回复【666】获取哦~编号：241022</span></span></strong><span></span></p><section><mp-common-profile data-pluginname="mpprofile" data-id="Mzg5MDk3Mzg4OA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/oCSOtP61aEVVCT8bjvGjvicxiaj3q39iaClXlQMVUcyTp0N2Jr5MX57B5mxKLt8W1YiaA7lEibyicLLicYAMJImkJQs4A/300?wx_fmt=png&amp;wxfrom=19" data-nickname="R语言学徒" data-alias="" data-signature="R语言学习从入门到精通，持续关注小师妹，每天更新R语言知识，生信干货内容。如需定制生信分析、服务器租赁，欢迎咨询小师妹" data-from="2" data-is_biz_ban="0" data-origin_num="262" data-isban="0" data-biz_account_status="0" data-index="0"></mp-common-profile></section><section><span>二、<span></span></span><span>应用案例</span></section><section><span></span></section><section><span>1.<span></span></span><span>可视化蛋白酶作用网络</span></section><section><span>接下来，我们可以用一种直观的方法来探究两种底物的蛋白酶作用模式：将它们呈现为一个蛋白-蛋白相互作用网络图，其中底物以红色节点表示，相关的蛋白酶则以蓝色节点显示。</span></section><section><span>首先，我们需要加载一些必要的R包，并定义我们想要研究的底物列表。</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="bash"><code><span>library(igraph)</span></code><code><span>library(data.table)</span></code><code><span><span># 定义研究的底物</span></span></code><code><span>proteins &lt;- c(<span>'P01011'</span>,<span>'P02671'</span>)</span></code></pre></section><section><span>然后，我们利用`searchSubstrate`函数查找这些底物的已知蛋白酶，并筛选出状态为“reviewed”的蛋白酶。</span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="nginx"><code><span><span># 查询切割这些底物的蛋白酶</span></span></code><code><span><span>res</span> &lt;- searchSubstrate(protein = proteins, summarize = FALSE)</span></code><code><span><span># 筛选状态为“reviewed”的蛋白酶</span></span></code><code><span>res &lt;- res[`Protease status` == <span>"reviewed"</span>]</span></code></pre></section><section><span>为了构建网络图，我们提取了与蛋白酶对底物的切割作用相关的两列数据。</span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="nginx"><code><span><span># 提取构建网络所需的数据    </span></span></code><code><span><span>res</span> &lt;- res[, c(<span>"Protease (Uniprot)"</span>, <span>"Substrate (Uniprot)"</span>, <span>"Cleavage type"</span>)]</span></code></pre></section><section><span>使用igraph包，我们根据这些数据构建了一个有向无环图（DAG）。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span># 构建网络图</span></span></code><code><span><span>g</span> <span>&lt;- igraph::graph_from_data_frame(res,</span></span></code><code><span>                                   <span>directed</span> = <span>TRUE,</span></span></code><code><span>                                   <span>vertices</span> = <span>unique(</span></span></code><code><span>                                       <span>c(res$`Protease</span> <span>(Uniprot)`,</span></span></code><code><span>                                         <span>res$`Substrate</span> <span>(Uniprot)`)))</span></span></code></pre></section><section><span>最后，我们绘制这个网络图，并对其进行美化，以便于我们能更清楚地看到每个蛋白酶和底物之间的相互作用。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="sql"><code><span><span># 设置随机种子以复现结果</span></span></code><code><span>set.seed(<span>104</span>)</span></code><code><span><span># 绘制网络图</span></span></code><code><span>plot(g,</span></code><code><span>     vertex.label.family = <span>"Helvetica"</span>,</span></code><code><span>     vertex.size = <span>14</span>,</span></code><code><span>     vertex.color = ifelse(V(g)$<span>name</span> %<span>in</span>% res$<span>`Protease (Uniprot)`</span>,</span></code><code><span>                           <span>"#377EB8"</span>, <span>"#E41A1C"</span>),</span></code><code><span>     vertex.label.cex = <span>1</span>,</span></code><code><span>     vertex.label.color = <span>"white"</span>,</span></code><code><span>     edge.arrow.size = <span>.6</span>,</span></code><code><span>     edge.color =  ifelse(E(g)$<span>`Cleavage type`</span> == <span>"physiological"</span>,</span></code><code><span>                          <span>"#01665E"</span>, <span>"#8E0152"</span>),</span></code><code><span>     layout = igraph::layout.davidson.harel)</span></code><code><span><span># 添加图例</span></span></code><code><span>legend(title = <span>"Nodes"</span>, cex = <span>2</span>, horiz = <span>FALSE</span>,</span></code><code><span>       title.adj = <span>0.0</span>, inset = c(<span>0.0</span>, <span>0.2</span>),</span></code><code><span>       <span>"bottomleft"</span>, bty = <span>"n"</span>,</span></code><code><span>       legend = c(<span>"Protease"</span>, <span>"Substrate"</span>),</span></code><code><span>       fill = c(<span>"#377EB8"</span>, <span>"#E41A1C"</span>), border = NA)</span></code><code><span>legend(title = <span>"Edges"</span>, cex = <span>2</span>, horiz = <span>FALSE</span>,</span></code><code><span>       title.adj = <span>0.0</span>, inset = c(<span>0.0</span>, <span>0.0</span>),</span></code><code><span>       <span>"bottomleft"</span>, bty = <span>"n"</span>,</span></code><code><span>       legend = c(<span>"Physiological"</span>, <span>"Non-physiological"</span>),    </span></code><code><span>       fill = c(<span>"#01665E"</span>, <span>"#8E0152"</span>), border = NA)</span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011088" data-ratio="0.7204030226700252" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE417SUTSBLEOyfUruV5RrciaQ29ic0RNnz2wxmYEm6vNSq3x6AqPhTGibwg/640?wx_fmt=png" data-type="png" data-w="397" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE417SUTSBLEOyfUruV5RrciaQ29ic0RNnz2wxmYEm6vNSq3x6AqPhTGibwg/640?wx_fmt=png"></span></section><section><span>通过这种网络图，我们可以直观地观察到特定蛋白酶与底物之间的潜在互作关系，这对于理解蛋白质在生物体内的功能和调控网络非常有帮助。</span></section><section><span>2.<span></span></span><span>序列相似性热图</span><span></span></section><section><span>proteasy包能够自动根据蛋白ID查找蛋白序列，这得益于ensembldb和Rcpi这两个库的支持。我们可以使用 `substrates()` 函数来获取这些序列。在这里，我们将研究一些蛋白和肽段水平上的序列相似性矩阵，并将它们作为热图绘制出来。为了进一步分析，我们还会用切割数据对这些热图进行</span><span>注释</span><span>。</span></section><section><span>首先，我们需要加载一些额外的库，并准备输入数据：蛋白和相关的肽段序列。</span></section><section><span></span></section><section><ul><li><li><li></ul><pre><code><span>library(Rcpi)</span></code><code><span>library(viridis)</span></code><code><span>suppressPackageStartupMessages(library(ComplexHeatmap))</span></code></pre></section><section><span>接着，</span><span>我们</span><span>可以</span><span>定义我们感兴趣的蛋白列表和相关的肽段序列，这些将作为我们分析的起点</span><span>。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="nginx"><code><span><span>protein</span> &lt;- c(<span>'P01011'</span>,<span>'P01011'</span>,<span>'P01034'</span>,<span>'P01034'</span>,</span></code><code><span>             <span>'P01042'</span>,<span>'P02671'</span>,<span>'P02671'</span>,<span>'P68871'</span>,</span></code><code><span>             <span>'P68871'</span>,<span>'P01042'</span>)</span></code><code><span>peptide &lt;- c(<span>'LVETRTIVRFNRPFLMIIVPTDTQNIFFMSKVTNPK'</span>,<span>'ITLLSAL'</span>,</span></code><code><span>             <span>'KAFCSFQIY'</span>,<span>'AFCSFQIY'</span>,<span>'DIPTNSPELEETLTHTITKL'</span>,<span>'FEEVSGNVSPGTR'</span>,    </span></code><code><span>             <span>'FVSETESR'</span>,<span>'LLVVYPW'</span>,<span>'VDEVGGEALGR'</span>,<span>'KIYPTVNCQPLGMISLM'</span>)</span></code></pre></section><section><span></span><span></span></section><section><span>使用findProtease函数，我们可以查找与特定底物相关的蛋白酶，并获取它们的切割数据。</span><span></span></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="properties"><code><span><span># 查找与上述底物相关的切割数据</span></span></code><code><span><span>res</span> <span>&lt;- findProtease(protein = protein,</span></span></code><code><span>                    <span>peptide</span> = <span>peptide,</span></span></code><code><span>                    <span>organism</span> = <span>"Homo sapiens")</span></span></code></pre></section><section><span>接下来，我们</span><span>可以</span><span>提取底物信息，并计算了蛋白序列之间的相似性，这有助于我们理解不同蛋白之间的同源性。</span><span></span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span># 获取底物信息</span></span></code><code><span><span>ss</span> <span>&lt;- substrates(res)# 仅展示唯一的序列</span></span></code><code><span><span>ss_uniq</span> <span>&lt;- ss[!duplicated(`Substrate sequence`)]</span></span></code><code><span><span># 计算蛋白（底物）序列相似性</span></span></code><code><span><span>psimmat</span> = <span>Rcpi::calcParProtSeqSim(ss_uniq$`Substrate sequence`,</span></span></code><code><span>                                  <span>type</span> = <span>'global',</span></span></code><code><span>                                  <span>submat</span> = <span>'BLOSUM62')</span></span></code><code><span><span>rownames(psimmat)</span> <span>&lt;- colnames(psimmat) &lt;- ss_uniq$`Substrate (Uniprot)`</span></span></code></pre></section><section><span>利用计算出的序列相似性数据，我们绘制了一个热图，以直观展示不同蛋白序列之间的相似度。</span><span></span></section><section><span></span></section><section><ul><li><li></ul><pre data-lang="php"><code><span><span># 热图绘制</span></span></code><code><span>ComplexHeatmap::Heatmap(psimmat, col = viridis::mako(<span>100</span>))    </span></code></pre></section><section><page></page></section><section><span><img data-imgfileid="100011089" data-ratio="0.6369047619047619" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4E8oehswiciayXMK8LticJaoJXTMFkgv2VMibKibmj1Se6FIMsJKcyWfibxHQ/640?wx_fmt=png" data-type="png" data-w="1008" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE4E8oehswiciayXMK8LticJaoJXTMFkgv2VMibKibmj1Se6FIMsJKcyWfibxHQ/640?wx_fmt=png"></span></section><section><span>同样的方法也应用于肽段序列，我们计算了它们的序列相似性，并用切割残基和末端信息对每一行进行了详细的注释。</span></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span><span># 获取切割细节</span></span></code><code><span>cl &lt;- cleavages(res)</span></code><code><span><span># 计算肽段序列相似性</span></span></code><code><span>pep_psimmat = Rcpi::calcParProtSeqSim(cl$Peptide, type = <span>'global'</span>,</span></code><code><span>                                      submat = <span>'BLOSUM62'</span>)</span></code><code><span>           </span></code><code><span><span># 添加注释</span></span></code><code><span>rsd &lt;- cl$`Cleaved residue`</span></code><code><span>cols &lt;- c(<span>"#8DD3C7"</span>, <span>"#FFFFB3"</span>, <span>"#BEBADA"</span>, <span>"#FB8072"</span>)</span></code><code><span>names(cols) &lt;- unique(rsd)</span></code><code><span>ha1 &lt;- ComplexHeatmap::columnAnnotation(`cleaved residue` = rsd,</span></code><code><span>                         col = <span>list</span>(`cleaved residue` = cols))</span></code><code><span>tn &lt;- cl$`Cleaved terminus`</span></code><code><span>cols &lt;- c(<span>"#B3E2CD"</span>, <span>"#FDCDAC"</span>)</span></code><code><span>names(cols) &lt;- unique(tn)</span></code><code><span>ha2 &lt;- ComplexHeatmap::columnAnnotation(terminus = tn,</span></code><code><span>                     col = <span>list</span>(terminus = cols))</span></code><code><span>rownames(pep_psimmat) &lt;- cl$`Substrate (Uniprot)`</span></code></pre></section><section><span>最后，我们为肽段序列绘制了另一个热图，其中包括了切割位点的详细信息，这有助于我们深入理解蛋白酶如何作用于这些特定的肽段。</span><span></span>    <page></page></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="properties"><code><span><span># 热图绘制</span></span></code><code><span><span>ComplexHeatmap</span>:<span>:Heatmap(</span></span></code><code><span>    <span>pep_psimmat,</span></span></code><code><span>    <span>name</span> = <span>"sequence\nsimilarity",</span></span></code><code><span>    <span>col</span> = <span>viridis::mako(100),</span></span></code><code><span>    <span>show_column_names</span> = <span>FALSE,</span></span></code><code><span>    <span>row_names_gp</span> = <span>grid::gpar(fontsize = 6.5),</span></span></code><code><span>    <span>top_annotation</span> = <span>c(ha1, ha2))</span></span></code></pre></section><section><span></span></section><section><span><img data-imgfileid="100011085" data-ratio="0.5456349206349206" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE44LMcTkmk2KwQn0S8NicalHlscxrux9tZgBmRXu6o3kXJnMQnSYr3Frg/640?wx_fmt=png" data-type="png" data-w="1008" src="https://mmbiz.qpic.cn/sz_mmbiz_png/oCSOtP61aEWofwhAOHx8IOKcgULzChE44LMcTkmk2KwQn0S8NicalHlscxrux9tZgBmRXu6o3kXJnMQnSYr3Frg/640?wx_fmt=png"></span></section><section><span>通过这些步骤，我们能够将复杂的生物信息数据转化为直观的图形表示，从而更深入地理解蛋白酶与其底物之间的相互作用。</span></section><section><span>通过使用proteasy包，我们不仅成功地分析了蛋白序列的相似性，还深入理解了蛋白酶如何精确地作用于特定肽段。这强大的工具将大大加速你在蛋白质组学研究中的探索步伐</span><span>。如果你对这个过程还有任何疑问，或者需要进一步的帮助，随时可以</span><span>联系</span><span>小师妹哦！</span></section><section><span>无论你是在优化代码，还是在云端进行便捷的分析，云生信神器都能为你提供强大的支持。</span><span>欢迎试试我们的云生信神器，只需一键上传数据，想要的图就能轻松get~</span></section><section><span>云生信平台链接：http://www.biocloudservice.com/home.html</span><span></span>    <page></page></section><section><br></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section><section><section powered-by="xiumi.us"><p>E</p></section></section><section><section powered-by="xiumi.us"><p>N</p></section></section><section><section powered-by="xiumi.us"><p>D</p></section></section><section><section powered-by="xiumi.us"><section><br></section></section></section></section></section><p><span>如果您的时间和精力有限或者缺乏相关经验，并且对生信分析和期刊推荐有所需要的话，我们非常乐意为您提供如下服务：免费思路评估、付费生信分析和方案设计以及付费选刊等，有意向的小伙伴欢迎咨询师妹哦！</span></p><p><span></span><span></span></p><section powered-by="xiumi.us"><p><img data-cropselx1="0" data-cropselx2="578" data-cropsely1="0" data-cropsely2="257" data-galleryid="" data-imgfileid="100010298" data-ratio="0.4444444444444444" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUqAk7f4mcKxwPx45IICz1wNazhXRTUEVx9ia4aYAawCG8smiaXiaJRzR0LiaEF0rUpevlfn6W3nnm4vA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="900" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/oCSOtP61aEUqAk7f4mcKxwPx45IICz1wNazhXRTUEVx9ia4aYAawCG8smiaXiaJRzR0LiaEF0rUpevlfn6W3nnm4vA/640?wx_fmt=jpeg&amp;from=appmsg"></p><p><br></p><p><br></p></section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section><section><section powered-by="xiumi.us"><p><strong>往期推荐</strong></p></section></section><section><section powered-by="xiumi.us"><section><section powered-by="xiumi.us"><section><svg viewbox="0 0 1 1"></svg></section></section></section></section></section></section><section powered-by="xiumi.us"><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492496&amp;idx=1&amp;sn=b3be5983f3f8f068ebdf1b773b7cb792&amp;chksm=cfd6d83ff8a15129493abd81502ab5c3128247ff20fd576c1ba880303f346110e8bee971478e&amp;scene=21#wechat_redirect" textvalue="别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">别再说纯生信想不出好思路了！北大深圳医院黄晓彦团队基于UKB数据库,孟德尔随机化一套连招拿下13分+！</a></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492387&amp;idx=1&amp;sn=fc12277c2ebd379a297d0c7a2c96c970&amp;chksm=cfd6d88cf8a1519a3a6eb4938cb44ebcb2d1b857ffc558c1c033ac88913384cb2f11d03a00f4&amp;scene=21#wechat_redirect" textvalue="师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图" linktype="text" imgurl="" imgdata="null" data-itemshowtype="11" tab="innerlink" data-linktype="2" hasload="1">师妹手把手带你复现IF5.8《Cancer Cell International》杂志的高分文章中相关性热图和散点图</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247492197&amp;idx=1&amp;sn=40540e16ddc99310445236401505c47e&amp;chksm=cfd6d9caf8a150dc8f010750cacc4bd241ed68a8974593d499c1b34edf5f222de567732a5705&amp;scene=21#wechat_redirect" textvalue="是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">是谁还不会用孟德尔随机化？这篇文章教你！高分SCI不是梦！！</a><br></p><p><a target="_blank" href="http://mp.weixin.qq.com/s?__biz=Mzg5MDk3Mzg4OA==&amp;mid=2247488665&amp;idx=1&amp;sn=6d7b7b1e8b36a92df691b0ab014e7663&amp;chksm=cfd52f36f8a2a620a790e74d99e3d8af879904a131c4e1f653448590453941b7ff356d486531&amp;scene=21#wechat_redirect" textvalue="师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">师妹教你R包EnhancedVolcano超详尽，让你的火山图喷发姿势更帅</a></p></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/FihOh3LdYE_zbOjNwB19Qg",target="_blank" rel="noopener noreferrer">原文链接</a>
