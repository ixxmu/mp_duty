---
title: "ggalign-基于ggplot2的热图扩展包"
date: 2024-10-23T13:20:07Z
draft: ["false"]
tags: [
  "fetched",
  "生信协作组"
]
categories: ["Acdemic"]
---
ggalign-基于ggplot2的热图扩展包 by 生信协作组
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h2 data-tool="mdnice编辑器"><span></span><span><span>介绍</span></span><span></span></h2><p data-tool="mdnice编辑器"><code>ggalign</code>通过对齐多个<code>ggplot2</code>图表的观测来组织图表布局。它使你能够使用熟悉的 ggplot2 语法创建复杂热图。</p><h2 data-tool="mdnice编辑器"><span></span><span>安装</span><span></span></h2><p data-tool="mdnice编辑器">你可以使用以下命令从 <code>CRAN</code> 安装 <code>ggalign</code>：</p><pre data-tool="mdnice编辑器"><span></span><code>install.packages("ggalign")<br></code></pre><p data-tool="mdnice编辑器">或者，从 <span>r-universe</span><sup>[1]</sup> 安装开发版本（目前开发版本添加了大量新功能，因为CRAN通常需要1-2个月的更新间隔，暂不能推送到CRAN）：</p><pre data-tool="mdnice编辑器"><span></span><code>install.packages("ggalign",<br>    repos = c("https://yunuuuu.r-universe.dev", "https://cloud.r-project.org")<br>)<br></code></pre><p data-tool="mdnice编辑器">或者从<span>GitHub</span><sup>[2]</sup></p><pre data-tool="mdnice编辑器"><span></span><code># install.packages("remotes")<br>remotes::install_github("Yunuuuu/ggalign")<br></code></pre><p data-tool="mdnice编辑器">如果您在使用ggalign后觉得它对您的工作有所帮助，欢迎在<span>GitHub</span><sup>[3]</sup>上为此项目添加星星。</p><h2 data-tool="mdnice编辑器"><span></span><span>基本流程</span><span></span></h2><p data-tool="mdnice编辑器">如果你熟悉 <code>ggplot2</code> 语法，<code>ggalign</code> 的使用很简单，典型的工作流程如下：</p><ul data-tool="mdnice编辑器"><li><section>使用 <code>ggheatmap()</code> 或 <code>ggstack()</code> 初始化布局。</section></li><li><section>使用以下自定义布局：</section></li><ul><li><section><code>align_group()</code>：将布局轴分组到具有组变量的面板中。</section></li><li><section><code>align_kmeans()</code>：通过 kmeans 将布局轴分组到面板中。</section></li><li><section><code>align_order()</code>：根据统计权重重新排序布局观察结果，或手动指定观察索引。</section></li><li><section><code>align_dendro()</code>：根据层次聚类重新排序或分组布局。</section></li></ul><li><section>使用 <code>ggalign()</code> 或 <code>ggpanel()</code> 添加图表，然后叠加额外的 ggplot2 元素，如 geoms、stats 或 scales。</section></li></ul><h2 data-tool="mdnice编辑器"><span></span><span>基本示例</span><span></span></h2><p data-tool="mdnice编辑器">下面，我们将通过一个基本示例，展示如何使用 <code>ggalign</code> 创建带有 <code>dendrogram</code> 的热图。</p><pre data-tool="mdnice编辑器"><span></span><code>library(ggalign)<br>set.seed(123)<br>small_mat &lt;- matrix(rnorm(81), nrow = 9)<br>rownames(small_mat) &lt;- paste0("row", seq_len(nrow(small_mat)))<br>colnames(small_mat) &lt;- paste0("column", seq_len(ncol(small_mat)))<br><br># 初始化热图布局，我们可以将其视为一个普通的 ggplot 对象<br>ggheatmap(small_mat) + <br>    # 我们可以直接修改 geoms、scales 和其他 ggplot2 组件<br>    scale_fill_viridis_c() +<br>    # 在顶部添加注释<br>    hmanno("top") +<br>    # 在顶部注释中，我们添加了一个树状图，并将观察结果分成 3 组<br>    align_dendro(aes(color = branch), k = 3) +<br>    # 在树状图中添加点 geom<br>    geom_point(aes(color = branch, y = y)) +<br>    # 更改树状图的颜色映射<br>    scale_color_brewer(palette = "Dark2")<br></code></pre><figure data-tool="mdnice编辑器"><img data-imgfileid="100011741" data-ratio="0.6175925925925926" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju701DQpf3QCHgtib2cNTh3mPmib5zIwQIf8HpL1ic4hOpxA7ClXRyXxiaYECQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju701DQpf3QCHgtib2cNTh3mPmib5zIwQIf8HpL1ic4hOpxA7ClXRyXxiaYECQ/640?wx_fmt=png&amp;from=appmsg"></figure><h2 data-tool="mdnice编辑器"><span></span><span>与其他 ggplot2 热图扩展比较</span><span></span></h2><p data-tool="mdnice编辑器"><code>ggalign</code> 相对于其他扩展如 <span>ggheatmap</span><sup>[4]</sup> 的主要优势在于其与 ggplot2 语法的完全兼容性。你可以无缝使用任何 ggplot2 geoms、stats 和 scales 来构建复杂布局，包括垂直或水平排列的多个热图。</p><h2 data-tool="mdnice编辑器"><span></span><span>与 ComplexHeatmap 比较</span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span>优点</span><span></span></h3><ul data-tool="mdnice编辑器"><li><section>与 <code>ggplot2</code> 生态系统完全集成。</section></li><li><section>热图注释轴和图例自动生成。</section></li><li><section>树状图可以轻松自定义和着色。</section></li><li><section>对图表大小和间距有灵活的控制。</section></li><li><section>可以通过面板区域轻松与其他 <code>ggplot2</code> 图表对齐。</section></li><li><section>可以轻松扩展用于其他聚类算法或注释图表。</section></li></ul><h3 data-tool="mdnice编辑器"><span></span><span>缺点</span><span></span></h3><p data-tool="mdnice编辑器">内置注释较少：与 <span>ComplexHeatmap</span><sup>[5]</sup> 中广泛的内置注释函数相比，可能需要额外编写更多代码以实现特定图形。</p><h2 data-tool="mdnice编辑器"><span></span><span>更复杂的示例</span><span></span></h2><p data-tool="mdnice编辑器">以下是使用 <code>ggalign</code> 进行的一些更高级的可视化示例：<img data-imgfileid="100011743" data-ratio="1" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju70AsqjVyLFVS54a5J8G8DBuuzPdibNqCm2tqgibTiarU9WK09yvwbR7b25w/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju70AsqjVyLFVS54a5J8G8DBuuzPdibNqCm2tqgibTiarU9WK09yvwbR7b25w/640?wx_fmt=png&amp;from=appmsg"><img data-imgfileid="100011742" data-ratio="0.8333333333333334" data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju70xfEtK9Xhjx1oTKKHrlFrZMJcyxNBtrkmiawJYrNM2ic0Lw653y3Wblzg/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" src="https://mmbiz.qpic.cn/sz_mmbiz_png/mPqFmhtlSJw0qZHuW57sK0cOKTobju70xfEtK9Xhjx1oTKKHrlFrZMJcyxNBtrkmiawJYrNM2ic0Lw653y3Wblzg/640?wx_fmt=png&amp;from=appmsg"></p><h2 data-tool="mdnice编辑器"><span></span><span>更多文档</span><span></span></h2><ul data-tool="mdnice编辑器"><li><section><span>热图布局</span><sup>[6]</sup></section></li><li><section><span>布局自定义</span><sup>[7]</sup></section></li><li><section><span>布局图表</span><sup>[8]</sup></section></li><li><section><span>堆叠布局</span><sup>[9]</sup></section></li><li><section><span>特殊语法</span><sup>[10]</sup></section></li></ul><section data-tool="mdnice编辑器"><span>最后感谢王诗翔教授以及生信技能树曾健明老师的推广！<br></span><span><br></span><span>参考资料</span></section><section data-tool="mdnice编辑器"><span><span>[1]</span><p>r-universe: <em>https://yunuuuu.r-universe.dev/ggalign</em></p></span><span><span>[2]</span><p>GitHub: <em>https://github.com/Yunuuuu/ggalign</em></p></span><span><span>[3]</span><p>GitHub: <em>https://github.com/Yunuuuu/ggalign</em></p></span><span><span>[4]</span><p>ggheatmap: <em>https://github.com/XiaoLuo-boy/ggheatmap</em></p></span><span><span>[5]</span><p>ComplexHeatmap: <em>https://github.com/jokergoo/ComplexHeatmap</em></p></span><span><span>[6]</span><p>热图布局: <em>https://yunuuuu.github.io/ggalign/articles/heatmap-layout.html</em></p></span><span><span>[7]</span><p>布局自定义: <em>https://yunuuuu.github.io/ggalign/articles/layout-customize.html</em></p></span><span><span>[8]</span><p>布局图表: <em>https://yunuuuu.github.io/ggalign/articles/layout-plot.html</em></p></span><span><span>[9]</span><p>堆叠布局: <em>https://yunuuuu.github.io/ggalign/articles/stack-layout.html</em></p></span><span><span>[10]</span><p>特殊语法: <em>https://yunuuuu.github.io/ggalign/articles/special-syntax.html</em></p></span></section></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/6-0M1s3ipgKv5wlIS95ojg",target="_blank" rel="noopener noreferrer">原文链接</a>
