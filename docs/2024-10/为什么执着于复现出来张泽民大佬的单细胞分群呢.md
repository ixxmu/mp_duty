---
title: "为什么执着于复现出来张泽民大佬的单细胞分群呢"
date: 2024-10-04T00:39:14Z
draft: ["false"]
tags: [
  "fetched",
  "单细胞天地"
]
categories: ["Acdemic"]
---
为什么执着于复现出来张泽民大佬的单细胞分群呢 by 单细胞天地
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><blockquote data-tool="mdnice编辑器"><span></span><p>前些天我们兼职工程师交流群的小伙伴们反馈了一个“鸡同鸭讲”的数据分析售后单子，客户强烈要求必须复现出来跟张泽民大佬的单细胞原文一模一样的降维聚类分群和生物学命名结果。</p></blockquote><p data-tool="mdnice编辑器">这个文章很经典，发表在2019的CELL期刊：《Landscape and Dynamics of Single Immune Cells in Hepatocellular Carcinoma》，其中 单细胞表达量矩阵文件是：</p><pre data-tool="mdnice编辑器"><span></span><code>ls -lh *gz|cut -d<span>" "</span> -f 6-<br>  250M  8 30 11:20 GSE140228_UMI_counts_Droplet.mtx.gz<br>  308K  8 30 11:19 GSE140228_UMI_counts_Droplet_barcodes.tsv.gz<br>  478K  8 30 11:19 GSE140228_UMI_counts_Droplet_cellinfo.tsv.gz<br>  1.0M  8 30 11:19 GSE140228_UMI_counts_Droplet_genes.tsv.gz<br></code></pre><p data-tool="mdnice编辑器">我们可以很简单的读取上面的表达量矩阵文件以及作者给出来了各个细胞的身份信息，然后做降维聚类分群，如下所示 ：</p><p><img data-galleryid="" data-imgfileid="100041984" data-ratio="0.7849056603773585" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPXF4laIibbFku4l6Fg5kbEeJ1ZL00PUZoPNI5wrqLYnGicjJwCVAho2vQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1590" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPXF4laIibbFku4l6Fg5kbEeJ1ZL00PUZoPNI5wrqLYnGicjJwCVAho2vQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>降维聚类分群</figcaption></figure><p data-tool="mdnice编辑器">这个数据分析过程，最大的难点，就是读取作者给出来的文件，如下所示：</p><pre data-tool="mdnice编辑器"><span></span><code> <span>library</span>(data.table)<br>  <span>library</span>(Matrix)  <br>  mtx=readMM( <span>"inputs/GSE140228_UMI_counts_Droplet.mtx.gz"</span> ) <br>  cl=fread( <span>"inputs/GSE140228_UMI_counts_Droplet_barcodes.tsv.gz"</span>   ,<br>            header = <span>F</span>,data.table = <span>F</span> )  <br>  rl=fread(  <span>"inputs/GSE140228_UMI_counts_Droplet_genes.tsv.gz"</span> ,<br>             header = <span>T</span>,data.table = <span>F</span> )  <br>  kp=!duplicated(rl$SYMBOL)<br>  table(kp)<br>  dim(mtx)<br>  mtx=mtx[kp,]<br>  rl=rl[kp,] <br>   rownames(mtx)=rl$SYMBOL<br>   colnames(mtx)=cl$V1 <span>#paste0('c',cl$V2)</span><br>  mtx[<span>1</span>:<span>4</span>,<span>1</span>:<span>4</span>]<br>  dim(mtx)<br>  meta=fread( <span>"inputs/GSE140228_UMI_counts_Droplet_cellinfo.tsv.gz"</span>   ,<br>              header = <span>T</span>,data.table = <span>F</span> ) <br>  head(meta)<br>  rownames(meta)=meta[,<span>1</span>]<br>  meta=meta[,-<span>1</span>]<br>  head(meta)<br>  identical(rownames(meta),colnames(mtx)) <br>  <span>library</span>(Seurat)<br>  sce.all=CreateSeuratObject(counts = mtx  , <br>                             meta.data = meta,<br>                             min.cells = <span>5</span>,<br>                             min.features = <span>300</span> )<br></code></pre><p data-tool="mdnice编辑器">如果我们没有读取作者自己的单细胞亚群名字文件，是不可能拿到跟文章一模一样的各个单细胞亚群结果 ：</p><p><img data-galleryid="" data-imgfileid="100041986" data-ratio="0.7829949238578681" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPCRBIl0fyRo5C107h0ubXz4t2KarnMoFxWLLfZ8UPfFDUhia494ZyCGQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1576" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPCRBIl0fyRo5C107h0ubXz4t2KarnMoFxWLLfZ8UPfFDUhia494ZyCGQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>各个单细胞亚群结果</figcaption></figure><p data-tool="mdnice编辑器">首先呢，作者的每个单细胞亚群进行了大量的细分，比如cd4和cd8还有nk都是各自有好多个细分亚群，这些信息在我们自己的UMAP里面肯定是会糅合在一起的，因为哪怕是cd4和cd8还有nk都是有互相掺杂的，如下所示：</p><p><img data-galleryid="" data-imgfileid="100041985" data-ratio="0.36272040302267" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPibeonwQVibO7WnMziaczrGyUAqClX45j3duEps7wnSpjWuEQJONzy0LfA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="2382" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPibeonwQVibO7WnMziaczrGyUAqClX45j3duEps7wnSpjWuEQJONzy0LfA/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>哪怕是cd4和cd8还有nk都是有互相掺杂的</figcaption></figure><p data-tool="mdnice编辑器">因为cd4和cd8还有nk在第一层次降维聚类分群的UMAP本来就是不应该是泾渭分明，就算是我们强行的想把细分亚群添加在umap上面，也是看起来就“杂乱无章”：</p><p><img data-galleryid="" data-imgfileid="100041987" data-ratio="0.48350253807106597" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPa2nLFI8tOuiaUP79Yq5s45DH9icUo070icFAQgE8qp2oHA6WPGG7CsuuQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1576" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVPa2nLFI8tOuiaUP79Yq5s45DH9icUo070icFAQgE8qp2oHA6WPGG7CsuuQ/640?wx_fmt=png&amp;from=appmsg"></p><figure data-tool="mdnice编辑器"><figcaption>看起来就“杂乱无章”</figcaption></figure></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com"><h3 data-tool="mdnice编辑器"><span></span><span>但是客户根本就不理解各个结果复现的重要性</span><span></span></h3><p data-tool="mdnice编辑器">毕竟张泽民大佬的权威性太高，所以初次接触单细胞的小伙伴们肯定是想朝他看齐。</p><p><img data-galleryid="" data-imgfileid="100041989" data-ratio="1.1294416243654823" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVP4J6gicbmrJFfpNsWlDf39svByVrLQkcE4oCGsvAEd41ZYnIjd9Gqttw/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="788" src="https://mmbiz.qpic.cn/mmbiz_png/siaia0BDGJdjRG7cXrmNtMHItauH1AZnVP4J6gicbmrJFfpNsWlDf39svByVrLQkcE4oCGsvAEd41ZYnIjd9Gqttw/640?wx_fmt=png&amp;from=appmsg"></p><p data-tool="mdnice编辑器"><br></p></section><p><br></p><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/5jaTU0ScmjCUhVcS3g_zNw",target="_blank" rel="noopener noreferrer">原文链接</a>
