---
title: "Rè¯­è¨€lightGBMè¶…å‚æ•°è°ƒä¼˜"
date: 2024-01-28T01:56:15Z
draft: ["false"]
tags: [
  "fetched",
  "åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°"
]
categories: ["Acdemic"]
---
Rè¯­è¨€lightGBMè¶…å‚æ•°è°ƒä¼˜ by åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°
------
<div><section><span>å…³æ³¨å…¬ä¼—å·ï¼Œå‘é€</span><strong>Rè¯­è¨€</strong><span>æˆ–</span><strong>python</strong><span>ï¼Œå¯è·å–èµ„æ–™</span><span></span></section><section><mp-common-profile data-pluginname="mpprofile" data-id="MzUzOTQzNzU0NA==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84R9YDc8IDhqWAHTrZsMuhDpFlw4scqOl1ZVWpeY77cdibaSzPeGALfkEhdVpwHzVibHCRSYZg4csB43g/0?wx_fmt=png" data-nickname="åŒ»å­¦å’Œç”Ÿä¿¡ç¬”è®°" data-alias="yxhsxbj" data-signature="å¤–ç§‘åŒ»ç”ŸğŸ‘¨â€âš•ï¸çš„Rè¯­è¨€å’Œç”Ÿä¿¡å­¦ä¹ ğŸ”–" data-from="2" data-weuitheme="light"></mp-common-profile></section><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer" label="edit by 135editor"><section data-role="paragraph"><section data-role="outer"><section data-role="outer" label="edit by 135editor"><section data-tools="135ç¼–è¾‘å™¨" data-id="28"><p data-brushtype="text" hm_fix="440:185"><span>ğŸ’¡ä¸“æ³¨Rè¯­è¨€åœ¨ğŸ©ºç”Ÿç‰©åŒ»å­¦ä¸­çš„ä½¿ç”¨</span></p></section></section></section></section></section><hr><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨"><span><span>è®¾ä¸ºâ€œ</span><strong><span>æ˜Ÿæ ‡</span></strong><span>â€ï¼Œç²¾å½©ä¸é”™è¿‡</span></span><br></p><hr><p data-tool="mdniceç¼–è¾‘å™¨"><span><strong></strong></span></p><section data-tool="mdniceç¼–è¾‘å™¨" data-website="https://www.mdnice.com"><p data-tool="mdniceç¼–è¾‘å™¨">ä¸Šä¸€ç¯‡æ¨æ–‡ä»‹ç»äº†<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247500875&amp;idx=1&amp;sn=c08b461868b43d90e5325a9eac1ec338&amp;scene=21#wechat_redirect" data-linktype="2">Rè¯­è¨€lightgbmå¿«é€Ÿä¸Šæ‰‹</a>ï¼Œä¸»è¦æ˜¯ä»‹ç»åŸç”Ÿçš„<code>lightgbm</code>åŒ…çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p><span>LightGBM</span>å’Œ<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247500668&amp;idx=1&amp;sn=7e035408d7073448eb7fcc55d78d9993&amp;chksm=facaf3fbcdbd7aed5ad4da1c8a4b58eb1c0aff61c95efc7035ae67fc3af36c3b499fe0574693&amp;scene=21#wechat_redirect" textvalue="xgboost" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2"><span>xgboost</span></a>ã€Catboostå¹¶ç§°ä¸ºGBDTä¸‰å¤§ç¥å™¨ï¼ŒåŠ ä¸Šæœ¬ç¯‡ä»‹ç»ä¹‹åå°±å‰©Catboostè¿˜æ²¡ä»‹ç»è¿‡äº†ï¼Œç­‰Catboostå¯ç”¨ä¹‹åæˆ‘å°±ç«‹é©¬ä»‹ç»å®ƒã€‚è¿™æ ·å¸¸è§çš„ä¸€äº›æ–¹æ³•æˆ‘å°±å…¨éƒ½ä»‹ç»è¿‡äº†ï¼Œåé¢å°±æ˜¯æ¨¡å‹è§£é‡Šçš„å†…å®¹äº†ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨Rä¸­å¯¹lightgbmè¿›è¡Œè¶…å‚æ•°è°ƒä¼˜å¯ä»¥é€šè¿‡<code>tidymodels</code>æˆ–è€…<code>mlr3</code>å®ç°ï¼Œè¿™é‡Œç®€å•è¯´ä¸‹å¦‚æœé€šè¿‡<code>tidymodels</code>å®ç°ã€‚å…¶å®è¿™å’Œå…¶ä»–ç®—æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåªä¸è¿‡æ˜¯æ¢ä¸ªâ€œå¼•æ“â€è€Œå·²ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">è¦æƒ³å¾—åˆ°æ›´å¥½çš„ç»“æœï¼Œå…³é”®è¿˜æ˜¯çœ‹ä½ å¯¹è‡ªå·±æ•°æ®çš„ç†è§£ä»¥åŠå¯¹ç®—æ³•æœ¬èº«çš„ç†è§£ã€‚ä¸ç®¡æ˜¯<code>tidymodels</code>è¿˜æ˜¯<code>mlr3</code>éƒ½åªæ˜¯ä¸€ç§å®ç°å·¥å…·è€Œå·²ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨"><code>tidymodels</code>ä¸­çš„è¶…å‚æ•°è°ƒä¼˜çš„æ–¹æ³•å¾ˆå°‘ï¼Œç›®å‰åªæ”¯æŒç½‘æ ¼æœç´¢ã€è´å¶æ–¯ä¼˜åŒ–ã€æ¨¡æ‹Ÿé€€ç«3ç§æ–¹æ³•ã€‚å…¶ä¸­æ¨¡æ‹Ÿé€€ç«éœ€è¦é¢å¤–å®‰è£…<code>finetune</code>åŒ…æ‰å¯å®ç°ã€‚</p><p data-tool="mdniceç¼–è¾‘å™¨">æ³¨æ„é€šè¿‡<code>tidymodels</code>å®ç°<code>lightgbm</code>éœ€è¦é¢å¤–å®‰è£…<code>bonsai</code>åŒ…ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>åŠ è½½RåŒ…å’Œæ•°æ®</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">åŠ è½½RåŒ…å’Œæ•°æ®ï¼Œè¿™æ˜¯ä¸€ä¸ª3åˆ†ç±»çš„æ•°æ®ï¼Œå…¶ä¸­<code>species</code>æ˜¯ç»“æœå˜é‡ï¼Œå› å­å‹ï¼Œå…¶ä½™å˜é‡æ˜¯é¢„æµ‹å˜é‡ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>library</span>(tidymodels)<br><span>library</span>(bonsai)<br><span>library</span>(modeldata)<br><span>library</span>(ggplot2)<br><br>data(<span>"penguins"</span>)<br>str(penguins)<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â tibbleÂ [344Â Ã—Â 7]Â (S3:Â tbl_df/tbl/data.frame)</span><br><span>##Â Â $Â speciesÂ Â Â Â Â Â Â Â Â Â :Â FactorÂ w/Â 3Â levelsÂ "Adelie","Chinstrap",..:Â 1Â 1Â 1Â 1Â 1Â 1Â 1Â 1Â 1Â 1Â ...</span><br><span>##Â Â $Â islandÂ Â Â Â Â Â Â Â Â Â Â :Â FactorÂ w/Â 3Â levelsÂ "Biscoe","Dream",..:Â 3Â 3Â 3Â 3Â 3Â 3Â 3Â 3Â 3Â 3Â ...</span><br><span>##Â Â $Â bill_length_mmÂ Â Â :Â numÂ [1:344]Â 39.1Â 39.5Â 40.3Â NAÂ 36.7Â 39.3Â 38.9Â 39.2Â 34.1Â 42Â ...</span><br><span>##Â Â $Â bill_depth_mmÂ Â Â Â :Â numÂ [1:344]Â 18.7Â 17.4Â 18Â NAÂ 19.3Â 20.6Â 17.8Â 19.6Â 18.1Â 20.2Â ...</span><br><span>##Â Â $Â flipper_length_mm:Â intÂ [1:344]Â 181Â 186Â 195Â NAÂ 193Â 190Â 181Â 195Â 193Â 190Â ...</span><br><span>##Â Â $Â body_mass_gÂ Â Â Â Â Â :Â intÂ [1:344]Â 3750Â 3800Â 3250Â NAÂ 3450Â 3650Â 3625Â 4675Â 3475Â 4250Â ...</span><br><span>##Â Â $Â sexÂ Â Â Â Â Â Â Â Â Â Â Â Â Â :Â FactorÂ w/Â 2Â levelsÂ "female","male":Â 2Â 1Â 1Â NAÂ 1Â 2Â 1Â 2Â NAÂ NAÂ ...</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ä¹‹å‰æˆ‘ä»¬ä¹Ÿä»‹ç»è¿‡ï¼Œ<code>tidymodels</code>æ”¯æŒçš„æ¨¡å‹çœŸçš„å¾ˆæœ‰é™ï¼Œæ¯”å¦‚å¸¸è§çš„<code>lightGBM</code>å®ƒå°±ä¸æ”¯æŒã€‚ã€‚ã€‚å¯¹äºæå‡æ ‘æ¨¡å‹ï¼Œå®ƒç›®å‰åªæ”¯æŒä»¥ä¸‹5ä¸ªå¼•æ“ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>#Â åŠ è½½bonsaiä¹‹åæ˜¯7ä¸ª</span><br>show_engines(<span>'boost_tree'</span>)<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â AÂ tibble:Â 7Â Ã—Â 2</span><br><span>##Â Â Â engineÂ Â Â modeÂ Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â Â &lt;chr&gt;Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â </span><br><span>##Â 1Â xgboostÂ Â classification</span><br><span>##Â 2Â xgboostÂ Â regressionÂ Â Â Â </span><br><span>##Â 3Â C5.0Â Â Â Â Â classification</span><br><span>##Â 4Â sparkÂ Â Â Â classification</span><br><span>##Â 5Â sparkÂ Â Â Â regressionÂ Â Â Â </span><br><span>##Â 6Â lightgbmÂ regressionÂ Â Â Â </span><br><span>##Â 7Â lightgbmÂ classification</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">é™¤æ­¤ä¹‹å¤–ï¼Œ<code>catboost</code>ç›®å‰è¿˜æ˜¯ä¸æ”¯æŒçš„ï¼Œä¹‹å‰çš„<code>treesnip</code>åŒæ—¶æ”¯æŒ<code>catboost</code>å’Œ<code>lightGBM</code>ï¼Œä½†æ˜¯ç°åœ¨<code>treesnip</code>å·²ç»åœæ­¢ç»´æŠ¤äº†ï¼Œå¹¶è¢«<code>bonsai</code>å–ä»£ï¼Œä½†æ˜¯<code>bonsai</code>ç›®å‰å¹¶ä¸æ”¯æŒ<code>catboost</code>ï¼ˆå› ä¸ºcatboostç›®å‰å¹¶ä¸åœ¨CRANï¼‰ã€‚å®˜æ–¹è¯´å¤§æ¦‚3ä¸ªæœˆåæ”¯æŒ<code>catboost</code>ï¼ˆç°åœ¨æ˜¯20231115ï¼‰ã€‚</p><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>æ¨¡å‹è®¾å®š</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬è¦è®¾ç½®å¥½å“ªäº›è¶…å‚æ•°éœ€è¦è¿›è¡Œè°ƒä¼˜ï¼Œè¿™äº›è¶…å‚æ•°å’Œxgboostå¤ªåƒäº†ï¼Œæ‰€ä»¥æ²¡è¯¦ç»†ä»‹ç»ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒ<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247500668&amp;idx=1&amp;sn=7e035408d7073448eb7fcc55d78d9993&amp;scene=21#wechat_redirect" data-linktype="2">xgboostè¶…å‚æ•°è°ƒä¼˜</a>ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_lightÂ &lt;-Â boost_tree(treesÂ =Â <span>1000</span>,Â mtryÂ =Â tune(),Â tree_depthÂ =Â tune(),Â Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â learn_rateÂ =Â tune(),Â min_nÂ =Â tune(),Â <br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â loss_reductionÂ =Â tune())Â %&gt;%<br>Â Â set_engine(<span>"lightgbm"</span>,objectiveÂ =Â <span>"multiclass"</span>,num_class=<span>3</span>)Â %&gt;%<br>Â Â set_mode(<span>"classification"</span>)<br><br>bt_light<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â BoostedÂ TreeÂ ModelÂ SpecificationÂ (classification)</span><br><span>##Â </span><br><span>##Â MainÂ Arguments:</span><br><span>##Â Â Â mtryÂ =Â tune()</span><br><span>##Â Â Â treesÂ =Â 1000</span><br><span>##Â Â Â min_nÂ =Â tune()</span><br><span>##Â Â Â tree_depthÂ =Â tune()</span><br><span>##Â Â Â learn_rateÂ =Â tune()</span><br><span>##Â Â Â loss_reductionÂ =Â tune()</span><br><span>##Â </span><br><span>##Â Engine-SpecificÂ Arguments:</span><br><span>##Â Â Â objectiveÂ =Â multiclass</span><br><span>##Â Â Â num_classÂ =Â 3</span><br><span>##Â </span><br><span>##Â ComputationalÂ engine:Â lightgbm</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å»ºç«‹å·¥ä½œæµ</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">æ¥ä¸‹æ¥æ˜¯å»ºç«‹å·¥ä½œæµï¼Œå³ä½¿æ˜¯æ²¡æœ‰ä»»ä½•é¢„å¤„ç†æ­¥éª¤ï¼Œä¹Ÿæ¨èä½ ä½¿ç”¨å·¥ä½œæµï¼Œç›®å‰<code>tidymodels</code>åœ¨å¼ºæ¨å·¥ä½œæµï¼Œåœ¨å¾ˆå¤šæ—¶å€™ç¡®å®æ›´åŠ æ–¹ä¾¿ï¼Œè¯­æ³•ä¹Ÿæ›´åŠ ç»Ÿä¸€ã€å¥½è®°å¿†ã€‚</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_wfÂ &lt;-Â workflow()Â %&gt;%Â <br>Â Â add_formula(speciesÂ ~Â .)Â %&gt;%Â <br>Â Â add_model(bt_light)<br>bt_wf<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â â•â•Â WorkflowÂ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><br><span>##Â Preprocessor:Â Formula</span><br><span>##Â Model:Â boost_tree()</span><br><span>##Â </span><br><span>##Â â”€â”€Â PreprocessorÂ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span>##Â speciesÂ ~Â .</span><br><span>##Â </span><br><span>##Â â”€â”€Â ModelÂ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span>##Â BoostedÂ TreeÂ ModelÂ SpecificationÂ (classification)</span><br><span>##Â </span><br><span>##Â MainÂ Arguments:</span><br><span>##Â Â Â mtryÂ =Â tune()</span><br><span>##Â Â Â treesÂ =Â 1000</span><br><span>##Â Â Â min_nÂ =Â tune()</span><br><span>##Â Â Â tree_depthÂ =Â tune()</span><br><span>##Â Â Â learn_rateÂ =Â tune()</span><br><span>##Â Â Â loss_reductionÂ =Â tune()</span><br><span>##Â </span><br><span>##Â Engine-SpecificÂ Arguments:</span><br><span>##Â Â Â objectiveÂ =Â multiclass</span><br><span>##Â Â Â num_classÂ =Â 3</span><br><span>##Â </span><br><span>##Â ComputationalÂ engine:Â lightgbm</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>ç½‘æ ¼è®¾å®š</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">é€‰æ‹©ä¸€ä¸ªç®€å•çš„æ‹‰ä¸è¶…ç«‹æ–¹ç½‘æ ¼ï¼Œè¿™ä¸ªæ¯”ä¼ ç»Ÿçš„ç½‘æ ¼æ›´æœ‰æœºä¼šè¦†ç›–å…¨éƒ¨çš„è¶…å‚æ•°ç©ºé—´ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>set.seed(<span>123</span>)<br>tree_gridÂ &lt;-Â grid_max_entropy(mtry(rangeÂ =Â c(<span>2L</span>,Â <span>6L</span>)),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tree_depth(),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â learn_rate(),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â min_n(),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â loss_reduction(),<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sizeÂ =Â <span>15</span>Â <span>#Â åªäº§ç”Ÿ15ä¸ªæ¨¡å‹é…ç½®</span><br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â )<br><span>#tree_grid</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>æ•°æ®åˆ’åˆ†</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">æ•°æ®åˆ’åˆ†é€‰æ‹©3æŠ˜äº¤å‰éªŒè¯ï¼Œæˆ‘è¿™é‡Œå¹¶æ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†æµ‹è¯•é›†ï¼Œæœ‰éœ€è¦çš„è‡ªå·±åˆ†ä¸€ä¸‹å³å¯ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>set.seed(<span>123</span>)<br>bt_foldsÂ &lt;-Â vfold_cv(penguins,Â v=<span>3</span>)<br>bt_folds<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â Â 3-foldÂ cross-validationÂ </span><br><span>##Â #Â AÂ tibble:Â 3Â Ã—Â 2</span><br><span>##Â Â Â splitsÂ Â Â Â Â Â Â Â Â Â Â Â idÂ Â Â </span><br><span>##Â Â Â &lt;list&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;chr&gt;</span><br><span>##Â 1Â &lt;splitÂ [229/115]&gt;Â Fold1</span><br><span>##Â 2Â &lt;splitÂ [229/115]&gt;Â Fold2</span><br><span>##Â 3Â &lt;splitÂ [230/114]&gt;Â Fold3</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>å¼€å§‹è°ƒå‚</span><span></span></h2><pre data-tool="mdniceç¼–è¾‘å™¨"><code>set.seed(<span>123</span>)<br>bt_tuneÂ &lt;-Â tune_grid(bt_wf,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â bt_folds,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â gridÂ =Â tree_grid,<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â controlÂ =Â control_grid(save_predÂ =Â <span>T</span>,verboseÂ =Â <span>F</span>)<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â )<br><span>#save(bt_tune,fileÂ =Â "../000æœºå™¨å­¦ä¹ /bt_tune.rdata")</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>ç»“æœæ¢ç´¢</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">æŸ¥çœ‹è®­ç»ƒç»“æœï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>load(fileÂ =Â <span>"../000æœºå™¨å­¦ä¹ /bt_tune.rdata"</span>)<br><br>bt_tuneÂ %&gt;%Â collect_metrics()<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â AÂ tibble:Â 30Â Ã—Â 11</span><br><span>##Â Â Â Â Â mtryÂ min_nÂ tree_depthÂ learn_rateÂ loss_reductionÂ .metricÂ Â .estimatorÂ Â mean</span><br><span>##Â Â Â Â &lt;int&gt;Â &lt;int&gt;Â Â Â Â Â Â &lt;int&gt;Â Â Â Â Â Â &lt;dbl&gt;Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;Â &lt;chr&gt;Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â &lt;dbl&gt;</span><br><span>##Â Â 1Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7Â Â Â 1.38e-Â 8Â Â Â Â Â Â Â 4.81e-Â 1Â accuracyÂ multiclassÂ 0.442</span><br><span>##Â Â 2Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7Â Â Â 1.38e-Â 8Â Â Â Â Â Â Â 4.81e-Â 1Â roc_aucÂ Â hand_tillÂ Â 0.989</span><br><span>##Â Â 3Â Â Â Â Â 3Â Â Â Â 12Â Â Â Â Â Â Â Â Â Â 1Â Â Â 4.19e-10Â Â Â Â Â Â Â 1.26e-Â 5Â accuracyÂ multiclassÂ 0.442</span><br><span>##Â Â 4Â Â Â Â Â 3Â Â Â Â 12Â Â Â Â Â Â Â Â Â Â 1Â Â Â 4.19e-10Â Â Â Â Â Â Â 1.26e-Â 5Â roc_aucÂ Â hand_tillÂ Â 0.989</span><br><span>##Â Â 5Â Â Â Â Â 2Â Â Â Â 11Â Â Â Â Â Â Â Â Â Â 5Â Â Â 7.76e-Â 6Â Â Â Â Â Â Â 2.64e-Â 4Â accuracyÂ multiclassÂ 0.442</span><br><span>##Â Â 6Â Â Â Â Â 2Â Â Â Â 11Â Â Â Â Â Â Â Â Â Â 5Â Â Â 7.76e-Â 6Â Â Â Â Â Â Â 2.64e-Â 4Â roc_aucÂ Â hand_tillÂ Â 0.992</span><br><span>##Â Â 7Â Â Â Â Â 3Â Â Â Â 10Â Â Â Â Â Â Â Â Â 13Â Â Â 3.60e-Â 3Â Â Â Â Â Â Â 2.62e-Â 3Â accuracyÂ multiclassÂ 0.983</span><br><span>##Â Â 8Â Â Â Â Â 3Â Â Â Â 10Â Â Â Â Â Â Â Â Â 13Â Â Â 3.60e-Â 3Â Â Â Â Â Â Â 2.62e-Â 3Â roc_aucÂ Â hand_tillÂ Â 0.997</span><br><span>##Â Â 9Â Â Â Â Â 5Â Â Â Â Â 4Â Â Â Â Â Â Â Â Â Â 5Â Â Â 1.11e-Â 7Â Â Â Â Â Â Â 4.83e-10Â accuracyÂ multiclassÂ 0.442</span><br><span>##Â 10Â Â Â Â Â 5Â Â Â Â Â 4Â Â Â Â Â Â Â Â Â Â 5Â Â Â 1.11e-Â 7Â Â Â Â Â Â Â 4.83e-10Â roc_aucÂ Â hand_tillÂ Â 0.988</span><br><span>##Â #Â â„¹Â 20Â moreÂ rows</span><br><span>##Â #Â â„¹Â 3Â moreÂ variables:Â nÂ &lt;int&gt;,Â std_errÂ &lt;dbl&gt;,Â .configÂ &lt;chr&gt;</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç»“æœå¯è§†åŒ–ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>autoplot(bt_tune)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017232" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXphYm9njb81gGfv3SBVwNnjhyPic7vcALcn1Q3ysVPuCoPqGrgjzzx40w/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXphYm9njb81gGfv3SBVwNnjhyPic7vcALcn1Q3ysVPuCoPqGrgjzzx40w/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-9</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">æŸ¥çœ‹é¢„æµ‹ç»“æœï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_tuneÂ %&gt;%Â <br>Â Â collect_predictions()<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â AÂ tibble:Â 5,160Â Ã—Â 13</span><br><span>##Â Â Â Â idÂ Â Â Â .pred_AdelieÂ .pred_ChinstrapÂ .pred_GentooÂ Â .rowÂ Â mtryÂ min_nÂ tree_depth</span><br><span>##Â Â Â Â &lt;chr&gt;Â Â Â Â Â Â Â Â &lt;dbl&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;Â Â Â Â Â Â Â Â &lt;dbl&gt;Â &lt;int&gt;Â &lt;int&gt;Â &lt;int&gt;Â Â Â Â Â Â &lt;int&gt;</span><br><span>##Â Â 1Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â Â 5Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 2Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â Â 7Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 3Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â Â 8Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 4Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â Â 9Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 5Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 12Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 6Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 13Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 7Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 17Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 8Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 19Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â Â 9Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 22Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â 10Â Fold1Â Â Â Â Â Â Â Â 0.428Â Â Â Â Â Â Â Â Â Â Â 0.210Â Â Â Â Â Â Â Â 0.362Â Â Â Â 25Â Â Â Â Â 4Â Â Â Â 31Â Â Â Â Â Â Â Â Â Â 7</span><br><span>##Â #Â â„¹Â 5,150Â moreÂ rows</span><br><span>##Â #Â â„¹Â 5Â moreÂ variables:Â learn_rateÂ &lt;dbl&gt;,Â loss_reductionÂ &lt;dbl&gt;,</span><br><span>##Â #Â Â Â .pred_classÂ &lt;fct&gt;,Â speciesÂ &lt;fct&gt;,Â .configÂ &lt;chr&gt;</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ç”»ä¸ª3åˆ†ç±»çš„ROCæ›²çº¿(ä¸ä¼šçš„å¯å‚è€ƒå†å²æ¨æ–‡<a href="https://mp.weixin.qq.com/s?__biz=MzUzOTQzNzU0NA==&amp;mid=2247500640&amp;idx=1&amp;sn=d8e0e2b58bd2549bbf2c9d0b3eb03269&amp;scene=21#wechat_redirect" data-linktype="2">Rè¯­è¨€å¤šåˆ†ç±»ROCæ›²çº¿ç»˜åˆ¶</a>)ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_tuneÂ %&gt;%Â <br>Â Â collect_predictions()Â %&gt;%Â <br>Â Â roc_curve(species,Â .pred_Adelie:.pred_Gentoo)Â %&gt;%Â <br>Â Â ggplot(aes(<span>1</span>Â -Â specificity,Â sensitivity,Â colorÂ =Â .level))Â +<br>Â Â geom_abline(ltyÂ =Â <span>2</span>,Â colorÂ =Â <span>"gray80"</span>,Â linewidthÂ =Â <span>1.5</span>)Â +<br>Â Â geom_path(alphaÂ =Â <span>0.8</span>,Â linewidthÂ =Â <span>1</span>)Â +<br>Â Â coord_equal()Â +<br>Â Â labs(colorÂ =Â <span>NULL</span>)<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017231" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpSNSD5v9BY656SCRWXEfZvOY9kiabFPhZ7RXKJlvIiaGQcvZmAccY7JFA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpSNSD5v9BY656SCRWXEfZvOY9kiabFPhZ7RXKJlvIiaGQcvZmAccY7JFA/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-11</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">ä¹Ÿå¯ä»¥ä½¿ç”¨<code>autoplot</code>ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_tuneÂ %&gt;%Â <br>Â Â collect_predictions()Â %&gt;%Â <br>Â Â roc_curve(species,Â .pred_Adelie:.pred_Gentoo)Â %&gt;%Â <br>Â Â autoplot()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017229" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpkiaicRmRABfbnDbdslzZVHcu5ICjUBt9sO6CLb2iaEqlkJyQjHmInt4Pg/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpkiaicRmRABfbnDbdslzZVHcu5ICjUBt9sO6CLb2iaEqlkJyQjHmInt4Pg/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-12</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">ç»˜åˆ¶æ··æ·†çŸ©é˜µï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_tuneÂ %&gt;%Â <br>Â Â collect_predictions()Â %&gt;%<br>Â Â conf_mat(species,Â .pred_class)Â %&gt;%<br>Â Â autoplot()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017228" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpD8g9icvFqqNvuyawgm5rZ564S08ibCp9iaKSo0Qg5Kc1Tzj3W2yz6c4VA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpD8g9icvFqqNvuyawgm5rZ564S08ibCp9iaKSo0Qg5Kc1Tzj3W2yz6c4VA/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-13</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">æŸ¥çœ‹è¡¨ç°æœ€å¥½çš„è¶…å‚æ•°ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_bestÂ &lt;-Â bt_tuneÂ %&gt;%Â <br>Â Â select_best(<span>"roc_auc"</span>)<br><br>bt_best<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â AÂ tibble:Â 1Â Ã—Â 6</span><br><span>##Â Â Â Â mtryÂ min_nÂ tree_depthÂ learn_rateÂ loss_reductionÂ .configÂ Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â Â Â &lt;int&gt;Â &lt;int&gt;Â Â Â Â Â Â &lt;int&gt;Â Â Â Â Â Â &lt;dbl&gt;Â Â Â Â Â Â Â Â Â Â &lt;dbl&gt;Â &lt;chr&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span><br><span>##Â 1Â Â Â Â Â 3Â Â Â Â 10Â Â Â Â Â Â Â Â Â 13Â Â Â Â 0.00360Â Â Â Â Â Â Â Â 0.00262Â Preprocessor1_Model04</span><br></code></pre><h2 data-tool="mdniceç¼–è¾‘å™¨"><span></span><span>é‡æ–°æ‹Ÿåˆ</span><span></span></h2><p data-tool="mdniceç¼–è¾‘å™¨">é€‰æ‹©æœ€å¥½çš„å‚æ•°ï¼Œé‡æ–°æ‹Ÿåˆæ¨¡å‹</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_fitÂ &lt;-Â bt_wfÂ %&gt;%Â <br>Â Â finalize_workflow(bt_best)Â %&gt;%Â <br>Â Â fit(penguins)<br>bt_fit<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â â•â•Â WorkflowÂ [trained]Â â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><br><span>##Â Preprocessor:Â Formula</span><br><span>##Â Model:Â boost_tree()</span><br><span>##Â </span><br><span>##Â â”€â”€Â PreprocessorÂ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span>##Â speciesÂ ~Â .</span><br><span>##Â </span><br><span>##Â â”€â”€Â ModelÂ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span>##Â LightGBMÂ ModelÂ (1000Â trees)</span><br><span>##Â Objective:Â multiclassÂ (3Â classes)</span><br><span>##Â FittedÂ toÂ datasetÂ withÂ 6Â columns</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">æŸ¥çœ‹å˜é‡é‡è¦æ€§ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>library</span>(vip)<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code>bt_fitÂ %&gt;%Â <br>Â Â extract_fit_parsnip()Â %&gt;%<br>Â Â vip()<br></code></pre><figure data-tool="mdniceç¼–è¾‘å™¨"><img data-imgfileid="100017230" data-ratio="1" data-type="png" data-w="504" data-src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpsibJrntF9SeMz99pdr6F9BILBdyyQibbicLqzhLEgibjSiajcibDiaBLke4Lw/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/tpAC6lR84Ricwn6kRpod6bPVZ4hblpkXpsibJrntF9SeMz99pdr6F9BILBdyyQibbicLqzhLEgibjSiajcibDiaBLke4Lw/640?wx_fmt=png&amp;from=appmsg"><figcaption>plot of chunk unnamed-chunk-16</figcaption></figure><p data-tool="mdniceç¼–è¾‘å™¨">é¢„æµ‹æ–°çš„æ•°æ®ï¼š</p><pre data-tool="mdniceç¼–è¾‘å™¨"><code>new_dataÂ &lt;-Â head(penguins)<br><br>predict(bt_fit,Â new_dataÂ =Â new_data)<br></code></pre><pre data-tool="mdniceç¼–è¾‘å™¨"><code><span>##Â #Â AÂ tibble:Â 6Â Ã—Â 1</span><br><span>##Â Â Â .pred_class</span><br><span>##Â Â Â &lt;fct&gt;Â Â Â Â Â Â </span><br><span>##Â 1Â AdelieÂ Â Â Â Â </span><br><span>##Â 2Â AdelieÂ Â Â Â Â </span><br><span>##Â 3Â AdelieÂ Â Â Â Â </span><br><span>##Â 4Â AdelieÂ Â Â Â Â </span><br><span>##Â 5Â AdelieÂ Â Â Â Â </span><br><span>##Â 6Â Adelie</span><br></code></pre><p data-tool="mdniceç¼–è¾‘å™¨">ä¸€å¥—æ‰“å®Œï¼Œç»“æŸï¼</p><p data-tool="mdniceç¼–è¾‘å™¨">å¯¹<code>tidymodels</code>å„ç§ç”¨æ³•è¿˜ä¸ç†Ÿæ‚‰çš„å¯åœ¨åå°ä¼šå›å¤<strong>tidymodels</strong>è·å–ç›¸å…³åˆé›†ã€‚å›å¤<strong>lightgbm</strong>å¯è·å–ç›¸å…³æ¨æ–‡åˆé›†ã€‚</p></section><p><span><br></span></p><hr><blockquote><p><span><strong>è”ç³»æˆ‘ä»¬ï¼Œå…³æ³¨æˆ‘ä»¬</strong></span></p><ol><li><section>å…è´¹QQäº¤æµç¾¤1ï¼š613637742</section></li><li><section>å…è´¹QQäº¤æµç¾¤2ï¼š608720452</section></li><li><section>å…¬ä¼—å·æ¶ˆæ¯ç•Œé¢å…³äºä½œè€…è·å–è”ç³»æ–¹å¼</section></li><li><section>çŸ¥ä¹ã€CSDNã€ç®€ä¹¦åŒåè´¦å·</section></li><li><section>å“”å“©å“”å“©ï¼šé˜¿è¶Šå°±æ˜¯æˆ‘</section></li></ol></blockquote></section></section></section></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/jICU30gQlWFbtXR7tHjClA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
