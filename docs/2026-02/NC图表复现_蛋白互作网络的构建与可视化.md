---
title: "NC图表复现：蛋白互作网络的构建与可视化"
date: 2026-02-25T14:16:22Z
draft: ["false"]
tags: [
  "fetched",
  "R语言数据分析指南"
]
categories: ["Acdemic"]
---
NC图表复现：蛋白互作网络的构建与可视化 by R语言数据分析指南
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">欢迎关注R语言数据分析指南</span></span><span></span></h3><blockquote><span><span leaf="">❝</span></span><p><span leaf="">本节来复现NC一篇论文中的蛋白互作网络图，数据来源于原文同时作者还提供了对应的代码，但是得到的结果与原图差距较大。小编根据自己对个人对数据的理解来进行代码编写及绘图，与原文有所不同，个人理解仅供参考。</span></p></blockquote><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">论文信息</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">Multiomics insights into eating time patterns and cardiovascular risk among Chinese children</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883od06Q1bU2We9HRyHibaQhoIiatPFaV4el958giba28OBkhDCQl14s9PXk31YV2syF60jHbvudDa9EuYKz8CxvQkfApCVF1jybYzZo/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.3907407407407407" data-type="png" data-w="1080" data-imgfileid="100056253" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883od06Q1bU2We9HRyHibaQhoIiatPFaV4el958giba28OBkhDCQl14s9PXk31YV2syF60jHbvudDa9EuYKz8CxvQkfApCVF1jybYzZo/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">Liu, Q., Chen, J., An, X. et al. Multiomics insights into eating time patterns and cardiovascular risk among Chinese children. Nat Commun 17, 1891 (2026). https://doi.org/10.1038/s41467-026-68617-8</span></p><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">论文原图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883oeVibBwFBcKicHpBc8rv4S2mriaSQLJKMiaD1u6icVjnqibpNJiciaBPHxWHF731vBoDLVJHianRWcEoCRnPPmPD7D4bev2MgF6cnwv5gZQ/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7268623024830699" data-type="png" data-w="886" data-imgfileid="100056256" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883oeVibBwFBcKicHpBc8rv4S2mriaSQLJKMiaD1u6icVjnqibpNJiciaBPHxWHF731vBoDLVJHianRWcEoCRnPPmPD7D4bev2MgF6cnwv5gZQ/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">复现图</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/4uxvYT883of3AbYqhKbJEnFAN4un2zUBbeMib7kAxlEK3YTkj65QpDsh1ia5uy3f9UWFPXKhYjCI08NG2S4tibJyqm3oWJjdYkPlIxdgZYT4FM/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.8666666666666667" data-type="png" data-w="1080" data-imgfileid="100056254" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/4uxvYT883of3AbYqhKbJEnFAN4un2zUBbeMib7kAxlEK3YTkj65QpDsh1ia5uy3f9UWFPXKhYjCI08NG2S4tibJyqm3oWJjdYkPlIxdgZYT4FM/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">论文代码</span></span><span></span></h3><p data-tool="mdnice编辑器"><strong><span leaf="">https://github.com/LQ-doctor/Eating-Time-Patterns</span></strong></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/4uxvYT883ocYCj7Ea7ulnD1nhqmibiaVxs0tCo1YutQUiacRbJIM4gkLTY7heEhzSmibhpJzvCfMM11ZHRfefQuF3adX5EWhAvSH3MqrLGzMuJc/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.7583333333333333" data-type="png" data-w="1080" data-imgfileid="100056257" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/4uxvYT883ocYCj7Ea7ulnD1nhqmibiaVxs0tCo1YutQUiacRbJIM4gkLTY7heEhzSmibhpJzvCfMM11ZHRfefQuF3adX5EWhAvSH3MqrLGzMuJc/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">代码展示</span></span><span></span></h3><pre data-tool="mdnice编辑器"><span data-cacheurl="" data-remoteid=""></span><code><span><span leaf="">library</span></span><span leaf="">(tidyverse)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggplot2)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(ggraph)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(igraph)</span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(tidygraph)</span><span leaf=""><br></span><span><span leaf=""># 读取并处理数据</span></span><span leaf=""><br></span><span leaf="">ppi_df &lt;- read_delim(</span><span leaf=""><br></span><span leaf="">  file = </span><span><span leaf="">"string_interactions.tsv"</span></span><span leaf="">,  </span><span leaf=""><br></span><span leaf="">  delim = </span><span><span leaf="">"\t"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">  col_names = </span><span><span leaf="">TRUE</span></span><span leaf="">)</span><span leaf=""><br></span><span><span leaf=""># 创建边列表</span></span><span leaf=""><br></span><span leaf="">edge_list &lt;- ppi_df %&gt;%</span><span leaf=""><br></span><span leaf="">  select(node1, node2, combined_score) %&gt;%</span><span leaf=""><br></span><span leaf="">  rename(from = node1,to = node2,</span><span leaf=""><br></span><span leaf="">    value = combined_score)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">graph_df &lt;- as_tbl_graph(edge_list) %&gt;%</span><span leaf=""><br></span><span leaf="">  tidygraph::mutate(</span><span leaf=""><br></span><span leaf="">    Popularity = centrality_degree(mode = </span><span><span leaf="">'all'</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">    Betweenness = centrality_betweenness(),</span><span leaf=""><br></span><span leaf="">    Degree = case_when(</span><span leaf=""><br></span><span leaf="">      Popularity &gt; </span><span><span leaf="">5</span></span><span leaf=""> ~ </span><span><span leaf="">"High"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">      </span><span><span leaf="">TRUE</span></span><span leaf=""> ~ </span><span><span leaf="">"Low"</span></span><span leaf="">)) %&gt;% </span><span leaf=""><br></span><span leaf="">  activate(edges) %&gt;%</span><span leaf=""><br></span><span leaf="">  mutate(Interaction = case_when(</span><span leaf=""><br></span><span leaf="">      value &gt; </span><span><span leaf="">0.8</span></span><span leaf=""> ~ </span><span><span leaf="">"Strong"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">      </span><span><span leaf="">TRUE</span></span><span leaf=""> ~ </span><span><span leaf="">"Weak"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">ggraph(graph_df, layout = </span><span><span leaf="">'linear'</span></span><span leaf="">, circular = </span><span><span leaf="">TRUE</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  geom_edge_arc(aes(color = Interaction, width = value/</span><span><span leaf="">1000</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  geom_node_point(aes(size = Popularity,fill = Degree),</span><span leaf=""><br></span><span leaf="">                  color = </span><span><span leaf="">"<a topic-id="mm2410ai-votoyj" data-topic="1">#000000</a>"</span></span><span leaf="">,alpha = </span><span><span leaf="">1</span></span><span leaf="">, shape = </span><span><span leaf="">21</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  geom_node_text(aes(label=name,x=x*</span><span><span leaf="">1.07</span></span><span leaf="">,y=y*</span><span><span leaf="">1.07</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                     angle=-((-node_angle(x,y)+</span><span><span leaf="">90</span></span><span leaf="">) %% </span><span><span leaf="">180</span></span><span leaf="">)+ </span><span><span leaf="">90</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">                     vjust=</span><span><span leaf="">0.5</span></span><span leaf="">,hjust=ifelse(x&gt;</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">0</span></span><span leaf="">,</span><span><span leaf="">1</span></span><span leaf="">)),size=</span><span><span leaf="">3</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  scale_edge_colour_manual(</span><span leaf=""><br></span><span leaf="">    values = c(</span><span><span leaf="">"Strong"</span></span><span leaf=""> = </span><span><span leaf="">"<a topic-id="mm2410ai-c2o4xj" data-topic="1">#E7298A</a>"</span></span><span leaf="">,</span><span><span leaf="">"Weak"</span></span><span leaf="">   = </span><span><span leaf="">"<a topic-id="mm2410ai-b200pp" data-topic="1">#F4A6B7</a>"</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  scale_edge_width(range = c(</span><span><span leaf="">0.1</span></span><span leaf="">, </span><span><span leaf="">1</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  scale_size_continuous(range = c(</span><span><span leaf="">1</span></span><span leaf="">, </span><span><span leaf="">8</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  scale_fill_manual(values = c(</span><span><span leaf="">"High"</span></span><span leaf=""> = </span><span><span leaf="">"<a topic-id="mm2410aj-dl0zx3" data-topic="1">#7FCDBB</a>"</span></span><span leaf="">,</span><span><span leaf="">"Low"</span></span><span leaf="">  = </span><span><span leaf="">"<a topic-id="mm2410aj-831n8x" data-topic="1">#F2F2F2</a>"</span></span><span leaf="">)) +</span><span leaf=""><br></span><span leaf="">  guides(size = </span><span><span leaf="">"none"</span></span><span leaf="">,edge_width = </span><span><span leaf="">"none"</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  labs(caption = </span><span><span leaf="">"Strong interaction: combined score &gt; 0.8"</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  coord_cartesian(clip=</span><span><span leaf="">"off"</span></span><span leaf="">) +</span><span leaf=""><br></span><span leaf="">  theme_graph() +</span><span leaf=""><br></span><span leaf="">  theme(legend.position = </span><span><span leaf="">"right"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">    plot.title = element_text(size = </span><span><span leaf="">14</span></span><span leaf="">, face = </span><span><span leaf="">"bold"</span></span><span leaf="">, hjust = </span><span><span leaf="">0.5</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">    legend.text = element_text(size =</span><span><span leaf="">12</span></span><span leaf="">,color=</span><span><span leaf="">"black"</span></span><span leaf="">),</span><span leaf=""><br></span><span leaf="">    plot.caption = element_text(vjust=</span><span><span leaf="">0</span></span><span leaf="">,hjust=</span><span><span leaf="">0.5</span></span><span leaf="">,color=</span><span><span leaf="">"black"</span></span><span leaf="">,size=</span><span><span leaf="">12</span></span><span leaf="">))</span><span leaf=""><br></span></code></pre><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">PlotCase介绍</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">PlotCase是小编近期开发完成的一款本地R图形案例知识库App，作为文档类的升级版在PlotCase中，每一个图表案例都不再是孤立的截图或代码片段，而是图表 + 数据 + 代码的完整组合：  数据与代码可直接下载，一键跳转RStudio即可运行复现，省去繁琐配置与反复查找的时间成本。 换句话说，你关注的只剩下分析本身，而不是“文件到底放哪了”。</span></p><p data-tool="mdnice编辑器"><span leaf="">为确保用户权益，该App使用一机一码的方式进行付费激活，。</span><strong><span leaf="">目前只支持Mac系统M芯片系列电脑，暂无windows版本。</span></strong><span leaf=""> 对此感兴趣的读者欢迎交流</span></p><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">安装激活</span></span><span></span></h3><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/4uxvYT883ofuibcnDX6gpx76pY1untPd6aY85OdZs1MwZuKv9FR4jsLs2TpEyna2Ougcx3uKFu3X7QOLwntVBdzwTV4G3rl96wl6Cl2g2xCM/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.6240740740740741" data-type="jpeg" data-w="1080" data-imgfileid="100056255" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/4uxvYT883ofuibcnDX6gpx76pY1untPd6aY85OdZs1MwZuKv9FR4jsLs2TpEyna2Ougcx3uKFu3X7QOLwntVBdzwTV4G3rl96wl6Cl2g2xCM/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883odIp0uiaYJSu6m2XzseVqD01Oib5wrm1iaV2XicwJno8hpwjtYiaznicxkJvnerqFg4QpgRf7IVOVRD6oZIX6XbZmSXDMz24c51uheuU/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.6416666666666667" data-type="png" data-w="1080" data-imgfileid="100056261" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883odIp0uiaYJSu6m2XzseVqD01Oib5wrm1iaV2XicwJno8hpwjtYiaznicxkJvnerqFg4QpgRf7IVOVRD6oZIX6XbZmSXDMz24c51uheuU/640?wx_fmt=png&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/4uxvYT883ofswADPqlYicsQGe93KBHQ0WupNAviaa3SUnAwmsZoicYrCgQCIbC4rDtHz6lQgEzY5XavsPsIw9cO5O39YPMRvpjkYePuAX1DNrM/640?wx_fmt=jpeg&amp;from=appmsg" data-ratio="0.6287037037037037" data-type="jpeg" data-w="1080" data-imgfileid="100056262" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/4uxvYT883ofswADPqlYicsQGe93KBHQ0WupNAviaa3SUnAwmsZoicYrCgQCIbC4rDtHz6lQgEzY5XavsPsIw9cO5O39YPMRvpjkYePuAX1DNrM/640?wx_fmt=jpeg&amp;from=appmsg"></span></figure><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883ofNGUSXTsOaWLPdxqGxC5UTQEYicpatNiaa4xY2d5G04AHhLkt3XaKrWrPYJus07KGcZS7fXHR6NDknIFlItWtWsFbsibKEXMnn2o/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.42962962962962964" data-type="png" data-w="1080" data-imgfileid="100056260" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/4uxvYT883ofNGUSXTsOaWLPdxqGxC5UTQEYicpatNiaa4xY2d5G04AHhLkt3XaKrWrPYJus07KGcZS7fXHR6NDknIFlItWtWsFbsibKEXMnn2o/640?wx_fmt=png&amp;from=appmsg"></span></figure><h3 data-cacheurl="" data-remoteid="" data-tool="mdnice编辑器"><span></span><span><span leaf="">关注下方公众号下回更新不迷路</span></span><span></span></h3><section nodeleaf=""><mp-common-profile data-pluginname="mpprofile" data-nickname="R语言数据分析指南" data-alias="YanJANtwo" data-from="0" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/EibnicgwScTAZF0rpeZII9Ltl26VbVagriczTria1fib3XgjwwHEHFjPzkmGpqWDVVHBSzhENictUM2iavAKiaM5lc9USw/0?wx_fmt=png" data-signature="R语言重症爱好者，喜欢绘制各种精美的图表，喜欢的小伙伴可以关注我，跟我一起学习" data-id="Mzg3MzQzNTYzMw==" data-is_biz_ban="0" data-service_type="1" data-verify_status="0"></mp-common-profile></section></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/IX8o_xLyyDIoX1UNJO6THA",target="_blank" rel="noopener noreferrer">原文链接</a>
