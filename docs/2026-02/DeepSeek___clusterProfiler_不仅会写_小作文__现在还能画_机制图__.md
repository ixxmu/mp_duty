---
title: "DeepSeek + clusterProfiler：不仅会写“小作文”，现在还能画“机制图”！"
date: 2026-02-04T16:18:14Z
draft: ["false"]
tags: [
  "fetched",
  "Y叔的代码与演化"
]
categories: ["Acdemic"]
---
DeepSeek + clusterProfiler：不仅会写“小作文”，现在还能画“机制图”！ by Y叔的代码与演化
------
<div><section data-plugin="note-to-mp"><blockquote><p><strong><span leaf="">导读</span></strong><span leaf="">：昨天我们介绍了 clusterProfiler 的“多智能体”模式，它能像生物学家一样为你解读富集结果。但文字终究是抽象的，为了让你在汇报时能直接甩出一张高大上的机制图，我们连夜加班，把“画图”功能也加上了！本文将带你体验如何用一行代码，将 AI 的推理逻辑转化为可视化的调控网络。</span></p></blockquote><hr><section><img alt="封面图：从文字报告到精美网络图的转化" data-ratio="1" data-w="1024" data-aistatus="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4lyEWvPrNWWAzxmRbQk7UQSFn4xxLqQu2fxFg1tyMAEp3ibEiafNKBtBt5PxrpO3MKkVia3RAEPF3ibAA/640?from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/MPBFtnFrw4lyEWvPrNWWAzxmRbQk7UQSFn4xxLqQu2fxFg1tyMAEp3ibEiafNKBtBt5PxrpO3MKkVia3RAEPF3ibAA/640?from=appmsg"></section><h2><span leaf="">只有文字的报告，是没有灵魂的</span></h2><p><span leaf="">在上一篇文章中，我们展示了 </span><code><span leaf="">interpret_agent()</span></code><span leaf=""> 如何利用 AI 帮你写出有理有据的生物学故事。很多小伙伴后台留言：“</span><strong><span leaf="">功能很强大，但老板说 PPT 里全是字不想看，能不能画个图？</span></strong><span leaf="">”</span></p><p><strong><span leaf="">痛点非常真实。</span></strong></p><p><span leaf="">以前，我们拿到 AI 提示的“关键驱动因子”和“互作关系”后，还得打开 BioRender 或 Illustrator，一个个把基因画上去，再连线、标颜色。这一折腾，半天又过去了。</span></p><p><strong><span leaf="">能不能让 AI 既然想明白了，顺便就把图也画了？</span></strong></p><h2><span leaf="">一行代码，图文并茂</span></h2><p><strong><span leaf="">答案是：能。</span></strong></p><p><span leaf="">在最新的 </span><code><span leaf="">clusterProfiler</span></code><span leaf=""> (v4.19.4.004) 中，我们为解读结果对象新增了 </span><code><span leaf="">plot()</span></code><span leaf=""> 方法。这不仅仅是一个简单的绘图函数，它是连接 </span><strong><span leaf="">AI 逻辑</span></strong><span leaf=""> 与 </span><strong><span leaf="">可视化展示</span></strong><span leaf=""> 的桥梁。</span></p><h3><span leaf="">核心黑科技：ggtangle</span></h3><p><span leaf="">为了实现这个功能，我们引入了一个全新的可视化底座——</span><code><span leaf="">ggtangle</span></code><span leaf="">。</span></p><p><span leaf="">这就好比给 AI 配了一套高级画笔。不同于传统的 </span><code><span leaf="">igraph</span></code><span leaf=""> 绘图，</span><code><span leaf="">ggtangle</span></code><span leaf=""> 继承了 </span><code><span leaf="">ggplot2</span></code><span leaf=""> 的语法哲学。这意味着生成的网络图不仅美观，而且</span><strong><span leaf="">完全可定制</span></strong><span leaf="">。</span></p><h2><span leaf="">实战演示：从 Story 到 Figure</span></h2><p><span leaf="">让我们回到昨天的场景。假设你已经运行了多智能体解读：</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li><li><section><span leaf="">4</span></section></li><li><section><span leaf="">5</span></section></li><li><section><span leaf="">6</span></section></li><li><section><span leaf="">7</span></section></li><li><section><span leaf="">8</span></section></li><li><section><span leaf="">9</span></section></li></ul><pre><code><span leaf="">library</span><span leaf="">(</span><span leaf="">clusterProfiler</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 1. 运行解读（开启 add_ppi 以获取网络证据）</span></span></code><code><span leaf="">res </span><span leaf="">&lt;-</span><span leaf=""> interpret_agent</span><span leaf="">(</span><span leaf="">edo</span><span leaf="">,</span><span leaf=""> </span></code><code><span leaf="">   context</span><span leaf="">=</span><span><span leaf="">"CD8+ T cell exhaustion in TME"</span></span><span leaf="">,</span><span leaf=""> </span></code><code><span leaf="">   add_ppi</span><span leaf="">=</span><span><span leaf="">TRUE</span></span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 2. 见证奇迹的时刻</span></span></code><code><span leaf="">plot</span><span leaf="">(</span><span leaf="">res</span><span leaf="">)</span></code></pre></section><h3><span leaf="">你将看到什么？</span></h3><p><span leaf="">屏幕上会立刻弹出一张</span><strong><span leaf="">精修调控网络图</span></strong><span leaf="">：</span></p><ul><li><section><strong><span leaf="">🔵 核心节点</span></strong><span leaf="">：AI 鉴定出的 Key Drivers（如 TOX, PDCD1）会作为网络的核心节点展示。</span></section></li><li><section><strong><span leaf="">🟢 激活关系</span></strong><span leaf="">：AI 推断出的促进/激活作用（Activation），线条自动显示为</span><strong><span leaf="">绿色</span></strong><span leaf="">。</span></section></li><li><section><strong><span leaf="">🔴 抑制关系</span></strong><span leaf="">：AI 推断出的抑制/阻滞作用（Inhibition），线条自动显示为</span><strong><span leaf="">红色</span></strong><span leaf="">。</span></section></li><li><section><strong><span leaf="">⚪ 其它互作</span></strong><span leaf="">：普通的蛋白结合关系则以灰色显示。</span></section></li></ul><blockquote><p><strong><span leaf="">从此，你不再需要对着文本脑补“E2F1 激活了 Cell Cycle”，图上画得清清楚楚。</span></strong></p></blockquote><hr><h2><span leaf="">为什么要用 ggtangle？</span></h2><p><span leaf="">你可能会问，R 语言里画网络的包那么多，为什么要用 </span><code><span leaf="">ggtangle</span></code><span leaf="">？</span></p><p><span leaf="">因为它是“</span><strong><span leaf="">长在 ggplot2 上</span></strong><span leaf="">”的。</span></p><p><span leaf="">这意味着，你可以像叠加图层一样，轻松修改这张图的样式：</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li><li><section><span leaf="">4</span></section></li><li><section><span leaf="">5</span></section></li><li><section><span leaf="">6</span></section></li><li><section><span leaf="">7</span></section></li><li><section><span leaf="">8</span></section></li><li><section><span leaf="">9</span></section></li><li><section><span leaf="">10</span></section></li><li><section><span leaf="">11</span></section></li></ul><pre><code><span><span leaf=""># 想要换个主题？没问题！</span></span></code><code><span leaf="">library</span><span leaf="">(</span><span leaf="">ggtangle</span><span leaf="">)</span></code><code><span leaf="">library</span><span leaf="">(</span><span leaf="">ggplot2</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span leaf="">p </span><span leaf="">&lt;-</span><span leaf=""> plot</span><span leaf="">(</span><span leaf="">res</span><span leaf="">)</span></code><code><span leaf=""><br></span></code><code><span><span leaf=""># 叠加自定义图层</span></span></code><code><span leaf="">p </span><span leaf="">+</span><span leaf=""> </span></code><code><span leaf="">  geom_node_text</span><span leaf="">(</span><span leaf="">aes</span><span leaf="">(</span><span leaf="">label </span><span leaf="">=</span><span leaf=""> name</span><span leaf="">)</span><span leaf="">,</span><span leaf=""> color </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">"red"</span></span><span leaf="">,</span><span leaf=""> fontface </span><span leaf="">=</span><span leaf=""> </span><span><span leaf="">"bold"</span></span><span leaf="">)</span><span leaf=""> </span><span leaf="">+</span><span leaf=""> </span></code><code><span leaf="">  theme_dark</span><span leaf="">(</span><span leaf="">)</span><span leaf=""> </span><span leaf="">+</span><span leaf=""> </span></code><code><span leaf="">  ggtitle</span><span leaf="">(</span><span><span leaf="">"AI 推断的耗竭 T 细胞调控机制"</span></span><span leaf="">)</span></code></pre></section><p><span leaf="">这种灵活性，是传统静态网络图无法比拟的。</span></p><h2><span leaf="">总结：闭环已成</span></h2><p><span leaf="">至此，</span><code><span leaf="">clusterProfiler</span></code><span leaf=""> 已经完成了一个从数据到洞察的完整闭环：</span></p><ol><li><section><strong><span leaf="">Enrichment</span></strong><span leaf="">: 算出显著通路（传统的强项）。</span></section></li><li><section><strong><span leaf="">Interpretation</span></strong><span leaf="">: 多智能体 AI 挖掘生物学意义（昨天的新功能）。</span></section></li><li><section><strong><span leaf="">Visualization</span></strong><span leaf="">: </span><code><span leaf="">ggtangle</span></code><span leaf=""> 将逻辑可视化（今天的新功能）。</span></section></li></ol><p><strong><span leaf="">数据 -&gt; 故事 -&gt; 图表</span></strong><span leaf="">，我们希望帮你省下每一个不必要的重复劳动环节，让你把时间花在真正的科学思考上。</span></p><hr><p><strong><span leaf="">🔥 尝鲜指南</span></strong><span leaf="">：</span><span leaf=""><br></span><span leaf="">目前该功能已在 </span><code><span leaf="">clusterProfiler</span></code><span leaf=""> 开发版上线。</span><span leaf=""><br></span><span leaf="">你需要安装 </span><code><span leaf="">ggtangle</span></code><span leaf=""> 包来解锁这一技能：</span></p><section><ul><li><section><span leaf="">1</span></section></li><li><section><span leaf="">2</span></section></li><li><section><span leaf="">3</span></section></li></ul><pre><code><span leaf="">install.packages</span><span leaf="">(</span><span><span leaf="">"ggtangle"</span></span><span leaf="">)</span></code><code><span><span leaf=""># 或者安装开发版</span></span></code><code><span><span leaf=""># remotes::install_github("YuLab-SMU/ggtangle")</span></span></code></pre></section><p><span leaf="">快去试试吧！如果画出了漂亮的机制图，记得在朋友圈晒一晒，这可能是第一张由 AI “构思并绘制”的生物学通路图哦！</span></p><p><strong><span leaf="">👇 关注我们，不仅有代码，还有科研的新范式！</span></strong></p></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/iDGF9qUMHsgZRs_4rk0jQQ",target="_blank" rel="noopener noreferrer">原文链接</a>
