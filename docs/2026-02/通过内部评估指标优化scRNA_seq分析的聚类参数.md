---
title: "通过内部评估指标优化scRNA-seq分析的聚类参数"
date: 2026-02-13T14:56:59Z
draft: ["false"]
tags: [
  "fetched",
  "生信菜鸟团"
]
categories: ["Acdemic"]
---
通过内部评估指标优化scRNA-seq分析的聚类参数 by 生信菜鸟团
------
<div><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-pm-slice="0 0 []"><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Go1sLc9TF8XrBTmlewapsGhkySrkH3TFcmxaMzKEFZVZTU0yDq2cYETTduxlssx2yYxATgU5UhFEgyZZX5JGGOyeOqDTlptSuTa5hGoTbSk/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.5324074074074074" data-type="png" data-w="1080" data-imgfileid="100055826" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Go1sLc9TF8XrBTmlewapsGhkySrkH3TFcmxaMzKEFZVZTU0yDq2cYETTduxlssx2yYxATgU5UhFEgyZZX5JGGOyeOqDTlptSuTa5hGoTbSk/640?wx_fmt=png&amp;from=appmsg"></span></figure><p data-tool="mdnice编辑器"><span leaf="">在 scRNA-seq 分析中，准确的细胞亚群识别对于许多下游分析而言至关重要，其中无监督聚类是识别细胞亚群的关键步骤。当前的主流聚类算法（如 Leiden、DESC ）依赖多个参数（如分辨率、n_neighbors、主成分数等），</span><strong><span leaf=""><span textstyle="">参数选择对聚类结果的影响十分显著</span></span></strong><span leaf="">。</span></p><p data-tool="mdnice编辑器"><span leaf="">在实际应用中，样本中存在的细胞类型通常是未知的，真实细胞类型标签通常</span><strong><span leaf=""><span textstyle="">不可用</span></span></strong><span leaf="">，无法直接使用外部指标（如 ARI、NMI）来评估聚类质量。</span></p><p data-tool="mdnice编辑器"><span leaf="">因此，本研究的核心问题就是</span><strong><span leaf=""><span textstyle="">探究不同聚类参数对细胞聚类准确性的影响</span></span></strong><span leaf="">，以及探索</span><strong><span leaf=""><span textstyle="">是否能用仅依赖数据本身的内部指标来预测聚类的准确性</span></span></strong><span leaf="">。</span></p><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">Workflow</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><strong><span leaf=""><span textstyle="">数据来源与预处理：</span></span></strong><span leaf="">三个公开数据集（肝脏、骨骼肌、肾皮质），每个数据集的都含有手工标注的真实细胞类型标签（从 CellTypist 数据库中获取）。按照原始数据集的比例，每个数据集子采样 20% 的细胞，重复 100 次。对每一次子采样，进行预处理（QC、Normalization、HVG、PCA），然后进行聚类。</span></p><p data-tool="mdnice编辑器"><strong><span leaf=""><span textstyle="">聚类与准确性计算：</span></span></strong><span leaf="">使用了两种聚类算法：</span><strong><span leaf="">Leiden</span></strong><span leaf=""> 和 </span><strong><span leaf="">DESC</span></strong><span leaf="">。其中，Leiden 算法是一种基于图的经典聚类方法，它通过构建邻近图来识别细胞群落，在通过主成分分析获得的低维空间中，计算细胞间的距离，然后连接 k 个最相似的细胞；DESC 算法则是使用深度神经网络构建从原始scRNA-seq数据到低维特征空间的非线性映射，在低维空间中每个细胞被迭代地重新定位到其最近的簇。在执行聚类时，系统地改变关键参数（如主成分数、最近邻数、分辨率、距离度量等），以生成多种不同的聚类结果。使用 CellTypist 对聚类结果进行自动注释，将 CellTypist 自动注释的标签与真实标签进行对比，计算出准确性。</span></p><p data-tool="mdnice编辑器"><strong><span leaf=""><span textstyle="">通过内部指标预测准确性：</span></span></strong><span leaf="">对于之前生成的所有聚类结果，首先计算 15 种内部评估指标，这些指标仅基于数据本身的分布和簇的紧密度/分离度来计算，不需要知道真实标签。使用</span><strong><span leaf=""><span textstyle="">弹性网络回归</span></span></strong><span leaf="">，将内部指标作为输入特征，将之前计算出的准确性作为预测目标。模型训练好后，就可以尝试仅用内部指标来预测准确性。通过数据集内部的交叉验证和跨数据集验证筛选出那些在不同条件下都能稳定预测准确性的内部指标。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/Go1sLc9TF8VDg2icf9zJtLbV7T6fcyHrg6ZuplPxwEVzSJYbqiaiaBictavUBSwATnq5JPicLuO9oY88uaLMJClyGhteJ5DrxNia02YBM0riaM5GHs/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.43148148148148147" data-type="png" data-w="1080" data-imgfileid="100055827" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/Go1sLc9TF8VDg2icf9zJtLbV7T6fcyHrg6ZuplPxwEVzSJYbqiaiaBictavUBSwATnq5JPicLuO9oY88uaLMJClyGhteJ5DrxNia02YBM0riaM5GHs/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">结果</span></span><span></span><span></span></h2><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">聚类参数对聚类准确性的影响</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">Leiden 算法设置了五个关键参数：主成分数（取值10, 20, 30, 50）；最近邻数（取值10, 20, 30）；分辨率（0.5, 0.8, 1.2）；方法（UMAP / Gauss）；距离度量（余弦 / 欧式）。DESC 算法有两个关键参数：最近邻数和分辨率，取值和 Leiden相同。对 Leiden 的五个分类变量和 DESC 的两个分类变量计算了稳健线性混合回归模型。</span></p><p data-tool="mdnice编辑器"><span leaf="">下图以网络图的形式展示了 Leiden 算法以及 DESC 算法中各个参数及其交互项对准确性的影响。节点代表不同的参数水平，边绿色表示正向影响（准确率提高），红色表示负向影响。边的粗细代表影响大小。</span></p><p data-tool="mdnice编辑器"><span leaf="">结果表明，使用UMAP方法生成邻域图和提高分辨率对提升准确性有积极影响。分辨率参数的影响因最近邻数量的减少而更加突出，这是因为图结构更稀疏且对局部变化更敏感，高分辨率能够更好地保留细胞间的精细关系。主成分数目受数据复杂性的高度影响，分析时建议多测试不同的主成分。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_jpg/Go1sLc9TF8UrHUXhDGcM2o3MNxh5xicKfElDTXW6eMYV8wUI03WPc2Ukd11xhwpoZ2MIer7NatC8yWu0vIJxDZ4puoeVVJongAl1KsmI4ZDU/640?wx_fmt=other&amp;from=appmsg" data-ratio="1.3731707317073172" data-type="other" data-w="410" data-imgfileid="100055825" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/Go1sLc9TF8UrHUXhDGcM2o3MNxh5xicKfElDTXW6eMYV8wUI03WPc2Ukd11xhwpoZ2MIer7NatC8yWu0vIJxDZ4puoeVVJongAl1KsmI4ZDU/640?wx_fmt=other&amp;from=appmsg"></span></figure><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">找到最能稳定预测准确性的内部指标</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">弹性回归模型会把这些内部指标逐一评估，对预测准确性没什么帮助的指标，模型会直接把它们的权重设为 </span><strong><span leaf="">0</span></strong><span leaf="">；对预测准确性有帮助的指标，模型会保留它们，并赋予</span><strong><span leaf="">非 0 的权重</span></strong><span leaf="">，数值越大表示这个指标越重要。</span></p><p data-tool="mdnice编辑器"><span leaf="">图中，上半部分是数据集内部的方法，下半部分是跨数据集的方法。结果表明，</span><strong><span leaf="">Banfield-Raftery</span></strong><span leaf=""> 和 </span><strong><span leaf="">WC_Dispersion</span></strong><span leaf=""> 在多次测试中都稳定的保持非0，是稳健的内部指标。</span></p><figure data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/sz_mmbiz_png/Go1sLc9TF8UBq1TX1KEnbnIk9L7VTWKUSPuFGia9gDU5bNFNwReM1JExaflcWsc6ptKibZsEqQRGTsYA6QnI0IxgY9BFMTY17jxIuWaGaicOJ4/640?wx_fmt=png&amp;from=appmsg" data-ratio="0.524074074074074" data-type="png" data-w="1080" data-imgfileid="100055828" data-aistatus="1" src="https://mmbiz.qpic.cn/sz_mmbiz_png/Go1sLc9TF8UBq1TX1KEnbnIk9L7VTWKUSPuFGia9gDU5bNFNwReM1JExaflcWsc6ptKibZsEqQRGTsYA6QnI0IxgY9BFMTY17jxIuWaGaicOJ4/640?wx_fmt=png&amp;from=appmsg"></span></figure><h2 data-tool="mdnice编辑器"><span></span><span><span leaf="">总结</span></span><span></span><span></span></h2><p data-tool="mdnice编辑器"><span leaf="">总的来说，这篇研究为无真实标签场景下的单细胞聚类分析提供了一种实用策略：借助 </span><strong><span leaf="">Banfield-Raftery</span></strong><span leaf=""> 和 </span><strong><span leaf="">WC_Dispersion</span></strong><span leaf=""> 两个内部指标，在参数选择的过程中可以快速评估聚类质量，从而获得更可靠、更贴近真实生物学结构的细胞分群结果，有助于降低聚类参数调优的盲目性。</span></p></section><section><span leaf=""><br></span></section><p><mp-style-type data-value="10000"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/V96uG4EumndGMY2REBm-zQ",target="_blank" rel="noopener noreferrer">原文链接</a>
