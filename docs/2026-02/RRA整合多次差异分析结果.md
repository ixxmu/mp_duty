---
title: "RRA整合多次差异分析结果"
date: 2026-02-01T06:12:04Z
draft: ["false"]
tags: [
  "fetched",
  "生信星球"
]
categories: ["Acdemic"]
---
RRA整合多次差异分析结果 by 生信星球
------
<div><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><p data-tool="mdnice编辑器"><span leaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png" data-ratio="1" data-type="png" data-w="64" width="20px" data-imgfileid="100013059" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHrDic8XGmJ0b7oibVJajb0emLBHSvuibGG49ooBgtaAibE3TNJ00iaHviaMtdIKQJfCwtUfuHicDImtSfIxg/640?wx_fmt=png"><span textstyle="">今天是生信星球陪你的第1068天</span></span></p><section data-tool="markdown2wechat编辑器" data-website="https://aizhuanqian.com" data-pm-slice="0 0 []"><p><span leaf="">公众号里的文章大多数需要编程基础，如果因为代码看不懂，而跟不上正文的节奏，可以来找我学习，相当于给自己一个新手保护期。 我的课程都是循环开课， 点进去咨询微信，随时可以报名↓</span></p></section><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497289&amp;idx=1&amp;sn=e87f24c3b353034b5719294cca0eb166&amp;scene=21#wechat_redirect" textvalue="生信入门&amp;数据挖掘线上直播课12月班" data-itemshowtype="11" linktype="text" data-linktype="2">生信入门&amp;数据挖掘线上直播课</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497024&amp;idx=2&amp;sn=8c8b240b5df1d3b2c2e29b17f407ee75&amp;scene=21#wechat_redirect" textvalue="生信新手保护学习小组长期报名中" data-itemshowtype="0" linktype="text" data-linktype="2">生信新手保护学习小组</a></span></p><p data-tool="mdnice编辑器"><span leaf=""><a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497395&amp;idx=1&amp;sn=9cac5ae851a792fa0b0ef0626dbe5d93&amp;scene=21#wechat_redirect" textvalue="单细胞数据分析不求人，从零开始系统学" data-itemshowtype="0" linktype="text" data-linktype="2">单细胞数据分析不求人，从零开始系统学</a></span></p><p><span leaf=""><br></span></p><p data-tool="mdnice编辑器"><span leaf="">之前演示了如何使用<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzU4NjU4ODQ2MQ==&amp;mid=2247497401&amp;idx=1&amp;sn=41027e52bce17bff8af80b1084601ad0&amp;scene=21#wechat_redirect" textvalue="meta分析" data-itemshowtype="0" linktype="text" data-linktype="2">meta分析</a>整合多次差异分析结果，本文演示如何用RRA算法整合。</span></p><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">1. 数据下载和整理</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">示例数据是从GEO数据库下载3个胃癌与癌旁样本的基因表达芯片数据，实际使用可以是芯片与转录组或者单细胞混搭，只要都是按照p值排好顺序的基因即可，上下调基因要分开整合。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 清理环境</span></span><span leaf=""><br></span><span leaf="">rm(list = ls())</span><span leaf=""><br></span><span><span leaf=""># 加载用于GEO数据下载和差异分析的包</span></span><span leaf=""><br></span><span><span leaf="">library</span></span><span leaf="">(tinyarray)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 将目标GEO数据集编号存入向量</span></span><span leaf=""><br></span><span leaf="">datasets = c(</span><span><span leaf="">"GSE19826"</span></span><span leaf="">, </span><span><span leaf="">"GSE54129"</span></span><span leaf="">, </span><span><span leaf="">"GSE79973"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 依次下载3个GEO数据集</span></span><span leaf=""><br></span><span><span leaf=""># geo_download函数会自动下载数据并解析为包含表达矩阵(exp)和样本信息(pd)的列表</span></span><span leaf=""><br></span><span leaf="">geo1 = geo_download(datasets[</span><span><span leaf="">1</span></span><span leaf="">])</span><span leaf=""><br></span><span leaf="">geo2 = geo_download(datasets[</span><span><span leaf="">2</span></span><span leaf="">])</span><span leaf=""><br></span><span leaf="">geo3 = geo_download(datasets[</span><span><span leaf="">3</span></span><span leaf="">])</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">根据各数据集表达矩阵的数值范围，判断是否需要进行对数转换。通常，如果表达值范围较大（跨数量级，0~几万、几十万之间），则说明数据未经log2转换。我们以0-20的范围作为判断标准，对超出此范围的数据进行log2(x+1)转换，用于差异分析。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 检查GSE19826的表达谱范围，发现数值较大，需进行log2转换</span></span><span leaf=""><br></span><span><span leaf=""># range(geo1$exp) </span></span><span leaf=""><br></span><span leaf="">exp1 = log2(geo1$exp + </span><span><span leaf="">1</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 其他两个数据集的表达值已在合理范围内，无需转换</span></span><span leaf=""><br></span><span leaf="">exp2 = geo2$exp</span><span leaf=""><br></span><span leaf="">exp3 = geo3$exp</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">2. 分组信息与探针注释</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">为每个数据集创建分组信息，明确区分“癌症”与“非癌”样本，并设置为因子类型，确保后续分析中“对照组在前，疾病组在后”。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">library</span></span><span leaf="">(stringr)</span><span leaf=""><br></span><span leaf=""><br></span><span leaf=""><br></span><span leaf="">Group1 = ifelse(str_detect(geo1$pd$`tissue type:ch1`, </span><span><span leaf="">"noncancer"</span></span><span leaf="">), </span><span><span leaf="">"noncancer"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Group1 = factor(Group1, levels = c(</span><span><span leaf="">"noncancer"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">table(Group1)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">## Group1</span></span><span leaf=""><br></span><span><span leaf="">## noncancer    cancer </span></span><span leaf=""><br></span><span><span leaf="">##        12        15</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">Group2 = ifelse(str_detect(geo2$pd$title, </span><span><span leaf="">"normal"</span></span><span leaf="">), </span><span><span leaf="">"normal"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Group2 = factor(Group2, levels = c(</span><span><span leaf="">"normal"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">table(Group2)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">## Group2</span></span><span leaf=""><br></span><span><span leaf="">## normal cancer </span></span><span leaf=""><br></span><span><span leaf="">##     21    111</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">Group3 = ifelse(str_detect(geo3$pd$source_name_ch1, </span><span><span leaf="">"mucosa"</span></span><span leaf="">), </span><span><span leaf="">"normal"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">Group3 = factor(Group3, levels = c(</span><span><span leaf="">"normal"</span></span><span leaf="">, </span><span><span leaf="">"cancer"</span></span><span leaf="">))</span><span leaf=""><br></span><span leaf="">table(Group3)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">## Group3</span></span><span leaf=""><br></span><span><span leaf="">## normal cancer </span></span><span leaf=""><br></span><span><span leaf="">##     10     10</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">获取芯片平台的探针注释信息，建立探针ID与基因符号（Gene Symbol）的对应关系。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">注意</span></strong><span leaf="">：本例中3个数据集均使用</span><code><span leaf="">GPL570 [hgu133plus2]</span></code><span leaf="">平台，因此可共用一套注释信息。在实际应用中，若数据集来自不同平台（GPL号不同），需要分别为每个平台获取注释，用在下面的get_deg函数中。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">library</span></span><span leaf="">(hgu133plus2.db)</span><span leaf=""><br></span><span leaf="">ids &lt;- toTable(hgu133plus2SYMBOL)</span><span leaf=""><br></span><span leaf="">head(ids)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">##    probe_id symbol</span></span><span leaf=""><br></span><span><span leaf="">## 1 1007_s_at   DDR1</span></span><span leaf=""><br></span><span><span leaf="">## 2   1053_at   RFC2</span></span><span leaf=""><br></span><span><span leaf="">## 3    117_at  HSPA6</span></span><span leaf=""><br></span><span><span leaf="">## 4    121_at   PAX8</span></span><span leaf=""><br></span><span><span leaf="">## 5 1255_g_at GUCA1A</span></span><span leaf=""><br></span><span><span leaf="">## 6   1294_at   UBA7</span></span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">3. 差异基因筛选与差异基因提取</span></span><span></span></h3><p data-tool="mdnice编辑器"><span leaf="">使用</span><code><span leaf="">tinyarray</span></code><span leaf="">包中的</span><code><span leaf="">get_deg</span></code><span leaf="">函数，对3个数据集分别进行差异表达分析。该函数整合了</span><code><span leaf="">limma</span></code><span leaf="">包的功能，能快速得到差异基因结果。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">deg1 = get_deg(exp1, Group1, ids, entriz = </span><span><span leaf="">F</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">head(deg1)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">##       logFC  AveExpr         t      P.Value adj.P.Val</span></span><span leaf=""><br></span><span><span leaf="">## 1 -2.380063 3.865782 -5.603020 5.505999e-06 0.1548921</span></span><span leaf=""><br></span><span><span leaf="">## 2 -1.025598 5.519599 -5.310656 1.216449e-05 0.2216978</span></span><span leaf=""><br></span><span><span leaf="">## 3 -1.995034 4.485646 -4.780629 5.148657e-05 0.3332432</span></span><span leaf=""><br></span><span><span leaf="">## 4  1.846215 5.252243  4.720927 6.057212e-05 0.3332432</span></span><span leaf=""><br></span><span><span leaf="">## 5 -1.911447 3.387338 -4.633209 7.689642e-05 0.3332432</span></span><span leaf=""><br></span><span><span leaf="">## 6 -2.101307 3.790645 -4.633087 7.692194e-05 0.3332432</span></span><span leaf=""><br></span><span><span leaf="">##          B   probe_id       symbol change</span></span><span leaf=""><br></span><span><span leaf="">## 1 3.044180 1555018_at        OR2C3   down</span></span><span leaf=""><br></span><span><span leaf="">## 2 2.464743 1554793_at        UBE3C   down</span></span><span leaf=""><br></span><span><span leaf="">## 3 1.393080  229094_at ATP6V0E2-AS1   down</span></span><span leaf=""><br></span><span><span leaf="">## 4 1.271127 1554810_at      PLA2G4C     up</span></span><span leaf=""><br></span><span><span leaf="">## 5 1.091645 1560557_at LOC105370549   down</span></span><span leaf=""><br></span><span><span leaf="">## 6 1.091395 1562973_at LOC101928201   down</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">deg2 = get_deg(exp2, Group2, ids, entriz = </span><span><span leaf="">F</span></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">deg3 = get_deg(exp3, Group3, ids, entriz = </span><span><span leaf="">F</span></span><span leaf="">)</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">为使代码更简洁、可读性更强，我们自定义</span><code><span leaf="">up</span></code><span leaf="">和</span><code><span leaf="">down</span></code><span leaf="">函数，用于从差异分析结果中快速提取上调和下调的基因列表。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 提取上调基因的函数</span></span><span leaf=""><br></span><span leaf="">up = </span><span><span leaf="">function</span></span><span leaf="">(deg) {</span><span leaf=""><br></span><span leaf="">  deg$symbol[deg$change == </span><span><span leaf="">"up"</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 提取下调基因的函数</span></span><span leaf=""><br></span><span leaf="">down = </span><span><span leaf="">function</span></span><span leaf="">(deg) {</span><span leaf=""><br></span><span leaf="">  deg$symbol[deg$change == </span><span><span leaf="">"down"</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">}</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">将各数据集的上调基因和下调基因分别整合到列表中（</span><code><span leaf="">uplist</span></code><span leaf="">和</span><code><span leaf="">downlist</span></code><span leaf="">）。</span><code><span leaf="">get_deg</span></code><span leaf="">的输出默认按p值排序，这恰好满足RRA算法对输入数据的要求（输入为排序好的基因列表）。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">uplist = list(up(deg1), up(deg2), up(deg3))</span><span leaf=""><br></span><span leaf="">downlist = list(down(deg1), down(deg2), down(deg3))</span><span leaf=""><br></span></code></pre><h3 data-tool="mdnice编辑器"><span></span><span><span leaf="">4. RRA整合</span></span><span></span></h3><h4 data-tool="mdnice编辑器"><span><span></span></span><span><span></span><span leaf="">RRA算法背景介绍</span></span><span><span></span></span></h4><p data-tool="mdnice编辑器"><span leaf="">在生物信息学分析中，单个研究的差异表达基因列表往往存在假阳性，且不同研究之间的结果重合度可能不高。这主要是由于样本异质性、批次效应、样本量不足或采用的分析平台不同等因素造成的。为了克服这些局限性，好的算法对多个数据集差异分析结果的整合至关重要。</span></p><p data-tool="mdnice编辑器"><strong><span leaf="">稳健排序聚合（Robust Rank Aggregation, RRA）</span></strong><span leaf=""> 是一种强大的Meta分析方法，专门用于整合多个排序后的基因列表（或其他元素列表）。它的核心思想是：如果一个基因在多个独立的分析中都 consistently（一致地）排在靠前的位置（即差异最显著），那么它是一个真正差异基因的可能性就远大于偶然。RRA算法会为每个基因计算一个Score值（类似于p值），这个值反映了其排序位置在多个列表中的一致性程度是否显著优于随机排序。通过这种方式，RRA能够筛选出在多个数据集中都表现稳健的候选基因，显著提升结果的可靠性。</span></p><h4 data-tool="mdnice编辑器"><span><span></span></span><span><span></span><span leaf="">执行RRA整合</span></span><span><span></span></span></h4><p data-tool="mdnice编辑器"><span leaf="">我们使用</span><code><span leaf="">RobustRankAggreg</span></code><span leaf="">包，分别对上调和下调基因列表进行RRA整合。同时，我们统计每个基因在所有数据集中出现的频率，并将其合并到RRA结果中，作为额外筛选标准。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf="">library</span></span><span leaf="">(RobustRankAggreg)</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 对上调基因列表进行RRA整合</span></span><span leaf=""><br></span><span leaf="">ups = aggregateRanks(glist = uplist, N = length(unique(unlist(uplist))))</span><span leaf=""><br></span><span><span leaf=""># 计算每个基因出现的频率</span></span><span leaf=""><br></span><span leaf="">freq1 = as.data.frame(table(unlist(uplist)))</span><span leaf=""><br></span><span><span leaf=""># 将频率信息添加到RRA结果中</span></span><span leaf=""><br></span><span leaf="">ups$Freq = freq1[match(ups$Name, freq1$Var1), </span><span><span leaf="">2</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">head(ups)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">##            Name        Score Freq</span></span><span leaf=""><br></span><span><span leaf="">## COL10A1 COL10A1 0.0003280513    3</span></span><span leaf=""><br></span><span><span leaf="">## SALL4     SALL4 0.0011799491    3</span></span><span leaf=""><br></span><span><span leaf="">## THY1       THY1 0.0029836957    3</span></span><span leaf=""><br></span><span><span leaf="">## BGN         BGN 0.0037554172    3</span></span><span leaf=""><br></span><span><span leaf="">## IGFBP4   IGFBP4 0.0044134300    3</span></span><span leaf=""><br></span><span><span leaf="">## COL5A2   COL5A2 0.0046833500    3</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 对下调基因列表进行RRA整合</span></span><span leaf=""><br></span><span leaf="">downs = aggregateRanks(glist = downlist, N = length(unique(unlist(downlist))))</span><span leaf=""><br></span><span><span leaf=""># 计算频率并添加</span></span><span leaf=""><br></span><span leaf="">freq2 = as.data.frame(table(unlist(downlist)))</span><span leaf=""><br></span><span leaf="">downs$Freq = freq2[match(downs$Name, freq2$Var1), </span><span><span leaf="">2</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">head(downs)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">##          Name        Score Freq</span></span><span leaf=""><br></span><span><span leaf="">## VSTM2A VSTM2A 0.0001592915    3</span></span><span leaf=""><br></span><span><span leaf="">## ERLN     ERLN 0.0006647707    3</span></span><span leaf=""><br></span><span><span leaf="">## PSAPL1 PSAPL1 0.0006774730    3</span></span><span leaf=""><br></span><span><span leaf="">## SMPD3   SMPD3 0.0013483127    3</span></span><span leaf=""><br></span><span><span leaf="">## ADH7     ADH7 0.0018878245    3</span></span><span leaf=""><br></span><span><span leaf="">## DISP1   DISP1 0.0026651509    3</span></span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">基于RRA整合结果筛选核心差异基因。这里我们设定筛选条件为：</span><code><span leaf="">Score &lt; 0.05</span></code><span leaf="">（统计上显著）且 </span><code><span leaf="">Freq &gt; 1</span></code><span leaf="">（至少在2个数据集中都被识别为差异基因）。这些阈值可根据实际需求进行调整。</span></p><pre data-tool="mdnice编辑器"><code><span leaf="">up_gene = ups$Name[ups$Score &lt; </span><span><span leaf="">0.05</span></span><span leaf=""> &amp; ups$Freq &gt; </span><span><span leaf="">1</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">length(up_gene)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">## [1] 35</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span leaf="">down_gene = downs$Name[downs$Score &lt; </span><span><span leaf="">0.05</span></span><span leaf=""> &amp; downs$Freq &gt; </span><span><span leaf="">1</span></span><span leaf="">]</span><span leaf=""><br></span><span leaf="">length(down_gene)</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">## [1] 86</span></span><span leaf=""><br></span></code></pre><h4 data-tool="mdnice编辑器"><span><span></span></span><span><span></span><span leaf="">5. 核心差异基因的可视化</span></span><span><span></span></span></h4><p data-tool="mdnice编辑器"><span leaf="">为了直观验证这些核心差异基因在各个数据集中的表达变化趋势是否一致，我们提取它们在3个数据集中的logFC值，构建矩阵并通过热图进行可视化。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 构建核心上调基因的logFC矩阵</span></span><span leaf=""><br></span><span leaf="">updat = data.frame(</span><span leaf=""><br></span><span leaf="">  deg1$logFC[match(up_gene, deg1$symbol)],</span><span leaf=""><br></span><span leaf="">  deg2$logFC[match(up_gene, deg2$symbol)],</span><span leaf=""><br></span><span leaf="">  deg3$logFC[match(up_gene, deg3$symbol)],</span><span leaf=""><br></span><span leaf="">  row.names = up_gene</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(updat) = datasets</span><span leaf=""><br></span><span leaf=""><br></span><span><span leaf=""># 构建核心下调基因的logFC矩阵</span></span><span leaf=""><br></span><span leaf="">downdat = data.frame(</span><span leaf=""><br></span><span leaf="">  deg1$logFC[match(down_gene, deg1$symbol)],</span><span leaf=""><br></span><span leaf="">  deg2$logFC[match(down_gene, deg2$symbol)],</span><span leaf=""><br></span><span leaf="">  deg3$logFC[match(down_gene, deg3$symbol)],</span><span leaf=""><br></span><span leaf="">  row.names = down_gene</span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span><span leaf="">colnames(downdat) = datasets</span><span leaf=""><br></span></code></pre><p data-tool="mdnice编辑器"><span leaf="">为了使热图清晰，我们选取RRA分析结果中最显著（排序最靠前）的10个上调基因和10个下调基因进行展示。</span></p><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 合并logFC矩阵</span></span><span leaf=""><br></span><span leaf="">dat = rbind(updat[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">10</span></span><span leaf="">, ], downdat[</span><span><span leaf="">1</span></span><span leaf="">:</span><span><span leaf="">10</span></span><span leaf="">, ])</span><span leaf=""><br></span><span leaf="">dat</span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf="">##           GSE19826    GSE54129  GSE79973</span></span><span leaf=""><br></span><span><span leaf="">## COL10A1   3.071534  2.15271981  4.462640</span></span><span leaf=""><br></span><span><span leaf="">## SALL4     2.607545  1.18278826  3.422764</span></span><span leaf=""><br></span><span><span leaf="">## THY1      1.342529  2.89722251  2.563030</span></span><span leaf=""><br></span><span><span leaf="">## BGN       1.709515  3.00616305  2.370870</span></span><span leaf=""><br></span><span><span leaf="">## IGFBP4    1.106299  3.39094842  1.004140</span></span><span leaf=""><br></span><span><span leaf="">## COL5A2    1.098713  1.55004533  1.951849</span></span><span leaf=""><br></span><span><span leaf="">## SPARC     1.186296  2.02695018  2.062874</span></span><span leaf=""><br></span><span><span leaf="">## CDH3      1.905570  1.17492855  3.227229</span></span><span leaf=""><br></span><span><span leaf="">## COL6A3    1.196825  2.59742060  2.058583</span></span><span leaf=""><br></span><span><span leaf="">## NID2      1.287962  1.85254663  2.278844</span></span><span leaf=""><br></span><span><span leaf="">## VSTM2A   -1.490487 -1.99546404 -3.848826</span></span><span leaf=""><br></span><span><span leaf="">## ERLN     -1.111827 -3.80918861 -2.682419</span></span><span leaf=""><br></span><span><span leaf="">## PSAPL1   -2.216413 -3.11882447 -4.934091</span></span><span leaf=""><br></span><span><span leaf="">## SMPD3    -1.018454 -2.53184664 -1.478866</span></span><span leaf=""><br></span><span><span leaf="">## ADH7     -1.448377 -3.21195574 -4.268211</span></span><span leaf=""><br></span><span><span leaf="">## DISP1    -1.027092 -1.77041055 -1.424939</span></span><span leaf=""><br></span><span><span leaf="">## ACER2    -1.792120 -4.42151077 -2.999481</span></span><span leaf=""><br></span><span><span leaf="">## SULT1B1  -1.246034 -2.12849222 -2.754854</span></span><span leaf=""><br></span><span><span leaf="">## DCAF12L1 -2.277390  0.03808734 -3.329189</span></span><span leaf=""><br></span><span><span leaf="">## RDH12    -2.105713 -2.51700831 -3.622408</span></span><span leaf=""><br></span></code></pre><pre data-tool="mdnice编辑器"><code><span><span leaf=""># 使用pheatmap绘制热图</span></span><span leaf=""><br></span><span leaf="">pheatmap::pheatmap(</span><span leaf=""><br></span><span leaf="">  dat,</span><span leaf=""><br></span><span leaf="">  cluster_cols = </span><span><span leaf="">F</span></span><span leaf="">,                   </span><span><span leaf=""># 不对列（数据集）进行聚类</span></span><span leaf=""><br></span><span leaf="">  display_numbers = </span><span><span leaf="">TRUE</span></span><span leaf="">,             </span><span><span leaf=""># 在热图上显示logFC数值</span></span><span leaf=""><br></span><span leaf="">  number_format = </span><span><span leaf="">"%.2f"</span></span><span leaf="">,             </span><span><span leaf=""># 数值格式化为两位小数</span></span><span leaf=""><br></span><span leaf="">  color = colorRampPalette(c(</span><span><span leaf="">"navy"</span></span><span leaf="">, </span><span><span leaf="">"white"</span></span><span leaf="">, </span><span><span leaf="">"firebrick3"</span></span><span leaf="">))(</span><span><span leaf="">50</span></span><span leaf="">) </span><span><span leaf=""># 设置颜色</span></span><span leaf=""><br></span><span leaf="">)</span><span leaf=""><br></span></code></pre><figure data-tool="mdnice编辑器"><span leaf=""><br></span></figure></section><section nodeleaf=""><img data-src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqmFQDiahPCfXFo830nwprJX7P3HxYZtgBEwTDGZEcicyfMwmkYIIC30sqBYzic96wyoRC25qS5wlWEw/640?wx_fmt=png&amp;from=appmsg" data-ratio="1" data-s="300,640" data-type="png" data-w="504" type="block" data-imgfileid="100013788" data-aistatus="1" src="https://mmbiz.qpic.cn/mmbiz_png/8oKPbJgbBHqmFQDiahPCfXFo830nwprJX7P3HxYZtgBEwTDGZEcicyfMwmkYIIC30sqBYzic96wyoRC25qS5wlWEw/640?wx_fmt=png&amp;from=appmsg"></section><p><mp-style-type data-value="3"></mp-style-type></p></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/dopEX6SuLExbM1A6fWC41A",target="_blank" rel="noopener noreferrer">原文链接</a>
