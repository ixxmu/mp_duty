---
title: "å•ç»†èƒç»˜å›¾ -- GSEA & GSVA"
date: 2022-10-05T09:12:51Z
draft: ["false"]
tags: [
  "fetched",
  "åŒ»å­¦åƒ§çš„ç§‘ç ”æ—¥è®°"
]
categories: ["Acdemic"]
---
å•ç»†èƒç»˜å›¾ -- GSEA & GSVA by åŒ»å­¦åƒ§çš„ç§‘ç ”æ—¥è®°
------
<div><p>~<span>å•ç»†èƒæ•°æ®ä¸­çš„åŸºå› é›†å¯Œé›†åˆ†æ~</span></p><p><iframe data-vidtype="2" data-mpvid="wxv_2604208849075617792" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FeBfvI7Ryx8egz8p73UyIWo4BeovL2zJHnVIwx466JxqxQSfSiciaiaiaJNzAEPQDZgavLksMolE9wGEEoO2ibnUK7gg%2F0%3Fwx_fmt%3Djpeg" allowfullscreen="" frameborder="0" data-ratio="1.7777777777777777" data-w="1920" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;action=mpvideo&amp;auto=0&amp;vid=wxv_2604208849075617792"></iframe></p><p><br></p><section data-id="93972" data-tools="135ç¼–è¾‘å™¨"><section><section><section><section><section><span>01</span></section></section><section><span><strong>å¼•è¨€</strong></span></section></section></section></section></section><section><br></section><section><span>GSEAã€GSVAæ˜¯æˆ‘ä»¬åœ¨è¿›è¡Œç»„é—´å¯¹æ¯”æ—¶å¸¸ç”¨çš„åŸºå› é›†å¯Œé›†åˆ†æï¼Œè€Œ</span>åœ¨å•ç»†èƒæ•°æ®ä¸­æˆ‘ä»¬åº”å¦‚ä½•å¤„ç†æ•°æ®å¹¶å®ç°å®ƒä»¬å‘¢ï¼Ÿ</section><section><br></section><section data-id="93972" data-tools="135ç¼–è¾‘å™¨"><section><section><section><section><section><span>02</span></section></section><section data-brushtype="text"><span><strong>Key Points</strong></span></section></section></section></section></section><section><br></section><section><span><strong>2.1 æ•°æ®å‡†å¤‡</strong></span></section><section>ä½¿ç”¨Â <a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwODIzOTExNw==&amp;mid=2247490300&amp;idx=1&amp;sn=74b6b4ad31b3682c2538792d13de5c65&amp;chksm=9b70bb9eac07328806e8872129954590cf2fb8ecc51d9d237753a7294caa29282a268472ee5d&amp;scene=21#wechat_redirect" textvalue="Seurat é‚£ç‚¹å„¿äº‹" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2" hasload="1">Seurat é‚£ç‚¹å„¿äº‹Â <span>çš„å•ç»†èƒæ•°æ®"scedata.rda"(å³Seurat</span></a>Â object data) è¿›è¡Œç¤ºä¾‹ï¼›</section><section>ä½¿ç”¨SingleRè¿›è¡Œç»†èƒå¤§ç±»æ³¨é‡Šï¼›</section><section>UMAPç»˜å›¾ä»£ç å¯å‚è€ƒ<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAwODIzOTExNw==&amp;mid=2247491400&amp;idx=1&amp;sn=06da47eec04c8e564473b0dc385b0e27&amp;chksm=9b70be2aac07373cee752ef81e3c1d7e5be2d5542fcf987adc922da6f393e0e1c350fc1311bd&amp;scene=21#wechat_redirect" textvalue="å•ç»†èƒç»˜å›¾ä¹‹ UMAP &amp; tSNE" linktype="text" imgurl="" imgdata="null" data-itemshowtype="0" tab="innerlink" data-linktype="2">å•ç»†èƒç»˜å›¾ä¹‹ UMAP &amp; tSNE</a>ã€‚</section><section><br></section><section><span><strong>2.2 æ•°æ®æå–ä¸å¤„ç†</strong></span></section><section><strong><span>â‘ </span></strong><strong>è¡¨è¾¾çŸ©é˜µï¼š</strong><span>scRNA-seq è¡¨è¾¾çŸ©é˜µï¼ŒåŸºå› ä¸ºè¡Œã€ç»†èƒä¸ºåˆ—ã€‚</span><br></section><section><span><span>ã€Â </span><span>scedata@assays$RNA@dataÂ </span><span>ã€‘</span></span></section><section><span><img data-ratio="0.12903225806451613" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHVnZj68gGicu2dssnSzE65k2EOiayEgicF963orNeHbw76hibhut64GtzoA/640?wx_fmt=png" data-type="png" data-w="558" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHVnZj68gGicu2dssnSzE65k2EOiayEgicF963orNeHbw76hibhut64GtzoA/640?wx_fmt=png"></span></section><section><strong><span>â‘¡ åˆ†ç»„å’Œç»†èƒæ³¨é‡Šä¿¡æ¯</span></strong></section><section><span>ã€ </span><span>scedata@meta.data[ , c("orig.ident","Tissue","labels")]</span><span> ã€‘</span></section><section><img data-ratio="0.3502824858757062" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHlWTSMMEUXRLIOmMLSFjaETE04SRPhxibia0QBIhYpxXyuHohoC4cyynA/640?wx_fmt=png" data-type="png" data-w="354" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHlWTSMMEUXRLIOmMLSFjaETE04SRPhxibia0QBIhYpxXyuHohoC4cyynA/640?wx_fmt=png"></section><p><strong><span>â‘¢åŸºå› é›†ï¼š</span></strong><span>GSEAç½‘ç«™è·å–ï¼š</span></p><section><span>â€œc5.go.bp.v7.4.entrez.gmtâ€</span></section><section><span>â€œc2.cp.kegg.v7.4.entrez.gmtâ€</span></section><section><img data-ratio="0.3412887828162291" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHWtpWfCPtwF1UR46yrxHxysunHB0hrrcoMtHv1AM8je3mfhx64sTic7A/640?wx_fmt=png" data-type="png" data-w="419" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHWtpWfCPtwF1UR46yrxHxysunHB0hrrcoMtHv1AM8je3mfhx64sTic7A/640?wx_fmt=png"></section><section><br></section><section><br></section><section><span><strong><strong>2.3Â </strong>GSEA</strong></span></section><section><span>â‘  æå–Tç»†èƒæ•°æ®Â Â Â Â </span></section><section><span>â‘¡ </span><span>ç»„é—´å·®å¼‚</span><span>è¡¨è¾¾åŸºå› åˆ†æ</span></section><section><span><img data-ratio="0.060459492140266025" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHPhVMUJF23njY0znGUJuFjhC2h5adG0ul55eaicFFf9FMWAuDa184eSg/640?wx_fmt=png" data-type="png" data-w="827" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHPhVMUJF23njY0znGUJuFjhC2h5adG0ul55eaicFFf9FMWAuDa184eSg/640?wx_fmt=png"></span></section><section><span>â‘¢ è¯»å–ç›®æ ‡ genesets æ–‡ä»¶</span></section><section><span>â‘£ è¿è¡ŒGSEA+ä½œå›¾</span></section><section><span>ã€clusterProfilerã€‘-- GSEA</span></section><section><span>ã€ enrichplot ã€‘-- gseaplot2</span></section><section><span><br></span></section><section><span><strong><strong>2.4Â </strong>GSVA</strong></span></section><section><span>â‘  </span><span>æå–å’Œé¢„å¤„ç†è¡¨è¾¾çŸ©é˜µ</span></section><section><span>æå–ï¼šexpr &lt;- as.data.frame(scRNA_sub@assays$RNA@data)</span></section><section><span>åŸºå› IDè½¬æ¢ï¼š</span></section><section><span><img data-ratio="0.1280193236714976" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHpib7LxNicg0jZ72g88QDoqAiaNWicpqkh8ZR2dQmrO9opIVia6ajDicp79MQ/640?wx_fmt=png" data-type="png" data-w="828" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHpib7LxNicg0jZ72g88QDoqAiaNWicpqkh8ZR2dQmrO9opIVia6ajDicp79MQ/640?wx_fmt=png"></span></section><section><span>â†“</span></section><section><span><img data-ratio="0.1316425120772947" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHW5FgicXBDm5jP2xVia4eYyLFiarh6VialG8eB7beJhRN9gWID98Sa56Lyw/640?wx_fmt=png" data-type="png" data-w="828" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHW5FgicXBDm5jP2xVia4eYyLFiarh6VialG8eB7beJhRN9gWID98Sa56Lyw/640?wx_fmt=png"></span></section><section><span>â‘¡ è¯»å–ç›®æ ‡ genesets æ–‡ä»¶</span></section><section><span>â‘¢ è¿è¡ŒGSVAã€gsvaå‡½æ•°ã€‘+ä½œå›¾</span></section><section><span>â‘£ *å·®å¼‚åˆ†æã€limmaã€‘</span></section><section><span><br></span></section><section data-id="93972" data-tools="135ç¼–è¾‘å™¨"><section><section><section><section><section><span>03</span></section></section><section data-brushtype="text"><span><strong>ä»£ç åˆ†äº«</strong></span></section></section></section></section></section><section><ul><li><li><li><li><li><li></ul><pre data-lang="css"><code><span><span>library</span>(<span>Seurat</span>)</span></code><code><span><span>library</span>(<span>tidyverse</span>)</span></code><code><span><span>library</span>(<span>ggplot2</span>)</span></code><code><span><span>library</span>(<span>ggsci</span>)</span></code><code><span><span>library</span>("<span>org</span><span>.Hs</span><span>.eg</span><span>.db</span>")</span></code><code><span><span>library</span>(<span>clusterProfiler</span>)</span></code></pre></section><section><ul><li></ul><pre data-lang="sql"><code><span><span>load</span>(<span>"scedata.rda"</span>)</span></code></pre></section><section><span></span></section><section><span><br></span></section><section><strong><span>##### GSEA #####</span></strong><br></section><section><ul><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span>table(<span>scedata@</span>meta.<span>data</span>$labels)</span></code><code><span>cells_sub &lt;- subset(<span>scedata@</span>meta.<span>data</span>, </span></code><code><span>                    labels %<span>in</span>% c(<span>"T_cells"</span>))</span></code><code><span>scRNA_sub &lt;- subset(scedata, </span></code><code><span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cells=row.names(cells_sub))</span></code></pre></section><section><span></span></section><section><ul><li><li><li><li></ul><pre data-lang="cs"><code><span><span>#ç»„é—´å¯¹æ¯”è®¡ç®—å„åŸºå› logFC</span></span></code><code><span>sub.markers &lt;- FindMarkers(scRNA_sub,<span>group</span>.<span>by</span> = <span>'Tissue'</span>,</span></code><code><span>                           ident<span>.1</span> = <span>'T'</span>,ident<span>.2</span> = <span>'N'</span>,logfc.threshold = <span>0.01</span>)</span></code><code><span>sub.markers.sig &lt;- subset(sub.markers, p_val_adj&lt;<span>0.05</span> &amp; avg_log2FC &gt;<span>0.5</span>)</span></code></pre></section><section><span></span></section><section><span><img data-ratio="0.24956672443674177" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHoPZvf1KwxypIypRufX30C7DtI9wHQtibwsXcVc4WCCKnZzuO7Sysr7A/640?wx_fmt=png" data-type="png" data-w="577" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHoPZvf1KwxypIypRufX30C7DtI9wHQtibwsXcVc4WCCKnZzuO7Sysr7A/640?wx_fmt=png"></span></section><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># åŸºå› åè½¬æ¢</span></span></code><code><span><span>mydata</span> &lt;- data.frame(Gene=rownames(sub.markers),logFC=sub.markers$avg_log2FC)%&gt;%</span></code><code><span>  <span>arrange</span>(desc(logFC))</span></code><code><span><span>genelist</span> &lt;- bitr(mydata$Gene,fromType = <span>"SYMBOL"</span>, toType = <span>"ENTREZID"</span>, OrgDb = <span>"org.Hs.eg.db"</span>)%&gt;%</span></code><code><span>  <span>inner_join</span>(mydata,by= c('SYMBOL'='Gene'))%&gt;%</span></code><code><span>  <span>arrange</span>(desc(logFC))</span></code><code><span><br></span></code><code><span><span>gsea_input</span> &lt;- genelist$logFC</span></code><code><span><span>names</span>(gsea_input) &lt;- genelist$ENTREZID</span></code></pre></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span>#Â geneÂ setsÂ input</span></span></code><code><span><span>geneset</span> &lt;- read.gmt(<span>"c5.go.bp.v7.4.entrez.gmt"</span>)  </span></code><code><span><span># Run GSEA</span></span></code><code><span><span>gg</span> &lt;- GSEA(gsea_input, TERM2GENE=geneset,verbose=F,</span></code><code><span>           <span>pvalueCutoff</span>=0.1, pAdjustMethod = <span>"BH"</span>)</span></code><code><span><span>sortgg</span>&lt;- gg[order(gg$NES, decreasing = T),]</span></code><code><span><span>sortgg</span>&lt;- sortgg[sortgg$p.adjust &lt;0.05,]</span></code><code><span><span>#Â view(sortgg)</span></span></code></pre></section><section><span></span></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># plot</span></span></code><code><span><span>library</span>(enrichplot)</span></code><code><span><span>geneset_plot</span> &lt;- c(<span>"GOBP_OXIDATIVE_PHOSPHORYLATION"</span>,</span></code><code><span>                  "<span>GOBP_ELECTRON_TRANSPORT_CHAIN</span><span>",</span></span></code><code><span><span>                  "</span>GOBP_CELLULAR_RESPIRATION<span>")</span></span></code><code><span>mycol &lt;- pal_nejm()(8)</span></code><code><span>gseaplot2(gg,</span></code><code><span>          geneSetID = geneset_plot,</span></code><code><span>          color = mycol[c(1:3)],</span></code><code><span>          title = 'Specific GO_BP',</span></code><code><span>          rel_heights = c(1.3, 0.3, 0.6),</span></code><code><span>          pvalue_table = F)</span></code></pre></section><p><span><img data-ratio="0.7534246575342466" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHP3EmLjic2AEhCT9kibL1vIWic7H43mm68cHiczcIjPINOOiagcGlhYcECdw/640?wx_fmt=png" data-type="png" data-w="511" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHP3EmLjic2AEhCT9kibL1vIWic7H43mm68cHiczcIjPINOOiagcGlhYcECdw/640?wx_fmt=png"></span></p><section><strong><span></span></strong></section><section><strong><span>##### GSVA #####</span></strong><br></section><section><ul><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span>table(<span>scedata@</span>meta.<span>data</span>$labels)</span></code><code><span>cells_sub &lt;- subset(<span>scedata@</span>meta.<span>data</span>, </span></code><code><span>                    labels %<span>in</span>% c(<span>"T_cells"</span>))</span></code><code><span>scRNA_sub &lt;- subset(scedata, </span></code><code><span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â cells=row.names(cells_sub))</span></code></pre></section><section><ul><li></ul><pre data-lang="css"><code><span><span>expr</span> &lt;<span>-</span> <span>as</span><span>.data</span><span>.frame</span>(<span>scRNA_sub</span>@<span>assays</span>$<span>RNA</span>@<span>data</span>)</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li></ul><pre data-lang="bash"><code><span><span>#Â åŸºå› åè½¬æ¢</span></span></code><code><span>expr<span>$ID</span> &lt;- rownames(expr)</span></code><code><span>s2e &lt;- bitr(expr<span>$ID</span>, </span></code><code><span>            fromType = <span>"SYMBOL"</span>,</span></code><code><span>            toType = <span>"ENTREZID"</span>,</span></code><code><span>            OrgDb = org.Hs.eg.db)</span></code><code><span>expr &lt;- inner_join(expr,s2e,by=c(<span>"ID"</span>=<span>"SYMBOL"</span>))</span></code><code><span>rownames(expr)Â &lt;-Â expr<span>$ENTREZID</span></span></code><code><span>expr &lt;- expr[,-c((ncol(expr)-1),ncol(expr))]</span></code></pre></section><section><ul><li><li><li></ul><pre data-lang="apache"><code><span><span># Prepare gene set</span></span></code><code><span><span>geneset</span> &lt;- read.gmt(<span>"D:\\AAA\\Common_source\\c2.cp.kegg.v7.4.entrez.gmt"</span>)  </span></code><code><span><span>geneset_list</span> = split(geneset$gene, geneset$term)</span></code></pre></section><section><ul><li><li><li><li></ul><pre data-lang="javascript"><code><span>library(GSVA)</span></code><code><span>expr &lt;- <span>as</span>.matrix(expr)</span></code><code><span>expr[<span>1</span>:<span>3</span>,<span>1</span>:<span>3</span>]</span></code><code><span>gsva1 &lt;- gsva(expr, geneset_list, kcdf=<span>"Gaussian"</span>,method = <span>"gsva"</span>, parallel.sz=<span>12</span></span></code></pre></section><section>è¿™ä¸€æ­¥æ¯”è¾ƒåƒå†…å­˜ï¼Œå»ºè®®è¿è¡Œå®Œä¹‹ååŠæ—¶ä¿å­˜ã€‚</section><section>è‡³æ­¤ï¼ŒGSVAå·²å®Œæˆï¼Œåç»­ç»˜å›¾å¯è‡ªè¡Œé€‰æ‹©æƒ³è¦å±•ç¤ºçš„é€šè·¯ï¼Œä¹Ÿå¯å†æ¥ä¸ªå·®å¼‚åˆ†æï¼Œå±•ç¤ºæœ€æ˜¾è‘—çš„é€šè·¯~â†“</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="kotlin"><code><span>meta &lt;- <span>as</span>.<span>data</span>.frame(<span>scRNA_sub@</span>meta.<span>data</span>[,c(<span>"orig.ident"</span>,<span>"Tissue"</span>,<span>"labels"</span>)])</span></code><code><span><br></span></code><code><span>mydata &lt;- t(<span>as</span>.<span>data</span>.frame(gsva1))%&gt;%<span>as</span>.<span>data</span>.frame()</span></code><code><span>mydata &lt;- merge(meta,mydata,<span>by</span>.x = <span>0</span>,<span>by</span>.y = <span>0</span>)</span></code><code><span>rownames(mydata) &lt;- mydata$Row.names</span></code><code><span>mydata &lt;- mydata[,c(-<span>1</span>,-<span>2</span>,-<span>4</span>)]</span></code><code><span><br></span></code><code><span>library(limma)</span></code><code><span>group_list &lt;- factor(mydata$Tissue)</span></code><code><span>design &lt;- model.matrix(~<span>0</span>+group_list)</span></code><code><span>colnames(design) &lt;- levels(group_list)</span></code><code><span>rownames(design) &lt;- rownames(mydata)</span></code><code><span>contrast.matrix &lt;- makeContrasts(<span>'T-N'</span>,levels = design)</span></code><code><span>fit &lt;- lmFit(t(mydata[,-<span>1</span>]),design = design)</span></code><code><span>fit2 &lt;- contrasts.fit(fit,contrast.matrix)</span></code><code><span>fit2 &lt;- eBayes(fit2)</span></code><code><span>alldiff=topTable(fit2,coefÂ =Â <span>1</span>,nÂ =Â Inf)</span></code></pre></section><section>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»˜åˆ¶çƒ­å›¾å±•ç¤ºä¸€ä¸‹ logFC æ’åå‰20çš„é€šè·¯ â†“</section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="apache"><code><span><span># data prepare</span></span></code><code><span><span>alldiff</span> &lt;- alldiff[order(abs(alldiff$logFC),decreasing = T),]</span></code><code><span><span>plotdata</span> &lt;- t(mydata[,rownames(alldiff[1:20,])])</span></code><code><span><br></span></code><code><span><span>library</span>(ComplexHeatmap)</span></code><code><span><span>library</span>(circlize)</span></code><code><span><span>Group</span> &lt;- c('#D2691E','#DDA0DD')</span></code><code><span><span>names</span>(Group) &lt;- c('T','N')</span></code><code><span><span>Top</span> &lt;- HeatmapAnnotation(Group= factor(mydata$Tissue),</span></code><code><span>                         <span>annotation_legend_param</span>=list(labels_gp = gpar(fontsize = 10),</span></code><code><span>                                                      <span>title_gp</span> = gpar(fontsize = 10, fontface = <span>"bold"</span>),</span></code><code><span>                                                      <span>ncol</span>=1),</span></code><code><span>                         <span>border</span> = T,</span></code><code><span>                         <span>col</span>=list(Group=Group),</span></code><code><span>                         <span>show_annotation_name</span> = TRUE,</span></code><code><span>                         <span>annotation_name_side</span>=<span>"left"</span>,</span></code><code><span>                         <span>annotation_name_gp</span> = gpar(fontsize = 10))</span></code></pre></section><section><ul><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li><li></ul><pre data-lang="php"><code><span>Heatmap(plotdata,<span>##å¯¹åŸºå› è¡¨è¾¾é‡è¿›è¡Œé™å®š,ä¹Ÿå¯ä»¥è¿›è¡Œè½¬ç½®tåscaleè¿›è¡Œè¿‡æ»¤</span></span></code><code><span>        name=<span>'Score'</span>,<span>#çƒ­å›¾å€¼å›¾ä¾‹å</span></span></code><code><span>        top_annotation = Top,<span>#é¡¶éƒ¨æ³¨é‡Š  </span></span></code><code><span>        cluster_rows = <span>FALSE</span>,<span>#ä¸å¯¹è¡Œè¿›è¡Œèšç±»</span></span></code><code><span>        col=colorRamp2(c(<span>-1</span>,<span>0</span>,<span>1</span>),c(<span>'#008B8B'</span>,<span>'#F5F5F5'</span>,<span>'#DC143C'</span>)),<span>#é¢œè‰²'steelblue','white','firebrick3'è“ç™½çº¢</span></span></code><code><span>        color_space = <span>"RGB"</span>,</span></code><code><span>        cluster_columns = <span>FALSE</span>,border = T,</span></code><code><span>        row_order=<span>NULL</span>,</span></code><code><span>        row_names_side = <span>'left'</span>,</span></code><code><span>        column_order=<span>NULL</span>,</span></code><code><span>        show_column_names = <span>FALSE</span>,</span></code><code><span>        <span>#show_row_names = FALSE,  </span></span></code><code><span>        row_names_gp = gpar(fontsize = <span>8</span>),</span></code><code><span>        column_split = c(rep(<span>1</span>,table(mydata$Tissue)[<span>1</span>]),rep(<span>2</span>,table(mydata$Tissue)[<span>2</span>])),</span></code><code><span>        gap = unit(<span>4</span>, <span>"mm"</span>),</span></code><code><span>        column_title = <span>NULL</span>,</span></code><code><span>        column_title_gp = gpar(fontsize = <span>10</span>),</span></code><code><span>        row_title_gp = gpar(fontsize=<span>10</span>),</span></code><code><span>        show_heatmap_legend = <span>TRUE</span>,</span></code><code><span>        heatmap_legend_param=<span>list</span>(labels_gp = gpar(fontsize = <span>10</span>), </span></code><code><span>                                  title_gp = gpar(fontsize = <span>10</span>, fontface = <span>"bold"</span>)))</span></code></pre></section><section><img data-ratio="0.7495741056218058" data-src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHH0XLDgeZZIl7CPAlHHfKn1mHNJwbQp2M6xmzJPBa8LVEztkIsOX3eg/640?wx_fmt=png" data-type="png" data-w="587" src="https://mmbiz.qpic.cn/mmbiz_png/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHH0XLDgeZZIl7CPAlHHfKn1mHNJwbQp2M6xmzJPBa8LVEztkIsOX3eg/640?wx_fmt=png"></section><section><br></section><section><br></section><section data-id="96476" data-tools="135ç¼–è¾‘å™¨"><section><section><section><br></section></section><section><section data-ct="fix"><section data-autoskip="1"><section><span><strong><span>---PS---</span></strong></span></section></section></section></section></section></section><p><img data-croporisrc="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHG7y96GcpTR5oqtYJHuQHJOuJXf7TcAp7ia1yhhkWunRZGjktFU7Qedw/0?wx_fmt=jpeg" data-cropx1="0" data-cropx2="960" data-cropy1="0" data-cropy2="910.1730103806228" data-galleryid="" data-ratio="0.9479166666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHEoA1lp7JJlqlf40hMRiaWE4ia7oU89xnJBxPaGp9Z5abicerYHDvRyrfg/640?wx_fmt=jpeg" data-type="jpeg" data-w="960" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8egz8p73UyIWo4BeovL2zJHEoA1lp7JJlqlf40hMRiaWE4ia7oU89xnJBxPaGp9Z5abicerYHDvRyrfg/640?wx_fmt=jpeg"></p><p><br></p><p><span>åŒ»å­¦åƒ§çš„å¿ƒæ„¿æ˜¯ä¸ºåŒ»å­¦åƒ§çš„æ”¯æŒè€…å’Œç§‘ç ”çˆ±å¥½è€…è¥é€ ä¸€ä¸ªå‹¤å­¦å¥½é—®ã€äº’å¸®äº’åŠ©ã€å…±åŒè¿›æ­¥çš„ä¼˜è‰¯ç¯å¢ƒã€‚</span><span>ä½†æ˜¯äººå¤šäº†éš¾å…é±¼é¾™æ··æ‚ï¼Œè‰¯è ä¸é½ï¼Œç¾¤é‡Œä¸ä¹æœ‰çœŸå¿ƒå®æ„ã€è„šè¸å®åœ°çš„ç§‘ç ”äººï¼Œæˆ‘ä»¬å¾ˆå°Šé‡å¹¶æ¬¢è¿ä»–ä»¬ï¼Œå› æ­¤ä¸å¸Œæœ›è¢«å°‘æ•°æ¥å‘å¹¿å‘Šçš„ã€åˆ’æ°´çš„ã€çœ‹çƒ­é—¹çš„ã€å ä¸ªå‘çš„æ‰€æ‰“æ‰°ï¼Œæœ€ç»ˆæˆ‘ä»¬çš„å¿ƒæ„ä»˜ä¹‹ä¸œæµï¼Œå¤§å®¶çš„çƒ­æƒ…æ¶ˆç£¨æ®†å°½ã€‚</span><span>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†³å®šæé«˜å…¥ç¾¤çš„é—¨æ§›â€”â€”æ”¶è´¹è¿›ç¾¤ï¼Œè¿™æ ·ï¼Œæ„¿æ„è¿›ç¾¤çš„åŒå¿—ç›¸ä¿¡ä¹Ÿæ˜¯ä¸ªåœˆå†…æ´»è·ƒç”¨æˆ·ï¼Œåœˆå†…äººç›¸äº’äº¤æµï¼Œå²‚ä¸å¿«å“‰ï¼</span><br></p><section><section>å› æ­¤ï¼Œä¸ºäº†æå‡å¤§å®¶çš„æ•ˆç‡ï¼Œè°ƒåŠ¨å¤§å®¶çš„ç§¯ææ€§ï¼Œå¸æ”¶çœŸæ­£çš„ç§‘ç ”çˆ±å¥½è€…ï¼Œå½¢æˆä¸€ä¸ªè‰¯å¥½çš„å­¦ä¹ äº¤æµæ°›å›´ï¼Œæˆ‘ä»¬å†³å®šå¢åŠ ç¾¤çš„æ•°é‡ï¼Œå¹¶ç»†åŒ–ç¾¤çš„åŠŸèƒ½ï¼Œæš‚æ—¶å¢åŠ ä»¥ä¸‹å‡ ä¸ªä¸»é¢˜ç¾¤ï¼š</section><ul><li><p>æ–‡çŒ®ä¸‹è½½-åŒ»å­¦åƒ§</p></li><li><p>æœºå™¨å­¦ä¹ ï¼ˆåˆ†ç±»ï¼‰-åŒ»å­¦åƒ§</p></li><li><p>ggplotå¯è§†åŒ–-åŒ»å­¦åƒ§</p></li><li><p>çƒ­å›¾å¯è§†åŒ–-åŒ»å­¦åƒ§</p></li><li><p>TCGAæŒ–æ˜-åŒ»å­¦åƒ§</p></li><li><p>GEOæŒ–æ˜-åŒ»å­¦åƒ§</p></li><li><p>è‚¿ç˜¤é¢„åæ¨¡å‹-åŒ»å­¦åƒ§</p></li><li><p>è‚¿ç˜¤åˆ†å­äºšå‹-åŒ»å­¦åƒ§</p></li></ul><p>æ¬¢è¿å°ä¼™ä¼´ä»¬è¿›ç¾¤ğŸ‘ğŸ‘ğŸ‘ï¼Œæ¯ä¸ªç¾¤æ”¶è´¹15å…ƒã€‚è¯·è”ç³»å°ç¼–å¾®ä¿¡yixuesengkyrjæˆ–æ‰«æä¸‹é¢äºŒç»´ç ï¼š</p><p><img data-ratio="0.8407407407407408" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8eToe4Nt4XyydFdvqEM0WohEpzTSD45q9Xib8zpEq7kGgVBYh9AMdPvXJNOZAVz3MgrRJAKKfzxIWQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="jpeg" data-w="1080" src="https://mmbiz.qpic.cn/mmbiz_jpg/eBfvI7Ryx8eToe4Nt4XyydFdvqEM0WohEpzTSD45q9Xib8zpEq7kGgVBYh9AMdPvXJNOZAVz3MgrRJAKKfzxIWQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"></p><p><br></p></section></div>  
<hr>
<a href="https://mp.weixin.qq.com/s/uBIvJ3Q-_E-95zonLerxeA",target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a>
